Lyte.Component.registerHelper("getRecordNum",(function(e){return e&&e.recnum?e.recnum:-1})),Lyte.Component.registerHelper("recordsCount",(function(e){return e?e.length:1})),Lyte.Component.registerHelper("getMessageHtml",(function(e){var t,r=e.type,n=[],a=e.rule?e.rule.id:null,i=e.rule?e.rule.name:"",o=!!e.rule&&(!!e.rule.type&&("orchestration"==e.rule.type||"commandcenter"==e.rule.type)),s=!!e.rule&&(!!e.rule.type&&("series"===e.rule.type||"cadence"===e.rule.type||"cadences"===e.rule.type)),l=e.execution_type,c={email_alert:"/ShowSetup.do?tab=automate&subTab=alert&step=showAlert&alertId=",task:"/ShowSetup.do?tab=automate&subTab=task&step=showTask&taskId=",field_update:"/ShowSetup.do?tab=automate&subTab=fieldUpdate&step=showFieldUpdate&fieldUpdateId=",webhook:"/ShowSetup.do?tab=automate&subTab=webhook&step=showWebHook&webHookId=",sms:"/settings/workflow-sms-notifications/notifications/"},d={followups:"crm.upcomingActions.scheduled.deluge.message",addmeeting:"crm.upcomingActions.scheduled.createrecord.message",flow:"crm.upcomingActions.scheduled.schedulecall.message"},m=r.toLowerCase();if("email_alert"===r?m="alert":"deluge"===r?m="deluge":"field_update"===r?m="fieldupdate":"assign_owner"===r?m="assignowner":"create_record"===r?m="createrecord":"create_connected_record"===r&&(m="createconnectedrecord"),o)t="crm.upcomingActions.scheduled.orchestration."+m+".message";else if(s)t="crm.upcomingActions.series.scheduled."+m+".message";else{var u;if("RemoveTags"==r||"AddTags"==r)u="RemoveTags"==r?"remove":"add",t=e.name.includes(",")?"crm.tags.timeline.upcoming."+u+".tag.action.plural":"crm.tags.timeline.upcoming."+u+".tag.action.singular","instant"!=l&&(t=t.replace("crm.tags.timeline.upcoming.","crm.upcoming.scheduled.")),n.push(e.name);else t="crm.upcomingActions.scheduled."+m+".message",null!=d[m]&&(t=d[m])}if(null!=r&&0===r.indexOf("custom-")&&(t="crm.upcomingActions.scheduled.customactions.message"),"instant"==l&&(t=t.replace("upcomingActions.scheduled.","upcomingActions.")),"field_update"===r){var p=$ESAPI.encoder().encodeForHTML(e.value)||"",g=store.peekRecord("field",e.field.id),_=g?$ESAPI.encoder().encodeForHTML(g.display_label):null;n.push(_),"0"===p.length?p=I18n.getMsg("crm.workflow.fieldupdate.toblank"):e.field&&e.field.enable_colour_code&&(p=getPKcolorAppliedVal(p,e.field.pick_list_values)),n.push(p)}if(Object.keys(c).indexOf(r)>=0){var v=e.id,f=e.name,y="<a class='link' href='"+Crm.getCrmBasePath()+c[r]+v+"' target='_blank'>"+$ESAPI.encoder().encodeForHTML(f)+"</a>";n.push(y)}if("task"===r){var C=e.assigned_to.id,L=e.assigned_to.name;n.push("<span id='show_"+C+"' class='mR5 mL3 crm-small-font-size cDefault' onmouseover='showUserBusinessCard(this,'"+C+"',this)' onmouseout='hideUserBusinessCard(this)'>"+$ESAPI.encoder().encodeForHTML(L)+"</span>")}if("deluge"===r&&n.push(e.name),"assign_owner"===r){var h=this.getData("module");n.push(moduleRecordMapping[h].singular_label)}return s?n.push("<a class='link' href='"+Crm.getCrmBasePath()+"/settings/cadences/"+a+"' target='_blank'>"+$ESAPI.encoder().encodeForHTML(i)+"</a>"):n.push("<a class='link' href='"+Crm.getCrmBasePath()+"/settings/workflow-rules/"+a+"' target='_blank'>"+$ESAPI.encoder().encodeForHTML(i)+"</a>"),t=o?t:t.replace("fieldupdate","fieldUpdate"),I18n.getMsg(t,n)})),Lyte.Component.registerHelper("getConnectedModuleData",(function(e,t,r,n){var a=e[r].id,i=store.peekRecord(moduleRecordMapping[t].id,a);if(!n)return i;for(var o=n?n.split("."):[],s=o.length,l=0;l<s;l++){if(!(i=i[n=o[l]]))return i}return i})),Lyte.Component.registerHelper("getConnectedModuleDataForUploadFields",(function(e,t,r,n,a,i,o){var s=Lyte.Component.registeredHelpers.getConnectedModuleData(e,t,r);if("fileupload"===a)return Lyte.Component.registeredHelpers.getFilesDataInCruxFormat(s[n]);if("imageupload"===a){if(s[n]){let r=Lyte.registeredMixins["crm-uploadfields-mixin"].constructImageDataFromServer(s[n],t,e.parentCompId,i),a=document.querySelector("crm-detailview-canvas"),o=Lyte.Router.getRouteInstance().getDynamicParam();var l=moduleRecordMapping[t].id;let u;if(u=l&&Customization.imageuploadFieldsId[l]&&Customization.imageuploadFieldsId[l].contains(i)?Customization.imageuploadFieldsId[l]:o&&Customization.imageuploadFieldsId[o]&&Customization.imageuploadFieldsId[o].contains(i)?Customization.imageuploadFieldsId[o]:[i],a&&u&&a.component&&(!Object.keys(a.component.getData("getThumbnailDataMap")).length||!a.component.getData("getThumbnailDataMap")[i]||Customization.imageuploadFieldsId[o]||Customization.imageuploadFieldsId[l])){var c=u,d=[],m=moduleRecordMapping[t]&&moduleRecordMapping[t].fields;m&&(d=c.filter((e=>m.some((t=>t.id===e))))),u=d.join("."),Lyte.registeredMixins["crm-uploadfields-mixin"].makeRequestForThumbnailForAlLIU(t,u,e.parentCompId,"canvas")}return r}return[]}})),Lyte.Component.registerHelper("getContactRoles",(function(e){return e?store.peekRecord("contact_role",e).name:""})),Lyte.Component.registerHelper("getApproveRejectCSS",(function(e,t){if(e)switch(e.toLowerCase()){case"approved":return"rpApproveIcon";case"rejected":return"rpRejectIcon";default:return"Rejected"===t?"dN":"rpApproveRejIcon"}return""})),Lyte.Component.registerHelper("getDisplayContentForSignalsInTimeline",(function(e){var t="";switch(e.action){case"email-bounce":t="<b>"+I18n.getMsg("crm.scoring.rules.zoho.campaign.bounce")+"</b> - "+e.displayContent.subject;break;case"email-opened":t="<b>"+I18n.getMsg("crm.scoring.rules.zoho.campaign.open")+"</b> - "+e.displayContent.subject;break;case"email-clicked":t="<b>"+I18n.getMsg("crm.scoring.rules.zoho.campaign.click")+"</b> - "+e.displayContent.subject;break;case"chat-missed":t="<b>"+I18n.getMsg("crm.signal.salesiq.missed.chat.text")+"</b> - "+e.displayContent.message;break;case"call-missed":t="<b>"+I18n.getMsg("crm.activities.call.defaultsubject.incomingmissed",e.displayContent.phone)+"</b>"}return t})),Lyte.Component.registerHelper("getFileUploadDataCruxFormView",(function(e){var t=$L("crm-create-layout")[0];if(t){var r=t.component.data.fileuploadFieldsData;return Lyte.registeredMixins["crm-uploadfields-mixin"].getFileDataInCruxFormat(r[e])}return this.component.data.record&&this.component.data.record[e]?Lyte.registeredMixins["crm-uploadfields-mixin"].getFileDataInCruxFormat(this.component.data.record[e]):[]})),Lyte.Component.registerHelper("getMaximumAllowedSize",(function(e){return Lyte.registeredMixins["crm-uploadfields-mixin"].formatBytes(e.maximum_allowed_size)})),Lyte.Component.registerHelper("checkButtonStatus",(function(e,t,r,n){var a,i=!("Quotes"!=r||!Crm.userDetails.isDisableActionsEnabled||"approval_process_pending"!==t.$approval_state);if("view"===n&&!i)return!1;if("send_mail_related_mod"===e&&!t)return!0;if(!t||validationUtils.isEmpty(t))return!1;var o=!1,s=!1,l=!0;if(r){var c="Crm_Implied_Edit_"+r;l=Crm.userDetails.permissions[c]}t&&t.Data_Processing_Basis_Details&&t.Data_Processing_Basis_Details&&!t.Data_Processing_Basis_Details.Contact_Through_Email&&(s=!0);var d,m=!1,u=!1,p=!1;if("canvas"===Lyte.Router.getRouteInstance().routeName){m=Lyte.Router.getRouteInstance().currentModel.entityDetails,u=Lyte.Router.getRouteInstance().currentModel[e+"_integration"];var g=$L("crm-detailview-canvas")[0];g&&(d=g.getData("recordLockingDetails"),p=g.getData("isLockAllowed"))}var _=t.$review;_?("Rejected"===_&&"edit"!==e&&"delete"!==e||"Review in Progress"===_&&"send_mail"!==e||"Pending for ReReview"===_&&"send_mail"!==e||"Pending for Review"===_&&"send_mail"!==e)&&(o=!0):o=!1;var v=!1,f=!1,y=!1,C=!1,L=!1,h=!1;if(t.$locked_for_me&&d&&d.restricted_actions)for(var k=d.restricted_actions.length,R=0;R<k;R++)switch(d.restricted_actions[R]){case"update":h=!0;break;case"delete":v=!0;break;case"convert":f=!0;break;case"tags":y=!0}if(t.$locked_for_me&&d&&d.restricted_communications){var b=d.restricted_communications.length;for(R=0;R<b;R++)switch(d.restricted_communications[R]){case"send_mail":C=!0;break;case"send_portal_invitation":L=!0}}switch("zia_vision_pending"!==t.$approval_state&&"zia_vision_validation"!==t.$approval_state||"send_mail"===e||(o=!0),e){case"send_mail":case"send_mail_related_mod":a=!(t.$stop_processing||o||s||C);break;case"sendDM":a=!t.$stop_processing&&!o&&!s&&m&&m.socialObj&&m.socialObj.TWDMInfo;break;case"convert":if(!r){a=!1;break}var M=store.peekRecord("module",moduleRecordMapping[r].id);a=M&&M.convertable&&(t.$editable||t.$locked_for_me)&&!t.$stop_processing&&t.$approved&&!o&&!t.$converted&&!f;break;case"edit":case"no_redirect_edit":a=t.$editable&&!t.$stop_processing&&(t.$approved||["Services","Appointments"].indexOf(r)>=0||"approval_process_rejected"===t.$approval_state||"approval_process_pending"===t.$approval_state)&&!o&&r&&("Calls"!==r||"Cancelled"!==t.Outgoing_Call_Status);break;case"lock":a=p;break;case"clone":case"no_redirect_clone":case"add_related_list":a=!o;break;case"delete":if(a=(t.$editable||t.$locked_for_me)&&(t.$approved||["Services","Appointments"].indexOf(r)>=0)&&!o&&!v,"Events"===r){var I=Crm.userDetails.DATE_PATTERN.toUpperCase()+" "+Crm.userDetails.TIME_FORMAT.replace(" a"," A"),D=$L.moment(t.Start_DateTime,I).toDate().getTime(),$=$L.moment($L.moment().timezone(Crm.userDetails.USER_TIME_ZONE).format(I),I).toDate().getTime();a=a&&(0===t.Participants.length||t.$event_cancelled||D<$||!t.$send_notification)}break;case"print_preview":case"exportpdf":a=!o&&!i;break;case"findandmerge":case"data_enrichment":a=t.$editable&&t.$approved&&!t.$stop_processing&&!o;break;case"mail_merge":var w="Crm_Implied_MailMerge_Mail_"+r;a=Crm.userDetails.permissions[w]&&!t.$stop_processing&&!o;break;case"macro":a=!t.$stop_processing&&t.$approved&&!o&&!h;break;case"follow":var S=!1;t&&t.Owner&&Crm.userDetails.USER_ID!==t.Owner.id&&(S=!0),a=S&&!o;break;case"reviewHistory":a=!o&&!t.$stop_processing;break;case"meetnow":case"scheduleonlinemeeting":a=!o&&Crm.calPreferences&&Crm.calPreferences.MEETINGPREFDETAILS&&"China"!==RebrandLinkUtil.getProperty("DeploymentLocation")&&"Free"!==Crm.userDetails.LICENSE_TYPE_ACTUAL_NAME;break;case"inviteClientPortal":a=!t.$stop_processing&&!o&&m&&((m.clientPortal.sendClientInvitation||m.clientPortal.sendClientReInvitation)&&!L||m.clientPortal.canViewPortalPreference);break;case"share":a=!t.$stop_processing&&t.$approved&&!o&&!m.isSharedRecord&&m.manageShare;break;case"cliq":case"slack":case"google_chat":case"microsoft_teams":case"cisco":a=u&&!o;break;case"tags":a=!o&&!y;break;case"create_client_script":a=!clientPortalName;break;case"close_task":a=l&&t.$editable&&"Completed"!==t.Status;break;case"rescheduled_appointment_history":a=!clientPortalName&&t.Reschedule_Count>0;break;case"mark_as_completed":case"reschedule_call":case"cancel_call":"Appointments"===r&&"mark_as_completed"===e?a=l&&t.$editable&&("Scheduled"===t.Status||"Overdue"===t.Status):(a=t.$editable&&["Completed","Cancelled"].indexOf(t.Outgoing_Call_Status)<0&&"Outbound"===t.Call_Type,"mark_as_completed"===e&&"Calls"===r&&(a=a&&t.Owner.id===Crm.userDetails.USER_ID),"reschedule_call"!==e&&"cancel_call"!==e||(a=a&&l));break;case"event_invitation":I=Crm.userDetails.DATE_PATTERN.toUpperCase()+" "+Crm.userDetails.TIME_FORMAT.replace(" a"," A");var A=$L.moment(t.End_DateTime,I).toDate().getTime();$=$L.moment($L.moment().timezone(Crm.userDetails.USER_TIME_ZONE).format(I),I).toDate().getTime();a=!(!t.Participants||0===t.Participants.length||!0===t.$send_notification||t.$event_cancelled||$>A);break;case"send_recordings":a=t.$meeting_details&&t.$meeting_details.recording_downloadUrl;break;case"start_meeting":I=Crm.userDetails.DATE_PATTERN.toUpperCase()+" "+Crm.userDetails.TIME_FORMAT.replace(" a"," A"),D=$L.moment(t.Start_DateTime,I).toDate().getTime(),A=$L.moment(t.End_DateTime,I).toDate().getTime();var H=($=$L.moment($L.moment().timezone(Crm.userDetails.USER_TIME_ZONE).format(I),I).toDate().getTime())>=D-3e5,T=t.$meeting_details&&t.$meeting_details.tool_name;a=!1;var F=t.Owner.id===Crm.userDetails.USER_ID?"start_meeting":"join_meeting";if(H||"ZohoMeeting"===T)if("start_meeting"===F&&t.Owner.id===Crm.userDetails.USER_ID&&$<A&&t.$approved&&!t.$event_cancelled&&void 0!==t.$meeting_details)a=!0;else if("join_meeting"===F&&t.Owner.id!==Crm.userDetails.USER_ID&&$<A&&t.$approved&&!t.$event_cancelled&&void 0!==t.$meeting_details){t.Participants.forEach((function(e){e.participant===Crm.userDetails.USER_ID&&"user"===e.type&&(a=!0)}))}break;case"cancel_event":I=Crm.userDetails.DATE_PATTERN.toUpperCase()+" "+Crm.userDetails.TIME_FORMAT.replace(" a"," A"),D=$L.moment(t.Start_DateTime,I).toDate().getTime(),A=$L.moment(t.End_DateTime,I).toDate().getTime(),$=$L.moment($L.moment().timezone(Crm.userDetails.USER_TIME_ZONE).format(I),I).toDate().getTime();a=!t.$event_cancelled&&t.$editable&&!0===t.$send_notification&&$<A;break;case"export_event":var E="Crm_Implied_Export_"+r;a=Crm.userDetails.permissions[E];break;case"mark_as_temporarily_unavail":case"mark_as_notinuse":I=Crm.userDetails.DATE_PATTERN.toUpperCase()+" "+Crm.userDetails.TIME_FORMAT.replace(" a"," A");var P=t.Available_From&&$L.moment(t.Available_From,I).toDate().getTime(),x=t.Available_Till&&$L.moment(t.Available_Till,I).toDate().getTime();$=$L.moment($L.moment().timezone(Crm.userDetails.USER_TIME_ZONE).format(I),I).toDate().getTime();a=!0,P&&x&&(a=!(x-$<-864e5||P>$)),"mark_as_temporarily_unavail"===e?a=a&&l&&t.$editable&&"Available"===t.Status:"mark_as_notinuse"===e&&(a=a&&l&&t.$editable&&("Available"===t.Status||"Temporarily Unavailable"===t.Status));break;case"mark_as_available":a=l&&t.$editable&&"Available"!==t.Status;break;case"manage_unavailability":a=l&&t.$editable&&"Temporarily Unavailable"===t.Status;break;case"reschedule_appointment":case"cancel_appointment":a=l&&t.$editable&&("Scheduled"===t.Status||"Overdue"===t.Status);break;case"meeting_status":a=!t.$event_cancelled;break;case"add_job_sheet":a=t.$editable&&"Completed"===t.Status&&t.Job_Sheet_Section__s&&!t.Job_Sheet_Created__s;break;default:a=!1}return!a})),Lyte.Component.registerHelper("isFieldLocked",(function(e,t,r){return e&&!(t&&t.contains(r))})),Lyte.Component.registerHelper("getInvitedData",(function(e,t,r,n){var a=e?store.peekAll(moduleRecordMapping[r].id)[0]:Lyte.Router.getRouteInstance().currentModel.record;if(a||(a=t),a){var i=e?t?store.peekRecord(moduleRecordMapping.Events.id,t.id):null:n;if(i)return Lyte.Component.registeredHelpers.getInvitedEventStatus(i,a)}})),Lyte.Component.registerHelper("getColorCodeForEvents",(function(e,t){return t?t&&t.$colour_code?"<span class='activitesColor_canvas' data-zcqa='rlcolor_"+$ESAPI.encoder().encodeForHTMLAttribute(t.Event_Title)+"' style='background: "+$ESAPI.encoder().encodeForHTMLAttribute(t.$colour_code)+"'></span>":"":"<span>{{unescape( getColorCodeForEvents(false , record) )}}</span>"})),Lyte.Component.registerHelper("getDateForWebformsListViewUpcoming",(function(e){if(e&&""!==e){var t=e.split("T")[0].split("-");return crmCalendar.monthNameWithThreeLetter[parseInt(t[1])-1].html+" "+parseInt(t[2])+", "+t[0]}return e})),Lyte.Component.registerHelper("getDateValue",(function(e){return $L.moment(e).toDate().getDate()})),Lyte.Component.registerHelper("zcPadStart",(function(e,t){return zutils.zcleftfillnum(e,t)})),Lyte.Component.registerHelper("bytesToSize",(function(e,t=0){let r=parseFloat(e);if(0===r)return"0 B";let n=t<0?0:t,a=Math.floor(Math.log(r)/Math.log(1024));return parseFloat((r/Math.pow(1024,a)).toFixed(n))+" "+["B","KB","MB"][a]})),Lyte.Component.registerHelper("getMonthName",(function(e){var t=$L.moment(e).toDate();return I18n.getMsg(["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"][t.getMonth()])})),Lyte.Component.registerHelper("getDateWithMonth",(function(e){return $L.moment(e).i18N("DD MMM")})),Lyte.Component.registerHelper("convertDateToGivenFormat",(function(e,t){var r=e;return t&&(r=$L.moment(e).format(t)),r})),Lyte.Component.registerHelper("convertDateToUserFormat",(function(e){return $L.moment(e).validate()?Utils.getDateInGivenPattern($L.moment(e).toDate(),Crm.userDetails.DATE_PATTERN.toLowerCase()):"Invalid"})),Lyte.Component.registerHelper("convertDateTimeToUserFormat",(function(e){return $L.moment(e).validate()?Utils.getDateTimeInUserFormat($L.moment(e).toDate()):"Invalid"})),Lyte.Component.registerHelper("validateCanvasURL",(function(e){return!!validationUtils.isValidWebUrl(e)})),Lyte.Component.registerHelper("canvasConstructURL",(function(e){return e&&"string"==typeof e&&0!==e.indexOf("http")&&(e="https://"+e),e})),Lyte.Component.registerHelper("flatResponse",(function(e){return"object"==typeof e?JSON.stringify(e):e})),Lyte.Component.registerHelper("canvasIsValidNumber",(function(e){return null!==e&&""!==e&&!isNaN(e)})),Lyte.Component.registerHelper("canvasIsBoolean",(function(e){return!0===e||e&&"true"===e.toLowerCase()})),Lyte.Component.registerHelper("CanvasGetRecordValueByID",(function(e,t){var r=t&&t.api_name;return e?e[r]:""})),Lyte.Component.registerHelper("isUserImageAvailable",(function(e){var t=Crm.getUserDetailsMap();e=e||Crm.userDetails.USER_ID;var r=t?t[e]:void 0;return!(!r||!r.avatar)})),Lyte.Component.registerHelper("getUserProfileImageText",(function(e){var t;if(e){var r=e.split(" "),n=r.length;t=n<=1?e.substring(0,2):r[0].charAt(0)+r[n-1].charAt(0)}else t="-";return t})),Lyte.Component.registerHelper("getAttachIconClass",(function(e,t,r,n){if(["word","excel","movie"].indexOf(e)<0&&(e=getExtensionGroup(e)),n&&"workdrive_link"===n)e="teamDrive";else if("Link URL"===t)e="link";else if("file"===e){var a=r.split("."),i=a[a.length-1];"ics"===i&&(e=i)}return"zcm-attachment-"+e})),Lyte.Component.registerHelper("PriceBookStatusChange",(function(e,t){return!0===e[t]?"Active":"InActive"})),Lyte.Component.registerHelper("getModulenameByApiname",(function(e){var t=objectUtils.getMatchedKey(moduleApiMapping,e);return moduleRecordMapping[t]?moduleRecordMapping[t].plural_label:""})),Lyte.Component.registerHelper("getModulePluralName",(function(e){return moduleRecordMapping[e]?moduleRecordMapping[e].plural_label:""})),Lyte.Component.registerHelper("getCanvasRuleSupportedComp",(function(e){return!(!e||Lyte.registeredMixins["crm-detailcanvas-utils"].canvasRuleUnsupportComp.indexOf(e)>-1)})),Lyte.Component.registerHelper("getCanvasRuleForModule",(function(e,t){return e.filter((function(e){return e.module.api_name===t&&"active"===e.status&&!e.combined})).length>0})),Lyte.Component.registerHelper("isNoRuleAvail",(function(e,t,r){return e.filter((function(e){return(e.module.api_name===t||e.module.api_name===r)&&"active"===e.status&&!e.combined})).length>0})),Lyte.Component.registerHelper("isEntityOnline",(function(e,t){return!("object"!=typeof CrmTracking||!CrmTracking.isEntityOnline(e,t))})),Lyte.Component.registerHelper("canvasImageToolTip",(function(e,t,r){var n=store.peekRecord(moduleRecordMapping[t].id,e),a=Lyte.registeredMixins["crm-detailcanvas-utils"];if(!(n&&null!==n&&n.$zia_visions&&n.$zia_visions.length>0&&a.fieldInvolvedInZia(n,r)))return"profileImageReadOnly";var i=Lyte.Router.getRouteInstance().currentModel;if(i&&i.entityDetails&&"13"===i.entityDetails.isApproved)return"profileImageZiaVisionProcessing";if(i&&i.entityDetails&&"10"===i.entityDetails.isApproved)return"profileImageZiaVision";for(var o,s="image_processing",l=n.$zia_visions.length,c=0;c<l;c++)if(r===n.$zia_visions[c].field.id){o=n.$zia_visions[c].vision_approvals.id;var d=Lyte.registeredMixins["crm-detailcanvas-utils"].visionApprovals;if(d&&d.length>0)for(var m=d.length,u=0;u<m;u++)d[u].approvalId===o&&(s=d[u].image_status)}return"image_processing"===s?"profileImageZiaVisionProcessing":"waiting_for_approval"===s?"profileImageZiaVision":void 0})),Lyte.Component.registerHelper("onClickforprofileImage",(function(e,t,r){var n=store.peekRecord(moduleRecordMapping[e].id,t),a=Lyte.registeredMixins["crm-detailcanvas-utils"],i="crm.tab.module.create.canvas"===Lyte.Router.getRouteInstance().transition.info.route;if(n&&null!==n&&n.$zia_visions&&n.$zia_visions.length>0&&a.fieldInvolvedInZia(n,r)&&Lyte.Router.getRouteInstance().currentModel.entityDetails){for(var o,s,l=n.$zia_visions.length,c=Lyte.Router.getRouteInstance().currentModel.entityDetails.isApproved,d="image_processing",m=!1,u=0;u<l;u++)if(r===n.$zia_visions[u].field.id){switch(o=n.$zia_visions[u].id,s=n.$zia_visions[u].vision_approvals.id,c){case"10":d="record_approval";break;case"12":d="do_not_create";break;case"13":d="image_processing";break;default:m=!0}if(!m)return"detailView.renderVisionErrorPopUp('"+d+"','"+e+"','"+n.id+"','"+o+"','"+s+"','"+!1+"','"+!0+"')"}if(m){var p=Lyte.registeredMixins["crm-detailcanvas-utils"].visionApprovals;if(p&&p.length>0){var g=p.length;for(u=0;u<g;u++)p[u].approvalId===s&&(d=p[u].image_status)}return"detailView.renderVisionErrorPopUp('"+d+"','"+e+"','"+n.id+"','"+o+"','"+s+"','"+!1+"','"+!0+"')"}}else{if(!i)return store.peekRecord("field",r).read_only||n&&(!n.$editable||!n.$approved||"Review in Progress"===n.$review||"Pending for ReReview"===n.$review||"Pending for Review"===n.$review)?"previewPhoto();":"checkOptionsForImage('"+e+"','"+t+"');";"checkOptionsForImage('"+e+"');"}})),Lyte.Component.registerHelper("checkImageStatus",(function(e,t,r){var n=store.peekRecord(moduleRecordMapping[r].id,t),a=Lyte.registeredMixins["crm-detailcanvas-utils"],i=!1;return n&&(store.peekRecord("field",e).read_only?i=!0:!n||n.$approved&&"Review in Progress"!==n.$review&&"Pending for ReReview"!==n.$review&&"Pending for Review"!==n.$review?(n&&!n.$editable||n&&n.$zia_visions&&n.$zia_visions.length>0&&a.fieldInvolvedInZia(n,e))&&(i=!0):i=!0),i})),Lyte.Component.registerHelper("canvasErrorMessageHandling",(function(e,t,r){return Lyte.registeredMixins["crm-detailcanvas-utils"].canvasErrorHandlingforLimit(e,t,r)})),Lyte.Component.registerHelper("getfileId",(function(e,t){var r=store.peekRecord(moduleRecordMapping[e].id,t);return r?r.Record_Image:""})),Lyte.Component.registerHelper("showOrHideStageAndBp",(function(e,t,r,n){var a=store.peekRecord(moduleRecordMapping[t].id,e),i=!1,o="",s=Lyte.registeredMixins["crm-detailcanvas-utils"].isBluePrintTrans;"blueprint"===n?(!!a&&a.$stop_processing||clientPortalName&&!s)&&(o="undefined"!==r?"zcanvas_tab_hidden":"zcanvas_contd_hidden"):a&&"stage_navigator"===n&&("Rejected"!==a.$review&&"Review in Progress"!==a.$review&&"Pending for Review"!==a.$review&&"Pending for ReReview"!==a.$review||(i=!0),a.$approved&&!i||(o="undefined"!==r?"zcanvas_tab_hidden":"zcanvas_contd_hidden"));return["S","Y"].indexOf(Crm.userDetails.LICENSE_TYPE)>-1&&"blueprint"===n&&(o="undefined"!==r?"zcanvas_tab_hidden":"zcanvas_contd_hidden"),o})),Lyte.Component.registerHelper("showOrHideCheckList",(function(e,t){var r=this.getData("entityDetails"),n="";"CHECKLISTSPERSONALITY"===t&&(r&&r.isCheckListAvail||(n="undefined"!==e?"zcanvas_tab_hidden":"zcanvas_contd_hidden"));return n})),Lyte.Component.registerHelper("canvasformattingCurrency",(function(e){return e||(e=void 0)})),Lyte.Component.registerHelper("getCruxName",(function(e,t){if(e||(e=store.peekRecord("field",t)),37!==e.ui_type&&555!==e.ui_type){var r=crmConstants.defaultUiTypeToCruxMapping[e.ui_type];return r||(r=e.data_type),r}})),Lyte.Component.registerHelper("canvaslookupvalue",(function(e,t){return t.isfol?t.folValue:e[t.fldObj.api_name]})),Lyte.Component.registerHelper("canvasGetFieldLabel",(function(e){var t=store.peekRecord("field",e).tooltip,r="";return t&&"Info Icon"===t.name&&(r='<span data-zcqa="zc_ajxFld_'+e+'" id="zc_ajax_info_icon_'+e+'" lt-prop-title="'+$ESAPI.encoder().encodeForHTMLAttribute(t.value)+'" lt-prop-tooltip-config={"position":"top"} class="icon_roundinfo mL5 cP vaM"></span>'),$ESAPI.encoder().encodeForHTMLAttribute(store.peekRecord("field",e).field_label)+r})),Lyte.Component.registerHelper("getCompForAjaxEdit",(function(e,t,r,n,a,i,o,s,l,c,d){if(!d){var m,u=!1;"crm.tab.module.create.canvas"===Lyte.Router.getRouteInstance().transition.info.route?(m="form_create",u=!0):"crm.tab.module.entity.edit.canvas"===Lyte.Router.getRouteInstance().transition.info.route&&(m="form_edit",u=!0);var p=Lyte.registeredMixins["crm-detailcanvas-utils"];if("form_create"===m||"form_edit"===m)var g=!!Lyte.registeredMixins["crm-canvas-view-rules"].LRuleManField.filter((function(t){return t.targetFieldId===e})).length;else g=!!p.revLRuleManField.filter((function(t){return t.targetFieldId===e})).length;return(r=!!(r&&n&&n.length>0))?Lyte.registeredMixins["crm-canvas-core-construct-component"].constructCompForAjaxEdit(e,t,g,n,null,null,o,s,l,c,m,u):a?Lyte.registeredMixins["crm-canvas-core-construct-component"].constructCompForAjaxEdit(e,t,g,n,a,i,o,s,l,c,m,u):Lyte.registeredMixins["crm-canvas-core-construct-component"].constructCompForAjaxEdit(e,t,g,null,null,null,o,s,l,c,m,u)}})),Lyte.Component.registerHelper("getCruxCompForAjaxFld",(function(e,t,r,n){return r=store.peekRecord(moduleRecordMapping[t].id,r.id),("form_create"===n||"form_edit"===n||"form_clone"===n?Lyte.registeredMixins["crm-canvas-core-construct-component"].constructCruxCompForForm(e,r||null,!1,null,null,null,null,null,null,null,n,!0):Lyte.registeredMixins["crm-canvas-core-construct-component"].constructCruxComponentForCanvas(e,t,r,!0,null,null,null,null,null,null,null,!0))||"-"})),Lyte.Component.registerHelper("getImageDataForCanvasFormView",(function(e,t,r,n,a){var i,o;this.component.data.record&&(o=this.component.data.record[e]);var s=!1;let l=Lyte.Router.getRouteInstance().getDynamicParam();var c;l||(l=(c=a?$L("crm-canvas-dynamic-preview")[0]:$L("crm-detailview-canvas")[0])&&c.component&&c.component.data&&c.component.data.viewId?c.component.data.viewId:void 0);if(a){var d=document.querySelector("crm-canvas-form"),m=document.querySelector("crm-create-layout");"WizardView"===(c=d?d.component:m.component).getData("currView").feature&&(i=(c=m.component).data.uploadedImageDetailsMap[e],s=!0,l=c&&c.data&&c.data.activeScreenView?c.data.activeScreenView.id:void 0);l&&$L.moment(store.peekRecord("canvasview",l).modified_time).time()}var u=moduleRecordMapping[n].id;let p;p=u&&Customization.imageuploadFieldsId[u]&&Customization.imageuploadFieldsId[u].contains(t)?Customization.imageuploadFieldsId[u]:l&&Customization.imageuploadFieldsId[l]&&Customization.imageuploadFieldsId[l].contains(t)?Customization.imageuploadFieldsId[l]:[t];var g="form_edit"===this.component.data.form_type?"edit":"create";if(!i&&o){i=Lyte.registeredMixins["crm-uploadfields-mixin"].constructImageDataFromServer(o,n,this.component.data.record.id,t);var _,v;if("edit"===g||s||!a)a&&"label_"+r,a?(_=d,v="formView"):(_=document.querySelector("crm-detailview-canvas"),v="canvas"),_&&p&&_.component&&(!Object.keys(_.component.getData("getThumbnailDataMap")).length||_.component.getData("getThumbnailDataMap")[t]||Customization.imageuploadFieldsId[u]||Customization.imageuploadFieldsId[l])&&(p=p.includes("[]")?t:[...new Set(p)].join("."),Lyte.registeredMixins["crm-uploadfields-mixin"].makeRequestForThumbnailForAlLIU(n,p,this.component.data.record.id,v));else i=JSON.stringify(i)}else i||(i=[]);return i})),Lyte.Component.registerHelper("getSubformCompForAjaxFld",(function(e,t,r){var n=store.peekRecord("field",e);return"<crm-detail-view-subform subform='"+JSON.stringify(n.section[0].$.toJSON())+"' subform_api='"+n.section[0].api_name+"' record-id='"+r.id+"' module='"+t+"'></crm-detail-view-subform>"})),Lyte.Component.registerHelper("isTextArea",(function(e){return"textarea"===store.peekRecord("field",e).data_type?"crm-canvas-textarea-field":""})),Lyte.Component.registerHelper("isFldVisible",(function(e){return store.peekRecord("field",e).visible})),Lyte.Component.registerHelper("isCanvasSectionVisible",(function(e){var t=!1;return e.fields.filter((function(e){store.peekRecord("field",e.id).visible&&(t=!0)})),t})),Lyte.Component.registerHelper("getLookupModule",(function(e){var t=e.lookup.module.api_name;return store.peekAll("module").forEach((function(e){e.api_name===t&&(t=e.module_name)})),t})),Lyte.Component.registerHelper("getLookupId",(function(e,t){return e[t.api_name]?e[t.api_name].id:""})),Lyte.Component.registerHelper("lookupCreatenotSupported",(function(e){var t=e.lookup.module.id,r=store.peekRecord("module",t).module_name;return!("Quotes"===r||"PriceBooks"===r||"Invoices"===r||"SalesOrders"===r||"PurchaseOrders"===r||"Services"===r)&&Lyte.Component.registeredHelpers.showAddRecord(r)})),Lyte.Component.registerHelper("lookupClassName",(function(e){var t=objectUtils.getMatchedKey(moduleApiMapping,e.lookup.module.api_name),r="lookup_hIconO fR mR5 hIconO lookupIconChange";return r=store.peekRecord("module",e.lookup.module.id).module_name.indexOf("CustomModule")>=0?"lookup newSearchIcon "+r:moduleRecordMapping[t].module_name+"-small "+r,e.read_only&&(r="icon-Icon_lock"),r})),Lyte.Component.registerHelper("lookupRelatedAccountDetails",(function(e,t,r){return("Contact_Name"===e.api_name||e.lookup&&e.lookup.module&&"Contacts"===e.lookup.module.api_name)&&t.Account_Name?"relatedId"===r?t.Account_Name.id:"relatedName"===r?t.Account_Name.name:"relatedModId"===r?moduleRecordMapping.Accounts.id:void 0:""})),Lyte.Component.registerHelper("recordJsonStringify",(function(e){return JSON.stringify(e.$.toJSON())})),Lyte.Component.registerHelper("lookupSingularLabel",(function(e){var t=e.lookup.module.id;return store.peekRecord("module",t).singular_label})),Lyte.Component.registerHelper("rptotalfldcount",(function(e){var t=Lyte.registeredMixins["crm-detailcanvas-utils"],r=e;return e&&t.RpHiddenFldId&&t.RpHiddenFldId.length&&(r=e+t.RpHiddenFldId.length),t.RpPermissionLessFldId&&t.RpPermissionLessFldId.length&&(r+=t.RpPermissionLessFldId.length),r})),Lyte.Component.registerHelper("checkandsetLookupMandatoryFld",(function(e){return e=e.$.toJSON(),!!Lyte.registeredMixins["crm-detailcanvas-utils"].revLRuleManField.filter((function(t){return t.targetFieldId===e.id})).length&&(e.required=!0),e})),Lyte.Component.registerHelper("getModuleNameforLookup",(function(e){return objectUtils.getMatchedKey(moduleApiMapping,e)})),Lyte.Component.registerHelper("fetchFileuploladicons",(function(e){if(e&&e.file_Name){if("teamdrive"===e.fromService||3===e.link_Docs)return"ico-teamDrive";var t=e.file_Name.split("."),r=t[t.length-1];r=r.toLowerCase();return showImageType(r)}})),Lyte.Component.registerHelper("canvasI18nforLookup",(function(e,t){return I18n.getMsg(e,t)})),Lyte.Component.registerHelper("meetingLiteral",(function(e){return"Events"===e.$activity_type?Crm.getModuleDisplayName(!1,!0,!0):e.Activity_Type})),Lyte.Component.registerHelper("isBlueprintEnable",(function(e,t){var r=Lyte.registeredMixins["crm-detailcanvas-utils"],n=r.isBluePrintTrans;if(clientPortalName&&n){if("stage"===e&&!r.showStage)return"dN";if("stage"===e&&r.showStage)return"";if("bluePrint"===e&&!r.showStage)return"";if("bluePrint"===e&&r.showStage)return"dN"}return n||r.showStage||!t.$process_flow||"stage"!==e?n||r.showStage||!t.$process_flow||"bluePrint"!==e?n&&"stage"===e?"dN":n||"stage"!==e?n&&"bluePrint"===e?"":n||"bluePrint"!==e?void 0:"dN":"":"":"dN"})),Lyte.Component.registerHelper("checkLRSectionsFld",(function(e){var t=Lyte.registeredMixins["crm-detailcanvas-utils"],r=!0;return t.revlayoutRuleShowFld.filter((function(t){t===e&&(r=!1)})),r})),Lyte.Component.registerHelper("autocompleteOptions",(function(e,t){e=e||store.peekRecord("field",t);var r=Lyte.registeredMixins["crux-textautocomplete-options"];return JSON.stringify(r.getTextAutocompleteOptions({column_name:e.column_name}))})),Lyte.Component.registerHelper("DummyComponentValueSetter",(function(e,t,r){var n="-";if(void 0!==e)if("userlookup"===t)n=e.name;else if("999"===r&&"object"==typeof e){n=[];for(var a=e.length,i=0;i<a;i++)n.push(e[i].Name);n=n.toString()}else n=e;return n})),Lyte.Component.registerHelper("canvasRules",(function(e,t,r){var n=$L(r);if(e&&e.length&&t){for(var a,i=e.length,o=[],s=[],l=0;l<i;l++){if((a=store.peekRecord("canvas_rule",e[l].id))&&(!a||"inactive"!==a.status))Lyte.registeredMixins["crm-create-mixin"].checkCriteriaMatchForCanvas(a.criteria,t,Lyte.registeredMixins["crm-create-mixin"])?o.push(a.zcid):s.push(a.zcid)}n.addClass(o.join(" ")).removeClass(s.join(" ")),Lyte.registeredMixins["crm-detailcanvas-utils"].expandcombinedcriteria(n)}})),Lyte.Component.registerHelper("getCanvasViewName",(function(e){return"TableView"===e?"crm.canvas.table.viewname":"CardView"===e?"crm.canvas.tile.viewname":"crm.canvas.custom.viewname"})),Lyte.Component.registerHelper("getSortOptionIcon",(function(e){var t="",r=store.peekRecord("field",e);return r&&r.module[0].custom_view.sort_by&&r.module[0].custom_view.sort_by.id===e&&(t="asc"===r.module[0].custom_view.sort_order?"sort_asc":"sort_desc"),t})),Lyte.Component.registerHelper("hasCanvasRowFilled",(function(e,t,r){return e*r<(t||renderingUtils.windowWidth)})),Lyte.Component.registerHelper("isCanvasActionAvail",(function(e,t,r){var n;return n=t?store.peekRecord("module",t):store.peekAll("module").filter((function(e){return e.api_name===r}))[0],Lyte.registeredMixins["crm-detailcanvas-utils"].isTeamModulehasAccess(n)})),Lyte.Component.registerHelper("showEditIconCanvasView",(function(e,t){var r=!0,n=!(!moduleRecordMapping[t]||"team_based"!==moduleRecordMapping[t].access_type);return e&&("Review in Progress"===e.$review||"Pending for Review"===e.$review||"Pending for ReReview"===e.$review||"merge_pending"===e.$approval_state||"approval_process_pending"===e.$approval_state||"read_only"===e.$sharing_permission&&!n?r=!1:"Rejected"===e.$review?(r=!1,Crm.userDetails.IS_ADMIN&&(r=!0)):e.Locked__s?r=!0:(e.$stop_processing||!e.$editable&&!n)&&(r=!1)),r})),Lyte.Component.registerHelper("getCustomButtonName",(function(e){var t=store.peekRecord("custom_button",e);return t&&t.name?$ESAPI.encoder().encodeForHTML(t.name):""})),Lyte.Component.registerHelper("getCustomLinkName",(function(e){var t=store.peekRecord("custom_link",e);return t&&t.name?$ESAPI.encoder().encodeForHTML(t.name):""})),Lyte.Component.registerHelper("canvasRuleToolTipMessage",(function(e,t,r,n,a){return!t.contains(r)&&t.length>=a?I18n.getMsg("crm.canvas.rules.component.limit",a):r.module.api_name===n&&!e.contains(r)&&e.length>=a?I18n.getMsg("crm.canvas.rules.component.view.limit",a):void 0})),Lyte.Component.registerHelper("isOriginalRecord",(function(e){return!(!e||!e.$)})),Lyte.Component.registerHelper("canvasListRecordToolTip",(function(e){return e&&e.$stop_processing?I18n.getMsg("crm.privacy.listview.consent.locked"):e.$locked_for_me&&!e.$editable?I18n.getMsg("crm.record.lock.record.locked"):e.Locked__s?e.$locked_for_me?I18n.getMsg("crm.record.lock.record.locked"):I18n.getMsg("crm.record.record.locked.other"):I18n.getMsg("crm.approvalProcess.label.waitingForApproval")})),Lyte.Component.registerHelper("isClipText",(function(e){return!(!e||"clipText"!==e)})),Lyte.Component.registerHelper("getFormattedPhoneNumber",(function(e,t,r){return e[r.api_name]?commonUtils.getFormatPhoneNo(e[r.api_name]):t})),Lyte.Component.registerHelper("getConnectedModuleName",(function(e,t){return e[t].module})),Lyte.Component.registerHelper("getConnectedModuleRecId",(function(e,t){var r=e[t].id,n=e[t].module;return store.peekRecord(moduleRecordMapping[n].id,r).id})),Lyte.Component.registerHelper("setPreviewDataZcqa",(function(e){return e.split(".")[0]})),Lyte.Component.registerHelper("getUrlforCanvasBG",(function(e,t){var r=crmBasePath+"/EntityImageAttach.do?actionName=getBackgroundImagesforCanvas&fileId="+e;return t&&(r=r+"&size="+t),r})),Lyte.Component.registerHelper("transitionDataHandler",(function(e,t){if(t&&Lyte&&Lyte.Router&&Lyte.Router.getRouteInstance()&&"crm.tab.module.custom-view.canvas"===Lyte.Router.getRouteInstance().transition.target){var r={cvid:Lyte.Router.getRouteInstance().parent.getDynamicParam(),recordNum:t.recnum,fromid:t.id};return"Calls"!==e&&"Events"!==e&&"Tasks"!==e||(r.fromActSubModuleListView=!0,r.fromActivityListView=!0),JSON.stringify(r)}})),Lyte.Component.registerHelper("setValueForComponent",(function(e,t,r){var n="",a=store.peekRecord("field",t),i=$L("crm-canvas-form")[0],o="form_create",s=Lyte.registeredMixins["crm-detailcanvas-utils"],l=s.isWizardView(),c=i&&i.component&&i.component.getData("module_name"),d=i&&i.component&&i.component.getData("oldRecord");if(i&&(o=i.component.getData("form_type")),(n=s.preProcessFieldValue(e,a))&&"datetime"===a.data_type)n=Utils.getDateTimeInUserFormat($L.moment(Lyte.Transform[a.data_type].serialize(n)).toDate(),!0);else if("date"===a.data_type&&("Invoices"===c&&"INVOICEDATE"===a.column_name||"PurchaseOrders"===c&&"PODATE"===a.column_name)&&"form_create"===o)n=Utils.getDateInUserDatePattern($L.moment().toDate()),e.$.set(a.api_name,n),d[a.api_name]=n;else if(555===a.ui_type)n=e[a.api_name]?e[a.api_name]:[];else if(444===a.ui_type){var m="",u=n&&n.length;if(u&&n[0]&&n[0][a.multiselectlookup.connectedlookup_apiname]&&(m=1===u?n[0][a.multiselectlookup.connectedlookup_apiname].name:2===u?n[0][a.multiselectlookup.connectedlookup_apiname].name+", "+n[1][a.multiselectlookup.connectedlookup_apiname].name:n[0][a.multiselectlookup.connectedlookup_apiname].name+", "+n[1][a.multiselectlookup.connectedlookup_apiname].name+".. &More"),l)(M=$L("crm-create-layout")[0].component.shelvedData)&&M[a.api_name]&&(m=M[a.api_name].value);n=m}else if("boolean"===a.data_type&&301===a.ui_type)n=""!==n&&void 0!==n?n:!0===a.default_value,e.id&&e.$&&(e.$.set(a.api_name,n),d[a.api_name]=n);else if("picklist"===a.data_type){var p;if("Stage"===a.api_name&&(p=Lyte.registeredMixins["crm-canvas-core-construct-component"].stageValues(a,e,r)).length&&"form_clone"!==o&&"form_edit"!==o&&(n=p[0].display_value),n||!a.default_value||"form_create"!==o&&"form_clone"!==o&&"FormView"!==o)if(39===a.ui_type){var g=store.peekRecord("user",Crm.userDetails.USER_ID);n=n||(g&&g.Currency?g.Currency:Crm.userDetails.BASE_CURRENCY)}else if(n||26!==a.ui_type)if(n||"Forecast_Category__s"!==a.api_name)n||(n=a.pick_list_values&&a.pick_list_values[0]?a.pick_list_values[0].display_value:void 0);else{var _,v,f;if(e&&e.Stage)_=e.Stage;else{var y=store.peekAll("field").filter((function(e){if("Stage"===e.api_name)return e}))[0],C=Lyte.registeredMixins["crm-canvas-core-construct-component"].stageValues(y,e,r);_=C[0].display_value}v=Lyte.registeredMixins["crm-canvas-view-rules"].parentChildDependencies.Stage,Object.keys(v).map(function(e){f=Lyte.registeredMixins["crm-canvas-view-rules"].parentChildDependencies.Stage[e][_]}.bind(this)),n=(p=f)[0].display_value}else n=p[0].display_value;else n=a.default_value;e.id&&e.$&&n&&(e.$.set(a.api_name,n),d[a.api_name]=n)}else if("Probability"===a.api_name&&"Potentials"===a.module[0].module_name){var L=store.peekAll("field").filter((function(e){return"Stage"===e.api_name}))[0],h=Lyte.registeredMixins["crm-canvas-core-construct-component"].stageValues(L,e,r);if(h){var k=L.pick_list_values.filter((function(e){return e.display_value===h[0].display_value}))[0];n=n||k.probability}else L&&L.pick_list_values&&(n=n||L.pick_list_values[0].probability);e=e.id&&e.$?e.$.set(a.api_name,n):e,d[a.api_name]=n}else if(36===a.ui_type&&n){var R=a?a.decimal_place:void 0;n=parseFloat(Number(n).toFixed(R)),isNaN(Number(n))||"Potentials"!==c||"EXPECTEDREVENUE"===a.column_name||(e.$.set(a.api_name,n),d[a.api_name]=n)}else if(40===a.ui_type)n=parseFloat(e.Exchange_Rate);else if("multiuserlookup"===a.data_type&&"form_edit"===o&&l){var b=[],M=$L("crm-create-layout")[0].component.shelvedData,I=a.multiuserlookup.connectedlookup_apiname;if(M&&M[a.api_name])M[a.api_name].usersData&&M[a.api_name].usersData.length&&(M[a.api_name].usersData.forEach((function(e){var t={name:e.full_name,id:e.id};b.push({[I]:t})})),n=JSON.stringify({users:b}))}else if("multiselectpicklist"===a.data_type)l||n.length||!a.default_value||"form_create"!==o&&"form_clone"!==o&&"FormView"!==o?!n&&l&&(n=a.default_value||"[]"):n.push(a.default_value),l||(e=e.id&&e.$?e.$.set(a.api_name,n.join("; ")):e,d[a.api_name]=n.join("; "));else if(8===a.ui_type){var D={},$=store.peekRecord("user",Crm.userDetails.USER_ID);D.id=Crm.userDetails.USER_ID,D.name=$.full_name,n=n||D,e.$.set("Owner",n)}return n})),Lyte.Component.registerHelper("setPicklistValues",(function(e,t,r){var n,a=store.peekRecord("field",t);if("Stage"===a.api_name)n=Lyte.registeredMixins["crm-canvas-core-construct-component"].stageValues(a,e,r);else if(a.canvasDependencyMap&&a.canvasDependencyMap.length>0){if(n=a.canvasDependencyMap,e[a.api_name]&&!a.canvasDependencyMap.find((function(t){return t.display_value===e[a.api_name]}))){var i=a.pick_list_values.find((function(t){return t.display_value===e[a.api_name]}));i&&a.canvasDependencyMap.push(i)}}else n=a[r]?a[r].pick_list_values:a.pick_list_values;return JSON.stringify(n)})),Lyte.Component.registerHelper("setFromType",(function(){var e=$L("crm-canvas-form")[0],t="form_create";return e&&(t=e.component.getData("form_type")),t})),Lyte.Component.registerHelper("setCurrencyCode",(function(e){var t=Crm.userDetails.CURRENCY_DETAILS[Crm.userDetails.BASE_CURRENCY]?Crm.userDetails.CURRENCY_DETAILS[Crm.userDetails.BASE_CURRENCY].key:Crm.userDetails.defaultCurrencyISOCode;return e&&e.Currency&&Crm.userDetails.CURRENCY_DETAILS[e.Currency]&&(t=Crm.userDetails.CURRENCY_DETAILS[e.Currency].key),Crm.userDetails.IS_MULTI_CURRENCY_ENABLED||(t=""),t})),Lyte.Component.registerHelper("getSEmodulenameByApiname",(function(e){var t=e;return store.peekAll("module").forEach((function(r){r.api_name==e&&(t=r.module_name)})),t})),Lyte.Component.registerHelper("getCreateButtonDisablePermission",(function(e){return"save"===e.getAttribute("lt-prop-name")||"saveAndNew"===e.getAttribute("lt-prop-name")||e.getAttribute("lt-prop-name"),!1})),Lyte.Component.registerHelper("setSeletedId",(function(e,t){var r=$("crm-canvas-form")[0].component,n=r.getData("form_type"),a=(e=r.getData("record"),"");if("form_clone"===n){var i=store.peekRecord("field",t),o=i.api_name,s=i.multiselectlookup.connectedlookup_apiname;void 0!==e[o]&&e[o][0]&&e[o][0][s]&&e[o].length<10?e[o].filter((function(t,r){a+=t[s].id+(e[o].length===++r?"":",")})):void 0!==e[o]&&e[o][0]&&e[o][0][s]&&store.triggerAction(r.getData("moduleObj.id"),"fetchrelatedList",{entityid:r.getData("entityrecordData.id"),relapiname:i.multiselectlookup.api_name}).then(function(e){e.data&&e.data.length>100?(Lyte.Router.getRouteInstance().currentModel.hasMorethan100MxNRecords=!0,!Lyte.Router.getRouteInstance().currentModel.msFldsHasMorethan100MxNRecords.includes(t)&&Lyte.Router.getRouteInstance().currentModel.msFldsHasMorethan100MxNRecords.push(t)):e.data.filter((function(t,r){a+=t[s].id+(e.data.length===++r?"":",")}))}.bind(this))}return a})),Lyte.Component.registerHelper("canvasComponentRegisterHelper",(function(e){var t=Lyte.registeredMixins["crm-canvas-common-utils"],r=store.peekAll("canvasview").filter((function(t){return t.map&&t.map[e]})),n=r[0]&&r[0].map?r[0].map[e]:void 0;return t.viewPortObj.viewPortTriggered++,{viewIn:{afterAppend:function(){if(t.viewPortObj.viewPortResolved++,t.viewPortObj.viewPortTriggered===t.viewPortObj.viewPortResolved){var e=$L("crm-detailview-canvas");if((e=e&&e[1]||e[0])&&!e.getData("isPageLoaded"))e.querySelector(".zc-page-component")&&e.setData("isPageLoaded",!0),e.component.onPageLoaded.bind(e.component)()}}},lazy:!0,viewOut:{beforeRemove:function({resolve:r}){n&&t.renderViewPort(e,n,canvasOutput,r)}}}})),Lyte.Component.registerHelper("getLabelForField",(function(e,t,r){return Lyte.registeredMixins["crm-detailcanvas-utils"].constructFldName(e,t,r)})),Lyte.Component.registerHelper("getValueForField",(function(e,t,r){return Lyte.registeredMixins["crm-detailcanvas-utils"].constructFldValue(e,r,t)})),Lyte.Component.registerHelper("populateRightPanel",(function(e,t,r){var n=Lyte.registeredMixins["crm-detailcanvas-utils"].right_panel_info;switch((!n.record||n&&n.record!==e)&&((n={}).record=e,Lyte.registeredMixins["crm-detailview-parser"].formRightPanelData(n,t),Lyte.registeredMixins["crm-detailcanvas-utils"].right_panel_info=n),n=n.right_panel_info,r){case"entity_name":return n.record_info.entity_name;case"show_info":return n.show_info;case"rp_records":return n.rp_records;case"record_info":return n.record_info;case"right_panel_info":return n}})),Lyte.Component.registerHelper("getFldVsColumnMap",(function(e){var t=Lyte.registeredMixins["crm-detailcanvas-utils"].getFldVsColumnMap(e),r={};return r.fieldColumnNameMap=t,r})),Lyte.Component.registerHelper("getPKValuesForServiceDuration",(function(e){var t=$L("crm-detailview-canvas")[0];return t&&JSON.stringify(t.component.executeMethod("setDurationOptions",e))})),Lyte.Component.registerHelper("getMeetingStatusFldValue",(function(e){return Lyte.registeredMixins["crm-detailcanvas-utils"].getMeetingStatus(e,"view")})),Lyte.Component.registerHelper("getLookupModuleForWhoOrWhatId",(function(e,t,r){var n=Lyte.registeredMixins["crm-detailcanvas-utils"].getValForWhatOrWhoIdFlds(e,t);return"lookupModule"===r?n&&JSON.parse(n).module?moduleApiVsNameMapping[JSON.parse(n).module.api_name]:void 0:"dataId"===r?n&&JSON.parse(n).id:void 0})),Lyte.Component.registerHelper("setImageUploadToolTip",(function(e,t){var r=store.peekRecord("field",t),n=null;return null!==e&&e[r.api_name]&&(n=Lyte.registeredMixins["crm-uploadfields-mixin"].setTooltipValue(e[r.api_name])),n})),Lyte.Component.registerHelper("setClassIcon",(function(e,t){var r=store.peekRecord("field",t);if(e[r.api_name]){var n=e[r.api_name].module.api_name;return Lyte.registeredMixins["crm-canvas-core-construct-component"].getModuleIcon(n)}})),Lyte.Component.registerHelper("getDynamicParamForMultiModule",(function(e,t){var r=store.peekRecord("field",t);if(e[r.api_name]){var n=e[r.api_name].module.id;return[store.peekRecord("module",n).module_name,e[r.api_name].id]}})),Lyte.Component.registerHelper("addConnectedRecordNonEmptyClass",(function(e,t){var r=store.peekRecord("field",t);return e[r.api_name]&&e[r.api_name].name&&e[r.api_name].id?"zc_nonempty":""}));
