var CrmPlusImpl={moduleData:" ",searchFilterModules:"",crmPlusTheme:"",search:{showAutoSuggestView:function(e){var t=$L("crm-global-search-input")[0],r=$L("crm-global-search-identifiers")[0];if(!t||t.component.data.isPrimarySearch)if(Crm.userDetails.bundleRedirectObj&&Crm.userDetails.isNewGlobalSearch){var a=$L("crm-global-search-history")[0].component;a.setData("canShow",!1);var n=e.replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi," "),o=n.trim();if(o=o.replace(/[A-Z a-z 0-9 . / ]*/,""),(r=r.component).setData("crmPlusValue",e),o||e.trim().length>2&&0!==e.trim().length)(e={autocomplete:!0}).searchword=n,commonUtils.showHideLoadingDiv(!0),store.findAll("global-search",e,!1,!1).then((function(e){commonUtils.showHideLoadingDiv(!1),r.setData("searchResultHeight","300");var t=e.data,a=[],n={},o=[];for(var i in t)if(t.hasOwnProperty(i)){var s=t[i],c=s.module||s.$setype;if("Potentials"!==s.$setype&&"Deals"!==s.$setype||!s.Amount||(s.Amount=currencyUtils.returnValueInDefaultCurrency(void 0,s.Amount)),n[c]&&n[c].length<10){n[c].push(s)}else{var l=[];l.push(s),n[c]=l}}let u=r.getDataFromModuleRecordMapping().allModulesArrayList.filter((e=>"Notes"!==e.name));u.forEach((function(e){let t=e.module_name;if(n.hasOwnProperty(t)){a=n[t];var r={};r[t]=a,o.push(r)}})),r.setData("searchStarted",!0),r.setData("showResultsTrigger",!0),o.length>0?r.setData({primarySearchResults:o,isResultsEmpty:!1}):(r.setData("isResultsEmpty",!0),r.setData("primarySearchResults",[]))}));else a.setData("canShow",!1),r&&r.setData({isResultsEmpty:!1,primarySearchResults:[],searchStarted:!1,showResultsTrigger:!1})}else{$("#gsearchTextBox")[0]?CrmPlusImpl.performSearchAction(e):(renderingUtils.triggerEvent("click",$("#topbandSearchIcon")),setTimeout((function(){CrmPlusImpl.performSearchAction(e)}),0))}else r.component.setData("crmPlusValue",e)},hideAutoSuggestView:function(){if(Crm.userDetails.bundleRedirectObj&&Crm.userDetails.isNewGlobalSearch){var e=$L("crm-global-search-history")[0];e&&(e.setData("canShow",!1),e.setData("isSecondaryPageOpen",!1));var t=$L("crm-global-search-identifiers")[0];t&&t.setData({isResultsEmpty:!1,primarySearchResults:[],searchStarted:!1,showResultsTrigger:!1})}else $(".primarySearchList").hide()},showAutoSuggestPopupOnEmptyInput:function(e){if(Crm.userDetails.bundleRedirectObj&&Crm.userDetails.isNewGlobalSearch){const a=$L("crm-global-search-input")[0];a&&a.component.setData("isPrimarySearch",!0);var t=document.querySelector("#cgsPlusPrimarySearch");if(t){t.style.left===e.left&&($L("crm-global-search-history")[0].component.setData("canShow",!0),$L("crm-global-search-input")[0].setData("isPrimarySearch",!0));var r=$L("crm-global-search-identifiers")[0];r&&r.setData({isResultsEmpty:!1,primarySearchResults:[],searchStarted:!1,showResultsTrigger:!1})}else Lyte.injectResources(networkUtils.returnDependencyFiles(["crm-global-search.js"],ResourceConstants.CRMClient),void 0,(function(){var t={},r="<div id='cgsPlusPrimarySearch' style='left:"+e.left+";top:"+e.top+"; width:"+e.width+"; '></div>";$("body").append(r),t.filters=String('{"comparator":"equals","field":{"api_name":"source"},"value":"search"}'),document.querySelector(".gsLeastChar")&&$(".gsLeastChar").hide(),store.findAll("search-history",t,!1,!1).then((function(e){Lyte.Component.render("crm-global-search-history",{search_history:e.search_history,canShow:!0},"#cgsPlusPrimarySearch")}))}))}}},performSearchAction:function(e){$("#gsearchTextBox").val(e);var t=$("input#gsearchTextBox");null!=t.data("ui-autocomplete")&&(t.autocomplete("enable"),t.autocomplete("search",e),t.autocomplete("widget").addClass("crmplusMainSearch"))},setup:{show:function(){"undefined"==typeof crmSetup?networkUtils.loadFeatureScripts(["zohocrm_setup.js"],(function(){Lyte.Router.getRouteInstance().transitionTo("crm.settings.index")})):Lyte.Router.getRouteInstance().transitionTo("crm.settings.index")},hide:function(e){if(featuresAvailable.NEXTGENUI_ENABLED){var t=$L("crm-left-menu")[0].component,r=t.getData("prevSelectedMenu");r||(r="modules"),t.actions.openSelectedMenu(r,!1,!0)}else" "!=e&&null!=e||(e="Home"),Lyte.Router.getRouteInstance().transitionTo("crm.tab.module",e)}},handleUIChange:function(){$("#mainMenuTabDiv").addClass("mainMenuTabDiv"),$("#ThemesContainer").hide(),$("body").addClass("zcrmInsideCRMPlus")},selectModule:function(e){$("#crmAddEmailPop").length||(featuresAvailable.NEXTGENUI_ENABLED?$L("crm-left-menu")[0].component.actions.openSelectedMenu(e,!1,!0):($L("crm-tab .lyteItem[data-zcqa='tab_"+e+"']").e[0].click(),crmplusImplTriggerActions("selectEntity",["module",e])))},handleDraftMailIcon:function(e){CrmPlusImpl.trigger("sendCommonUIElements",["chatBarNotification",{zia:!0,reminder:!0,recent_items:!0,stickynotes:!0,visitors_online:!0,ziachatbot:!0,mailIcon:e}])},selectDepartment:function(e){if(featuresAvailable.TEAMSPACE_ENABLED){$L("crm-left-menu-teamspace")[0].component.switchTeamspace(e,!0)}else{e="alltabgroups"===e?"0":e;var t=Crm.getCrmBasePath()+"/CustomizeTabGroup.do",r="action=updateMyTabGroup&tabGroupId="+e+"&"+csrfParamName+"="+encodeURIComponent(csrfToken);(new crmRequestPool).initiate({action:t,type:"POST",data:r,success:function(){Utils.windowLocationReload()}})}},showCreateDepartmentView:function(e){var t=featuresAvailable.TEAMSPACE_ENABLED,r=t?$L("crm-left-menu-teamspace")[0].component:null;e?t?r.executeMethod("teamspaceDropdownOnclickMethod","manageTeamspace",null,r):showCustomizePopup("tabGroupList","popup"):t?r.executeMethod("teamspaceDropdownOnclickMethod","newTeamspace",null,r):showCustomizePopup("createTabGroup","create")},showCreateCustomModuleView:function(){"undefined"==typeof crmSetup?networkUtils.loadFeatureScripts(["zohocrm_setup.js"],(function(){Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.modules.index-modules.create-module")})):Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.modules.index-modules.create-module")},selectOption:function(e){if("whatsNew"==e){var t=RebrandLinkUtil.getProperty("COB_WTASNEWLINK");networkUtils.openUrl(t,null,null)}else if("setup"==e)"undefined"==typeof crmSetup?networkUtils.loadFeatureScripts(["zohocrm_setup.js"],(function(){Lyte.Router.getRouteInstance().transitionTo("crm.settings.index")})):Lyte.Router.getRouteInstance().transitionTo("crm.settings.index");else if("OtherCRMOrganizationsLink"==e)Crm.openOrganizationsPageInNewTab("crmplus_profile_menu");else if("oldui"===e){(r=$L("crm-profile-menu"))[0]&&r[0].component&&r[0].component.executeMethod("enableOrDisableNewUIMethod",r[0].component)}else if("feedback"===e){var r;(r=$L("crm-profile-menu"))[0]&&r[0].component&&r[0].component.actions.openFeedback()}},showNotificationDialog:function(e,t){if(!$("#crmAddEmailPop").length)switch(LytePopup.components.length>0&&LytePopup.closePopup(),t){case"general":crmNTCGlobal.renderGlobalNotification();break;case"calendar":crmCalendar.crmCalposition=e,document.getElementById("leftPanelCalendarP").ltProp({show:!0,wrapperClass:"popCal crmTopMenuCalender"}),hideMenu(event);break;case"gamescope":crmplusImplTriggerActions("hideTopBar"),GameLoad.loadMainPage();break;case"marketplace":Crm.client_tracking("Market Place Top Band Icon Click"),Lyte.Router.transitionTo("crm.settings.section.extensions.all-extensions");break;case"salesmotivator":CrmPlusImpl.trigger("setNotificationCount",["salesmotivator",0,!1,!1]),Crm.isSMNotificationPushedToCrmPlus?(Crm.isSMNotificationPushedToCrmPlus=!1,networkUtils.openUrl(Crm.getCrmBasePath()+"/gamification/home?notification=true")):networkUtils.openUrl(Crm.getCrmBasePath()+"/gamification/home");break;case"ziachatbot":Lyte.injectResources(networkUtils.returnDependencyFiles(["crm-chatbot-helper.js"],ResourceConstants.CRMClient),void 0,(function(){Lyte.registeredMixins["crm-chatbot-helper"].constructChatbotDiv()}));break;case"mailbox":showRecentMails();break;case"zia":Lyte.injectResources(networkUtils.returnDependencyFiles(["crm-zianotification-mixin.js"],ResourceConstants.CRMClient),void 0,(function(){Lyte.registeredMixins["crm-zianotification-helper"].getZiaNotificationSummary(event,this)}));break;case"stickynotes":Lyte.injectResources(networkUtils.returnDependencyFiles(["crm-sticky-mixin.js"],ResourceConstants.CRMClient),void 0,(function(){Lyte.Mixin.get("crm-sticky-mixin").stickyRenderer()}));break;case"telephonyWidget":WidgetHandler.Telephony.toggle();break;case"mailIcon":EmailComposeUtil.restoreComposePopup(),CrmPlusImpl.handleDraftMailIcon(!1);break;case"recent_items":refreshRecentItem1(),slidelt();break;case"reminder":Activities.showHideRemainder();break;case"visitors_online":CrmTracking.maximizePop();break;case"commands":Lyte.registeredMixins["crm-cscript-global-mixin"].toggle_command_palette()}},hideNotificationDialog:function(e){if(!$("#crmAddEmailPop").length)switch(e){case"general":crmNTCGlobal.closeGlobalNotifications();break;case"mailbox":var t=$("#recentMailsDiv");t.is(":visible")&&t.hide();break;case"calendar":LytePopup.components.length>0&&LytePopup.closePopup(),document.getElementById("leftPanelCalendarP").ltProp("show",!1);var r=$("#leftPanelCalendarP");r.is(":visible")&&r.hide();break;case"zia":Lyte.injectResources(networkUtils.returnDependencyFiles(["crm-zianotification-mixin.js"],ResourceConstants.CRMClient),void 0,(function(){Lyte.registeredMixins["crm-zianotification-helper"].hideDiNotification()}));break;case"ziachatbot":Lyte.injectResources(networkUtils.returnDependencyFiles(["crm-chatbot-helper.js"],ResourceConstants.CRMClient),void 0,(function(){Lyte.registeredMixins["crm-chatbot-helper"].constructChatbotDiv()}));break;case"stickynotes":document.querySelector("crm-sticky-container").component.executeMethod("closeStickies");break;case"recent_items":refreshRecentItem1(),slidelt();break;case"reminder":Activities.showHideRemainder();break;case"visitors_online":CrmTracking.maximizePop()}},showAddRecordView:function(e){$("#crmAddEmailPop").length||("Events"==e?Events.globalCreate(event,"quickcreate"):"Calls"==e?qCreateCall.createQCForm(event,"crmplus-qc"):"CustomModule5006"==e||"CustomModule5007"==e?Lyte.Router.getRouteInstance().transitionTo("crm.tab.module.create",e):"Appointments"==e?Events.globalCreate(event,"listview","Appointments"):Lyte.Router.getRouteInstance().transitionTo("crm.tab.module.create",e))},getDepartmentList:function(){var e=[];if(featuresAvailable.TEAMSPACE_ENABLED){var t=$L("crm-left-menu-teamspace")[0].component.getData("teamspace");if(t&&t.length>0){for(var r=[],a=t.length,n=0;n<a;n++)r.push({key:t[n].id,label:t[n].name});crmplusImplTriggerActions("modifyUI",["department",{list:r}])}}else{var o=Crm.getCrmBasePath()+"/CustomizeTabGroup.do?action=showTabList";(new crmRequestPool).initiate({action:o,type:"GET",success:function(t){for(var r=t.length,a=0;a<r;a++){(n={}).key=t[a].tabGroupId,n.label=t[a].tabGroupName,e.push(n)}var n;(n={key:"alltabgroups"}).label=I18n.getMsg("crm.tabgroup.label.AllAccessibleTabs"),e.push(n),crmplusImplTriggerActions("modifyUI",["department",{list:e}])}})}},setBundleTheme:function(e){""!==CrmPlusImpl.crmPlusTheme&&Lyte.registeredMixins["crm-left-menu-util"].applyThemeForCRMPlusBundle(e,CrmPlusImpl.crmPlusTheme),CrmPlusImpl.crmPlusTheme=e},getSearchFilters:function(){var e=Crm.getCrmBasePath()+"/CustomizeTabGroup.do?action=getSearchModulelist&setDefaultFilter=false";(new crmRequestPool).initiate({action:e,type:"GET",success:function(e){crmplusImplTriggerActions("setSearchFilters",[e])}})},getCurrentDefaultFilters:function(){var e=Crm.getCrmBasePath()+"/CustomizeTabGroup.do?action=getSearchModulelist&setDefaultFilter=true";(new crmRequestPool).initiate({action:e,type:"GET",success:function(e){crmplusImplTriggerActions("setDefaultFilters",[e])}})},triggerSearch:function(e){var t=$L("crm-global-search-input")[0];if(t&&Crm.userDetails.isNewGlobalSearch)if(null!==e.searchString&&""!==e.searchString&&$L("crm-global-search-identifiers")[0].component.setData("crmPlusValue",e.searchString),t.component.data.isPrimarySearch)$L("crm-global-search-identifiers")[0].component.actions.changeSearchScreen();else{t.setData("searchInputText",e.searchString);const r=$L("crm-global-search-refine")[0].component;r.actions.clearCommonFilter.call(r),$L("crm-global-search-identifiers")[0].component.renderSecondaryResults()}else{var r=e.searchString;if("global-search"!==Lyte.Router.getRouteInstance().routeName||200===Lyte.Router.getRouteInstance().transition.state||void 0===Lyte.Router.getRouteInstance().getQueryParams().searchword||Lyte.Router.getRouteInstance().getQueryParams().searchword!==r){var a=e.filter,n=a&&a.module;null!=n&&" "!=n||(n="AllEntities");for(var o="",i=n.length,s=0;s<i;s++)o=0==s?n[s]:o+","+n[s];CrmPlusImpl.searchFilterModules=n,crmNavig.removeFeaturCacheObj("gsearch"),Lyte.Router.getRouteInstance().transitionTo("crm.global-search",{searchword:r,sModules:o})}}},closeSearchView:function(){adSearchClose(),null!=$("input#gsearchTextBox").data("ui-autocomplete")&&$(".primarySearchList").hide()},showDialog:function(e){"phonelogin"==e?"AWSlily"==CTIAPI.CTI.ctiname&&lilyUINotify.lily_config_show_login():"phonepreferences"==e&&("AWSlily"==CTIAPI.CTI.ctiname?lilyUINotify.showPreferences():"twilio"==CTIAPI.CTI.ctiname&&TwilioConf.showPreferences())},updatePhoneAgentStatus:function(e){if(lilyAgentBasicDetails.statusKeyFnsMap.hasOwnProperty(e)){var t=lilyAgentBasicDetails.statusKeyFnsMap[e];lilyActions.setCurrentState(t)}},showUsersTab:function(e){"setup"===e&&Lyte.Router.getRouteInstance("crm.settings.section.users").refresh({refreshTemplate:!0})},profilepanel:{select_appsAddonsLink:function(e){var t;"android"===e?t="CRM_ANDROID_APP":"ios"===e&&(t="CRM_IOS_APP");var r=RebrandLinkUtil.getProperty(t);""!==r&&networkUtils.openUrl(r,"_blank","")}},showIntegConfiguration:function(e){Lyte.Router.getRouteInstance().refresh()},getOtherPortalsList:function(){let e={};store.findAll("organization",{include:"info",from:"crm_org_profile"}).then((t=>{e.hasManageOption=t.length>1,"undefined"==typeof Crm||void 0===t.$||e.hasManageOption||(e.hasManageOption=t.$.meta.confirmed_user&&(["zohotest.com","zohocorp.com"].includes($("<div></div>").html(Crm.userDetails.EMAIL).text().split("@")[1])||t.$.meta.admin_of_any_crm)),(new crmRequestPool).initiate({action:"/crm/getbadge.acs",type:"POST",headers:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8"},data:"nfchannel=UNS&crmcsrfparam="+csrfToken,success:function(r){let a=r[0].objString.uns;e.list=t.map((e=>({key:e.domain_name,label:e.name,is_selected:e.id===crmZgid,portal_image_url:RebrandLinkUtil.getProperties().CRMURL_HTTPS+(e.company_logo_id&&e.company_logo_id.length>0?"/crm/viewInLineImage?fileContent="+e.company_logo_id:networkUtils.getImageUrl("org_ph.svg",ResourceConstants.CRMOrganization)),notification_count:a["UNS@"+e.id]?a["UNS@"+e.id]:0,portalUrl:e.web_url}))),CrmPlusImpl.trigger("modifyUI",["otherPortals",e])},error:function(e){murphy.error(e)}})}))},openPortal:function(e){const t="/crm/"+e+"/tab/Home/begin";networkUtils.openUrl(t)},openManageOrgPage:function(){networkUtils.openUrl("/organizations")},showDevModePopup:function(){networkUtils.openUrl("https://crmbeta.zoho.com"+window.location.pathname),CrmPlusImpl.trigger("hideDevModePopup")},isLoadedInCrmplus:function(){return!("undefined"==typeof CrmPlusLib||!CrmPlusLib.isLoadedInCrmplusFrame)},trigger:function(e,t){if("undefined"!=typeof CrmPlusLib)if(void 0!==(a=CrmPlusLib[e])&&"function"==typeof a)a.apply(CrmPlusLib,t);else if("undefined"!=typeof CrmPlusLibUtil){var r="CrmPlusLib."+e;if(CrmPlusLibUtil.callByMethodName)CrmPlusLibUtil.callByMethodName(r,t);else if(CrmPlusLibUtil.stringToFunctionReference){var a;(a=CrmPlusLibUtil.stringToFunctionReference(r))&&"function"==typeof a&&a.apply(null,t)}}}};CrmPlusImpl.serviceView={show:function(e,t){if("extensionView"==e)"undefined"==typeof crmSetup?networkUtils.loadFeatureScripts(["zohocrm_setup.js"],(function(){Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.extensions.zoho-extensions.finance-suite").data={isCrmPlusFrame:!0,dKey:e,dParams:t}})):Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.extensions.zoho-extensions.finance-suite").data={isCrmPlusFrame:!0,dKey:e,dParams:t};else if("analytic_dashboard"==e){var r=newDashbordsEnabled?"crm.tab.newDashboards.index.view":"crm.tab.dashboards.view";"undefined"==typeof CrmAnalytics&&networkUtils.loadFeatureScripts(["zohocrm_analytics.js",networkUtils.getI18nJSUrl("dashboard")],(function(){CrmAnalytics.init()}));var a=$("#homePageHeader");if(0===a.length||newDashbordsEnabled){var n=Lyte.Router.getRouteInstance();if(!((newDashbordsEnabled&&a.length>0||!newDashbordsEnabled)&&n&&n.transition&&n.transition.info.route===r&&n.transition.info.dynamicParams&&n.transition.info.dynamicParams[0]===t.key))return Lyte.Router.transitionTo({route:r,dynamicParams:[t.key]});n.refresh()}else CrmAnalytics.loadComponents(event,this,{id:t.key})}else if("dashboard_creation"==e){if(newDashbordsEnabled)return Lyte.Router.transitionTo({route:"crm.tab.newDashboards.create"});"undefined"==typeof CrmAnalytics?networkUtils.loadFeatureScripts(["zohocrm_analytics.js",networkUtils.getI18nJSUrl("dashboard")],(function(){CrmAnalytics.init(),CrmAnalytics.createNewDashboard()})):(CrmAnalytics.init(),CrmAnalytics.createNewDashboard())}},load:function(e){Lyte.Router.transitionTo(Lyte.Router.getRoute(crmHistory.getNewURL(e)))}},CrmPlusImpl.handleKeyBoardShortCut=function(e){var t=new e.constructor(e.type,e);(e.shiftKey&&"Equal"!==e.code||"NumpadAdd"!==e.code)&&"Slash"!==e.code&&"KeyU"!==e.code&&document.querySelector("body").dispatchEvent(t)};