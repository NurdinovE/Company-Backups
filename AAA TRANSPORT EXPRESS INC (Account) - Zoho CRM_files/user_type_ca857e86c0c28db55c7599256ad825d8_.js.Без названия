if(store.registerModel("user_type",{id:Lyte.attr("string"),name:Lyte.attr("string"),personality_module:Lyte.attr("object"),modules:Lyte.hasMany("clientPortalModulePermissions",{serialize:"partial",deepNest:!0}),active:Lyte.attr("boolean"),no_of_users:Lyte.attr("number"),created_time:Lyte.attr("string"),default:Lyte.attr("boolean"),modified_time:Lyte.attr("string"),modified_by:Lyte.attr("object"),created_by:Lyte.attr("object"),isRecordModified:Lyte.attr("boolean"),layouts:Lyte.hasMany("clientPortalLayoutPermissions"),fields:Lyte.hasMany("clientPortalFieldPermissions"),criteria_value_metadata:Lyte.attr("array"),invitation_field:Lyte.attr("object"),associations:Lyte.hasMany("association"),wizard:Lyte.hasMany("wizard"),didLoad:function(){var e=this;if(e.created_by){var t=store.peekRecord("user",e.created_by.id);if(t)e.createdByImageSrc="https://"+RebrandLinkUtil.getProperty("CONTACTS_URL")+"/file?ID="+t.zuid+"&fs=thumb",e.created_by.id===e.modified_by.id&&e.$.set("modifiedByImageSrc","https://"+RebrandLinkUtil.getProperty("CONTACTS_URL")+"/file?ID="+t.zuid+"&fs=thumb");else store.findRecord("user",e.created_by.id).then((function(t){e.$.set("createdByImageSrc","https://"+RebrandLinkUtil.getProperty("CONTACTS_URL")+"/file?ID="+t[0].zuid+"&fs=thumb"),e.created_by.id===e.modified_by.id&&e.$.set("modifiedByImageSrc","https://"+RebrandLinkUtil.getProperty("CONTACTS_URL")+"/file?ID="+t[0].zuid+"&fs=thumb")}));var i=store.peekRecord("user",e.modified_by.id);if(e.created_by.id===e.modified_by.id||i)i&&e.$.set("modifiedByImageSrc","https://"+RebrandLinkUtil.getProperty("CONTACTS_URL")+"/file?ID="+i.zuid+"&fs=thumb");else store.findRecord("user",e.modified_by.id).then((function(t){e.$.set("modifiedByImageSrc","https://"+RebrandLinkUtil.getProperty("CONTACTS_URL")+"/file?ID="+t[0].zuid+"&fs=thumb")}))}}}),void 0===CLIENT_PORTAL_NAME)var CLIENT_PORTAL_NAME="dummyValue";store.registerAdapter("user_type",{namespace:"crm/ver$ion/settings/portals/"+CLIENT_PORTAL_NAME,buildURL:function(e,t,i,r,a){return a=(a=a.replace("/ver$ion/",Crm.userDetails.PORTALS_CRITERIA_BASED_AUTHORIZATION_ENABLED?"/v8/":"/v6/")).replace("dummyValue",Crm.userDetails.CLIENT_PORTAL_NAME),"deleteRecord"===t?a=a.replace("v2.2","v6"):"findRecord"===t&&Crm.userDetails.PORTALS_CRITERIA_BASED_AUTHORIZATION_ENABLED?i.include_inner_details="$..personality_module.plural_label,$..modules.plural_label,$..layouts.display_label,$..custom_views.display_label,$..canvas_views.display_label,$..filters.display_label,$..invitation_field.ui_type,$..invitation_field.display_label":"findAll"===t&&Crm.userDetails.PORTALS_CRITERIA_BASED_AUTHORIZATION_ENABLED&&(i.include_inner_details="$..personality_module.plural_label,$..invitation_field.ui_type,$..invitation_field.display_label"),a},processRequest:function(e,t,i){this.payLoad=i},parseRequest:function(e,t,i){i.payLoad=this.payLoad},methodForRequest:function(e,t,i,r){return"PATCH"===e?"PUT":("DELETE"===e&&r&&r.transfer_To&&(i.transfer_To=r.transfer_To),e)},reloadAll:function(e,t){return!t||!t.cache}}),store.registerSerializer("user_type",{normalizeResponse:function(e,t,i,r){return"updateRecord"===t&&i.user_type&&i.user_type[0]&&"SUCCESS"===i.user_type[0].code?i.user_type=i.user_type[0]:"createRecord"===t&&i.user_type&&i.user_type[0]&&"SUCCESS"===i.user_type[0].code?(i.user_type=i.user_type[0],i.user_type.oldId=r):"findRecord"===t&&i.criteria_value_metadata&&i.criteria_value_metadata[0]&&i.user_type&&i.user_type[0]&&(i.user_type[0].criteria_value_metadata=i.criteria_value_metadata),i},normalize:function(e,t,i){if("updateRecord"!==t&&"createRecord"!==t||"SUCCESS"!==i.code||(i.id=i.details.id),i.hasOwnProperty("created_time")&&(i.created_time=Utils.getDateInUserDatePattern($L.moment(i.created_time).toDate(),!0),i.modified_time=Utils.getDateInUserDatePattern($L.moment(i.modified_time).toDate(),!0)),Crm.userDetails.PORTALS_CRITERIA_BASED_AUTHORIZATION_ENABLED){if("createRecord"===t&&"SUCCESS"===i.code){for(var r=[],a=(T=store.peekRecord("user_type",i.oldId).modules).length,d=0;d<a;d++){var s=T[d],o={};o.id=s.id,o.layouts=[];for(var l=s.layouts,_=l.length,n=0;n<_;n++)o.layouts[n]={id:l[n].id};o.fields=[];for(var u=s.fields,y=u.length,c=0;c<y;c++)o.fields[c]={id:u[c].id};o.custom_views=[];for(var f=s.custom_views,m=f.length,p=0;p<m;p++)o.custom_views[p]={id:f[p].id};o.canvas_views=[];for(var v=s.canvas_views,L=v.length,b=0;b<L;b++)o.canvas_views[b]={id:v[b].id};o.filters=[];var g=s.filters,R=g.length;for(K=0;K<R;K++)o.filters[K]={id:g[K].id};r[d]=o}i.modules=r}var T;for(P=(T=i.modules)?T.length:0,U=0;U<P;U++){(O=T[U]).criteria_value_metadata=i.criteria_value_metadata,O.user_type_id=i.id;N=(D=store.peekRecord("module",O.id))?D.generated_type:void 0;O.generatedType="webtab_widget"===N?"webtab_link":N;for(w=O.layouts?O.layouts.length:0,$=0;$<w;$++){(B=O.layouts[$]).user_type_id=i.id}O.fields&&null!==O.fields||(O.fields=[]);for(M=O.fields.length,z=0;z<M;z++){(j=O.fields[z]).field_id=j.id,j.user_type_id=i.id}var h=O.custom_views?O.custom_views.length:0;for(p=0;p<h;p++){O.custom_views[p].user_type_id=i.id}var A=O.filters?O.filters.length:0;0===A&&(O.filters=[]);for(K=0;K<A;K++){O.filters[K].user_type_id=i.id}for(var C=O.canvas_views?O.canvas_views.length:0,I=0;I<C;I++){O.canvas_views[I].user_type_id=i.id}if(O.secondary_conditions){var S=Lyte.registeredMixins["crm-client-portal-util"];if(S){var E=S.getConditionsCount(O.secondary_conditions.conditions);O.secondaryConditionsCount=E}}}}else for(var P=i.modules?i.modules.length:0,U=0;U<P;U++){var O;if(!(O=i.modules[U])||"{}"!==JSON.stringify(O)){var D,N=(D=store.peekRecord("module",O.id))?D.generated_type:void 0;O.generatedType="webtab_widget"===N?"webtab_link":N,!D||"platform_plugin"!==D.source&&"marketplace_plugin"!==D.source||(O.isPluginModule=!0),O.module_id=O.id,O.id=O.module_id+"_"+i.id,O.user_type_id=i.id;for(var w=O.layouts?O.layouts.length:0,$=0;$<w;$++){var B,k=(B=O.layouts[$]).id;B.id=k+"_"+i.id,B.user_type_id=i.id,B.layout_id=k}O.fields&&null!==O.fields||(O.fields=[]);for(var M=O.fields.length,z=0;z<M;z++){var j;(j=O.fields[z]).field_id=j.id,j.id=j.id+"_"+i.id,j.user_type_id=i.id}O.filters&&null!==O.filters||(O.filters=[]);for(var H=O.filters.length,K=0;K<H;K++){O.filters[K].user_type_id=i.id}}}return i},varPayloadKey:"user_type",payloadKey:function(){return this.varPayloadKey},serialize:function(e,t){var i=t.user_type;return i&&(objectUtils.removeKeyFromGivenObj(i,"createdByImageSrc"),objectUtils.removeKeyFromGivenObj(i,"modifiedByImageSrc")),(t={user_type:[]}).user_type[0]=i,JSON.stringify(t)}});
