!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(self,(function(){return(()=>{"use strict";var t={r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};function n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function o(e){if("string"!=typeof e)return{};var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/),r=t[6]||"",n=t[8]||"";return{protocol:t[2],host:t[4],path:t[5],query:r,relative:t[5]+r+n}}function a(e){return"[object String]"===Object.prototype.toString.call(e)}function s(e){return"[object Array]"===Object.prototype.toString.call(e)}function i(e){return"object"==typeof e&&null!==e}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function c(e){return"function"==typeof e}function d(e,t){return e==t.development}function m(){return(new Date).getTime()}function p(e){return"number"==typeof e}function f(e,t){if(!t||"object"!=typeof t)return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}function g(){var e=window.location;return{time:m(),userAgent:navigator.userAgent,url:e.href,domain:e.host,uuID:n()}}t.r(r);var h,y,v=new function(e,t){var r,n={},o=(t=t||1e3,e||3),a=m();n[1]={},this.curKey=1,this.checkLimit=function(e){var s=((m()-a)/t).toFixed(0),i=0;return n[s]?i=n[s][e]=p(n[s][e])?n[s][e]+1:1:Number(s)>Number(this.curKey)&&(this.curKey=s,n[s]={},i=n[s][e]=p(n[s][e])?n[s][e]+1:1,clearTimeout(r),r=setTimeout(function(){this.clearbeforeKeys(s)}.bind(this),t-1)),i-o>0?i-o:0},this.clearbeforeKeys=function(e){e=Number(e),Object.keys(n).forEach((function(t,r){(t=Number(t))!=e&&t<e&&delete n[t]}))}}(3,1e3),b=function(e){var t,r,n,d=window,p=d.location,g=document,h=p.href,y=[],b=[],S={},I=e,_=["click","focus","change","keypress"],w=["type","name","title","alt","lt-prop-dp","data-zcqa","lt-prop-route"];function T(e){return""==e?e:/^[\w](['A-Za-z0-9._%\-+]*@[A-Za-z0-9-]+(\.[a-zA-Z0-9-]{1,22}){0,9}\.[a-zA-Z]{2,22})$/.test(e)?"**(email)":e}function E(e){function t(e){"id"!=e.name&&"class"!=e.name&&(d[e.name]=e.value,m.push(e.name))}function r(e){s.test(e)&&(i=T(i=d[e]))&&-1==p.indexOf(e)&&(p.push(e),c.push("["+e+'="'+i+'"]'))}var n,o,s,i,u,c=[],d={},m=[],p=[];if(!e||!e.tagName)return"";if(c.push(e.tagName.toLowerCase()),e.id&&c.push("#"+e.id),(n=e.className)&&a(n)){var f=(o=n.split(/\s+/)).length;for(u=0;u<f;u++)c.push("."+o[u])}var g=w.length;for(u=0;u<g;u++)l(s=w[u])?(m.length<=0&&e.attributes.forEach(t),m.find(r)):(i=T(i=e.getAttribute(s)))&&-1==p.indexOf(s)&&(p.push(s),c.push("["+s+'="'+i+'"]'));return c.join("")}function x(e){var t=f({timestamp:m()},e);if(t.bubbled)return t;(Ve&&void 0!==window.murphy.recording&&(t.timeEllapsed=window.murphy.recording.getTimeEllapsed(),t.location=window.location.href,Fe.push(t)),"Custom Track"==e.type)?y.push(t):(c(r)?r(e):e)&&y.push(t);return y.length>I&&y.shift(),t}function O(e,t,r,n){if(null!=e){var o=e[t];e[t]=r(o),e[t].__murphy__=!0,e[t].__orig__=o,n&&n.push([e,t,o])}}function k(e){if(e){var t;try{t=e.type}catch(e){return}return"keypress"===t?N(e):L(e)}}var L=function(e){var r,n=e.type;t=null;try{r=function(e){var t,r=200,n=[],o=0,a=0,s=" > ".length;for(Ve&&(r=400);e&&o++<4&&!("html"===(t=E(e))||o>1&&a+n.length*s+t.length>=r);)n.push(t),a+=t.length,e=e.parentNode;return n.reverse().join(" > ")}(e.target)}catch(e){r="<unknown>"}S.evt===e||S.target==r&&S.evtName==n||(S.evt=e,S.target=r,S.evtName=n,""==r||r.includes("murphy")||-1==_.indexOf(e.type)||x({category:"user."+n,message:r,division:"userEvents"}))},N=function(e){var r;try{r=e.target}catch(e){return}var n=r&&r.tagName;if(n&&("INPUT"===n||"TEXTAREA"===n||r.isContentEditable)){var o=t;o||L(e),clearTimeout(o),t=setTimeout((function(){t=null}),5e3)}};function R(e){var t=d[e]&&d[e].prototype;t&&t.hasOwnProperty&&t.hasOwnProperty("addEventListener")&&(O(t,"addEventListener",(function(e){return function(t,r,n,o){return e.call(this,t,function(e,t){if(e&&e.__murphy__)return e.__murphy_wrapped;if(!c(e))return e;function r(){try{t&&c(t)&&t.apply(this,arguments)}catch(e){}return e.apply(this,arguments)}for(var n in e)u(e,n)&&(r[n]=e[n]);return r.prototype=e.prototype,e.__murphy__=!0,e.__murphy_wrapped=r,r.__orig__=e,r}(r,k),n,o)}}),b),O(t,"removeEventListener",(function(e){return function(t,r,n,o){return r&&r.__murphy__?e.call(this,t,r.__murphy_wrapped,n,o):e.call(this,t,r,n,o)}}),b))}for(var D=["EventTarget"],j=D.length,C=0;C<j;C++)R(D[C]);function B(e,t){var r=o(p.href),n=o(t),a=o(e);e!==t&&(window.murphy.recording.isInitialised()&&window.murphy.recording.urlChange(),h=t,r.protocol===n.protocol&&r.host===n.host&&(t=n.relative),r.protocol===a.protocol&&r.host===a.host&&(e=a.relative),x({category:"navigation",data:{to:t,from:e}}))}g.addEventListener("click",L,!1),g.addEventListener("keypress",N,!1);var U=d.XMLHttpRequest&&d.XMLHttpRequest.prototype;if(O(U,"open",(function(e){return function(t,r){this.__murphy_xhr&&this.__murphy_xhr.isListenerAttached?this.__murphy_xhr={method:t,url:r,status_code:null,startimestamp:m(),isListenerAttached:!0}:this.__murphy_xhr={method:t,url:r,status_code:null,startimestamp:m()};var n=this.__murphy_xhr,o=v.checkLimit(n.method+n.url);if(o>0&&this.__murphy_xhr.url!=se.logUrl){x({type:"http",category:"roguexhr",data:this.__murphy_xhr,count:o+3});var a=n.url.split("?")[0],s=a.split("/crm/");s[0]!=a&&(a=(a="crm/"+s[1]).split("/").map((function(e,t){var r=/(v(?:\d+\.?\d*))/.test(e);return r||(e=e.replace(/([0-9]+)/g,"*")),e=1!=t||r?e:"*"})).join("/")),murphy.error(new Error("Rage: "+a))}return e.apply(this,arguments)}}),b),O(U,"setRequestHeader",(function(e){return function(t,r){if(Ve){this.__murphy_xhr=this.__murphy_xhr||{},this.__murphy_xhr.reqHeaders=this.__murphy_xhr.reqHeaders||{};var n={};n[t]=r,this.__murphy_xhr.reqHeaders=f(this.__murphy_xhr.reqHeaders,n)}return e.apply(this,arguments)}}),b),O(U,"send",(function(e){return function(){var t=this;function r(){if(t.__murphy_xhr&&4===t.readyState){window.murphy.recording.isInitialised()&&window.murphy.recording.retainMaskElements();try{t.__murphy_xhr.status_code=t.status,Ve&&(xe("stripXhrResponse")||(t.__murphy_xhr.response=t.response),t.__murphy_xhr.respHeaders=t.getAllResponseHeaders()),t.__murphy_xhr.timeTaken=m()-t.__murphy_xhr.startimestamp}catch(e){}t.__murphy_xhr.url!=se.logUrl&&x({type:"http",category:"xhr",data:t.__murphy_xhr})}}function n(){x({type:"http",category:"xhr",data:t.__murphy_xhr,message:"timeout",timeout:this.timeout})}return Ve&&(t.__murphy_xhr.params=arguments[0]),t.__murphy_xhr&&!t.__murphy_xhr.isListenerAttached&&(t.addEventListener("readystatechange",r),t.addEventListener("timeout",n),t.__murphy_xhr.isListenerAttached=!0),e.apply(this,arguments)}}),b),d.history.pushState&&d.history.replaceState){var M=d.onpopstate;d.onpopstate=function(){var e=p.href;if(B(h,e),M)return M.apply(this,arguments)};var P=function(e){return function(){var t=arguments.length>2?arguments[2]:void 0;return t&&B(h,t+""),e.apply(this,arguments)}};O(d.history,"pushState",P,b),O(d.history,"replaceState",P,b)}if(window.fetch){O(d,"fetch",(function(e){return function(){var t=(new Date).getTime(),r=arguments[1]?arguments[1].method:null;return e.apply(this,arguments).then((e=>(x({category:"fetch",method:r,status:e.status,requestedUrl:arguments[0],url:e.url,ok:e.ok,startimestamp:t,timeTaken:(new Date).getTime()-t}),e))).catch((e=>(x({category:"fetch",method:r,startimestamp:t,msg:e.toString(),url:arguments[0],timeTaken:(new Date).getTime()-t}),Promise.reject(e))))}}),b)}return{getBreadCrumbs:function(e){var t=y.slice(0);return e&&(y=[]),t},getWrappedPrototypes:function(){return b.slice(0)},addAttrWhiteLists:function(e){return(a(e)||l(e))&&w.push(e),s(e)&&(n=e.filter((function(e){return w.indexOf(e)<0})),w=w.concat(n)),w.slice(0)},removeAttrWhiteLists:function(e){if(a(e)){var t=w.indexOf(e);t>-1&&w.splice(t,1)}return s(e)&&(n=w.filter((function(t){return e.indexOf(t)<0})),w=n.slice(0)),w.slice(0)},addEventWhiteLists:function(e){return a(e)&&_.push(e),s(e)&&(n=e.filter((function(e){return _.indexOf(e)<0})),_=_.concat(n)),_.slice(0)},removeEventWhiteLists:function(e){if(a(e)){var t=_.indexOf(e);t>-1&&_.splice(t,1)}return s(e)&&(n=_.filter((function(t){return e.indexOf(t)<0})),_=n.slice(0)),_.slice(0)},beforeBreadCrumbCapture:function(e){c(e)&&!r&&(r=e)},addBreadCrumb:function(e){return!!i(e)&&(e.type="Custom Track",e.category||(e.category=e.type),x(e),!0)},restoreAll:function(){d.removeEventListener("popstate",popstateHandler),g.removeEventListener("click",L),g.removeEventListener("keypress",N),b&&b.forEach((function(e){var t=e[0],r=e[1],n=e[2];"removeEventListener"!=n&&(t[r]=n)}))}}},S=window,I=S.location,_="Window Error",w="Handled Exception",T="Custom Info",E="Unhandled Promise",x=[],O=[],k=[],L=[],N=[];function R(e,t){var r;return function(){if(!r){var n=arguments,o=this,a=function(){e.apply(o,n),r=!1};r=!0,setTimeout(a,t)}}}function D(e){var t=O.map((function(e){return e.uniString})).indexOf(e.msg+e.lineno+e.colno+e.fileName);return t>-1?O[t].pos:"false"}function j(){var e={};return ae&&null!=ae&&(e=ae()),f(e,g())}function C(e){var t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),r=e.async||!0;t.open(e.type,e.url,r),t.addEventListener("load",e.success),t.addEventListener("error",e.error),t.setRequestHeader("content-type","application/json"),t.setRequestHeader("X-MURPHY-AUTHKEY",e.headers["X-MURPHY-AUTHKEY"]||""),t.setRequestHeader("x-remote-user",ae&&ae().zuid||""),t.send(e.data)}function B(e){(e=f(e,{url:I.href,domain:I.host})).type==T?function(e){L.push(e),L.length>=se.logsBatch&&y&&y()}(e):function(e){var t=e.errorObj,r=D(t);if("false"==r){e.count=1;var n=x.push(e);O.push({uniString:t.msg+t.lineno+t.colno+t.fileName,pos:n-1})}else x[r].lastOccured=e.time,x[r].count+=1;h&&h()}(e)}function U(e){if(e.sessionData&&e.sessionData.sessionId)for(var t=e.errors.length,r=0;r<t;r++)e.errors[r].sessionId=e.sessionData.sessionId,e.errors[r].tabId=e.sessionData.tabId;try{C({type:"POST",url:se.logUrl,data:JSON.stringify(e),dataType:"json",headers:se.headers})}catch(e){return}}async function M(e){if(navigator.sendBeacon){if(Ye.sPushed&&0===x.length&&0===L.length&&(Ye.tabEnd>0||Ye.sessionEnd>0)&&navigator.sendBeacon(se.logUrl,JSON.stringify({sessionData:Ye})),x.length>0){var t={errors:x};Ye.sPushed?(Ye.sPushed=!1,t.sessionData=Ye):(Ye.sessionEnd>0&&Ye.sessionEnd-Number(Ye.sessionStart)<ee||Ye.tabEnd>0&&Ye.tabEnd-Number(Ye.tabStart)<ee)&&(t.sessionData=Ye),navigator.sendBeacon(se.logUrl,JSON.stringify(t))}if(L.length>0){var r={info:L};Ye.sPushed?r.sessionData=Ye:(Ye.sessionEnd>0&&Ye.sessionEnd-Number(Ye.sessionStart)<ee||Ye.tabEnd>0&&Ye.tabEnd-Number(Ye.tabStart)<ee)&&(r.sessionData=_sessionData),navigator.sendBeacon(se.logUrl,JSON.stringify(r))}}re||(window.murphy.recording.isRecordingTab()?e.returnValue="video is recording . ":ve())}function P(){S.addEventListener("error",A)}function A(e){var t;if(!ie&&(e instanceof Error||e instanceof Event)&&(re&&!Xe&&(Ge.init(),Xe=!0),(e instanceof Error||e instanceof Event)&&(e instanceof Event&&(t=J(e.message,e.filename||document.location.href,e.lineno,e.colno,e.error)),e instanceof Error&&(t=J(e.message,e.fileName||document.location.href,e.lineNumber,e.columnNumber,e)),t))){var r=t.errorObj,n=D(r);if("false"==n){t.count=1;var o=x.push(t);O.push({uniString:r.msg+r.lineno+r.colno+r.fileName,pos:o-1})}else x[n].lastOccured=t.time,x[n].count+=1}}function H(e,t){W(e,t||w)}function K(e,t){W(e,t||T)}function z(e,t){if(u(e,"errorObj")){var r={errorObj:e.errorObj,type:e.type,sessionId:Ye.sessionId,tabId:Ye.tabId};if(r.breadCrumbs=e.breadCrumbs,c(t.setTags)){var n=f(t.setTags(),g());r=f(r,n)}if(i(t.config)){var o,a=t.config;o=a.logUrl?a.logUrl:"https://"+a.appDomain+"/murphy/"+a.appKey+"/exceptions";try{C({type:"POST",url:o,data:JSON.stringify({errors:[r]}),dataType:"json",headers:{"X-MURPHY-AUTHKEY":a.authKey}})}catch(e){return}}}}function J(e,t,r,n,o,a){var s;if(a=a||_,!e||e.toUpperCase()!="Script error.".toUpperCase()){"string"==typeof o?s=o:"object"==typeof o&&o&&o.stack&&(s=o.stack);var i={errorObj:{msg:e,fileName:t,lineno:r,colno:n,stackVal:s},type:a,sessionId:Ye.sessionId,tabId:Ye.tabId};return i=f(i,j())}}async function q(e){var t=localStorage.getItem("currentBlobId"),r=localStorage.getItem("currentVideoId");"null"!=t&&"null"!=r&&(e.videoId=r),B(e)}function W(e,t){if(e instanceof Error||e instanceof Event){var r;if(e instanceof Event&&(r=J(e.message,e.filename||document.location.href,e.lineno,e.colno,e.error,t)),e instanceof Error){var n=e.message;"Handled Exception"===t&&e.name&&(n=e.name+": "+e.message),r=J(n,e.fileName||document.location.href,e.lineNumber,e.columnNumber,e,t)}if(r){if(Ve){var o=JSON.parse(JSON.stringify(r));o.category="exception",o.errorObj.url=o.url,o.timeEllapsed=window.murphy.recording.getTimeEllapsed(),Fe.push(o)}if(te&&oe&&(r=f(r,{breadCrumbs:oe.getBreadCrumbs()})),Q){var a=r,s=N.length;if(s>0)for(var i=0;i<s;i++)a=N[i](r);a&&q(a)}return V(r),!1}}}function X(t){var r;t.reason?r=t.reason:t.detail&&t.detail.reason&&(r=e.detail.reason),r&&r instanceof Error&&W(r,E)}function V(e){var t,r=k.length;for(t=0;t<r;t++)k[t](e)}function Y(e){"function"==typeof e&&-1==k.indexOf(e)&&k.push(e)}function F(e){if(e)for(var t=k.length,r=0;r<t;r++)k[r]==e&&(k.splice(r,1),t--,r--);else k=[]}function Z(e){return oe?oe.getBreadCrumbs(e||!0):[]}function G(e){c(e)&&N.push(e)}var $,Q,ee,te,re,ne,oe,ae,se={},ie=!1,ue=!1,le={development:"dev",test:"testing",production:"production"},ce=window;function de(e){ie||(se.appDomain=e.appDomain,se.appKey=e.appKey,se.authKey=e.authKey,e.logUrl?se.logUrl=e.logUrl:se.logUrl="https://"+e.appDomain+"/murphy/"+e.appKey+"/exceptions",se.logsBatch=e.batchCount||10,$=function(e){if(null!=le[e])return le[e]}(e.environment||"development"),Q=null==e.pushLogs?!d($,le):e.pushLogs,null==e.pushInfo?!d($,le):e.pushInfo,te=null==e.enableTracking||e.enableTracking,ee=void 0===e.waitTime?6e4:e.waitTime,ne=p(e._maxTrackData)?e._maxTrackData:100,re=void 0!==e.enableSessionTracking&&e.enableSessionTracking,c(e.multiTabCallBack)&&fe(e.multiTabCallBack),se.headers["X-MURPHY-AUTHKEY"]=se.authKey)}function me(e,t){(!ie||ie&&!0===t)&&"function"==typeof e&&(ae=e)}function pe(){var e={};return"function"==typeof ae&&(e.zuid=ae().zuid,e.envData=ae()),e.appKey=se.appKey,e.appDomain=se.appDomain,e.logUrl=se.logUrl,e.authKey=se.authKey,e}function fe(e){murphy.multiTabCallBack=e}async function ge(e){ie||(i(e)&&(i(e.config)&&de(e.config),c(e.setTags)&&me(e.setTags),c(e.multiTabCallBack)&&fe(e.multiTabCallBack)),re&&!Xe&&(Ge.init(),Xe=!0),function(){if(ae&&void 0!==ae){var e,t=x.length;for(e=0;e<t;e++)x[e]=f(x[e],ae())}}(),h=R((function(){var e={errors:x};x=[],O=[],re&&!Ye.sPushed&&(Ge.pushSessionData(ae().zuid),e.sessionData=Ye),U(e)}),ee),y=R((function(){var e={info:L};L=[],re&&!Ye.sPushed&&(Ge.pushSessionData(ae().zuid),e.sessionData=_sessionData),U(e)}),ee),function(){ce.removeEventListener("error",A),ce.addEventListener("error",W),ce.addEventListener("unhandledrejection",X),S.addEventListener("beforeunload",M),re||Ge.storeNoOfTabsInDB();!function(){var e=localStorage.getItem("currentVideoId");null!==e&&"null"!==e&&"sessionExists"!=murphy.recording.checkSessionExistsInOtherOrg()&&murphy.multiTabCallBack&&"function"==typeof murphy.multiTabCallBack&&(murphy.loadRecAfterInitialPageLoad=!0);window.addEventListener("storage",ye)}()}(),te&&(oe=b(ne)),ie=!0,await async function(){new Promise(((e,t)=>{var r=indexedDB.open("murphyTestDB",1);r.onerror=function(t){Te=!1,e(!1)},r.onsuccess=function(t){Te=!0,e(!0)}}))}())}function he(){ie&&(F(),ce.removeEventListener("error",W),ce.removeEventListener("unhandledrejection",X),S.removeEventListener("beforeunload",M),window.removeEventListener("storage",ye),ie=!1)}function ye(e){if("currentBlobId"===e.key&&("null"!==localStorage.getItem("currentBlobId")?"sessionExists"!=murphy.recording.checkSessionExistsInOtherOrg()&&(Ve=!0):Ve=!1),"murphyRecInitialisedBeforeSendingInOtherTab"==e.key&&"true"==localStorage.getItem("murphyRecInitialisedBeforeSendingInOtherTab")){var t=localStorage.getItem("currentRecOrgId"),r=ae().zgid;(r=parseInt(r))==(t=parseInt(t))&&murphy.recording.recInitInOtherOrgs()}if("currentVideoId"===e.key){var n=localStorage.getItem("currentVideoId");if("null"!==n&&0===Fe.length){var o={};o.uuid=n,"sessionExists"!=murphy.recording.checkSessionExistsInOtherOrg()&&murphy.multiTabCallBack&&"function"==typeof murphy.multiTabCallBack&&(murphy.multiTabCallBack(),ke(o))}}}function ve(){var e=JSON.parse(localStorage.getItem("noOfTabs"));(e-=1)>=0&&(localStorage.setItem("noOfTabs",e),localStorage.setItem("onlyOne",!1),0===e)&&localStorage.setItem("onlyOne",!0)}function be(){Ze()?Ge.setPeers("pop"):ve()}function Se(e){if(_e())return window.moduleGenerator?(window.murphy.videoInstance||(window.murphy.videoInstance=new moduleGenerator,window.murphy.recording.setInstalled(),Ce()),window.murphy.recording.initiateScreenRecording(e)):void new Promise((function(e){var t;(t=document.createElement("script")).type="text/javascript";var r=document.getElementsByTagName("HEAD")[0];t.addEventListener("load",(function(t){e(t.target)})),r.appendChild(t)})).then((t=>(window.murphy.videoInstance=new moduleGenerator,window.murphy.recording.setInstalled(),Ce(),window.murphy.recording.initiateScreenRecording(e))))}function Ie(){ue=!0}function _e(){return ie}var we={sessions:[],currentSession:void 0,customTracking:{}},Te=!1;function Ee(e){we.customTracking=e}function xe(e){return we.customTracking[e]}function Oe(){return Te}function ke(e){Ve=!0,Ve="null"!=localStorage.getItem("currentBlobId"),we.sessions.push(e),we.currentSession=e;var t={type:"Session",category:"message internal",data:JSON.stringify(we.currentSession)};t=f({timestamp:m()},t),(Fe=[]).push(t)}function Le(){Ve=!1;var e=Fe;return Fe=[],e.slice(0)}function Ne(){Ve=!1}function Re(){Ve=!0}function De(){}function je(){var e=localStorage.getItem("videoStatus");if("recording"===e||"pause"===e){var t=localStorage.getItem("currentRecOrgId"),r=ae().zgid;if((r=parseInt(r))!=(t=parseInt(t)))return murphy.endRemoteSession(),murphy.recording.removeRecorder(),"sessionExists"}}function Ce(){for(var e=["initiateScreenRecording","getTimeEllapsed","clearRecordedContent","destroyRecorder","getRecordUrl","sendRecording","isInitialised","isRecordingTab","retainMaskElements","recorderState","showMurphyRecorderTour","closeMurphyRecorderTour","getModuleId","uploadedDataHandler","getUploadedFiles","deleteWritetousUploadedFiles","deleteElement","fileNameCheck","clearDrawnElements","getVideoSize","urlChange","removeRecorder","recInitInOtherOrgs"],t=0;t<e.length;t++)window.murphy.recording[e[t]]=window.murphy.videoInstance[e[t]].bind(window.murphy.videoInstance)}function Be(){for(var e=["getTimeEllapsed","clearRecordedContent","destroyRecorder","getRecordUrl","sendRecording","isInitialised","isRecordingTab","retainMaskElements","recorderState","showMurphyRecorderTour","closeMurphyRecorderTour","getModuleId","uploadedDataHandler","getUploadedFiles","deleteWritetousUploadedFiles","deleteElement","fileNameCheck","clearDrawnElements","getVideoSize","urlChange","removeRecorder","recInitInOtherOrgs"],t=0;t<e.length;t++)window.murphy.recording[e[t]]=De}var Ue="murphy_sessionId",Me="murphy_masterId",Pe="murphy_slaveId",Ae="murphy_peers",He="murphy_sessionStartTime",Ke="murphy_newTabOpened",ze="murphy_newSessionStarted",Je="murphy_sessionEnded",qe="murphy_tabClosed",We="murphy_hasSessionErrors",Xe=!1,Ve=!1,Ye={zuid:null,sessionStart:0,sessionMsg:"",sessionEnd:0,tabStart:0,tabMsg:"",tabEnd:0,sessionId:"",tabId:"",sPushed:!1},Fe=[];function Ze(){return Xe}var Ge={browserTabId:n(),ismaster:!1,isslave:!1,isFirstPage:!1,storeTabId:function(){"visible"==document.visibilityState&&localStorage.setItem("currentTabId",Ge.browserTabId)},storeSessionInfo:function(){null==localStorage.getItem(Ue)&&(localStorage.setItem(Ue,Ge.browserTabId),localStorage.setItem(He,Date.now()),localStorage.setItem(ze,ze),localStorage.setItem(We,"false"),Ge.setSessionObject(ze)),null!==localStorage.getItem(Me)?Ge.isslave=!0:(localStorage.setItem(Me,Ge.browserTabId),Ge.ismaster=!0),sessionStorage.setItem(Pe,Ge.browserTabId),Ge.setSessionObject(Ke),Ge.setPeers("push"),Ye.zuid=ae().zuid},storeNoOfTabsInDB:function(e){const t=indexedDB.open("session_db",1);var r={},n=!0;t.onupgradeneeded=e=>{r.db=e.target.result,r.db.createObjectStore("session_store",{keyPath:"name"})},t.onsuccess=o=>{r.db=o.target.result;const a=r.db.transaction("session_store","readwrite",{durability:"strict"}).objectStore("session_store");a.openCursor().onsuccess=r=>{var o=r.target.result;if(o){if(n=!1,"noOfTabs"==o.key){var s=o.value.value,i=a.put({name:"noOfTabs",value:s});s=JSON.parse(localStorage.getItem("noOfTabs")),s+=1,localStorage.setItem("noOfTabs",s),s>1&&localStorage.setItem("onlyOne","false"),"session"===e&&Ge.storeSessionInfo();var u=t.result;i.onsuccess=function(){u.close()}}o.continue()}else if(n){n=!1;i=a.put({name:"noOfTabs",value:1});localStorage.setItem("noOfTabs",1),"session"===e&&Ge.storeSessionInfo(),i.onsuccess=function(){t.result.close()}}}}},setPeers:function(e){var t=[];if(null!==localStorage.getItem(Ae)&&(t=JSON.parse(localStorage.getItem(Ae))),"push"===e)t.push(Ge.browserTabId);else if("pop"===e){var r=t.indexOf(Ge.browserTabId);if(r>-1){t.splice(r,1);var n=JSON.parse(localStorage.getItem("noOfTabs"));if((n-=1)>=0&&(localStorage.setItem("noOfTabs",n),localStorage.setItem("onlyOne",!1),0==n))return localStorage.setItem("murphy_peers",JSON.stringify([])),localStorage.removeItem(Me),localStorage.removeItem(Ue),localStorage.removeItem(He),localStorage.removeItem(ze),localStorage.removeItem(We),void localStorage.setItem("onlyOne",!0)}}localStorage.setItem(Ae,JSON.stringify(t))},pushSessionData:function(e){Ye.sPushed||(null!==localStorage.getItem(ze)&&localStorage.getItem(ze)==ze&&(Ye.sessionMsg=localStorage.getItem(ze),localStorage.removeItem(ze)),null!==localStorage.getItem(We)&&"false"==localStorage.getItem(We)&&localStorage.setItem(We,"true"),Ye.sPushed=!0)},setSessionObject:function(e){e===ze?(Ye.sessionStart=localStorage.getItem(He),Ye.sessionId=localStorage.getItem(Ue)):e===Ke?(Ye.sessionStart=localStorage.getItem(He),Ye.tabStart=Date.now(),Ye.tabMsg=Ke,Ye.sessionId=localStorage.getItem(Ue),Ye.tabId=sessionStorage.getItem(Pe)):e===Je?(Ye.sessionMsg=Je,Ye.sessionEnd=Date.now(),Ye.sPushed||null===localStorage.getItem(We)||"true"!=localStorage.getItem(We)?Ge.setSessionObject(qe):(Ye.tabMsg="",Ye.sPushed=!0,localStorage.removeItem(We))):e===qe&&(Ye.tabMsg=qe,Ye.tabEnd=Date.now())},cleanUpBeforeUnload:function(){Ge.setPeers("pop"),null!==localStorage.getItem(Ae)&&0===JSON.parse(localStorage.getItem(Ae)).length?Ge.setSessionObject(Je):Ge.setSessionObject(qe),"murphy_newSessionStarted"===Ye.sessionMsg&&(Ye.sessionMsg="")},init:function(){Xe=!0;try{window.addEventListener("unload",(function(){null!==localStorage.getItem(Ae)&&0===JSON.parse(localStorage.getItem(Ae)).length?(null!==localStorage.getItem(Ue)&&localStorage.removeItem(Ue),null!==localStorage.getItem(He)&&localStorage.removeItem(He),null!==localStorage.getItem(Me)&&localStorage.removeItem(Me),null!==localStorage.getItem(Ae)&&localStorage.removeItem(Ae),null!==localStorage.getItem(ze)&&localStorage.removeItem(ze),null!==localStorage.getItem(We)&&localStorage.removeItem(We)):Ge.ismaster&&null!==localStorage.getItem(Me)&&localStorage.removeItem(Me)})),window.addEventListener("beforeunload",(function(e){window.murphy.recording.isRecordingTab()?e.returnValue="video is recording . ":Ge.cleanUpBeforeUnload()})),window.addEventListener("storage",(function(e){if(null!==e.key&&e.key===Me&&null==localStorage.getItem(Me)&&!Ge.ismaster){var t=[];null!==localStorage.getItem(Ae)&&(t=JSON.parse(localStorage.getItem(Ae))),Ge.browserTabId===t[0]&&(Ge.ismaster=!0,localStorage.setItem(Me,Ge.browserTabId),Ge.isslave=!1)}})),Ge.storeNoOfTabsInDB("session")}catch(e){return}}};return function(e){var t=e;function r(e){return oe?oe.addBreadCrumb(e):[]}Ge.storeTabId(),se.headers={"content-type":"application/json"};var n={config:de,setTags:me,error:H,customInfo:K,pushToOtherService:z,info:r,install:ge,uninstall:he,subscribe:Y,unsubscribe:F,getTrackingData:Z,whiteListAttributes:function(e){return oe?oe.addAttrWhiteLists(e):[]},blackListAttributes:function(e){return oe?oe.removeAttrWhiteLists(e):[]},whiteListEvents:function(e){return oe?oe.addEventWhiteLists(e):[]},blackListEvents:function(e){return oe?oe.removeEventWhiteLists(e):[]},addCustomTracking:r,beforeTrack:function(e){return oe?oe.beforeBreadCrumbCapture(e):[]},beforeError:G,beginRemoteSession:ke,endRemoteSession:Le,pauseSession:Ne,resumeSession:Re,setCustomTrackingForVideo:Ee,sendUserInfo:pe,isMurphyTabInstalled:Ze,initiateTabClose:be,isMurphyInstalled:_e,recording:{initiateScreenRecording:function(e){return Se(e)},isInstalled:function(){return ue},setInstalled:Ie,checkSessionExistsInOtherOrg:je,isMurphyRecSupported:Oe}};t.murphy||(t.murphy=n,Be(),P()),document.addEventListener("visibilitychange",(function(){"visible"==document.visibilityState&&localStorage.setItem("currentTabId",Ge.browserTabId)}))}(window||self),"undefined"!=typeof enableMurphy&&enableMurphy(),r})()}));