!function(){var e=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t.CalendarMonthFilter=e({1:function(e,t,a,r,i){var n=e.escapeExpression,s=null!=t?t:{};return' <option class="month_'+n(e.lambda(t,t))+'" value="'+n(a.increment.call(s,i&&i.index,1,{name:"increment",hash:{},data:i}))+'">'+n(a.getI18n.call(s,t,{name:"getI18n",hash:{},data:i}))+"</option> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,r,i){var n;return' <select id="calendarMonthid" onchange="Lyte.Mixin.get(\'crm-zianotification-helper\').calendarUpd(this,event,0,undefined,1)"> '+(null!=(n=a.each.call(null!=t?t:{},null!=t?t.months:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?n:"")+" </select>"},useData:!0}),t.CalendarYearFilter=e({1:function(e,t,a,r,i){var n=e.lambda,s=e.escapeExpression;return' <option class="year_'+s(n(t,t))+'">'+s(n(t,t))+"</option> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,r,i){var n;return' <select id="calendarYearid" onchange="Lyte.Mixin.get(\'crm-zianotification-helper\').calendarUpd(this,event,1,undefined,1)"> '+(null!=(n=a.each.call(null!=t?t:{},null!=t?t.years:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?n:"")+" </select>"},useData:!0}),t.TrendDashboardDateFilter=e({1:function(e,t,a,r,i){return" <option>"+e.escapeExpression(e.lambda(t,t))+"</option> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,r,i){var n,s=e.lambda,l=e.escapeExpression,o=null!=t?t:{};return' <div data-zcqa="dIDateRangeContainer_'+l(s(null!=t?t.dbItemId:t,t))+'" class="dIDateRangeContainer dIB pR mL10" onclick="crmui.hideTooltip()" onmouseover="if(!$(this).find(\'.diUserSettingContainerData\').is(\':visible\')){crmui.showTooltip(\''+l(a.getI18n.call(o,"crm.label.daterange",{name:"getI18n",hash:{},data:i}))+'\',false,\'center\',this)}else{crmui.hideTooltip()}" onmouseout="crmui.hideTooltip()"> <div data-zcqa="dISubModuleconta_'+l(s(null!=t?t.dbItemId:t,t))+'" class="dISubModuleconta pR"  onclick="Lyte.Mixin.get(\'crm-zianotification-helper\').slider(this, \''+l(s(null!=t?t.dbItemId:t,t))+"');$(this).parent().trigger('mouseout');sE(event)\"> <div data-zcqa=\"dISubModuleTextConta_"+l(s(null!=t?t.dbItemId:t,t))+'" class="dISubModuleTextConta crm-font-regular  selected dateRangeHeader '+l(s(null!=t?t.dbItemId:t,t))+'"> Today </div> </div> <div class="diUserSettingContainerData crm-font-regular" style="left: initial; right: 0px;  display: none;"  onclick="$(\'#Calendar\').hide();sE(event);" > <div class="dIB diUserSettingSubContainer pR oA" > <div class="dIB w100_per dIDateRangeContainerUlLi"> <span class="m0 pL30 dIRecentLabelHeader crm-font-regular hide">Recent</span> <ul class="trendDBrecentFilters '+l(s(null!=t?t.dbItemId:t,t))+' p0 m0 w100_per dIB hide"> </ul> <span class="m0 pL30 dIRecentLabelHeader  crm-font-regular mT10">'+l(a.getI18n.call(o,"crm.label.timeperiod",{name:"getI18n",hash:{},data:i}))+'</span> <ul class="p0 m0 w100_per dIB"> <li class="current dateFilter '+l(s(null!=t?t.dbItemId:t,t))+' m0" onclick="Lyte.Mixin.get(\'crm-zianotification-helper\').showTodayDrop(this);sE(event);" datetype="current"> <label for="rbCheckidone" class="rbCheckHtml mR10"> <span class="rbHtml mR10"></span> <span data-zcqa="current_'+l(s(null!=t?t.dbItemId:t,t))+'" class="dILstSpn crm-font-regular">'+l(a.getI18n.call(o,"crm.ln.lable.current",{name:"getI18n",hash:{},data:i}))+'</span> <div class="currentPeriod dateFilterDrop '+l(s(null!=t?t.dbItemId:t,t))+' dIrecentSelectDataCont crm-font-regular mL5 mR5"> <select data-zcqa="curfilter_'+l(s(null!=t?t.dbItemId:t,t))+'" onchange="sE(event);"> <option value="week">'+l(a.getI18n.call(o,"crm.emailstats.week",{name:"getI18n",hash:{},data:i}))+'</option> <option value="month">'+l(a.getI18n.call(o,"crm.emailstats.month",{name:"getI18n",hash:{},data:i}))+'</option> <option value="year">'+l(a.getI18n.call(o,"crm.emailstats.year",{name:"getI18n",hash:{},data:i}))+'</option> </select> </div> </label> </li> <li class="last dateFilter '+l(s(null!=t?t.dbItemId:t,t))+' m0" onclick="Lyte.Mixin.get(\'crm-zianotification-helper\').showTodayDrop(this);sE(event)" datetype="last"> <label data-zcqa="last_'+l(s(null!=t?t.dbItemId:t,t))+'" for="rbCheckidtwo" class="rbCheckHtml mR10"> <span class="rbHtml mR10"></span> <span class="dILstSpn crm-font-regular">'+l(a.getI18n.call(o,"Last",{name:"getI18n",hash:{},data:i}))+'</span> <div class="lastPeriodSteps '+l(s(null!=t?t.dbItemId:t,t))+' dIB mL5 mR5 dIInputSetinRange"> <select data-zcqa="lastcount_'+l(s(null!=t?t.dbItemId:t,t))+'"class="dILastDaysDrop"> '+(null!=(n=a.each.call(o,null!=t?t.range:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?n:"")+' </select> </div> <div class="lastPeriod dateFilterDrop '+l(s(null!=t?t.dbItemId:t,t))+' dIB mR5 crm-font-regular dIrecentSelectDataCont"> <select data-zcqa="lastFilter_'+l(s(null!=t?t.dbItemId:t,t))+'" onchange="CrmDashboard.restrictYearPeriodSteps(\''+l(s(null!=t?t.dbItemId:t,t))+'\');sE(event);"> <option value="day">'+l(a.firstLetterCap.call(o,a.getI18n.call(o,"days",{name:"getI18n",hash:{},data:i}),{name:"firstLetterCap",hash:{},data:i}))+'</option> <option value="week">'+l(a.firstLetterCap.call(o,a.getI18n.call(o,"weeks",{name:"getI18n",hash:{},data:i}),{name:"firstLetterCap",hash:{},data:i}))+'</option> <option value="month">'+l(a.firstLetterCap.call(o,a.getI18n.call(o,"months",{name:"getI18n",hash:{},data:i}),{name:"firstLetterCap",hash:{},data:i}))+'</option> <option value="year">'+l(a.firstLetterCap.call(o,a.getI18n.call(o,"crm.label.years",{name:"getI18n",hash:{},data:i}),{name:"firstLetterCap",hash:{},data:i}))+'</option> </select> </div> </label> </li> <li class="custom dateFilter '+l(s(null!=t?t.dbItemId:t,t))+' m0" onclick="Lyte.Mixin.get(\'crm-zianotification-helper\').showTodayDrop(this);sE(event);" datetype="custom"> <label data-zcqa="custom_'+l(s(null!=t?t.dbItemId:t,t))+'" for="rbCheckidthree" class="rbCheckHtml mR10"> <span class="rbHtml mR10"></span> <span class="dIB vAlignMid ">'+l(a.getI18n.call(o,"Custom",{name:"getI18n",hash:{},data:i}))+'</span> </label> </li> </ul> </div> <div class="w100_per dIDateRangeinInputCont"> <div class="dIB w100_per trendDBRowSection"> <div class="dIB crm-base-font-size crm-font-regular trendDBRowSectionLabel">'+l(a.getI18n.call(o,"crm.label.from",{name:"getI18n",hash:{},data:i}))+'</div> <div class="dIB inputTrendDbSectionCont customPeriod startDate '+l(s(null!=t?t.dbItemId:t,t))+'" onclick="sE(event);"> <input data-zcqa="customstart_'+l(s(null!=t?t.dbItemId:t,t))+'" type="text" class="trendDBRowSectionDate" id="trendDBRowSectionFromDate_'+l(s(null!=t?t.dbItemId:t,t))+'"  placeholder="MM/DD/YYYY" onfocus="sE(event);" onclick="Lyte.Mixin.get(\'crm-zianotification-helper\').showFilterCalendar(event, this, \''+l(s(null!=t?t.dbItemId:t,t))+"');sE(event);\" onchange=\"Lyte.Mixin.get('crm-zianotification-helper').showDateChangeDropdown('"+l(s(null!=t?t.dbItemId:t,t))+'\', this);sE(event);"> </div> </div> <div class="dIB w100_per trendDBRowSection"> <div class="dIB trendDBRowSectionLabel">'+l(a.getI18n.call(o,"crm.label.to",{name:"getI18n",hash:{},data:i}))+'</div> <div class="dIB inputTrendDbSectionCont customPeriod endDate '+l(s(null!=t?t.dbItemId:t,t))+'" onclick="sE(event);"> <input data-zcqa="customend_'+l(s(null!=t?t.dbItemId:t,t))+'" type="text" class="trendDBRowSectionDate " id="trendDBRowSectionToDate_'+l(s(null!=t?t.dbItemId:t,t))+'" placeholder="MM/DD/YYYY" style="" onfocus="sE(event);" onclick="Lyte.Mixin.get(\'crm-zianotification-helper\').showFilterCalendar(event, this, \''+l(s(null!=t?t.dbItemId:t,t))+"');sE(event);\" onchange=\"Lyte.Mixin.get('crm-zianotification-helper').showDateChangeDropdown('"+l(s(null!=t?t.dbItemId:t,t))+'\', this);sE(event);"> </div> </div> </div> </div> <div class="dIB w100_per mT20 mB20 alignRight pR20 brderbox"> <button data-zcqa="datecancel_'+l(s(null!=t?t.dbItemId:t,t))+'" class="dIB newgraybtn lyteSm"  onclick="Lyte.Mixin.get(\'crm-zianotification-helper\').closeSettingContainer()">'+l(a.getI18n.call(o,"crm.button.cancel",{name:"getI18n",hash:{},data:i}))+'</button> <button data-zcqa="dateapply_'+l(s(null!=t?t.dbItemId:t,t))+'" class="dIB primarybtn lyteSm"  onclick="CrmDashboard.trendDashbboardDateChange(\''+l(s(null!=t?t.dbItemId:t,t))+"', false);$('.diUserSettingContainerData').hide()\">"+l(a.getI18n.call(o,"crm.button.apply",{name:"getI18n",hash:{},data:i}))+'</button> </div> </div> </div> <div class="periodFilterDrop '+l(s(null!=t?t.dbItemId:t,t))+" trendDBRowSectionDateView trendDBRowSectionDate\" onclick='Lyte.Mixin.get('crm-zianotification-helper').addActiveBorder(this);crmui.hideTooltip();sE(event)' onmouseover=\"if($(this).hasClass('remHidToolTip')){crmui.hideTooltip()}else{crmui.showTooltip('"+l(a.getI18n.call(o,"crm.calendar.freq",{name:"getI18n",hash:{},data:i}))+'\',false,\'center\',this)}" onmouseout="crmui.hideTooltip()"> <select data-zcqa="period_'+l(s(null!=t?t.dbItemId:t,t))+'" id="trendDbViewSelection" onchange="CrmDashboard.trendDashbboardPeriodChange(\''+l(s(null!=t?t.dbItemId:t,t))+"', $(this).val())\" onclick='sE(event)'> <option value=\"day\">"+l(a.getI18n.call(o,"Daily",{name:"getI18n",hash:{},data:i}))+'</option> <option value="week">'+l(a.getI18n.call(o,"Weekly",{name:"getI18n",hash:{},data:i}))+'</option> <option value="month">'+l(a.getI18n.call(o,"Monthly",{name:"getI18n",hash:{},data:i}))+'</option> <option value="year">'+l(a.getI18n.call(o,"Yearly",{name:"getI18n",hash:{},data:i}))+"</option> </select> </div>"},useData:!0}),t.TrendDashboardFeatureSelector=e({1:function(e,t,a,r,i,n,s){var l,o=e.lambda,c=e.escapeExpression,d=null!=t?t:{};return' <button data-zcqa="feature_'+c(o(null!=t?t.dbItemId:t,t))+"_"+c(o(i&&i.index,t))+'"'+(null!=(l=a.if.call(d,i&&i.first,{name:"if",hash:{},fn:e.program(2,i,0,n,s),inverse:e.noop,data:i}))?l:"")+" onclick=\"CrmDashboard.trendDBSeriesChange('"+c(o(null!=s[1]?s[1].dbItemId:s[1],t))+"', "+c(o(i&&i.index,t))+', this)">'+c(a.getI18n.call(d,t,{name:"getI18n",hash:{},data:i}))+"</button> "},2:function(e,t,a,r,i){return'class="dIEmailAnamolySelected crm-font-regular"'},compiler:[7,">= 4.0.0"],main:function(e,t,a,r,i,n,s){var l;return' <div class = "dIEmailAnamoly mT10"> '+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.features:t,{name:"each",hash:{},fn:e.program(1,i,0,n,s),inverse:e.noop,data:i}))?l:"")+" </div>"},useData:!0,useDepths:!0}),t.TrendDashboardFilterList=e({1:function(e,t,a,r,i,n,s){var l=e.lambda,o=e.escapeExpression;return' <li data-zcqa="recentfilter_'+o(l(null!=t?t.dbItemId:t,t))+"_"+o(l(i&&i.index,t))+'" class="m0 noneedCheck" data-filter="'+o(l(null!=t?t.filter:t,t))+'" onclick="CrmDashboard.trendDashbboardDateChange(\''+o(l(null!=s[1]?s[1].dbItemId:s[1],t))+"', true, $(this).data('filter'));$(this).parents('.dIDateRangeContainer').find('.diUserSettingContainerData').fadeOut(200);\"> <span class=\"dIB crm-font-regular\"\">"+o(l(null!=t?t.text:t,t))+"</span> </li> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,r,i,n,s){var l;return" "+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.filters:t,{name:"each",hash:{},fn:e.program(1,i,0,n,s),inverse:e.noop,data:i}))?l:"")},useData:!0,useDepths:!0}),t.TrendDashboardToolTip=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,r,i){var n,s=e.lambda,l=e.escapeExpression;return"<b>"+l(s(null!=(n=null!=t?t.data:t)?n.name:n,t))+"</b></br>"+l(s(null!=(n=null!=t?t.data:t)?n.value:n,t))},useData:!0}),t.TrendDashboardUserFilter=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,r,i){var n=e.lambda,s=e.escapeExpression,l=null!=t?t:{};return' <div data-zcqa="trendDBUserFilter_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dIUserListContainer pR dIB" onclick="CrmDashboard.showTrendDBUserSelector(\''+s(n(null!=t?t.dbItemId:t,t))+"');Lyte.Mixin.get('crm-zianotification-helper').showUserContainer(this, '"+s(n(null!=t?t.dbItemId:t,t))+'\');sE(event)"> <div data-zcqa="dISubUserCont_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dISubUserCont"> <div data-zcqa="dioneUserConta_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dioneUserConta"> <div data-zcqa="dIUserImage_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dIUserImage hide"> <img src="https://'+s(n(null!=t?t.sampleImage:t,t))+'"/> </div> <div class="userSettings '+s(n(null!=t?t.dbItemId:t,t))+' dIUserNameText crm-font-regular" data-zcqa="dIUserNameText_'+s(n(null!=t?t.dbItemId:t,t))+'" > '+s(n(null!=t?t.userSettings:t,t))+' </div> </div> </div> <div data-zcqa="diUserListContainerData_'+s(n(null!=t?t.dbItemId:t,t))+'" class="diUserListContainerData crm-font-regular '+s(n(null!=t?t.dbItemId:t,t))+'"  onclick="sE(event);Lyte.Mixin.get(\'crm-zianotification-helper\').hideOtherpops();"> <input data-zcqa="search_'+s(n(null!=t?t.dbItemId:t,t))+'" type="checkbox" class="hide" name="n1" id="sa"> <div data-zcqa="diUserListSubData_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dIB w100_per p15 brderbox"> <div data-zcqa="dIUserSearchNewContainer_'+s(n(null!=t?t.dbItemId:t,t))+'" class="mL10 mR10 dIUserSearchNewContainer"> <div data-zcqa="diuserchangeDropdown_'+s(n(null!=t?t.dbItemId:t,t))+'" class="diuserchangeDropdown '+s(n(null!=t?t.dbItemId:t,t))+'" onclick="$(\'.dIuserOpenChange\').show();sE(event);"> '+s(n(null!=t?t.userType:t,t))+' </div> <div data-zcqa="dIuserOpenChange_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dIuserOpenChange '+s(n(null!=t?t.dbItemId:t,t))+' p0"> <ul data-zcqa="usergroup_'+s(n(null!=t?t.dbItemId:t,t))+'" class="p0 m0" id="userOrGroup_'+s(n(null!=t?t.dbItemId:t,t))+'"> <li data-zcqa="user_'+s(n(null!=t?t.dbItemId:t,t))+"\" class=\"pL10 pR10 diuserchangeli dIB selected\" type=\"allusers\" onclick=\"$(this).parent().find('li').removeClass('selected');$(this).addClass('selected');$('.diuserchangeDropdown."+s(n(null!=t?t.dbItemId:t,t))+"').text($(this).text());$('.dIuserOpenChange').hide();CrmDashboard.trendDBUserTypeChange('"+s(n(null!=t?t.dbItemId:t,t))+'\', this);" usertype="user">'+s(a.getI18n.call(l,"Users",{name:"getI18n",hash:{},data:i}))+'</li> <li data-zcqa="group_'+s(n(null!=t?t.dbItemId:t,t))+"\" class=\"pL10 pR10 diuserchangeli dIB\" type=\"group\" onclick=\"$(this).parent().find('li').removeClass('selected');$(this).addClass('selected');$('.diuserchangeDropdown').text($(this).text());$('.dIuserOpenChange').hide();CrmDashboard.trendDBUserTypeChange('"+s(n(null!=t?t.dbItemId:t,t))+'\', this);" usertype="group">'+s(a.getI18n.call(l,"groups",{name:"getI18n",hash:{},data:i}))+'</li> </ul> </div> <div data-zcqa="dIUserInputContainer_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dIB dIUserInputContainer"> <input type="text" class="trendDBUserSearch '+s(n(null!=t?t.dbItemId:t,t))+'"placeholder="'+s(a.getI18n.call(l,"crm.label.search",{name:"getI18n",hash:{},data:i}))+'" onkeyup="$(\'.selectAllUser.'+s(n(null!=t?t.dbItemId:t,t))+"').addClass('hide');Lyte.Mixin.get('crm-zianotification-helper').inputSearchUser(this);\"> </div> </div> </div> <div data-zcqa=\"diAllCheckBoxContainerSection_"+s(n(null!=t?t.dbItemId:t,t))+'" class="dIB pL15 pR15 brderbox mT10 mB10 w100_per diAllCheckBoxContainerSection"> <div data-zcqa="diAllCheckBoxSubSection_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dIB mL5 selectAllUser '+s(n(null!=t?t.dbItemId:t,t))+'"> <input data-zcqa="selall_'+s(n(null!=t?t.dbItemId:t,t))+'" type="checkbox" class="hide" name="dIAllSelectionInputBox" id="userSelectAll_'+s(n(null!=t?t.dbItemId:t,t))+'" onchange="CrmDashboard.trendDBSelectAllUser(\''+s(n(null!=t?t.dbItemId:t,t))+'\')"> <label class="cP" for="dIAllSelectionInputBox" onclick="$(this).prev().click()"> <span></span> <div data-zcqa="dIUserNameText_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dIUserNameText crm-font-regular"> '+s(a.getI18n.call(l,"crm.label.all",{name:"getI18n",hash:{},data:i}))+' </div> </label> </div> <div class="dIB  dIuserselectedCount" > <div data-zcqa="trendDBUserCount_'+s(n(null!=t?t.dbItemId:t,t))+'" id="trendDBUserCount_'+s(n(null!=t?t.dbItemId:t,t))+'"class="dIB  crm-font-regular" > </div> '+s(a.getI18n.call(l,"crm.label.selected",{name:"getI18n",hash:{},data:i}))+' </div> </div> <div data-zcqa="dIUserListScrollContainer_'+s(n(null!=t?t.dbItemId:t,t))+'" class="w100_per brderbox dIUserListScrollContainer" onscroll="Lyte.Mixin.get(\'crm-zianotification-helper\').diUserListScrollAddShad(this)"> <ul id="trendDBUserList_'+s(n(null!=t?t.dbItemId:t,t))+'" class="m0 pR15 pL15 brderbox pT0 pB0 w100_per dIB"> </ul> </div> <div data-zcqa="dICancelApply_'+s(n(null!=t?t.dbItemId:t,t))+'" class="w100_per p15 brderbox dIB alignRight diUserListActContainer"> <button data-zcqa="usercancel_'+s(n(null!=t?t.dbItemId:t,t))+'" class="newgraybtn lyteSm "  onclick="$(\'.diUserListContainerData.'+s(n(null!=t?t.dbItemId:t,t))+"').fadeOut(200);$('.dIactiveBorder').removeClass('dIactiveBorder');$('.diUserListContainerData."+s(n(null!=t?t.dbItemId:t,t))+"').find('li').show();$('.diUserListContainerData."+s(n(null!=t?t.dbItemId:t,t))+"').find('input').val('false');CrmDashboard.trendDashbboardUserFilterReset('"+s(n(null!=t?t.dbItemId:t,t))+"');$('.trendDBUserSearch."+s(n(null!=t?t.dbItemId:t,t))+"').val('');\"> "+s(a.getI18n.call(l,"crm.button.cancel",{name:"getI18n",hash:{},data:i}))+' </button> <button data-zcqa="userapply_'+s(n(null!=t?t.dbItemId:t,t))+'" class="primarybtn mR0 lyteSm"  onclick="CrmDashboard.trendDashbboardUserFilterChange(\''+s(n(null!=t?t.dbItemId:t,t))+"');$('.trendDBUserSearch."+s(n(null!=t?t.dbItemId:t,t))+"').val('');\"> "+s(a.getI18n.call(l,"crm.button.apply",{name:"getI18n",hash:{},data:i}))+" </button> </div> </div> </div>"},useData:!0}),t.TrendDashboardUserList=e({1:function(e,t,a,r,i,n,s){var l,o=e.lambda,c=e.escapeExpression;return' <li class="m0 cBoth" data-id="'+c(o(null!=t?t.id:t,t))+'" > <input type="checkbox" class="hide" name="n'+c(o(i&&i.index,t))+'" id="'+c(o(null!=s[1]?s[1].dbItemId:s[1],t))+"_"+c(o(null!=t?t.id:t,t))+'" onchange="CrmDashboard.trendDBSelectUser(\''+c(o(null!=s[1]?s[1].dbItemId:s[1],t))+'\', this)"> <label data-zcqa="user_'+c(o(null!=s[1]?s[1].dbItemId:s[1],t))+"_"+c(o(i&&i.index,t))+'" class="cP" for="'+c(o(null!=s[1]?s[1].dbItemId:s[1],t))+"_"+c(o(null!=t?t.id:t,t))+'" > <span></span> '+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.photo:t,{name:"if",hash:{},fn:e.program(2,i,0,n,s),inverse:e.noop,data:i}))?l:"")+' <div class="dIUserNameText onlytheUserName crm-font-regular" title="'+c(o(null!=t?t.name:t,t))+'">'+c(o(null!=t?t.name:t,t))+"</div> </label> </li> "},2:function(e,t,a,r,i){return' <div class="dIUserImage"> <img src="'+e.escapeExpression(e.lambda(null!=t?t.photo:t,t))+'"> </div> '},compiler:[7,">= 4.0.0"],main:function(e,t,a,r,i,n,s){var l;return" "+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.userlist:t,{name:"each",hash:{},fn:e.program(1,i,0,n,s),inverse:e.noop,data:i}))?l:"")},useData:!0,useDepths:!0}),t.ZiaOnboard=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,r,i){var n,s=e.escapeExpression,l=null!=t?t:{};return' <div class="aligncenter p20"> <img src="'+s(e.lambda(t,t))+'" class="mT30 w70_per"></img> <p class="crm-base-font-size mT20">'+(null!=(n=a.getI18n.call(l,"crm.zia.onboard",{name:"getI18n",hash:{},data:i}))?n:"")+'</p> <p class="aligncenter crmLinkColor crm-base-font-size crm-font-regular mT20"> <link-to lt-prop-route="crm.settings.section.zia.notification.workflow" lt-prop-custom> <a href="'+s(a.getCrmBasePath.call(l,{name:"getCrmBasePath",hash:{},data:i}))+'/settings/zia/notification">Configure</a> </link-to> </p> </div>'},useData:!0})}();var crmLicense={enableEditionTrial:function(e,t,a){if(commonUtils.showHideLoadingDiv(),$("#tryFeaturesDiv").remove(),"extendYourTrail"===e&&"Starter"===t)return $("#trialExpiryDiv").css("display","none"),renderingUtils.hideFreezeLayer(),void crmLicense.editionTrialPopup();var r=Crm.getCrmBasePath()+"/Security.do",i="crmcsrfparam="+encodeURIComponent(csrfToken);i=i+"&selEdition="+t,void 0!==a?i=i+"&actionName="+a:i+="&actionName=newEvaluation&",(new crmRequestPool).initiate({url:r,data:i,success:function(e){-1!==e.indexOf("You cannot access this URL")?renderingUtils.displayPermissionDenied():(Crm.client_tracking("Extend Trial"),setTimeout((function(){cookieUtils.setCookie("crmtrialEnabed","Closed",365,"/"),Utils.windowLocationReload()}),500))},error:function(e){555===e.status&&crmui.showMsgBand("warning",$ESAPI.encoder().encodeForHTML(e.responseText),5e3)}})},enableHigherEditionTrial:function(e){commonUtils.showHideLoadingDiv(),renderingUtils.showFreezeLayer();var t=csrfParamName+"="+encodeURIComponent(csrfToken);(new crmRequestPool).initiate({type:"POST",url:Crm.getCrmBasePath()+"/Security.do?actionName=enableHigherEditionTrial&selEdition="+e,data:t,success:function(e){if(-1!==e.indexOf("You cannot access this URL"))renderingUtils.displayPermissionDenied();else{var t=window.location.href;-1!==(t=t.replace(/&higherEditionTry=true|&higherEditionClick=true|&thisEditionFeature=false/g,"")).indexOf("&subTab=emailSettings")&&(t=t.replace("action=null","action=mailSelect"));var a="?";if(-1!==t.indexOf("showonlyonhigheredition")){if(-1!==(t=t.replace(/&showonlyonhigheredition=true/g,"")).indexOf("invenmanagemnt")||-1!==t.indexOf("zia"))t="https://"+RebrandLinkUtil.getProperty("CRMURL")+Crm.getCrmBasePath()+"/ShowTab.do?module=Setup";else{for(var r,i=t.slice(t.indexOf("?")+1).split("&"),n=i.length,s=0;s<n;s++){var l=i[s];-1!==l.indexOf("nextclickid")?r=l:-1===l.indexOf("tab")&&-1===l.indexOf("subTab")&&-1===l.indexOf("messagekey")&&((a="?")?a+=l:a=a+"&"+l)}if(r.length>0){var o=r.substring(r.indexOf("=")+1,r.length).split("_");if(a=a+"&tab="+o[0]+"&subTab="+o[1],o.length>2)a=a+"&innerTab="+o[2];t="https://"+RebrandLinkUtil.getProperty("CRMURL")+Crm.getCrmBasePath()+"/ShowSetup.do"+a}}t=t.replace(/&showonlyonhigheredition=true/g,"")}window.location.replace(t);cookieUtils.setCookie("crmtrialEnabedFrmSetup","Closed",200,"/")}}}),renderingUtils.removeFreezeLayer()},moveToFree:function(){var e=csrfParamName+"="+encodeURIComponent(csrfToken);(new crmRequestPool).initiate({type:"POST",url:Crm.getCrmBasePath()+"/Security.do?actionName=cancelSubscription",data:e,success:function(e){"success"===e.STATUS&&$("#SubscriptionExpiryDiv").size()&&Utils.windowLocationReload()}})},showMissingFeatures:function(){var e=$("#editionChangePop");if(e.length)e.show();else{var t=csrfParamName+"="+encodeURIComponent(csrfToken);(new crmRequestPool).initiate({type:"POST",url:Crm.getCrmBasePath()+"/Security.do?actionName=missingFeatures",data:t,success:function(e){var t=networkUtils.returnDependencyFiles(["zohocrm_missingfeaturetemplate.js"],ResourceConstants.CRM);Lyte.injectResources(t,void 0,(function(){var t=(0,Handlebars.templates.MissingFeatures)(e);$("body").append(t)}))}})}},hideMissingFeatures:function(){$("#editionChangePop").hide()},renewSubscription:function(){networkUtils.openUrl("https://"+RebrandLinkUtil.getProperty("STOREURL")+"/html/store/index.html#subscription?serviceId=2&customId="+Crm.userDetails.ZGID)},changeEdition:function(){networkUtils.openUrl("https://"+RebrandLinkUtil.getProperty("STOREURL")+"/html/store/index.html#subscription?serviceId=2&customId="+Crm.userDetails.ZGID+"&renewSubscription=false")}},Search="object"!=typeof Search?{}:Search;Search.addressFieldSetInCriteria=void 0,Search.classNameForHide="searchHide",Search.InfoForPartialLoad=void 0,Search.InfoForDefaultDisplay=void 0,Search.InfoForDefaultDisplayWithLiteUsers=void 0,Search.InfoForSubordinateListing=void 0,Search.divElem=$(document.createElement("div")).attr({class:"wf_chosen_ui wf_no_focus"}).append("<span class='crm-font-regular crm-base-font-size sltSetVal sltBdr dIB'></span>"),Search.inputElem=$(document.createElement("INPUT")).attr({size:"30",maxlength:"250",class:"w342 newinputText pR5 pB7",type:"text"}),Search.inputElem1=$(document.createElement("INPUT")).attr({size:"30",maxlength:"250",class:"datewidth newinputText fL cri_cal",type:"text"}),Search.inputElem2=$(document.createElement("INPUT")).attr({size:"30",maxlength:"250",class:"datewidth newinputText fL",type:"text"}),Search.inputElem3=$(document.createElement("INPUT")).attr({size:"30",maxlength:"250",class:"w342 newinputText fL",type:"text"}),Search.hiddenElem=$(document.createElement("INPUT")).attr({size:"30",maxlength:"250",type:"hidden"}),Search.ownerElem=$(document.createElement("IMG")).attr({width:"17",height:"17",border:"30",align:"absmiddle",class:"OwnerNameLookup",title:"Owner Name Lookup"}),Search.campElem=$(document.createElement("IMG")).attr({width:"17",height:"17",border:"0",align:"absmiddle",class:"Campaigns-small",title:"Campaign Name Lookup"}),Search.MAX_CRT_CNT=25,Search.ageCrt="Age in Days",Search.dueCrt="Due in Days",Search.noOfChar="No of Characters",Search.maxValuesForTextCond=50,Search.include_exclude_comparator_limit=5,Search.include_exclude_values_limit=5,Search.countOfIncludeExcludeCond=new Set,Search.MAX_COL_CNT=100,Search.isFormRuleCriteria=!1,Search.supportMSPOption=!1,Search.isVRCriteria=!1,Search.criteriaDtls=[],Search.numOfCharSupportedComp=["between","not_between","greater_equal","greater_than","less_equal","less_than","not_equal","equal"],Search.dashboardDrillDown_MAX_COL_CNT=150,Search.liteUserSupportFeatures=["Customview","Dashboards","workflowRules","blueprint"],Search.isPatternEditOpen=!1,Search.userIdsForReq=[],Search.userElemMap={},Search.roleElemMap={},Search.numberSeparatorMap=[],Search.folUserRefValues=[],Search.requestedUsers={"${CURRENTUSER}":I18n.getMsg("current.logged.in.user")},Search.deletedUsers=[],Search.isFromScoringRule=!1,Search.analyticsFilterHiddenFields=["SERVICEAVAILABILITY","STARTING_DATE","CLOSING_DATE","AVAILABLE_DATES","AVAILABLE_DAYS","AVAILABLE_CUSTOM_TIMING","UNAVAILABLE_FROM","UNAVAILABLE_TILL","ISJOBSHEETREQUIRED","ENDTIME","S_MODIFIEDTIME","ISJOBSHEETCREATED","JOBSHEETSECTION"],Search.setDefaultValues=function(e,t,a,r,i,n,s,l){if(void 0===t&&(t=1),void 0===s&&(s=""),"create"==e){var o=document.createElement("option"),c=t+s,d=$("#datecondition"+c),m=$("#searchfield"+c);if(Search.createOption(m,"Search._FLD",Search["FLD"+s],o,void 0,a,n,l),$("#divpicklist"+c).length&&(Search.createOption($("#textpicklistcondition"+c),"Search._TXTCOND",Search.isFormRuleCriteria||Search.isFromScoringRule?Search._PICKLISTCOND:Search._TXTCOND,o,void 0,r),Search.createOption($("#consentcondition"+c),"Search._CONSENTCOND",Search._CONSENTCOND,o,void 0,r)),$("#divcallstatus"+c).length&&Search.createOption($("#callstatuscondition"+c),"Search._CALLSTATUSCOND",Search._CALLSTATUSCOND,o,void 0,r),$("#divservicestatus"+c).length&&Search.createOption($("#servicestatuscondition"+c),"Search._SERVICESTATUSCOND",Search._SERVICESTATUSCOND,o,void 0,r),$("#divtext"+c).length&&Search.createOption($("#textcondition"+c),"Search._TXTCOND",Search._TXTCOND,o,void 0,r,void 0,l),$("#enc_divtext"+c).length&&Search.createOption($("#enc_textcondition"+c),"Search._ENCTXTCOND",Search._ENCTXTCOND,o,void 0,r,void 0,l),$("#divuser"+c).length&&Search.createOption($("#usercondition"+c),"Search._USERCOND",Search._USERCOND,o,void 0,r),$("#divmxn"+c).length&&Search.createOption($("#mxncondition"+c),"Search._MXNCOND",Search._MXNCOND,o,void 0,r),$("#divlayout"+c).length&&Search.createOption($("#layoutcondition"+c),"Search._LAYOUTCOND",Search._LAYOUTCOND,o,void 0,r),$("#divwizard"+c).length&&Search.createOption($("#wizardcondition"+c),"Search._WIZARDCOND",Search._WIZARDCOND,o,void 0,r),$("#divtag"+c).length&&Search.createOption($("#tagcondition"+c),"Search._TAGCOND",Search._TAGCOND,o,void 0,r),$("#divcampcv"+c).length&&Search.createOption($("#campcvcondition"+c),"Search._CAMPCVCOND",Search._CAMPCVCOND,o,void 0,r,void 0,l),$("#divdate"+c).length&&Search.createOption(d,"Search._DATETIMECOND",Search.isFormRuleCriteria?Search._MINDATETIMECOND:Search._DATETIMECOND,o,void 0,r,void 0,l),$("#enc_divdate"+c).length&&Search.createOption($("#enc_datecondition"+c),"Search._ENCTXTCOND",Search._ENCTXTCOND,o,void 0,r,void 0,l),$("#divnum"+c).length&&Search.createOption($("#numcondition"+c),"Search._NUMCOND",Search._NUMCOND,o,void 0,r,void 0,l),$("#enc_divnum"+c).length&&Search.createOption($("#enc_numcondition"+c),"Search._ENCNUMCOND",Search._ENCNUMCOND,o,void 0,r,void 0,l),$("#divdatetime"+c).length&&$("#datetimecondition"+c).append(d.children().clone()),$("#enc_divdatetime"+c).length&&Search.createOption($("#enc_datetimecondition"+c),"Search._ENCTXTCOND",Search._ENCTXTCOND,o,void 0,r,void 0,l),$("#divBoolean"+c).length&&Search.createOption($("#booleancondition"+c),"Search._BOOLEANCOND",Search._BOOLEANCOND,o,void 0,r),$("#divprofile"+c).length&&Search.createOption($("#profilecondition"+c),"Search._PROFILECOND",Search._PROFILECOND,o,void 0,r),$("#divrole"+c).length&&Search.createOption($("#rolecondition"+c),"Search._ROLECOND",Search._ROLECOND,o,void 0,r),Search.createOption($("#stagecondition"+c),"Search._STAGECOND1",Search.isFormRuleCriteria||Search.isFromScoringRule?Search._STAGECONDFORM:Search._STAGECOND1,o,void 0,r),Search.createOption($("#ageindayscondition"+c),"Search._AGEINDAYSCOND",Search._AGEINDAYSCOND,o,void 0,r),l){var p=m;p.trigger("change"),p.prop("disabled",!0)}}},Search.getJSONforCriteria=function(e,t,a,r){var i,n;if("blueprint"!==a&&"createProcess"!==a&&void 0===r&&Search.criteriaDtls.length&&(r=Search.criteriaDtls),void 0===r||0===r.length?"createProcess"!==a&&"blueprint"!==a||(n=i=ProcessFlow.criteriaProperties[t]):"AnalyticsChart"===a?(null!==e.match(/\((.*)\)/)&&(e=(e=e.split(e.match(/\((.*)\)/)[0])[0]).trim()),""!==(t=$("#module").val())&&(i=r[t][t]),n=i):n=i=r,"blueprint"===a&&void 0===i&&ProcessBuilder.moduleVsCriOptionsArr&&ProcessBuilder.moduleVsCriOptionsArr[t]&&ProcessBuilder.moduleVsCriOptionsArr[t][0]&&(i=ProcessBuilder.moduleVsCriOptionsArr[t][0][t]),i){for(var s=i.length,l=0;l<s&&(n=i[l]).field_label!==e;l++);if("AnalyticsChart"===a||"wflow"===a||"createProcess"===a||"blueprint"===a||"orchestration"===a)return(32===n.uitype||38===n.uitype||52===n.uitype||117===n.uitype||116===n.uitype)&&!0===n.separator}return!1},Search.reverseFormatNumber=function(e,t,a){var r,i="string"==typeof e;return!i&&e&&"object"!=typeof e&&(e=e.toString()),"between"===t||"not_between"===t||"not between"===t?("object"==typeof e&&(e=e[0]+"~"+e[1]),e=1===e.split("~").length?e.split(","):e.split("~"),a?(e[0]=e[0].toString().replace(new RegExp("\\"+Search.getSeparator(a.Number_Separator),"g"),""),e[0]=e[0].toString().replace(new RegExp("\\"+Search.getSeparator(a.Decimal_Separator)),"."),e[1]=e[1].toString().replace(new RegExp("\\"+Search.getSeparator(a.Number_Separator),"g"),""),e[1]=e[1].toString().replace(new RegExp("\\"+Search.getSeparator(a.Decimal_Separator)),".")):(e[0]=e[0].toString().replace(new RegExp("\\"+Crm.userDetails.numberSeparators.group,"g"),""),e[0]=e[0].toString().replace(new RegExp("\\"+Crm.userDetails.numberSeparators.decimal),"."),e[1]=e[1].toString().replace(new RegExp("\\"+Crm.userDetails.numberSeparators.group,"g"),""),e[1]=e[1].toString().replace(new RegExp("\\"+Crm.userDetails.numberSeparators.decimal),".")),"object"!=typeof e||i?e[0]+","+e[1]:e):(e&&(r=a?(r=e.replace(new RegExp("\\"+Search.getSeparator(a.Number_Separator),"g"),"")).replace(new RegExp("\\"+Search.getSeparator(a.Decimal_Separator)),"."):(r=e.replace(new RegExp("\\"+Crm.userDetails.numberSeparators.group,"g"),"")).replace(new RegExp("\\"+Crm.userDetails.numberSeparators.decimal),".")),r&&e===Search.formatNumber(r)?Number.isNaN(r)?0:r:e)},Search.getSeparator=function(e){switch(e){case"Comma":return",";case"Period":return".";case"Space":return" "}},Search.countCharacters=function(e,t){return t.split(e).length-1},Search.formatNumber=function(e){"string"!=typeof e&&(e=e.toString());var t=null,a=Crm.userDetails.COUNTRY_LOCALE.replace("_","-");if(-1==e.indexOf("~")&&("${EMPTY}"===e||"${NOTEMPTY}"===e||"NaN"===Intl.NumberFormat(a,{maximumFractionDigits:9}).format(e)))return e;if(["ps-AF","bn-BD","es-PR","ar-SA","ar-EG","ar-AE","es-ES","ar-KW","ar-QA"].includes(a)&&(a="en-US"),-1!==e.indexOf(".")&&e.length>16){const a=e.split(".");t=a[1],e=a[0]}e=-1===e.indexOf(".")&&e.length>16?Search.formatBigNumber(e,a):-1!==e.indexOf(".")?Intl.NumberFormat(a,{minimumFractionDigits:1,maximumFractionDigits:9}).format(e):Intl.NumberFormat(a,{maximumFractionDigits:9}).format(e),null!=t&&(e=e+"."+t);var r=new Intl.NumberFormat(a).format(11111).replace(/1/g,""),i=new Intl.NumberFormat(a).format(1.1).replace(/1/g,""),n=e.split(r).join(Crm.userDetails.numberSeparators.group);if(1===Search.countCharacters(i,e)){var s=new RegExp(i+"([^"+i+"]*)$");n=n.replace(s,Crm.userDetails.numberSeparators.decimal+"$1")}return n},Search.getSeparatorsObject=function(e){return e=e.replace("_","-"),{group:new Intl.NumberFormat(e).format(11111).replace(/1/g,""),decimal:new Intl.NumberFormat(e).format(1.1).replace(/1/g,"")}},Search.formatBigNumber=function(e,t){if(e<=999&&e>=-999)return e;var a=new Intl.NumberFormat(t).format(11111).replace(/1/g,"");if(-1===t.indexOf("IN")){var r=e.substring(e.length-3),i=e.substring(0,e.length-3);return Intl.NumberFormat(t,{maximumFractionDigits:9}).format(i)+a+r}r=e.substring(e.length-3),i=e.substring(0,e.length-3);return Search.formatNumberToIndianFormat(i)+a+r},Search.formatNumberToIndianFormat=function(e){return e.toString().replace(/\B(?=(\d{2})+(?!\d))/g,",")},Search.displayLookupExceedsMsg=function(e){getElemById("searchbtn")&&(getElemById("searchbtn").disabled=!1),getElemById("step5Btn")&&(getElemById("step5Btn").disabled=!1);var t=e.responseText;if(t.includes("&#x23;&#x23;&#x23;&#x23;")){const a=document.createElement("div");a.innerHTML=e.responseText,t=a.textContent}var a="";"f"===(t=t.split("####"))[t.length-2]&&(a+="####f"),"r"===t[t.length-1]&&(a+="####r"),t[0]&&""!=t[0]?(getElemById("lookupSelect").style.display="",$("#lookupSelectCol").text(t[0])):getElemById("lookupSelect").style.display="none",t[1]&&""!=t[1]?(getElemById("lookupCrt").style.display="",getElemById("lookupCrtFields").innerText=t[1]):getElemById("lookupCrt").style.display="none",showAnimatePopup("lookupErrorMsg"+a)},Search.showLookupExceedMsg=function(e){e&&((e=e.split("####"))[0]&&""!=e[0]?(getElemById("lookupSelect").style.display="",$("#lookupSelectCol").text(e[0])):getElemById("lookupSelect").style.display="none",e[1]&&""!=e[1]?(getElemById("lookupCrt").style.display="",getElemById("lookupCrtFields").innerText=e[1]):getElemById("lookupCrt").style.display="none",showAnimatePopup("lookupErrorMsg"))},Search.changeInputValue=function(e,t){var a=$("input[name=searchpicklist"+t+"]"),r=e?e.id:"";r||(r=e.attr("id"));var i=$(e).val();(r.indexOf("textpicklistcondition")>-1||r.indexOf("searchpicklist")>-1)&&setCommaSeparatedValues(a,i),r.indexOf("servicestatuscondition")>-1||r.indexOf("searchservicestatus")>-1||r.indexOf("searchselservicestatus")>-1?setCommaSeparatedValues($("#searchservicestatus"+t),i):r.indexOf("layoutcondition")>-1||r.indexOf("searchlayout")>-1?(i=!i||i instanceof Array?i:i.indexOf(",")>-1?i.split(","):[i],setCommaSeparatedValues($("input[name=searchlayout"+t+"]"),i)):r.indexOf("wizardcondition")>-1||r.indexOf("searchwizard")>-1?(i=!i||i instanceof Array?i:i.indexOf(",")>-1?i.split(","):[i],setCommaSeparatedValues($("#inputsearchwizard"+t),i)):r.indexOf("profilecondition")>-1||r.indexOf("searchprofile")>-1?setCommaSeparatedValues($("input[name=searchprofile"+t+"]"),i):r.indexOf("rolecondition")>-1||r.indexOf("searchrole")>-1?setCommaSeparatedValues($("input[name=searchrole"+t+"]"),i):r.indexOf("tagcondition")>-1||r.indexOf("searchtag")>-1?setCommaSeparatedValues($("input[name=searchtag"+t+"]"),i):r.indexOf("searchboolean")>-1&&$("input[name=searchboolean"+t+"]").val(i),"customViewSmartFilters"===$(e).closest("form").attr("name")&&$("#lv_filter_submit").prop("disabled",!1)},Search.editCriteria=function(e){for(var t,a=Search["rowcnt"+e],r=1;r<=a;r++){t=r+e;var i,n,s=$("#searchfield"+t),l=$("#previousSelectedValue"+t),o=$("#textcondition"+t),c=$("#searchtext"+t),d=$("#searchboolean"+t),m=$("#temp_searchcampcv"+t),p=$("#searchfieldtype"+t).val(),h=s.find(":selected").attr("data-enc");switch(p){case"picklist":l.val(s.val()),i=$("#textpicklistcondition"+t).val(),n=$("input[name=searchpicklist"+t+"]"),i&&"None"!==i||(i=o.val(),n=c);var u=n.val();"is empty"!==i&&"is not empty"!==i&&Search.createChosenSelect(t,"edit","picklist",i,u);break;case"L":l.val(s.val()),""===(i=$("#layoutcondition"+t).val())&&(i=$("#textlayoutcondition"+t).val());u=(n=$("input[name=searchlayout"+t+"]")).val();Search.createChosenSelect(t,"edit","layout",i,u);break;case"W":l.val(s.val()),""===(i=$("#wizardcondition"+t).val())&&(i=$("#textwizardcondition"+t).val());u=(n=$("#inputsearchwizard"+t)).val();Search.createChosenSelect(t,"edit","wizard",i,u);break;case"tag":l.val(s.val()),""===(i=$("#tagcondition"+t).val())&&(i=$("#texttagcondition"+t).val());u=(n=$("input[name=searchtag"+t+"]")).val();"is empty"!==i&&"is not empty"!==i&&Search.createChosenSelect(t,"edit","tag",i,u);break;case"Profile":l.val(s.val()),""===(i=$("#profilecondition"+t).val())&&(i=$("#textprofilecondition"+t).val());u=(n=$("input[name=searchprofile"+t+"]")).val();Search.createChosenSelect(t,"edit","profile",i,u);break;case"Role":l.val(s.val()),""===(i=$("#rolecondition"+t).val())&&(i=$("#textrolecondition"+t).val());u=(n=$("input[name=searchrole"+t+"]")).val();Search.createChosenSelect(t,"edit","role",i,u);break;case"T":"true"==h?(i=$("#enc_textcondition"+t).val(),n=$("#enc_searchtext"+t)):(i=o.val(),n=c);break;case"B":i="${NOTEMPTY}"==(n=d.val())?"is not empty":"${EMPTY}"==n?"is empty":"true"==n?"is true":"false"==n?"is false":$("#booleancondition"+t).val();for(var f=!1,v=Search._BOOLEANCOND.length,g=0;g<v;g++)if(Search._BOOLEANCOND[g].contains(i)){f=!0;break}if(!f&&"is true"!=i&&"is false"!=i){var S=document.createElement("option");S.setAttribute("value",i),S.innerHTML=i,S.setAttribute("selected",!0),$("#booleancondition"+t).append(S)}"is empty"!==i&&"is not empty"!==i&&($("input[name=searchboolean"+t+"]").hide(),Search.createChosenSelect(t,"edit","B"));break;case"N":"true"==h?(i=$("#enc_numcondition"+t).val(),n=$("#enc_searchnum"+t)):(i=$("#numcondition"+t).val(),n=$("#searchnum"+t));break;case"CML":i=$("#campcvcondition"+t).val(),n=$("#searchcampcv"+t);break;case"CS":i=$("#callstatuscondition"+t).val(),n=$("#searchcallstatus"+t);break;case"ServiceStatus":l.val(s.val()),i=$("#servicestatuscondition"+t).val();u=(n=$("#searchservicestatus"+t)).val();Search.createChosenSelect(t,"edit","servicestatus",i,u);break;case"consent":i=$("#consentcondition"+t).val();u=(n=$("#searchpicklist"+t)).val();"is empty"!==i&&"is not empty"!==i&&Search.createChosenSelect(t,"edit","picklist",i,u);break;case"D":"true"===h?(i=$("#enc_datecondition"+t).val(),n=$("#enc_searchdate"+t)):(i=$("#datecondition"+t).val(),n=$("#searchdate"+t)),n.attr("placeholder","");break;case"MXN":"true"===h?(i=$("#enc_mxncondition"+t).val(),n=$("#enc_searchmxn"+t)):(i=$("#mxncondition"+t).val(),n=$("#searchmxn"+t));break;case"DT":"true"===h?(i=$("#enc_datetimecondition"+t).val(),n=$("#enc_searchdatedate"+t)):(i=$("#datetimecondition"+t).val(),n=$("#searchdatedate"+t)),n.attr("placeholder","");break;case"stagecond":l.val(s.val()),i=$("#stagecondition"+t).val();u=(n=$("#divstage"+t).find("#searchpicklist"+t)).val();"is empty"!==i&&"is not empty"!==i&&"is OPEN"!==i&&"is WON"!==i&&"is LOST"!==i&&Search.createChosenSelect(t,"edit","picklist",i,u)}("is empty"===i||"is not empty"===i||"is"===i&&"${OPEN}"===n||"${CLOSEDWON}"===n||"${CLOSEDLOST}"===n||"stagecond"===p&&"is OPEN"===i||"is WON"===i||"is LOST"===i)&&(n.val(""),n.attr("readonly",!0),n.attr("style","background:var(--bg_f5f7f9)"),"N"===p?$("#currencyCode"+t).hide():"CML"===p&&m.val("").attr("readonly",!0).attr("style","background:var(--bg_f5f7f9)"))}},Search.createChosenSelect=function(e,t,a,r,i,n,s){if("picklist"===a||"layout"===a||"L"===a||"wizard"===a||"tag"===a||"profile"===a||"role"===a||"servicestatus"===a){var l=$("#searchfield"+e),o=$("input[name=search"+a+e+"]"),c=n?"210px":"358px",d=document.getElementById("div"+a+e),m=(L=n||l.val()).split(":")[1];d=document.getElementById("div"+a+e);"STAGE"===m&&(d=document.getElementById("divstage"+e));var p=$("#"+d.id),h=(M=L.split(":")[0]).split("Crm")[1];"CrmProducts"!=M&&"CrmVendors"!=M&&"CrmPriceBooks"!=M&&h&&-1==M.indexOf("CustomModule")&&-1==M.indexOf("LinkingModule")&&"CrmProcessLogs"!=M&&-1==M.indexOf("CrmOrchestrationDetails")&&(h+="s"),s&&s.indexOf("Orchestration")>=0?h=s:("CrmLeadDetails"==M?h="Leads":"CrmServiceDetails"==M?h="Services":"CrmAppointmentDetails"==M?h="Appointments":"CrmContactDetails"==M?h="Contacts":"CrmVisitDetails"==M?h="Visits":"CrmMassMailDetails"==M?h="Emails":"CrmProcessLogs"==M?h="Blueprints":"CrmConsentDetails"==M?h=$("#lv_left_filter").length?crmListView.getObject().module.replace("privacy_",""):"object"==typeof module?module.value:module:"CrmIamUser"==M?h="Users":"CrmMessageConversations"===M?h="Messages":"CrmReviewProcessDetails"==M?h="Review Processes":"CrmReviewLogs"==M?h="Review Logs":M.indexOf("CrmOrchestrationDetails")>-1?h=Search.repPrimaryModule:"CrmSalesOrderLineItems"===M?h="OrderedItems":"CrmQuoteLineItems"===M?h="QuotedItems":"CrmInvoiceLineItems"===M?h="InvoicedItems":"CrmPurchaseOrderLineItems"===M&&(h="PurchaseItems"),M.indexOf("DetailsNewCF")>-1?h=M.split("Crm")[1].split("DetailsNewCF")[0]+"s":M.indexOf("NewCF")>-1&&(h=M.split("Crm")[1].split("NewCF")[0])),"servicestatus"===a&&(a="sel"+a);var u=document.createElement("select");u.className="chosen-select",u.id="search"+a+e,p.find(".historyTrackerFilterVal").length>0?(u.setAttribute("onChange"," crmListView.evaluteHistoryTracker(this);Search.changeInputValue(this,'"+e+"')"),p.closest("ul").addClass("picklistTracker")):u.setAttribute("onChange","Search.changeInputValue(this,'"+e+"')"),u.setAttribute("style","width:"+c+";"),u.setAttribute("multiple",!0),"tag"!=a&&"layout"!=a&&"L"!=a&&"wizard"!=a&&"profile"!=a&&"role"!=a&&u.setAttribute("data-tags",!0);var f=h;if("CampaignCntRels"!=h&&"CampaignLeadRels"!=h||(f={CampaignCntRels:"CampaignContactsMembers",CampaignLeadRels:"CampaignLeadsMembers"}[h]),!(J=Crm.jsonSelectValues[f]&&Crm.jsonSelectValues[f][m])&&"Tasks"==h&&Crm.jsonSelectValues.Calls?J=Crm.jsonSelectValues.Calls[m]:J||"Activitys"!==h||"CURRENCYISOCODE"!==m||(J=Crm.jsonSelectValues.Tasks[m]),"tag"!==a||J||"Tasks"!=h&&"Calls"!=h&&"Events"!=h||(J=Crm.jsonSelectValues.Tags[h]),!J)return;if(void 0===J.layout_jsonarrayObj||"layout"!==a&&"L"!==a){if(Crm.existningLayoutIdNameMap=void 0,"tag"!=a){for(R=J.length,P=0;P<R;P++)if("-None-"!==J[P]){X=document.createElement("option");var v=J[P].split("!@#");if(v.length>1)(S=document.createElement("input")).setAttribute("type","hidden"),S.setAttribute("id",v[0]),S.setAttribute("value",v[1]),X.setAttribute("value",v[0]),X.innerHTML=$ESAPI.encoder().encodeForHTML(v[1]),p[0].appendChild(S);else X.setAttribute("value",J[P]),X.innerHTML=$ESAPI.encoder().encodeForHTML(crmTab.isZBStatusColumn(m)?I18n.getMsg("zb."+J[P]):J[P]);u.appendChild(X)}}else{var g=J.length;for(P=0;P<g;P++)if(null!==J[P]){X=document.createElement("option");var S,C=J[P];(S=document.createElement("input")).setAttribute("type","hidden"),S.setAttribute("id",C.id),S.setAttribute("value",C.name),X.setAttribute("value",C.id),X.innerHTML=$ESAPI.encoder().encodeForHTML(C.name),p[0].appendChild(S),u.appendChild(X)}}p[0].appendChild(u);F=p.find(".chosen-select");if("edit"===t){if($("input[id=searchtext"+e+"]").className="searchHide",!(j=$("select[id=search"+a+e+"]").val()).length)j=o.val(),(H=o).attr("hidden","true");"tag"!=a||null!=j&&null!=j&&""!=j||!customViewObject.tagFilterValue||""==customViewObject.tagFilterValue||(j=customViewObject.tagFilterValue,delete customViewObject.tagFilterValue),j=i||j,i&&"CrmMassMailDetails"==M&&"SOURCE"==m&&(j=Search.getConvertedSource(i));V=[];if(j){if(j.indexOf("\\")>-1){for(var y,I=new RegExp(/(?:[^\\])\,/g),T=0;null!==(y=I.exec(j));)V[V.length]=j.slice(T,y.index+1).replace(/\\/g,""),T=y.index+2;V[V.length]=j.slice(T).replace(/\\/g,"")}else j.length>0&&(V=j.split(","));if(void 0===Crm.existningLayoutIdNameMap||"layout"!==a&&"L"!==a)if("layout"===a||"L"===a||"tag"===a||"profile"===a||"role"===a){var b,x,w,_={};if(b="layout"===a||"L"===a?Crm.existingLayoutValues:{},"tag"!=a){R=J.length;for(var E=0;E<R;E++)(v=J[E].split("!@#")).length>1&&(x=v[0],w=v[1],_[x]=w)}else{var O={},N=J.length;for(E=0;E<N;E++)x=(O=J[E]).id,w=O.name,_[x]=w}for(R=V.length,k=0;k<R;k++){if(""!==_[x=V[k]]&&void 0!==_[x])(X=document.createElement("option")).setAttribute("value",V[k]),X.innerHTML=_[x];else if(""!==b[x]&&void 0!==b[x]){(X=document.createElement("option")).setAttribute("value",V[k]),X.innerHTML=b[x]}0===F.find("option[value='"+V[k]+"']").length&&u.appendChild(X),F.find("option[value='"+V[k]+"']").prop("selected",!0).trigger("change.select2")}}else{var L=l.val(),D=$("input[name=searchpicklist"+e+"]");if(L&&L.indexOf("CrmProcessLogs")>-1){var M;m=L.split(":")[1];"CrmProcessLogs"!==(M=L.split(":")[0])||"PROCESSID"!==m&&"FROMSTATEID"!==m&&"TRANSITIONID"!==m||setTimeout((function(){$("#searchpicklist"+e).next("span").find("input").prop("readonly",!0);var t=D.val();if(""!=t){for(var a=t.split(","),r=a.length,i="",n=0;n<r;n++){var s=a[n];J.find((function(e){e.trim().startsWith(s.trim()+"!@#")&&(i+=s.trim()+",")}))}i=i.substring(0,i.length-1),D.val(i)}}),100)}for(k=0;k<V.length;k++){if(!J.contains(V[k])&&J.length>0&&!(J[0].indexOf("!@#")>-1))(X=document.createElement("option")).setAttribute("value",V[k]),X.innerHTML=$ESAPI.encoder().encodeForHTML(V[k]),u.appendChild(X);F.find("option[value='"+$.escapeSelector(V[k])+"']").prop("selected",!0).trigger("change.select2")}}else for(var R=V.length,k=0;k<R;k++)F.find("option[value='"+V[k]+"']").prop("selected",!0).trigger("change.select2")}}var A="selservicestatus"===a?$("#searchservicestatus"+e+"_chosen"):$("#search"+a+e+"_chosen");if(thirdPartyUtils.bindSelect2("#"+d.id+" .chosen-select"),r&&["contains","doesn't contain","starts with","ends with"].contains(r)){var B=A.attr("class");A.attr("class",B),p.find("select").on("change",(function(e,t){var a=$(this).attr("id");if($(this).val()&&$(this).val().length>Search.maxValuesForTextCond)return Search.isVRCriteria?$(".validationRuleCongureWarningMsg").text(I18n.getMsg("crm.alert.maximum.text.values.contains",Search.maxValuesForTextCond.toString())).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.maximum.text.values.contains",Search.maxValuesForTextCond.toString())),$("#"+a).find('option[value="'+t.selected+'"]:selected').prop("selected",!1).trigger("change.select2"),!1;$('input[name="'+a+'"]').removeAttr("data-isdef")}))}else p.attr({onclick:"wfForm.checkMultiSelVal(this)"}),p.on("change",(function(e,t){var a=$(this).attr("id");if($(this).val()&&$(this).val().length>Search.maxValuesForTextCond)return Search.isVRCriteria?$(".validationRuleCongureWarningMsg").text(I18n.getMsg("crm.alert.maximum.text.values.contains",Search.maxValuesForTextCond.toString())).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.maximum.text.values.contains",Search.maxValuesForTextCond.toString())),$("#"+a).find('option[value="'+t.selected+'"]:selected').prop("selected",!1).trigger("change.select2"),!1;$('input[name="'+a+'"]').removeAttr("data-isdef")}));A.attr("style","border: 1px solid #c0c6cc; width:"+c+";")}else{p[0].appendChild(u);var F=p.find(".chosen-select");Crm.existningLayoutIdNameMap={};for(var R=(J=Crm.jsonSelectValues[h][m].layout_jsonarrayObj).length,P=0;P<R;P++){var U=J[P];Crm.existningLayoutIdNameMap[U.LAYOUTID]=U.LAYOUTNAME,(X=document.createElement("option")).setAttribute("value",U.LAYOUTID),X.innerHTML=U.LAYOUTNAME,0===F.find("option[value='"+U.LAYOUTID+"']").length&&F.append(X)}if(thirdPartyUtils.bindSelect2("#"+d.id+" select"),"edit"==t)for(var V,R=(V=o.val().split(",")).length,P=0;P<R;P++)F.find("option[value='"+V[P]+"']").prop("selected",!0).trigger("change.select2")}}else if("B"==a){var H,z=$("#divBoolean"+e),Y=$("#searchboolean"+e);(H=$("input[name=searchboolean"+e+"]"))||(H=Y);var j=Y.val();"text"==H.type&&"is empty"!==j&&"is not empty"!==j&&(H.setAttribute("name",""),H.setAttribute("style","display:none;"));var q=document.createElement("select");q.className="chosen-select",q.setAttribute("style","width:200px;"),q.setAttribute("tabindex","-1"),q.setAttribute("onChange","Search.changeInputValue(this,'"+e+"')"),q.id="searchboolean"+e;var W=document.createElement("option");W.setAttribute("value","true"),W.innerHTML=I18n.getMsg("crm.label.selected"),q.appendChild(W);var G=document.createElement("option");if(G.setAttribute("value","false"),G.innerHTML=I18n.getMsg("crm.label.notSelected"),q.appendChild(G),z.addClass("wf_chosen_ui"),z[0].appendChild(q),"edit"===t){H.className="searchHide";var J,X,Q=$("#booleancondition"+e).val();if(!j){j=H.val();"is true"==Q?j="true":"is false"==Q&&(j="false")}if(!(J=["true","false"]).contains(j))(X=document.createElement("option")).setAttribute("value",j),X.innerHTML=j,q.appendChild(X);z.find(".chosen-select").val(j).trigger("change.select2")}else z.find(".chosen-select").trigger("change.select2");thirdPartyUtils.bindSelect2("#divBoolean"+e+" .chosen-select"),$("#searchboolean"+e+"_chosen").attr("style","border: 1px solid #c0c6cc;width:100%;")}},Search.getConvertedSource=function(e){for(var t="",a=e.split(","),r=a.length,i=0;i<r;i++){var n="";switch(a[i]){case"30":n="Workflow Alert";break;case"10":n="Mass Email Scheduler";break;case"15":n="Mass Email";break;case"20":n="Outlook Plugin";break;case"25":n="Autoresponder";break;case"26":n="Autoresponder Follow-up";break;case"35":n="Multiple";break;case"40":n="Individual";break;case"41":n="IMAP";break;case"60":n="BCC Dropbox";break;case"65":n="Event Invitation";break;case"100":n="Plugin Mail"}""!==n&&(""!==t?t+=", "+n:t=n)}return t},Search.setValues=function(e,t){var a={T:"textcondition",U:"usercondition",CML:"campcvcondition",CS:"callstatuscondition",ServiceStatus:"servicestatuscondition",consent:"consentcondition",B:"booleancondition",N:"numcondition",D:"datecondition",DT:"datetimecondition",picklist:"textpicklistcondition",L:"layoutcondition",tag:"tagcondition",MXN:"mxncondition"},r={textcondition:["searchtext"],usercondition:["searchuser"],campcvcondition:["searchcampcv","temp_searchcampcv"],callstatuscondition:["searchcallstatus"],servicestatuscondition:["searchservicestatus"],consentcondition:["searchpicklist"],booleancondition:["searchboolean"],numcondition:["searchnum","searchenum"],datecondition:["searchdate","searchedate"],datetimecondition:["searchstime","searchdatedate","searchsthour","searchstminute","searchstampm","searchenddate","searchethour","searchetminute","searchetampm","searchetime"],textpicklistcondition:["searchpicklist"],layoutcondition:["searchlayout"],textlayoutcondition:["searchlayout"],enc_textcondition:["enc_searchtext"],enc_numcondition:["enc_searchnum"],texttagcondition:["searchtag"]},i=t.rowCount;$("#rowCount").val(i);for(var n=1;n<=i;n++){var s=a[t["searchfieldtype"+n]],l=t[s+n];void 0===t["enc"+n]||!0!==t["enc"+n]&&"true"!==t["enc"+n]||(t["enc_"+s+n]=t[s+n],t[r["enc_"+s]+n]=t[r[s]+n],delete t[s+n],delete t[r[s]+n],s="enc_"+s),1!==n?Search.addCriteria(Search.MAX_CRT_CNT,!0,void 0,t):(Search.setDefaultValues(e,n,t["searchfield"+n],l,s+n,!0),l!==Search.ageCrt&&l!==Search.dueCrt||($("#ageindayscondition"+n).val(t["ageindayscondition"+n]),$("#ageindays"+n).val(t["ageindays"+n]))),$("#match"+n).val(t["match"+n]);var o="and"===t["match"+n];1!==n&&$("#condition_inp"+n).prop("checked",o),Search.changeField("searchfield"+n);var c=r[s];if("picklist"===t["searchfieldtype"+n]||"L"===t["searchfieldtype"+n]){var d=$("#search"+m+n),m=t["searchfieldtype"+n];"L"===t["searchfieldtype"+n]&&(m="layout");var p=t["search"+m+n],h=$("#div"+m+n);$("input[name='search"+m+n+"']").val(p);var u=[];if(p.indexOf(",")>-1){if(p.indexOf("\\")>-1){for(var f,v=new RegExp(/(?:[^\\])\,/g),g=0;null!==(f=v.exec(p));)u[u.length]=p.slice(g,f.index+1).replace(/\\/g,""),g=f.index+2;u[u.length]=p.slice(g).replace(/\\/g,"")}else u=p.split(",");for(var S=u.length,C=0;C<S;C++){if(null==d.find("option[value='"+$.escapeSelector(u[C])+"']").val())(y=document.createElement("option")).setAttribute("value",u[C]),y.innerHTML=u[C],d.append(y);h.find(".chosen-select").find("option[value='"+$.escapeSelector(u[C])+"']").prop("selected",!0).trigger("change.select2")}}else{var y;if(null==h.find("option[value='"+$.escapeSelector(p)+"']").val())(y=document.createElement("option")).setAttribute("value",p),y.innerHTML=p,d.append(y);h.find(".chosen-select").val(p).trigger("change.select2")}}else if("B"===t["searchfieldtype"+n]){(p=t["searchboolean"+n])&&$("#divBoolean"+n).find(".chosen-select").find("option[value="+p+"]").attr("selected","selected").trigger("change.select2"),thirdPartyUtils.bindSelect2("#divBoolean"+n+" .chosen-select")}else if(c){S=c.length;var I=$("#latlong");for(C=0;C<S;C++){if("searchstampm"===c[C]&&$("#searchstampmSpan"+n).html(t[c[C]+n]).attr("ampm",t[c[C]+n]),"searchetampm"===c[C]&&$("#searchetampmSpan"+n).html(t[c[C]+n]).attr("ampm",t[c[C]+n]),"searchuser"===c[C]&&""!=t[c[C]+n]){var T=t[c[C]+n].split(","),b=t["temp_searchuser"+n].split(","),x=$("#temp_searchuser"+n),w=x.find("ul").find("input"),_=[];if(null!=T){S=T.length;for(var E=0;E<S;E++){var O="temp_searchuser"+n,N="temp_searchuser"+n+"_"+T[E];"${CURRENTUSER}"==b[E]&&(b[E]=I18n.getMsg("current.logged.in.user"));var L='<li class="search-choice" data-id="'+T[E]+'" id="sel_'+N+'">'+$ESAPI.encoder().encodeForHTML(b[E])+'<a href="javascript:void(0)" class="search-choice-close" onclick="Search.removeSingleUser(event,this,\''+N+"','"+O+"')\"></a></li>";w.before(L),w.attr("placeholder",""),_.push({id:T[E],full_name:b[E]})}}if(x.attr("selected-users")){var D=x.attr("id"),M=document.getElementById(D);if(M){var R=M.component;R.setData("selectedNames",t["temp_searchuser"+n]),R.setData("usersRecord",_)}}}var k=$("#textcondition"+n);if(void 0!==t[c[C]+n]){if("near to"===k.val()&&I.length){I.val(t.latlong);var A=t.meter+" "+I18n.getMsg("crm.nearby");$("#textcondition"+n+" option").text(A).prop("selected",!0),k.trigger("change.select2")}$("#"+c[C]+n).val(t[c[C]+n])}}}}var B=t.patternVal;if(B){var F=I18n.getProperties();$("#patternVal").val(B);var P=B.replace(new RegExp("and","g"),F.and).replace(new RegExp("or","g"),F.or);$("#pattern").text(P)}},Search.createOption=function(e,t,a,r,i,n,s,l){for(var o=i&&i.length?i.attr("selectedIndex"):-1,c=a.length,d=$(".fieldValidationErrorTxt"),m=0;m<c;m++){var p=a[m],h=p[0];if((!Search.isFormRuleCriteria||"Search._NUMCOND"!=t||"between"!=h&&"not between"!=h)&&(void 0===l&&!d.is(":visible")||"is empty"!=h.trim())){if(!0===s){var u={};if(h.indexOf(":")>-1){var f=p[4];"CrmCampaignLeadRel"===h.split(":")[0]?f="Leads":"CrmCampaignCntRel"===h.split(":")[0]&&(f="Contacts"),u.columnname=f+":"+h.split(":")[1]}}var v=$(r).clone();if(v.attr({value:p[0]}).html(p[1]),p[5]&&v.attr({col:p[5]}),"Search._FLD"===t&&(v.attr({id:p[2],currency:p[3],"data-enc":p[6],"data-enc-related":p[7]}),v.attr({"data-params":JSON.stringify(u)})),i&&m===o&&v.attr("selected","selected"),l&&p[5]&&l===p[5]&&v.prop("selected",!0),n)if(p[0]===n)v.attr("selected","selected");else if("Search._FLD"===t){var g=p[0].split(":");f=p[4];"CrmCampaignLeadRel"==g[0]?f="Leads":"CrmCampaignCntRel"===g[0]&&(f="Contacts"),g[1]===n.split(":")[1]&&n.split(":")[0]===f&&v.prop("selected",!0)}if(e.append(v),0==m){var S=v.closest(".wf_chosen_ui").find(".sltSetVal");S.text(p[1]),"none"===p[1].toLowerCase()&&S.addClass("color_None")}}}if(e.length>0){var C=$("#searchtext"+I),y=e[0].id;if(y.indexOf("textcondition")>-1){var I=y.split("condition")[1];"none"===$("#searchfield"+I).val()&&(C.attr("readonly",!0).attr("style","background:var(--bg_f5f7f9)"),e.prop("disabled",!0))}}},Search.changemmlField=function(e){var t=$("#"+e),a=t.find("option:selected"),r=a.val();t.find("option").removeAttr("selected"),t.val(r),a.attr("selected","selected")},Search.changeField=function(e){var t=e.substring(e.lastIndexOf("d")+1,e.length),a=$("[name='"+e+"']").val(),r=$("[name='multimodulelookup"+t+"']"),i=!1;try{"CrmProcessLogs"===a.split(":")[0]&&(i=!0)}catch(e){}var n=$("#previousSelectedValue"+t),s=n.val(),l=$("#divtext"+t),o=$("#divpicklist"+t),c=$("#divuser"+t),d=$("#divcampcv"+t),m=$("#divdate"+t),p=$("#divnum"+t),h=$("#divdatetime"+t),u=$("#divmxn"+t),f=$("#endTimeFields"+t),v=$("#divBoolean"+t),g=$("#divcallstatus"+t),S=$("#callstatuscond"+t),C=$("#divservicestatus"+t),y=$("#servicestatuscond"+t),I=$("#divlayout"+t),T=$("#divwizard"+t),b=$("#divtag"+t),x=$("#textcond"+t),w=$("#textpicklistcond"+t),_=$("#consentcond"+t),E=$("#usercond"+t),O=$("#campcvcond"+t),N=$("#datecond"+t),L=$("#mxncond"+t),D=$("#numcond"+t),M=$("#datetimecond"+t),R=$("#booleancond"+t),k=$("#layoutcond"+t),A=$("#wizardcond"+t),B=$("#tagcond"+t),F=null,P=$("#userLookup"+t),U=$("#campCvLookup"+t),V=$("#divprofile"+t),H=$("#profilecond"+t),z=$("#divrole"+t),Y=$("#rolecond"+t),j=$("#divstage"+t),q=$("#stagecond"+t),W=$("#searchfield"+t),G=$("#searchfieldtype"+t),J=W.find("option:selected");0==J.length&&(W[0].selectedIndex=1,J=W.find("option:selected"));var X=J.attr("data-enc"),Q=J.attr("data-enc-related"),Z=null,K=null,ee=null,te=null,ae=null,re=null,ie=null,ne=null,se=null,le=null,oe="textcondition",ce=$("#textcondition"+t);"true"===X||"true"===Q?(Z=l,ee=p,K=u,te=x,ae=D,ie=L,se=m,le=h,re=N,ne=M,l=$("#enc_divtext"+t),p=$("#enc_divnum"+t),u=$("#enc_divmxn"+t),x=$("#enc_textcond"+t),D=$("#enc_numcond"+t),m=$("#enc_divdate"+t),h=$("#enc_divdatetime"+t),N=$("#enc_datecond"+t),L=$("#enc_mxncond"+t),M=$("#enc_datetimecond"+t),F=$("#enc_searchtext"+t),oe="enc_textcondition",ce=$("#enc_textcondition"+t)):(Z=$("#enc_divtext"+t),ee=$("#enc_divnum"+t),K=$("#enc_divmxn"+t),te=$("#enc_textcond"+t),ae=$("#enc_numcond"+t),ie=$("#enc_mxncond"+t),se=$("#enc_divdate"+t),le=$("#enc_divdatetime"+t),re=$("#enc_datecond"+t),ne=$("#enc_datetimecond"+t),F=$("#searchtext"+t));var de=$("[name=actdiv"+t+"]"),me=!1;Z.addClass(Search.classNameForHide),te.css("display","none"),ee.addClass(Search.classNameForHide),ae.css("display","none"),se.addClass(Search.classNameForHide),re.css("display","none"),K.addClass(Search.classNameForHide),ie.css("display","none"),le.addClass(Search.classNameForHide),ne.css("display","none"),l.addClass(Search.classNameForHide),x.css("display","none"),o.addClass(Search.classNameForHide),w.css("display","none"),g.addClass(Search.classNameForHide),S.css("display","none"),C.addClass(Search.classNameForHide),y.css("display","none"),c.addClass(Search.classNameForHide),E.css("display","none"),c.addClass("pR"),d.addClass(Search.classNameForHide),O.css("display","none"),m.addClass(Search.classNameForHide),N.css("display","none"),u.addClass(Search.classNameForHide),L.css("display","none"),p.addClass(Search.classNameForHide).removeClass("dIB"),D.css("display","none"),h.addClass(Search.classNameForHide),M.css("display","none"),v.addClass(Search.classNameForHide),R.css("display","none"),I.addClass(Search.classNameForHide),k.css("display","none"),T.addClass(Search.classNameForHide),A.css("display","none"),b.addClass(Search.classNameForHide),B.css("display","none"),V.addClass(Search.classNameForHide),H.css("display","none"),z.addClass(Search.classNameForHide),Y.css("display","none"),j.addClass(Search.classNameForHide),q.css("display","none"),P.addClass(Search.classNameForHide),U.addClass(Search.classNameForHide),_.css("display","none"),f.css("display","none"),de.hide(),p.removeClass("cri_cur_div"),$("#endNumFields"+t).css("display","none"),$("#enddateFields"+t).css("display","none"),$("#ageindayscond"+t).css("display","none"),$("#divageindays"+t).addClass(Search.classNameForHide);var pe=J.attr("id");"none"===a?($(ce).find("option[value=None]").attr("selected","selected"),ce.prop("disabled",!0)):ce.prop("disabled",!1);var he=W.val(),ue=Search.FLD_1;void 0===ue&&(ue=Search.FLD);var fe=Search.mml_1;if(fe){var ve=Search.mmllabel_1,ge=0,Se=0;ue&&ue.each((function(e){e[0]===a&&(ge=Se),Se++})),ue&&fe&&(ue.length!==fe.length&&(ge-=1),ge<0&&(ge=0));var Ce=fe[ge],ye=ve[ge];if(Se=0,r.empty(),1===Ce.length&&"none"===Ce[0])r.parent().parent().hide(),$("#searchcriteria"+t+"> #mmlInText").hide();else r.parent().css("display","block").parent().css("display","block"),$("#searchcriteria"+t+"> #mmlInText").css("display","block");if(void 0!==Ce){var Ie=Ce.length;for(let e=0;e<Ie;e++)r.append($("<option></option>").attr({value:Ce[e]}).text(ye[e]))}}W.find("option").removeAttr("selected"),W.val(he),J.attr("selected","selected"),-1!==he.indexOf("LATITUDE")?(Search.addressFieldSetInCriteria=t,$("#searchlayer").find("select[id^='searchfield']").each((function(e,a){$(this);if(this.id.split("searchfield")[1]!==t){var r=$(this).find("option[value*='LATITUDE']"),i={index:r.index(),obj:r};$("#searchlayer").data("indObj",i),r.remove()}})),Search.addressFieldSetInCriteria=t):null!=Search.addressFieldSetInCriteria&&Search.addressFieldSetInCriteria==t&&(Search.addressFieldSetInCriteria=void 0,$("#searchlayer").find("select[id^='searchfield']").each((function(e,a){var r=$(this),i=this.id.split("searchfield"),n=$("#searchlayer").data("indObj"),s=n.obj.clone();i[1]!==t&&r.find("option:eq('"+(parseInt(n.index)-1)+"')").after(s)})));var $e=$("input[name=searchpicklist"+t+"]"),Te=$("input[name=searchboolean"+t+"]");switch("picklist"===pe&&a.indexOf("CrmPotential:STAGE")>-1&&(pe="stagecond"),pe){case"picklist":oe="textpicklistcondition";var be=$("#"+oe+t);if(G.val(pe),w.css("display",""),o.removeClass(Search.classNameForHide),s!==a){if((Ne=$("select[id=searchpicklist"+t+"]")).length>0)Ne.hasClass("select2-hidden-accessible")&&$(Ne).select2("destroy"),Ne[0].parentNode.removeChild(Ne[0]),(Le=$("#searchpicklist"+t+"_chosen")).length>0&&Le[0].parentNode.removeChild(Le[0]);$e.val(""),("None"==be.val()||"is empty"==be.val()||"is not empty"==be.val()||i)&&$e.attr("readonly",!0).attr("style","background:transparent"),i&&(thirdPartyUtils.unbindSelect2(be[0]),be.find("option").each((function(e,t){var a=(t=$(t)).val();"contains"!==a&&"doesn't contain"!==a&&"starts with"!==a&&"ends with"!==a&&"is empty"!==a&&"is not empty"!==a||t.remove()})),thirdPartyUtils.bindSelect2(be[0]))}n.val(a);break;case"T":if(G.val(pe),he.indexOf("LATITUDE")>-1)x.find("option").remove().end(),x.find("select").append("<option value='near to'>"+I18n.getMsg("Near By")+"</option>"),x.find("select").find("option[value='near to']").attr("selected","selected"),x.find("select").trigger("change.select2"),F.attr("onClick","populateMap(this)"),F.attr("placeholder",I18n.getMsg("crm.chooselocation")),F.attr("style","");else if(x.find("select option[value='near to']").length>0){me=!0;for(var xe=$("#textConditionBackup").val().split("~~~"),we=0;we<xe.length;we++){var _e=xe[we].split("===");void 0!==_e&&void 0!==_e[0].trim&&x.find("select").append("<option value='"+_e[0]+"'>"+_e[1]+"</option>")}x.find('option[value="near to"]').remove(),x.find("select").find("option[value='None']").attr("selected","selected"),x.find("select").trigger("change.select2"),F.attr("placeholder",""),F.attr("onClick","")}x.css("display",""),l.removeClass(Search.classNameForHide),l.css("display",""),"true"===X&&l.find("input").css("display","");break;case"U":oe="usercondition",G.val(pe),E.css("display",""),c.removeClass(Search.classNameForHide),$("#temp_searchuser"+t).css("display",""),$("#userImg"+t).css("display",""),(a.indexOf("SMOWNER")>-1||a.indexOf("AaaUser")>-1||a.indexOf(":SMCREATORID:")>-1||a.indexOf(":MODIFIEDBY:")>-1||a.indexOf(":HANDLER")>-1||a.indexOf("LASTMODIFIED")>-1)&&P.removeClass(Search.classNameForHide);var Ee=c.find("crm-multiuserdd-wrapper#temp_searchuser"+t);Ee&&1===Ee.length&&(a.indexOf("SMCREATORID")>-1||a.indexOf("MODIFIEDBY")>-1?Ee[0].component.setData("queryparam",{include_lite_users:!0}):Ee[0].component.setData("queryparam",{}));var Oe=$("#ownerNameLookup_temp_searchuser"+t);s&&Oe.length>0&&Oe.remove(),n.val(a);break;case"CML":oe="campcvcondition",G.val(pe),O.css("display",""),d.removeClass(Search.classNameForHide),(a.indexOf("CrmCampaignLeadRel")>-1||a.indexOf("CrmCampaignCntRel")>-1)&&U.removeClass(Search.classNameForHide);break;case"CS":oe="callstatuscondition",G.val(pe),S.css("display",""),g.removeClass(Search.classNameForHide),g.css("display",""),$("#searchcallstatus"+t).removeClass("w70 datewidth").addClass("w342").attr("readonly","readonly").attr("style","display:block;background:var(--bg_f5f7f9);color:#eee;");break;case"ServiceStatus":oe="servicestatuscondition",G.val(pe),y.css("display",""),C.removeClass(Search.classNameForHide),C.css("display",""),$("#searchservicestatus"+t).removeClass("w70 datewidth").addClass("w342").attr("readonly","readonly").attr("style","display:block;background:var(--bg_f5f7f9);color:#eee;");break;case"consent":oe="consentcondition";be=$("#"+oe+t);if(G.val(pe),_.css("display",""),o.removeClass(Search.classNameForHide),s!==a){var Ne,Le;if((Ne=$("select[id=searchpicklist"+t+"]")).length>0)Ne.hasClass("select2-hidden-accessible")&&$(Ne).select2("destroy"),Ne[0].parentNode.removeChild(Ne[0]),(Le=$("#searchpicklist"+t+"_chosen")).length>0&&Le[0].parentNode.removeChild(Le[0]);$e.val(""),("None"==be.val()||"is empty"==be.val()||"is not empty"==be.val()||i)&&$e.attr("readonly",!0).attr("style","background:transparent"),i&&(thirdPartyUtils.unbindSelect2(be[0]),be.find("option").each((function(e,t){var a=(t=$(t)).val();"contains"!==a&&"doesn't contain"!==a&&"starts with"!==a&&"ends with"!==a&&"is empty"!==a&&"is not empty"!==a||t.remove()})),thirdPartyUtils.bindSelect2(be[0]))}n.val(a);break;case"D":oe="true"===X?"enc_datecondition":"datecondition",G.val(pe),N.css("display",""),m.removeClass(Search.classNameForHide).addClass("fL");break;case"MXN":oe="true"===X?"enc_mxncondition":"mxncondition",G.val(pe),L.css("display","");break;case"N":oe="true"===X?"enc_numcondition":"numcondition",G.val(pe),D.css("display",""),p.removeClass(Search.classNameForHide).addClass("fL"),J&&("false"===X&&J.attr("currency")&&"true"===J.attr("currency")&&"true"===W.attr("multicurrencyenabled")?getElemById("currencyCode"+t).style.display="inline-block":getElemById("currencyCode"+t).style.display="none"),p.addClass("cri_cur_div"),p.removeClass("no_cur_div"),$("#currencyCode"+t).addClass("w30");break;case"DT":oe="true"===X?"enc_datetimecondition":"datetimecondition",G.val(pe),M.css("display",""),h.removeClass(Search.classNameForHide).addClass("");var De=getElemById(oe+t);Search.changeCriteria(t,De);break;case"B":oe="booleancondition",G.val(pe),R.css("display",""),v.removeClass(Search.classNameForHide),Te[0].readOnly="true";break;case"L":oe="layoutcondition",G.val(pe),k.css("display",""),I.removeClass(Search.classNameForHide);break;case"W":oe="wizardcondition",G.val(pe),A.css("display",""),T.removeClass(Search.classNameForHide);break;case"tag":oe="tagcondition",G.val(pe),B.css("display",""),b.removeClass(Search.classNameForHide);break;case"Profile":oe="profilecondition",G.val(pe),H.css("display",""),V.removeClass(Search.classNameForHide);break;case"Role":oe="rolecondition",G.val(pe),Y.css("display",""),z.removeClass(Search.classNameForHide);break;case"ActivityType":if(G.val("T"),de.length)de.show(),Search.changeValue(de.last().children().get(0),"type");else{var Me=Search.addSelectTag(Search.actCriteria,x.parent(),t);Search.changeValue(Me,"criteria"),thirdPartyUtils.bindSelect2(Me),Me=Search.addSelectTag(Search.params,l.parent(),t),Search.changeValue(Me,"type"),thirdPartyUtils.bindSelect2(Me)}break;case"stagecond":oe="stagecondition",G.val(pe),q.css("display",""),j.removeClass(Search.classNameForHide),"None"!==(be=$("#"+oe+t)).val()&&"is empty"!==be.val()&&"is not empty"!==be.val()||$e.attr("readonly",!0).attr("style","background:transparent")}var Re=getElemById(oe+t);("ActivityType"!==pe&&"None"!=Re.value&&"near to"!=Re.value||me)&&Search.checkEmptyCdn(Re,"","",!0),thirdPartyUtils.bindSelect2($("#searchcriteria"+t).find(".wf_chosen_ui select"))},Search.changeValue=function(e,t){var a,r=e.parentNode.getAttribute("name").match(/\d+/)[0];"criteria"===t?a=e.value:null===(a=$(e).val())?a="":"object"==typeof a&&(a=a.join(",")),$("#searchfieldtype"+r).val("T"),"criteria"===t?$("#textcondition"+r).val(a):$("#searchtext"+r).val(a)},Search.addSelectTag=function(e,t,a){var r=renderingUtils.createSelectBox(e.option,Boolean(e.multiSelect),void 0,e.select.attr);r.onchange=e.select.events.onchange,$(r).removeClass("select");var i=document.createElement("div");return i.setAttribute("id","actdiv_"+e.type+a),i.setAttribute("name","actdiv"+a),e.multiSelect||i.setAttribute("class","wf_chosen_ui"),$(i).append(r),$(t).append(i),r},Search.addCriteria=function(e,t,a,r){a=void 0!==a?a:"";var i=getElemById("newpattern"+a);if(i&&"block"===i.style.display)return alert(I18n.getMsg("crm.alert.label.savepattern","")),!1;var n=Search["rowcnt"+a];if(n=parseInt(n)+1,e&&n>e)return alert(I18n.getMsg("crm.criteria.max.rowcnt.exceeds","")),!1;Search["rowcnt"+a]=n;var s=$(document.createElement("TR")),l=$(document.createElement("TD")),o=$(document.createElement("DIV")),c=$(document.createElement("INPUT")),d=$(document.createElement("SPAN")),m=$(document.createElement("SELECT")),p=document.createElement("option"),h=t&&r;n>1&&getElemById("critTable"+a)&&(getElemById("critTable"+a).style.display=""),"AssignCriteria"===frmName&&n>=3||"AutoFollowUpForm"===Search.calform&&n>=4&&$("#feedsLookupDiv").css("height","auto"),getElemById("check1"+a).style.display="";var u=n+a,f=n-1+a;s=s.attr({id:"searchcriteria"+u,"data-zcqa":"searchcriteria"+u}),$("#critTable"+a).before(s);var v=l.clone();s.append(v);var g=l.clone().attr({align:"left"}),S=$('<img src="'+Search.spacerImg+'" data-zcqa="check'+u+'"  id="check'+u+'" class="removeCriteria"/>');S.on("click",(function(){Search.removeCriteria(this.id,t,a)})),$("#addRow1"+a).remove();var C=$('<img id="addRow1'+a+'" data-zcqa="addRow1'+a+'"  src="'+Search.spacerImg+'" class="addCriteria"/>');C.on("click",(function(){Search.addCriteria(e,t,a)})),g.append(S),g.append(C);var y=l.clone(),I=l.clone(),T=l.clone(),b=l.clone(),x=l.clone(),w=l.clone();w.attr({id:"mmlInText",width:"40",class:"mmlInText"}).hide();var _=m.clone().attr({name:"match"+u,"data-zcqa":"match"+u,id:"match"+u}).hide();_.on("change",(function(){Search.changeOprValPattern(this.id,a)})),""==y.text()&&y.attr("width","");var E='<label id="matchConditionLabel'+u+'" class="cus_cb_label" onclick="wfForm.setOprSel(this,\''+u+'\');"><input type="checkbox" id="condition_inp'+u+'" class="cus_cb_inp" onclick="sE(event);" checked><span class="cus_cb_sp"><span id="matchCndtnAnd'+u+'" class="cus_cb_and alink">'+I18n.getMsg("crm.label.and")+'</span><span id="matchCndtnOr'+u+'" class="cus_cb_or alink">'+I18n.getMsg("crm.label.or")+"</span></span></label>";v.append(o.clone().addClass("andOrOp").append(E).append(_)),Search.createOption(_,"Search._MATCH",Search._MATCH,p,$("#match"+f)),s.append(I),s.append(b),s.append(T);var O=Search.hiddenElem.clone().attr({id:"searchfieldtype"+u,name:"searchfieldtype"+u});O.val("T"),T.append(O).addClass("wf_field_type_td").attr("id","wf_field_type_td"),c.attr({id:"patternNum"+u,type:"text",class:"searchMatchText",readonly:"readonly",value:n}),v.append(c);var N=$("#searchfield"+f),L=$("[name='multimodulelookup"+f+"']"),D=(N=$("#searchcriteria"+f),$("#searchcriteria"+f+"> #mmlInText").clone()),M=L.parent().parent().clone().children(),R=M.children();R.children().first().attr("name","multimodulelookup"+u),R.last().remove(),R.attr("name","multimodulelookup"+u),M.hide(),x.append(M),w.append(D.children());var k=m.clone().attr({name:"searchfield"+u,"data-zcqa":"searchfield"+u,id:"searchfield"+u,multicurrencyenabled:N.attr("multicurrencyenabled")});k.on("change",(function(){Search.changeField(this.id),wfForm.setSltVal(this)}));var A,B=Search.divElem.clone().attr({onmouseover:"Search.hideCS(this)"}),F=Search.hiddenElem.clone().attr({name:"previousSelectedValue"+u,id:"previousSelectedValue"+u});B.append(F),I.append(B.append(k)),"undefined"!=typeof ProcessBuilder&&ProcessBuilder.colNameToValidate&&""!==ProcessBuilder.colNameToValidate&&(A=ProcessBuilder.colNameToValidate),Search.createOption(k,"Search._FLD",Search["FLD"+a],p,void 0,h?r[k.attr("id")]:void 0,t,A);var P=o.clone().attr({id:"divtext"+u});T.append(P);var U=m.clone().attr({name:"textcondition"+u,"data-zcqa":"textcondition"+u,id:"textcondition"+u});U.on("change",(function(){Search.checkEmptyCdn(this),wfForm.setSltVal(this)}));var V=Search.divElem.clone().attr({id:"textcond"+u});V.css("display",""),b.append(V.append(U)),Search.createOption(U,"Search._TXTCOND",Search._TXTCOND,p,void 0,h?r[U.attr("id")]:void 0);var H=Search.inputElem.clone().attr({id:"searchtext"+u,"data-zcqa":"searchtext"+u,name:"searchtext"+u,readonly:"true",style:"background:var(--bg_f5f7f9)",onkeypress:"return Search.limitTextValues(this,event);",onpaste:"return Search.limitTextValues(this,event);"}).removeAttr("maxlength");P.append(H),H.focus();var z=$(document.createElement("DIV")).attr({id:"nearto"+u});z.css("display","none"),z.html(I18n.getMsg("crm.custom.field.nearto")),P.append(z);var Y=o.clone().attr({id:"enc_divtext"+u});T.append(Y);var j=m.clone().attr({name:"enc_textcondition"+u,"data-zcqa":"enc_textcondition"+u,id:"enc_textcondition"+u});j.on("change",(function(){Search.checkEmptyCdn(this),wfForm.setSltVal(this)}));var q=Search.divElem.clone().attr({id:"enc_textcond"+u});q.css("display","none"),b.append(q.append(j)),Search.createOption(j,"Search._ENCTXTCOND",Search._ENCTXTCOND,p,void 0,h?r[j.attr("id")]:void 0);var W=Search.inputElem.clone().attr({id:"enc_searchtext"+u,"data-zcqa":"enc_searchtext"+u,name:"enc_searchtext"+u,readonly:"true",style:"display:none",onkeypress:"return Search.limitTextValues(this,event);",onpaste:"return Search.limitTextValues(this,event);"}).removeAttr("maxlength");Y.append(W),W.focus();var G=$(document.createElement("DIV")).attr({id:"nearto"+u});G.css("display","none"),G.html(I18n.getMsg("crm.custom.field.nearto")),Y.append(G);var J=o.clone().attr({id:"divpicklist"+u});T.append(J);var X=m.clone().attr({name:"textpicklistcondition"+u,id:"textpicklistcondition"+u});X.on("change",(function(){Search.checkEmptyCdn(this),wfForm.setSltVal(this)}));var Q=Search.divElem.clone().attr({id:"textpicklistcond"+u});Q.css("display","none"),b.append(Q.append(X)),Search.createOption(X,"Search._TXTCOND",Search.isFormRuleCriteria||Search.isFromScoringRule?Search._PICKLISTCOND:Search._TXTCOND,p,void 0,h?r[X.attr("id")]:void 0);var Z=o.clone().attr({id:"divstage"+u});T.append(Z);var K=m.clone().attr({name:"stagecondition"+u,id:"stagecondition"+u});K.on("change",(function(){Search.checkEmptyCdn(this),wfForm.setSltVal(this)}));var ee=Search.divElem.clone().attr({id:"stagecond"+u});ee.css("display","none"),b.append(ee.append(K)),Search.createOption(K,"Search._STAGECOND1",Search.isFormRuleCriteria||Search.isFromScoringRule?Search._STAGECONDFORM:Search._STAGECOND1,p,void 0,h?r[K.attr("id")]:void 0);var te=Search.inputElem.clone().attr({name:"searchpicklist"+u,readonly:"true",style:"display:none;"});J.append(te),Z.append(te);var ae=o.clone().attr({id:"divcallstatus"+u});T.append(ae);var re=m.clone().attr({name:"callstatuscondition"+u,id:"callstatuscondition"+u});re.on("change",(function(){Search.checkEmptyCdn(this)}));var ie=Search.divElem.clone().attr({id:"callstatuscond"+u});ie.css("display","none"),b.append(ie.append(re)),Search.createOption(re,"Search._CALLSTATUSCOND",Search._CALLSTATUSCOND,p,void 0,h?r[re.attr("id")]:void 0);var ne=Search.inputElem.clone().attr({name:"searchcallstatus"+u,id:"searchcallstatus"+u,readonly:"true",style:"display:none;"});if(ae.append(ne),Search.isFormRuleCriteria){var se=o.clone().attr({id:"divservicestatus"+u});T.append(se);var le=m.clone().attr({name:"servicestatuscondition"+u,id:"servicestatuscondition"+u});le.on("change",(function(){Search.checkEmptyCdn(this)}));var oe=Search.divElem.clone().attr({id:"servicestatuscond"+u,style:"display:none;"});b.append(oe.append(le)),Search.createOption(le,"Search._SERVICESTATUSCOND",Search._SERVICESTATUSCOND,p,void 0,h?r[le.attr("id")]:void 0);var ce=Search.inputElem.clone().attr({name:"searchservicestatus"+u,id:"searchservicestatus"+u,readonly:"true",style:"display:none;"});se.append(ce)}var de=m.clone().attr({name:"consentcondition"+u,id:"consentcondition"+u});de.on("change",(function(){Search.checkEmptyCdn(this)}));var me=Search.divElem.clone().attr({id:"consentcond"+u});me.css("display","none"),b.append(me.append(de)),Search.createOption(de,"Search._CONSENTCOND",Search._CONSENTCOND,p,void 0,h?r[de.attr("id")]:void 0);var pe=o.clone().attr({id:"divuser"+u,class:"userDiv"});T.append(pe);var he=m.clone().attr({name:"usercondition"+u,id:"usercondition"+u});he.on("change",(function(){Search.checkEmptyCdn(this),wfForm.setSltVal(this)}));var ue=Search.divElem.clone().attr({id:"usercond"+u});ue.css("display","none"),b.append(ue.append(he)),Search.createOption(he,"Search._USERCOND",Search._USERCOND,p,void 0,h?r[he.attr("id")]:void 0);var fe=Search.hiddenElem.clone().attr({id:"searchuser"+u,name:"searchuser"+u});if(pe.append(fe),!t){var ve=Search.divElem.clone().attr({id:"temp_searchuser"+u,name:"searchUserLookup",class:"chosen-container chosen-container-multi ",style:"min-height:31px;height:auto;display:none;",onclick:"Search.showLookup(this.id)","data-withmultipleoptions":"yes","data-withemail":"yes","data-deactivatedusers":"yes"});$(ve).find(".sltSetVal").remove();var ge=$(document.createElement("ul")).addClass("chosen-choices"),Se=Search.inputElem.clone().attr({id:"hostSearch_temp_searchuser"+u,placeholder:I18n.getMsg("crm.label.select.user"),name:"hostSearch",class:"lookUpSearch newinputText",onkeydown:"Search.searchOnKeyDown(this,event)",style:"float:left;s border: none; border: 0px;  background: transparent;"});ge.append(Se),ve.append(ge),ve.on("click",(function(){Search.showLookup(this.id)})),pe.append(ve)}var Ce=o.clone().attr({id:"divlayout"+u});T.append(Ce);var ye=m.clone().attr({name:"layoutcondition"+u,id:"layoutcondition"+u});ye.on("change",(function(){Search.checkEmptyCdn(this)}));var Ie=Search.divElem.clone().attr({id:"layoutcond"+u});Ie.css("display","none"),b.append(Ie.append(ye)),Search.createOption(ye,"Search._LAYOUTCOND",Search._LAYOUTCOND,p,void 0,h?r[ye.attr("id")]:void 0);var $e=Search.inputElem.clone().attr({name:"searchlayout"+u,readonly:"true",style:"display:none;"});Ce.append($e);var Te=o.clone().attr({id:"divwizard"+u});T.append(Te);var be=m.clone().attr({name:"wizardcondition"+u,id:"wizardcondition"+u});be.bind("change",(function(){Search.checkEmptyCdn(this)})),T.append(Te);var xe=Search.divElem.clone().attr({id:"wizardcond"+u});xe.css("display","none"),b.append(xe.append(be)),Search.createOption(be,"Search._WIZARDCOND",Search._WIZARDCOND,p,void 0,h?r[be.attr("id")]:void 0);var we=Search.inputElem.clone().attr({name:"searchwizard"+u,id:"inputsearchwizard"+u,readonly:"true",style:"display:none;"});Te.append(we);var _e=o.clone().attr({id:"divtag"+u});T.append(_e);var Ee=m.clone().attr({name:"tagcondition"+u,id:"tagcondition"+u});Ee.bind("change",(function(){Search.checkEmptyCdn(this)}));var Oe=Search.divElem.clone().attr({id:"tagcond"+u});Oe.css("display","none"),b.append(Oe.append(Ee)),Search.createOption(Ee,"Search._TAGCOND",Search._TAGCOND,p,void 0,h?r[Ee.attr("id")]:void 0);var Ne=Search.inputElem.clone().attr({name:"searchtag"+u,readonly:"true",style:"display:none;"});_e.append(Ne);var Le=o.clone().attr({id:"divprofile"+u});T.append(Le);var De=m.clone().attr({name:"profilecondition"+u,id:"profilecondition"+u});De.on("change",(function(){Search.checkEmptyCdn(this)}));var Me=Search.divElem.clone().attr({id:"profilecond"+u});Me.css("display","none"),b.append(Me.append(De)),Search.createOption(De,"Search._PROFILECOND",Search._PROFILECOND,p,void 0,h?r[De.attr("id")]:void 0);var Re=Search.inputElem.clone().attr({name:"searchprofile"+u,readonly:"true",style:"display:none;"});Le.append(Re);var ke=o.clone().attr({id:"divrole"+u,class:"searchHide"});T.append(ke);var Ae=m.clone().attr({name:"rolecondition"+u,id:"rolecondition"+u});Ae.on("change",(function(){Search.checkEmptyCdn(this)}));var Be=Search.divElem.clone().attr({id:"rolecond"+u});Be.css("display","none"),b.append(Be.append(Ae)),Search.createOption(Ae,"Search._ROLECOND",Search._ROLECOND,p,void 0,h?r[Ae.attr("id")]:void 0);var Fe=$(document.createElement("a")).attr({"data-zcqa":"img_slctRole",onclick:"rolesLookUp(this,'userrole','','searchrole"+u+"');blockContent('roleName_Add',event);",class:"cP addUserIcon dIB fR",align:"absmiddle",border:"0"}),Pe=Search.inputElem.clone().attr({name:"searchrole"+u,readonly:"true",style:"display:none;"});if(ke.append(Fe),ke.append(Pe),getElemById("divcampcv"+f)){var Ue=o.clone().attr({id:"divcampcv"+u}).addClass("pR");T.append(Ue);var Ve=m.clone().attr({name:"campcvcondition"+u,id:"campcvcondition"+u});Ve.on("change",(function(){Search.checkEmptyCdn(this)}));var He=Search.divElem.clone().attr({id:"campcvcond"+u});He.css("display","none"),b.append(He.append(Ve)),Search.createOption(Ve,"Search._CAMPCVCOND",Search._CAMPCVCOND,p,void 0,h?r[Ve.attr("id")]:void 0);var ze=Search.hiddenElem.clone().attr({id:"searchcampcv"+u,name:"searchcampcv"+u}),Ye=Search.inputElem.clone().attr({id:"temp_searchcampcv"+u,readonly:"readonly",style:"display:none"}),je=d.clone().attr({id:"campCvLookup"+u}).attr({style:"position:absolute; right:10px; top:7px"}),qe=Search.campElem.clone().attr({id:"campCvImg"+u,src:Search.spacerImg,style:"display:none"});qe.on("click",(function(){return Search.campLookup(this.id)})),je.append(qe),Ue.append(Ye),Ue.append(ze),Ye.focus(),Ue.append(je)}var We=o.clone().attr({id:"divdate"+u});T.append(We);var Ge=m.clone().attr({name:"datecondition"+u,id:"datecondition"+u});Ge.on("change",(function(){Search.checkEmptyCdn(this),wfForm.setSltVal(this)}));var Je=Search.divElem.clone().attr({id:"datecond"+u});Je.css("display","none"),b.append(Je.append(Ge)),Search.createOption(Ge,"Search._DATETIMECOND",Search.isFormRuleCriteria?Search._MINDATETIMECOND:Search._DATETIMECOND,p,void 0,h?r[Ge.attr("id")]:void 0);var Xe=Search.inputElem1.clone().attr({id:"searchdate"+u,name:"searchdate"+u,placeholder:Search.userDatePattern,style:"display:none"});Xe.on("click",(function(){return showCalen(this.id,void 0,void 0,void 0,!0)})),(Lt=o.clone().attr({id:"enddateFields"+u})).css("display","none"),T.append(Lt),(Dt=Search.inputElem1.clone().attr({id:"searchedate"+u,name:"searchedate"+u,size:"15",placeholder:Search.userDatePattern})).on("click",(function(){return showCalen(this.id,void 0,void 0,void 0,!0)})),Dt.addClass("mL10"),Lt.append(Dt),We.append(Xe),Xe.focus();We=o.clone().attr({id:"enc_divdate"+u});T.append(We);var Qe=m.clone().attr({name:"enc_datecondition"+u,id:"enc_datecondition"+u});Qe.on("change",(function(){Search.checkEmptyCdn(this),wfForm.setSltVal(this)}));var Ze=Search.divElem.clone().attr({id:"enc_datecond"+u});Ze.css("display","none"),b.append(Ze.append(Qe)),Search.createOption(Qe,"Search._ENCTXTCOND",Search._ENCTXTCOND,p,void 0,h?r[Qe.attr("id")]:void 0);var Ke=Search.inputElem1.clone().attr({id:"enc_searchdate"+u,name:"enc_searchdate"+u,placeholder:Search.userDatePattern,style:"display:none"});Ke.on("click",(function(){return showCalen(this.id,void 0,void 0,void 0,!0)})),We.append(Ke),Ke.focus();var et=o.clone().attr({id:"divmxn"+u});T.append(et);var tt=m.clone().attr({name:"mxncondition"+u,id:"mxncondition"+u});tt.on("change",(function(){Search.checkEmptyCdn(this),wfForm.setSltVal(this)}));var at=Search.divElem.clone().attr({id:"mxncond"+u});at.css("display","none"),b.append(at.append(tt)),Search.createOption(tt,"Search._MXNCOND",Search._MXNCOND,p,void 0,h?r[tt.attr("id")]:void 0);var rt=Search.inputElem.clone().attr({name:"searchmxn"+u,id:"searchmxn"+u,style:"display:none"});et.append(rt),rt.focus();var it=o.clone().attr({id:"divnum"+u});T.append(it);var nt=m.clone().attr({name:"numcondition"+u,id:"numcondition"+u});nt.on("change",(function(){Search.checkEmptyCdn(this),wfForm.setSltVal(this)}));var st=Search.divElem.clone().attr({id:"numcond"+u});st.css("display","none"),b.append(st.append(nt)),Search.createOption(nt,"Search._NUMCOND",Search._NUMCOND,p,void 0,h?r[nt.attr("id")]:void 0);var lt=Search.inputElem.clone().attr({class:"w342 newinputText",id:"searchnum"+u,name:"searchnum"+u,maxlength:"18",style:"display:none"});lt.on("keypress",(function(e){return Search.numCheck(this,e)})),it.append(lt),lt.focus();var ot=o.clone().attr("id","currencyCode"+u).html($("#currencyCode"+f).html());ot.hide(),it.prepend(ot);var ct=o.clone().attr({id:"endNumFields"+u,class:"dIB mL10"});ct.css({display:"none"}),T.append(ct);var dt=Search.inputElem.clone().attr({class:"w150 newinputText",id:"searchenum"+u,name:"searchenum"+u,maxlength:"18"});lt.on("keypress",(function(e){return Search.numCheck(this,e)})),ct.append(dt);it=o.clone().attr({id:"divnum"+u,class:$("#divnum"+f).attr("class")});var mt=o.clone().attr({id:"enc_divnum"+u});T.append(mt);var pt=m.clone().attr({name:"enc_numcondition"+u,id:"enc_numcondition"+u});pt.on("change",(function(){Search.checkEmptyCdn(this),wfForm.setSltVal(this)}));var ht=Search.divElem.clone().attr({id:"enc_numcond"+u});ht.css("display","none"),b.append(ht.append(pt)),Search.createOption(pt,"Search._ENCNUMCOND",Search._ENCNUMCOND,p,void 0,h?r[pt.attr("id")]:void 0);var ut=Search.inputElem.clone().attr({class:"w300 newinputText",id:"enc_searchnum"+u,name:"enc_searchnum"+u,maxlength:"18",style:"display:none"});ut.on("keypress",(function(e){return Search.numCheck(this,e)})),mt.append(ut),ut.focus();var ft=o.clone().attr({id:"divBoolean"+u});T.append(ft);var vt=m.clone().attr({name:"booleancondition"+u,id:"booleancondition"+u});vt.on("change",(function(){Search.checkEmptyCdn(this),wfForm.setSltVal(this)}));var gt=Search.divElem.clone().attr({id:"booleancond"+u});gt.css("display","none"),b.append(gt.append(vt)),Search.createOption(vt,"Search._BOOLEANCOND",Search._BOOLEANCOND,p,void 0,h?r[vt.attr("id")]:void 0);var St=Search.inputElem.clone().attr({name:"searchboolean"+u,style:"display:none"});ft.append(St),St.focus();var Ct=o.clone().attr({id:"divdatetime"+u});T.append(Ct);var yt=Ge.clone().attr({name:"datetimecondition"+u,id:"datetimecondition"+u});h&&yt.find('option[value="'+r["datetimecondition"+u]+'"]').prop("selected",!0),yt.on("change",(function(){Search.checkEmptyCdn(this),Search.changeCriteria(n,this),wfForm.setSltVal(this)}));var It=Search.divElem.clone().attr({id:"datetimecond"+u});It.css("display","none"),b.append(It.append(yt));var $t=Search.inputElem1.clone().attr({id:"searchdatedate"+u,name:"searchdatedate"+u,size:"15",placeholder:Search.userDatePattern,style:"display:none"});$t.on("click",(function(){return showCalen(this.id,void 0,void 0,void 0,!0)})),Ct.append($t),$t.focus();var Tt=Search.hiddenElem.clone().attr({id:"searchsthour"+u,name:"searchsthour"+u});Tt.val("01"),Ct.append(Tt);var bt=Search.hiddenElem.clone().attr({id:"searchstminute"+u,name:"searchstminute"+u});bt.val("00"),Ct.append(bt);var xt=d.clone().attr({class:"newtimefrmt newinputText fL borderLeftNone "+("HH:mm"===Crm.userDetails.TIME_FORMAT?"time_h24":"h12")});xt.css("display","none");var wt=Search.inputElem.clone().attr({id:"searchstime"+u,fldlabel:"searchst@{pattern}"+u,class:"textField ddTime",maxlength:"5"});if(wt.val("01:00"),xt.append(wt),"HH:mm"!==Crm.userDetails.TIME_FORMAT){var _t=Search.hiddenElem.clone().attr({id:"searchstampm"+u,name:"searchstampm"+u});_t.val("AM"),xt.append(_t);var Et=d.clone().attr({class:"ampmSpan",id:"searchstampmSpan"+u,ampm:"AM"});Et.html("AM"),xt.append(Et)}populateTimeVal(wt),Ct.append(xt);Ct=o.clone().attr({id:"enc_divdatetime"+u});T.append(Ct);var Ot=Qe.clone().attr({name:"enc_datetimecondition"+u,id:"enc_datetimecondition"+u});h&&Ot.find('option[value="'+r["enc_datetimecondition"+u]+'"]').prop("selected",!0),Ot.on("change",(function(){Search.checkEmptyCdn(this),Search.changeCriteria(n,this),wfForm.setSltVal(this)}));var Nt=Search.divElem.clone().attr({id:"enc_datetimecond"+u});Nt.css("display","none"),b.append(Nt.append(Ot));var Lt,Dt,Mt=Search.inputElem1.clone().attr({id:"enc_searchdatedate"+u,name:"enc_searchdatedate"+u,size:"15",placeholder:Search.userDatePattern,style:"display:none"});Mt.on("click",(function(){return showCalen(this.id,void 0,void 0,void 0,!0)})),Ct.append(Mt),$t.focus(),(Lt=o.clone().attr({id:"endTimeFields"+u,class:"cri_divdatetime endDateFld"})).css("display","none"),T.append(Lt),(Dt=Search.inputElem1.clone().attr({id:"searchenddate"+u,name:"searchenddate"+u,size:"15",placeholder:Search.userDatePattern})).on("click",(function(){return showCalen(this.id,void 0,void 0,void 0,!0)})),Lt.append(Dt);var Rt=Search.hiddenElem.clone().attr({id:"searchethour"+u,name:"searchethour"+u});Rt.val("01"),Lt.append(Rt);var kt=Search.hiddenElem.clone().attr({id:"searchetminute"+u,name:"searchetminute"+u});kt.val("00"),Lt.append(kt);var At=d.clone().attr({class:"newtimefrmt newinputText borderLeftNone  fL "+("HH:mm"===Crm.userDetails.TIME_FORMAT?"time_h24":"time_h12")}),Bt=Search.inputElem.clone().attr({id:"searchetime"+u,name:"searchetime"+u,fldlabel:"searchet@{pattern}"+u,class:"textField ddTime",maxlength:"5"});if(Bt.val("01:00"),At.append(Bt),"HH:mm"!==Crm.userDetails.TIME_FORMAT){var Ft=Search.hiddenElem.clone().attr({id:"searchetampm"+u,name:"searchetampm"+u});Ft.val("AM"),At.append(Ft);var Pt=d.clone().attr({class:"ampmSpan",id:"searchetampmSpan"+u,ampm:"AM"});Pt.html("AM"),At.append(Pt)}populateTimeVal(Bt),Lt.append(At),s.append(T),s.append(w),s.append(x),s.append(g);P=o.clone().attr({id:"divageindays"+u,class:"searchHide fL divageindays"});var Ut=m.clone().attr({name:"ageindayscondition"+u,id:"ageindayscondition"+u});Ut.on("change",(function(){Search.checkEmptyCdn(this)}));var Vt=Search.divElem.clone().attr({id:"ageindayscond"+u,class:"cri_cr_md_fl wf_chosen_ui fL mR10"});Vt.css("display","none"),T.append(Vt.append(Ut)),T.append(P),Search.createOption(Ut,"Search._AGEINDAYSCOND",Search._AGEINDAYSCOND,p,void 0,h?r[Ut.attr("id")]:void 0);var Ht=Search.inputElem2.clone().attr({class:"w100_per textField newinputText fL",id:"ageindays"+u,name:"ageindays"+u,size:"10",value:h?r["ageindays"+u]:""});if(Ht.on("keypress",(function(e){return Search.numCheck(this,e)})),P.append(Ht),Ht.focus(),Search.addRowformPattern(n,a),Search.assignEnter("temp_searchuser"+u),Search.assignOn("temp_searchuser"+u),getObj("criteriaSearchTable")&&Search.changeField("searchfield"+u),getObj("criteriaSearchTable")){thirdPartyUtils.bindSelect2("#searchfield"+u),Search.changeField("searchfield"+u);var zt=$("#searchfield"+(n-1)+a+"_chosen").width();$("#searchfield"+u+"_chosen").css("min-width",zt),$("#searchfield"+u+"_chosen .chosen-drop").css("min-width",zt),$("#searchfield"+u+"_chosen .chosen-search").find("input").css("min-width",zt-40)}$("#hostSearch_temp_searchuser"+u).focus(),s.find("td").wrapInner('<div class="wf_slideDownUp_Div tr_cnt_'+u+'"></div>');new animate({element:".tr_cnt_"+u,height:"auto",opacity:[0,1],easing:"easeOutCubic",duration:350,complete:function(){setTimeout((function(){$(".tr_cnt_"+u).css({height:"auto",overflow:"visible"})}),100)}}).play();if(thirdPartyUtils.bindSelect2($("#searchcriteria"+u).find(".wf_chosen_ui select")),Search.removeAddressOption($("#searchfield"+u)),A&&(k.trigger("change"),k.prop("disabled",!0)),$("#conditionalFieldRightSection").find("#CriteriaFieldList").is(":visible")&&CFRCust.hidePrimaryFieldFromCriteriaEditor(),Search.isFormRuleCriteria&&n<=2){var Yt=$("#formRuleConditionForm");Yt.find("#conditionError").remove(),Yt.find("#searchcriteria1"+a).find("td:last").addClass("hide"),Yt.find("#searchcriteria2"+a).find(".cus_cb_label").addClass("inActiveSec")}if(t){var jt={id:"temp_searchuser"+u,zcqa:"temp_searchuser"+u,placeholder:I18n.getMsg("crm.label.select.user"),selectedUsers:"",selectedNames:"",fieldId:"searchuser"+u,class:"dN"};Lyte.Component.render("crm-multiuserdd-wrapper",jt,"#divuser"+u)}},Search.changeOprValPattern=function(e,t){t=void 0!==t?t:"";var a=getElemById(e).value,r=I18n.getProperties(),i=getElemById("newpattern"+t);if(i&&"block"===i.style.display)return Search.isVRCriteria?$(".validationRuleCongureWarningMsg").text(I18n.getMsg("crm.alert.label.savepattern")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.label.savepattern")),!1;var n=e.lastIndexOf("_")>0?e.lastIndexOf("_"):e.length,s=parseInt(e.substring(e.lastIndexOf("h")+1,n)),l=getElemById("patternVal"+t).value,o=l.indexOf(s),c=l.substr(0,o),d="or",m="and";"or"==a&&(d="and",m="or");var p=c.lastIndexOf(d);l=(c=c.substr(0,p)+m)+l.substr(p+d.length,l.length),getElemById("patternVal"+t).value=l,$("#patternVal"+t).text(l);var h=l.replace(new RegExp("and","g"),r.and).replace(new RegExp("or","g"),r.or);$("#pattern"+t).empty(),getElemById("pattern"+t).innerHTML=h},Search.checkEmptyCdn=function(e,t,a,r,i,n){var s,l,o=e.id,c=$("#"+o+" option:selected").text();a=o.substr(o.lastIndexOf("n")+1);var d,m=e.value;if(Search.showHideMMLDropDownOld(a,m),"near to"==m?$("#nearto"+a).css("display","block"):$("#nearto"+a).css("display","none"),o.indexOf("textpicklistcondition")>-1||o.indexOf("layoutcondition")>-1||o.indexOf("wizardcondition")>-1||o.indexOf("tagcondition")>-1||o.indexOf("consentcondition")>-1||o.indexOf("profilecondition")>-1||o.indexOf("rolecondition")>-1||o.indexOf("stagecondition")>-1){var p="picklist";o.indexOf("layoutcondition")>-1&&(p="layout"),o.indexOf("wizardcondition")>-1&&(p="wizard"),o.indexOf("tagcondition")>-1&&(p="tag"),o.indexOf("profilecondition")>-1&&(p="profile"),o.indexOf("rolecondition")>-1&&(p="role");var h=$("input[name=search"+p+a+"]");if("None"!==e.value&&"is empty"!==e.value&&"is not empty"!==e.value&&"${OPEN}"!==e.value&&"${CLOSEDWON}"!==e.value&&"${CLOSEDLOST}"!==e.value&&"is OPEN"!==e.value&&"is WON"!==e.value&&"is LOST"!==e.value){h.attr("readOnly",!1),h.attr("style","display:none;");var u=$("#div"+p+a).find(".chosen-select").length;o.indexOf("stagecondition")>-1&&(u=$("#divstage"+a).find(".chosen-select").length);var f=(y=u>0)?"edit":"create";if(y){if(!(I=$("[name=search"+p+a+"]").val())){if((I=$("select[id=search"+p+a+"]").val())&&I.length>0){for(var v=I[0].replace(/,/g,"\\,"),g=1;g<I.length;g++)v=v+","+I[g].replace(/,/g,"\\,");I=v}$("input[name=search"+p+a+"]").val(I)}(T=$("select[id='search"+p+a+"']")).length>0&&(T.hasClass("select2-hidden-accessible")&&$(T).select2("destroy"),T[0].parentNode.removeChild(T[0]))}if(Search.createChosenSelect(a,f,p,$("#"+o).val(),void 0,i,n),Search.changeInputValue(document.getElementById("search"+p+a),a),(i=$("#searchfield"+a).val())&&i.indexOf("CrmProcessLogs:")>-1){var S=i.split(":")[1];"CrmProcessLogs"!==i.split(":")[0]||"PROCESSID"!==S&&"FROMSTATEID"!==S&&"TRANSITIONID"!==S||setTimeout((function(){$("#searchpicklist"+a).next("span").find("input").prop("readonly",!0)}),100)}}else{if((T=$("select[id='search"+p+a+"']")).length>0&&(T.hasClass("select2-hidden-accessible")&&$(T).select2("destroy"),T[0].parentNode.removeChild(T[0])),0==h.length){var C=document.createElement("input");C.setAttribute("name","search"+p+a),C.setAttribute("size","30"),C.type="text",C.className="textField p5 fL",C.setAttribute("style","background:var(--bg_f5f7f9)"),C.setAttribute("readOnly",!0),$("#div"+p+a)[0].appendChild(C)}else h.val(""),h.attr("readOnly",!0),h.attr("style","background:var(--bg_f5f7f9);"),h.attr("name","search"+p+a),h.show()}t="search"+p+a,$('input[name="'+t+'"]').removeAttr("data-isdef")}else if(o.indexOf("callstatuscondition")>-1)t="searchcallstatus"+a;else if(o.indexOf("mxncondition")>-1)t="searchmxn"+a;else if(o.indexOf("servicestatuscondition")>-1){p="servicestatus";(h=$("#search"+p+a)).attr({readonly:"false",style:"display:none;"});var y;f=(y=(u=$("#div"+p+a).find(".chosen-select").length)>0)?"edit":"create";if(y){var I,T=$("#searchselservicestatus"+a);if(!(I=h.val())){if((I=T.val())&&I.length>0){v=I[0].replace(/,/g,"\\,");var b=I.length;for(g=1;g<b;g++)v=v+","+I[g].replace(/,/g,"\\,");I=v}h.val(I)}T.length>0&&(T.hasClass("select2-hidden-accessible")&&T.select2("destroy"),T[0].parentNode.removeChild(T[0]))}Search.createChosenSelect(a,f,p,$("#"+o).val(),void 0,i,n),Search.changeInputValue(document.getElementById("search"+p+a),a),t="searchservicestatus"+a}else if(o.indexOf("consentcondition")>-1)t="searchpicklist"+a;else if(o.indexOf("enc_textcondition")>-1){var x=$("#searchfield"+a).find("option:selected")[0].getAttribute("id"),w=$("#enc_divtext"+a).find(".chosen-select");"picklist"===x&&w.length<1?Search.createChosenSelect(a,"create","picklist"):t="enc_searchtext"+a,$("#"+t).removeAttr("data-isdef"),wfForm.focusInp("enc_divtext","enc_searchtext",a)}else if(o.indexOf("textcondition")>-1){x=$("#searchfield"+a).find("option:selected")[0].getAttribute("id"),w=$("#divtext"+a).find(".chosen-select");"picklist"===x&&w.length<1?Search.createChosenSelect(a,"create","picklist"):t="searchtext"+a,$("#"+t).removeAttr("data-isdef"),wfForm.focusInp("divtext","searchtext",a)}else if(o.indexOf("enc_datecondition")>-1)t="enc_searchdate"+a,$("#enc_divdate"+a).removeClass(Search.classNameForHide).addClass("fL"),$("#"+t).val("").removeClass("w342").addClass("datewidth"),thirdPartyUtils.bindSelect2($("#searchcriteria"+a).find(".wf_chosen_ui select"));else if(o.indexOf("datecondition")>-1){t="searchdate"+a;var _="enddateFields"+a;$("#"+_).css("display","none").children("input").val(""),m===Search.ageCrt||m===Search.dueCrt?($("#ageindayscond"+a).css("display",""),$("#divageindays"+a).removeClass(Search.classNameForHide).addClass("fL"),$("#divdate"+a).addClass(Search.classNameForHide).addClass("fL")):($("#ageindayscond"+a).css("display","none"),$("#divageindays"+a).addClass(Search.classNameForHide),$("#divdate"+a).removeClass(Search.classNameForHide).addClass("fL")),$("#"+t).val("").removeClass("w342").addClass("datewidth"),thirdPartyUtils.bindSelect2($("#searchcriteria"+a).find(".wf_chosen_ui select"))}else if(o.indexOf("enc_datetimecondition")>-1)t="enc_searchdatedate"+a,$("#"+t).val("").removeClass("w342").addClass("datewidth").closest("td").find(".newtimefrmt").show(),thirdPartyUtils.bindSelect2($("#searchcriteria"+a).find(".wf_chosen_ui select"));else if(o.indexOf("datetimecondition")>-1)t="searchdatedate"+a,$("#"+t).val("").removeClass("w342").addClass("datewidth").closest("td").find(".newtimefrmt").show(),thirdPartyUtils.bindSelect2($("#searchcriteria"+a).find(".wf_chosen_ui select"));else if(o.indexOf("enc_numcondition")>-1)t="enc_searchnum"+a;else if(o.indexOf("numcondition")>-1){t="searchnum"+a,$("#"+t).parent().removeClass("dIB w100_per"),$("#"+t).removeClass("w100_per");_="endNumFields"+a;$("#"+_).css("display","none"),"is empty"!==m&&"is not empty"!==m&&"true"===$("#searchfield"+a).find("option:selected").attr("currency")&&$("#currencyCode"+a).show()}else if(o.indexOf("booleancondition")>-1)"is empty"!==e.value&&"is not empty"!==e.value?$("#divBoolean"+a).find(".chosen-select").length<1?($("input[name=searchboolean"+a+"]").hide(),Search.createChosenSelect(a,"create","B")):($("#searchboolean"+a+"_chosen").show(),$("input[name=searchboolean"+a+"]").hide()):($("#searchboolean"+a+"_chosen").hide(),$("input[name=searchboolean"+a+"]").show()),t="searchboolean"+a;else if(o.indexOf("usercondition")>-1){t="searchuser"+a,getObj(t).value="";var E=$("#temp_searchuser"+a);if(E.css("display","block"),E.attr("selected-users")){var O=E.attr("id"),N=document.getElementById(O);if(N){var L=N.component;L.setData("selectedNames",""),L.setData("selectedUsers","[]"),L.setData("usersRecord",[])}}else E.find("li").remove(),-1!=c.indexOf("Current user")?E.children("ul").children("input").css({readonly:"true",display:"none"}):"is empty"==m||"is not empty"==m?(E.css({display:"none"}),E.children("ul").children("input").css({readonly:"true",display:"none"}),$("#"+t).css("readonly","true").addClass("w342 newinputText").attr("type","")):($("#"+t).attr("type","hidden"),E.css({display:"block"}),E.children("ul").children("input").attr("readOnly",!1).css({display:"block"}),E.children("ul").children("input").attr("placeholder",I18n.getMsg("crm.label.select.user")))}else o.indexOf("campcvcondition")>-1?(t="searchcampcv"+a,s="temp_searchcampcv"+a,l=!0):o.indexOf("ageindayscondition")>-1&&(t="ageindays"+a);if(1==r||"None"==m||"is empty"==m||"is not empty"==m){if(""===t||"searchmxn1"===t){let e=document.getElementsByName(t)[0];e&&(e.value="")}$("#searchenum"+a).val(""),$("#searchedate"+a).val("")}try{getObj(s).value=""}catch(e){}var D=e.value;$(e).find("option").removeAttr("selected"),$(e).val(D),$(e).find("option:selected").eq(0).attr("selected","selected");var M=$("#"+t);switch(m){case"None":case"is empty":case"is not empty":case"is true":case"is false":var R=getElemById("searchfield"+a).value;if(R.indexOf("AGEINDAYS")>-1||R.indexOf("CREATEDTIME")>-1||R.indexOf("CREATEDTIME_B")>-1||R.indexOf("MODIFIEDTIME")>-1||R.indexOf("MODIFIEDTIME_B")>-1||-1==m.indexOf("is empty")&&-1==m.indexOf("is not empty")&&(R.indexOf("SMOWNERID")>-1||R.indexOf("SMCREATORID")>-1||R.indexOf("MODIFIEDBY")>-1||R.indexOf("AaaUser")>-1||R.indexOf("SMOWNER")>-1||R.indexOf("SMCREATOR")>-1||R.indexOf("MODIFIEDBY")>-1))return Search.isVRCriteria?$(".validationRuleCongureWarningMsg").text(I18n.getMsg("crm.label.custom.view.time.emptycheck.alert",I18n.getMsg(singularModule))).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.label.custom.view.time.emptycheck.alert",I18n.getMsg(singularModule))),getElemById(t).value="",M.closest("td").find(".newtimefrmt").show(),e.selectedIndex=0,getElemById(t).readOnly=!1,void M.attr("style","").attr("readOnly",!1);if("is empty"===e.value?(t!=="searchpicklist"+a&&(void 0!==l&&!0===l&&($("#"+s).attr("readonly",!0),$("#"+s).attr("style","background:var(--bg_f5f7f9)")),M.attr("readonly",!0).attr("style","background:var(--bg_f5f7f9)"),getElemById(t)&&(getElemById(t).value="")),M.removeClass("datewidth").addClass("w100_per").closest("div").addClass("w100_per")):"is true"===e.value?getElemById(t).value="true":"is false"===e.value?getElemById(t).value="false":t!=="searchpicklist"+a&&(M.attr("readonly",!0).attr("style","background:var(--bg_f5f7f9)"),null!=l&&1==l&&$("#"+s).attr("style","background:var(--bg_f5f7f9)")),R.indexOf("SMOWNERID")>-1||R.indexOf("SMCREATORID")>-1||R.indexOf("MODIFIEDBY")>-1||R.indexOf("AaaUser")>-1||R.indexOf("SMOWNER")>-1||R.indexOf("SMCREATOR")>-1||R.indexOf("MODIFIEDBY")>-1)switch(e){case"is empty":getElemById(t).value="${EMPTY}";break;case"is not empty":getElemById(t).value="${NOTEMPTY}"}getElemById("campCvLookup"+a)&&(null!=s&&(getElemById(s).readOnly=!0),$("#campCvLookup"+a).addClass(Search.classNameForHide)),t.indexOf("enc_searchdatedate")>-1&&(M.attr("placeholder",""),M.closest("td").find(".newtimefrmt").hide()),t.indexOf("searchdatedate")>-1&&(M.attr("placeholder",""),M.closest("td").find(".newtimefrmt").hide()),t.indexOf("enc_searchdate")>-1&&M.attr("placeholder",""),t.indexOf("searchdate")>-1&&M.attr("placeholder",""),t.indexOf("searchnum")>-1&&$("#currencyCode"+a).hide();break;case"Current User":$("#"+t).attr("readOnly","readOnly").val("${CURRENTUSER}"),$("#temp_searchuser"+a).find("ul").append('<li class="search-choice">${CURRENTUSER}</li>').children("input").css("display","none");break;case"Today":case"Tommorow":case"Tommorow Onwards":case"Yesterday":case"Till Yesterday":case"Current Month":case"Current Week":case"Last Month":case"Last Week":case"Next Month":case"Next Week":case"Last Year":case"This Year":case"Current Year":case"Next Year":case"Previous FQ":case"Current FQ":case"Next FQ":case"Previous FY":case"Current FY":case"Next FY":case"Scheduled":case"Attended Dialled":case"Overdue":case"Cancelled":case"Unattended Dialled":case"Missed":case"Received":var k="";"Today"==m?d="${TODAY}":"Tommorow"==m?d="${TOMORROW}":"Tommorow Onwards"==m?d="${TOMORROWPLUS}":"Yesterday"==m?d="${YESTERDAY}":"Current Month"==m?d="${THISMONTH}":"Current Week"==m?d="${THISWEEK}":"Last Month"==m?d="${LASTMONTH}":"Last Week"==m?d="${LASTWEEK}":"Next Month"==m?d="${NEXTMONTH}":"Next Week"==m?d="${NEXTWEEK}":"Scheduled"==m||"Attended Dialled"==m||"Overdue"==m||"Cancelled"==m||"Unattended Dialled"==m||"Received"==m||"Missed"==m?(d="${Calls.Call Status."+m+"}",k="display:block;background:var(--bg_f5f7f9);color:#eee;"):d="Last Year"==m?"${LASTYEAR}":"This Year"==m||"Current Year"==m?"${THISYEAR}":"Next Year"==m?"${NEXTYEAR}":"Previous FQ"==m?"${PREVFQ}":"Current FQ"==m?"${THISFQ}":"Next FQ"==m?"${NEXTFQ}":"Previous FY"==m?"${PREVFY}":"Current FY"==m?"${THISFY}":"Next FY"==m?"${NEXTFY}":"${YESTERDAYMINUS}",$("#"+t).removeClass("w70 datewidth").addClass("w342").attr("readonly","readonly").attr("style",k).val(d),M.closest("td").find(".newtimefrmt").hide();break;case"between":case"not between":if(o.indexOf("datetimecondition")>-1||o.indexOf("datecondition")>-1){$("#"+_).css("display","");M.attr("placeholder",Search.userDatePattern).attr("style","").attr("readOnly",!1)}else if(o.indexOf("numcondition")>-1){$("#"+_).css("display","");M.attr("style","width:150px").attr("readOnly",!1),M.parent().addClass("dIB")}break;default:if(t!=="searchpicklist"+a&&t!=="searchboolean"+a&&t!=="searchlayout"+a&&t!=="searchwizard"+a&&t!=="searchtag"+a&&t!=="searchprofile"+a&&t!=="searchrole"+a&&t!=="searchservicestatus"+a){var A=$("#"+t).val();A="${EMPTY}"==A||"${CURRENTUSER}"==A||"${NOTEMPTY}"==A?"":A,$("#"+t).attr("readOnly",!1).val(A),M.attr("style",""),getElemById("userLookup"+a)&&$("#userLookup"+a).removeClass(Search.classNameForHide),getElemById("temp_searchcampcv"+a)&&($("#searchcampcv"+a).readOnly=!0,getElemById("temp_searchcampcv"+a).readOnly=!0,getElemById("temp_searchcampcv"+a).disabled="",$("#temp_searchcampcv"+a).attr("style",""),$("#campCvLookup"+a).removeClass(Search.classNameForHide),$("#campCvImg"+a).attr("style","display:inline-block")),t.indexOf("searchdatedate")>-1&&(M.attr("placeholder",Search.userDatePattern),M.closest("td").find(".newtimefrmt").show()),t.indexOf("searchdate")>-1&&M.attr("placeholder",Search.userDatePattern),t!=="temp_searchcampcv"+a&&t!=="searchcampcv"+a&&(t!=="temp_searchcampcv"+a&&t!=="searchcampcv"+a&&M.attr("readOnly",!1),M.attr("style",""))}}M.focus()},Search.showHideMMLDropDownOld=function(e,t){var a,r=$("[name='"+("searchfield"+e)+"']").val();a="is empty"===t||"is not empty"===t;var i=$("#searchcriteria"+e),n=i.find(".mmlInText"),s="multimodulelookup"+e,l=i.find("[name="+s+"]"),o=Search.FLD_1;void 0===o&&(o=Search.FLD);var c=Search.mml_1;if(c){var d=0,m=0;o&&o.each((function(e){e[0]===r&&(d=m),m++})),o&&c&&(o.length!==c.length&&(d-=1),d<0&&(d=0));var p=c[d];m=0,1===p.length&&"none"===p[0]?(n.hide(),l.parent().parent().hide()):!1===a?(n.css("display","block"),l.parent().parent().css("display","block")):(n.hide(),l.parent().parent().hide())}},Search.changePattern=function(e,t){Search.isPatternEditOpen=!0;var a=Search["rowcnt"+(t=void 0!==t?t:"")],r=$("#patternVal"+t);if(parseInt(a)>parseInt(e))return Search.isVRCriteria?$(".validationRuleCongureWarningMsg").text(I18n.getMsg("crm.criteria.max.rowcnt.exceeds")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.criteria.max.rowcnt.exceeds")),!1;var i=$("#changePattern"+t).outerHeight();if(getElemById("pattern"+t).style.display="none",getElemById("changePattern"+t).style.display="none",getElemById("newpattern"+t).style.display="block",r.css({height:i-7}),getElemById("cvbutton"+t)&&$("#searchbtn").addClass("eventNone op3"),getElemById("addCriteriaBTN"+t)&&$("#j_saveCriteria").addClass("eventNone op3"),getElemById("updatePattern"+t).style.display="inline-block",Search.isFormRuleCriteria){var n=getElemById("pattern"+t).innerHTML,s=I18n.getMsg("and"),l=n.substring(n.indexOf(s)+s.length,n.lastIndexOf(")"));$("#criteriaStart"+t).remove(),$("#criteriaEnd"+t).remove(),r.before($("<div/>").attr("id","criteriaStart"+t).addClass("inActiveSec").text("( 1 "+s+" ")),r.text(l),getElemById("patternVal"+t).value=l,r.after($("<div/>").attr("id","criteriaEnd"+t).addClass("inActiveSec").text(" )")),$("#saveFields").addClass("inActiveSec")}else getElemById("patternVal"+t).value=getElemById("pattern"+t).innerHTML,r.text(getElemById("pattern"+t).innerHTML).focus();if($("#wfCriteriaActionsDIV").length>0){var o=t.split("_")[2];workflow.setWtHt("criEditSum_"+o,"criteriaBg_"+o)}},Search.savePattern=function(e,t){Search.isPatternEditOpen=!1,e=void 0!==e?e:"";var a=t?$("#searchlayer_new"+e).find(".searchcrt").length:Search["rowcnt"+e],r=getElemById("patternVal"+e).value.trim();Search.isFormRuleCriteria&&(r=$("#criteriaStart"+e).text()+r.trim()+$("#criteriaEnd"+e).text()),r=r.split(" ").join("");var i=Search.replaceAndOr(r);if(!(i=this.validatePattern(i,e,a)))return!1;getElemById("pattern"+e).style.display="inline-block",getElemById("changePattern"+e).style.display="block",getElemById("newpattern"+e).style.display="none",getElemById("updatePattern"+e).style.display="none";r=i.replace(new RegExp("and","g"),I18n.getMsg("and")).replace(new RegExp("or","g"),I18n.getMsg("or"));if($("#pattern"+e).empty(),getElemById("pattern"+e).innerHTML=r,getElemById("patternVal"+e).value=i,$("#patternVal"+e).text(i),this.updateCriteriaRowsBasedOnChangedPattern(i,e,t),getElemById("cvbutton"+e)&&$("#searchbtn").removeClass("eventNone op3"),getElemById("addCriteriaBTN"+e)&&$("#j_saveCriteria").removeClass("eventNone op3"),Search.isFormRuleCriteria&&$("#saveFields").removeClass("inActiveSec"),$("#wfCriteriaActionsDIV").length>0){var n=e.split("_")[2];workflow.setWtHt("criEditSum_"+n,"criteriaBg_"+n)}},Search.validatePattern=function(e,t,a){t=void 0!==t?t:"";var r=(e=e.replace(/#/g,"~")).match(/\(/gi);if(r)var i=r.length;var n=e.match(/\)/gi);if(n)var s=n.length;var l=$(".validationRuleCongureWarningMsg");if(i!=s)return Search.isVRCriteria?l.text(I18n.getMsg("criteria.error.alert.brackets.count.mismatch")).show():_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("criteria.error.alert.brackets.count.mismatch","")}}),!1;var o=e.replace(/(and|or)/g,"#").split(" ").join("").replace(/\n/g,"");if(-1!=o.indexOf("(#")||-1!=o.indexOf("#)")||0===o.indexOf("#")||o.length&&o.lastIndexOf("#")===o.length-1)return Search.isVRCriteria?l.text(I18n.getMsg("criteria.error.alert.brackets.invalid")).show():_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("criteria.error.alert.brackets.invalid")}}),!1;if(-1!=o.indexOf("()"))return Search.isVRCriteria?l.text(I18n.getMsg("criteria.error.alert.brackets")).show():_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("criteria.error.alert.brackets")}}),!1;var c=o.replace(/[()]/g,"#"),d=e.match(/[0-9]+/g);if(null!=d)for(var m=0;m<d.length;m++)if(d[m]!=m+1)return Search.isVRCriteria?l.text(I18n.getMsg("crm.criteria.number.notmatch.check",d[m])).show():_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.criteria.number.notmatch.check",d[m])}}),!1;var p=c.replace(/[0-9]+/g,"#").replace(/#/g,"");if(p&&p.length>=1)return Search.isVRCriteria?l.text(I18n.getMsg("criteria.error.alert.other.params")).show():_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("criteria.error.alert.other.params")}}),!1;var h=e.match(/(and|or)/gi);if(a=a||Search["rowcnt"+t],h&&a-1!==h.length)return Search.isVRCriteria?l.text(I18n.getMsg("criteria.error.alert.andor.rowcount.mismatch")).show():_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("criteria.error.alert.andor.rowcount.mismatch")}}),!1;if(a!=c.replace(/[0-9]+/g,"$").replace(/#/g,"").length)return Search.isVRCriteria?l.text(I18n.getMsg("criteria.error.alert.critnum.rowcount.mismatch")).show():_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("criteria.error.alert.critnum.rowcount.mismatch")}}),!1;let u=0;for(let t of e)if("("===t)u++;else if(")"===t&&(u--,u<0))break;return h&&0===u?(null!=l&&l.length>0&&l.hide(),e=(e=this.addSpaceBetweenParanthesis(e)).replace(/\n/g,"")):(Search.isVRCriteria?l.text(I18n.getMsg("criteria.error.alert.other.params")).show():_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("criteria.error.alert.other.params")}}),!1)},Search.updateCriteriaRowsBasedOnChangedPattern=function(e,t,a){t=void 0!==t?t:"";var r=e.match(/(and|or)/gi);if(r){var i=r.length;if(a)for(var n=$("#searchlayer_new"+t).find("tr.searchcrt"),s=0;s<i;s++){var l=n.eq(s+1).find(".searchMatch");l.val(r[s]),wfForm.setOprSel_new(l.parent(),t,!0,r[s])}else for(s=0;s<i;s++)"and"==r[s]?getElemById("match"+(s+2)+t).value="and":getElemById("match"+(s+2)+t).value="or",wfForm.setOprSel($("#matchConditionLabel"+(s+2)+t),s+2+t,!0,r[s])}},Search.cancelChangePattern=function(e,t){Search.isPatternEditOpen=!1,e=void 0!==e?e:"";var a=getElemById("pattern"+e).innerHTML;a=a.split(" ").join("");var r=Search.replaceAndOr(a);if(r=this.addSpaceBetweenParanthesis(r),getElemById("patternVal"+e).value=r,$("#patternVal"+e).text(r),getElemById("newpattern"+e).style.display="none",getElemById("updatePattern"+e).style.display="none",getElemById("cvbutton"+e)&&$("#searchbtn").removeClass("op3 eventNone"),getElemById("addCriteriaBTN"+e)&&$("#j_saveCriteria").removeClass("eventNone op3"),getElemById("pattern"+e).style.display="inline-block",getElemById("changePattern"+e).style.display="block",this.updateCriteriaRowsBasedOnChangedPattern(r,e,t),Search.isFormRuleCriteria&&$("#saveFields").removeClass("inActiveSec"),Search.isVRCriteria&&$(".validationRuleCongureWarningMsg").text("").hide(),$("#wfCriteriaActionsDIV").length>0){var i=e.split("_")[2];workflow.setWtHt("criEditSum_"+i,"criteriaBg_"+i)}},Search.delRowFormPattern=function(e,t,a){if(t=void 0!==t?t:"",a)i=!0;else var r=e.indexOf("_")>0?e.indexOf("_"):e.length,i=(a=parseInt(e.substring(e.indexOf("k")+1,r)),!1);var n=getElemById("patternVal"+t).value;n=(n=n.split(" ").join("")).replace(/[0-9]+/g,"$"),Search.isFormRuleCriteria&&(n=n.substring(n.indexOf("and")+3,n.lastIndexOf(")")),a-=1);for(var s=a,l=n.length,o="",c=!1,d=!1,m=0,p="",h=!1,u=0,f="",v=0,g=0;g<l;g++){if("$"==(f=n.charAt(g))?(u++,p=n.substring(m,g),m=0,h=!0,f=u):(h=!1,0==m&&")"!=f&&"("!=f&&(m=g)),h&&u+""==s)if(c=!0,d=!0,this.stringEndsWith(p,"and")||this.stringEndsWith(p,"or"))o=o.substring(0,o.length-p.length);else for(var S=1;S<l;S++)if(l>g+S){if(")"==(f=n.charAt(g+S))&&this.stringEndsWith(p,"("))if(""==o)o=p.substring(0,p.length-1);else{if(1!=s){o=o.substring(0,o.length-p.length),v++;break}o=o.substring(0,o.length-1)}if("$"==f||"("==f)break;v++}c||(h&&d?h&&d&&(o+=u-1):0==v?o+=f:v-=1),c=!1}if(Search.isFormRuleCriteria){var C=2,y="",I=(o=o.replace(/[0-9]+/g,"$")).length;for(g=0;g<I;g++)"$"===o[g]?(y+=C,C++):y+=o[g];o=""!==(o=y)?"(1and"+o+")":"1"}o=this.addSpaceBetweenParanthesis(o),this.updateCriteriaRowsBasedOnChangedPattern(o,t,i),$("#patternVal"+t).val(o);var T=I18n.getProperties(),b=o.replace(new RegExp("and","g"),T.and).replace(new RegExp("or","g"),T.or);$("#pattern"+t).html(b)},Search.addSpaceBetweenParanthesis=function(e){for(var t="",a=e.length,r=0;r<a;r++){var i=e.charAt(r);"("==i||"d"==i||"r"==i?t=t+i+" ":")"==i||"a"==i||"o"==i?t=t+" "+i:t+=i}return t},Search.stringEndsWith=function(e,t){var a=t;return"("!=t&&")"!=t||(a="\\"+t),e.match(a+"$")==t},Search.addRowformPattern=function(e,t){t=void 0!==t?t:"";var a=$("#patternVal"+t),r=$("#pattern"+t).html(),i="and";if(e>=2&&(i=getElemById("match"+e+t).value),i="and"==i?I18n.getMsg("and"):I18n.getMsg("or"),Search.isFormRuleCriteria&&e>2){var n=I18n.getMsg("and"),s=r.substring(r.indexOf(n)+n.length,r.lastIndexOf(")"));r=r.substring(0,r.indexOf(n))+n+" ("+s+i+" "+e+" ) )"}else r="( "+r+" "+i+" "+e+" )";$("#pattern"+t).html(r),r=r.split(" ").join("");var l=Search.replaceAndOr(r);l=this.addSpaceBetweenParanthesis(l),a.val(l),a.text(l)},Search.removeCriteria=function(e,t,a){a=void 0!==a?a:"";var r=getElemById("newpattern"+a);if(r&&"block"===r.style.display)return alert(I18n.getMsg("crm.alert.label.savepattern","")),!1;var i=e.lastIndexOf("_")>0?e.lastIndexOf("_"):e.length,n=parseInt(e.substring(e.lastIndexOf("k")+1,i));if($("#searchcriteria"+n+a+" .addCriteria").length>0){var s=$('<img id="addRow1'+a+'" src="'+Search.spacerImg+'" class="addCriteria"/>');s.on("click",(function(){var e=$("#conditionalFieldRightSection").find("#CriteriaFieldList").is(":visible")?CFRCust.limits.MAX_BRANCH_CONDITIONS_CRITERIAS_ALLOWED:Search.MAX_CRT_CNT;Search.addCriteria(e,t,a)})),$("#searchcriteria"+(n-1)+a+" .removeCriteria").parent().append(s)}var l=$("#searchfield"+n+a).val();null!=l&&l.indexOf("LATITUDE")>-1&&(ind=$("#searchcriteria"+n+a).find("option[value*='LATITUDE']"),indObj={index:ind.index(),obj:ind},$("#searchlayer").data("indObj",indObj),Search.addAddressOptions()),$("#searchcriteria"+n+a).remove();var o=Search["rowcnt"+a]-1;Search["rowcnt"+a]=o,1===o&&getElemById("critTable"+a)&&(getElemById("critTable"+a).style.display="none");for(var c=getElemById("searchlayer"+a),d=n;d<=o;d++)if(!getElemById("searchcriteria"+d+a)){var m=c.getElementsByTagName("tr");if(currRow=m.item(d-1).id,i=currRow.lastIndexOf("_")>0?currRow.lastIndexOf("_"):currRow.length,currId=parseInt(currRow.substring(currRow.lastIndexOf("a")+1,i)),$("#searchcriteria"+currId+a).attr({id:"searchcriteria"+d+a}),Search.changeIndex("matchConditionLabel",currId,d,a),Search.changeIndex("check",currId,d,a),Search.changeIndex("match",currId,d,a),$("#patternNum"+currId+a).val(d),Search.changeIndex("patternNum",currId,d,a),1==d){var p=$("#match1"+a).parent();p.parent().append('<input type="hidden" name="match1'+a+'" id="match1'+a+'"/>'),p.remove()}if(Search.changeIndex("searchfield",currId,d,a),Search.changeIndex("searchfieldtype",currId,d,a),Search.changeIndex("nearto",currId,d,a),Search.changeIndex("multimodulelookup",currId,d,a),Search.changeIndex("divtext",currId,d,a),Search.changeIndex("textcond",currId,d,a),Search.changeIndex("textcondition",currId,d,a),Search.changeIndex("enc_divtext",currId,d,a),Search.changeIndex("enc_textcond",currId,d,a),Search.changeIndex("enc_textcondition",currId,d,a),Search.changeIndex("enc_searchtext",currId,d,a),Search.changeIndex("searchtext",currId,d,a),Search.changeIndex("divageindays",currId,d,a),Search.changeIndex("ageindayscond",currId,d,a),Search.changeIndex("ageindayscondition",currId,d,a),Search.changeIndex("ageindays",currId,d,a),Search.changeIndex("divcallstatus",currId,d,a),Search.changeIndex("callstatuscond",currId,d,a),Search.changeIndex("callstatuscondition",currId,d,a),Search.changeIndex("divservicestatus",currId,d,a),Search.changeIndex("servicestatuscond",currId,d,a),Search.changeIndex("servicestatuscondition",currId,d,a),Search.changeIndex("searchservicestatus",currId,d,a),Search.changeIndex("consentcond",currId,d,a),Search.changeIndex("consentcondition",currId,d,a),Search.changeIndex("divpicklist",currId,d,a),Search.changeIndex("divstage",currId,d,a),Search.changeIndex("stagecondition",currId,d,a),Search.changeIndex("stagecond",currId,d,a),Search.changeIndex("divlayout",currId,d,a),Search.changeIndex("divwizard",currId,d,a),Search.changeIndex("divtag",currId,d,a),Search.changeIndex("searchtag",currId,d,a),Search.changeIndex("textpicklistcond",currId,d,a),Search.changeIndex("layoutcond",currId,d,a),Search.changeIndex("wizardcond",currId,d,a),Search.changeIndex("tagcond",currId,d,a),Search.changeIndex("textpicklistcondition",currId,d,a),Search.changeIndex("layoutcondition",currId,d,a),Search.changeIndex("wizardcondition",currId,d,a),Search.changeIndex("tagcondition",currId,d,a),Search.changeIndex("searchpicklist",currId,d,a),Search.changeIndex("searchlayout",currId,d,a),Search.changeIndex("searchwizard",currId,d,a),Search.changeIndex("searchtag",currId,d,a),Search.changeIndex("rolecondition",currId,d,a),Search.changeIndex("searchrole",currId,d,a),Search.changeIndex("rolecond",currId,d,a),Search.changeIndex("divrole",currId,d,a),Search.changeIndex("profilecondition",currId,d,a),Search.changeIndex("searchprofile",currId,d,a),Search.changeIndex("profilecond",currId,d,a),Search.changeIndex("divprofile",currId,d,a),$("select[id='searchpicklist"+currId+a+"']").length>0){var h=$("select[id='searchpicklist"+currId+a+"']");h.attr("onchange","Search.changeInputValue(this,'"+d+a+"')"),h.attr("id","searchpicklist"+d+a)}if($("#searchpicklist"+currId+a+"_chosen").length>0){if($("#searchpicklist"+currId+a)[0].setAttribute("onchange","Search.changeInputValue(this,'"+d+a+"')"),$("#searchpicklist"+currId+a)[0].id="searchpicklist"+d+a,$("#searchpicklist"+currId+a+"_chosen")[0].id="searchpicklist"+d+a+"_chosen",(g=$("#searchpicklist"+d+a+"_chosen").find(".chosen-choices").children()).length>0)for(var u=0;u<g.length;u++)g[u].id="searchpicklist"+d+a+"_chosen_c_"+u;for(var f=$("#searchpicklist"+d+a+"_chosen").find(".chosen-results").children(),v=0;v<f.length;v++)f[v].id="searchpicklist"+d+a+"_chosen_o_"+v}if($("#searchlayout"+currId+a+"_chosen").length>0){if($("#searchlayout"+currId+a)[0].setAttribute("onchange","Search.changeInputValue(this,'"+d+a+"')"),$("#searchlayout"+currId+a)[0].id="searchlayout"+d+a,$("#searchlayout"+currId+a+"_chosen")[0].id="searchlayout"+d+a+"_chosen",(g=$("#searchlayout"+d+a+"_chosen").find(".chosen-choices").children()).length>0)for(u=0;u<g.length;u++)g[u].id="searchlayout"+d+a+"_chosen_c_"+u;for(f=$("#searchlayout"+d+a+"_chosen").find(".chosen-results").children(),v=0;v<f.length;v++)f[v].id="searchlayout"+d+a+"_chosen_o_"+v}if($("#searchtag"+currId+a+"_chosen").length>0){if($("#searchtag"+currId+a)[0].setAttribute("onchange","Search.changeInputValue(this,'"+d+a+"')"),$("#searchtag"+currId+a)[0].id="searchtag"+d+a,$("#searchtag"+currId+a+"_chosen")[0].id="searchtag"+d+a+"_chosen",(g=$("#searchtag"+d+a+"_chosen").find(".chosen-choices").children()).length>0)for(u=0;u<g.length;u++)g[u].id="searchtag"+d+a+"_chosen_c_"+u;for(f=$("#searchtag"+d+a+"_chosen").find(".chosen-results").children(),v=0;v<f.length;v++)f[v].id="searchtag"+d+a+"_chosen_o_"+v}if($("#searchrole"+currId+a+"_chosen").length>0){if($("#searchrole"+currId+a)[0].setAttribute("onchange","Search.changeInputValue(this,'"+d+a+"')"),$("#searchrole"+currId+a)[0].id="searchrole"+d+a,$("#searchrole"+currId+a+"_chosen")[0].id="searchrole"+d+a+"_chosen",(g=$("#searchrole"+d+a+"_chosen").find(".chosen-choices").children()).length>0)for(u=0;u<g.length;u++)g[u].id="searchrole"+d+a+"_chosen_c_"+u;for(f=$("#searchrole"+d+a+"_chosen").find(".chosen-results").children(),v=0;v<f.length;v++)f[v].id="searchrole"+d+a+"_chosen_o_"+v}if($("#searchprofile"+currId+a+"_chosen").length>0){var g;if($("#searchprofile"+currId+a)[0].setAttribute("onchange","Search.changeInputValue(this,'"+d+a+"')"),$("#searchprofile"+currId+a)[0].id="searchprofile"+d+a,$("#searchprofile"+currId+a+"_chosen")[0].id="searchprofile"+d+a+"_chosen",(g=$("#searchprofile"+d+a+"_chosen").find(".chosen-choices").children()).length>0)for(u=0;u<g.length;u++)g[u].id="searchprofile"+d+a+"_chosen_c_"+u;for(f=$("#searchprofile"+d+a+"_chosen").find(".chosen-results").children(),v=0;v<f.length;v++)f[v].id="searchprofile"+d+a+"_chosen_o_"+v}Search.changeIndex("mxncondition",currId,d,a),Search.changeIndex("divuser",currId,d,a),Search.changeIndex("usercond",currId,d,a),Search.changeIndex("usercondition",currId,d,a),Search.changeIndex("searchuser",currId,d,a),Search.changeIndex("temp_searchuser",currId,d,a),Search.changeIndex("divcampcv",currId,d,a),Search.changeIndex("campcvcond",currId,d,a),Search.changeIndex("campcvcondition",currId,d,a),Search.changeIndex("searchcampcv",currId,d,a),Search.changeIndex("temp_searchcampcv",currId,d,a),Search.changeIndex("campCvLookup",currId,d,a),Search.changeIndex("campCvImg",currId,d,a),Search.changeIndex("divdate",currId,d,a),Search.changeIndex("datecond",currId,d,a),Search.changeIndex("datecondition",currId,d,a),Search.changeIndex("enc_divdate",currId,d,a),Search.changeIndex("enc_datecond",currId,d,a),Search.changeIndex("enc_datecondition",currId,d,a),Search.changeIndex("searchdate",currId,d,a),Search.changeIndex("searchedate",currId,d,a),Search.changeIndex("enddateFields",currId,d,a),Search.changeIndex("mxncondition",currId,d,a),Search.changeIndex("divdatetime",currId,d,a),Search.changeIndex("datetimecond",currId,d,a),Search.changeIndex("datetimecondition",currId,d,a),Search.changeIndex("enc_divdatetime",currId,d,a),Search.changeIndex("enc_datetimecond",currId,d,a),Search.changeIndex("enc_datetimecondition",currId,d,a),Search.changeIndex("searchdatedate",currId,d,a),Search.changeIndex("searchsthour",currId,d,a),Search.changeIndex("searchstminute",currId,d,a),Search.changeIndex("searchstime",currId,d,a),"HH:mm"!==Crm.userDetails.TIME_FORMAT&&(Search.changeIndex("searchstampm",currId,d,a),Search.changeIndex("searchetampm",currId,d,a),Search.changeIndex("searchstampmSpan",currId,d,a),Search.changeIndex("searchetampmSpan",currId,d,a)),Search.changeIndex("endTimeFields",currId,d,a),Search.changeIndex("searchenddate",currId,d,a),Search.changeIndex("searchethour",currId,d,a),Search.changeIndex("searchetminute",currId,d,a),Search.changeIndex("searchetime",currId,d,a),Search.changeIndex("divnum",currId,d,a),Search.changeIndex("endNumFields",currId,d,a),Search.changeIndex("numcond",currId,d,a),Search.changeIndex("numcondition",currId,d,a),Search.changeIndex("enc_divnum",currId,d,a),Search.changeIndex("enc_numcond",currId,d,a),Search.changeIndex("enc_numcondition",currId,d,a),Search.changeIndex("enc_searchnum",currId,d,a),Search.changeIndex("searchnum",currId,d,a),Search.changeIndex("searchenum",currId,d,a),Search.changeIndex("currencyCode",currId,d,a),Search.changeIndex("divBoolean",currId,d,a),Search.changeIndex("booleancond",currId,d,a),Search.changeIndex("booleancondition",currId,d,a),Search.changeIndex("searchboolean",currId,d,a),$("#actdiv_criteria"+currId+a).attr({name:"actdiv"+d+a,id:"actdiv_criteria"+d+a}),$("#actdiv_type"+currId+a).attr({name:"actdiv"+d+a,id:"actdiv_type"+d+a}),$("#searchcriteria"+d+a).find(".wf_slideDownUp_Div").removeClass("tr_cnt_"+currId).addClass("tr_cnt_"+d)}if($("#check1"+a).css("display",1===o?"none":""),Search.delRowFormPattern(e,a),Search.isFormRuleCriteria&&1==o)$("#searchcriteria1"+a).find("td:last").removeClass("hide");else if(Search.isFormRuleCriteria&&2==n){var S=$("#formRuleConditionForm").find("#searchcriteria2"+a);S.find(".cus_cb_label").addClass("inActiveSec"),S.find(".cus_cb_inp").prop("checked",!0)}},Search.changeIndex=function(e,t,a,r,i,n){n=n||document;var s=$(n).find("[name='"+e+t+r+"']");if(0===s.length&&(s=$(n).find("[id='"+e+t+r+"']")),0!==s.length){var l=e+a+(i||r);if("searchwizard"===e?s.attr({id:"input"+l,name:l}):s.attr({id:l,name:l}),"searchstime"==e)s.attr({fldlabel:"searchst@{pattern}"+a+r});else if("searchetime"==e)s.attr({fldlabel:"searchet@{pattern}"+a+r});else if("temp_searchuser"==e){var o=$("#temp_searchuser"+a);if(o.attr("selected-names")){var c="searchuser"+a;o.attr("field-id",c)}else{for(var d=o.find("li"),m=d.length,p=0;p<m;p++){var h=d.eq(p),u=h.attr("id");u=u.split("sel_temp_searchuser"+t),u="sel_temp_searchuser"+a+u[1],h.attr("id",u)}$("#hostSearch_"+e+t).attr("id","hostSearch_"+e+a)}}else"matchConditionLabel"===e&&(s.removeAttr("onClick"),s.unbind("click").click((function(){wfForm.setOprSel(this,a+(i||r))})))}},Search.numCheck=function(e,t,a){var r;r=t.which;var i=$(e).attr("data-maxvalue")?parseInt($(e).attr("data-maxvalue")):4;if(-1!=e.id.indexOf("ageindays1")&&e.getAttribute("data-maxvalue")){var n=String.fromCharCode(t.charCode);if(isNaN(n)&&0!=r&&13!=r&&8!=r&&1!=r&&9!=r&&27!=r&&110!=r&&190!=r&&(65!==r||!0!==t.ctrlKey&&!0!==t.metaKey)&&!(t.keyCode>=35&&t.keyCode<=40))return!1;var s=e.value;if("number"==typeof e.selectionStart){var l=e.selectionStart,o=e.selectionEnd;o-l!=0&&(s=s.slice(0,l)+s.slice(o))}var c=parseInt(s+n),d=e.getAttribute("data-maxvalue");if(c>parseInt(d))return crmui.showMsgBand("error",I18n.getMsg("sentiment.criteria.wrongcriteria",d),3e3),!1}else if((a||-1!=e.id.indexOf("ageindays"))&&(46==r||45==r||e.value.length>=i&&r>=48&&r<=57))return!1;return(r>=48&&r<=57||0==r||13==r||8==r||46==r||45==r)&&(46!=r||-1==e.value.indexOf("."))},Search.rfmNumCheck=function(e,t){var a;return(a=t.which)>=49&&a<=53},Search.campLookup=function(e){var t=e.substring(e.lastIndexOf("g")+1),a="temp_searchcampcv"+t,r="searchcampcv"+t;getObj("campcvcondition"+t)&&showLookUp(a,r,"Campaign Name","Campaigns",null,null,null,null,null,null,null,null,getObj("campcvcondition"+t).value.toString().replace("'","").replace(" ",""))};var browser_name=window.navigator.appName,browser_version=window.navigator.appVersion;browser_name.indexOf("mozilla")>=0&&browser_version<=1.6&&(getObj("divid").style.overflow="none"),Search.validate=function(e,t,a,r){var i=Search["rowcnt"+(t=void 0===t?"":t)];if($("#newpattern"+t).is(":visible")){var n=$("#patternVal"+t).val().split(" ").join("");if(n=Search.replaceAndOr(n),!this.validatePattern(n,t,i))return!1}getElemById("rowCount"+t).value=i;for(var s=!1,l=I18n.getMsg("None"),o=$(".validationRuleCongureWarningMsg"),c=1;c<=i;c++){suffix=c+t;var d=$("#searchfield"+suffix+" option:selected"),m=d.text();m=m.trim();var p=d.attr("id"),h=d.attr("data-enc"),u=getElemById("textcondition"+suffix).value;if("true"===h&&(u=getElemById("enc_textcondition"+suffix).value),m==l&&(1!=i||a))return a&&1==i?Search.isVRCriteria?o.text(I18n.getMsg("crm.criteria.cannot.empty")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.criteria.cannot.empty")):Search.isVRCriteria?o.text(I18n.getMsg("crm.criteria.fieldlabel.valid.check",c)).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.criteria.fieldlabel.valid.check",c+"")),getElemById("searchfield"+suffix).focus(),!1;var f=getElemById("textpicklistcondition"+suffix).value,v=$("#stagecondition"+suffix).val();if("stagecond"===p&&(f=v),("T"==p&&"None"==u||"picklist"==p&&"None"==f)&&(1!=i||a||1==c&&m!=l))return Search.isVRCriteria?o.text(I18n.getValueForFields("crm.criteria.condition.valid.check",m)).show():renderingUtils.showCustomAlert(I18n.getValueForFields("crm.criteria.condition.valid.check",m)),"true"===h?getElemById("enc_textcondition"+suffix).focus():getElemById("textcondition"+suffix).focus(),!1;var g,S,C=$("#servicestatuscondition"+suffix);if(m!=l){if(-1===getElemById("divpicklist"+suffix).className.indexOf("searchHide")||getElemById("divstage"+suffix)&&getElemById("divstage"+suffix).className.indexOf("searchHide")){var y=$("select[id=searchpicklist"+suffix+"]").val(),I=getObj("textpicklistcondition"+suffix).value;if("stagecond"===p&&(I=v),null!=y&&y.length>0){O=y[0].replace(/,/g,"\\,");for(var T=1;T<y.length;T++)O=O+","+y[T].replace(/,/g,"\\,");(_=$("input[name=searchpicklist"+suffix+"]").val())!=O&&$("input[name=searchpicklist"+suffix+"]").val(O)}else O=$("input[name=searchpicklist"+suffix+"]").val();if("is empty"!==I&&"is not empty"!==I&&"${OPEN}"!==I&&"${CLOSEDWON}"!==I&&"${CLOSEDLOST}"!==I&&"is OPEN"!==I&&"is WON"!==I&&"is LOST"!==I){if(!O)return Search.isVRCriteria?o.text(I18n.getValueForFields("crm.field.valid.check",m)).show():renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",m)),!1;if(0!=O.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&"${EMPTY}"!=O&&"${NOTEMPTY}"!=O&&(O=O.replace(/^\s+/g,"").replace(/\s+$/g,"")).indexOf("*")>-1)return Search.isVRCriteria?o.text(I18n.getMsg("crm.alert.character.not.allowed",["*"])).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.character.not.allowed",["*"])),!1}}var b=$("#searchselservicestatus"+suffix);if(Search.isFormRuleCriteria&&-1===getElemById("divservicestatus"+suffix).className.indexOf("searchHide")){y=b.val(),I=C.val();if(null!==y&&y.length>0){O=y[0].replace(/,/g,"\\,");var x=y.length;for(T=1;T<x;T++)O=O+","+y[T].replace(/,/g,"\\,");(_=$("#searchservicestatus"+suffix)).val()!==O&&_.val(O)}else O=_.val();if("is empty"!==I&&"is not empty"!==I){if(!O)return Search.isVRCriteria?o.text(I18n.getValueForFields("crm.field.valid.check",m)).show():renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",m)),!1;if(0!==O.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&"${EMPTY}"!==O&&"${NOTEMPTY}"!==O&&(O=O.replace(/^\s+/g,"").replace(/\s+$/g,"")).indexOf("*")>-1)return Search.isVRCriteria?o.text(I18n.getMsg("crm.alert.character.not.allowed",["*"])).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.character.not.allowed",["*"])),!1}}else if(-1===getElemById("divlayout"+suffix).className.indexOf("searchHide")||-1===getElemById("divwizard"+suffix).className.indexOf("searchHide")||-1===getElemById("divprofile"+suffix).className.indexOf("searchHide")||-1===getElemById("divrole"+suffix).className.indexOf("searchHide")){var w="W"===p?"searchwizard"+suffix:"Profile"===p?"searchprofile"+suffix:"Role"===p?"searchrole"+suffix:"searchlayout"+suffix;if(null==(y=$("select[id="+w+"]").val())||0==y.length)return Search.isVRCriteria?o.text(I18n.getValueForFields("crm.field.valid.check",m)).show():renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",m)),$("select[id="+w+"]").focus(),!1;if(null!=y&&y.length>0){O=y[0].replace(/,/g,"\\,");for(T=1;T<y.length;T++)O=O+","+y[T].replace(/,/g,"\\,");(_=$("input[name="+w+"]").val())!=O?$("input[name="+w+"]").val(O):O=$("input[name="+w+"]").val()}if(O&&0!=O.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&"${EMPTY}"!=O&&"${NOTEMPTY}"!=O&&(O=O.replace(/^\s+/g,"").replace(/\s+$/g,"")).indexOf("*")>-1)return Search.isVRCriteria?o.text(I18n.getMsg("crm.alert.character.not.allowed",["*"])).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.character.not.allowed",["*"])),!1}else if(-1===getElemById("divtag"+suffix).className.indexOf("searchHide")){y=$("select[id=searchtag"+suffix+"]").val(),I=getObj("tagcondition"+suffix).value;if((null==y||0==y.length)&&"is empty"!==I&&"is not empty"!==I)return alert(I18n.getMsg("crm.tag.customview.filter.select.one.tag")),$("select[id=searchtag"+suffix+"]").focus(),!1;if(null!=y&&y.length>0){O=y[0].replace(/,/g,"\\,");for(T=1;T<y.length;T++)O=O+","+y[T].replace(/,/g,"\\,");var _;(_=$("input[name=searchtag"+suffix+"]").val())!=O?$("input[name=searchtag"+suffix+"]").val(O):O=$("input[name=searchtag"+suffix+"]").val()}if(O&&0!=O.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&"${EMPTY}"!=O&&"${NOTEMPTY}"!=O&&(O=O.replace(/^\s+/g,"").replace(/\s+$/g,"")).indexOf("*")>-1)return alert(I18n.getMsg("crm.alert.character.not.allowed",["*"])),!1}else if(-1===getElemById("divtext"+suffix).className.indexOf("searchHide")||-1===getElemById("enc_divtext"+suffix).className.indexOf("searchHide")){var E=null,O=(E="true"===h?$("#enc_searchtext"+suffix):$("#searchtext"+suffix)).val();I=null;if(I="true"===h?getObj("enc_textcondition"+suffix).value:getObj("textcondition"+suffix).value,"picklist"===p){O=(y=$("select[id=searchtext"+suffix+"]").val())[0];for(T=1;T<y.length;T++)O.concat(",",y[T])}if("is empty"!==I&&"is not empty"!==I&&"None"!==u){if(0==O.length||""==O.trim()||","===O)return Search.isVRCriteria?o.text(I18n.getValueForFields("crm.field.valid.check",m)).show():renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",m)),E.focus(),!1;if(0!==O.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&"${EMPTY}"!==O&&"${NOTEMPTY}"!==O&&(O=O.replace(/^\s+/g,"").replace(/\s+$/g,"")).indexOf("*")>-1)return Search.isVRCriteria?o.text(I18n.getMsg("crm.alert.character.not.allowed","*")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.character.not.allowed","*")),getElemById("searchtext"+suffix).focus(),!1}}else if(-1===getElemById("divdate"+suffix).className.indexOf("searchHide")||-1===getElemById("enc_divdate"+suffix).className.indexOf("searchHide")){O=null,I=null;if("true"===h?(O=getElemById("enc_searchdate"+suffix).value,I=$("#enc_datecondition"+suffix).val()):(O=getElemById("searchdate"+suffix).value,I=$("#datecondition"+suffix).val()),"is empty"!==I&&"is not empty"!==I&&(0==O.length||null!=O&&0!=O.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&"${EMPTY}"!=O&&"${NOTEMPTY}"!=O&&"${TODAY}"!=O&&"${TODAY}"!=O&&"${TOMORROW}"!=O&&"${TOMORROWPLUS}"!=O&&"${YESTERDAY}"!=O&&"${YESTERDAYMINUS}"!=O&&"${THISMONTH}"!=O&&"${THISWEEK}"!=O&&"${LASTMONTH}"!=O&&"${LASTWEEK}"!=O&&"${NEXTMONTH}"!=O&&"${NEXTWEEK}"!=O&&"${LASTYEAR}"!=O&&"${THISYEAR}"!=O&&"${NEXTYEAR}"!=O&&"${PREVFQ}"!=O&&"${THISFQ}"!=O&&"${NEXTFQ}"!=O&&"${PREVFY}"!=O&&"${THISFY}"!=O&&"${NEXTFY}"!=O)){if(!CrmDateUtils.dateValidate("searchdate"+suffix,m,"OTH"))return getElemById("searchdate"+suffix).focus(),!1;if($("#enddateFields"+suffix+":visible").length&&!CrmDateUtils.dateValidate("searchedate"+suffix,m,"OTH"))return getElemById("searchedate"+suffix).focus(),!1}}else if(-1===getElemById("divnum"+suffix).className.indexOf("searchHide")||-1===getElemById("enc_divnum"+suffix).className.indexOf("searchHide")){O=null;O="true"===h?getObj("enc_searchnum"+suffix).value:getObj("searchnum"+suffix).value;I=null;if("is empty"!==(I="true"===h?getObj("enc_numcondition"+suffix).value:getObj("numcondition"+suffix).value)&&"is not empty"!==I){if(0==O.length||0!=O.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&"${EMPTY}"!=O&&"${NOTEMPTY}"!=O){O=O.replace(/^\s+/g,"").replace(/\s+$/g,"");var N=/^-?\d+(,(\d)+)*(\.\d{1,2})*$/;if("FormRules"===r&&(O=Search.reverseFormatNumber(O)),isNaN(O)||!N.test(O))return Search.isVRCriteria?o.text(I18n.getValueForFields("crm.field.valid.check",m)).show():renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",m)),getObj("searchnum"+suffix).focus(),!1}if($("#endNumFields"+suffix+":visible").length){var L=getObj("searchenum"+suffix).value;if(0==L.length||0!=L.replace(/^\s+/g,"").replace(/\s+$/g,"").length){L=L.replace(/^\s+/g,"").replace(/\s+$/g,"");N=/^-?\d+(,(\d)+)*(\.\d{1,2})*$/;if(isNaN(L)||!N.test(L))return Search.isVRCriteria?o.text(I18n.getValueForFields("crm.field.valid.check",m)).show():renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",m)),getObj("searchenum"+suffix).focus(),!1;if(parseFloat(O)===parseFloat(L))return getObj("searchnum"+suffix).focus(),Search.isVRCriteria?o.text(I18n.getMsg("crm.custom.field.value.not.same")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.custom.field.value.not.same"),"",!0),!1;if(parseFloat(O)>parseFloat(L)||!commonUtils.compareNumber(O,L))return getObj("searchnum"+suffix).focus(),Search.isVRCriteria?o.text(I18n.getMsg("crm.custom.field.less.than.to")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.custom.field.less.than.to"),"",!0),!1}}}}else if(-1===getElemById("divageindays"+suffix).className.indexOf("searchHide")){var D=getElemById("ageindays"+suffix);if(0==(O=D.value).length||0!=O.replace(/^\s+/g,"").replace(/\s+$/g,"").length){O=O.replace(/^\s+/g,"").replace(/\s+$/g,"");N=/^(\d){1,4}$/;var M=$("#datecondition"+suffix+":visible").val()||$("#datetimecondition"+suffix+":visible").val();if(isNaN(O)||!N.test(O))return Search.isVRCriteria?o.text(I18n.getMsg("crm.field.valid.check",M)).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.field.valid.check",M)),D.focus(),!1}}else if(-1===getElemById("divdatetime"+suffix).className.indexOf("searchHide")||-1===getElemById("enc_divdatetime"+suffix).className.indexOf("searchHide")){O=null,I=null;if("true"===h?(O=$("#enc_searchdatedate"+suffix).val(),I=$("#enc_datetimecondition"+suffix).val()):(O=$("#searchdatedate"+suffix).val(),I=$("#datetimecondition"+suffix).val()),"is empty"!==I&&"is not empty"!==I&&(0==O.length||0!=O.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&"${EMPTY}"!=O&&"${NOTEMPTY}"!=O&&"${TODAY}"!=O&&"${TOMORROW}"!=O&&"${TOMORROWPLUS}"!=O&&"${YESTERDAY}"!=O&&"${YESTERDAYMINUS}"!=O&&"${THISMONTH}"!=O&&"${THISWEEK}"!=O&&"${LASTMONTH}"!=O&&"${LASTWEEK}"!=O&&"${NEXTMONTH}"!=O&&"${NEXTWEEK}"!=O&&"${LASTYEAR}"!=O&&"${THISYEAR}"!=O&&"${NEXTYEAR}"!=O&&"${PREVFQ}"!=O&&"${THISFQ}"!=O&&"${NEXTFQ}"!=O&&"${PREVFY}"!=O&&"${THISFY}"!=O&&"${NEXTFY}"!=O)){if(!CrmDateUtils.dateValidate("searchdatedate"+suffix,"DateTime","OTH"))return getObj("searchdatedate"+suffix).focus(),!1;if("none"!==getObj("endTimeFields"+suffix).style.display){var R=getObj("searchenddate"+suffix).value;if((0!=R.replace(/^\s+/g,"").replace(/\s+$/g,"").length||0==R.length)&&!CrmDateUtils.dateValidate("searchenddate"+suffix,"DateTime","OTH"))return getObj("searchenddate"+suffix).focus(),!1}}}}if("picklist"===p||"stagecond"===p){O=$("select[id=searchpicklist"+suffix+"]").val();var k=$("input[name=searchpicklist"+suffix+"]");if(g=$("#textpicklistcondition"+suffix).val(),"stagecond"===p&&(g=v),null!=O&&O.length>0){O=y[0];for(T=1;T<y.length;T++)O=O+","+y[T]}else O=$("input[name=searchpicklist"+suffix+"]").val()}if("L"===p)if(O=$("select[id=searchlayout"+suffix+"]").val(),g=$("#layoutcondition"+suffix).val(),null!=O&&O.length>0){O=y[0];for(T=1;T<y.length;T++)O=O+","+y[T]}else O=$("input[name=searchlayout"+suffix+"]").val();if("W"===p)if(O=$("#searchwizard"+suffix).val(),g=$("#wizardcondition"+suffix).val(),null!=O&&O.length>0){O=y[0];var A=y.length;for(T=1;T<A;T++)O=O+","+y[T]}else O=$("#inputsearchwizard"+suffix).val();else if("tag"===p)if(O=$("select[id=searchtag"+suffix+"]").val(),g=$("#tagcondition"+suffix).val(),null!=O&&O.length>0){O=y[0];for(T=1;T<y.length;T++)O=O+","+y[T]}else O=$("input[name=searchtag"+suffix+"]").val();else if("T"===p||"ActivityType"===p){k=null;O=(k="true"===h?$("#enc_searchtext"+suffix):$("#searchtext"+suffix)).val(),g="true"===h?$("#enc_textcondition"+suffix).val():$("#textcondition"+suffix).val()}else if("U"==p)O=getObj("searchuser"+suffix).value,g=$("#usercondition"+suffix).val();else if("CML"==p)O=getObj("temp_searchcampcv"+suffix).value,g=$("#campcvcondition"+suffix).val();else if("CS"==p)O=getObj("searchcallstatus"+suffix).value,g=$("#callstatuscondition"+suffix).val();else if("ServiceStatus"===p)if(k=S=$("#searchservicestatus"+suffix),O=b.val(),g=C.val(),null!==O&&O.length>0){O=y[0];var B=y.length;for(T=1;T<B;T++)O=O+","+y[T]}else O=k.val();else if("consent"==p)if(O=$("select[id=searchpicklist"+suffix+"]").val(),g=$("#consentcondition"+suffix).val(),null!=O&&O.length>0){O=y[0];for(T=1;T<y.length;T++)O=O+","+y[T]}else O=$("input[name=searchpicklist"+suffix+"]").val();else if("B"==p){if((O=$("#searchboolean"+suffix).val())||(O=$("input[name=searchboolean"+suffix+"]").val()),!O)return Search.isVRCriteria?o.text(I18n.getValueForFields("crm.field.valid.check",m)).show():renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",m)),!1;g=$("#booleancondition"+suffix).val()}else"N"==p?"true"===h?(g=$("#enc_numcondition"+suffix).val(),O=getObj("enc_searchnum"+suffix).value):(g=$("#numcondition"+suffix).val(),O=getObj("searchnum"+suffix).value):"DT"==p?"true"===h?(O=$("#enc_searchdatedate"+suffix).val(),g=$("#enc_datetimecondition"+suffix).val()):(O=$("#searchdatedate"+suffix).val(),g=$("#datetimecondition"+suffix).val()):"D"==p?"true"===h?(O=$("#enc_searchdate"+suffix).val(),g=$("#enc_datecondition"+suffix).val()):(O=getObj("searchdate"+suffix).value,g=$("#datecondition"+suffix).val()):"MXN"===p&&(g="true"===h?$("#enc_mxncondition"+suffix).val():$("#mxncondition"+suffix).val());if(O&&k&&void 0===k.attr("data-isdef")&&("picklist"===p||"T"===p||"ServiceStatus"===p))if(("string"==typeof O?O.split(","):O).length>Search.maxValuesForTextCond)return Search.isVRCriteria?o.text(I18n.getMsg("crm.alert.maximum.text.values.contains",Search.maxValuesForTextCond.toString())).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.maximum.text.values.contains",Search.maxValuesForTextCond.toString())),k.focus(),!1;if((O||""===O&&a)&&""===O.trim()&&"is empty"!==g&&"is not empty"!==g&&"Age in Days"!==g&&"is OPEN"!==g&&"is WON"!==g&&"is LOST"!==g&&g!==Search.dueCrt&&(1!==i||a))return Search.isVRCriteria?o.text(I18n.getValueForFields("crm.criteria.fieldvalue.valid.check",m)).show():renderingUtils.showCustomAlert(I18n.getValueForFields("crm.criteria.fieldvalue.valid.check",m)),"U"==p?getObj("searchuser"+suffix).focus():"CML"==p?getObj("temp_searchcampcv"+suffix).focus():"CS"==p?getObj("searchcallstatus"+suffix).focus():"ServiceStatus"===p?S.focus():"consent"==p?getObj("searchpicklist"+suffix).focus():"B"==p||"picklist"!==p&&getObj("searchtext"+suffix).focus(),!1;(O||""==O&&a)&&""!=O.trim()&&(s=!0)}return e&&s&&alert(I18n.getMsg("crm.territory.msg.no.parent.rule")),!0},Search.changeCriteria=function(e,t){var a=t.id;e=a.substr(a.lastIndexOf("n")+1);var r=t.value,i=$("#endTimeFields"+e);$(i).closest("td").removeClass("cri_two_inp");var n=$("#"+a).closest("#createProcessPopDiv");n.is(":visible")&&("between"!==r&&"not between"!==r||n.removeClass("w740").addClass("minW860"));var s=$("#ageindayscond"+e);if(r===Search.ageCrt||r===Search.dueCrt)return $("#divdatetime"+e).addClass(Search.classNameForHide),s.css("display",""),$("#divageindays"+e).removeClass(Search.classNameForHide).addClass("fL"),$("#endTimeFields"+e).css("display","none"),void thirdPartyUtils.bindSelect2(s.find("select"));if("between"===r||"not between"===r)$(i).closest("td").addClass("cri_two_inp"),i.find(".newtimefrmt").css("display","block"),i.addClass("fL").css("display","block"),$("#searchdatedate"+e).attr({size:"15"});else{var l=$("#searchdatedate"+e).parent("span").find(".newtimefrmt");l.css("display","block"),$("#endTimeFields"+e).css("display","none"),"Today"!==r&&"Tommorow"!==r&&"Tommorow Onwards"!==r&&"Yesterday"!==r&&"Till Yesterday"!==r||(l.css({display:"none"}),$("#searchdatedate"+e).attr({size:"20"}))}s.css("display","none"),$("#divageindays"+e).addClass(Search.classNameForHide),a.indexOf("enc_")>-1?$("#enc_divdatetime"+e).removeClass(Search.classNameForHide).addClass("cri_divdatetime  fL"):$("#divdatetime"+e).removeClass(Search.classNameForHide).addClass("cri_divdatetime  fL")};var userselmonth,userselyear,datefieldName,browff=document.getElementById&&!document.all,todaydate=new Date,todaymonth=todaydate.getMonth(),monthend=new Array(31,28,31,30,31,30,31,31,30,31,30,31),todayyear=todaydate.getYear();todayyear<1e3&&(todayyear+=1900);var userdayanddate=todaydate.getDate();function showCalen(e,t,a,r,i,n,s){if(n=n&&$(n).length?$(n):$('[id="'+e+'"]').eq(0),(!0!==i||!0!==n.prop("readOnly"))&&(crmCalendar.showCalendar(event,void 0,s,a,r),1===$("#analyticalPageContainer").length||1===$("#createDashboardPanel").length)){var l=n;AnalyticsChart.focusCalenderEle(l)}}userselmonth=todaymonth,userselyear=todayyear;var calenderTop="",userDateFrmtinCE=null;function dropRofn(e,t){e.className="bg_crmSelectBg",document.getElementById("div"+t)&&(document.getElementById("div"+t).style.visibility="visible")}function dropRoutfn(e,t){e.className="bg_white",document.getElementById("div"+t)&&(document.getElementById("div"+t).style.visibility="hidden",$("#dropnoteDiv")&&($("#dropnoteDiv").hide(),$("#dropnoteDiv").onmouseover=function(){e.className="bg_crmSelectBg",document.getElementById("div"+t).style.visibility="visible",show($("#dropnoteDiv"))},$("#dropnoteDiv").onmouseout=function(){e.className="bg_white",document.getElementById("div"+t).style.visibility="hidden",hide($("#dropnoteDiv"))}))}function setCommaSeparatedValues(e,t){var a,r=t.length;if(t&&""!=t&&t.length>0){if(""!=t[0]){a=t[0].replace(/,/g,"\\,");for(var i=1;i<r;i++)""!=t[i]&&(a=a+","+t[i].replace(/,/g,"\\,"));e.val(a)}}else e.val("")}Search.replaceAndOr=function(e){for(var t,a="",r=e.replace(/[(,),0-9]/g,"$"),i=r.length,n=0;n<i;n++)"$"!=r[n]?(-1==(t=r.substr(n).indexOf("$"))&&(t=i-1),a+=Search.andOrMapping[r.substring(n,t+n)],n+=t-1):a+=e[n];return a},Search.removeSingleUser=function(e,t,a,r,i,n){t=$(t).parent("li");var s=$(t).data("id"),l=$("#"+r),o=l.data("bodyappend"),c=$(t).closest('div[id^="temp_searchuser"]'),d=$(t).attr("id"),m=t.parent().find("input"),p=$("#multipleFieldsEditPop").is(":visible");l.trigger({type:"change",name:"removedListItem",id:d,userId:s}),r=c.length?c.attr("id"):r,t.remove(),e&&renderingUtils.stopEvent(e);var h=l,u=l.data("withmultipleoptions"),f=$("#ownerNameLookup_"+r);if(r.indexOf("MXNDUMMYCOLUMN")>-1){var v=l.data("selectedid")+"";if(v.length>1){var g=v.split("-")[1];v=v.split("-")[0];var S=a.replace(r+"_","");g||(g=""),(v=v.replace(S+",","").replace(","+S,"").replace(S,""))&&""!=v||m.attr("placeholder",m.attr("rplaceholder")),v+=""==g?"-"+S:"-"+g+","+S,l.data("selectedid",v);var C=r.split("_"),y=C.length,I=$("#mouseArea__"+C[y-1]);if(I&&I.data("params"))I.data("params").selectedid=v;l.val(v)}f.length||(Crm.showLookUp(Crm.moduleName,r,r,h.data("label"),h.data("lookupModule"),null,null,null,null,null,null,null,null,null,h.data("linkingmodule")),f=$("#ownerNameLookup_"+r))}if(f.length){var T=h.offset();"yes"==o?T.top+=h.parent().innerHeight():p&&445===h.data("uitype")?T.top=ProcessFlow.getOwnerLookupHeight(h).topOffset:T.top=h.parent().innerHeight();var b=f.offset();T.top+2!=b.top&&f.css("top",T.top+2)}for(var x=l.find("ul").find("li"),w="",_=0;_<x.length;_++)if(temp_val=$(x[_]).data("id"),_)w=w+","+temp_val;else var w=temp_val;l.prevAll("input").length>0?l.prevAll("input:eq(0)").val(w):l.data("id",w),$("[id='"+a+"']").attr("class","active-result"),Search.setOwnerNameValues(r,u),i&&$("#"+i).val(""),n&&$("#"+n).val(""),$("#hostListCont_"+r).removeClass("ownerLookUpDisable"),e&&renderingUtils.stopEvent(e)},Search.allSelectedSpan=function(e){var t=$("#ownerNameLookup_"+e).find("ul"),a=t.find("li").length,r=t.find("li.ownerException").length,i=t.find("li.result-selected-no-display").length,n=$("#nomatch_"+e);t.data("searchKey")&&""!=t.data("searchKey")&&a-r-i<1?n.show():a-r==i?$("#allSelected_"+e).show():($("#allSelected_"+e).hide(),n.hide())},Search.setOwnerNameValues=function(e,t){if("searchUserInLAR"!=e&&"addUserInLAR"!=e){var a=$("#temp_"+e)[0];if(a){var r=a.querySelectorAll("[id*='sel_']"),i="",n=r.length;for(let e=0;e<n;e++)i=""===i?r[e].dataset.id:r[e].dataset.id+","+i;var s,o=i,c=!0;try{var d=$.parseJSON(o)}catch(e){c=!1}if(!c||d&&d.length||(c=!1),c){for(var m=d.length,p=0;p<m;p++)0==p?s=d[p].id:s+=","+d[p].id;o=s}var h=$("#"+e).data("exception"),u=$("#ownerNameLookup_"+e);if(h)var f=$("#"+h).val();if("yes"==t){if($("#"+e).find("ul").find("li").length>0&&$("#hostSearch_"+e).attr("placeholder",""),u.find("ul").find("li").attr("class","active-result"),h&&""!=f&&($("#"+e+"_"+f).css("display","none"),$("#"+e+"_"+f).attr("class","ownerException")),o&&o.indexOf("-")>-1&&(o=o.split("-")[0]),o)if((o+="").indexOf(",")>-1)for(var v=(o=o.split(",")).length,g=0;g<v;g++)o[g]&&$("[id='"+e+"_"+o[g]+"']").attr("class","result-selected-no-display");else $("[id='"+e+"_"+o+"']").attr("class","result-selected-no-display");var S=u.find("li");for(v=S.length,l=0;l<v;l++){var C=S.eq(l).children("span");C.eq(1).css("margin-left",-C.eq(0).width())}Search.hideSpan(e)}else u.find("ul").find("li").removeClass("result-selected"),o&&$("#"+e+"_"+o).addClass("result-selected");Search.allSelectedSpan(e)}}},Search.assignEnter=function(e){("object"==typeof e?e:$("#hostSearch_"+e)).keydown((function(e){var t=$(this).closest("div").attr("id");if(13==e.which){if($("#ownerNameLookup_"+t).find("ul").find("li").hasClass("highlighted")){var a=$("#ownerNameLookup_"+t).find("ul").find("li.highlighted");$(a).trigger("click");$(this);Search.ownerNameLookupSearch("",this,"hostListCont_"+t,"li","nomatch_"+t,"userName"),Search.hideSpan(t);var r=$(a).nextAll("li.active-result")[0];$(r).addClass("highlighted")}return renderingUtils.stopEvent(e),!1}}))},Search.folUserDropdown=function(e,t,a,r,i){if(!0===Crm.userDetails.FIELD_OF_LOOKUP_ENABLED&&!0===Crm.userDetails.FIELD_OF_LOOKUP_AVAIALBLE)if("true"===e){var n={searchmodule:"Users",fldValue:"",isAutoComplete:!0,offset:"1",currencyISOCode:"",productId:"",fldName:t,entityId:"",fieldId:a,isSubFormField:"false",parentModule:r,layoutId:i="null"!==i?i:"",isFolUser:!0,isBP:$("#multipleFieldsEditPop").is(":visible")};store.findAll("dummy",n,!1,!1,{url:Crm.getCrmBasePath()+"/Search.do",method:"POST"}).then((function(e){Search.folUserRefValues.length>0&&(Search.folUserRefValues=[]),Search.folUserRefValues=e.dummy.Value}))}else Search.folUserRefValues.length>0&&(Search.folUserRefValues=[])},Search.selectOwner=function(e,t){var a=e,r=$("#ownerNameLookup_"+a),i="";-1!=a.indexOf("Approval")&&(i="Approval");var n="";$('[data-close="true"]').hide(),"approvalprocess"==t&&(n="_"+a.split("_")[1]),$("#ownerNameLookup_"+a+" ul li").click((function(){var e=$(this),i=$(e),n=(n=i.attr("username")).split(",")[0],s=i.data("id").toString(),l=i.data("profileid").toString(),o="";"workflow"!=t&&"approvalprocess"!=t&&changeOwner.enableButton(),-1!=a.indexOf("Approval")&&(o="Approval");var c="";if("approvalprocess"==t)c="_"+a.split("_")[1];var d=$("#"+o+"applyRestrictionOption"+c);d.length>0&&d[0].setData({ownerName:n});var m=$("#"+o+"OwnerField"+c);$("#ownerName").text(" "+n),$("#ownerId").val(s),$("#"+o+"ownerNameIntext"+c).text(""),$("#ownerNameIntext").text(" "+n),$(".form_err_msg").hide(),$(".wf_no_focus").removeClass("wf_no_focus form_err_fld"),m.removeClass("dN"),$("#"+a).data("id",s).data("profileId",l),m.show(),$("span.coma:visible:last").addClass("removecoma");var p=$("#"+a);if("workflow"==t)$("#ownerId").val(s),$(".fieldvals").text(n),$("#fieldValue1").val(n);else if("approvalprocess"==t){$("#"+o+"ownerName"+c).text(I18n.getMsg("crm.label.selected.owners")),$("#"+o+"ownerNameIntext"+c).text(""),$("#"+o+"ownerNameIntext"+c).text(I18n.getMsg("crm.changeOwner.newOwner.text")),$("."+a).text(n),p.val(n);var h=a.slice(-3);$("#"+o+"ownerId"+h).val(s)}else changeOwner.enableButton(),p.find("span").text(n),r.css("display","none")})),$("#"+a).click((function(){var e=$("#ownerNameLookup_"+a);e.is(":visible")&&e.css("display","none");var t=$("#"+i+"AvailableRecords"+n);t.is(":visible")&&t.css("display","none")})),$("#changeOwnerForm").click((function(){var e=$("#ownerNameLookup_"+a);e.is(":visible")&&e.css("display","none")})),$("#"+i+"RecordsSpan"+n).off("click.recordSpan"),$("#"+i+"RecordsSpan"+n).on("click.recordSpan",(function(){var e=$("#ownerNameLookup_"+a);e.is(":visible")&&e.css("display","none")})),r.find("ul li").mouseover((function(){r.find("ul li").hasClass("highlighted")?(r.find("ul li").removeClass("highlighted"),$(this).addClass("highlighted")):($(this).prevAll("li").removeClass("highlighted"),$(this).nextAll("li").removeClass("highlighted"),$(this).addClass("highlighted"))})).mouseout((function(){$(this).removeClass("highlighted")})),Search.allSelectedSpan(a)},Search.assignClick=function(e,t,a){if("searchUserInLAR"!=e&&"addUserInLAR"!=e){$("#"+(t?e+"_"+t:"ownerNameLookup_"+e+" ul li")).off("click").on("click",(function(t){var a=e,r=$("#"+a),i=r.data("withmultipleoptions"),n=r.data("changefield1"),s=r.data("changefield2"),l=r.data("bodyappend"),o=r.data("entityowner"),c=$(this),d=c.attr("id"),m=c.find(".userNameLookup").text(),p=""===m?c.text():m,h=c.data("id").toString(),u=$("#ownerNameLookup_"+a).attr("data-fieldName"),f=$(c).attr("user-zuid"),v=$("#socAddToCrmPop");if(("MassConvert"===r.data("action")||"SingleConvert"===r.data("action")||"WFConvert"===r.data("action")||"Blueprint"===r.data("actionfol")||v.is(":visible"))&&Search.folUserRefValues.length>0){var g=r.data("fieldidfoldeal");(void 0===g&&"Blueprint"===r.data("actionfol")||v.is(":visible"))&&(g=r.data("fieldid"));for(var S={},C=Search.folUserRefValues,y=C.length,I=0;I<y;I++)if(C[I].seId===h){S.item=C[I];break}if(S.item){var T=S.item.refFieldsInfo;T&&S.item.parentFieldsColumnName&&(T=T||{},Crm.setRefFieldValues(g,"",T,1))}}if("yes"==i){if(renderingUtils.stopEvent(t),c.hasClass("result-selected-no-display")){c.removeClass("result-selected-no-display"),c.show();var b=document.getElementById("sel_"+d).childNodes;Search.removeSingleUser("",b,d,u,n,s)}else{if(c.attr("class","result-selected-no-display"),Search.hideSpan(e),r.find("ul").find("input").before('<li class="search-choice" data-id="'+h+'" id="sel_'+a+"_"+h+'">'+$ESAPI.encoder().encodeForHTML(p)+'<a href="javascript:void(0)" class="search-choice-close p0" onclick="Search.removeSingleUser(event,this,\''+d+"','"+u+"','"+n+"','"+s+"')\"></a></li>"),r.prevAll("input:eq(0)").val()){var x=r.prevAll("input:eq(0)").val();","==x.substr(x.length-1)?$(r).prevAll("input:eq(0)").val(x+h):r.prevAll("input:eq(0)").val(x+","+h)}else r.prevAll("input:eq(0)").val(h);r.trigger({type:"change",name:"selectedListItem",id:a+"_"+h,liId:h})}r.find(".search-choice").length>=r.data("maxlength")&&$("#hostListCont_"+a).addClass("ownerLookUpDisable"),Search.allSelectedSpan(e)}else if(a.indexOf("MXNDUMMYCOLUMN")>-1){renderingUtils.stopEvent(t);var w=$(r.parent().find("ul").find("input"));w.val(""),$(r.parent().find("ul")).data("searchKey","");var _=r.data("selectedid");if(_){if(_&&(_+="").length>0){var E="";if(_.indexOf("-")>-1){var O=_.split("-");_=O[0],E=O.length>1?O[1]:""}if(_.split(",").length>=r.data("maxlength")/2)return void crmui.showMsgBand("warning",I18n.getMsg("crm.field.maxlimit.mxnuser.warning",[$ESAPI.encoder().encodeForHTML(r.data("maxlength")/2+"")]),4e3);E.length>0&&(E=(E=(E=E.replace(h+",","")).replace(","+h,"")).replace(h,"")),""==_?_=h+"":_+=","+h,_+="-"+E,r.data("selectedid",_)}}else r.data("selectedid",h+"");var N=a.split("_"),L=N.length,D=$("#mouseArea__"+N[L-1]);if(D&&D.data("params"))D.data("params").selectedid=_;if(r.val(r.data("selectedid")),c.hasClass("result-selected-no-display")){c.removeClass("result-selected-no-display"),c.show();b=document.getElementById("sel_"+d).childNodes;Search.removeSingleUser("",b,d,u,n,s)}else{c.attr("class","result-selected-no-display"),Search.hideSpan(e);$("#temp_"+a).find("ul").find("input").before('<li class="search-choice" data-id="'+h+'" id="sel_'+a+"_"+h+'">'+$ESAPI.encoder().encodeForHTML(p)+'<a href="javascript:void(0)" class="search-choice-close p0" onclick="Search.removeSingleUser(event,this,\''+d+"','"+u+"','"+n+"','"+s+"')\"></a></li>").focus()}w.attr("placeholder","")}else if(r.find("span").hasClass("spanGrey")&&r.find("span").removeClass("spanGrey"),c.hasClass("result-selected")&&"yes"!=o){var M=$(c).attr("id"),R=$(c).data("id");$(c).removeClass("result-selected"),$("#"+a).find("span").html(""),$("#"+a).find("span").attr("userid",""),$("#"+a).trigger({type:"change",name:"removedListItem",id:M,userId:R}),n&&$("#"+e).prevAll("input:eq(0)").prev().val(""),s&&$("#"+e).prevAll("input:eq(0)").val("")}else{var k;if($("#ownerNameLookup_"+a).find("ul").find("li").attr("class","active-result"),$(c).addClass("result-selected"),$("#"+a).find("span").text(p),$("#"+a).find("span").attr("userid",h),$("#"+a).find("span").attr("userzuid",f),$("#ownerId").val(h),(k=$("#multipleFieldsEditPop").is(":visible")?$L("#multipleFieldsEditPop").find(".duringTabDivsClass .current crm-threshold-grant."+a):$L("#assRestGrant")).length>0){var A=k[0];A.setData({ownerid:h}),A.component.methods.addRestrictionMessage(A)}if($("#"+a).prevAll("input").length>0?$("#"+a).prevAll("input:eq(0)").val(h):($("#"+a).data("id",h),$("#"+a).attr("title",p)),s){$("#"+d).attr("username");$("#"+e).prevAll("input:eq(0)").prev().val(p)}$("#"+a).trigger({type:"change",name:"selectedListItem",id:a+"_"+h,liId:h})}var B=$("#"+a),F=(B.width(),B.offset()),P=$(window).width();F.left+400>P&&(F.left-=200),"yes"==l?F.top+=B.parent().innerHeight():F.top=B.parent().innerHeight(),$("#meetingInclude").is(":checked")&&Events.checkAuthorizeDone($("#Crm_Events_MeetingSolutions_select option:selected").attr("name")),Search.setOwnerNameValues(e,i),$("#hostSearch_"+e).val(""),$("#"+a).trigger("ownerLookupChanged")}));var r=$("#ownerNameLookup_"+e);r.find("ul li").mouseover((function(){r.find("ul li").hasClass("highlighted")?(r.find("ul li").removeClass("highlighted"),$(this).addClass("highlighted")):($(this).prevAll("li").removeClass("highlighted"),$(this).nextAll("li").removeClass("highlighted"),$(this).addClass("highlighted"))})).mouseout((function(){$(this).removeClass("highlighted")}))}},Search.assignOn=function(e){if(Search.InfoForPartialLoad)return!1;("object"==typeof e?e:$("#hostSearch_"+e)).on("input",(function(){if(Search.InfoForPartialLoad)return!1;var e=$(this).val(),t=$(this).closest("div").attr("id");Search.ownerNameLookupSearch(e,this,"hostListCont_"+t,"li","nomatch_"+t,"userName"),Search.hideSpan(t)}))},Search.focusUserMxNInput=function(e){var t=$(e).find("input");$(t).focus(),crmTemplate.showUserLookup(t)},Search.createShowLookup=function(e,t,a,r,i,n,s,o){$("#ownerNameLookup_"+e)&&$("#ownerNameLookup_"+e).remove();var c=e,d=$("#"+e),m=(d.data("withemail"),d.data("deactivatedusers"),d.data("confirmeduseronly"),d.data("withmultipleoptions")),p=d.data("includedevuser"),h=(d.data("changefield1"),d.data("changefield2"),d.data("exception")),u=d.data("colname"),f=d.data("bodyappend"),v=d.data("innerscrollid"),g=$("#"+c),S=g.data("uitype"),C=g.data("multiplesearch"),y=!1;if("undefined"!=typeof approvalProcess&&approvalProcess&&$L("#allRuleSection").length>0&&"undefined"!=typeof wfNew&&wfNew&&wfNew.isPrivateModuleWorkflow(approvalProcess.getModule())&&(y=!0),Lyte.Router.getRouteInstance()&&Lyte.Router.getRouteInstance().routeName&&"index-auto-response-rules"===Lyte.Router.getRouteInstance().routeName&&Lyte.Router.getRouteInstance().getQueryParams()&&Lyte.Router.getRouteInstance().getQueryParams().module&&moduleRecordMapping){var I=Lyte.Router.getRouteInstance().getQueryParams().module;moduleRecordMapping[I]&&"team_based"===moduleRecordMapping[I].access_type&&(y=!0)}Search.findTheTarget(c);var T=d.data("changeowner");d.data("ownerid");if(d.data("userViewPermCheck",i),d.data("moduleName",n),d.data("actiontype",r),h)$("#"+h).val();c.indexOf("MXNDUMMYCOLUMN")>-1&&(m="yes","yes",u=c.split("_")[2],S=445),"yes"==m&&d.focusout((function(){var e=$(this).attr("id");$(this).find("ul").find("li").length>0?$("#hostSearch_"+e).attr("placeholder",""):$("#hostSearch_"+e).attr("placeholder",I18n.getMsg("crm.label.select.user"))}));var b=!0;c.startsWith("temp_searchuser")&&(!0,b=!1);var x,w=d.innerHeight(),_=d.parent(),E=1e3;if(!Crm.isHeadless&&crmNTC.isSignalDetailViewVisible()&&(E=33),-1!=c.indexOf("Crm_Events_SMOWNERID"))t=g.parents("#multipleFieldsEditPop").length>0&&!0===$("#eventCreatePopup").is(":visible")?t+70:_.width()+70,x=(Y=$("#multipleFieldsEditPop").is(":visible"))?{name:"div",css:{"z-index":"102","background-color":"#fff",border:"1px solid #d4d4d4",position:"absolute",top:g.offset().top+g.outerHeight()+10+"px",left:g.offset().left+"px",width:"auto",overflow:"auto","box-shadow":"0 4px 16px rgba(0,0,0,0.3)","border-top":"0"},attr:{id:"ownerNameLookup_"+e,name:"ownerNameLookup",class:"pR","data-fieldName":e},child:[]}:{name:"div",css:{"z-index":E,"background-color":"#fff",border:"1px solid #d4d4d4",position:"absolute",top:a.top+5+"px",left:a.left+"px",width:t+"px",overflow:"auto","box-shadow":"0 4px 16px rgba(0,0,0,0.3)","border-top":"0"},attr:{id:"ownerNameLookup_"+e,name:"ownerNameLookup",class:"pR","data-fieldName":e},child:[]};else if(null!=u){if(-1!=u.indexOf("SMOWNERID")||-1!=u.indexOf("HANDLER")||void 0!==S&&(221===S||445===S))if((Y=$("#multipleFieldsEditPop").is(":visible"))&&void 0!==S&&445!==S)x={name:"div",css:{"z-index":"Crm_Products_HANDLER"===c?"249":E,"background-color":"#fff",border:"1px solid #d4d4d4",position:"absolute",top:a.top+5+"px",left:a.left-7+"px",width:"400px",overflow:"auto","box-shadow":"0 4px 16px rgba(0,0,0,0.3)","border-top":"0"},attr:{id:"ownerNameLookup_"+e,name:"ownerNameLookup",class:"pR","data-fieldName":e},child:[]};else if(x={name:"div",css:{"z-index":"Crm_Products_HANDLER"===c?"249":E,"background-color":"#fff",border:"1px solid #d4d4d4",position:"absolute",top:(w=_.innerHeight())+"px",width:"400px",overflow:"auto","box-shadow":"0 4px 16px rgba(0,0,0,0.3)","border-top":"0"},attr:{id:"ownerNameLookup_"+e,name:"ownerNameLookup",class:"pR","data-fieldName":e},child:[]},Y&&445===S){var O=ProcessFlow.getOwnerLookupHeight(d);x.css=$.extend({},x.css,{left:O.leftOffset+"px",top:O.topOffset+"px","z-index":200})}}else if("yes"==f)x={name:"div",css:{"z-index":"999","background-color":"#fff",border:"1px solid #d4d4d4",top:a.top+2+"px",left:a.left+"px","box-shadow":"0 4px 16px rgba(0,0,0,0.3)",position:"absolute","border-top":"0",width:"400px",overflow:"auto"},attr:{id:"ownerNameLookup_"+e,name:"ownerNameLookup","data-fieldName":e},child:[]};else if(e.indexOf("app_user")>-1){x={name:"div",css:{"z-index":"999","background-color":"#fff",border:"1px solid #d4d4d4",top:g.position().top+g.outerHeight()+10+"px","box-shadow":"0 7px 20px rgba(0,0,0,0.3)",position:"absolute","border-top":"0",width:"400px",overflow:"auto","border-bottom-left-radius":"4px","border-bottom-right-radius":"4px"},attr:{id:"ownerNameLookup_"+e,class:"userLookup",name:"ownerNameLookup","data-fieldName":+e},child:[]}}else if(T){var N=$("#"+e).offset();if(x={name:"div",css:{"z-index":"999","background-color":"#fff",border:"1px solid #d4d4d4",top:N.top+27+"px",left:N.left-10+"px","box-shadow":"0 7px 20px rgba(0,0,0,0.3)",position:"absolute","border-top":"0",width:"400px",overflow:"auto","border-bottom-left-radius":"4px","border-bottom-right-radius":"4px"},attr:{id:"ownerNameLookup_"+e,name:"ownerNameLookup","data-fieldName":e},child:[]},"workflow"==r||"approvalprocess"==r){var L=_.offset();x={name:"div",css:{"z-index":"999",display:"block !important","background-color":"#fff",border:"1px solid #d4d4d4",top:L.top+25+"px",left:L.left+"px","box-shadow":"0 7px 20px rgba(0,0,0,0.3)",position:"absolute","border-top":"0",width:"400px",overflow:"auto"},attr:{id:"ownerNameLookup_"+e,name:"ownerNameLookup","data-fieldName":e},child:[]}}}else x={name:"div",css:{"z-index":"999","background-color":"#fff",border:"1px solid #d4d4d4",top:w+"px","box-shadow":"0 7px 20px rgba(0,0,0,0.3)",position:"absolute","border-top":"0",width:"400px",overflow:"auto","border-bottom-left-radius":"4px","border-bottom-right-radius":"4px"},attr:{id:"ownerNameLookup_"+e,class:"userLookup",name:"ownerNameLookup","data-fieldName":e},child:[]};var D={name:"ul",attr:{id:"hostListCont_"+e,class:"cusDropDown p0 oA"},css:{border:0,"max-height":175,display:"block","margin-bottom":"15px"},child:[]},M={name:"span",attr:{id:"nomatch_"+c,class:"userLookUpNoMatchFound"},css:{display:"none",padding:"10px"},text:I18n.getMsg("crm.label.nomatchingusers")},R={name:"div",attr:{id:"allSelected_"+c},css:{display:"none",padding:"10px 0px 10px 10px"},text:I18n.getMsg("crm.search.users.selected.allusers")};if(221===S){E=252;var k={name:"li",attr:{class:"active-result",name:"single_select",id:e+"_NONE",userName:I18n.getMsg("None")+",None","data-id":""},css:{"vertical-align":"bottom","margin-top":"7px"},child:[]},A={name:"span",attr:{class:"pL10 dB mB1"},text:I18n.getMsg("None")},B={name:"div",child:[],attr:{class:"w320 dIB namEmiDiv"}};B.child.push(A),k.child.push(B),D.child.push(k)}if("yes"!=m){if(221===S)var F={name:"input",attr:{id:"hostSearch_"+e,type:"text","data-zcqa":"txt_SearchUser",class:"hostSearch  userSearchInp",style:"border:none !important;width:80% !important;margin:0px !important;",placeholder:I18n.getMsg("crm.lar.searchUser")}};else F={name:"input",attr:{id:"hostSearch_"+e,type:"text","data-zcqa":"txt_SearchUser",class:"hostSearch  userSearchInp",style:"border:none;width:80% !important;margin:0px !important",placeholder:I18n.getMsg("crm.lar.searchUser")}};var P=[{name:"keyup",args:[F],fn:function(t,a){Search.singleMacroSuggest(a,t,"hostListCont_"+e,"li","nomatch_"+e,void 0,void 0,void 0,void 0,"userName")}}];F.events=P;var U={name:"div",child:[F],attr:{class:"searchOwnerIcn",style:"border-bottom:1px solid var(--br_EDF0F4)"}};if(221===S)U={name:"div",attr:{class:"searchOwnerIcn pR",style:"border-bottom:1px solid var(--br_EDF0F4)"},child:[F,Q={name:"span",attr:{class:"dIB searchLookupIcon pA svgIcons"}}]};x.child.push(U)}else if(445==S){var V=$("#temp_"+e).find("ul").find("input");Search.assignEnter(V),Search.assignOn(V)}else if("yes"==C){P=[{name:"keyup",args:[F={name:"input",attr:{id:"hostSearch_"+e,type:"text","data-zcqa":"txt_SearchUser",class:"hostSearch h27 userSearchInp",style:"border:none;width:80% !important;margin:5px;",placeholder:I18n.getMsg("crm.lar.searchUser")}}],fn:function(t,a){Search.singleMacroSuggest(a,t,"hostListCont_"+e,"li","nomatch_"+e,void 0,void 0,void 0,void 0,"userName")}}];F.events=P;U={name:"div",child:[F],attr:{class:"searchOwnerIcn",style:"border-bottom:1px solid var(--br_EDF0F4)"}};x.child.push(U)}x.child.push(M),x.child.push(R),x.child.push(D);var H=renderingUtils.createHTML(x),z=$(H).find("ul"),Y=$("#multipleFieldsEditPop").is(":visible");if($("#hostSearch_"+c).data("yes"),thirdPartyUtils.bindPerfectScroll("#hostListCont_"+e),"yes"==f){if(document.body.appendChild(H),setTimeout((function(){var t=$("#ownerNameLookup_"+e);$("#lv_left_filter").height()+$L("#lv_filter_scroll").scrollTop()-t.position().top<t.height()&&$("#lv_filter_scroll").animate({scrollTop:$L("#lv_filter_scroll").scrollTop()+t.height()},"500")}),10),221===S){a=d.offset();(J=$("#ownerNameLookup_"+e)).css({top:"",bottom:""});var j=J.outerHeight(),q=d.closest(".popup-model-content");0==q.length&&(q=d.closest(".pp-content"));var W=_.offset().top+q.position().top,G=_.height();renderingUtils.windowHeight-_.position().top+q.position().top>j+20?J.css({top:W-G+"px",left:a.left+"px",bottom:"auto",display:"block","z-index":"252"}):J.css({top:"auto ",left:a.left+"px",bottom:renderingUtils.windowHeight+w-W+"px",display:"block","z-index":"252"}),q.addClass("oH")}if($(".mmCriteriaContainer").is(":visible")){a=d.offset();(J=$("#ownerNameLookup_"+e)).css({left:a.left+"px"})}}else 221===S&&$(H).addClass("userLookup"),T||8===S&&Y||445===S&&Y?$("body").prepend(H):(_.prepend(H),setTimeout((function(){var e=_.find(".userLookup");renderingUtils.windowHeight+$L(document).scrollTop()-e.offset().top<e.height()&&$("body, html").animate({scrollTop:$L(document).scrollTop()+e.height()},"500")}),10)),221!==S&&445!=S||setTimeout((function(){var t=$("#ownerNameLookup_"+e);t.css({top:"",bottom:""});var a=t.outerHeight();$("body")[0].scrollHeight-_.offset().top>a+80?(Y&&445===S&&(w=ProcessFlow.getOwnerLookupHeight(d).topOffset),t.css({top:w+"px",bottom:"auto"})):t.css({top:"auto ",bottom:w+"px"})}),10);221!==S&&445!=S||$("#ownerNameLookup_"+e).addClass("userLookup"),v&&null!=v&&$("#"+v).scroll((function(){$("[name='ownerNameLookup']").each((function(){var e=$(this).data("fieldname"),t=$("#"+e),a=t.offset();a.top+=t.innerHeight(),"lv_filter_scroll"==v&&$(this).css({top:a.top,"z-index":11})}))}));var J,X=$("#ownerNameLookup_"+e).find("li");for(len=X.length,l=0;l<len;l++){var Q;(Q=X.eq(l).children("span")).eq(1).css("margin-left",-Q.eq(0).width())}if(thirdPartyUtils.titleForEllipsis(".userEmailAddress"),thirdPartyUtils.titleForEllipsis(".userNameLookup"),Search.initialDataLoad(e,p,b,z,r,S,o,n,y),(J=$("#ownerNameLookup_"+e)).offset().top+J.height()>renderingUtils.windowHeight&&$("#lv_filter_scroll").animate({scrollTop:$L("#lv_filter_scroll").scrollTop()+J.height()},"500"),445==S)return H},Search.initialDataLoad=function(e,t,a,r,i,n,s,l,o){var c=null,d=$L("#multipleFieldsEditPop").is(":visible"),m=l;if(d){var p=$L("#"+e);m=p&&p.data("entitymodule")?p.data("entitymodule"):l,m=void 0!==p.data("entityid")?p&&p.data("entitymodule")?p.data("entitymodule"):l:ProcessFlow&&ProcessFlow.ExcecutionObjs?ProcessFlow.ExcecutionObjs.module:l}var h=moduleRecordMapping[m]&&"team_based"===moduleRecordMapping[m].access_type,u=e&&e.indexOf("app_user")>-1&&h||s||d&&h||o||"approvalprocess"===i&&h,f=!0===Crm.userDetails.permissions.Crm_Implied_List_Subordinate_Users,v=!1,g=$L("#"+e).data("criteria");if(InfoForPartialLoad){if(!u&&void 0===Search.InfoForDefaultDisplay||u&&void 0===Search.InfoForDefaultDisplayWithLiteUsers)return r.data("loading",!0),0==r.find(".loadingDiv").length&&r.append('<li class="loadingDiv aligncenter">Loading...</li>'),void loadDataForDisplayAndMentions(t,!1,a,!0,(function(){r.data("loading",!1),c=!Search.InfoForPartialLoad&&u?JSON.parse(InfoForDisplayWithLiteUsers):Search.InfoForPartialLoad?u?JSON.parse(Search.InfoForDefaultDisplayWithLiteUsers):JSON.parse(Search.InfoForDefaultDisplay):JSON.parse(InfoForDisplay),Search.searchElemAddinPopup(e,r,c,n),Search.partialLoadUserDropdown(e,0,1,u),Search.resloadDataForDisplayAndMentions(c,r,e,n,u,v)}),u,g);u?(c=JSON.parse(Search.InfoForDefaultDisplayWithLiteUsers),Search.resloadDataForDisplayAndMentions(c,r,e,n,u,v)):(c=JSON.parse(Search.InfoForDefaultDisplay),Search.resloadDataForDisplayAndMentions(c,r,e,n,u,v))}else f&&(["convert","itsfromwebform"].includes(i)||445===n||8===n&&(e.includes("Crm_Events_")||d))?void 0===Search.InfoForSubordinateListing?loadDataForDisplayAndMentions(!1,!0,!1,!1,(function(){Search.InfoForSubordinateListingHandle(c,r,e,n,u,v)}),u,!0,g):Search.InfoForSubordinateListingHandle(c,r,e,n,u,v):!u&&void 0===InfoForDisplay||u&&void 0===InfoForDisplayWithLiteUsers?loadDataForDisplayAndMentions(!1,!0,!1,!1,(function(){if($L("#multipleFieldsEditPop").is(":visible")&&moduleRecordMapping[m]&&"team_based"===moduleRecordMapping[m].access_type){var t=JSON.parse(InfoForDisplayWithLiteUsers),a=t.map((function(e){return e.id}));JSON.parse(InfoForDisplay).forEach((function(e){e.id&&a.indexOf(e.id)<0&&t.push(e)})),this.InfoForDisplayWithLiteUsers=JSON.stringify(t)}Search.InfoForDisplayHandle(InfoForDisplayWithLiteUsers,r,e,n,u,v)}),u,!1,g,l):Search.InfoForDisplayHandle(InfoForDisplayWithLiteUsers,r,e,n,u,v)},Search.InfoForSubordinateListingHandle=function(e,t,a,r,i,n){e=JSON.parse(Search.InfoForSubordinateListing),Search.resloadDataForDisplayAndMentions(e,t,a,r,i,true)},Search.InfoForDisplayHandle=function(e,t,a,r,i,n){var s=null;i?s=JSON.parse(e):("[]"===InfoForDisplay&&$("#ownerNameLookup_"+a).find(".userLookUpNoMatchFound").show(),s=JSON.parse(InfoForDisplay)),Search.resloadDataForDisplayAndMentions(s,t,a,r,i,n)},Search.resloadDataForDisplayAndMentions=function(e,t,a,r,i,n){e&&e.length>5&&Search.onScrollPartialLoad(t),Search.searchElemAddinPopup(a,t,e,r),t.data("loading",!1),Search.partialLoadUserDropdown(a,0,1,i,n)},Search.searchElemAddinPopup=function(e,t,a,r){var i=a.length;$("#ownerNameLookup_"+e);if(i>5){var n;Search.onScrollPartialLoad(t);var s=$("#"+e),l=$("#hostSearch_"+e);445==r?n=$(s.parent().find("ul").find("input")):l&&$("#hostSearch_"+e).length>0?n=l:s&&s.length>0&&(n=s),n.focus(),Search.InfoForPartialLoad&&Search.userAutoCompleteSearch(n,e)}},Search.onScrollPartialLoad=function(e){Search.InfoForPartialLoad&&e[0].addEventListener("scroll",$L.debounce((function(e){var t=$($(e.target).closest("div")),a=$L(t).find("ul"),r=t[0].id.replace("ownerNameLookup_",""),i=!0;r.startsWith("temp_searchuser")&&(i=!1);var n=$("#"+r).data("changeowner"),s=a.data("searchKey");if(!(s&&s.length>0)&&a.scrollTop()+a.height()>=.75*a[0].scrollHeight){var l=Search.getStartRange(a,1);if(a.data("loading",!0),0==a.find(".loadingDiv").length&&l<2e3&&-1!=l&&a.append('<li class="loadingDiv aligncenter">Loading...</li>'),-1==l)return!1;a.data("startRange",l),"end"!=a.data("scrollRange")&&(s&&""!=s||(a.data("scrollOrder",1),loadUserDataForPartialLoad((function(e){a.data("loading",!1),a.data("InfoForPartialDisplay",e),Search.partialLoadUserDropdown(r,l,1,n)}),void 0,!0,l,s,i)))}}),300))},Search.showCreatedUserPopup=function(e,t,a){e.substr(e.indexOf("_")+1,e.length);var r=$("#multipleFieldsEditPop").is(":visible"),i=$("#ownerNameLookup_"+e);0===$(`#hostListCont_${e}`).children().length&&i.find(".userLookUpNoMatchFound").show(),i.attr("data-fieldName",e);var n=$L("#hostListCont_"+e),s=$("#hostSrchBox"),l=$("#ownerNameLookup_"+e);s&&(n.find("li").each((function(){$(this).show()})),s.val(""));var o=l.find("li"),c=null;len=o.length;var d=$("#"+e).parent().innerHeight();if(i.css({top:"",bottom:""}),$("body")[0].scrollHeight-$("#"+e).parent().offset().top>i.outerHeight()+80){if(r){var m="#"+e,p=ProcessFlow.getOwnerLookupHeight($(m));d=p.topOffset,c=p.leftOffset}i.css({top:d+"px",left:c+"px",bottom:"auto",display:"block"})}else i.css({top:"auto ",bottom:d+"px"});if(renderingUtils.windowHeight+$L(document).scrollTop()-i.offset().top<i.height()&&$("body, html").animate({scrollTop:$L(document).scrollTop()+i.height()},"500"),i.css("display","block"),a){n.scrollTo(0,0);for(var h=0;h<len;h++){var u=o.eq(h).children("span");u.eq(1).css("margin-left",-u.eq(0).width())}if("yes"!=t&&0!=l.find("ul").find("li.result-selected").length){var f=l.find("ul").find("li.result-selected");n.scrollTo($(f))}renderingUtils.stopEvent(window.event)}},Search.userAutoCompleteSearch=function(e,t){var a=$(e);a.attr("onkeydown","").unbind("keydown"),a.attr("onkeypress","").unbind("keypress"),a[0].onkeydown=function(a){if(8!=a.keyCode)return Search.searchOnKeyDown(a.target,a,t),!0;var r=e.val();if(r.length>0){var i=$("#ownerNameLookup_"+t),n=$(i.find("ul"));r.length<=2?(n.data("searchKey",""),n.data("startRange",0),Search.removeLiElems(t,r,0),Search.partialLoadUserDropdown(t,0,1)):(n.data("searchKey",r),n.data("startRange",0),r=r.substring(0,r.length-1),Search.removeLiElems(t,r,0),0==n.find(".loadingDiv").length&&n.append('<li class="loadingDiv aligncenter">Loading...</li>'),clearTimeout(Search.timeout),Search.timeout=setTimeout((function(){Search.getUserSearchValueFromLucene(r,1,t,(function(e){var a=$("#ownerNameLookup_"+t);a&&0!=a.length||(a=$("#ownerNameLookup_temp_"+t)),a.find(".loadingDiv").remove();var i=$(a.find("ul"));i.data("loading",!1),i.data("searchKey",r),i.data("startRange",0),Search.createUserLiElements(t,e,i,0)}))}),1e3))}Search.searchOnKeyDown(a.target,a,t)},a[0].onkeypress=function(t){var a=$($(t.target).closest("div"))[0].id;""===a&&(a=$($(t.target))[0].id.replace("hostSearch_","")),a.indexOf("temp_")>-1&&(a=a.replace("temp_",""));var r=String.fromCharCode(t.which),i=e.val()+r,n=$("#ownerNameLookup_"+a);n&&0!=n.length||(a="temp_"+a,n=$("#ownerNameLookup_"+a));var s=$(n.find("ul"));s.data("loading",!0),Search.removeLiElems(a,i,0),0==s.find(".loadingDiv").length&&s.append('<li class="loadingDiv aligncenter">Loading...</li>'),clearTimeout(Search.timeout),Search.timeout=setTimeout((function(){Search.getUserSearchValueFromLucene(i,1,a,(function(e){var t=$("#ownerNameLookup_"+a);t&&0!=t.length||(t=$("#ownerNameLookup_temp_"+a)),t.find(".loadingDiv").remove();var r=$(t.find("ul"));r.data("loading",!1),r.data("searchKey",i),r.data("startRange",0),Search.createUserLiElements(a,e,r,0)}))}),1e3)}},Search.getUserSearchValueFromLucene=function(e,t,a,r){var i=!0,n=$("#"+a).data("actiontype");(a.startsWith("temp_searchuser")||"massTransferFrom"===n)&&(i=!1);var s={searchmodule:"Users",fldValue:e,isAutoComplete:!0,offset:t,activeUsersOnly:i};(s[csrfParamName]=csrfToken,e.length<2)||(new crmRequestPool).initiate({action:Crm.getCrmBasePath()+"/Search.do?",data:s,type:"POST",success:function(e){var t=e.Value;r&&r(t)},error:function(){loadimg.removeClass("vVIm")}})},Search.partialLoadUserDropdown=function(e,t,a,r,i){$("#"+e).data("withmultipleoptions");e.indexOf("MXNDUMMYCOLUMN");var n=$("#ownerNameLookup_"+e);if(n.find(".loadingDiv").remove(),0===n.length)Search.createShowLookup(e);else{var s=n.find("ul"),l=s.data("searchKey"),o=null;if(!0===i)o=JSON.parse(Search.InfoForSubordinateListing);else if(!r||l&&""!==l||0!==t||Search.InfoForPartialLoad)if(l&&""!==l||0!==t||Search.InfoForPartialLoad)if(!r||l&&""!==l||0!==t)if(l&&""!==l||0!==t){var c=s.data("InfoForPartialDisplay");if(!c)return!0;o=JSON.parse(c)}else o=JSON.parse(Search.InfoForDefaultDisplay);else o=JSON.parse(Search.InfoForDefaultDisplayWithLiteUsers);else o=JSON.parse(InfoForDisplay);else o=JSON.parse(InfoForDisplayWithLiteUsers);var d=(o=o.filter((function(e){return"user"==e.type}))).filter((function(e){return"ACTIVE"==e.userType})),m=o.filter((function(e){return"DISABLED"==e.userType})),p=o.filter((function(e){return"DELETED"==e.userType})),h=o.filter((function(e){return"CURRENTUSER"==e.userType}));(o=t>0?d.concat(m).concat(p):h.concat(d).concat(m).concat(p)).length>0?Search.createUserLiElements(e,o,s,t):1==a&&s.data("scrollRange","end")}},Search.getStartRange=function(e,t){var a=e.find("li[data-limitcheck]");if(1==t){var r=a.length-1;(i=$(a[r]).attr("data-limitcheck"))||(i=0),i=parseInt(i),i+=crmConstants.userPartialLoadCount,(e.data("startRange")>=i||e.data("loading")||i>2e3)&&(i=-1)}else if(2==t){var i;(i=$(a[0]).attr("data-limitcheck"))||(i=0),i=parseInt(i),i-=crmConstants.userPartialLoadCount}return i},Search.createUserLiElements=function(e,t,a,r,i){var n=e,s=null,l=[],o=!1,c=!0,d=$("#"+e),m=d.data("withemail"),p=d.data("deactivatedusers"),h=d.data("confirmeduseronly"),u=d.data("withmultipleoptions");null!=(i=$(d).data("actiontype"))&&("mass_transfer"!=i&&"mass_delete"!=i&&"mass_update"!=i&&"mass_convert"!=i&&"mass_email"!=i||(c=!1));var f=$("#ownerNameLookup_"+e);f&&0!=f.length&&f.find(".userLookUpNoMatchFound").hide();var v=d.data("uitype"),g=d.data("changeowner"),S=null;if(n.indexOf("MXNDUMMYCOLUMN")>-1){u="yes",m="yes",v=445,S="";var C=$("#temp_"+e)[0].querySelectorAll("[id*='sel_']"),y=C.length;for(let e=0;e<y;e++)S=""===S?C[e].dataset.id:C[e].dataset.id+","+S;S=S?S.split("-")[0]:""}var I=Crm.userDetails.NAME_FORMAT;e.startsWith("temp_searchuser")&&(o=!0),s=I.indexOf("First")<I.indexOf("Last")?"first":"last";var T=0,b=0,x=0,w=0,_=[],E=a.data("searchKey"),O=a.data("scrollOrder"),N=d.data("userViewPermCheck"),L=d.data("moduleName"),D=$("#recordViewPerm").val(),M=[],R="";Search.InfoForPartialLoad?Search.removeLiElems(n,E,r,O):(M=""!=D&&null!=D?JSON.parse(D):"",R=d.data("ownerid"));var k=$(a);if((o||c)&&"yes"==p){var A=I18n.getMsg("DeactiveUsers"),B=I18n.getMsg("ActiveUsers"),F=I18n.getMsg("crm.label.deleted.users");if(!k.find("#ACTIVE")||0==k.find("#ACTIVE").length){var P={name:"span",text:B,attr:{class:"cbTitle dB pT5 pB5 ",name:"ownerType",id:"ACTIVE"}};a.append(renderingUtils.createHTML(P))}if(!k.find("#DISABLED")||0==k.find("#DISABLED").length){var U={name:"span",text:A,attr:{class:"cbTitle dB pT5 pB5 ",name:"ownerType",id:"DISABLED"}};a.append(renderingUtils.createHTML(U))}if(!k.find("#DELETED")||0==k.find("#DELETED").length){var V={name:"span",text:F,attr:{class:"cbTitle dB pT5 pB5 ",name:"ownerType",id:"DELETED"}};a.append(renderingUtils.createHTML(V))}}var H=!0,z=0,Y=0,j=0;if(t)for(var q=t.length,W=($("#leadid").val(),0);W<q;W++){var G={},J=t[W].id,X=t[W].profileId;if(z=0,Y=0,j=0,Search.InfoForPartialLoad||!N||"true"!=N||!(""!=R&&R==J||"convert"!=i&&"massconvert"!=i&&null!=M[L]&&!M[L].contains(X)||("convert"==i||"massconvert"==i)&&(null!=M.Contacts&&!M.Contacts.contains(X)||null!=M.Accounts&&!M.Accounts.contains(X)))){var Q=t[W].userType;if("first"==s)var Z=(0==t[W].firstName.length?"":t[W].firstName+" ")+t[W].lastName;else Z=(0==t[W].lastName.length?"":t[W].lastName+" ")+t[W].firstName;if(G.USERID=t[W].id,G.label=Z,_.push(G),("yes"==p||"DISABLED"!=Q&&"DELETED"!=Q)&&("CURRENTUSER"!=Q||0!=o&&0!=c)&&("null"!=t[W].zuid&&""!=t[W].zuid||(l.push(t[W].id),"yes"!=h))){if("ACTIVE"==Q&&"yes"==p&&(T=1,z=1),"DISABLED"==Q&&"yes"==p&&(b=1,Y=1),"DELETED"==Q&&(x=1,j=1),"yes"==u){w+=1;var K=null;K=445===v&&S.indexOf(J)>-1?{name:"li",attr:{class:"result-selected-no-display",name:"multi_select",id:e+"_"+t[W].id,userName:Z+","+t[W].email,"data-id":t[W].id},css:{"margin-top":"10px"},child:[]}:{name:"li",attr:{class:"active-result",name:"multi_select",id:e+"_"+t[W].id,userName:Z+","+t[W].email,"data-id":t[W].id},css:{"margin-top":"10px"},child:[]}}else{w+=1;K={name:"li",attr:{class:"active-result ownerLookupLi",name:"single_select",id:e+"_"+t[W].id,userName:Z+","+t[W].email,"data-id":t[W].id,"data-profileid":t[W].profileId},css:{"vertical-align":"bottom","margin-top":"10px","padding-top":"5px"},child:[]}}var ee={name:"span",attr:{class:"pL10 mL0  userNameLookup ellipsistext w100_per"},text:Z,css:{"vertical-align":"top"}},te={name:"input",attr:{id:t[W].id+"_chkbx",class:"rbRealHtml hide","data-zcqa":Z+"_chkbx",name:"radiobtn",type:"radio"}},ae={name:"span",attr:{class:"rbHtml dIB pR mT10 mR7 vaT"},child:[]},re={name:"img",attr:{src:t[W].avatar,class:"socialimg"}},ie={name:"span",text:t[W].email,attr:{class:"crmLabelColor dB pL10 userEmailAddress ellipsistext w100_per"},css:{"max-width":"300px"}};if(221===v)var ne={name:"div",child:[],attr:{class:"w320 dIB namEmiDiv"}};else ne={name:"div",child:[],attr:{class:"w300 dIB namEmiDiv vaT"}};if(ne.child.push(ee),g&&(K.child.push(te),K.child.push(ae),ae.child.push({name:"span",attr:{class:"rbTickHtml pA"},child:[]})),"yes"==m&&ne.child.push(ie),"addUserInLAR"==e){var se={name:"img",attr:{src:t[W].avatar,class:"socialimg fL mR5"}};K.child.push({name:"span",child:[se],attr:{style:"word-wrap:break-work; white-space:normal;"}}),K.child.push({name:"span",text:Z})}else K.child.push(re),K.child.push(ne);"addUserInLAR"==e&&(K.css={},K.attr={class:"listUsers1 w100_per",uid:t[W].id,uname:Z},K.child.push({name:"br"}),K.child.push({name:"span",child:[],attr:{class:"crmLabelColor"},text:t[W].email}));var le=renderingUtils.createHTML(K),oe=$(le);r||(r=0),Search.InfoForPartialLoad&&H&&(oe.attr("data-limitcheck",r),H=!1),(o||c)&&"yes"==p?z?a.find("#DISABLED").before(le):Y?a.find("#DELETED").before(le):j?a.append(le):a.prepend(le):a.append(le)}}}if((o||c)&&"yes"==p&&(T||a.find("#ACTIVE").remove(),b||a.find("#DISABLED").remove(),x||a.find("#DELETED").remove()),g){var ce=$("#"+e).data("unconfirmeduserslist");null!=ce?ce.concat(l):ce=l,Search.selectOwner(n,i),changeOwner.unconfirmedUsersList=ce,$("#unconfirmedUsersList").val(ce),$("#"+e).data("unconfirmeduserslist",ce)}else Search.assignClick(n,""),Search.setOwnerNameValues(n,u);return"searchUserInLAR"!=n&&"addUserInLAR"!=n||Search.userEventLAR(),w},Search.removeLiElems=function(e,t,a,r){var i=$("#ownerNameLookup_"+e).find("ul");t&&0==a&&i.empty()},Search.showChangeOwnerPopUp=function(e,t,a,r,i,n,s,l,o,c){var d="",m=!1,p="",h=networkUtils.returnDependencyFiles(["zohocrm_changeOwner.js"],ResourceConstants.CRM);if(Lyte.injectResources(h),"entityview"==e||"listview"==e||"detailview"==e)switch(m=!0,n=5,e){case"detailview":d=$("#Crm_"+r+"_SMOWNERID").data("id");break;case"entityview":d="crm.tab.module.entity.canvas"===Lyte.Router.getRouteInstance().transition.info.route?store.peekRecord(moduleRecordMapping[r].id,a).Owner.id:$("#value_SMOWNERID #ownerName_id").data("params").userId}""==r&&"macro"==e&&(r=$("#module").val());var u,f=Crm.getCrmBasePath()+"/Search.do?source="+encodeURIComponent(e)+"&searchmodule="+encodeURIComponent(t)+"&mainModule="+encodeURIComponent(r)+"&featureId="+encodeURIComponent(n);if((u="workflowconvert"===e?$("#changeOwnerLink").data("isownerdealfol"):$("#assignedto").data("isownerdealfol"))&&(f+="&isOwnerDealFol="+encodeURIComponent(u)),m)"detailview"==e||null!=i&&"null"!=i||(i=$("#cvid").val()),"listview"==e?(p={idList:getIdsAndNames().idList},f+="&cvid="+encodeURIComponent(i)):("entityview"==e&&null!=i&&(f+="&cvid="+encodeURIComponent(i)),f+="&seId="+a+"&ownerId="+encodeURIComponent(d));else if("macro"==e){var v=$(s).parent().attr("data-zcqa");v=v.replace("Macro_FieldValue_Users_",""),f+="&macroIndex="+encodeURIComponent(v);$("[data-zcqa="+("macro_ownerName_"+v)+"]").text();l="",o=$("[data-zcqa="+("macro_relatedRec_"+v)+"]").val(),c=$("[data-zcqa="+("macro_notifyOwner_"+v)+"]").val();var g=$("[data-zcqa="+("macro_applyRestriction_"+v)+"]").val();""===g||"true"!==g&&"false"!==g||(f+="&applyRestriction="+g)}else if("caseOwner"==e)""!=$("#ownerName").val()&&(o=$("#cases_relatedRecords").val(),l=!0);else if("blueprint"===e)""!=$("#fieldValue1").val()&&(o=$("#relatedRecords").val(),l=!0,c=$("#notify").val(),f+="&applyRestriction="+$("#isAssignmentRestricted").val());else if("workflowconvert"==e){var S=$("#convertownerId").val();if(Crm.userDetails.isNewConvertUIEnabled){var C=$L("crm-convert-action").e[0],y=C.getData("ownerId");""!==y&&(l=!0,o=C.component.relatedRecords,f+="&ownerId="+encodeURIComponent(y))}else S&&""!==S&&(o=$("#relatedRecords").val(),l=!0,f+="&ownerId="+encodeURIComponent(S))}else if("massconvert"==e){if((T=$L("crm-mass-convert")).length>0)(b=T[0].component.data).salesmanid&&(o=b.relatedRecords,c=!1,l=!0)}else if("massTransferTo"==e||"massTransferFrom"==e||"convert"==e||"dealconvert"==e){if("massTransferTo"==e){var I=$("#fromUserId");if(""==I.val())return renderingUtils.showCustomAlert(I18n.getMsg("crm.mass.action.choose.from")),!1;d=I.val()}else if("convert"==e){var T,b;if((T=$L("crm-convert-lead")).length>0)""!==(b=T[0].component.data).SalesManId&&(o=b.relatedRecords,c=!1,l=!0),d=b.LeadOwnerId,f+="&seId="+(a=b.Leads.id)}f+="&ownerId="+encodeURIComponent(d)}null!=l&&""!=l&&(f+="&isEditAction="+l+"&relatedRecords="+(o="null"==o?null:o)+"&notify="+c),$("#convertOwner").data("isownerdealfol")&&"massconvert"===e&&(f+="&isFolUser="+!0),""===p?p=csrfParamName+"="+encodeURIComponent(csrfToken):p+="&"+csrfParamName+"="+encodeURIComponent(csrfToken);var x=$("#topBandPopup");x.empty(),(new crmRequestPool).initiate({action:f,type:"POST",data:p,success:function(e){x.html(e),$("#changeOwnerForm").off("click.availableRecords"),$("#changeOwnerForm").on("click.availableRecords",(function(){$("#changeOwnerPopup .boxStyleInput").removeClass("focusEleField"),$(".filterDropdownElement").hide()}));var t="#freezeBackGround";showAnimatePopup("topBandPopup"),$(t).css("z-index","30"),($("#eventCreatePopup").is(":Visible")||$("#createEditCallDiv").is(":Visible"))&&$(t).css("z-index","32"),thirdPartyUtils.bindSelect2($(".newSelect").find("select")),"Events"===$("#module").val()&&$("#provNotAuthorisedAlert").remove(),setTimeout((function(){$L("#changeOwnerForm").trapFocus(),$("#changeOwnerForm").find(".labelValCreate").trigger("click")}),300)}},p)},Search.showLookup=function(e,t,a,r,i){if(e.indexOf("SMOWNERID")>0&&"edit"===window[t].currentStatus){var n=window[t].entityId;Search.showChangeOwnerPopUp("detailview","ownername",n,t,"",5)}else{var s=!0;if(null!=t&&e.indexOf("SMOWNERID")>0&&(s=Crm.userDetails.permissions["Crm_Implied_Change_Owner_"+t],"processflow"===a&&(s=!0)),s){var o=$("#"+e);$("#nomatch_"+e).hide(),$("div[name='ownerNameLookup']:visible").length&&$("div[name='ownerNameLookup']:visible").hide(),crmui.hideTooltip(),$("#"+e).find();var c=Search.findTheTarget(e),d="ownerNameLookup_"+e,m=e.substring(e.lastIndexOf("r")+1),p=e,h=$("#usercondition"+m).val();if(-1==p.indexOf("app_user")&&h&&(-1!=h.indexOf("Current User")||-1!=h.indexOf("${CURRENTUSER}")))return void $("#"+d).hide();if($("#hostSearch_"+e).val(""),"massTransferFrom"!=a||InfoForPartialLoad?isDeletedUserDetailsAvail&&(InfoForDisplay=void 0,loadDataForDisplayAndMentions(!1,!0),isDeletedUserDetailsAvail=!1):(InfoForDisplay=void 0,loadDataForDisplayAndMentions(!0,!0),isDeletedUserDetailsAvail=!0),$("#"+e).hasClass("focusCss")&&$("#"+e).removeClass("focusCss"),-1==p.indexOf("app_user")&&("Current User"===h||"${CURRENTUSER}"===h))return;var u=$("#socAddToCrmPop");if(o.data("isfieldoflookup")&&"Blueprint"===o.data("actionfol")||u.is(":visible")){var f=$L("crm-detailview-canvas")[0],v=f?f.component.getData().layoutId:returnJson&&returnJson.layout_jsonarrayObj?returnJson.layout_jsonarrayObj.sysLayoutId:"null";Search.folUserDropdown("true",o.data("colname"),o.data("fieldid"),t,v)}else(!o.data("isfieldoflookup")&&"Blueprint"===o.data("actionfol")||u.is(":visible"))&&Search.folUserRefValues.length>0&&(Search.folUserRefValues=[]);Search.hideSpan(p);var g=$("#"+p),S=g.data("withmultipleoptions"),C=g.data("exception"),y=g.data("setdefaultwidth"),I=g.data("colname"),T=g.data("uitype"),b=g.data("bodyappend"),x=g.data("changeowner"),w=g.parent();if(C)$("#"+C).val();if(""!=$("#"+e).find("ul").find("input").val()&&"yes"==S)return;(N=g.offset()).top;N.top+=g.innerHeight();var _=$(window).width();if(N.left+400>_&&(N.left-=200),$('input[id^="hostSearch_temp_searchuser"]').removeAttr("onclick"),1==y)var E="auto";else if("yes"==S)E=g.width();else E=g.width()+20;var O=$("#ownerNameLookup_"+p);if("yes"==g.data("confirmeduseronly")||x){let e=O.remove();O===e&&(O=[])}if("workflow"!==a&&"approvalprocess"!==a||(void 0!==InfoForOrgDisplay&&moduleRecordMapping[t]&&"org_based"===moduleRecordMapping[t].access_type&&(InfoForDisplay=InfoForOrgDisplay),(void 0===InfoForOrgDisplay||moduleRecordMapping[t]&&"team_based"===moduleRecordMapping[t].access_type)&&(O=[],InfoForDisplay=void 0)),$("#multipleFieldsEditPop").length>0&&($("#ownerNameLookup_"+p).remove(),$("#"+e).parents("#multipleFieldsEditPop").length>0&&1==$("#eventCreatePopup").is(":visible"))){var N,L=$("#eventCreatePopup").find("#"+e);(N=L.offset()).top;N.top+=L.innerHeight();_=$(window).width();N.left+400>_&&(N.left-=200);E=$("#eventCreatePopup").find("#"+e).width()+20}var D=$("#previousSelectedValue"+m).val();if(D=D&&(D.indexOf("SMCREATORID")>-1||D.indexOf("MODIFIEDBY")>-1),Search.InfoForPartialLoad)Search.createShowLookup(p,E,N,a,i,t,void 0,D);else if(0===O.length||D)Search.createShowLookup(p,E,N,a,i,t,void 0,D);else{O.attr("data-fieldName",p);var M=O.outerWidth(),R=O.outerHeight(),k=renderingUtils.windowWidth;$("#hostSrchBox")&&$("#hostSrchBox").val("");var A,B=O.find("li");len=B.length;var F=g.innerHeight();-1!=p.indexOf("Crm_Events_SMOWNERID")?(F=w.innerHeight(),A=-70,N.top-=0):null!=I&&221!=T?-1!=I.indexOf("SMOWNERID")&&(F=w.innerHeight()):221===T&&(F=w.innerHeight(),A=0,N.top-=0);var P=31;if(!Crm.isHeadless&&crmNTC.isSignalDetailViewVisible()&&(P=33),"mmOwnerField"==e.split("_")[0]&&(P=1001),"yes"==b)if(P=252,221===T){O.css({top:"",bottom:""});R=O.outerHeight();var U=g.closest(".popup-model-content");0==U.length&&(U=g.closest(".pp-content"));var V=w.offset().top+U.position().top,H=w.height();renderingUtils.windowHeight-w.position().top+U.position().top>R+20?O.css({top:V-H+"px",left:N.left+"px",bottom:"",display:"block","z-index":P}):O.css({top:"",left:N.left+"px",bottom:renderingUtils.windowHeight+F-V+"px",display:"block","z-index":P}),U.addClass("oH")}else if(M+N.left>k)O.css({top:N.top+2+"px",left:N.left-45+"px",bottom:"",display:"block","z-index":P});else{O.css({top:N.top+2+"px",left:N.left+"px",bottom:"",display:"block","z-index":P});var z=O.offset().top+O.height();renderingUtils.windowHeight<z&&$("#lv_filter_scroll").animate({scrollTop:$L("#lv_filter_scroll").scrollTop()+O.height()},"500")}else if(x){var Y=g.offset();if(O.css({"z-index":"999","background-color":"#fff",border:"1px solid #d4d4d4",top:Y.top+27+"px",left:Y.left-10+"px","box-shadow":"0 4px 16px rgba(0,0,0,0.3)",position:"absolute","border-top":"0",width:"400px",overflow:"auto"}),"workflow"==a||"approvalprocess"==a)if("workflow"==a){var j=$("#fieldValuetd1").offset();O.css({"z-index":"999",display:"block !important","background-color":"#fff",border:"1px solid #d4d4d4",top:j.top+25+"px",left:j.left+"px","box-shadow":"0 4px 16px rgba(0,0,0,0.3)",position:"absolute","border-top":"0",width:"400px",overflow:"auto"})}else{j=w.offset();O.css({"z-index":"999","background-color":"#fff",border:"1px solid #d4d4d4",top:j.top+25+"px",left:j.left+"px","box-shadow":"0 4px 16px rgba(0,0,0,0.3)",position:"absolute","border-top":"0",width:"400px",overflow:"auto"})}}else if(221===T){j=w.offset(),R=O.outerHeight();if(O.css({top:"",bottom:""}),$("body")[0].scrollHeight-j.top>R+80)O.css({top:F+"px",left:A+"px",bottom:"",display:"block"}),(z=renderingUtils.windowHeight+$L(document).scrollTop()-O.offset().top)<O.height()&&$("body, html").animate({scrollTop:$L(document).scrollTop()+O.height()},"500");else O.css({top:"",bottom:F+"px",display:"block"})}else{var q=$("#"+e).position().top+$("#"+e).outerHeight()+10,W=$("#"+e).position().left;O.css({top:q,left:W,width:"auto","z-index":"102"}),(z=renderingUtils.windowHeight+$L(document).scrollTop()-O.offset().top)<O.height()&&$("body, html").animate({scrollTop:$L(document).scrollTop()+O.height()},"500")}for(O.css("display","block"),x?Search.selectOwner(e,a):Search.setOwnerNameValues(e,S),$L("#hostListCont_"+p).scrollTo(0,0),l=0;l<len;l++){var G=B.eq(l).children("span");G.eq(1).css("margin-left",-G.eq(0).width())}if("yes"!=S&&0!=$("#ownerNameLookup_"+e).find("ul").find("li.result-selected").length){var J=$("#ownerNameLookup_"+e).find("ul").find("li.result-selected");$L("#hostListCont_"+p).scrollTo($(J))}renderingUtils.stopEvent(window.event)}if($("#ownerNameLookup_"+e).closest("#critEditorDIV").length&&Search.setHeightOwnerLookupScoring($("#ownerNameLookup_"+e)),x){var X=$("#"+e+"_"+c);X.hasClass("result-selected")&&(X.removeClass("result-selected"),X.find("input").prop("checked","checked"))}0===$(".lead-score-popup").length&&renderingUtils.scrollPrevent(O),$("input#hostSearch_"+e).attr("onclick","sE(event)"),$("input#hostSearch_"+e).focus(),$("#assignUser").addClass("focusFieldNewUpdate")}}},Search.singleMacroSuggest=function(e,t,a,r,i,n,s,l,o,c){var d=$("#"+a).parent().data("fieldname"),m=$("#ownerNameLookup_"+d).find("ul").find("li").length,p=(getElemById(s),e.value.trim().toLowerCase()),h=getElemById(i),u=getElemById(a).getElementsByTagName(r);currSechExtMatCnt=0,noMatchElem=0;for(var f=0;f<u.length;f++){var v=u[f];if(void 0===c||null!=v.getAttribute(c)){var g=void 0!==c&&null!=v.getAttribute(c)?v.getAttribute(c).toLowerCase():v.innerHTML.toLowerCase();""==p||-1!=g.indexOf(p)?($(v).addClass("active-result"),$(v).show()):($(v).removeClass("active-result"),$(v).hide(),noMatchElem++)}}h&&m==noMatchElem&&""!=p?h.style.display="":h.style.display="none"},Search.ownerNameLookupSearch=function(e,t,a,r,i,n){if(InfoForPartialLoad)return!1;var s=e.toLowerCase(),l=getElemById(i);l||(i=i.replace("_temp",""),a=a.replace("_temp",""),l=getElemById(i));var o=$("#"+a).parent().data("fieldname"),c=$("#ownerNameLookup_"+o).find("ul").find("li.active-result").length,d=($(t).parent().parent().attr("id"),getElemById(a).getElementsByTagName(r));currSechExtMatCnt=0;for(var m=0,p=0,h=0;h<d.length;h++){var u=d[h];if(void 0===n||null!=u.getAttribute(n)){var f=void 0!==n&&null!=u.getAttribute(n)?u.getAttribute(n).toLowerCase():u.innerHTML.toLowerCase();if(""==s||-1!=f.indexOf(s)){if($(u).hasClass("active-result")||$(u).hasClass("result-selected-no-display")||$(u).hasClass("ownerException")||($(u).addClass("active-result"),p++),null!=u.getAttribute("event_row_idx")){var v=u.getAttribute("event_row_idx"),g=parseInt(v)-Events.totalUsersCount;$("tr[event_row_idx='"+g+"']").next().css("display","")}l&&(l.style.display="none"),f.trim()===s&&currSechExtMatCnt++}else if($(u).hasClass("active-result")&&(m++,$(u).removeClass("active-result"),u.style.display="none"),null!=u.getAttribute("event_row_idx")){v=u.getAttribute("event_row_idx"),g=parseInt(v)-Events.totalUsersCount;$("tr[event_row_idx='"+g+"']").next().css("display","none")}}}l&&"none"==$("#allSelected_"+o).css("display")&&c==m&&""!=s&&!p?l.style.display="":l.style.display="none",Search.hideSpan(o)},Search.searchOnKeyDown=function(e,t,a){var r,i=$(e).attr("id");if(i){var n=$("#"+i).parent().parent();r=$(n).attr("id")}else r=a;r=r.replace("ownerNameLookup_","");var s=$("#ownerNameLookup_"+r);if(0==s.length&&$("#"+r).trigger("click"),8==t.keyCode){if(value=$(e).val(),length=value.length,lastChar=value.substring(length-1,length),""==lastChar&&$(e).prev()){var o=$(e).prev("li").attr("id");if(o){var c=document.getElementById(o).childNodes;o=o.substr(4),Search.removeSingleUser(t,c,o,r,"","")}}}else if(40==t.keyCode){if("none"==$("#ownerNameLookup_"+r).css("display")){$("#ownerNameLookup_"+r).css("display","");var d=s.find("li");for(len=d.length,l=0;l<len;l++){var m=d.eq(l).children("span");m.eq(1).css("margin-left",-m.eq(0).width())}}if($("#ownerNameLookup_"+r).find("ul").find("li").hasClass("highlighted")){var p=$("#ownerNameLookup_"+r).find("ul").find("li.highlighted");if($(p).nextAll(".active-result"))var h=$(p).nextAll(".active-result")[0];if(h){$("#ownerNameLookup_"+r).find("ul li").removeClass("highlighted");$(h).addClass("highlighted");var u=s.find("ul").find("li.active-result"),f=s.offset().top+190;(g=$(h).offset().top)>f&&$L("#hostListCont_"+r).scrollTo($(h))}else s.show()}else{u=s.find("ul").find("li.active-result"),$(u[0]).addClass("highlighted");$L("#hostListCont_"+r).scrollTo(0,0)}}else if(38==t.keyCode)if($("#ownerNameLookup_"+r).find("ul").find("li").hasClass("highlighted")){p=$("#ownerNameLookup_"+r).find("ul").find("li.highlighted");if($(p).removeClass("highlighted"),$(p).prevAll(".active-result"))var v=$(p).prevAll(".active-result")[0];if(v){$(v).addClass("highlighted"),u=s.find("ul").find("li.active-result"),f=s.offset().top;var g=$(v).offset().top;v=$(v).prevAll("li"),g<f&&v.length>1&&(v.length>=3?(v=$(v)[2],$L("#hostListCont_"+r).scrollTo($(v))):v.length>=1&&(v=$(v)[0],$L("#hostListCont_"+r).scrollTo($(v)))),v.length<=1&&$L("#hostListCont_"+r).scrollTo(0,0)}else s.hide(),$(e).removeAttr("onclick")}else s.hide(),$(e).removeAttr("onclick");else"none"==$("#ownerNameLookup_"+r).css("display")&&$("#ownerNameLookup_"+r).css("display","");$("#ownerNameLookup_"+r).closest("#critEditorDIV").length&&Search.setHeightOwnerLookupScoring($("#ownerNameLookup_"+r)),renderingUtils.stopEvent(t)},Search.hideSpan=function(e){for(var t=$("#ownerNameLookup_"+e).find("ul").children("span"),a=t.length,r=0;r<a;r++)if("ACTIVE"!==t[r].id&&"DISABLED"!==t[r].id&&"DELETED"!==t[r].id){var i=1;if(r)$(t).eq(1).nextAll("li.active-result").length&&(i=0);else $(t).eq(1).prevAll("li.active-result").length&&(i=0);i&&t.eq(r).is("span")?t.eq(r).css("display","none"):t.eq(r).css("display","")}},Search.formUserConditionValues=function(e,t,a,r){var i=I18n.getMsg("current.logged.in.user"),n=$("#temp_searchuser"+t).find("li");if("${CURRENTUSER}"!=r){var s;s="${CURRENTUSER}"==(r=r.split(","))[0]?i:n.filter("#sel_temp_searchuser"+t+"_"+r[0]).text();for(var l=1;l<r.length;l++)"${CURRENTUSER}"==r[l]?s+=","+i:s+=","+n.filter("#sel_temp_searchuser"+t+"_"+r[l]).text()}else s=i;e[a]=s},Search.findTheTarget=function(e){return $("#"+e).prevAll("input").length>0?$("#"+e).prevAll("input:eq(0)").val():$("#"+e).data("id")&&$("#"+e).data("id").length>0?$("#"+e).data("id"):$("#"+e).data("selectedid")&&$("#"+e).data("selectedid").length>0?$("#"+e).data("selectedid"):null},Search.updateJson=function(e,t){var a;if(void 0!==InfoForDisplay&&(a=JSON.parse(InfoForDisplay)),null!=a)for(var r=a.length,i=0;i<r;i++)if(a[i].id==e){a[i].userType=t;break}if(void 0!==InfoForDisplay&&(InfoForDisplay=JSON.stringify(a)),void 0!==InfoForDisplayWithLiteUsers&&(a=JSON.parse(InfoForDisplayWithLiteUsers)),void 0!==a)for(r=a.length,i=0;i<r;i++)if(a[i].id===e){a[i].userType=t;break}if(void 0!==InfoForDisplayWithLiteUsers&&(InfoForDisplayWithLiteUsers=JSON.stringify(a)),null!=Search.InfoForDefaultDisplay&&(a=JSON.parse(Search.InfoForDefaultDisplay)),null!=a)for(r=a.length,i=0;i<r;i++)if(a[i].id==e){a[i].userType=t;break}null!=Search.InfoForDefaultDisplay&&(Search.InfoForDefaultDisplay=JSON.stringify(a))},Search.bulkJsonUpdate=function(e,t){for(var a=0;a<e.length;a++)Search.updateJson(e[a],t)},Search.getJsonObj=function(e,t){return $.grep(e,(function(e){return e.id==t}))},Search.limitTextValues=function(e,t,a){var r,i=(e=$(e)).is("input:text"),n=e.val();if(i&&t){r=t.which;n="paste"===t.type&&t.clipboardData&&t.clipboardData.getData?n+t.clipboardData.getData("text/plain"):e.val()}return n&&((n=i?n.split(","):n).length>Search.maxValuesForTextCond&&(!i||t&&"paste"===t.type)||n.length>=Search.maxValuesForTextCond&&i&&44===r)?(Search.isVRCriteria?$(".validationRuleCongureWarningMsg").text(I18n.getMsg("crm.alert.maximum.text.values.contains",Search.maxValuesForTextCond.toString())).show():a?renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.maximum.text.values.contains",Search.maxValuesForTextCond.toString())):alert(I18n.getMsg("crm.alert.maximum.text.values.contains",Search.maxValuesForTextCond.toString())),!1):(44===r&&e.removeAttr("data-isdef"),!0)},Search.populateUserConditionValues=function(e,t,a){if(a.attr("selected-users")){var r=a.attr("id"),i=e.split(",");if(a.find("crux-role-component").length>0)return void(Search.roleElemMap[r]=i);Search.userElemMap[r]=i;for(var n=0;n<i.length;n++){var s=i[n];"${CURRENTUSER}"!==s&&-1===Search.userIdsForReq.indexOf(s)&&Search.userIdsForReq.push(s)}}else if(e){var l=a.find("ul"),o=a.attr("id");if(e=e.split(","),t)t=t.split(","),Search.populateUserCrtNames(e,l,o,t,void 0);else{e=(e=(e=e.replace("${CURRENTUSER},","")).replace(",${CURRENTUSER}","")).replace("${CURRENTUSER}","");var c=Crm.getCrmBasePath()+"/Pulse.do?action=getDataForDisplayAndMentions&isDeletedUsersNeeded=true&userIdList="+e;(new crmRequestPool).initiate({action:c,type:"GET",dataType:"json",success:function(a){Search.populateUserCrtNames(e,l,o,t,a)},error:function(){}})}}},Search.populateUserCrtNames=function(e,t,a,r,i){var n,s=t.find("input"),l=e.length;for(n=0;n<l;n++){var o,c=a+"_"+e[n];if("${CURRENTUSER}"==e[n])o=I18n.getMsg("current.logged.in.user");else{var d=[];if(i){for(var m=i.length,p=0;p<m;p++){var h=i[p];if(h.id===e[n]){d=h;break}}o=d.name}else o=r[n]}var u='<li class="search-choice" data-id="'+e[n]+'" id="sel_'+c+'">'+$ESAPI.encoder().encodeForHTML(o)+'<a href="javascript:void(0)" class="search-choice-close p0" onclick="Search.removeSingleUser(event,this,\''+c+"','"+a+"')\"></a></li>";s.before(u),s.attr("placeholder","")}},Search.showSummaryView=function(e,t,a,r,i,n,s,l){var o,c;void 0===a&&(a=!1),a&&"orchestration"!==s?c="wflow":"process"===s||"field"===s||"transition"===s?c="blueprint":"createProcess"===s?c="createProcess":"orchestration"===s&&(c="orchestration");var d=!1,m={T:"textcondition",U:"usercondition",CS:"callstatuscondition",consent:"consentcondition",CML:"campcvcondition",B:"booleancondition",N:"numcondition",D:"datecondition",DT:"datetimecondition",picklist:"textpicklistcondition",L:"layoutcondition",W:"wizardcondition",tag:"tagcondition",stagecond:"stagecondition",MXN:"mxncondition"},p={textcondition:["searchtext"],enc_textcondition:["enc_searchtext"],usercondition:["temp_searchuser"],callstatuscondition:["searchcallstatus"],consentcondition:["searchpicklist"],campcvcondition:["temp_searchcampcv"],booleancondition:["searchboolean"],numcondition:["searchnum","searchenum"],enc_numcondition:["enc_searchnum"],datecondition:["searchdate","searchedate"],enc_datecondition:["enc_searchdate"],datetimecondition:["searchdatedate","searchsthour","searchstminute","searchstampm","searchenddate","searchethour","searchetminute","searchetampm"],enc_datetimecondition:["enc_searchdatedate"],textpicklistcondition:["searchpicklist"],layoutcondition:["searchlayout"],wizardcondition:["searchwizard"],tagcondition:["searchtag"],stagecondition:["searchpicklist"]},h="";if(t&&""!=t&&(h=n?"":a?t:"_"+t),"criteria"===e||"processFlow"===e||"transitionFlow"===e||"FieldValidation"===e||"rlFieldValidation"===e){var u=$("#"+(i?"searchlayer_new"+h:"searchlayer"+h)),f=(d="true"==u.attr("hideOperator"),"criteria"===e?d?"<ol>":"<ol class='approvalOrderList'>":""),v=u.find("tr").length;if(("processFlow"===e||"transitionFlow"===e||"FieldValidation"===e||"rlFieldValidation"===e)&&!(o=Search.getCriteriaDetails(void 0,h,void 0,a||"processFlow"!==e&&"transitionFlow"!==e&&"rlFieldValidation"!==e?void 0:c)))return!1;for(var g=u.find("#patternVal"+h).val(),S=u.find("tr.searchcrt"),C=$("#W"),y="#temp_searchuser"+h,I=1;I<=v-3;I++){var T,b,x,w,_,E,O,N,L,D,M="";if(i){var R=(x=(b=S.eq(I-1)).find("#searchfield")).find("option:selected");T=R.attr("id"),w=b.find(".searchcondition").val(),_=b.find(".searchcondition option[value='"+w+"']").text();var k=R.attr("ind");M=b.find(".mmlmodule"+k).find("option:selected").attr("value");var A=R.attr("col"),B=A&&(A.indexOf("SMCREATORID")>-1||A.indexOf("MODIFIEDBY")>-1);if(void 0===D&&Search.isScoreRuleField(R.val())){D={};for(var F=JSON.parse(R.attr("data-params")),P=F.length,U=0;U<P;U++){var V=F[U];D[V.id]=V.name}}if(void 0===E||void 0===O||void 0===L||void 0===N){E={},O={},L={},N={};b.find("#searchValue");var H=x.find("#tag");if(H.length>0&&void 0!==H.attr("data-params")&&""!==H.attr("data-params")){var z=JSON.parse(H.attr("data-params"));$.each(z,(function(e,t){E[t.id]=t.name}))}if(C.length>0&&void 0!==C.attr("data-params")&&""!==C.attr("data-params"))for(var Y=(z=JSON.parse(C.attr("data-params"))).length,j=0;j<Y;j++){var q=z[j].split("!@#");N[q[0]]=q[1]}var W=x.find("#layout");W.length>0&&void 0!==W.attr("data-params")&&""!==W.attr("data-params")&&(z=JSON.parse(W.attr("data-params")),$.each(z,(function(e,t){var a=t.split("!@#");O[a[0]]=a[1]})));var G,J=!1;"blueprint"===c&&ProcessBuilder&&ProcessBuilder.Process&&ProcessBuilder.Process.Module&&(J=moduleRecordMapping[ProcessBuilder.Process.Module]&&"team_based"===moduleRecordMapping[ProcessBuilder.Process.Module].access_type),(!B&&void 0===InfoForDisplay||B&&void 0===InfoForDisplayWithLiteUsers)&&loadDataForDisplayAndMentions(!1,!0,void 0,void 0,void 0,B),J&&void 0!==InfoForDisplayWithLiteUsers?G=JSON.parse(InfoForDisplayWithLiteUsers):!B&&InfoForDisplay?G=JSON.parse(InfoForDisplay):B&&InfoForDisplayWithLiteUsers&&(G=JSON.parse(InfoForDisplayWithLiteUsers));var X,Q=Crm.userDetails.NAME_FORMAT,Z=Q.indexOf("First")<Q.indexOf("Last")?"first":"last";null!=G&&null!=G&&$.each(G,(function(e,t){"user"===t.type&&(X="first"==Z?(0==t.firstName.length?"":t.firstName+" ")+t.lastName:(0==t.lastName.length?"":t.lastName+" ")+t.firstName,L[t.id]=X)}))}}else T=$("#searchfieldtype"+I+h).val();var K,ee,te,ae,re,ie,ne,se,le,oe,ce=1;if(i){o=Search.getCriteriaObj(I,u,c,l),K=o.value;if(o.api_name&&/^Competitor Mentions\.crmcompetitormentions.*__s$/.test(o.api_name)){K=K.match(/(?:\\,|[^,])+/g).sort().join()}if(ee=o.comparator,"L"==T||"layout"==T)te=K.split(","),K="",$.each(te,(function(e,t){K+=O[t]+","})),K=K.substring(0,K.length-1);else if("W"==T){te=K.split(","),K="";var de=te.length;for(j=0;j<de;j++)K+=N[te[j]]+",";K=K.substring(0,K.length-1)}else"tag"==T?(te=K.split(","),K="",$.each(te,(function(e,t){K+=E[t]+","})),K=K.substring(0,K.length-1)):"U"==T?(te=K.split(","),K="",$.each(te,(function(e,t){null!=L[t]?K+=L[t].trim()+",":ne=!0})),ne?(K="",K=$(y+I).attr("selected-names")):K=K.substring(0,K.length-1)):"datetime"!=T&&"date"!=T||w!=Search.ageCrt&&w!=Search.dueCrt||K.startsWith("${AGE")&&(K=w==Search.ageCrt?(K=K.substring(5)).substring(0,K.length-1):(K=K.substring(6)).substring(0,K.length-1),$.each(Search._AGEINDAYSCOND1,(function(e,t){if(ee===t[0])return K=t[1]+" "+K,!1})));"L"==T||"layout"==T?ae=K:"W"===T?ie=K:"tag"==T?re=K:"picklist"==T&&K.indexOf(",")>0&&(K=K.replace(/\\\,/g,","))}else{var me,pe=m[T],he=$("#searchfield"+I+h).find(":selected").attr("data-enc");if(me="true"===he?p["enc_"+pe]:p[pe],"picklist"===T||"consent"===T||"stagecond"===T){if(te=$("select[id="+me+I+h+"]").val(),"stagecond"===T&&(te=$("#divstage"+I+h).find("select[id="+me+I+h+"]").val()),""!=te&&null!=te){ce=te.length;for(j=0;j<ce;j++)K=0==j?te[j]:K+", "+te[j]}}else if("L"==T){if(""!=(te=$("select[id="+me+I+h+"]").val())&&null!=te){ce=te.length;for(j=0;j<ce;j++)0==j?(K=te[j],ae=$("#"+te[j]).val()):(K=K+", "+te[j],ae=ae+", "+$("#"+te[j]).val())}}else if("W"==T){if(""!=(te=$("#"+me+I+h).val())){ce=te.length,K=te[0],ie=$("#"+te[0]).val();for(j=1;j<ce;j++)K=K+", "+te[j],ie=ie+", "+$("#"+te[j]).val()}}else if("tag"==T){if(""!=(te=$("select[id="+me+I+h+"]").val())&&null!=te){ce=te.length;for(j=0;j<ce;j++)0==j?(K=te[j],re=$("#"+te[j]).val()):(K=K+", "+te[j],re=re+", "+$("#"+te[j]).val())}}else if("U"==T){if("Current User"!=(Se=$("#usercondition"+I+h).val())){var ue=(te=$("#searchuser"+I+h).val()).split(",");ce=ue.length;var fe=$("#"+me+I+h);if(fe.attr("selected-names"))K=fe.attr("selected-names");else for(j=0;j<ce;j++)0==j&&""!=ue[j]?K=$("[id='sel_"+me+I+h+"_"+ue[j]+"']").text():0!=j&&""!=ue[j]&&(K=K+", "+$("[id='sel_"+me+I+h+"_"+ue[j]+"']").text())}}else if("DT"==T){if("between"==(Se=$("#datetimecondition"+I+h).val())||"not between"==Se)for(var ve=me.length,ge=0;ge<ve;ge++)0==ge?K=getElemById(me[ge]+I+h).value:2==ge||6==ge?K=K+":"+I18n.getMsg(getElemById(me[ge]+I+h).value):("HH:mm"===Crm.userDetails.TIME_FORMAT&&3!=ge&&7!=ge||"HH:mm"!=Crm.userDetails.TIME_FORMAT)&&(K=K+" "+getElemById(me[ge]+I+h).value);else"Today"==Se||"Yesterday"==Se||"Tommorow"==Se||"Tommorow Onwards"==Se||"Till Yesterday"==Se||"Last Month"==Se||"Current Month"==Se||"Next Month"==Se||"Last Week"==Se||"Current Week"==Se||"Next Week"==Se||"Last Year"==Se||"Next Year"==Se||"Current Year"==Se||"This Year"==Se||"Previous FQ"==Se||"Current FQ"==Se||"Next FQ"==Se||"Previous FY"==Se||"Current FY"==Se||"Next FY"==Se?K=$("#searchdatedate"+I+h).val():"is"==Se||"isn't"==Se||"is before"==Se||"is after"==Se?K=(K=(K=(K=$("#searchdatedate"+I+h).val())+" , "+$("#searchsthour"+I+h).val())+" : "+$("#searchstminute"+I+h).val())+" "+$("#searchstampmSpan"+I+h).text():Se!=Search.ageCrt&&Se!=Search.dueCrt||(K=(K=$("#ageindayscondition"+I+h).val())+"  "+$("#ageindays"+I+h).val())}else if("D"==T){var Se;if("between"==(Se=$("#datecondition"+I+h).val())||"not between"==Se)for(ve=me.length,ge=0;ge<ve;ge++)K=0==ge?getElemById(me[ge]+I+h).value:K+" "+getElemById(me[ge]+I+h).value;else"Today"==Se||"Yesterday"==Se||"Tommorow"==Se||"Tommorow Onwards"==Se||"Till Yesterday"==Se||"Last Month"==Se||"Current Month"==Se||"Next Month"==Se||"Last Week"==Se||"Current Week"==Se||"Next Week"==Se||"Last Year"==Se||"Next Year"==Se||"Current Year"==Se||"This Year"==Se||"Previous FQ"==Se||"Current FQ"==Se||"Next FQ"==Se||"Previous FY"==Se||"Current FY"==Se||"Next FY"==Se||"is"==Se||"isn't"==Se||"is before"==Se||"is after"==Se?K=$("#searchdate"+I+h).val():Se!=Search.ageCrt&&Se!=Search.dueCrt||(K=(K=$("#ageindayscondition"+I+h).val())+"  "+$("#ageindays"+I+h).val())}else if("N"==T)if("between"==(Se=$("#numcondition"+I+h).val())||"not between"==Se)for(ve=me.length,ge=0;ge<ve;ge++)K=0==ge?getElemById(me[ge]+I+h).value:K+"-"+getElemById(me[ge]+I+h).value;else K=$("#"+me[0]+I+h).val();else K=$("#"+me+I+h).val()}i?(le=w,oe=_):(le=(se="true"===he?$("#enc_"+pe+I+h+" option:selected"):$("#"+pe+I+h+" option:selected")).val(),oe=se.text());if((["Today","Yesterday","Tommorow","Tommorow Onwards","Till Yesterday","Last Month","Current Month","Next Month","Last Week","Current Week","Next Week","Current User","Last Year","Next Year","Current Year","This Year","Previous FQ","Current FQ","Next FQ","Previous FY","Current FY","Next FY"].contains(le)||["${TODAY}","${YESTERDAY}","${TOMORROW}","${TOMORROWPLUS}","${YESTERDAYMINUS}","${LASTMONTH}","${THISMONTH}","${NEXTMONTH}","${LASTWEEK}","${THISWEEK}","${NEXTWEEK}","${CURRENTUSER}","${LASTYEAR}","${THISYEAR}","${NEXTYEAR}","${PREVFQ}","${THISFQ}","${NEXTFQ}","${PREVFY}","${NEXTFY}","${THISFY}"].contains(le))&&(K=oe,oe=I18n.getMsg("is")),"CS"!=T&&"cs"!=T||(K=oe,oe=I18n.getMsg("is")),K||"is empty"===le||"is not empty"===le||"${EMPTY}"===le||"${NOTEMPTY}"===le||"is OPEN"===le||"is WON"===le||"is LOST"===le||"${OPEN}"===le||"${CLOSEDWON}"===le||"${CLOSEDLOST}"===le)if("processFlow"===e||"transitionFlow"===e||"FieldValidation"===e||"rlFieldValidation"===e){if(1==I)f=f+"<div class='viewCriRow'><span class='criNum crmBaseColor pR10'>"+I+"</span><span style='visibility:hidden' class='crmBaseColor ttUppercase wf_oprView'></span>";else{var Ce="and"===g.substring(g.substring(0,g.indexOf(I)-1).lastIndexOf(" ")+1,g.indexOf(I)-1)?I18n.getMsg("crm.label.and"):I18n.getMsg("crm.label.or");f=f+"<div class='viewCriRow'><span class='criNum crmBaseColor pR10'>"+I+"</span><span class='crmBaseColor ttUppercase wf_oprView'>"+$.trim(Ce)+"</span>"}var ye,Ie=x.find("option:selected").text();if(f=(f=f+"<span class='crmGreenColor'>"+$ESAPI.encoder().encodeForHTML($.trim(Ie))+"</span>")+"<span class='crm-small-font-size crmBaseColor ttUppercase'>"+$.trim(oe)+"</span>","is empty"!==le&&"is not empty"!==le&&"${EMPTY}"!==le&&"${NOTEMPTY}"!==le&&"is OPEN"!==le&&"is WON"!==le&&"is LOST"!==le&&"${OPEN}"!==le&&"${CLOSEDWON}"!==le&&"${CLOSEDLOST}"!==le||(K=""),""!=K&&null!=K)ye="L"==T?ae:"W"===T?ie:"tag"==T?re:K,f=f+"<span class='crmGreenColor'>"+$ESAPI.encoder().encodeForHTML($.trim(ye))+"</span></div>";else f+="</div>"}else{Ce="",Ie="";var $e="predefined"==T;if(i?(Ce=I>1?b.find("#match"+h+" option:selected").text():"",Ie=x.find("option:selected").text()):(Ce=I>1?$("#match"+I+h+" option:selected").text():"",Ie=$("#searchfield"+I+h+" option:selected").text()),f=(f=d?(f+="<li class='pB5'><div>")+"<span class='pR5'>"+Ce+"</span>":(f+="<li><div>")+"<span class='andOrText'>"+Ce+"</span>")+"<span class='crmGreenColor'>"+$ESAPI.encoder().encodeForHTML(Ie)+"</span>",$e||(f=f+"<span class='highlightTxt mR5 mL5  crm-small-font-size'>"+oe+"</span>"),"is empty"!==le&&"is not empty"!==le&&"${EMPTY}"!==le&&"${NOTEMPTY}"!==le&&"${OPEN}"!==le&&"${CLOSEDWON}"!==le&&"${CLOSEDLOST}"!==le&&"is OPEN"!==le&&"is WON"!==le&&"is LOST"!==le||(K=""),""==K||null==K||$e)f+="</div></li>";else{var Te;if("L"===T?Te=ae:"W"===T?Te=ie:"tag"===T&&(Te=re),K=void 0!==D&&D[K]?D[K]:K,"num"===T&&Search.numberSeparatorMap.includes(o.field_label))if("between"!==oe&&"not between"!==oe){var be=K.split("~");K=Search.formatNumber(be[0])+"~"+Search.formatNumber(be[1])}else K=Search.formatNumber(K);if("approval_process"===s&&"N"===T)if("true"===$("#searchfield"+I+h+" option:selected").val().split(":")[5])if("between"===oe||"not between"===oe){var xe=[],we=K.length;for(ge=0;ge<we&&("-"!=K[ge]||(xe.push(ge),2!=xe.length));ge++);if(2==xe.length){be=(K=K.substring(0,xe[1])+"~"+K.substring(xe[1]+1)).split("~");K=Search.formatNumber(be[0])+"~"+Search.formatNumber(be[1])}else if(1==xe.length){be=K.split("-");K=Search.formatNumber(be[0])+"-"+Search.formatNumber(be[1])}}else K=Search.formatNumber(K);f=f+"<span class='crmGreenColor'>"+$ESAPI.encoder().encodeForHTML("L"===T||"tag"===T||"W"===T?Te:"true"!==K&&"false"!==K||"boolean"!==T?K:"true"===K?I18n.getMsg("crm.label.selected"):I18n.getMsg("crm.label.notSelected")),"multimodulelookup"===T&&(f+="<span class='highlightTxt mR5 mL5  crm-small-font-size'>In</span>",f+="<span class='crmGreenColor'>"+M+"</span>"),f+="</span></div></li>"}}4!==v||K||"is empty"===le||"is not empty"===le||"${EMPTY}"===le||"${NOTEMPTY}"===le||"is OPEN"===le||"is WON"===le||"is LOST"===le||"${OPEN}"===le||"${CLOSEDWON}"===le||"${CLOSEDLOST}"===le||(f=a||"processFlow"===e||"transitionFlow"===e||"FieldValidation"===e||"rlFieldValidation"===e?"":I18n.getMsg("crm.message.processes.criteria.not.specified"))}if("processFlow"===e){var _e=$("#processCriteriaSummary");return _e.find(".criSummary").html(f),0===(Ee=_e.find(".viewCriRow").length)?($("#processAddCriLink").removeClass("hide"),_e.addClass("hide")):(1===Ee&&_e.find(".wf_oprView").remove(),$("#processAddCriLink").addClass("hide"),_e.removeClass("hide")),!0}if("transitionFlow"===e){if("undefined"!=typeof TransitionClone){var Ee,Oe=TransitionClone.isCloneInProgress?TransitionClone.destTransId:ProcessBuilder.Transition.Id,Ne=$("#transitionCriteriaSummary_"+Oe);Ne.find(".criSummary").html(f),0===(Ee=Ne.find(".viewCriRow").length)?($("#transitionAddCriLink_"+Oe).removeClass("hide"),Ne.addClass("hide")):(1===Ee&&Ne.find(".wf_oprView").remove(),$("#transitionAddCriLink_"+Oe).addClass("hide"),Ne.removeClass("hide"))}return!0}if("FieldValidation"===e)return $("#transFieldRow_"+t).find(".criSummary").html(f),!0;if("rlFieldValidation"===e)return $("#transRLFieldRow_"+t).find(".criSummary").html(f),!0;if(f+="</ol>",v>5&&!d){var Le="<div class='pT20' style='margin-left: 42px;' class='pT30'><span class='wf_form_lab dIB vaM'>"+I18n.getMsg("crm.label.criteria.pattern")+" :</span>";f+=Le+="<span class='pL0 dIB vaM crmBaseColor crm-font-regular cri_pattern mL10' style='max-width: 74%;'>"+$("#pattern"+h).text()+"</span></div>"}if(a||n)return f;$(getObj("criteriaSummary"+h)).empty(),getObj("criteriaSummary"+h).innerHTML=f,$("#critEditorDIV"+h).slideUp(),$("#criteriaSummary"+h).show();var De=$("#tab1"+h);De.find(".accordianTab").removeClass("accordianTabActive"),De.find(".accordianTab").removeAttr("onClick"),De.find(".accordianTabRight").hide(),De.addClass("hoverEffect pR"),De.attr("onMouseOver","accordiantabHover(this)"),De.attr("onMouseOut","accordiantabHoverout(this)"),De.attr("onClick","triggerTabsView('tab1"+h+"','"+t+"','1',"+!0+")")}else if("approver"==e){var Me="#approversTD",Re="#ApproverTypeList",ke="#approverTypes",Ae="#assignToId",Be=":",Fe=0,Pe="",Ue=!1,Ve=!1,He=[],ze=[],Ye=[],je=$("#approverlayer"+h+" tr").length,qe=I18n.getMsg("crm.option.approval.everyone");rolesResp("/crm/v2.2/users/actions/grouped_counts","group_by=role",null,"role"),approvalProcess.lastRoleCheck=2;var We=$("#approverTypeListNew_approverRow_"+h).attr("value");"1"===We&&$("#notifyToUserVia"+h).hide();var Ge="#approverTypes",Je="approvertype";if(Crm.userDetails.isAPRMPAEnabled){var Xe=$L("#approvalprocessAdminradio"+h).attr("value");if(!$L("#fields"+h)||$L("#fields"+h)[0].checked){var Qe=$("#allFields"+h),Ze=$("#processField"+h),Ke=approvalProcess.cancelRuleCall?"1"===Xe?"#allFields":"#processField":Qe[0].checked||Ze[0].checked?Qe[0].checked?"#allFields":"#processField":"1"===Xe?"#allFields":"#processField";$L(Ke+h).prop("checked","true")}var et=$L("#viaEmail6"+h),tt=et.attr("value"),at=$L("#viaApp6"+h),rt=at.attr("value"),it=$L("#viaCliq"+h),nt=$L("#userConfig"+h),st=nt.attr("value"),lt=it.attr("value"),ot=$L("#viainteg"+h),ct=ot.attr("value");"true"===tt&&et.prop("checked",!0),"true"===st&&nt.prop("checked",!0),"true"===rt&&at.prop("checked",!0),"true"===lt&&it.prop("checked",!0),"true"===ct&&ot.prop("checked",!0)}for(I=1;I<=je;I++){var dt=$("#approvalMsg"+h);1===je&&void 0!==dt&&dt.hide();var mt="#approverRow_"+I+h,pt=$L(mt+" #ApproverTypeList #approverTypes"),ht="";if("12"!==(Ft=pt.attr("approvertype"))&&("1"===We||1===je)){var ut="#approverRow_"+I+h,ft=$(ut).find("#ApproverTypeList").find(Ge),vt=parseInt(ft.attr(Je));vt>8&&13!==vt&&14!==vt&&15!==vt?ft.attr(Je,vt-7):15===vt&&ft.attr(Je,vt-1),Ge=ut.split("#")[1];var gt=$(ut).find("#approverTypesEoA_"+Ge)[0];void 0!==gt&&(gt.innerHTML=I18n.getMsg("crm.option.approval.anyone"));var St="icon_"+Ge,Ct=document.getElementById(St);null!==Ct&&(Ct.style.display="none"),$(ut+" #approverTypeListNew_"+Ge).addClass("eventNone disabledApDropdown");var yt=$(ut).find("#approverTypeListNew"),It='crmui.showTooltip({content:"'+I18n.getMsg("crm.approval.process.set.overall.everyOne")+"\",isHTML: false,position: 'Left'})";yt.attr({onmouseout:"crmui.hideTooltip()",onmouseenter:It})}if("13"===Ft&&(ht=$L("#approverRow_"+I+h+" #approversTD").attr("approverVal"),ze.push(!0),Ye.push($L("#approverRow_"+I+h+" #teamspaceUserListDiv #apApproversComponent")[0].component.getData("selectedId"))),"1"==Ft){var $t=$L(mt+" #assignTo").val();ht=$t,ze.push(!0);var Tt="idl";Tt=$(mt+" "+Ae).val().toString(),approvalProcess.listApprover[Tt+""]=$t,approvalProcess.arrayApprover.contains(Tt)||Lyte.arrayUtils(approvalProcess.arrayApprover,"insertAt",I-1,Tt),Ye.push(Tt)}else{var bt=$L(mt+" "+Me);if(ht=bt.attr("approverVal"),"4"===Ft||"5"===Ft||"11"===Ft||"12"===Ft){approvalProcess.listApprover.Levels=pt[0].innerText;var xt=ht.split(":"),wt="5"===Ft||"12"===Ft?"UptoLevels":"Levels";approvalProcess.arrayApprover.contains(wt+xt[0])||Lyte.arrayUtils(approvalProcess.arrayApprover,"insertAt",I-1,wt+xt[0])}else if("6"===Ft)approvalProcess.listApprover.Manager=pt[0].innerText,approvalProcess.arrayApprover.contains("Manager")||Lyte.arrayUtils(approvalProcess.arrayApprover,"insertAt",I-1,"Manager");else if("7"===Ft)approvalProcess.listApprover.RecordOwner=pt[0].innerText,approvalProcess.arrayApprover.contains("RecordOwner")||Lyte.arrayUtils(approvalProcess.arrayApprover,"insertAt",I-1,"RecordOwner");else if("2"===Ft||"9"===Ft){Tt=$L(mt+" #roleName").attr("roleid");approvalProcess.listApprover[Tt+""]=ht,approvalProcess.arrayApprover.contains(Tt)||Lyte.arrayUtils(approvalProcess.arrayApprover,"insertAt",I-1,Tt)}else if("3"===Ft||"10"===Ft){Tt=$L(mt+" #groupName").attr("groupid");approvalProcess.listApprover[Tt+""]=ht,approvalProcess.arrayApprover.contains(Tt)||Lyte.arrayUtils(approvalProcess.arrayApprover,"insertAt",I-1,Tt)}else if("13"===Ft){var _t=bt.attr("teamUser");_t=_t||pt.attr("approverId"),approvalProcess.arrayApprover.contains(_t)||Lyte.arrayUtils(approvalProcess.arrayApprover,"insertAt",I-1,_t)}else if("14"===Ft||"15"===Ft){var Et=bt.attr("teamProfile");Et=Et||pt.attr("approverId"),approvalProcess.arrayApprover.contains(Et)||Lyte.arrayUtils(approvalProcess.arrayApprover,"insertAt",I-1,Et)}else Tt=$L(mt+" "+Ae).val().toString(),approvalProcess.listApprover[Tt+""]=ht,approvalProcess.arrayApprover.contains(Tt)||Lyte.arrayUtils(approvalProcess.arrayApprover,"insertAt",I-1,Tt);ze.push(!1),Ye.push(null)}if("1"===Ft||"2"===Ft||"3"===Ft||"9"===Ft||"10"===Ft||"13"===Ft||"14"===Ft||"15"===Ft)He.push($ESAPI.encoder().encodeForHTML(ht));else if("4"===Ft||"5"===Ft||"11"===Ft||"12"===Ft)if("level"==(ht=ht.split(":"))[1])1==ht[0]?He.push(I18n.getMsg("crm.option.approval.level.st",ht[0])):2==ht[0]?He.push(I18n.getMsg("crm.option.approval.level.nd",ht[0])):3==ht[0]?He.push(I18n.getMsg("crm.option.approval.level.rd",ht[0])):He.push(I18n.getMsg("crm.option.approval.level.th",ht[0]));else for(ge=1;ge<=ht[0];ge++)1==ge?He.push(I18n.getMsg("crm.option.approval.level.st",ge.toString())):2==ge?He.push(I18n.getMsg("crm.option.approval.level.nd",ge.toString())):3==ge?He.push(I18n.getMsg("crm.option.approval.level.rd",ge.toString())):He.push(I18n.getMsg("crm.option.approval.level.th",ge.toString()));else"6"==Ft?Crm.userDetails.isUserHierarchy?He.push(I18n.getMsg("crm.user.hierarchy.reportingto")):He.push(I18n.getMsg("Manager")):"7"==Ft&&He.push(I18n.getMsg("crm.label.recordOwner"))}if(approvalProcess.arrayApproverJson["tab5"+h]=approvalProcess.arrayApprover,$("#approveAnyone"+h).prop("checked")||"1"===We){var Ot=0,Nt=0;$("#approverSummDetail"+h).removeClass("sequentialSummary"),$("#approverSummDetail"+h).removeClass("parallelList"),$("#approverSummDetail"+h).addClass("anyoneSummary"),He.length>1&&($(getObj("summaryTitle"+h)).empty(),getObj("summaryTitle"+h).innerHTML=I18n.getMsg("crm.message.anyone.summary.content"));var Lt=1;for(I=0;I<He.length;I+=1){if(Pe=ze[I]?Pe+'<span class="gBgText dIB mB10 tagCont" onmouseover="Search.showUserBusinessCardAP(this,\''+Ye[I]+'\')" onmouseout="hideUserBusinessCard()" onclick="hideUserBusinessCard()">'+He[I]+"</span>":Pe+"<span class='gBgText dIB mB10 tagCont'>"+He[I]+"</span>",void 0!==(jt=(Yt=$("#approverRow_"+Lt+h)).find(Me).attr("approverval"))){Be=jt.split(":")[0],Ot=Yt.find(Re).find(ke).attr("approvertype");var Dt=He[I].split("<sup>")[1];"5"!==Ot&&"12"!==Ot?Lt++:(void 0!==Dt&&"1"!==He[I].split("<sup>")[0]||(Fe=1),":"!==Be&&parseInt(Be)===Fe&&(Fe=0,Lt++)),Fe++,Nt="11"===Ot||"12"===Ot?1:"4"===Ot||"5"===Ot?2:3,void 0===Ot&&1===Nt?Ot="11":void 0===Ot&&2===Nt&&(Ot="4"),qe="2"===Ot||"3"===Ot||"14"===Ot||"4"===Ot&&!approvalProcess.isReportingHierarchy||"5"===Ot&&!approvalProcess.isReportingHierarchy?I18n.getMsg("crm.option.approval.anyone"):I18n.getMsg("crm.option.approval.everyone"),"10"!==Ot&&"9"!==Ot&&"14"!==Ot&&"15"!==Ot&&"3"!==Ot&&"2"!==Ot&&("4"!==Ot&&"11"!==Ot&&"12"!==Ot&&"5"!==Ot||approvalProcess.isReportingHierarchy)||!approvalProcess.isFeatureEnabled||(Pe=Pe+"<span class='cBoth mT5 aprTextTag crm-small-font-size crmWhiteColor' >"+qe+"</span>"),(ge=1+I)!=He.length&&(Pe+="<b class='pR10 pL10 crmNotFoundColor'>/</b>")}}$(getObj("approverSummDetail"+h)).html("").append(Pe)}else{if("3"==$("#everyOneOpt"+h).attr("everyoneOpt")){$("#approverSummDetail"+h).removeClass("parallelList"),$("#approverSummDetail"+h).removeClass("anyoneSummary"),$("#approverSummDetail"+h).addClass("sequentialSummary"),$(getObj("summaryTitle"+h)).empty(),getObj("summaryTitle"+h).innerHTML=I18n.getMsg("crm.message.sequential.summary.content");Je=1,ge=1;var Mt=1;for(Lt=1,I=0;I<He.length;I++)if(ge=I+1,0==I){(zt=document.createElement("ul")).setAttribute("id","ul"+Mt+h),zt.className="sequentialList fL mL0",$("#approverSummDetail"+h).html("").append(zt),Mt+=1;var Rt=document.createElement("li"),kt=document.createElement("p"),At=document.createElement("i");if(Rt.setAttribute("id","li"+h),$(kt).append(He[I]),ze[I]&&(kt.setAttribute("onmouseover","Search.showUserBusinessCardAP(this,'"+Ye[I]+"');"),kt.setAttribute("onmouseout","hideUserBusinessCard();")),Rt.appendChild(kt),Rt.appendChild(At),void 0===(jt=(Yt=$("#approverRow_"+Lt+h)).find(Me).attr("approverval")))continue;Be=jt.split(":")[0];Ot=Yt.find(Re).find(ke).attr("approvertype"),Dt=He[I].split("<sup>")[1];if("5"!==Ot&&"12"!==Ot?Lt++:(void 0!==Dt&&"1"!==He[I].split("<sup>")[0]||(Fe=1),":"!==Be&&parseInt(Be)===Fe&&(Fe=0,Lt++)),Fe++,"2"===Ot||"3"===Ot||"14"===Ot||"4"===Ot&&!approvalProcess.isReportingHierarchy||"5"===Ot&&!approvalProcess.isReportingHierarchy)Ue=!0,(Ut=document.createElement("span")).className="fL cBoth mT5 aprTextTag crm-small-font-size crmWhiteColor",$(Ut).append(I18n.getMsg("crm.option.approval.anyone")),approvalProcess.isFeatureEnabled&&Rt.append(Ut);else if("10"===Ot||"9"===Ot||"15"===Ot||("11"===Ot||"12"===Ot)&&!approvalProcess.isReportingHierarchy){Ue=!0,(Ut=document.createElement("span")).className="fL cBoth mT5 aprTextTag crm-small-font-size crmWhiteColor",$(Ut).append(I18n.getMsg("crm.option.approval.everyone")),approvalProcess.isFeatureEnabled&&Rt.append(Ut)}if($("#approverSummDetail"+h).find("ul").html("").append(Rt),ge<He.length){(Ht=document.createElement("li")).className="centerline";var Bt=document.createElement("span");Ht.appendChild(Bt),$("#approverSummDetail"+h).find("ul li:last").after(Ht)}}else if(1==Je||4==Je){Rt=document.createElement("li"),kt=document.createElement("p"),At=document.createElement("i");if(Rt.setAttribute("id","li"+I+h),$(kt).append(He[I]),ze[I]&&(kt.setAttribute("onmouseover","Search.showUserBusinessCardAP(this,'"+Ye[I]+"');"),kt.setAttribute("onmouseout","hideUserBusinessCard();")),Rt.appendChild(kt),Rt.appendChild(At),void 0===(jt=(Yt=$("#approverRow_"+Lt+h)).find(Me).attr("approverval")))continue;Be=jt.split(":")[0];var Ft=Yt.find(Re).find(ke).attr("approvertype");Dt=He[I].split("<sup>")[1];if("5"!==Ft&&"12"!==Ft?Lt++:(void 0!==Dt&&"1"!==He[I].split("<sup>")[0]||(Fe=1),":"!==Be&&parseInt(Be)===Fe&&(Fe=0,Lt++)),Fe++,"2"===Ft||"3"===Ft||"14"===Ft||"4"===Ft&&!approvalProcess.isReportingHierarchy||"5"===Ft&&!approvalProcess.isReportingHierarchy)Ue=!0,(Ut=document.createElement("span")).className="fL cBoth mT5 aprTextTag crm-small-font-size crmWhiteColor",$(Ut).append(I18n.getMsg("crm.option.approval.anyone")),approvalProcess.isFeatureEnabled&&Rt.append(Ut);else if("10"===Ft||"9"===Ft||"15"===Ft||("11"===Ft||"12"===Ft)&&!approvalProcess.isReportingHierarchy){Ue=!0,(Ut=document.createElement("span")).className="fL cBoth mT5 aprTextTag crm-small-font-size crmWhiteColor",$(Ut).append(I18n.getMsg("crm.option.approval.everyone")),approvalProcess.isFeatureEnabled&&Rt.append(Ut)}if(4==Je)(zt=document.createElement("ul")).setAttribute("id","li"+Mt+h),zt.className="sequentialList fL mT14",$("#approverSummDetail"+h).find("u:last").after(zt),Mt+=1,$("#approverSummDetail"+h).find("ul:last").html("").append(Rt),Je=1;else $("#approverSummDetail"+h).find("ul:last li:last").after(Rt);if(ge%4==0&&ge%8!=0){if(ge<He.length){var Pt=document.createElement("u");(Vt=document.createElement("img")).className="aprImgSize pR",Vt.src=networkUtils.getImageUrl("sideApr.png",ResourceConstants.CRM),4==ge?(Pt.className="reverseArw mT20",Ue&&(Pt.append(Vt),Pt.className="reverseArw mT20 noBg")):Pt.className="reverseArw",$("#approverSummDetail"+h).find("ul:last").after(Pt),Je=3}}else if(ge<He.length){(Ht=document.createElement("li")).className="centerline";Bt=document.createElement("span");Ht.appendChild(Bt),$("#approverSummDetail"+h).find("ul li:last").after(Ht)}}else if(2==Je||3==Je){(Rt=document.createElement("li")).setAttribute("id","li"+I+h),Rt.className="fR",(At=document.createElement("i")).className="reverse",Rt.appendChild(At),(kt=document.createElement("p")).className="fR",$(kt).append(He[I]),Rt.appendChild(kt);ge=I+1;if(void 0===(jt=(Yt=$("#approverRow_"+Lt+h)).find(Me).attr("approverval")))continue;Be=jt.split(":")[0];Ot=Yt.find(Re).find(ke).attr("approvertype"),Dt=He[I].split("<sup>")[1];if("5"!==Ot&&"12"!==Ot?Lt++:(void 0!==Dt&&"1"!==He[I].split("<sup>")[0]||(Fe=1),":"!==Be&&parseInt(Be)===Fe&&(Fe=0,Lt++)),Fe++,"2"===Ot||"3"===Ot||"14"===Ft||"4"===Ot&&!approvalProcess.isReportingHierarchy||"5"===Ot&&!approvalProcess.isReportingHierarchy)Ve=!0,(Ut=document.createElement("span")).className="fL cBoth mT5 aprTextTag crm-small-font-size crmWhiteColor",$(Ut).append(I18n.getMsg("crm.option.approval.anyone")),approvalProcess.isFeatureEnabled&&Rt.append(Ut);else if("10"===Ot||"9"===Ot||"15"===Ft||("11"===Ot||"12"===Ot)&&!approvalProcess.isReportingHierarchy){var Ut;Ve=!0,(Ut=document.createElement("span")).className="fL cBoth mT5 aprTextTag crm-small-font-size crmWhiteColor",$(Ut).append(I18n.getMsg("crm.option.approval.everyone")),approvalProcess.isFeatureEnabled&&Rt.append(Ut)}if(3==Je)(zt=document.createElement("ul")).setAttribute("id","ul"+Mt+h),1==$("#approverSummDetail"+h).find("ul").length?zt.className="sequentialList fR mR62 mB0 mT_16":zt.className="sequentialList fR mR33 mB0 mT_16",$("#approverSummDetail"+h).find("u:last").after(zt),Mt+=1,$("#approverSummDetail"+h).find("ul:last").html("").append(Rt),Je=2;else $("#approverSummDetail"+h).find("ul:last li:last").after(Rt);if(ge%4==0&&ge%8==0){if(ge<He.length){(Pt=document.createElement("u")).className="reverseArwLeft";var Vt=document.createElement("img");Ve&&(Pt.className="reverseArwLeft noBg",Vt.className="apprLeftArrow",Vt.src=networkUtils.getImageUrl("leftsideApr.png",ResourceConstants.CRM),Pt.append(Vt)),$("#approverSummDetail"+h).find("ul:last").after(Pt),Je=4}$("#ul1"+h).removeClass("mL0"),$("#ul1"+h).addClass("mL30"),$("#ul2"+h).removeClass("mR62"),$("#ul2"+h).addClass("mR33")}else if(ge<He.length){(Ht=document.createElement("li")).className="centerline1";Bt=document.createElement("span");Ht.appendChild(Bt),$("#approverSummDetail"+h).find("ul li:last").after(Ht)}}else{var Ht;(Ht=document.createElement("li")).className="centerline";Bt=document.createElement("span");Ht.appendChild(Bt),$("#approverSummDetail"+h).find("ul li:last").after(Ht);Rt=document.createElement("li"),kt=document.createElement("p"),At=document.createElement("i");Rt.setAttribute("id","li"+I+h),$(kt).append(He[I]),Rt.appendChild(kt),Rt.appendChild(At),$(getObj("approverSummDetail"+h)).find("ul li:last").after(Rt)}Rt=document.createElement("li");(At=document.createElement("i")).className=1==Je||4==Je?"icon_right mL10":"icon_right mR10",Rt.appendChild(At),$("#approverSummDetail"+h).find("ul li:last").after(Rt)}else{$("#approverSummDetail"+h).removeClass("sequentialSummary"),$("#approverSummDetail"+h).removeClass("anyoneSummary"),$("#approverSummDetail"+h).addClass("parallelList"),$(getObj("summaryTitle"+h)).empty(),getObj("summaryTitle"+h).innerHTML=I18n.getMsg("crm.message.parallel.summary.content");var zt=document.createElement("ul");$(getObj("approverSummDetail"+h)).html("").append(zt);for(Ot="",ge=0,Lt=1,I=0;I<He.length;I++){var Yt,jt;Rt=document.createElement("li");if((Bt=document.createElement("span")).className="gBgText dIB",$(Bt).append(He[I]),ze[I]&&(Bt.setAttribute("onmouseover","Search.showUserBusinessCardAP(this,'"+Ye[I]+"');"),Bt.setAttribute("onmouseout","hideUserBusinessCard();")),Rt.appendChild(Bt),void 0!==(jt=(Yt=$("#approverRow_"+Lt+h)).find(Me).attr("approverval"))){Be=jt.split(":")[0],qe=I18n.getMsg("crm.option.approval.everyone"),Ot=Yt.find(Re).find(ke).attr("approvertype");Dt=He[I].split("<sup>")[1];if("5"!==Ot&&"12"!==Ot?Lt++:(void 0!==Dt&&"1"!==He[I].split("<sup>")[0]||(Fe=1),":"!==Be&&parseInt(Be)===Fe&&(Fe=0,Lt++)),Fe++,("2"===Ot||"3"===Ot||"4"===Ot&&!approvalProcess.isReportingHierarchy||"5"===Ot&&!approvalProcess.isReportingHierarchy||"14"===Ot)&&(qe=I18n.getMsg("crm.option.approval.anyone")),"10"===Ot||"9"===Ot||"3"===Ot||"2"===Ot||("4"===Ot||"11"===Ot||"12"===Ot||"5"===Ot)&&!approvalProcess.isReportingHierarchy||"15"===Ot||"14"===Ot){var qt=document.createElement("span");$(qt).append(qe),qt.className="aprTextTag crm-small-font-size mL5 crmWhiteColor",approvalProcess.isFeatureEnabled&&Rt.appendChild(qt)}0==I?$("#approverSummDetail"+h).find("ul").append(Rt):$("#approverSummDetail"+h).find("ul li:last").after(Rt)}}}}$("#approverDiv"+h).slideUp(),$("#approverSummary"+h).css("display","inline-block");var Wt=$("#tab2"+h);Wt.find(".accordianTab").removeClass("accordianTabActive").removeAttr("onClick"),Wt.find(".accordianTabRight").hide(),Wt.addClass("hoverEffect pR"),Wt.attr("onMouseOver","accordiantabHover(this)"),Wt.attr("onMouseOut","accordiantabHoverout(this)"),Wt.attr("onClick","triggerTabsView('tab2"+h+"','"+t+"','2',"+!0+")"),1==$("#assignTask"+h).is(":checked")?""!=$("#TasklistView"+h).attr("taskid")&&$("#approverTask"+h).removeClass("dN"):$("#approverTask"+h).addClass("dN"),$("#selectTasksPop"+h).hide()}else"approveAction"==e&&($("body,html").animate({scrollTop:$("#tab3"+h).offset().top},500),$("#tab3"+h).attr("onMouseOver","accordiantabHover(this)"),$("#tab3"+h).attr("onMouseOut","accordiantabHoverout(this)"))},Search.showUserBusinessCardAP=function(e,t){null!=t&&1!=t&&"string"==typeof t&&(void 0===store.peekRecord("user",t)?store.findRecord("user",t,{type__s:"Regular User,Lite User"},!1,!0,{tempApiVersion:"V7"}).then((function(){showUserBusinessCard(null,t,e)})):showUserBusinessCard(null,t,e))},Search.hideUserBusinessCardImmediately=function(e){$("#userBCDiv").hide()},Search.getAddressOptionRowId=function(){var e;return $("#searchlayer").find("select[id^='searchfield']").each((function(t,a){var r=$(a).val();if(null!=r&&-1!==r.indexOf("LATITUDE"))return e=a.id.split("searchfield")[1],!1})),e},Search.removeAddressOptions=function(){var e=Search.getAddressOptionRowId();Search.addressFieldSetInCriteria=e,e&&$("#searchlayer").find("select[id^='searchfield']").each((function(t,a){$(this);if(this.id.split("searchfield")[1]!==e){var r=$(this).find("option[value*='LATITUDE']"),i={index:r.index(),obj:r};$("#searchlayer").data("indObj",i),r.remove()}}))},Search.removeAddressOption=function(e){if(Search.addressFieldSetInCriteria){$(e);var t=e.find("option[value*='LATITUDE']"),a={index:t.index(),obj:t};$("#searchlayer").data("indObj",a),t.remove()}},Search.addAddressOptions=function(){Search.addressFieldSetInCriteria=void 0,$("#searchlayer").find("select[id^='searchfield']").each((function(e,t){var a=$(this),r=$("#searchlayer").data("indObj"),i=r.obj.clone();a.find("option:eq('"+(parseInt(r.index)-1)+"')").after(i)}))},Search.hideCS=function(e){if(isNewCallView){var t=$(e).find("select"),a=t.val();if(!a||"Calls.Call_Status"!==a&&"Call_Status"!==a&&!a.startsWith("CrmTask:CALLSTATUS")&&!a.startsWith("CrmCall:CALLSTATUS")){var r=t.parent(),i=r.find("option#cs");if(i.length>0)i.remove().trigger("change.select2");else{var n=r.find("option#CS");n.length>0&&n.remove().trigger("change.select2")}}}},Search.changeField_new=function(e){var t=(e=$(e)).closest(".searchcrt"),a=t.data("index"),r=e.closest(".newSrchView").eq(0).attr("id"),i=r.substring(r.indexOf("w")+1),n=e.find("option:selected"),s=n.attr("id"),l=n.attr("data-enc"),o=n.attr("data-enc-related"),c=n.attr("col"),d=e.closest(".crtEditorDiv").attr("feature"),m=n.attr("ind"),p=t.find(".mmlmodule0").parent().children();p.each((function(){p.hide()}));var h=t.find(".mmlInText");if("multimodulelookup"===s){if(h.css("display","block"),s="text",void 0!==m){var u=t.find(".mmlmodule"+m);u.find(".searchfld").addClass("mmldrop").removeAttr("disabled"),u.css("display","block")}}else h.hide();t.find(".searchcond").removeClass("searchcondition").parent().hide();var f=null;if(Search.isScoreRuleField(e.val())&&(s="boolean"),"true"===l&&("text"===s||"num"===s||"date"===s||"datetime"===s)||"true"===o&&"text"===s){var v="enc_"+("datetime"===s?"date":t.find("#searchfield").find("option:selected").attr("currency")?"text":s);f=t.find("#"+v+"condition").css("display","block").find("select")}else f=t.find("#"+s+"condition").css("display","block").find("select");if(!f.length){if("user"===(v=Search.typeVsCondMap[s]?Search.typeVsCondMap[s]:"default")){var g=Lyte.Router.getRouteInstance().routeName;v=(g.indexOf("create-custom-view")>-1||g.indexOf("edit-custom-view")>-1||g.indexOf("clone-custom-view")>-1)&&("SHAREDTO"!==c||"Events"!==n.attr("module"))||g.indexOf("territor")>-1&&Crm.userDetails.isRGCTerritoryEnabled?v:"default"}f="picklist"===s&&"STAGE"===n.attr("col")&&"Potentials"===n.attr("module")?t.find("#stagecond").css("display","block").find("select"):t.find("#"+v+"condition").css("display","block").find("select")}f.addClass("searchcondition").removeAttr("disabled");var S=-1;if(f[0]&&f[0].options&&f[0].options.forEach(((e,t)=>{"include_all"===e.value&&(S=t)})),Search.supportMSPOption&&"multiselectpicklist"===s&&f[0]&&f[0].options&&-1===S){var C=new Option(I18n.getMsg("includes all"),"include_all"),y=new Option(I18n.getMsg("include any"),"include_any"),I=new Option(I18n.getMsg("excludes all"),"exclude_all"),T=new Option(I18n.getMsg("exclude any"),"exclude_any");f[0].add(C,f[0].options[7]),f[0].add(y,f[0].options[8]),f[0].add(I,f[0].options[9]),f[0].add(T,f[0].options[10]),f.val("None").trigger("change.select2")}else"multiselectpicklist"!==s&&f[0]&&f[0].options&&-1!==S&&(f[0].options[7].remove(),f[0].options[7].remove(),f[0].options[7].remove(),f[0].options[7].remove(),f.val("None").trigger("change.select2"));var b=n.attr("module");if(f[0].options&&"Competitor Mentions"===b&&("POSITIVE_COMPETITORS"===c||"NEGATIVE_COMPETITORS"===c||"NEUTRAL_COMPETITORS"===c||"OVERALL_COMPETITORS"===c)){var x=-1,w=-1;f[0].options.forEach(((e,t)=>{"starts_with"===e.value&&(x=t)})),x>-1&&f[0].options[x].remove(),f[0].options.forEach(((e,t)=>{"ends_with"===e.value&&(w=t)})),w>-1&&f[0].options[w].remove()}var _=t.find("#searchValue");switch(_.val(""),s){case"ownerlookup":case"U":var E=t.find(".userNameObj"),O=$("#previousSelectedValue"+i),N=O.val();"workflowRules"===d&&"Notes"===b&&(b=wfNew.mainMod);var L=moduleRecordMapping[b]&&"team_based"===moduleRecordMapping[b].access_type&&Search.liteUserSupportFeatures.includes(d),D=N&&N.indexOf("SMCREATORID")>-1||N.indexOf("MODIFIEDBY")>-1||O&&O.attr("includeLiteUser"),M=L||c&&(c.indexOf("SMCREATORID")>-1||c.indexOf("MODIFIEDBY")>-1);if("blueprint"===d&&L&&void 0===InfoForDisplayWithLiteUsers&&loadDataForDisplayAndMentions(!1,!0,void 0,void 0,void 0,L),0===E.length||D&&!M||!D&&M||L){var R={id:"temper_searchuser"+a,zcqa:"temp_searchuser"+a,class:"userNameObj multiuserDD",queryparam:c&&(c.indexOf("SMCREATORID")>-1||c.indexOf("MODIFIEDBY")>-1)||L?{include_lite_users:!0}:{},placeholder:I18n.getMsg("crm.label.select.user"),selectedUsers:"",selectedNames:"",fieldId:"searchValue",style:"height:auto; width:350px; display:none; background:white;"},k="#userComponentDiv"+i+"_"+a;0===$(k).length&&(k="#"+(k=E[0].parentElement.id)),$(k)[0].innerHTML="",Lyte.Component.render("crm-multiuserdd-wrapper",R,k),E=t.find(".userNameObj")}k="temp_searchuser"+i+t.attr("data-index");t.find("#"+k).length||(E.attr("id",k).css("display","block"),t.find(".lookUpSearch").attr("id","hostSearch_"+k)),_.hide();var A=document.getElementById(E.attr("id"));E&&M?A.setData("queryparam",{include_lite_users:!0}):A.setData("queryparam",{}),O.val(c),O.attr("includeLiteUser",L);break;case"text":case"T":"none"==e.val()&&f.attr("disabled","disabled").val("None").trigger("change.select2")}"tag"==s&&(Search.tagVal=1!=Search.tagLoad),Search.supportMSPOption&&f.on("select2:opening",(function(){Search.hideIncludeExcludeComp($(this))})),Search.changeCondition(f)},Search.hideIncludeExcludeComp=function(e){if(Crm.userDetails.multiSelectFilterOptions&&Search.supportMSPOption)for(var t=Search.getIncludeExcludeCount(e),a=e[0].length,r=e.closest("tr")[0].id,i=!Search.countOfIncludeExcludeCond.has(r),n=0;n<a;n++){var s=$(e[0].options[n]).val(),l=new Option(I18n.getMsg("includes all"),"include_all"),o=new Option(I18n.getMsg("include any"),"include_any"),c=new Option(I18n.getMsg("excludes all"),"exclude_all"),d=new Option(I18n.getMsg("exclude any"),"exclude_any"),m="include_all"===s?l:"include_any"===s?o:"exclude_all"===s?c:"exclude_any"===s?d:m;"include_all"!==s&&"include_any"!==s&&"exclude_all"!==s&&"exclude_any"!==s||(i&&t>=Search.include_exclude_comparator_limit?(e[0].options[n].remove(),$(m).prop("disabled",!0).attr("title",I18n.getMsg("crm.multi.select.field.filter.limit.reached.tooltip1",Search.include_exclude_comparator_limit)),e[0].add(m,e[0].options[n])):i&&(e[0].options[n].remove(),e[0].add(m,e[0].options[n])))}},Search.getIncludeExcludeCount=function(){for(var e=0,t=$(".wf_slideDownUp_Div select#textcondition.searchcond.searchcondition.select2-hidden-accessible"),a=t.length,r=0;r<a;r++){var i=t.eq(r).val();"include_all"!==i&&"include_any"!==i&&"exclude_all"!==i&&"exclude_any"!==i||e++}return e},Search.changeCondition=function(e,t){t=void 0!==t?t:"";var a=(e=$(e)).closest(".searchcrt"),r=a.find("#searchValue");r.val(t).css("display","block").removeAttr("readonly").removeAttr("placeholder").addClass("w342").removeAttr("maxlength");var i=r.closest("#searchval_div");i.find("span.select2, .dateTimeFlds, #endTimeFields, #endNumFields, #campCvLookup, #temp_searchcampcv, #currencyCode, .userNameObj").hide();var n=e.closest(".newSrchView").eq(0).attr("id"),s=n.substring(n.indexOf("w")+1),l=a.find("#searchfield"),o=l.find("option:selected"),c=o.attr("id"),d=o.attr("datatype");a.find("#ageindayscond, #lengthconddiv").hide();var m=e.val(),p=e.closest("tr")[0].id;"include_all"===m||"include_any"===m||"exclude_all"===m||"exclude_any"===m?Search.countOfIncludeExcludeCond.add(p):Search.countOfIncludeExcludeCond.delete(p);var h=o.attr("ind");if("multimodulelookup"===c){var u=a.find(".mmlmodule"+h),f=a.find(".mmlInText"),v=u.find("option:selected").attr("value"),g=u.find(".searchfld"),S=g.children().first().attr("value");void 0===v&&g.val(S),"${EMPTY}"===m||"${NOTEMPTY}"===m?(u.hide(),f.hide()):(f.css("display","table-cell"),u.css("display","block"))}if("tag"==c&&("${EMPTY}"==m||"${NOTEMPTY}"==m||"equal"==m&&0==Search.tagVal)&&(m="None"),"predefined"==c&&(e.val(o.attr("comparator")),r.val(o.attr("val")),m=o.attr("comparator")),m&&"None"!==m&&!Search.defaultFilters.contains(m))if(m!==Search.ageCrt&&m!==Search.dueCrt)if(Search.isScoreRuleField(l.val()))Search.showPicklistOptions(!1,c,t,l.val(),a,s);else switch(c){case"picklist":case"multiselectpicklist":case"layout":case"W":case"tag":case"boolean":case"ActivityType":case"ServiceStatus":case"consent":case"Role":case"Profile":Search.showPicklistOptions(!1,c,t,l.val(),a,s);break;case"datetime":i.find(".dateTimeFlds").css("display","block");case"date":if(r.attr("placeholder",Crm.userDetails.DATE_PATTERN).removeClass("w342").addClass("datewidth"),"between"===m||"not_between"===m){var C=a.find("#endTimeFields");if(C.css("display","block"),t){var y="",I="";if("[object Array]"!=Object.prototype.toString.call(t)){for(var T=t.split(","),b=T.length,x=0;x<b;x++)x<b/2?y+=T[x]+",":I+=T[x]+",";y=y.substring(0,y.length-1),I=I.substring(0,I.length-1)}else y=t[0],I=t[1];Search.populateDateTimeValues(I,c,C),t=y}}t&&Search.populateDateTimeValues(t,c,i);break;case"CML":i.find("#campCvLookup, #temp_searchcampcv").css("display","block"),$(".camp_lkp_obj").removeClass("camp_lkp_obj"),r.attr("readonly","readonly").addClass("camp_lkp_obj").hide();var w=i.find("#temp_searchcampcv").val("");t&&(t="object"!=typeof t?JSON.parse(t):t,r.val(Object.keys(t).join(",")),w.val(Object.keys(t).map((function(e){return t[e]})).join(",")));break;case"U":var _=a.find(".userNameObj");_.css("display","block");var E=_.attr("id"),O=document.getElementById(E);if(O){var N=O.component;N.setData("selectedNames",""),N.setData("selectedUsers","[]"),N.setData("usersRecord",[]),N.setData("roleRecords",[]),N.setData("selectedRoles","");var L=e.val();L&&["equal_role","not_equal_role","equal_group"].indexOf(L)>-1?(N.setData("isRoleComponent",!0),N.setData("roleRequestModel",L.indexOf("group")>-1?"user_group":"role")):N.setData("isRoleComponent",!1)}t?Search.populateUserConditionValues(t,void 0,_):_.children("ul").children("input").attr("placeholder",I18n.getMsg("crm.label.select.user")),r.hide();break;case"cs":r.attr("readonly","readonly").val(e.find("option:selected").text());break;case"num":case"duration":if(r.attr("maxlength","18"),"bigint"===d&&r.attr("maxlength","19"),!Search.defaultFilters.contains(m)&&a.find("#searchfield").find("option:selected").attr("currency")&&i.find("#currencyCode").css("display","block"),"between"===m||"not_between"===m){r.removeClass("w342");var D="duration"==c?I18n.getMsg("crm.label.in.minutes",I18n.getMsg("crm.gcal.from")):I18n.getMsg("crm.gcal.from"),M="duration"==c?I18n.getMsg("crm.label.in.minutes",I18n.getMsg("crm.gcal.capsto")):I18n.getMsg("crm.gcal.capsto");r.attr("placeholder",D),t?(t=-1!==t.indexOf("~")?"[object Array]"!==Object.prototype.toString.call(t)?t.split("~"):t:"[object Array]"!=Object.prototype.toString.call(t)?t.split(","):t,r.val(t[0]),a.find("#endNumFields").css("display","block").find("#searchEndValue").val(t[1]).attr("maxlength","18").removeAttr("readonly")):a.find("#endNumFields").css("display","block").find("#searchEndValue").val("").attr("maxlength","18").removeAttr("readonly").attr("placeholder",M)}else a.find("#endNumFields").hide(),"duration"==c&&r.attr("placeholder",I18n.getMsg("crm.label.type.minutes"));break;case"text":if(m===Search.noOfChar){a.find("#lengthconddiv").css("display","block");var R=a.find("#lengthcondition").val();r.attr("maxlength","20"),"between"===R||"not_between"===R?(r.removeClass("w342"),r.attr("placeholder",I18n.getMsg("crm.gcal.from")),t?(t="[object Array]"!=Object.prototype.toString.call(t)?t.split(","):t,r.val(t[0]),a.find("#endNumFields").css("display","block").find("#searchEndValue").val(t[1]).attr("maxlength","20").removeAttr("readonly")):a.find("#endNumFields").css("display","block").find("#searchEndValue").val("").attr("maxlength","20").removeAttr("readonly").attr("placeholder",I18n.getMsg("crm.gcal.capsto"))):a.find("#endNumFields").css("display","none")}break;case"predefined":r.hide(),e.parent().hide()}else a.find("#ageindayscond").css("display","block");else{if(r.attr("readonly","readonly"),"tag"==c&&(m=e.val()),!("picklist"!==c&&"stagecond"!==c||"${OPEN}"!==m&&"${CLOSEDWON}"!==m&&"${CLOSEDLOST}"!==m)){switch(m){case"${OPEN}":r.val("${"+I18n.getMsg("crm.potential.all.open")+"}");break;case"${CLOSEDWON}":r.val("${"+I18n.getMsg("crm.potential.all.won")+"}");break;case"${CLOSEDLOST}":r.val("${"+I18n.getMsg("crm.potential.all.lost")+"}")}return}Search.defaultFilters.contains(m)&&r.val(m)}},Search.changeNOCCondition=function(e,t){var a=(e=$(e)).closest(".searchcrt"),r=a.find("#searchValue");r.val(""),r.parent().find("#endNumFields").hide(),r.attr("maxlength","20");var i=e.val();"between"===i||"not_between"===i?(r.attr("maxlength","20").removeClass("w342"),r.attr("placeholder",I18n.getMsg("crm.gcal.from")),t?(t="[object Array]"!=Object.prototype.toString.call(t)?t.split(","):t,r.val(t[0].trim().substring(5,t[0].trim().lastIndexOf("}"))),a.find("#endNumFields").show().find("#searchEndValue").val(t[1].trim().substring(5,t[1].trim().lastIndexOf("}"))).attr("maxlength","20").removeAttr("readonly")):a.find("#endNumFields").show().find("#searchEndValue").val("").attr("maxlength","20").removeAttr("readonly").attr("placeholder",I18n.getMsg("crm.gcal.capsto"))):t?(r.val(t.substring(5,t.lastIndexOf("}"))),a.find("#endNumFields").hide()):(r.addClass("w342"),r.removeAttr("placeholder"))},Search.addCriteria_new=function(e,t,a,r,i,n){var s=$("#searchlayer_new"+n),l=$("#criteriaDiv"+n),o=s.find("tr.searchcrt"),c=$(".validationRuleCongureWarningMsg");if(o.length>=e)return Search.isVRCriteria?c.text(I18n.getMsg("crm.criteria.max.rowcnt.exceeds")).css("display","block"):renderingUtils.showCustomAlert(I18n.getMsg("crm.criteria.max.rowcnt.exceeds","")),!1;var d=s.find("#newpattern"+n)[0],m=s.find(".criPatternTab")[0];if(d&&"block"===d.style.display&&m&&"none"!==m.style.display)return Search.isVRCriteria?c.text(I18n.getMsg("crm.alert.label.savepattern")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.label.savepattern","")),!1;i||(i=o.eq(o.length-1).find("#addRow"));var p=(i=$(i)).closest("tr.searchcrt"),h=(a=parseInt(p.attr("data-index"))+1)+1;p.nextAll(".searchcrt").each((function(){$(this).attr("data-index",h).attr("id","searchcriteria"+h),$(this).find(".searchMatchText").val(h),h++})),p.after('<tr id="searchcrt'+a+'" class="searchcrt" data-index="'+a+'"></tr>');var u=s.find("#searchcrt"+a);u.html(l.find("#searchcriteria0").html());var f=u.find(".mmlmodule0").parent().children();f.each((function(){f.hide()})),u.find("#currencyCode").after('<input type="text" class="w342 newinputText fL searchdate" id="searchValue" class="searchvalue" readonly="readonly" onpaste="return Search.handleSearchValPaste(this,event);"><div id="userComponentDiv'+n+"_"+a+'" class="autocompleteselector"></div>');var v=$L("#noReviewerinSLA");if(null!=v&&0!=v.length&&v[0].getData("ltPropShow")&&document.querySelector("#noReviewerinSLA").alignPopover(),"undefined"!=typeof ProcessBuilder&&ProcessBuilder.colNameToValidate&&""!==ProcessBuilder.colNameToValidate&&(u.find("#searchfield").eq(0).val(ProcessBuilder.colNameToValidate).trigger("change"),u.find("#searchfield").eq(0).attr("disabled",!0)),u.find(".searchMatchText").val(a),"true"==s.attr("hideOperator")){var g=$("#crtoperator"+n).val();u.find(".searchMatch").val(g)}if(Search.afterRenderCriteria(u),Search.addRowformPattern_new(u,a,n),"true"!=s.attr("hideOperator")&&u.parent().find(".criPatternTab").css("display",""),i.hide(),i.prev(".removeCriteria").css("display","block"),$("#validationRuleRightSection").length&&CVRCust.setpostCenterPopup(),$("#wfCriteriaActionsDIV").length>0){var S=n.split("_")[2];workflow.setWtHt("criEditSum_"+S,"criteriaBg_"+S)}return Search.addSelect2ListenerForEmailFields(n,o),u},Search.addSelect2ListenerForEmailFields=function(e){try{if("undefined"!=typeof wfNew&&wfNew&&"Emails"===wfNew.getWFRuleModule()){e=e.replace("main_","");setTimeout((function(){"Emails"===wfNew.getWFRuleModule()&&$("#searchlayer_new_main"+e).find(".searchcrt").find(".searchfld").select2({templateResult:function(t){if(t.element){var a=t.element.getAttribute("col");return"OutgoingEmail"!==wfNew.maintrigName&&!wfNew.selectedTrigger.includes("Outgoing")||"SE_STATUS"!==a&&"FILEID"!==a?"OutgoingMailNotOpened"!==wfNew.selectedTrigger&&"OutgoingMailBounced"!==wfNew.selectedTrigger&&"OutgoingMailNotOpened"!==wfNew.selectedTrigger&&"OutgoingMailSentNotReplied"!==wfNew.selectedTrigger&&"OutgoingMailOpenedNotReplied"!==wfNew.selectedTrigger&&"OutgoingMailClicked"!==wfNew.selectedTrigger&&"OutgoingMailOpened"!==wfNew.selectedTrigger&&"EmailReceived"!==wfNew.selectedTrigger&&"EmailReceivedNotReplied"!==wfNew.selectedTrigger&&"EmailReceivedOpenNotReplied"!==wfNew.selectedTrigger&&"Potentials"!==$("#relcrtModule"+e).val()||"SETYPE"!==a?"OutgoingMailClicked"!==wfNew.selectedTrigger&&"BODY"===a?(setTimeout((function(){$(".select2-results__option").each((function(){this.id&&this.id.includes("Link")&&this.remove()}),1e3)})),null):t.text:(setTimeout((function(){$(".select2-results__option").each((function(){this.id&&this.id.includes("Sent_From")&&this.remove()}),1e3)})),null):(setTimeout((function(){$(".select2-results__option").each((function(){this.id&&this.id.includes("Email_Properties")&&this.remove(),this.id&&(this.id.includes("Email_Sentiment")||this.id.includes("Email_Intent"))&&"EmailReceived"!==wfNew.selectedTrigger&&"EmailReceivedNotReplied"!==wfNew.selectedTrigger&&"EmailReceivedOpenNotReplied"!==wfNew.selectedTrigger&&this.remove(),this.id&&(this.id.includes("Email_Sentiment")||this.id.includes("Email_Intent"))&&!wfNew.isMailAppsUser&&this.remove()}),1e3)})),null)}}})}),800)}}catch(e){murphy.error(e)}},Search.addRowformPattern_new=function(e,t,a){a=void 0!==a?a:"";var r=e.closest("#searchlayer_new"+a).find("#pattern"+a),i=r.html(),n="and";t>=2&&(n=e.find(".searchMatch").val()),i="( "+i+" "+(n=I18n.getMsg(n))+" "+t+" )",r.html(i),i=i.split(" ").join("");var s=Search.replaceAndOr(i);s=this.addSpaceBetweenParanthesis(s),e.closest("#searchlayer_new"+a).find("#patternVal"+a).val(s).text(s)},Search.select2templateResultSearchFld=function(e,t){if(e.element){var a=$(e.element);if(a.hasClass("hide")&&$(t).addClass("hide"),a.attr("tooltip")){var r=a.attr("tooltip");$(t).mouseover((function(){crmui.showTooltip({content:r,position:"left"})})),$(t).mouseleave((function(){crmui.hideTooltip()}))}}return thirdPartyUtils.selectTempResult(e,t)},Search.afterRenderCriteria=function(e){e||(e=$("#searchcrt1.searchcrt"));var t=(e=$(e)).find("#searchValue");t.off("click").on("click",(function(){Search.handleSearchValClick(this)})),t.off("keypress").on("keypress",(function(e){return Search.handleSearchValKeyPress(this,e)})),e.find("#searchEndValue").off("keypress").on("keypress",(function(e){return Search.handleSearchValKeyPress(this,e)})),setTimeout((function(){thirdPartyUtils.bindSelect2(e.find(".wf_chosen_ui select").not(".searchfld"));var t="true"==e.closest("table").attr("hideOperator"),a={};a.templateResult=Search.select2templateResultSearchFld,t&&(a.onOpenCallback="Search.hideSelectedPredefinedOptions",a.afterOpenCallback="Search.select2searchFldAfterOpen"),thirdPartyUtils.bindSelect2(e.find(".wf_chosen_ui select.searchfld"),a),populateTimeVal(e.find(".ddTime"))}),100),e.find(".lookUpSearch").each((function(){Search.assignEnter($(this)),Search.assignOn($(this))}))},Search.hideSelectedPredefinedOptions=function(e){var t=e.find("option");t.removeClass("hide");var a=e[0].value,r=e.closest("table").find(".searchfld"),i=($(".select2-results__options"),r.find("option[id='predefined']:selected"));if(i.length>0){for(var n=e.find("option[id='predefined']").length,s=0,l=i.length,o=0;o<l;o++){var c=i[o].value;c!=a&&(t.filter("[value='"+c+"']").addClass("hide"),s++)}s==n&&t.filter("[value=predefinedseparator]").addClass("hide")}},Search.select2searchFldAfterOpen=function(){$(".select2-search__field").attr("onkeyup","Search.appendNoResultsDIVOnSearch()")},Search.appendNoResultsDIVOnSearch=function(){var e=$(".select2-results__options");e.find("li:visible").length<1&&$("<li role='treeitem' aria-live='assertive' class='select2-results__option select2-results__message'>"+I18n.getMsg("crm.label.no.options.found")+"</li>").appendTo(e)},Search.changeOprValPattern_new=function(e,t){e=$(e),t=void 0!==t?t:"";var a=$("#searchlayer_new"+t),r=a.find("#patternVal"+t),i=e.val(),n=I18n.getProperties(),s=a.find("#newpattern"+t)[0];if(s&&"block"===s.style.display)return Search.isVRCriteria?$(".validationRuleCongureWarningMsg").text(I18n.getMsg("crm.alert.label.savepattern")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.label.savepattern")),!1;var l=parseInt(e.closest("tr.searchcrt").attr("data-index")),o=r.val(),c=o.indexOf(l),d="or"==i?"and":"or",m=o.substr(0,c).lastIndexOf(d);o=o.substr(0,m)+i+o.substr(m+d.length,o.length),r.val(o),r.text(o);var p=o.replace(new RegExp("and","g"),n.and).replace(new RegExp("or","g"),n.or);a.find("#pattern"+t).html(p)},Search.replaceOprValPattern_new=function(e,t){$("#criteriaDiv"+e).find(".searchMatch").val(t);var a=$("#patternVal"+e),r=a.val().replace(/and/g,t).replace(/or/g,t);a.val(r);var i=I18n.getProperties(),n=r.replace(new RegExp("and","g"),i.and).replace(new RegExp("or","g"),i.or);$("#pattern"+e).html(n)},Search.handleSearchValClick=function(e){var t=$(e),a=t.closest("tr.searchcrt"),r=a.find("#searchfield").find("option:selected").attr("id"),i=a.find(".searchcondition").val();switch(r){case"D":case"DT":case"datetime":case"date":i!==Search.ageCrt&&i!==Search.dueCrt&&showCalen(void 0,void 0,void 0,void 0,!0,t);break;case"CML":Search.campLookup_new(t)}},Search.handleSearchValKeyPress=function(e,t){var a=$(e).closest("tr.searchcrt"),r=a.find("#searchfield").find("option:selected").attr("id"),i=a.find(".searchcondition").val();return"N"===r||i===Search.ageCrt||i===Search.dueCrt||i===Search.noOfChar||"num"===r||"duration"===r?Search.numCheck(e,t,i===Search.ageCrt||i===Search.dueCrt):"T"===r||"text"===r?Search.limitTextValues(e,t,!0):void 0},Search.handleSearchValPaste=function(e,t){var a=$(e).closest("tr.searchcrt"),r=a.find("#searchfield").find("option:selected").attr("id"),i=a.find(".searchcondition").val();return"N"===r||i===Search.ageCrt||i===Search.dueCrt||"num"===r||"duration"===r?Search.numCheck(e,t):"T"===r||"text"===r?Search.limitTextValues(e,t,!0):void 0},Search.removeCriteria_new=function(e,t){e=$(e),Search.isVRCriteria&&$(".validationRuleCongureWarningMsg").hide();var a=$("#newpattern"+t)[0],r=$(".criPatternTab")[0];if(a&&"block"===a.style.display&&r&&"none"!==r.style.display)return Search.isVRCriteria?validationObj.text(I18n.getMsg("crm.alert.label.savepattern")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.label.savepattern","")),!1;var i=e.closest(".searchcrt");Search.countOfIncludeExcludeCond.clear();var n=parseInt(i.attr("data-index")),s=n;i.nextAll(".searchcrt").each((function(){$(this).attr("data-index",n).attr("id","searchcrt"+n),$(this).find(".searchMatchText").val(n),$(this).find(".autocompleteselector").attr("id","userComponentDiv"+t+"_"+n),$(this).find(".userNameObj").attr("id","temp_search_"+n),1===n&&$(this).find("div.andOrOp").remove(),n++})),e.parent().find(".addCriteria:visible").length&&i.prev(".searchcrt").find(".addCriteria").show();var l=i.closest(".newSrchView");i.remove();for(var o=$(".wf_slideDownUp_Div select#textcondition.searchcond.searchcondition.select2-hidden-accessible"),c=o.length,d=0;d<c;d++){var m=o.eq(d),p=m.val();i=m.closest(".searchcrt");if("include_all"===p||"include_any"===p||"exclude_all"===p||"exclude_any"===p){var h=i[0].id;Search.countOfIncludeExcludeCond.add(h)}}if($("#validationRuleRightSection").length&&CVRCust.setpostCenterPopup(),l.find(".searchcrt").length<2&&(l.find(".criPatternTab").hide(),l.find(".searchcrt").find(".removeCriteria").hide()),Search.delRowFormPattern(void 0,t,s),$("#wfCriteriaActionsDIV").length>0){var u=t.split("_")[2];workflow.setWtHt("criEditSum_"+u,"criteriaBg_"+u)}var f=$L("#noReviewerinSLA");null!=f&&0!=f.length&&f[0].getData("ltPropShow")&&document.querySelector("#noReviewerinSLA").alignPopover()},Search.showPicklistOptions=function(e,t,a,r,i,n){r||(r=i.find("#searchfield").val());var s=r.split("."),l=r.substr(0,r.lastIndexOf(".")),o=s[s.length-1],c="search_"+l+"_"+o,d=i.find("#"+$.escapeSelector(c));i.find("#searchValue").hide();var m="boolean"==t?"true":"",p=i.closest("#searchlayer_new"+n).find("#searchfield").find('option[value="'+r+'"]').data("params");if(p&&Search.isScoreRuleField(r)&&(m=p[0].id),d.length)d.val(m).trigger("change.select2"),d.next("span").show();else if("multiselectpicklist"!==t&&i.closest("#searchlayer_new"+n).find("#"+c).length)(d=i.closest("#searchlayer_new"+n).find("#"+c).clone().val(m).removeAttr("class")).addClass("criSelctField"),i.find("#searchval_div").append(d),thirdPartyUtils.bindSelect2(d),i.find("#searchValue").val(m);else{var h=$(i.find(".chosen-select"));h.length>0&&(h=h[0]).getAttribute("id").indexOf("Tag")>0&&h.remove(),Search.createPicklistOptions(l,o,t,a,i,p)}null!=a&&"boolean"==typeof a&&(a=a?"true":"false"),a&&d&&d.length&&Search.setSelectedPicklistValues(a,d,t)},Search.setSelectedPicklistValues=function(e,t,a){if(e){var r="layout"===a||"W"===a,i=[];if(e.indexOf("\\")>-1){for(var n=new RegExp(/(?:[^\\])\,/g),s=null,l=0;null!==(s=n.exec(e));)i[i.length]=e.slice(l,s.index+1).replace(/\\/g,""),l=s.index+2;i[i.length]=e.slice(l).replace(/\\/g,"")}else i=$.isArray(e)?e:e.split(",");if(e.indexOf("\\")>-1){for(n=new RegExp(/(?:[^\\])\,/g),s=null,l=0;null!==(s=n.exec(e));)i[i.length]=e.slice(l,s.index+1).replace(/\\/g,""),l=s.index+2;i[i.length]=e.slice(l).replace(/\\/g,"")}else i=r?"object"!=typeof i?JSON.parse(i):i:e.split(",");if(r)for(var o=null,c=null,d=i.length,m=0;m<d;m++){var p=i[m];if("object"==typeof p?c=p[o=Object.keys(p)[0]]:(o=p,c=p),!t.find("option[value='"+o+"']").length)(h=document.createElement("option")).setAttribute("value",o),h.innerHTML=c,t[0].appendChild(h);t.find("option[value='"+o+"']").prop("selected",!0).trigger("change.select2")}else for(d=i.length,m=0;m<d;m++){var h,u=i[m];if(!t.find("option[value='"+$.escapeSelector(u)+"']").length)(h=document.createElement("option")).setAttribute("value",u),h.innerHTML=$ESAPI.encoder().encodeForHTML(u),t[0].appendChild(h);t.find("option[value='"+$.escapeSelector(u)+"']").prop("selected",!0).trigger("change.select2")}}},Search.createPicklistOptions=function(e,t,a,r,i,n){var s=i.find("#searchValue"),l=i.closest(".crtEditorDiv"),o=s.parent(),c="Competitor Mentions"===e&&["crmcompetitormentions_positive_competitors__s","crmcompetitormentions_negative_competitors__s","crmcompetitormentions_neutral_competitors__s","crmcompetitormentions_overall_competitors__s"].includes(t),d=!1;("Entity Scores"===e&&(n?d=!0:(n=[]).push("-None-")),n)||("picklist"===a||"multiselectpicklist"===a||"layout"===a||"L"===a||"ServiceStatus"===a?((n=Crm.jsonSelectValues[e]?Crm.jsonSelectValues[e][t]:void 0)||"Tasks"!=e||(n=Crm.jsonSelectValues.Calls[t]),n||"picklist"!==a&&"multiselectpicklist"!==a||(n=[]).push("-None-")):"B"==a||"boolean"==a?(d=!0,n=[{true:I18n.getMsg("crm.label.selected")},{false:I18n.getMsg("crm.label.notSelected")}]):"ActivityType"==a?n=[{Tasks:I18n.getMsg("Tasks")},{Calls:I18n.getMsg("Calls")},{Events:I18n.getMsg(Crm.getModuleDisplayName(!1,!0,!0))}]:"tag"!=a&&"W"!==a||(n=[]).push("-None-"));if(n){var m=document.createElement("select");-1!==["tag","L","W","layout","Role","Profile","ActivityType"].indexOf(a)||"Entity Scores"===e||c?$(m).attr({id:"search_"+e+"_"+t,class:"chosen-select",onchange:"Search.changeInputValue_new(this);",style:"width:358px",multiple:!d}):$(m).attr({id:"search_"+e+"_"+t,class:"chosen-select",onchange:"Search.changeInputValue_new(this);",style:"width:358px",multiple:!d,"data-tags":!d});var p="layout"===a||"L"===a;!e&&l.length&&l.data("selectedModule")&&(e=l.data("selectedModule"));var h=crmTab.isZBCustomModule(e)||crmTab.isZSCustomModule(e);if(n.layout_jsonarrayObj&&p)for(var u={},f=(n=Crm.jsonSelectValues[e][t].layout_jsonarrayObj).length,v=0;v<f;v++){var g=n[v];u[g.LAYOUTID]=g.LAYOUTNAME,(y=document.createElement("option")).setAttribute("value",g.LAYOUTID),y.innerHTML=g.LAYOUTNAME,m.appendChild(y)}else{u=void 0;var S=h&&null!=Crm.jsonSelectValues[e+"_pickListValues"]?Crm.jsonSelectValues[e+"_pickListValues"][t]:null;for(f=h?Object.keys(n).length:n.length,v=0;v<f;v++){if(h&&"boolean"!==a)(C={}).id=Object.keys(n)[v],C.name=n[Object.keys(n)[v]];else var C=n[v];if("-None-"!==C){var y=document.createElement("option");if("object"==typeof C){var I=null;C.id?(M=C.id,I=C.name):I=C[M=Object.keys(C)[0]],y.setAttribute("value",M),C.hasOwnProperty("color_code")&&y.setAttribute("color_code",C.color_code),y.innerHTML=$ESAPI.encoder().encodeForHTML(I)}else{var T=C.split("!@#");T.length>1?(y.setAttribute("value",T[0]),y.innerHTML=$ESAPI.encoder().encodeForHTML(T[1])):(y.setAttribute("value",C),y.innerHTML=$ESAPI.encoder().encodeForHTML(null!=S?S[C]:C))}m.appendChild(y)}}}$(m).addClass("criSelctField"),o[0].appendChild(m);var b=o.find(".chosen-select");if(s.val()){var x=s.val();if("B"===a||"boolean"==a){var w=i.find(".searchcondition").val();"is true"==w?x="true":"is false"==w&&(x="false")}var _=[];if(x=r||x){if(x.indexOf("\\")>-1){for(var E=new RegExp(/(?:[^\\])\,/g),O=null,N=0;null!==(O=E.exec(x));)_[_.length]=x.slice(N,O.index+1).replace(/\\/g,""),N=O.index+2;_[_.length]=x.slice(N).replace(/\\/g,"")}else _=$.isArray(x)?x:x.split(",");if(u&&p){f=_.length;for(var L=0;L<f;L++)b.find("option[value='"+_[L]+"']").prop("selected",!0).trigger("change.select2")}else if(p){var D=Crm.existingLayoutValues,M=null;for(f=_.length,L=0;L<f;L++){if(M=_[L],!b.find("option[value='"+_[L]+"']").length&&D&&D[M])(y=document.createElement("option")).setAttribute("value",_[L]),y.innerHTML=D[M],m.appendChild(y);b.find("option[value='"+_[L]+"']").prop("selected",!0).trigger("change.select2")}}else if("tag"==a)for(f=_.length,L=0;L<f;L++)b.find("option[value='"+$.escapeSelector(_[L])+"']").prop("selected",!0).trigger("change.select2");else for(f=_.length,L=0;L<f;L++){if(h){if(!Object.keys(n).contains(_[L]))(y=document.createElement("option")).setAttribute("value",_[L]),y.innerHTML=$ESAPI.encoder().encodeForHTML(_[L]),m.appendChild(y)}else if(!n.contains(_[L])){(y=document.createElement("option")).setAttribute("value",_[L]),y.innerHTML=$ESAPI.encoder().encodeForHTML(_[L]),m.appendChild(y)}b.find("option[value='"+$.escapeSelector(_[L])+"']").prop("selected",!0).trigger("change.select2")}}}thirdPartyUtils.bindSelect2(m),o.find("select").on("select2:selecting",(function(){var e=$(this),t=e.attr("id"),a=e.val(),r=e.closest(".searchcrt"),i=r.find(".searchcond"),n=r[0].id,s=$("#"+n+" #searchfield").find("option:selected").attr("id"),l=i.val(),o=Search.maxValuesForTextCond;if("multiselectpicklist"!==s||"include_all"!==l&&"include_any"!==l&&"exclude_all"!==l&&"exclude_any"!==l||(o=Search.include_exclude_values_limit),a&&a.length>=o)return Search.isVRCriteria?$(".validationRuleCongureWarningMsg").text(I18n.getMsg("crm.alert.maximum.text.values.contains",o.toString())).css("display","block"):_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.alert.maximum.text.values.contains",o.toString()),ltPropButtonPosition:"center"}}),e.select2("close"),!1;$('input[name="'+t+'"]').removeAttr("data-isdef")})),d&&s.val($(m).val())}},Search.changeInputValue_new=function(e){var t=(e=$(e)).val()?e.val():"";if("object"==typeof t)if(t.length){if(""!=t[0]){for(var a=t[0].replace(/,/g,"\\,"),r=t.length,i=1;i<r;i++)""!=t[i]&&(a=a+","+t[i].replace(/,/g,"\\,"));t=a}}else t="";if(e.parent().find("#searchValue").val(t),$("#wfCriteriaActionsDIV").length>0){var n=e.closest(".newApCriteriaTable").attr("id").split("_");n="_"+n[3],workflow.setWtHt("criEditSum"+n,"criteriaBg"+n)}},Search.campLookup_new=function(e){showLookUp("temp_searchcampcv","searchcampcv","Campaign Name","Campaigns",null,null,null,null,null,null,null,null,$(e).closest(".searchcrt").find(".searchcondition").val().toString().replace("'","").replace(" ",""))},Search.getCriteriaObj=function(e,t,a,r,i){var n=$(".validationRuleCongureWarningMsg");if(Search.isVRCriteria&&e>CVRCust.maxCriteriaCnt)return n.text(I18n.getMsg("crm.criteria.editor.max.limit.exceed",CVRCust.maxCriteriaCnt)).show(),!1;var s=t.find("tr.searchcrt").length,l=t.find("tr").eq(e-1),o=l.find("#searchfield"),c=o.find("option:selected"),d=c.text(),m=c.attr("id"),p=c.attr("ind");"multimodulelookup"===m&&(m="text");var h,u=c.attr("datatype"),f=l.find(".searchcondition").val(),v=l.find("#searchValue"),g=void 0,S={};"undefined"!=typeof CVRCust&&Search.isVRCriteria&&CVRCust.fieldObj&&(g=CVRCust.fieldObj[o.val()]?CVRCust.fieldObj[o.val()]:CVRCust.excess_fieldObj[o.val()]);var C=v.val(),y=!1;"${EMPTY}"!==(C=C?C.trim():C)&&"${NOTEMPTY}"!==C||(y=!0);var I=l.find(".mmlmodule"+p).find("option:selected").attr("value");if("none"===o.val())return 1!=e||1!=s?(Search.isVRCriteria?n.text(I18n.getMsg("crm.criteria.fieldlabel.valid.check",e)).show():setTimeout((function(){renderingUtils.showCustomAlert(I18n.getMsg("crm.criteria.fieldlabel.valid.check",e+""))}),70),o.focus(),!1):{};if("None"===f)return Search.isVRCriteria?n.text(I18n.getMsg("crm.criteria.condition.valid.check",d)).show():setTimeout((function(){renderingUtils.showCustomAlert(I18n.getValueForFields("crm.criteria.condition.valid.check",d))}),70),!1;var T=!1;switch(m){case"CML":for(var b=C.split(","),x=l.find("#temp_searchcampcv").val().split(","),w=0;w<x.length;w++)S[b[w]]=x[w];break;case"datetime":var _=!0,E=l.find("#searchsthour").val()+":"+l.find("#searchstminute").val();"HH:mm"!==Crm.userDetails.TIME_FORMAT&&(E+=" "+l.find("#searchstampm").val());case"date":if(f!==Search.ageCrt&&f!==Search.dueCrt){if(!(Search.defaultFilters.contains(f)||C&&0==C.replace(/^\s+/g,"").replace(/\s+$/g,"").length||CrmDateUtils.dateValidate(void 0,d,"OTH",void 0,v[0],"custom")))return v.focus(),!1;if(_&&(C=C+" "+E),"between"===f||"not_between"===f){var O=l.find("#endTimeFields").find("#searchenddate"),N=0,L=0,D=0,M=0;if(!CrmDateUtils.dateValidate(void 0,d,"OTH",void 0,O[0],"custom"))return O.focus(),!1;var R=l.find("#searchenddate").val();if(_){N=l.find("#searchsthour").val(),L=l.find("#searchstminute").val();E=l.find("#searchethour").val()+":"+l.find("#searchetminute").val();if(D=l.find("#searchethour").val(),M=l.find("#searchetminute").val(),"HH:mm"!==Crm.userDetails.TIME_FORMAT){var k=l.find("#searchetampm").val();E+=" "+k,N=Utils.convertTimeTo24HoursFormat(parseInt(N),l.find("#searchstampm").val()),D=Utils.convertTimeTo24HoursFormat(parseInt(D),k)}R=R+" "+E}var A=Utils.getDateObject(C,{hrs:N,mins:L}),B=Utils.getDateObject(R,{hrs:D,mins:M});if(Utils.compareDateandTime(B,A))return renderingUtils.showCustomAlert(I18n.getMsg("crm.custom.field.less.than.equalto",[I18n.getMsg("workflow.option.webhookFailure.fromDate"),I18n.getMsg("workflow.option.webhookFailure.toDate")])),void v.focus();C=C+","+R}break}if(C!=parseInt(C))return renderingUtils.showCustomAlert(I18n.getMsg("crm.field.valid.check",d)),!1;case"num":case"duration":if("${EMPTY}"!==f&&"${NOTEMPTY}"!==f&&f!==Search.noOfChar){"between"!==f&&"not_between"!==f||(C=v.val());var F=Search.isVRCriteria?g.length:0;C=C.replace(/^\s+/g,"").replace(/\s+$/g,"");var P=c.data("decimal-length")?c.data("decimal-length"):2,U=new RegExp("^-?\\d+(,(\\d)+)*(\\.\\d{0,"+P+"})*$");if(isNaN(C)||!U.test(C)){T=!0;break}if(Search.isVRCriteria&&parseInt(C.length)>F)return v.focus(),void n.text(I18n.getMsg("crm.criteria.editor.no.of.digits.exceed",[g.display_label,F])).show();if(Search.isVRCriteria&&"Potentials.Probability"===o.val()&&parseInt(C)>100)return v.focus(),void n.text(I18n.getMsg("crm.criteria.editor.probability.value.exceed")).show();var V=l.find("#searchEndValue").val();if("bigint"===u)if(BigInt(C)>BigInt("9223372036854775807"))return v.focus(),void renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.limit.check",d));if("between"===f||"not_between"===f){if(V=V.replace(/^\s+/g,"").replace(/\s+$/g,""),isNaN(V)||!U.test(V)){T=!0;break}if(Search.isVRCriteria&&parseInt(V.length)>F)return l.find("#searchEndValue").focus(),void n.text(I18n.getMsg("crm.criteria.editor.no.of.digits.exceed",[g.display_label,F])).show();if(Search.isVRCriteria&&"Potentials.Probability"===o.val()&&parseInt(V)>100)return l.find("#searchEndValue").focus(),void n.text(I18n.getMsg("crm.criteria.editor.probability.value.exceed")).show();if(Search.isVRCriteria&&parseFloat(C)===parseFloat(V))return getObj("searchEndValue").focus(),Search.isVRCriteria?n.html(I18n.getMsg("crm.custom.field.value.not.same")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.custom.field.value.not.same")),!1;if(Search.isVRCriteria&&parseFloat(C)>parseFloat(V)||!Search.isVRCriteria&&!commonUtils.compareNumber(C,V))return l.find("#searchEndValue").focus(),void(Search.isVRCriteria?n.html(I18n.getMsg("crm.custom.field.less.than.to")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.custom.field.less.than.to1"),"",!0))}"between"!==f&&"not_between"!==f||(C=C+"~"+V)}break;case"text":if(","==C.trim()&&(T=!0),"near_to"===f){var H=$("#latlong");if(H.val()){var z=H.val().split(",");C=C+";"+z[1]+";"+z[0]}C=C+";"+$("#meter").val();break}if(f===Search.noOfChar){F=Search.isVRCriteria?g.length:0;C=C.replace(/^\s+/g,"").replace(/\s+$/g,"");U=/^-?\d+(,(\d)+)*(\.\d{1,2})*$/;if(isNaN(C)||!U.test(C)){T=!0;break}if(0===parseInt(C))return v.focus(),void(Search.isVRCriteria?n.text(I18n.getMsg("crm.criteria.editor.no.of.characters.error.msg")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.criteria.editor.no.of.characters.error.msg")));if(Search.isVRCriteria&&parseInt(C)>F)return v.focus(),void n.text(I18n.getMsg("crm.criteria.editor.no.of.characters.exceed",[g.display_label,F])).show();V=l.find("#searchEndValue").val();if("between"===l.find("#lengthcondition").val()||"not_between"===l.find("#lengthcondition").val()){if(V=V.replace(/^\s+/g,"").replace(/\s+$/g,""),isNaN(V)||!U.test(V)){T=!0;break}if(Search.isVRCriteria&&parseInt(V)>F)return l.find("#searchEndValue").focus(),void n.text(I18n.getMsg("crm.criteria.editor.no.of.characters.exceed",[g.display_label,F])).show();if(Search.isVRCriteria&&parseFloat(C)===parseFloat(V))return getObj("searchEndValue").focus(),Search.isVRCriteria?n.html(I18n.getMsg("crm.custom.field.value.not.same")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.custom.field.value.not.same")),!1;if(Search.isVRCriteria&&parseFloat(C)>parseFloat(V)||!Search.isVRCriteria&&!commonUtils.compareNumber(C,V))return l.find("#searchEndValue").focus(),void(Search.isVRCriteria?n.html(I18n.getMsg("crm.custom.field.less.than.to")).show():renderingUtils.showCustomAlert(I18n.getMsg("crm.custom.field.less.than.to"),"",!0))}}case"picklist":case"multiselectpicklist":case"layout":case"L":case"W":if(C&&0!=C.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&(C=C.replace(/^\s+/g,"").replace(/\s+$/g,"")).indexOf("*")>-1)return Search.isVRCriteria?n.text(I18n.getMsg("crm.alert.character.not.allowed",["*"])).show():setTimeout((function(){renderingUtils.showCustomAlert(I18n.getMsg("crm.alert.character.not.allowed",["*"]))}),70),v.focus(),!1;break;case"U":if(["equal_role","not_equal_role","equal_group"].indexOf(f)>-1){var Y=l.find("crm-multiuserdd-wrapper");(C=Y.length&&Y[0].component.data.usersRecord.length?Y[0].component.data.usersRecord.toString():"")&&(C=C.trim(),h=f.indexOf("role")>-1?o.val()+".role":o.val()+".group",f="not_equal_role"===f?"not_equal":"equal")}if(C){var j=C.split(","),q=new RegExp(/^\d*$/);j.forEach((function(e){q.test(e)||"${CURRENTUSER}"===e||"${CURRENTUSERROLE}"===e||"${EMPTY}"===e||"${NOTEMPTY}"===e||(T=!0)}))}}if(!C||T)return Search.isVRCriteria?n.text(I18n.getMsg("crm.field.valid.check",d)).show():setTimeout((function(){renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",d))}),70),"between"!==f&&"not_between"!==f||""!=v.eq(0).val()?"between"!==f&&"not_between"!==f||""!=l.find("#searchEndValue").val()?v.focus():l.find("#searchEndValue").focus():v[0].focus(),!1;if(!Crm.userDetails.isTaggingAvailable&&o.val().indexOf(".Tag")>-1&&"Tag"==o.val().split(".")[1])return setTimeout((function(){renderingUtils.showCustomAlert(I18n.getMsg("crm.tags.records.downgrade.free.edition"))}),70),!1;if((Search.defaultFilters.contains(f)||"cs"===m)&&(C=f,f="equal"),f!==Search.ageCrt&&f!==Search.dueCrt||(C=(f===Search.ageCrt?"${AGE":"${AGE+")+C.trim()+"}",f=l.find("#ageindayscondition").val()),f===Search.noOfChar&&(C="between"!==(f=l.find("#lengthcondition").val())&&"not_between"!==f?"${NOC"+C.trim()+"}":"${NOC"+C.trim()+"},${NOC"+l.find("#searchEndValue").val().trim()+"}"),0!=Object.keys(S).length)return{api_name:o.val(),comparator:f,value:C,field_label:d,idVsNameJSON:S};"AnalyticsChart"!==a&&"orchestration"!==a&&"wflow"!==a&&"blueprint"!==a&&"createProcess"!==a&&"ValRules"!==a||!0===i||"num"===m&&("ValRules"===a?g&&g.separator&&("between"===f||"not_between"===f?(b=-1!==C.indexOf(",")?C.split(","):C.split("~"),C=Search.formatNumber(b[0])+"~"+Search.formatNumber(b[1])):C=Search.formatNumber(C)):Search.getJSONforCriteria(d,o.val().split(".")[0],a,r)&&"${NOTEMPTY}"!==C&&"${EMPTY}"!==C&&("between"===f||"not_between"===f?(b=C.split(","),C===b[0]&&(b=C.split("~")),C=Search.formatNumber(b[0])+"~"+Search.formatNumber(b[1])):C=Search.formatNumber(C)));var W=o.val(),G="";if("none"!==I&&void 0!==I&&!1===y){var J=W.length,X=!1;for(w=0;w<J;w++)"."===W.charAt(w)?(G+="->"+I+".",X=!0):G+=W.charAt(w);!1===X&&(G+="->"+I)}return""===G&&(G=W),{api_name:h||G,comparator:f,value:C,field_label:d}},Search.getCriteriaDetails=function(e,t,a,r,i,n){void 0!==i?Search.criteriaDtls=i:Search.criteriaDtls.length||(i=Search.criteriaDtls),t=void 0===t?"":t;var s=$("#searchlayer_new"+t);if(s.length>0){var l=s.find("#patternVal"+t).val();if($("#newpattern"+t).is(":visible")){var o=l.split(" ").join("");if(o=Search.replaceAndOr(o),!this.validatePattern(o,t,Search["rowcnt"+t]))return!1}var c=Search.getCriteriaJsonFromPattern(l,s,r,i,n);if(!(c&&a&&validationUtils.isEmpty(c)))return document&&document.domain&&document.domain.indexOf("localzoho.com")>-1&&Search.testPopulateCriteria(c)&&murphy.info("Incomplete criteria is submitted for pattern :"+l),c;if(a)return Search.isVRCriteria?$(".validationRuleCongureWarningMsg").text(I18n.getMsg("crm.criteria.cannot.empty")).show():"workflow"===r||"assignmentrules"===r?renderingUtils.showCustomAlert(I18n.getMsg("crm.condition.cannot.empty")):renderingUtils.showCustomAlert(I18n.getMsg("crm.criteria.cannot.empty")),!1}},Search.getCriteriaJsonFromPattern=function(e,t,a,r,i){for(var n=[],s=(e=e.trim()).length,l=0;l<s;l++){var o=e.charAt(l);if("("===o){var c=Search.getPatternSplitIndex(e,l+1)-1,d=e.substr(l+1,c);l+=c+1;var m=Search.getCriteriaJsonFromPattern(d,t,a,r,i);if(!m)return!1;validationUtils.isEmpty(m)||n.push(m)}else if("a"===o)n.push("and"),l+=2;else if("o"===o)n.push("or"),l+=1;else if(o&&")"!=o&&" "!==o){var p=-1!==e.substr(l).indexOf(" ")?e.substr(l).indexOf(" ")+l:e.length,h=Search.getCriteriaObj(parseInt(e.substring(l,p)),t,a,r,i);if(l=p,!h)return!1;validationUtils.isEmpty(h)||n.push(h)}}return n},Search.getPatternSplitIndex=function(e,t){var a=e.substr(t).indexOf(")"),r=e.substr(t).indexOf("(");if(-1===r||a>0&&a<r)return a;var i=e.length,n=1;for(r+=t;r<i;r++){var s=e.charAt(r);if("("===s?n++:")"===s&&n--,0==n)return r-t}},Search.createRowForCriteria=function(e,t,a,r,i){var n="";a=void 0===a?"":a;var s=$("#searchlayer_new"+a).find("tr.searchcrt"),l=s.length,o=l,c=s.eq(l-1);if((l>1||1==l&&"none"!==s.eq(0).find("#searchfield").val())&&(c=Search.addCriteria_new(25,void 0,"",void 0,c.find("#addRow"),a),o++),e){if(!c.find("#searchfield").find('option[value="'+e.api_name+'"]').length){if(r)return;var d='<option value="'+e.api_name+'" id="'+Handlebars.helpers.getDataType(e)+'">'+$ESAPI.encoder().encodeForHTML(e.field_label)+"</option>";c.find("#searchfield").append(d)}if(-1!==e.api_name.indexOf("->")){var m=e.api_name.split("."),p=m[0].split("->");e.api_name=p[0]+"."+m[1],n=p[1]}if(-1!=e.api_name.indexOf(".Tag")&&(Search.tagLoad=!0),c.find("#searchfield").val(e.api_name).trigger("change"),-1!=e.api_name.indexOf(".Tag")&&(Search.tagVal=!0,Search.tagLoad=!1),Search.modifyCrtJsonForDisplay(e,c,i),-1!==e.api_name.indexOf(".Tag")&&"${EMPTY}"===e.value||"${NOTEMPTY}"===e.value||("Potentials.Stage"===e.api_name||"Stage"===e.api_name||"Deals.Stage"===e.api_name)&&("${OPEN}"===e.value||"${CLOSEDWON}"===e.value||"${CLOSEDLOST}"===e.value))c.find(".searchcondition").val(e.value);else c.find(".searchcondition").val(e.comparator),c.find(".mmldrop").val(n);Search.changeCondition(c.find(".searchcondition"),e.hasOwnProperty("idVsNameJSON")?e.idVsNameJSON:e.value),e.ageComparator&&c.find("#ageindayscondition").val(e.ageComparator).trigger("change"),e.nocComparator&&(c.find("#lengthcondition").val(e.nocComparator).trigger("change"),Search.changeNOCCondition(c.find("#lengthcondition"),e.value),e.comparator=e.nocComparator,delete e.nocComparator),o>1&&"or"===t&&c.find("#matchConditionLabel").click()}return o},Search.modifyCrtJsonForDisplay=function(e,t,a){var r=t.find("#searchfield").find("option:selected").attr("id"),i=e.value;if(Search.defaultFilters.contains(i)&&"${CURRENTUSER}"!==e.value&&("date"===r||"datetime"===r||"D"===r||"DT"===r)||"cs"===r)e.comparator=i;else if("${EMPTY}"===i||"${NOTEMPTY}"===i)e.comparator="${EMPTY}"===i&&"not_equal"===e.comparator?"${NOTEMPTY}":i;else if("date"!==r&&"datetime"!==r||"object"==typeof i||!i.startsWith("${AGE"))if("text"===r&&"near_to"===e.comparator&&i&&-1!==i.indexOf("NEARTO")){var n=i.split("NEARTO")[1].split(";");i=n[0],$("#meter").val(n[3]),$("#latlong").val(n[2]+","+n[1])}else"text"===r&&i&&Search.numOfCharSupportedComp.contains(e.comparator)&&-1!==i.indexOf("${NOC")&&(e.nocComparator=e.comparator,e.comparator=Search.noOfChar,i=i||0);else i=i.substring(5,i.lastIndexOf("}")),e.ageComparator=e.comparator,"+"===i.charAt(0)?(e.comparator=Search.dueCrt,i=i.replace("+","")):e.comparator=Search.ageCrt,i=i||0;"num"!==r||"AnalyticsChart"!==a&&"wflow"!==a&&"ValRules"!==a||"double"===e.data_type||(i=Search.reverseFormatNumber(i,e.comparator)),e.value=i},Search.setCriteriaValues=function(e,t,a,r,i){if(Search.isPatternEditOpen=!1,!validationUtils.isEmpty(e)){Search.userIdsForReq=[],Search.userElemMap={},Search.roleElemMap={};var n=Search.populateCriteria(e,void 0,void 0,t,a,r);if(Search.supportMSPOption&&setTimeout((function(){$("select#textcondition.searchcond.searchcondition").on("select2:opening",(function(){Search.hideIncludeExcludeComp($(this))}))}),2e3),n){var s=$("#searchlayer_new"+t),l=(n="1"===n.trim()?n:"( "+n.trim()+" )").replace(new RegExp("and","g"),I18n.getMsg("and")).replace(new RegExp("or","g"),I18n.getMsg("or"));s.find("#pattern"+t).text(l),s.find("#patternVal"+t).val(n);var o=[];Search.userIdsForReq.forEach((function(e){Object.keys(Search.requestedUsers).contains(e)||o.push(e)}));var c=o.join();if(Object.keys(Search.userElemMap).length){var d=Crm.getCrmBasePath()+"/Pulse.do?action=getDataForDisplayAndMentions&isDeletedUsersNeeded=true&userIdList="+c,m=new crmRequestPool;if(""!==c)m.initiate({action:d,type:"GET",dataType:"json",success:function(e){for(var t=0;t<e.length;t++)Search.requestedUsers[e[t].id]=e[t].name,"DELETED"===e[t].userType&&Search.deletedUsers.push(e[t].id);var a=Object.keys(Search.userElemMap);for(t=0;t<a.length;t++){for(var r=a[t],n=Search.userElemMap[r],s=[],l=0;l<n.length;l++){var o=n[l];"blueprint"===i&&-1!=Search.deletedUsers.indexOf(o)||s.push({id:o,full_name:Search.requestedUsers[o]})}document.getElementById(r).component.setData("usersRecord",s)}}});else for(var p=Object.keys(Search.userElemMap),h=p.length,u=0;u<h;u++){for(var f=p[u],v=Search.userElemMap[f],g=[],S=v.length,C=0;C<S;C++){var y=v[C];"blueprint"===i&&-1!=Search.deletedUsers.indexOf(y)||g.push({id:y,full_name:Search.requestedUsers[y]})}document.getElementById(f).component.setData("usersRecord",g)}}if(Object.keys(Search.roleElemMap).length){var I=Search.roleElemMap;store.findAll("role",{},!0).then((function(){for(var e=Object.keys(I),t=e.length,a=0;a<t;a++){for(var r=e[a],i=I[r],n=[],s=i.length,l=0;l<s;l++){var o=i[l];"${CURRENTUSERROLE}"===o?n.push({display_label:I18n.getMsg("current.logged.in.user.role"),name:I18n.getMsg("current.logged.in.user.role"),id:"${CURRENTUSERROLE}"}):n.push(store.peekRecord("role",o))}var c=document.getElementById(r).component;c.setData("roleRecords",n),c.setData("selectedRoles",JSON.stringify(i))}}))}}}},Search.populateCriteria=function(e,t,a,r,i,n){a||(a="");var s=e.length;if(s)for(var l=0;l<s;l++){var o=e[l];if("object"==typeof o)if(o[0]){t="string"==typeof e[l-1]?e[l-1]:t;a+="( "+Search.populateCriteria(o,t,void 0,r,i,n)+" )"}else{var c,d="string"==typeof e[l-1]?e[l-1]:t;(c=Search.createRowForCriteria(o,d,r,i,n))&&(a+=c+" ")}else""!==a&&(a+=" "+o+" ")}else(c=Search.createRowForCriteria(e,t,r,i,n))&&(a+=c+" ");return a},Search.populateDateTimeValues=function(e,t,a){var r=a.children(".searchdate");if("date"!==t){var i="",n=a.children(".dateTimeFlds"),s=!("HH:mm"===Crm.userDetails.TIME_FORMAT),l=e.split(" "),o=l.length;if(s){i=l[o-1];var c=l[o-2]}else c=l[o-1];var d=e.indexOf(c),m=e.substring(0,d-1);r.val(m),n.find(".searchtime").val(c);var p=c.split(":");n.find(".searchhour").val(p[0]),n.find(".searchmin").val(p[1]),i&&(n.find(".searchampm").val(i),n.find(".ampmSpan").text(I18n.getMsg(i)).attr("ampm",i))}else r.val(e)},Handlebars.registerHelper("getDataType",(function(e){var t=e.data_type;return"predefined"==t||("formula"===t&&e.formula?t=e.formula.return_type:"rollup_summary"===t&&e.rollup_summary?t=e.rollup_summary.return_type:8===e.uitype||55===e.uitype||221===e.uitype||"userlookup"===t?t="ownerlookup":208===e.uitype?t="layout":207===e.uitype?t="W":39===e.uitype?t="picklist":"CrmTask"!==e.table_name&&"CrmCall"!==e.table_name||"CALLSTATUS"!==e.column_name?"CrmActivity"===e.table_name&&"ACTIVITYTYPE"===e.column_name?t="ActivityType":"CrmServiceDetails"===e.table_name&&"SERVICESTATUS"===e.column_name||"CrmAppointmentDetails"===e.table_name&&"APPOINTMENTSTATUS"===e.column_name?t="ServiceStatus":("CrmServiceDetails"===e.table_name&&"SERVICEDURATION"===e.column_name||"CrmAppointmentDetails"===e.table_name&&"APPOINTMENTDURATION"===e.column_name)&&(t="duration"):t="cs",Search.fieldTypeVsDataType[t]&&(t=Search.fieldTypeVsDataType[t]),Crm.userDetails.multiSelectFilterOptions&&Search.supportMSPOption&&(100===e.uitype||96===e.uitype||"multiselectpicklist"===e.data_type)&&(t="multiselectpicklist")),t})),Handlebars.registerHelper("getFieldDetails",(function(e){if("true"===e.separator&&Search.numberSeparatorMap.push(e.display_label),!validationUtils.isEmpty(e.pick_list_values))return JSON.stringify(e.pick_list_values)})),Handlebars.registerHelper("formConditions",(function(e,t){for(var a=Search["_"+e],r=a.length,i="",n=0;n<r;n++){var s=a[n];(Search.isVRCriteria||"No of Characters"!=s[0])&&(i+="<option value='"+s[0]+"'>"+s[1]+"</option>")}return"true"===t&&(i+="<option value='${EMPTY}'>"+I18n.getMsg("is empty")+"</option><option value='${NOTEMPTY}'>"+I18n.getMsg("is not empty")+"</option>"),i})),Handlebars.registerHelper("formConditions1",(function(e){var t="";if(e)for(var a=e.split("_"),r=a.length-1,i=0;i<r;i++)["Unknown__s"].includes(moduleRecordMapping[a[i]].api_name)||(t+="<option pluralname='"+moduleRecordMapping[a[i]].plural_label+"' value='"+a[i]+"'>"+moduleRecordMapping[a[i]].plural_label+"</option>");return t})),Search.renderCriteriaEditor=function(e,t,a,r,i,n,s){void 0!==s&&["Dashboards","Customview"].contains(s)&&e.forEach((function(t,a){var r=[],i=Object.keys(t)[0];t[i].forEach((function(e){(-1==="Dashboards".indexOf(s)||1!==e.is_filterable||e.uitype===CrmField.UITYPES.MULTI_MODULE_LOOK_UP_ENTITY||Search.analyticsFilterHiddenFields.contains(e.column_name))&&(-1==="Customview".indexOf(s)||e.uitype===CrmField.UITYPES.FORMULA&&void 0!==e.formula&&e.formula.dynamic)||r.push(e)})),t[i]=r,e[a]=t}));var l={fields:e,userTimeFormat:Crm.userDetails.TIME_FORMAT,suffix:a,addModulePrefix:i,suffixModule:n,featureName:s,index:1};l.maxCrtCnt=r||Search.MAX_CRT_CNT,("object"==typeof t?t:$("#"+t)).html(Handlebars.templates.criteriaEditor(l)),Search.afterRenderCriteria()},Search.setHeightOwnerLookupScoring=function(e){var t,a,r=$("#critEditorDIV .popup-model-content"),i=e,n=0,s=r.offset().top,l=r.outerHeight(),o=i.outerHeight();t=s+l,a=i.offset().top+o,i.css({"max-height":""}),a>t?((n=150)>220&&(n=220),i.css({"max-height":n}),r.animate({scrollTop:n})):i.css({"max-height":""})},Handlebars.registerHelper("constructCriteriaSummary",(function(e,t,a,r,i,n){var s=void 0;if(a&&a.length){if(i){var l=$ESAPI.encoder().encodeForHTML(a[0]);i=$ESAPI.encoder().encodeForHTML(i);s='<p class="m5 mB0 crmBaseColor dIB"><span>'+I18n.getMsg("crm.dashboard.funnel.count.of.with.conversion",[i,l])+" </span>"}else s='<p class="m5 mB0 crmBaseColor dIB"><span>'+I18n.getMsg("crm.dashboard.funnel.count.of",$ESAPI.encoder().encodeForHTML(a[0]))+" </span>";if(r&&1===r[0].split(".").length){var o=e[r[0]],c=$ESAPI.encoder().encodeForHTML(o.display_label),d=CrmKPIRenderer.getDisplayLabelForComparisonLabel(r[1]);s=s+'<span><span class="crmGreenColor">'+I18n.getMsg("crm.dashboard.funnel.duration.msg",[c,d])+"</span>"}for(var m=a.length,p=1;p<m;p++)if(s=s+'<span class="ifRelatedModulePresent"><span> '+I18n.getMsg("crm.dashboard.containing",$ESAPI.encoder().encodeForHTML(a[p]))+"</span></span>",1===p&&r&&r[0].split(".").length>1){o=e[r[0]],c=$ESAPI.encoder().encodeForHTML(o.display_label),d=CrmKPIRenderer.getDisplayLabelForComparisonLabel(r[1]);s=s+' <span><span class="crmGreenColor">'+I18n.getMsg("crm.dashboard.funnel.duration.msg",[c,d])+"</span>"}s+=t.length?" Where</p>":"</p>"}if(t&&"object"===$.type(t)){o=e[t.api_name],c=$ESAPI.encoder().encodeForHTML(o.display_label);var h=Handlebars.helpers.getDataType(o),u=Handlebars.helpers.convertComparatorToDisplayTextForSummary(t.api_name,t.comparator,t.value,e),f=$ESAPI.encoder().encodeForHTML(Handlebars.helpers.convertCompareValToDisplayTextForSummary(t.comparator,t.value,h,t.api_name,e,n).toString());n&&o.separator&&-1===f.indexOf("-")&&"Empty"!==f?f="between"===u||"not between"===u?Search.formatNumber(f.split(",")[0])+" ~ "+Search.formatNumber(f.split(",")[1]):Search.formatNumber(f):"between"!==u&&"not between"!==u||-1===f.indexOf(",")||!n||o.separator||(f=f.split(",")[0]+" ~ "+f.split(",")[1]),s=null==s?'<p class="m5 crmBaseColor"><span><span class="crmGreenColor">'+c+' </span><span class="ttUppercase">'+u+' </span><span class="crmGreenColor">'+f+"</span></span></p>":s+'<p class="m5 crmBaseColor"><span><span class="crmGreenColor">'+c+' </span><span class="ttUppercase">'+u+' </span><span class="crmGreenColor">'+f+"</span></span></p>"}else if("array"===$.type(t)){var v=t.length;for(p=0;p<v;p++)if("array"===$.type(t[p]))for(var g=t[p],S=g.length,C=0;C<S;C++)null==s?s=Handlebars.helpers.constructCriteriaSummary(e,g[C],void 0,void 0,void 0,n):s+=Handlebars.helpers.constructCriteriaSummary(e,g[C],void 0,void 0,void 0,n);else"object"===$.type(t[p])?null==s?s=Handlebars.helpers.constructCriteriaSummary(e,t[p],void 0,void 0,void 0,n):s+=Handlebars.helpers.constructCriteriaSummary(e,t[p],void 0,void 0,void 0,n):s=t[p]&&"and"==t[p].toLowerCase()?s+"<div class='w100_per cBoth fL mB5 mT5 crm-small-font-size ttUppercase crmNotFoundColor'>"+I18n.getMsg("crm.label.and")+"</div>":s+"<div class='w100_per cBoth fL mB5 mT5 crm-small-font-size ttUppercase crmNotFoundColor'>"+I18n.getMsg("crm.label.or")+"</div>"}else s=t&&"and"==t.toLowerCase()?"<div class='w100_per cBoth fL mB5 mT5 crm-small-font-size ttUppercase crmNotFoundColor'>"+I18n.getMsg("crm.label.and")+"</div>":"<div class='w100_per cBoth fL mB5 mT5 crm-small-font-size ttUppercase crmNotFoundColor'>"+I18n.getMsg("crm.label.or")+"</div>";return s})),Handlebars.registerHelper("convertComparatorToDisplayTextForSummary",(function(e,t,a,r){if("${EMPTY}"===a||"${NOTEMPTY}"===a)switch(t){case"equal":"${EMPTY}"===a?t=I18n.getMsg("is"):"${NOTEMPTY}"===a&&(t=I18n.getMsg("isn't"));break;case"not_equal":t=I18n.getMsg("isn't")}else if("between"==t||"not_between"==t||-1!==a.toString().indexOf("${NOC"))if($.isArray(a)&&a[0].toString().indexOf("${NOC")>=0||-1!==a.toString().indexOf("${NOC")){var i="num",n=Search.DATATYPEVSCMPMAP[i];t=I18n.getMsg("crm.criteria.editor.no.of.characters")+" "+n[t]}else{var s=r[e];i=Handlebars.helpers.getDataType(s);t=(n=Search.DATATYPEVSCMPMAP[i])[t]}else{s=r[e];"ActivityType"!==(i=Handlebars.helpers.getDataType(s))&&"cs"!==i||(i="picklist"),t=(n=Search.DATATYPEVSCMPMAP[i])[t],"datetime"!==i&&"date"!==i||a.startsWith("${AGE")&&(t=-1!==a.indexOf("+")?Search.dueCrt:Search.ageCrt)}return t})),Handlebars.registerHelper("convertCompareValToDisplayTextForSummary",(function(e,t,a,r,i,n){var s=[];if("between"==e||"not_between"==e){if($.isArray(t)&&-1==t[0].toString().indexOf("${NOC"))return t[0]+" - "+t[1];if($.isArray(t)&&-1!==t[0].toString().indexOf("${NOC"))return t[0].trim().substring(5,t[0].trim().lastIndexOf("}"))+" - "+t[1].trim().substring(5,t[1].trim().lastIndexOf("}"));if(-1!==t.toString().indexOf("${NOC"))return(t=t.split(","))[0].trim().substring(5,t[0].trim().lastIndexOf("}"))+" - "+t[1].trim().substring(5,t[1].trim().lastIndexOf("}"));if(!n)return(t=t.split(","))[0]+" - "+t[1]}else if(-1!==t.toString().indexOf("${NOC"))return t.substring(5,t.lastIndexOf("}"));if("tag"===a&&-1===t.indexOf("${EMPTY}")&&-1===t.indexOf("${NOTEMPTY}")){for(var l=i[r].pick_list_values,o=l.length,c=t.split(","),d={},m=0;m<o;m++)d[l[m].id]=l[m].name;var p=c.length;for(m=0;m<p;m++)s.push(d[c[m]]);return s}if("U"==a||"OwnerLookUp"==a){var h,u=Crm.getUserDetailsMap();for(o=(C=t.split(",")).length,m=0;m<o;m++)h=u[C[m]]?u[C[m]].name:"${EMPTY}"===C[m]||"${NOTEMPTY}"===C[m]?I18n.getMsg("Empty"):(h=$("li[data-value="+C[m]+"]").find(".lyteDropdownVisible").text()).length>0?h.trim():"",s.push(h);return s}if("layout"===a||"L"===a){if($.isArray(t))for(o=(C=t).length,m=0;m<o;m++){var f=Object.keys(C[m]);s.push(C[m][f[0]])}else{var v=i[r].pick_list_values,g=(o=v.length,{});for(m=0;m<o;m++){var S=v[m].split("!@#");g[S[0]]=S[1]}var C;for(o=(C=t.split(",")).length,m=0;m<o;m++)s.push(g[C[m]])}return s}if("cs"===a){var y=Search._CS,I=y.length;for(m=0;m<I;m++){var T=y[m];if(T[0]===t)return T[1]}}if("datetime"===a||"date"===a){if(t.startsWith("${AGE"))return t=-1===t.indexOf("+")?(t=t.substring(5)).substring(0,t.length-1):(t=t.substring(6)).substring(0,t.length-1),$.each(Search._AGEINDAYSCOND1,(function(a,r){e===r[0]&&(t=r[1]+" "+t)})),t;var b=Search.DATETIMECOND;if(b.hasOwnProperty(t))return b[t]}var x=1;$.isArray(t)&&(x=t.length);for(m=0;m<x;m++){var w=null;switch(w=$.isArray(t)?t[m]:t,e){case"starts_with":case"ends_with":case"like":case"not_like":w=w.replace(/\*/g,"");break;case"is":case"isn't":case"=":case"!=":case"equal":case"not_equal":switch(w){case"${EMPTY}":case"${NOTEMPTY}":w=I18n.getMsg("Empty");break;case"true":w=I18n.getMsg("crm.label.selected");break;case"false":w=I18n.getMsg("crm.label.notSelected")}}s.push(w)}return s})),Search.userEventLAR=function(){$(".listUsers1").prop("onclick",null).off("click"),$(".listUsers1").click((function(e){$(this).hasClass("active2")?($(this).removeClass("active2"),1==$("#selusrs li.active2").size()&&($("#moveup").css("display",""),$("#movedown").css("display",""),$("#moveup_disabled").css("display","none"),$("#movedown_disabled").css("display","none"))):($(this).addClass("active2"),$("#selusrs li.active2").size()>1&&($("#moveup").css("display","none"),$("#movedown").css("display","none"),$("#moveup_disabled").css("display",""),$("#movedown_disabled").css("display","")))}))},Search.testPopulateCriteria=function(e){var t=e.length;if(t)for(var a=0;a<t;a++){var r=e[a];if("object"==typeof r){if(r[0])return Search.testPopulateCriteria(r);if("string"==typeof r)return!0}else if(!r||!e[a-1])return!0}else if("string"==typeof e)return!0;return!1},Search.isScoreRuleField=function(e){return null!==e&&-1!==e.indexOf("Entity Scores.Scoring_Rule")};var crmBstTime={responseData:{},responseDataSeid:{},userData:void 0,reqtime:{},updateInterval:void 0,updateTimeout:void 0,bestTimeClickTracker:void 0,detailsPageDate:void 0,detailsPageTime:void 0,reminderTime:void 0,reminderInformation:{},orderid:0,notificationFlag:0,increment:0,pushNotificationList:{},gmtTime:{},module:void 0,supportedModules:["Leads","Contacts"],days:["crm.best.time.day.short.sunday","crm.best.time.day.short.monday","crm.best.time.day.short.tuesday","crm.best.time.day.short.wednesday","crm.best.time.day.short.thursday","crm.best.time.day.short.friday","crm.best.time.day.short.saturday"],daysShortForm:["crm.best.time.day.short.monday","crm.best.time.day.short.tuesday","crm.best.time.day.short.wednesday","crm.best.time.day.short.thursday","crm.best.time.day.short.friday","crm.best.time.day.short.saturday","crm.best.time.day.short.sunday"],months:["crm.best.time.month.short.january","crm.best.time.month.short.february","crm.best.time.month.short.march","crm.best.time.month.short.april","crm.best.time.month.short.may","crm.best.time.month.short.june","crm.best.time.month.short.july","crm.best.time.month.short.august","crm.best.time.month.short.september","crm.best.time.month.short.october","crm.best.time.month.short.november","crm.best.time.month.short.december"],bestTimeNotificationData:{},ziapauseFlag:0,ziapauseInc:1,cTop:0,activityType:void 0,quickCreateTaskFlag:0,component:void 0,isRemainingTimeShown:!0,getConvertedCurrentDateTime:function(){var e=$L.moment().toDate(),t=e.getTimezoneOffset(),a=Utils.getTimezoneOffset();if(a!==t){var r=t-a;e.setMinutes(e.getMinutes()+r)}return e},isSupportedModule:function(e){return-1!==crmBstTime.supportedModules.indexOf(e)},isFeatureAvailable:function(){return!(Crm.userDetails.isBTPermissionMigrationRun&&!Crm.userDetails.permissions.Crm_Implied_View_Result_BestTime)&&!(!Crm.userDetails.isBestTimeEnabledCall&&!Crm.userDetails.isBestTimeEnabledMail||Crm.userDetails.CLIENT_ACCOUNT||"A|Z|C|E|U".indexOf(Crm.userDetails.LICENSE_TYPE)<0)},makeAjaxCall:function(e,t,a,r,i){i=i||"GET";var n={"X-CRM-ORG":crmZgid,"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken};(new crmRequestPool).initiate({action:e,data:a,type:i,headers:n,success:function(e,a,r){t(e,a,r)},error:function(e){r&&r(e)}})},getListViewString:function(e){var t=e.length;t=t<=3?t:3;for(var a="",r=crmBstTime.getConvertedCurrentDateTime(),i=0;i<t;i++){var n=e[i],s=-1!==n.indexOf(" "),l=n.split(":"),o=$L.moment().toDate();if(s){var c=l[1].split(" "),d=I18n.getMsg("PM"),m=c[1]==d,p=l[0];m&&parseInt(p)<12&&(p=parseInt(p)+12),o.setHours(p),o.setMinutes(c[0])}else o.setHours(l[0]),o.setMinutes(l[1]);r>o?a='<span class="crm-font-regular crm-base-font-size bestTimeTagList ">'+n+"</span>":a+='<span class="crm-font-regular crm-base-font-size bestTimeTagList  mR5">'+n+"</span>"}return a},getParsedBestTime:function(e,t){var a={},r="hh:mm a"===Crm.userDetails.TIME_FORMAT,i=-1,n=-1,s=$L.moment().toDate(),l=$L.moment().toDate();if(l.setMinutes(l.getMinutes()-30),void 0!==t&&void 0!==t.user_time){var o=t.user_time;i=o.hour,n=o.minute,s.setHours(i),s.setMinutes(n),l.setHours(i),l.setMinutes(n),l.setMinutes(l.getMinutes()-30),$L.moment().toDate().getDate()!==crmBstTime.reqtime.getDate()&&(s.setDate(crmBstTime.reqtime.getDate()),l.setDate(crmBstTime.reqtime.getDate()))}s.setMilliseconds($L.moment().toDate()-crmBstTime.reqtime),l.setMilliseconds($L.moment().toDate()-crmBstTime.reqtime);for(var c=[],d=[],m=[],p=[],h=[],u=e.length,f=0;f<u;f++){var v=e[f],g=v.time.split(":"),S=g[0],C=g[1];r&&"PM"===v.ampm&&parseInt(S)<12&&(S=parseInt(S)+12);var y=$L.moment().toDate();if(y.setHours(S),y.setMinutes(C),s>y)l<y&&d.push(y),m.push(y);else{var I=(y-s)/6e4;I>4&&(h.push(y),I<15&&(a.isbelow15=!0)),p.push(y)}c.push(y),crmBstTime.gmtTime[crmBstTime.getFormattedTime(r,y)]=v.gmtTime}c.sort(Utils.sortDate),d.sort(Utils.sortDateDecending),p.sort(Utils.sortDate);var $=d.length,T=void 0,b=void 0;if($>0){T=d[$-1],a.oldTime=crmBstTime.getFormattedTime(r,T);var x=Math.ceil((s.getTime()-T.getTime())/6e4%60);b=x;var w="";0===x?w=I18n.getMsg("crm.Now"):1===x?w=I18n.getMsg("crm.best.time.nl.str.minute.ago"):x>1&&(w=I18n.getMsg("crm.best.time.nl.str.minutes.ago",x)),a.oldTimeInNL=w}if(a.allPastTimes=[],m.length>0){m.sort(Utils.sortDateDecending);for(var _=m.length,E=0;E<_;E++)a.allPastTimes.push(crmBstTime.getFormattedTime(r,m[E]))}if(a.reminderTime=[],h.length>0){h.sort(Utils.sortDate);var O=h.length;for(E=0;E<O;E++)a.reminderTime.push(crmBstTime.getFormattedTime(r,h[E]))}var N=$<=0?4:3;N=p.length>N?N:p.length;var L=p.slice(0,N);if(void 0!==L[0]){var D=L[0];a.nextImmediateTime=crmBstTime.getFormattedTime(r,D),a.nextImmediateTimeInNL=crmBstTime.getNextImmediateTimeInNL(D,s)}a.diffTime=Math.ceil(b),a.allTimes=[];for(var M=c.length,R=0;R<M;R++){var k=crmBstTime.getFormattedTime(r,c[R]);a.allTimes.push(k)}a.nextTimes=[];for(R=1;R<N&&void 0!==L[R];R++)a.nextTimes.push(crmBstTime.getFormattedTime(r,L[R]));return a},getNextImmediateTimeInNL:function(e,t){return diffTime=(e.getTime()-t.getTime())/6e4,crmBstTime.getRemainingTimeText(parseInt(diffTime/60),parseInt(diffTime%60))},getRemainingTimeText:function(e,t){return 0===e?t<0?"":0===t?I18n.getMsg("crm.Now"):1===t?I18n.getMsg("crm.best.time.nl.str.minute.only",t):I18n.getMsg("crm.best.time.nl.str.minutes.only",t):1===e?0===t?I18n.getMsg("crm.best.time.nl.str.minutes.only",60):1===t?I18n.getMsg("crm.best.time.nl.str.minute.only",t):I18n.getMsg("crm.best.time.nl.str.minutes.only",t):e>1&&e<24?(e-=1,0===t?I18n.getMsg("crm.best.time.nl.str.hours.only",e+1):1===e&&1===t?I18n.getMsg("crm.best.time.nl.str.both.hour.and.minute",[e,t]):1===e&&t>1?I18n.getMsg("crm.best.time.nl.str.both.hour.and.minutes",[e,t]):1===t?I18n.getMsg("crm.best.time.nl.str.both.hours.and.minute",[e,t]):I18n.getMsg("crm.best.time.nl.str.both.hours.and.minutes",[e,t])):void 0},sortDateBestTime:function(e,t){return new Date(e.bestTimeDate)-new Date(t.bestTimeDate)},getLevel:function(e){return e>=0&&e<21?1:e>20&&e<41?2:e>40&&e<61?3:e>60&&e<81?4:5},getBestTimeByDay:function(e){for(var t="hh:mm a"===Crm.userDetails.TIME_FORMAT,a=e,r=a.length,i=[],n=0;n<r;n++){var s=a[n],l={weight:s.score,bestTimeDate:$L.moment(s.timestamp.substring(0,s.timestamp.length-5)).toDate()};i.push(l)}i.sort(crmBstTime.sortDateBestTime);var o=[],c=i.length;for(n=0;n<c;n++){var d={bestTimeDate:i[n].bestTimeDate,bestTime:crmBstTime.getFormattedTime(t,i[n].bestTimeDate,!0),level:crmBstTime.getLevel(i[n].weight)};o.push(d)}return o},showBestTimeOnRightPanelNew:function(e){if(void 0!==e){crmBstTime.reqtime=$L.moment().toDate();var t=crmBstTime.getBestTimeByDay(e,7,!0),a=t.length>5?5:t.length;if(0!==a){for(var r={nextImmediateTime:t[0].bestTime,nextImmediateTimelevel:"lev"+t[0].level,nextImmediateTimeInNL:crmBstTime.getNextImmediateTimeInNL(t[0].bestTimeDate,$L.moment().toDate()),nextTimes:[]},i=1;i<a&&5!==i;i++){var n={bestTime:t[i].bestTime,bestTimeLevel:"lev"+t[i].level};r.nextTimes.push(n)}r.showRightpanelRemTime=r.nextTimes.length>0;var s=Handlebars.templates.RightPanelBestTime(r);$("#bestTimeRP").html(s)}}},getBestTimeDataForRightPanelComponent:function(e){if(void 0===e)return{};var t=e.bestTime_call,a=(t=t?t.concat(e.bestTime_text):e.bestTime_text)?t.length:0;if(0===a)return{};t.sort((function(e,t){return $L.moment(e.dateTime).toDate().getTime()-$L.moment(t.dateTime).toDate().getTime()}));for(var r={nextImmediateTime:t[0].bestTime,nextImmediateTimelevel:"lev"+t[0].level,nextImmediateTimeInNL:crmBstTime.getNextImmediateTimeInNL(t[0].dateTime,$L.moment().toDate()),nextTimes:[]},i=1;i<a;i++)r.nextTimes.push({bestTime:t[i].bestTime,level:"lev"+t[i].level});return r.showRightpanelRemTime=r.nextTimes.length>0,r},detailsViewShow:function(e,t){if(void 0!==!(!Crm.userDetails.isBTPermissionMigrationRun||Crm.userDetails.permissions.Crm_Implied_View_Result_BestTime)&&!(!Crm.userDetails.isBestTimeEnabledCall&&!Crm.userDetails.isBestTimeEnabledMail||Crm.userDetails.CLIENT_ACCOUNT||"A|Z|C|E|U".indexOf(Crm.userDetails.LICENSE_TYPE)<0)&&e&&e.id){var a={id:e.id,reqDate:$L.moment().toDate().getTime(),module:crmTab.selectedTab,type:"ALL"};e.relModule&&(a.module=e.relModule),crmBstTime.makeAjaxCall("/crm/di/besttime",(function(e){if(e){var a=e.besttime;t?t(a,e):$("#bestTimeToContact").html(Handlebars.templates.BestTimeToContact(a))}}),a,void 0,"GET"),crmBstTime.reqtime=$L.moment().toDate()}},populateActivityReminderBestTime:function(e){if(e){if(e.best_times)e.best_times_result=crmBstTime.getParsedBestTime(e.best_times);else for(var t=e.length,a=0;a<t;a++)for(var r=e[a].length,i=0;i<r;i++)e[a][i].best_times&&(e[a][i].best_times_result=crmBstTime.getParsedBestTime(e[a][i].best_times));return e}},showHideSuggestionForCreateTask:function(e){if("show"===e){var t=$("#BestTimeCreateTask .dIBestTimetoCallContainer");t.length?(t.removeClass("hide").hide().fadeIn(500),t.find("dIBestTimeContent").removeClass("hide").show(),t.find("#dIBestTime").addClass("hide").removeClass("hide").fadeIn(200)):crmBstTime.showSuggestionForCreateTask()}else $(".REMINDAT").attr("style","padding-bottom:0px;")},showSuggestionForCreateTask:function(){},showSuggestionForCreateCall:function(){if(Crm.userDetails.isBestTimeEnabledCall&&(crmBstTime.hideBestTimeSuggestion("CreateCall"),!$("#CurrentCall").prop("checked")&&!$("#CompletedCall").prop("checked")&&document.getElementById("Crm_Calls_CONTACTID"))){var e=$("#Crm_Calls_CONTACTID");e.attr("onchange","crmBstTime.showSuggestionForCreateCall()");var t=$("#Crm_Calls_CALLSTARTDATETIME"),a=e.data(),r=a.lookupModule,i=a.id,n=crmBstTime.constructDateObject(t.val());$(".newCallContainer").parent().append(renderingUtils.createHTML({name:"div",attr:{id:"BestTimeCreateCall",class:"w100_per"}}));var s=networkUtils.returnDependencyFiles(["crm-besttime-new.js","besttime_zia_new_model.js","zia_reminder_model.js"],ResourceConstants.CRMClient);if(s=s.concat(networkUtils.returnDependencyFiles(["crm-besttime-new.css"],ResourceConstants.CRMClient)),$("#BestTimeCreateCall").length){Lyte.injectResources(s,void 0,(function(){Lyte.Component.render("crm-besttime-new",{seid:i,viewType:"CreateCall",module:r,dueDate:n},"#BestTimeCreateCall"),$("#ScheduleCall").parents(".labelValCreate").css({"margin-bottom":"0px"}),$("#BestTimeCreateCall").css({"margin-bottom":"120px"}),crmBstTime.setPosition()}))}crmBstTime.setBestTimeTracker("CreateCall","Call"),t.on("change",(function(){var e=$(this).val();$L(".calendarInputCreateCall").val(e);var t=$("crm-besttime-new").eq(0).get(0);if(t){if(e=crmBstTime.constructDateObject(e),$L.moment().toDate()>e&&$L.moment().toDate().toDateString()!==e.toDateString())return $L(t).hide(),void $("#BestTimeCreateCall").css({"margin-bottom":"0px"});t.component.changeDateForCreateTask(e)}}))}},showSuggestionForQuickCreateCall:function(){if(Crm.userDetails.isBestTimeEnabledCall){var e=$("#bestTimeUsageId");crmBstTime.hideBestTimeSuggestion("QuickCreateTask"),$("#leContModName").on("loadBestTime",(function(){crmBstTime.showSuggestionForQuickCreateCall()})),$("#Crm_Calls_CALLSTARTDATETIME").attr("onchange","crmBstTime.showSuggestionForQuickCreateCall()");var t=$("#leContModSel").val(),a=$("#leContModId").val(),r=$('input[name="property(Call Start Time)"]').val(),i=crmBstTime.constructDateObject(r);e.val("NotUsed"),crmBstTime.sendBestTimeRequest("QuickCreateCall",i,t,a)}},showSuggestionForQuickCreateTask:function(){},showSuggestionForReSchedule:function(e){if(void 0!==!(!Crm.userDetails.isBTPermissionMigrationRun||Crm.userDetails.permissions.Crm_Implied_View_Result_BestTime)&&Crm.userDetails.isBestTimeEnabledCall){""!==e&&void 0!==e||(e=0);var t=$("#relatedDetails_Calls").find("a").attr("data-params");if(""!==t&&void 0!==t){var a=JSON.parse(t),r=a.module,i=a.id,n=$("#callDate");$("#rescheduleBestTimeUsageId").val("NotUsed");var s=$("#bestTimeUsageId");n.attr("onchange","crmBstTime.showSuggestionForReSchedule()");var l=crmBstTime.constructDateObject(n.val());s.val("NotUsed"),crmBstTime.sendBestTimeRequest("Reschedule",l,r,i)}else e<5&&(e+=1,setTimeout((function(){crmBstTime.showSuggestionForReSchedule(e)}),100))}},sendBestTimeRequest:function(e,t,a,r){if(!(Crm.userDetails.CLIENT_ACCOUNT||"A|Z|C|E|U".indexOf(Crm.userDetails.LICENSE_TYPE)<0)){crmBstTime.module=a;var i=0==$("#updateCallStatus").length?$("#bestTimeUsageId"):$("#rescheduleBestTimeUsageId"),n="DetailsPage"===e;if(crmBstTime.responseData[e]=void 0,t&&a&&r&&("Contacts"===a||"Leads"===a)){var s=new crmRequestPool,l="QuickCreateCall"===e||"QuickCreateTask"===e||"Reschedule"===e?$L.moment(t).toDate():$L.moment().toDate();"QuickCreateCall"!==e&&"Reschedule"!==e||(crmBstTime.activityType="CALL");var o={id:r,module:a,type:crmBstTime.activityType,reqDate:l.getTime()},c={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken,"X-CRM-ORG":crmZgid};s.initiate({action:"/crm/di/besttime",type:"GET",data:o,headers:c,success:function(t){if(t&&t.besttime){crmBstTime.responseData[e]=t.besttime,crmBstTime.responseDataSeid[e]=r;var s=$L.moment().toDate();crmBstTime.userData={user_time:{hour:s.getHours(),minute:s.getMinutes()}},crmBstTime.reqtime=$L.moment().toDate(),crmBstTime.loadBestTimeData(e,!0,a)}else i.val("NA");n&&(crmBstTime.reminderTime=t.reminderTime)},error:function(){i.val("NA")}})}}},removeBestTimeFilter:function(){$(".dItimesdiv").find("li").show(),$("#bestTimeListFilterId").removeClass("filtered").hide()},hideBestTimeSuggestion:function(e,t){""!==t&&void 0!==t||(t=0),"QuickCreateTask"===e||"Reschedule"===e||"QuickCreateCall"===e?($("#times").find("li").removeClass("favBestTimeDrop").removeClass("bestTime").removeClass("lev1").removeClass("lev2").removeClass("lev3").removeClass("lev4").removeClass("lev5"),crmBstTime.removeBestTimeFilter(),$("#sdiv").removeClass("dItimesdiv").removeClass("tHours"),$("#bestTimeListFilterId").hide(),"QuickCreateCall"===e&&($("#leContModName").removeAttr("loadBestTime"),$("#bestTimeUsageId").val("NA"))):"DetailsPage"===e?$("#BestTime"+e).find(".dIBestTimeContainerDetailsPage").remove():"CreateTask"===e?($("#BestTime"+e).remove(),$(".REMINDAT").attr("style","padding-bottom:0px"),$("#bestTimeListFilterId").hide()):"CreateCall"===e&&($("#BestTime"+e).remove(),$("#ScheduleCall").parents(".labelValCreate").css({"margin-bottom":"initial"}),$("#Crm_Calls_CALLSTARTDATETIME").removeAttr("onchange"),$("#Crm_Calls_CONTACTID").removeAttr("onchange"),$("#bestTimeListFilterId").hide())},showCalendarForDi:function(e,t,a){var r=$L.moment().toDate();crmCalendar.showCalendar(e,t,a,void 0,void 0,void 0,r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear(),void 0),$("#Calendar").css({"box-sizing":"border-box"})},loadBestTimeData:function(e,t,a){$("body").children(".diNewToolTipForBestTime").remove();var r=crmBstTime.responseData[e];if(r&&("QuickCreateTask"===e||"Reschedule"===e||"QuickCreateCall"===e)){var i=crmBstTime.getBestTimeByDay(r),n=$("#times"),s=$("#sdiv");if(s.find("li").show(),n.find("li").removeClass("favBestTimeDrop").removeClass("bestTime").removeClass("lev1").removeClass("lev2").removeClass("lev3").removeClass("lev4").removeClass("lev5"),i.length>0){if(s.addClass("dItimesdiv"),"HH:mm"===Crm.userDetails.TIME_FORMAT&&s.addClass("tHours"),"pl_PL"!==Crm.userDetails.RELEVANT_LOCALE&&"bg_BG"!==Crm.userDetails.RELEVANT_LOCALE||s.addClass("plLang"),"QuickCreateCall"===e)newDate=crmBstTime.constructDateObject($('input[name="property(Call Start Time)"]').val());else if("QuickCreateTask"===e){var l=$("#qc_rem_date").val();l=""===l||void 0===l?$('input[name="property(Due Date)"]').val():l,newDate=crmBstTime.constructDateObject(l)}else"Reschedule"===e&&(newDate=crmBstTime.constructDateObject($("#callDate").val()));for(var o=i.length>5?5:i.length,c=0;c<o;c++){var d=i[c].bestTime,m="lev"+i[c].level;n.find('li[time="'+d.replace(" ",":")+'"]').addClass("bestTime").addClass(m)}(o>0&&!t&&!a||s.is(":visible"))&&$("#bestTimeListFilterId").show(),t||crmBstTime.alignBestTimeList()}else s.css({"padding-bottom":0})}},alignBestTimeList:function(){var e=$("#sdiv"),t=e.offset().top,a=e.outerHeight();if(0===$(".dItimesdiv").find("li.bestTime").length)e.removeClass("dItimesdiv").removeClass("tHours"),$("#bestTimeListFilterId").hide();else{var r=$("#bestTimeListFilterId"),i=r.outerHeight()+3;if(e.is(":visible")&&r.show(),renderingUtils.windowHeight<a+t){var n=t-a-30,s=r.offset().top-a-26;e.css({top:n}),r.css({top:s}),e.addClass("tA")}}e.css({"padding-bottom":i}),r.show()},setBestTimeTracker:function(e,t){$(".dIBestTimeContent .timeDi ").on("click",(function(a){var r=a.target.textContent;if(r=9===r.length?a.target.textContent.slice(1):r,crmBstTime.bestTimeClickTracker=!0,"CreateTask"===e){var i=$("#Crm_Tasks_RemindAt_Start_Date1_TimeOption");i.val(r).effect("highlight",{},1e3);var n=i.val().split(" ")[0].split(":"),s=n[0],l=n[1];s="PM"===Utils.getMeridiem(i.timeEntry("getTime")).toUpperCase()?parseInt(s)+12:s;var o=crmCalendar.getDateObjectFromGivenDateString($("#Crm_Tasks_RemindAt_Start_Date1").val());o.setHours(s),o.setMinutes(l),$("#Tasks_fldRow_RemindAt_Start_Date1 #Crm_Tasks_RemindAt_Start_Date1").data("dateObj",o)}else"CreateCall"===e&&$("#Crm_Calls_CALLSTARTDATETIME_TimeOption").val(r).effect("highlight",{},1e3);Crm.client_tracking("BestTime - Usage",{Module:crmBstTime.module,viewType:e,BestTimeTo:t})}))},getDateCri:function(e){var t=$L.moment().toDate();return e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()?"Today":e.getDate()==t.getDate()+1&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()?"Tomorrow":"Other"},setPosition:function(){var e=$("#BestTimeDetailsPage");if(!e||e.length){var t=e.outerWidth(),a=$("#bcWraperDiv").outerWidth(),r=$(".bcCardDetail"),i=r.outerWidth()+t,n=a-i<=0?0:a-i;0!==(n=n-50>400?n-200:n-50>300?n-100:n-50>250?n-50:n)?n+i<=a?(n=n-10<=0?0:n-10,e.hasClass("flex-grid-skeleton")||(Crm.userDetails.RTL_ENABLED?e.hide().fadeIn(100).css({"margin-right":n-5}):e.hide().fadeIn(100).css({"margin-left":n-5}))):(n=n+i-a,e.hasClass("flex-grid-skeleton")||(Crm.userDetails.RTL_ENABLED?e.hide().fadeIn(100).css({"margin-right":n-10}):e.hide().fadeIn(100).css({"margin-left":n-10}))):r.length&&!$(".DetailsPageRevampBox").length&&r.find(".busniess_card_Hover").addClass("dITruncateFields")}},showBestTimeInList:function(){if($(".dItimesdiv").find("li").show(),$("#ctiapi_activitys_create_call").is(":visible")||$("#ctiapi_activitys_create_task").is(":visible"))crmBstTime.hideBestTimeSuggestion("QuickCreateTask");else{$("#bestTimeListFilterId").removeClass("filtered");var e=$("#quick_module").val();if("Tasks"===e)crmBstTime.loadBestTimeData("QuickCreateTask");else if("Calls"===e){var t=$("#leContModName"),a=t&&t.val()?t.val().length:"";$L("#whichCall1").prop("checked")||$L("#whichCall2").prop("checked")||0===a?crmBstTime.hideBestTimeSuggestion("QuickCreateCall"):crmBstTime.loadBestTimeData("QuickCreateCall")}else $("#statusHeading").text()===I18n.getMsg("Re-schedule")&&crmBstTime.loadBestTimeData("Reschedule");0===$("#sdiv").find("li.bestTime").length&&crmBstTime.hideBestTimeSuggestion("QuickCreateTask")}},showFilteredBestTime:function(e){var t=$(".dItimesdiv"),a=$(e),r=$("#sdiv"),i=r.outerHeight(),n=$("#bestTimeListFilterId"),s=n.outerHeight()+3;if(a.hasClass("filtered")?(t.find("li").show(),a.removeClass("filtered")):(a.addClass("filtered"),t.find("li").hide(),t.find("li.bestTime").show()),$(".tA").length)if($(".filtered").length){n.attr("w",i);var l=i-r.outerHeight();crmBstTime.cTop=r.offset().top+l,n.css({top:crmBstTime.cTop+r.height()+4}),r.css({top:crmBstTime.cTop,"padding-bottom":s})}else{l=n.attr("w")-i;var o=crmBstTime.cTop-l;n.css({top:o+r.height()+4}),r.css({top:o,"padding-bottom":s})}else r.css({"padding-bottom":s}),n.css({top:t.offset().top+t.height()+4});n.removeClass("bottomAlignClicked"),Crm.client_tracking("BestTime - Usage",{Module:crmBstTime.module,viewType:"QuickCreateCall"})},showRightpanelRemTime:function(e){crmBstTime.isRemainingTimeShown?(crmBstTime.isRemainingTimeShown=!1,$(".dIrightPanelTags").fadeIn(200),$(e).addClass("dIKanbanRightPanelRotateIcon")):(crmBstTime.isRemainingTimeShown=!0,$(".dIrightPanelTags").fadeOut(200),$(e).removeClass("dIKanbanRightPanelRotateIcon"))},setBestTimeValueforCall:function(){var e=Utils.getDateInUserDatePattern(crmBstTime.detailsPageDate),t=crmBstTime.detailsPageTime[1]+":"+crmBstTime.detailsPageTime[2];$("#whichCall3").trigger("click"),$("[id='Call Start TimedateTime']").attr("value",t).effect("highlight",{},1e3),$('[name="property(Call Start Time)"]').val(e).effect("highlight",{},1e3),$('[name="property(Call Start Timehour)"]').val(crmBstTime.detailsPageTime[1]),$('[name="property(Call Start Timeminute)"]').val(crmBstTime.detailsPageTime[2]);var a=$("[id='Call Start Time_ampmSpan']");if(a.length){var r=I18n.getMsg("AM")===crmBstTime.detailsPageTime[3]?"AM":"PM";a.text(I18n.getMsg(crmBstTime.detailsPageTime[3])),$('[name="property(Call Start Timeampm)"]').val(r)}$("#qCreate").addClass("qCreateCallCenter"),$("#saveCall").show(),$("#startCurrCall").hide(),$("#Zia_CreateCall").removeClass("BT"),$("#bestTimeUsageId").val("Used")},setBestTimeValueforTask:function(){var e=Utils.getDateInUserDatePattern(crmBstTime.detailsPageDate),t=crmBstTime.detailsPageTime[1]+":"+crmBstTime.detailsPageTime[2];$("#qCreate").addClass("qCreateCallCenter"),$("#dateBasedRemindAtTime").attr("value",t),$('[name="property(Remind Athour)"]').val(crmBstTime.detailsPageTime[1]),$('[name="property(Remind Atminute)"]').val(crmBstTime.detailsPageTime[2]);var a=$("[id='Remind At_ampmSpan']");if(a.length){var r=I18n.getMsg("AM")===crmBstTime.detailsPageTime[3]?"AM":"PM";a.text(I18n.getMsg(crmBstTime.detailsPageTime[3])),$('[name="property(Remind Atampm)"]').val(r)}Crm.userDetails.detailView_newUI?($("#Zia_CreateTaskCall").removeClass("BT"),$("#Zia_CreateTaskMail").removeClass("BT")):$("#Zia_CreateTask").removeClass("BT"),$(getElemById("Call Start TimedateTime")).val(e),$("#qc_rem_date").val(e),$("#bestTimeUsageId").val("Used"),$('select[name="alertType"]').val("popup").change(),$("#remindAtInfo").addClass("BT"),$("#remindAtCheckbox").prop("checked",!0),quickTask.setReminder(),Crm.userDetails.detailView_newUI?quickTask.createReminder():$("#doneRemindAt").trigger("click")},sendBestTimeReminderRequest:function(e,t,a,r){Lyte.injectResources([networkUtils.returnDependencyFiles(["zia_reminder_model.js"],ResourceConstants.CRMClient)[0]],void 0,(function(){store.findAll("zia_reminder",e,!1,!1,r).then((function(e){var r=Lyte.Router.getRouteInstance().parent&&Lyte.Router.getRouteInstance().parent.parent&&"voc"===Lyte.Router.getRouteInstance().parent.parent.routeName;if(e&&""!==e&&(crmBstTime.reminderTime=e.ReminderTime),"listView"===t){var i=Lyte.Router.getRouteInstance().routeName;if(e.result&&(e.overAll_status?crmui.showMsgBand("success",I18n.getMsg("crm.best.time.zia.success.msg"),2e3):void 0!==e.overAll_status&&crmui.showMsgBand("warning",I18n.getMsg("crm.best.time.zia.warning.msg"),5e3),!a))if("list"===i||"kanban"===i||"chart"===i||"canvas"===i||r){if("chart"===i||r){var n=$L("#listViewPopup")[0];(n&&$L("crm-chart-view")[0]||r)&&n.component.closeModal()}void 0!==e.overAll_status||"kanban"===i||"canvas"===i?Lyte.registeredMixins["crm-view-utils"].clearSelection():crmListView.reloadCurrentListView(void 0,"list")}else crmListView.selectAllEntity();r&&(customViewObject.selectedIds=[]),hideAnimatePopup("topBandPopup",!0),commonUtils.showHideLoadingDiv(),renderingUtils.removeFreezeLayer()}else if("restore"===t){crmBstTime.setToLocalStorage();var s=e.notifications;if(void 0!==s)for(var l=s.length,o=0;o<l;o++)crmBstTime.showReminderPushNotification(s[o],"customMsg")}}))}))},showReminderPushNotification:function(e,t){var a=crmBstTime.orderid;crmBstTime.reminderInformation[crmBstTime.orderid]=e,0===crmBstTime.notificationFlag&&(crmBstTime.setTopEle(crmBstTime.increment),crmBstTime.notificationFlag=1);var r=27e5;if(void 0!==t){var i=$L.moment().toDate().getTime();r=crmBstTime.getDateObject(e.time,!0).getTime()-i+18e5}crmBstTime.pushNotificationList["notificationTimeout"+a]=setTimeout((function(){crmBstTime.hideRemoveNotification(a,$("#crmBtReminder"+a),void 0,!1)}),r),crmBstTime.orderid++},setTopEle:function(e){crmBstTime.increment=e;var t=Object.keys(crmBstTime.reminderInformation).length,a=$(".diCrmBestTmeRepDiv"),r=$("body");a.length||(r.append('<div class="diCrmBestTmeRepDiv"><div class="crm-font-regular headerClassdI" id="reminderTopBand" ><span class="fL mR5">'+I18n.getMsg("crm.best.time.zia.notification.title")+'</span><div class="divOrderIc fL cP" onclick="crmBstTime.openNotificationSettings()"></div><div class="fR cP" data-zcqa="zia_dissmissAll" onclick="crmBstTime.dismissAllNotification()">'+I18n.getMsg("crm.best.time.zia.dismiss.all")+"</div></div></div>"),a=$(".diCrmBestTmeRepDiv"));var i=$(".diCrmBestTmeRepDiv .headerClassdI"),n=i.outerHeight(),s=$(".headerClassdI").outerHeight(),l=$("#moreNotification");l.length||r.append(renderingUtils.createHTML({name:"div",attr:{class:"dishowMoreOptNotification dishowMoreOptNotification",id:"moreNotification",onclick:"crmBstTime.toShowAllNotification(this)","data-zcqa":"zia_moreOption"},child:[{name:"text",content:"1"+I18n.getMsg("crm.label.More")}]}));var o=$(".dishowMoreOptNotification");if(e<t){var c=crmBstTime.reminderInformation[crmBstTime.increment];if(c&&c.entity_detail){var d=void 0===c.accountName?" ":c.accountName,m=c.time;c.time.includes("AM")?m=(m=c.time.replace("AM",""))+" "+I18n.getMsg("AM"):c.time.includes("PM")&&(m=(m=c.time.replace("PM",""))+" "+I18n.getMsg("PM"));var p="<div id=crmBtReminder"+crmBstTime.increment+" data-id="+c.id+' class="popReminderFromBestTime" databesttimeorderid='+crmBstTime.increment+'><div class="remBandCont fL"><div class="profileSectionCont w100_per"><div class="profTextCont crm-font-regular w100_per"><div id="crmBtReminderContactName" class="profTextcontName fL cBoth mB4" data-zcqa="zia_openEntity'+crmBstTime.increment+'" onClick="crmBstTime.openEntityInNewWindow('+crmBstTime.increment+')">'+$ESAPI.encoder().encodeForHTML(c.name)+'</div><span class="profTextTitTime fR ellipsistext" title="'+m+'">'+m+'</span><div id="crmBtReminderAccountName" class="profcontOrg fL crm-font-regular cBoth">'+$ESAPI.encoder().encodeForHTML(d)+'</div></div></div><div class="remBandButton mT8"><button class="remBandGreen crm-font-regular  mR5" data-zcqa="zia_displayPhoneNo'+crmBstTime.increment+'" id=notificationCallButton'+crmBstTime.increment+' onclick="crmBstTime.displayPhoneNumber(this,'+crmBstTime.increment+');sE(event);">'+I18n.getMsg("Call")+'</button></div></div><div class="fL popRightPanelbutton"><div class="viewbtnStyle cP" data-zcqa="zia_dismiss" onClick="crmBstTime.hideRemoveNotification('+crmBstTime.increment+',this,event);sE(event);">'+I18n.getMsg("crm.eventreminder.dismiss")+'</div><div class="viewbtnStyle laterViewBtn cP" onClick="crmBstTime.displayLaterTime(this,'+crmBstTime.increment+');sE(event)" style="border-bottom:0px;">'+I18n.getMsg("crm.tpi.ctiapi.button.label.notification.later")+"</div></div></div>";p=Handlebars.compile(p);var h={};h[c.entity_detail.seId+""]=c.gmtTime+":"+c.viewId,crmBstTime.setToLocalStorage(c.id,h,"add");var u=$(".popReminderFromBestTime"),f=u.length;0===f?a.append(p):($(p.call()).insertAfter(u.last()),f+=1),void 0!==c.entity_detail.callOptions&&c.entity_detail.callOptions.length||$("#notificationCallButton"+crmBstTime.increment).text(I18n.getMsg("crm.label.view")).addClass("viewLabel"),a.show();var v=$("#crmBtReminder"+crmBstTime.increment),g=v.outerWidth()+3,S=v.outerWidth()/2-o.outerWidth()/2,C=v.outerHeight();i.css({width:g-3}),a.css({width:g,height:n+3*C}),a.hasClass("showMoreOpened")?crmBstTime.toShowAllNotification():f>=3?a.css({height:n+3*C}):crmBstTime.toShowAllNotification(),o.css({top:s+3*C+16,right:S});var y=$(".toAvoidbord");if(!a.hasClass("showMoreOpened")&&f>=3){var I=f-3;I>0&&(l.text(I+" "+I18n.getMsg("crm.label.More")).show(),a.hasClass("ps-container")&&thirdPartyUtils.unbindPerfectScroll(a),y.show(),thirdPartyUtils.bindPerfectScroll(a,{preventHorizontal:!0}))}y.length||a.append('<div class="toAvoidbords"></div>'),setTimeout((function(){i.fadeIn(350),$("#crmBtReminder"+crmBstTime.increment).css({right:"3px",opacity:1,top:"27px"}).show(),crmBstTime.setTopFromNew($("#crmBtReminder"+crmBstTime.increment),crmBstTime.increment)}),1e3)}}else crmBstTime.notificationFlag=0},toShowAllNotification:function(e){var t=$(".popReminderFromBestTime"),a=$("#wmstoolbar"),r=a.length?a.outerHeight():28,i=t.one().outerHeight()*t.length+$(".headerClassdI").outerHeight()+27-r;renderingUtils.windowHeight<=i&&(i=renderingUtils.windowHeight-7-a.outerHeight());var n=$(".diCrmBestTmeRepDiv");$(e).hide(),e&&n.addClass("showMoreOpened"),n.css({height:i,overflow:"auto"})},setTopFromNew:function(e,t){var a=$(e).prev(".popReminderFromBestTime"),r=a.nextAll(".popReminderFromBestTime").length*a.outerHeight()+27;a.css({top:r,right:"3px"}),$(".toAvoidbord").css({top:95+r}),a.prev(".popReminderFromBestTime").length?crmBstTime.setTopFromNew(a,t):crmBstTime.setTopEle(t+1)},dismissReminderPushNotificaiton:function(e){var t=e.nId;if("0"===t){for(x in $(".diCrmBestTmeRepDiv").remove(),$("#reminderTopBand, #moreNotification").hide(),crmBstTime.increment=0,crmBstTime.orderid=0,crmBstTime.notificationFlag=0,crmBstTime.reminderInformation={},crmBstTime.pushNotificationList)clearTimeout(crmBstTime.pushNotificationList[x]);crmBstTime.setToLocalStorage()}else{var a=$("[data-id="+t+"]");if(a.length){var r=a.attr("id").replace("crmBtReminder","");crmBstTime.hideRemoveNotification(r,a,void 0,!1)}}},displayLaterTime:function(e,t){var a=I18n.getMsg("mins"),r="<div class='diLaterTimeDiv' id='diLaterTimeDiv'><ul class='p0 m0'><li class='crm-font-regular m0' data-zcqa='zia_reschedule5' onClick='crmBstTime.rescheduleReminder(this,"+t+",5);sE(event)'>5 "+a+"</li><li class='crm-font-regular m0' data-zcqa='zia_reschedule10' onClick='crmBstTime.rescheduleReminder(this,"+t+",10);sE(event)'>10 "+a+"</li><li class='crm-font-regular m0 lastForBorder' data-zcqa='zia_reschedule15' onClick='crmBstTime.rescheduleReminder(this,"+t+",15);sE(event)'>15 "+a+"</li></ul></div>",i=$(".remindMeTime .listElements:not(.nextBestTime)").clone(),n="",s=$(e),l="hh:mm a"===Crm.userDetails.TIME_FORMAT,o=crmBstTime.reminderInformation[t].entity_detail.laterTimes,c=s.offset().left,d=s.offset().top+s.outerHeight()-3,m=void 0===o?0:o.length;if(m>0){n=n+'<li class="crm-font-regular m0 diLaterTimesForLi firstForBorder" data-zcqa="zia_reschedule1" onClick="crmBstTime.rescheduleReminder(this,'+t+');" gmtTime='+o[0].gmtTime+">"+(l?crmBstTime.get12HourTimeFormat(o[0].timeString):o[0].timeString)+"</li>";for(var p=1;p<m;p++)n=n+'<li class="crm-font-regular m0 diLaterTimesForLi" data-zcqa="zia_reschedule'+p+'" onclick="crmBstTime.rescheduleReminder(this,'+t+');"  gmtTime='+o[p].gmtTime+">"+(l?crmBstTime.get12HourTimeFormat(o[p].timeString):o[p].timeString)+"</li>"}i.removeAttr("onmouseout").removeAttr("onmouseover"),i.removeClass("listElements"),n=Handlebars.compile(n),$("#diLaterTimeDiv").remove(),$("body").append(r),$(".diLaterTimeDiv .p0").append(n),0===$(".diLaterTimesForLi").length&&$(".lastForBorder").removeClass("lastForBorder"),$(".diLaterTimeDiv").css({left:c,top:d}).show(),$(".dICallTimerDiv").hide(),$(".clikedLaterbtn").removeClass("clikedLaterbtn"),s.addClass("clikedLaterbtn")},rescheduleReminder:function(e,t,a){$(".diLaterTimeDiv").hide();var r=crmBstTime.reminderInformation[t],i=void 0,n=void 0;void 0!==a?(i=60*a*1e3,n="modify"):(i=e.getAttribute("gmtTime"),n="add");var s={seId:r.entity_detail.seId,reminderTime:i,viewId:r.viewId,operation:n,userTZ:Crm.userDetails.USER_TIME_ZONE,timeFormat:Crm.userDetails.TIME_FORMAT};crmBstTime.hideRemoveNotification(t,$("#crmBtReminder"+t)),crmBstTime.sendBestTimeReminderRequest(s,null,!1)},initCallfromReminder:function(e,t){$(".dICallTimerDiv").hide(),$(".callBtnSel").removeClass("callBtnSel");var a=t.getAttribute("lastusedorderid");if(Crm.userDetails.TELEPHONY_ENABLED){var r=crmBstTime.reminderInformation[a].entity_detail;ctiApiNotifier.click2Call($(t).children(".offNo").text(),Crm.userDetails.ZGID,Crm.userDetails.USER_ID,r.id,"",r.module,crmBstTime.reminderInformation[a].name)}else window.ZPB&&ZPB.clickToDial.isEnabled()?crmCallsNew.initiateCallViaZPB($(t).children(".offNo").text(),r.id,r.module,crmBstTime.reminderInformation[a].name):window.location="skype:+"+$(t).children(".offNo").text()+"?call";crmBstTime.hideRemoveNotification(a,$("#crmBtReminder"+a))},displayPhoneNumber:function(e,t){var a=$(e),r=a.offset().left,i=a.offset().top+a.outerHeight()+3,n=crmBstTime.reminderInformation[t].entity_detail.callOptions;if($(".callBtnSel").removeClass("callBtnSel"),a.addClass("callBtnSel"),$("#diCallToolTip").hide(),a.hasClass("viewLabel"))a.removeClass("viewLabel"),crmBstTime.openEntityInNewWindow(t),crmBstTime.hideRemoveNotification(t,$("#crmBtReminder"+t));else{for(var s="<div class='dICallTimerDiv' id='diCallToolTip' ><ul class='p0 m0' style='display:table'>",l=n.length,o=0;o<l;o++)s=s+"<li class='crm-font-regular m0 diPersonalTime' data-zcqa='zia_phone'"+o+"' id='crmBtReminderCallMobile' lastUsedOrderId="+t+" onClick='crmBstTime.initCallfromReminder(1,this);sE(event);'><span class='offLab crm-font-regular'>"+$ESAPI.encoder().encodeForHTML(I18n.getMsg(n[o].displayName))+"</span><span class='offNo'>"+$ESAPI.encoder().encodeForHTML(n[o].number)+"</span></li>";s+="</ul></div>",s=Handlebars.compile(s),$("#diCallToolTip").length?$("#diCallToolTip").replaceWith(s):$("body").append(s)}$("#diCallToolTip").css({left:r,top:i}).show(),$(".diLaterTimeDiv").hide()},openEntityInNewWindow:function(e){var t=crmBstTime.reminderInformation[e].entity_detail;networkUtils.openUrl(networkUtils.getOrgSpecificURL(Crm.getCrmBasePath()+"/EntityInfo.do?module="+t.module+"&id="+t.seId))},hideRemoveNotification:function(e,t,a,r){delete crmBstTime.pushNotificationList["notificationTimeout"+e];var i=$(t),n=crmBstTime.reminderInformation[e].id;crmBstTime.reminderInformation[e]="",clearTimeout(crmBstTime.pushNotificationList["notificationTimeout"+e]),$(".diLaterTimeDiv, .dICallTimerDiv").hide();var s=i.parents(".popReminderFromBestTime"),l=s.length?s:i;crmBstTime.dismissNotification(l),l.remove();var o=$(".popReminderFromBestTime");($L(".showMoreOpened").length||o.length<=2)&&crmBstTime.toShowAllNotification();var c=$L(".diCrmBestTmeRepDiv"),d=c.scrollTop();c.scrollTop(d-95),thirdPartyUtils.unbindPerfectScroll(c),thirdPartyUtils.bindPerfectScroll(c,{preventHorizontal:!0}),crmBstTime.setToLocalStorage(n,void 0,"remove"),r||crmBstTime.saveReminderSettings({nId:n,op:"dismiss",action:"ziaReminder"},void 0,!0);var m=o.length;m?m<=3?($("#moreNotification").hide(),$(".toAvoidbord").hide(),c.hasClass("ps-container")&&thirdPartyUtils.unbindPerfectScroll(c)):$("#moreNotification").text(o.length-3+" "+I18n.getMsg("crm.label.More")):($("#reminderTopBand").hide(),c[0].remove(),crmBstTime.increment=0,crmBstTime.orderid=0,crmBstTime.notificationFlag=0,crmBstTime.reminderInformation={},crmBstTime.setToLocalStorage())},dismissNotification:function(e){var t=$(e),a=t.prev(".popReminderFromBestTime"),r=t.prev(),i=$(".toAvoidbord");if(a.length){var n=parseInt(r.css("top"))-parseInt(r.outerHeight());i.css({top:n+95}),a.css({top:n}),a.prev(".popReminderFromBestTime").length&&crmBstTime.dismissNotification(a)}else i.css({top:parseInt(i.css("top"))-95})},dismissAllNotification:function(){for(x in $(".diCrmBestTmeRepDiv").remove(),crmBstTime.increment=0,crmBstTime.orderid=0,crmBstTime.notificationFlag=0,crmBstTime.reminderInformation={},crmBstTime.pushNotificationList)clearTimeout(crmBstTime.pushNotificationList[x]);crmBstTime.setToLocalStorage(),crmBstTime.pushNotificationList={},$("#moreNotification").hide(),crmBstTime.saveReminderSettings({nId:0,op:"dismiss",action:"ziaReminder"},void 0,!0)},openNotificationSettings:function(){networkUtils.openUrl(networkUtils.getOrgSpecificURL(Crm.getCrmBasePath()+"/ShowSetup.do?tab=general&subTab=ZiaSettings&action=remindersettings"))},openNotificationSettingsSameWindow:function(){Utils.windowLocationHref(Crm.getCrmBasePath()+"/ShowSetup.do?tab=general&subTab=ZiaSettings&action=remindersettings")},saveReminderSettings:function(e,t,a,r){var i=new crmRequestPool;e.userTZ=Crm.userDetails.USER_TIME_ZONE,e.crmcsrfparam=cookieUtils.getCookie("crmcsr"),i.initiate({action:Crm.getCrmBasePath()+"/ZiaReminderAction.do",type:"POST",data:e,success:function(e){if(void 0!==e&&""!==e){function i(t,r){return t&&(e.configs=r,crmBstTime.renderReminderSettings(e)),void 0===a&&crmui.showMsgBand("success",I18n.getMsg("crm.best.time.zia.settings.updated"),1500),e}t?r&&i(t,r):i()}},error:function(){void 0===a&&crmui.showMsgBand("failure",I18n.getMsg("crm.zia.config.not.saved"),1e3)}})},showZiaReminderSettingsforListView:function(e,t,a){Crm.client_tracking("BestTime - SetReminderClick",{Module:e}),Lyte.injectResources([networkUtils.returnDependencyFiles(["zia_reminder_model.js"],ResourceConstants.CRMClient)[0]],void 0,(function(){var r=!!crmListView.getObject().doMassActioninScheduler&&crmListView.getObject().doMassActioninScheduler;commonUtils.showHideLoadingDiv(!0),"HomePage"!==e&&"Tasks"!==e&&"Events"!==e&&"Calls"!==e||(e="Activities");var i=!1;void 0===t&&(t=$(a).attr("cvid"),r=!0,i=!0);var n={operation:"getLCount",viewId:t,seModule:e,userTZ:Crm.userDetails.USER_TIME_ZONE};store.findAll("zia_reminder",n).then((function(a){var n=a.layoutCount;if(n){var s=n.layoutCount,l=!1;if(n.nodata_records&&n.beyond_businesshrs&&n.new_records&&(l=!0),s>=5&&!l)crmBstTime.showLimitReachedWarning();else{renderingUtils.freezeBackground();var o={module:e,cvid:t.toString(),noData:n.nodata_records,businessHr:!!n.disableBusinessHr||n.beyond_businesshrs,newRecord:n.new_records,isMassUpdate:r,isUpdate:l,isHomePage:i,disableBusinessHr:n.disableBusinessHr};if(Handlebars.templates.ziaReminderSetup){var c=Handlebars.templates.ziaReminderListViewSetup(o);$("#topBandPopup").html(c).addClass("zcrm-show").show()}else networkUtils.loadFeatureScripts(["zohocrm_ziaReminderSetup.js"],(function(){var e=Handlebars.templates.ziaReminderListViewSetup(o);$("#topBandPopup").html(e).addClass("zcrm-show").show()}));crmui.modalZIndex("nonLyte",$L("#topBandPopup")[0],"open"),commonUtils.showHideLoadingDiv()}}else commonUtils.showHideLoadingDiv(!1)}),(function(){commonUtils.showHideLoadingDiv(!0)}))}))},showLimitReachedWarning:function(){if(!$(".warningPopForlimitReached").length){var e="<div class='warningPopForlimitReached' data-zcqa='zia_limitReachWarning' id='warningPopForlimitReached'><span class='warningCont crm-font-regular fL pR pL20'>"+I18n.getMsg("crm.best.time.zia.layout.count.error")+"</span><div class='fL cB w100p pL20 mT20'><input type='button' style='font-size: var(--crm-extra-medium-font-size) !important;' class='primarybtn mR10' onclick=\"crmBstTime.openNotificationSettingsSameWindow();$('#warningPopForlimitReached').hide();renderingUtils.removeFreezeLayer();\" value='"+I18n.getMsg("crm.best.time.zia.manage.reminders")+"'/> <input type='button' value='"+I18n.getMsg("Cancel")+"' class='cP crm-font-regular newwhitebtn' onclick=$('#warningPopForlimitReached').hide();renderingUtils.removeFreezeLayer();commonUtils.showHideLoadingDiv();> </div></div>";$("body").append(Handlebars.compile(e))}var t=$("#warningPopForlimitReached"),a=$("#remindByZia");if(renderingUtils.freezeBackground(),a.length){var r=a.offset().left+a.outerWidth()-t.outerWidth()/2-56,i=a.offset().top+a.outerHeight();t.removeClass("hideArrowTop"),t.css({left:r,top:i}).show()}else{i=renderingUtils.tabLayerTop()+renderingUtils.tabLayerOuterHeight(),r=mailsetCenter("warningPopForlimitReached \t");t.addClass("hideArrowTop"),t.css({top:i,"margin-top":"0"})}},scheduleListViewReminder:function(e,t,a,r){var i=null;if(!a&&"Activities"===e.moduleName&&Crm.isActivitySplitDone)if(e.moduleName!==Lyte.Router.getRouteInstance().parent.parent.getDynamicParam()){var n=Lyte.Router.getRouteInstance().parent.parent.getDynamicParam();i=crmTab.getFromCache(n).selectedIds}else i=crmTab.getFromCache(e.moduleName).selectedIds;else a||(i=crmTab.getFromCache(e.moduleName).selectedIds);var s={seId:a?0:i.join(";"),viewId:t,operation:"schedule",noBestTime:$("#noBestTimeCheck").is(":checked"),beyondBusinesHr:$("#businessHourCheck").is(":checked"),newRecord:$("#newRecordCheck").is(":checked"),seModule:e.moduleName,userTZ:Crm.userDetails.USER_TIME_ZONE,isMassJobScheduled:a},l=0;l=s.noBestTime?l+4:l,l=s.beyondBusinesHr?l+2:l,l=s.newRecord?l+1:l,Crm.client_tracking("BestTime - ListViewReminder",{Module:s.seModule,checkbox:l}),commonUtils.showHideLoadingDiv(!0),crmBstTime.sendBestTimeReminderRequest(s,"listView",r)},renderReminderSettings:function(e){var t={display:!1},a="hh:mm a"===Crm.userDetails.TIME_FORMAT;if(e.configs){var r=e.configs[0].configs[0];r.category=e.configs[0].category,t.config=r}if(e.notification){var i=e.reminderDetails;t.display=!0,t.is12Hours=a,t.notification=e.notification,a?(t.startTime=crmBstTime.get12HourTimeFormat(e.pause_startTime),t.endTime=crmBstTime.get12HourTimeFormat(e.pause_endTime)):(t.startTime=e.pause_startTime,t.endTime=e.pause_endTime),t.pauseStatus=e.pause_status,t.reminderSettings=n;var n={};if(i){if(void 0!==i.Leads&&i.Leads.length>0){var s=void 0!==Crm.moduleInfo.Leads?Crm.moduleInfo.Leads.translatedPluralLabel:"Leads";n.lead={name:s,value:i.Leads,id:0}}if(void 0!==i.Contacts&&i.Contacts.length>0){var l=void 0!==Crm.moduleInfo.Contacts?Crm.moduleInfo.Contacts.translatedPluralLabel:"Contacts";n.contact={name:l,value:i.Contacts,id:1}}if(void 0!==i.Activities&&i.Activities.length>0){var o=void 0!==Crm.moduleInfo.Activities?Crm.moduleInfo.Activities.translatedPluralLabel:"Activities";n.Activity={name:o,value:i.Activities,id:2}}}var c=[];void 0!==e.pause_days&&(c=e.pause_days.split(",")),t.daysList=[];for(var d=1,m=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],p=0;p<7;p++){var h={value:d,checked:c[p],day:I18n.getMsg(m[p])};d+=d,t.daysList.push(h)}}Handlebars.templates.ziaReminderSetup?crmBstTime.showZiaReminderSettings(t):networkUtils.loadFeatureScripts(["zohocrm_ziaReminderSetup.js"],(function(){crmBstTime.showZiaReminderSettings(t)}))},showZiaReminderSettings:function(e){$("#settingInner").hide();var t=$("#result");t.html(Handlebars.templates.ziaReminderSetup(e)),t.show(),crmBstTime.onZiaSetupDaySelect(!0),crmLayout.Resize.Setup(),$("[data-fieldtype=timeField]").each((function(e,t){t.value=$(this).val(),crmTemplate.bindEventsToTimeField.call(t,crmBstTime.onZiaPauseTimeChanged)})),$("#ziaPauseEndTime").click((function(){$("#ziaPauseStartTime_List").hide();var e=$("#ziaPauseStartTime").val(),t=$("#ziaPauseEndTime_List li");t.hide(),crmBstTime.ziapauseInc=1,crmBstTime.ziapauseFlag=0,t.each((function(){$(this).text().trim()==e&&($(this).hide(),crmBstTime.ziapauseFlag=1),1==crmBstTime.ziapauseFlag&&($(this).text().trim()==e?$(this).hide():$(this).show(),crmBstTime.ziapauseInc=crmBstTime.ziapauseInc+1,crmBstTime.ziapauseInc>=12&&(crmBstTime.ziapauseFlag=0))})),$(".timeList").perfectScrollbar("update")})),$("#ziaPauseStartTime").click((function(){$("#ziaPauseEndTime_List").hide(),$("#ziaPauseStartTime_List ziaPauseStartTime_SCROLLDIV").find("li").last().hide()})),$("#setupshow,#mainResult").show(),crmSetup.SetHeight_setup_inner_content(),crmBstTime.setWidthForListSpan()},onZiaSetupDaySelect:function(e){var t=0,a=[],r=[0,0,0,0,0,0,0],i=void 0;if($("#ziaDaysList .p0").each((function(e){if($(this).find("input:checkbox").is(":checked")){var i=$(this);t+=parseInt(i.find("label").attr("value")),r[e]=1,a.push(I18n.getMsg(crmBstTime.daysShortForm[e]))}})),i=127===t?I18n.getMsg("day"):31===t||63===t?I18n.getMsg("crm.best.time.weekdays"):96===t?I18n.getMsg("crm.best.time.weekends"):a.join(", "),$("#ziaPauseDayText").text(i),void 0===e){var n={op:"pauseSetup",daysList:r.join(),action:"ziaReminder"};crmBstTime.saveReminderSettings(n,void 0,!0),crmBstTime.setWidthForListSpan()}},onZiaPauseTimeChanged:function(){var e="hh:mm a"===Crm.userDetails.TIME_FORMAT,t="",a=$("#ziaPauseEndTime"),r=crmBstTime.getDateObject($("#ziaPauseStartTime").val()),i=crmBstTime.getDateObject(a.val()),n=(i-r)/36e5;if(n<=6&&n>0)t=crmBstTime.getFormattedTime(!1,r)+","+crmBstTime.getFormattedTime(!1,i);else if(n<=0)crmui.showMsgBand("error",I18n.getMsg("crm.start.before.end.time"),4e3);else{var s=new Date(r.getTime()+18e5);a.val(crmBstTime.getFormattedTime(e,s)),t=crmBstTime.getFormattedTime(!1,r)+","+crmBstTime.getFormattedTime(!1,s)}""!==t&&crmBstTime.saveReminderSettings({op:"pauseSetup",fromToTime:t,action:"ziaReminder"},void 0,!0),crmBstTime.setWidthForReminderInput()},setWidthForListSpan:function(){var e=0;crmBstTime.setWidthForReminderInput();var t=$("#ziaReminderSettings .indsubSpan");t.css({width:"auto"}),t.each((function(){$(this).outerWidth()>e&&(e=$(this).outerWidth())})),t.css({width:e+30}),crmLayout.Resize.Setup(),$("#setup_new_ContentDiv").addClass("oA")},setWidthForReminderInput:function(){var e=$("#ziaPauseStartTime"),t=$("#ziaPauseEndTime"),a=e.val(),r=t.val(),i=renderingUtils.createHTML({name:"div",attr:{class:"dIstartTimeEndTime"}});$("body").append(i);var n=$(".dIstartTimeEndTime"),s=n.text(a).outerWidth(),l=n.text(r).outerWidth();e.css({width:s}),t.css({width:l}),n.remove()},checkZiaPendingReminder:function(){var e=crmBstTime.getFromLocalStorage(),t=[];for(var a in e){var r=e[a],i=Object.keys(r),n=r[i].split(":"),s={notificationId:a,time:n[0],seId:i[0],viewId:n[1]};t.push(s)}Object.keys(e).length>0&&history.length>1&&crmBstTime.sendBestTimeReminderRequest({operation:"restore",viewId:0},"restore",!1,t)},getFormattedTime:function(e,t,a){var r=t.getHours(),i=t.getMinutes(),n="";if(e){n="AM";0===r?r=12:12===r?n="PM":r>12&&(r-=12,n="PM")}return r<10&&(r="0"+r),i<10&&(i="0"+i),n=a?n:I18n.getMsg(n),e?r+":"+i+" "+n:r+":"+i},constructDateObject:function(e,t){return e?CrmDateUtils.getDateObjectFromString(e,t):new Date(e)},sleep:function(e){var t=$L.moment().toDate(),a=null;do{a=$L.moment().toDate()}while(a-t<e)},getMonthName:function(e){return crmBstTime.months[e.getMonth()]},getDayName:function(e){return crmBstTime.days[e.getDay()]},getDateObject:function(e,t){var a=void 0===t?e.match(new RegExp("(\\d+):(\\d+) ?("+I18n.getMsg("AM")+"|"+I18n.getMsg("PM")+"|)")):e.match(new RegExp("(\\d+):(\\d+) ?(AM|PM|)")),r=$L.moment().toDate();return r.setSeconds(0,0),"PM"===a[3]||I18n.getMsg("PM")===a[3]?"12"!==a[1]?r.setHours(12+parseInt(a[1])):r.setHours(12):"AM"!==a[3]&&I18n.getMsg("AM")!==a[3]||"12"!==a[1]?r.setHours(a[1]):r.setHours(0),r.setMinutes(a[2]),r},get12HourTimeFormat:function(e){var t=e.split(":"),a=t[0],r=t[1],i="AM";return 0==a?a=12:12==a?i="PM":a>12&&(a-=12,i="PM"),a<10&&1===a.toString.length&&(a="0"+a),a+":"+r+" "+(i=I18n.getMsg(i))},getFromLocalStorage:function(){var e=localStorage.getItem("ZiaReminder");return e=null===e?"{}":e,JSON.parse(e)},setToLocalStorage:function(e,t,a){var r={};"add"===a?(r=crmBstTime.getFromLocalStorage())[e+""]=t:"remove"===a&&delete(r=crmBstTime.getFromLocalStorage())[e+""],localStorage.setItem("ZiaReminder",JSON.stringify(r))},getSuggestedCallStartTimeArray:function(e,t,a){return Crm.userDetails.isBestTimeEnabledCall&&e&&t&&a?store.findAll("besttime_zia_new",{id:e,module:t,type:"Call",reqDate:a}).then((function(e){var t=e.bestTime_call;if(t){var a={};t.forEach((function(e){e.level&&e.bestTime&&(a[e.bestTime]="lev"+e.level)}))}return a})).catch((function(){return{}})):new Promise((function(e){e({})}))}};