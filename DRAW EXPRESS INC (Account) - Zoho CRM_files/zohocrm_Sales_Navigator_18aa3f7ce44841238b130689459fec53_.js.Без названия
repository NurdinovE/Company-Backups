var SalesNavigator={snData:"",loadSalesNavigator:function(){var n=$('[ddname="LINKEDIN_SALES_NAVIGATOR_PERSONALITY"]');if(n.length>0){var e=renderingUtils.windowHeight,t=n.offset().top,a=$("#linked_in_container");t>0&&t<e&&(1==a.children().length&&"true"!==a.attr("load")||crmConstants.reloadSalesNavigator)&&(a.attr("load","true"),(returnJson.Leads||returnJson.Contacts||returnJson.Potentials||returnJson.Accounts)&&SalesNavigator.loadSalesNavigatorRelatedList())}},loadSalesNavigatorRelatedList:function(){var n=Crm.getCrmBasePath()+"/SalesNavigator.do",e={action:"get_widgets"};if(returnJson.Leads||returnJson.Contacts?(e.entity_id=returnJson.relListLabelsJson.entityid,returnJson.Leads&&returnJson.entityMapJson.COMPANY&&returnJson.entityMapJson.COMPANY.defaultvalue&&""!==returnJson.entityMapJson.COMPANY.defaultvalue?e.company=!0:returnJson.Contacts&&returnJson.entityMapJson.ACCOUNTID&&returnJson.entityMapJson.ACCOUNTID.defaultvalue&&""!==returnJson.entityMapJson.ACCOUNTID.defaultvalue&&(e.account_id=returnJson.entityMapJson.ACCOUNTID.defaultid),returnJson.Leads?e.module="Leads":returnJson.Contacts&&(e.module="Contacts")):returnJson.Accounts?(e.account_id=returnJson.relListLabelsJson.entityid,e.module="Accounts"):returnJson.Potentials&&(returnJson.entityMapJson.CONTACTID&&returnJson.entityMapJson.CONTACTID.defaultvalue&&""!==returnJson.entityMapJson.CONTACTID.defaultvalue&&(e.entity_id=returnJson.entityMapJson.CONTACTID.defaultid),returnJson.entityMapJson.ACCOUNTID&&returnJson.entityMapJson.ACCOUNTID.defaultvalue&&""!==returnJson.entityMapJson.ACCOUNTID.defaultvalue&&(e.account_id=returnJson.entityMapJson.ACCOUNTID.defaultid),e.module="Contacts"),e.entity_id||e.account_id){(new crmRequestPool).initiate({action:n,data:e,success:function(n){commonUtils.showHideLoadingDiv(!1),n=JSON.parse(n),SalesNavigator.snData=n,n.hasOwnProperty("sat_token")?SalesNavigator.newApiModel(n):SalesNavigator.cookieAuthModel(n)}})}else{var t=$('[ddname="LINKEDIN_SALES_NAVIGATOR_PERSONALITY"]').attr("ddid");$("#"+t).html('<table border="0" width="100%" cellspacing="0" cellpadding="0" align="center" class="norec"><tbody><tr><td valign="center"><div class="pR30 crm-font-regular-italic">'+I18n.getMsg("crm.social.lable.noDataFound")+"</div></td></tr></tbody></table>")}},revokeAccess:function(){var n=I18n.getMsg("crm.linkedin.delete.alert"),e={};e.message=n,e.noText="No",e.yesText="Yes",e.functionName="logoutSN",Lyte.Component.render("crm-social-delete-warning",e,"body").setData("renderDeletePopup",!0)},revokeAccessCallBack:function(){networkUtils.lyteInitiateRequest("/crm/v2/settings/sales_navigator/actions/revoke_access","POST").then((function(n){var e=n.code;if(e&&"SUCCESS"===e){$L("#relLinkedLogoutId").addClass("dN");var t,a=$L("#canvasLinkedLogoutId");if((t=$L("crm-social-delete-warning"))&&t.length&&(t[0].setData("renderDeletePopup",!1),t[0].remove()),a&&a.length>0)a.addClass("dN"),(t=$L("sales-navigator")[0].component).loadSalesNavigatorRelatedList();else SalesNavigator.loadSalesNavigatorRelatedList()}}))},newApiModel:function(n){var e=$("#linked_in_container");(t=$L("#relLinkedLogoutId")).text(I18n.getMsg("crm.linkedin.logout"));var t,a="https://www.linkedin.com/sales/widget/",o="",i="";if(n.entity_linkedin_id=null==n.entity_linkedin_id?SalesNavigator.snData.entity_linkedin_id:n.entity_linkedin_id,n.account_linkedin_id=null==n.account_linkedin_id?SalesNavigator.snData.account_linkedin_id:n.account_linkedin_id,delete crmConstants.reloadSalesNavigator,n.entity_linkedin_id)if(o=a+"profile-matching/?apiKey="+n.client_id+"&profile=lead&crmSourceType=ZOHO&crmOrgId="+Crm.userDetails.ZGID+"&crmRecordId="+n.entity_linkedin_id+"&version=2.1&modules=TopCard2,Icebreakers,GetIntroduced,RelatedLeads&isInlineMode=false&sat="+n.sat_token,returnJson.Leads||returnJson.Contacts)o+="&firstName="+encodeURIComponent(returnJson.entityMapJson.LASTNAME.nameInfo.firstname)+"&lastName="+encodeURIComponent(returnJson.entityMapJson.LASTNAME.nameInfo.lastname),(returnJson.Leads||returnJson.Contacts)&&(returnJson.entityMapJson.EMAIL&&""!==returnJson.entityMapJson.EMAIL.defaultvalue&&"null"!==returnJson.entityMapJson.EMAIL.defaultvalue?o+="&email="+encodeURIComponent(returnJson.entityMapJson.EMAIL.defaultvalue):returnJson.entityMapJson.ADDN_EMAIL&&""!==returnJson.entityMapJson.ADDN_EMAIL.defaultvalue&&"null"!==returnJson.entityMapJson.ADDN_EMAIL.defaultvalue&&(o+="&email="+encodeURIComponent(returnJson.entityMapJson.ADDN_EMAIL.defaultvalue))),returnJson.Leads&&returnJson.entityMapJson.COMPANY&&""!==returnJson.entityMapJson.COMPANY.defaultvalue?o+="&companyName="+encodeURIComponent(returnJson.entityMapJson.COMPANY.defaultvalue):returnJson.Contacts&&returnJson.entityMapJson.ACCOUNTID&&returnJson.entityMapJson.ACCOUNTID.defaultvalue&&(o+="&companyName="+encodeURIComponent(returnJson.entityMapJson.ACCOUNTID.defaultvalue));else if(returnJson.Potentials&&returnJson.entityMapJson.CONTACTID&&""!==returnJson.entityMapJson.CONTACTID.defaultvalue){var s=returnJson.entityMapJson.CONTACTID.defaultvalue.trim();1===s.split(" ").length?o+="&firstName="+encodeURIComponent(s.split(" ")[0]):2===s.split(" ").length&&(o+="&firstName="+encodeURIComponent(s.split(" ")[0])+"&lastName="+encodeURIComponent(s.split(" ")[1])),returnJson.entityMapJson.CONTACTID.priEmail&&""!==returnJson.entityMapJson.CONTACTID.priEmail&&"null"!==returnJson.entityMapJson.CONTACTID.priEmail?o+="&email="+encodeURIComponent(returnJson.entityMapJson.CONTACTID.priEmail):returnJson.entityMapJson.CONTACTID.EntEmail&&""!==returnJson.entityMapJson.CONTACTID.EntEmail&&"null"!==returnJson.entityMapJson.CONTACTID.EntEmail&&(o+="&email="+encodeURIComponent(returnJson.entityMapJson.CONTACTID.EntEmail)),returnJson.entityMapJson.ACCOUNTID&&returnJson.entityMapJson.ACCOUNTID.defaultvalue&&(o+="&companyName="+encodeURIComponent(returnJson.entityMapJson.ACCOUNTID.defaultvalue))}(n.account_linkedin_id&&(i=a+"company-matching?apiKey="+n.client_id+"&crmSourceType=ZOHO&crmOrgId="+Crm.userDetails.ZGID+"&crmRecordId="+n.account_linkedin_id+"&version=2.1&modules=TopCard,RecommendedLeads,Connections,News&isInlineMode=false&sat="+n.sat_token,returnJson.Leads&&returnJson.entityMapJson.COMPANY&&""!==returnJson.entityMapJson.COMPANY.defaultvalue?i+="&name="+encodeURIComponent(returnJson.entityMapJson.COMPANY.defaultvalue):returnJson.Contacts&&returnJson.entityMapJson.ACCOUNTID&&returnJson.entityMapJson.ACCOUNTID.defaultvalue?i+="&name="+encodeURIComponent(returnJson.entityMapJson.ACCOUNTID.defaultvalue):returnJson.Accounts?i+="&name="+encodeURIComponent(returnJson.Accounts.entityName):returnJson.Potentials&&(i+="&name="+encodeURIComponent(returnJson.entityMapJson.ACCOUNTID.defaultvalue))),n.client_id&&""!==n.sat_token)?$L("#relLinkedLogoutId").removeClass("dN"):($L("#relLinkedLogoutId").addClass("dN"),(t=$L("#canvasLinkedLogoutId"))&&t.addClass("dN"),o=a+"login?apiKey=%27%27&version=2.1",i=a+"login?apiKey=%27%27&version=2.1");if(n.entity_linkedin_id&&n.account_linkedin_id){var r=745;(l=Math.ceil(e.outerWidth()/2)-20)>639&&(l=639),e.css("height","800px"),returnJson.Leads?(n.entity_title=moduleRecordMapping.Leads.singular_label,n.account_title=I18n.getMsg("Company")):(returnJson.Contacts||returnJson.Potentials)&&(n.entity_title=moduleRecordMapping.Contacts.singular_label,n.account_title=moduleRecordMapping.Accounts.singular_label),n.width=l,n.height=r,n.entity_url=o,n.account_url=i,e.html(Handlebars.templates.SalesNavigatorWidget(n))}else if(n.entity_linkedin_id||n.account_linkedin_id){r=590;var l=Math.floor(e.outerWidth());n.width=l,n.height=r,e.css("height","640px"),n.entity_linkedin_id?(returnJson.Leads?n.entity_title=moduleRecordMapping.Leads.singular_label:(returnJson.Contacts||returnJson.Potentials)&&(n.entity_title=moduleRecordMapping.Contacts.singular_label),n.entity_url=o,e.html(Handlebars.templates.SalesNavigatorWidget(n))):n.account_linkedin_id&&(n.account_title=moduleRecordMapping.Accounts.singular_label,n.account_url=i,e.html(Handlebars.templates.SalesNavigatorWidget(n)))}},cookieAuthModel:function(n){var e=$("#linked_in_container"),t="https://www.linkedin.com/sales/widget/",a="",o="";if(delete crmConstants.reloadSalesNavigator,n.entity_linkedin_id)if(a=t+"profile-matching/?from=crm&apiKey=750hg7mkzhryiz&profile=lead&crmSourceType=ZOHO&crmOrganizationId="+Crm.userDetails.ZGID+"&crmRecordId="+n.entity_linkedin_id+"&version=2.0.0&modules=TopCard2,Icebreakers,GetIntroduced,RelatedLeads",returnJson.Leads||returnJson.Contacts)a+="&firstName="+encodeURIComponent(returnJson.entityMapJson.LASTNAME.nameInfo.firstname)+"&lastName="+encodeURIComponent(returnJson.entityMapJson.LASTNAME.nameInfo.lastname),(returnJson.Leads||returnJson.Contacts)&&(returnJson.entityMapJson.EMAIL&&""!==returnJson.entityMapJson.EMAIL.defaultvalue&&"null"!==returnJson.entityMapJson.EMAIL.defaultvalue?a+="&email="+encodeURIComponent(returnJson.entityMapJson.EMAIL.defaultvalue):returnJson.entityMapJson.ADDN_EMAIL&&""!==returnJson.entityMapJson.ADDN_EMAIL.defaultvalue&&"null"!==returnJson.entityMapJson.ADDN_EMAIL.defaultvalue&&(a+="&email="+encodeURIComponent(returnJson.entityMapJson.ADDN_EMAIL.defaultvalue))),returnJson.Leads&&returnJson.entityMapJson.COMPANY&&""!==returnJson.entityMapJson.COMPANY.defaultvalue?a+="&companyName="+encodeURIComponent(returnJson.entityMapJson.COMPANY.defaultvalue):returnJson.Contacts&&returnJson.entityMapJson.ACCOUNTID&&returnJson.entityMapJson.ACCOUNTID.defaultvalue&&(a+="&companyName="+encodeURIComponent(returnJson.entityMapJson.ACCOUNTID.defaultvalue));else if(returnJson.Potentials&&returnJson.entityMapJson.CONTACTID&&""!==returnJson.entityMapJson.CONTACTID.defaultvalue){var i=returnJson.entityMapJson.CONTACTID.defaultvalue.trim();1===i.split(" ").length?a+="&firstName="+encodeURIComponent(i.split(" ")[0]):2===i.split(" ").length&&(a+="&firstName="+encodeURIComponent(i.split(" ")[0])+"&lastName="+encodeURIComponent(i.split(" ")[1])),returnJson.entityMapJson.CONTACTID.priEmail&&""!==returnJson.entityMapJson.CONTACTID.priEmail&&"null"!==returnJson.entityMapJson.CONTACTID.priEmail?a+="&email="+encodeURIComponent(returnJson.entityMapJson.CONTACTID.priEmail):returnJson.entityMapJson.CONTACTID.EntEmail&&""!==returnJson.entityMapJson.CONTACTID.EntEmail&&"null"!==returnJson.entityMapJson.CONTACTID.EntEmail&&(a+="&email="+encodeURIComponent(returnJson.entityMapJson.CONTACTID.EntEmail)),returnJson.entityMapJson.ACCOUNTID&&returnJson.entityMapJson.ACCOUNTID.defaultvalue&&(a+="&companyName="+encodeURIComponent(returnJson.entityMapJson.ACCOUNTID.defaultvalue))}if(n.account_linkedin_id&&(o=t+"company-matching/?from=crm&apiKey=750hg7mkzhryiz&profile=account&crmSourceType=ZOHO&crmOrganizationId="+Crm.userDetails.ZGID+"&crmRecordId="+n.account_linkedin_id+"&version=2.0.0&modules=TopCard,RecommendedLeads,Connections,News",returnJson.Leads&&returnJson.entityMapJson.COMPANY&&""!==returnJson.entityMapJson.COMPANY.defaultvalue?o+="&name="+encodeURIComponent(returnJson.entityMapJson.COMPANY.defaultvalue):returnJson.Contacts&&returnJson.entityMapJson.ACCOUNTID&&returnJson.entityMapJson.ACCOUNTID.defaultvalue?o+="&name="+encodeURIComponent(returnJson.entityMapJson.ACCOUNTID.defaultvalue):returnJson.Accounts?o+="&name="+encodeURIComponent(returnJson.Accounts.entityName):returnJson.Potentials&&(o+="&name="+encodeURIComponent(returnJson.entityMapJson.ACCOUNTID.defaultvalue))),n.entity_linkedin_id&&n.account_linkedin_id){var s=745;(r=Math.ceil(e.outerWidth()/2)-20)>639&&(r=639),e.css("height","800px"),returnJson.Leads?(n.entity_title=moduleRecordMapping.Leads.singular_label,n.account_title=I18n.getMsg("Company")):(returnJson.Contacts||returnJson.Potentials)&&(n.entity_title=moduleRecordMapping.Contacts.singular_label,n.account_title=moduleRecordMapping.Accounts.singular_label),n.width=r,n.height=s,n.entity_url=a,n.account_url=o,e.html(Handlebars.templates.SalesNavigatorWidget(n))}else if(n.entity_linkedin_id||n.account_linkedin_id){s=590;var r=Math.floor(e.outerWidth());n.width=r,n.height=s,e.css("height","640px"),n.entity_linkedin_id?(returnJson.Leads?n.entity_title=moduleRecordMapping.Leads.singular_label:(returnJson.Contacts||returnJson.Potentials)&&(n.entity_title=moduleRecordMapping.Contacts.singular_label),n.entity_url=a,e.html(Handlebars.templates.SalesNavigatorWidget(n))):n.account_linkedin_id&&(n.account_title=moduleRecordMapping.Accounts.singular_label,n.account_url=o,e.html(Handlebars.templates.SalesNavigatorWidget(n)))}}};window.addEventListener("message",(function(n){var e={};if("string"==typeof n.data&&validationUtils.IsJsonString(n.data)?e=JSON.parse(n.data):"object"==typeof n.data&&(e=JSON.parse(JSON.stringify(n.data))),"salesNavAuthSuccess"===e.type)(t=networkUtils.lyteInitiateRequest("/crm/v2/settings/sales_navigator/auth_url","GET")).then((function(n){var e=n.details;e.auth_url&&networkUtils.openUrl(e.auth_url,"_blank")}));else if("tokenError"===e.type){var t;(t=networkUtils.lyteInitiateRequest("/crm/v2/settings/sales_navigator/sat_token","GET")).then((function(n){if((t=n.details).hasOwnProperty("sat_token")&&""!==t.sat_token){var e=SalesNavigator.snData;t.entity_linkedin_id=e.entity_linkedin_id,t.account_linkedin_id=e.account_linkedin_id,SalesNavigator.newApiModel(t)}else{n={sat_token:"",entity_linkedin_id:!0,account_linkedin_id:!0};SalesNavigator.newApiModel(n)}}))}}));