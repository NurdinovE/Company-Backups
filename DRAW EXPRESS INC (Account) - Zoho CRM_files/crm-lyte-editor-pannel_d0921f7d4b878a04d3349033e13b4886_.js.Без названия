var _lyteUiEditor={version:"1.9.15",author:"lyte-team <lyte-team@zohocorp.com>",url_rgx:/\b((?:(?:ht|f)tps?:\/\/|www\d{0,3}[.])(?:[^\s()<>]+|\([^\s()<>]+\))+(?:\((?:[^\s()<>]+|(?:\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))|([\w\-.%+]+@(?:[\w\-]+\.)+[A-Z]{2,}\b)/gi,i18n:function(){var t={"Reset to default color":"lyte.editor.panel.reset.color","Insert image":"lyte.editor.panel.insert.image","Upload from devive":"lyte.editor.panel.upload.from.devive","Image preview will be shown here.":"lyte.editor.panel.image.preview.message","Error in loading the image. Pls check the URL.":"lyte.editor.panel.image.error","Enter valid image URL":"lyte.editor.panel.image.placeholder","Fit to screen":"lyte.editor.panel.image.fit.screen",Small:"lyte.editor.panel.image.small","Actual size":"lyte.editor.panel.image.actualsize",Insert:"lyte.editor.panel.image.insert",Cancel:"lyte.editor.panel.cancel","Insert Table":"lyte.editor.panel.table.insert","Show more options":"lyte.editor.panel.table.more.options",Apply:"lyte.editor.panel.apply","Keep source formatting":"lyte.editor.keep.source","Match destination formatting":"lyte.editor.destination.formatting","Text only":"lyte.editor.text.only",Bold:"lyte.editor.bold",Italic:"lyte.editor.italic",Underline:"lyte.editor.underline","Strike through":"lyte.editor.strike.through","Sub script":"lyte.editor.script.sub","Super script":"lyte.editor.script.super",Color:"lyte.editor.color","Background color":"lyte.editor.background.color","Align left":"lyte.editor.align.left","Align right":"lyte.editor.align.right","Align center":"lyte.editor.align.center","Align justify":"lyte.editor.align.justify","Text indent increase":"lyte.editor.indent.increase","Text indent decrease":"lyte.editor.indent.decrease","Line height":"lyte.editor.line.height","Unordered list":"lyte.editor.ul","Ordered list":"lyte.editor.ol",Undo:"lyte.editor.undo",Redo:"lyte.editor.redo",Blockquote:"lyte.editor.blockquote",Table:"lyte.editor.table",Anchor:"lyte.editor.anchor",Clear:"lyte.editor.clear","Image left align":"lyte.editor.image.align.left","Image right align":"lyte.editor.image.align.right","More options":"lyte.editor.more.options",Rows:"lyte.editor.table.rows",Columns:"lyte.editor.table.columns",Width:"lyte.editor.table.width",Height:"lyte.editor.table.height",Align:"lyte.editor.table.align",None:"lyte.editor.table.none",Left:"lyte.editor.table.left",Right:"lyte.editor.table.right",Center:"lyte.editor.table.center","Add here...":"lyte.editor.placeholder",Link:"lyte.editor.link","Remove selected":"lyte.editor.remove.selected",Cut:"lyte.editor.cut",Copy:"lyte.editor.copy",Paste:"lyte.editor.paste",Edit:"lyte.editor.edit","Select word":"lyte.editor.select.word","Select line":"lyte.editor.select.line","Select all":"lyte.editor.select.all","Open in new window":"lyte.editor.open.window",Justify:"lyte.editor.align.justify","Reset to default colour":"lyte.editor.panel.reset.color","Upload from drive":"lyte.editor.panel.upload.from.devive","Error while loading the image. Please check the URL.":"lyte.editor.panel.image.error","Open in a new window":"lyte.editor.open.window",Text:"lyte.editor.panel.text",Remove:"lyte.editor.remove"};return function(e){for(var i=Array.from(arguments),a=(e=i[0],window._lyteEditorLocale||{}),o=t[e]||e,n=a[o]||e,r=i.length,s=1;s<r;s++)n=n.replace("{{"+(s-1)+"}}",i[s]);return n}}(),listVariable:!0,tabSize:3,wordAttributes:!1,wordStyle:{whiteSpace:"break-spaces",color:"#333"},paraStyle:{maxWidth:"100%",lineHeight:1.25,overflowWrap:"break-word"},tdStyle:{overflow:"hidden",position:"relative",minWidth:"50px",border:"1px solid black",padding:"2px",whiteSpace:"pre-line",wordBreak:"break-word"},tableStyle:{borderCollapse:"collapse"},imageStyle:{display:"inline-block",margin:"10px"},wordStyleConversion:{},wordSimpleConversion:{fontWeight:[{value:"bold",tag:"b"}],fontStyle:[{value:"italic",tag:"i"}],textDecoration:[{value:"underline",tag:"u"},{value:"line-through",tag:"del"}],textDecorationLine:[{value:"underline",tag:"u"},{value:"line-through",tag:"del"}],backgroundColor:[{value:"yellow",tag:"mark"}],fontSize:[{value:"smaller",tag:"small"}]},captionStyle:{background:"#f6f7f7",color:"#646970",fontSize:"14px",lineHeight:"1.7",padding:"16px",display:"block",margin:0,position:"relative",pointerEvents:"auto"},paraStyleConversion:function(){var t="padding",e="border",i="-inline-start",a="-inline-end",o=": 2px solid #ccc",n=": 2px dotted #ccc",r=": 25px",s=": 10px",l=": 25px 10px",d=": 10px 0";return{lyteEditorQuoteLeft:[t+d,t+i+r,e+i+o],lyteEditorQuoteTop:["padding-top: 25px",t+i+s,t+a+s,"border-top"+o],lyteEditorQuoteTopDashed:["padding-top: 25px",t+i+s,t+a+s,"border-top"+n],lyteEditorQuoteTopBottom:[t+l,"border-top"+o,"border-bottom"+o],lyteEditorQuoteTopBottomDashed:[t+l,"border-top"+n,"border-bottom"+n],lyteEditorQuoteLeftRight:[t+d,t+i+s,t+a+s,e+i+o,e+a+o]}}(),paraChildConversion:{h1:{fontSize:"2em",fontWeight:"bold"},h2:{fontSize:"1.5em",fontWeight:"bold"},h3:{fontSize:"1.17em",fontWeight:"bold"},h4:{fontSize:"1em",fontWeight:"bold"},h5:{fontSize:"0.83em",fontWeight:"bold"},h6:{fontSize:"0.67em",fontWeight:"bold"}},orderedList:[{name:"roman",lower:!0,conversionName:"lower-roman",suffix:".",type:"OL"},{name:"roman",lower:!1,conversionName:"upper-roman",suffix:".",type:"OL"},{name:"number",lower:!1,conversionName:"decimal",suffix:".",type:"OL"},{name:"zeronumber",lower:!1,conversionName:"decimal-leading-zero",suffix:".",type:"OL"},{name:"alphabet",lower:!0,conversionName:"lower-alpha",suffix:".",type:"OL"},{name:"alphabet",lower:!1,conversionName:"upper-alpha",suffix:".",type:"OL"}],unOrderedList:[{name:"disc",lower:!1,conversionName:"disc",suffix:"",type:"UL"},{name:"circle",lower:!1,conversionName:"circle",suffix:"",type:"UL"},{name:"square",lower:!1,conversionName:"square",suffix:"",type:"UL"},{name:"custom",conversionName:"ulVolume",type:"UL"},{name:"custom",conversionName:"ulSquareOutline",type:"UL"},{name:"custom",conversionName:"ulDisclosureClosed",type:"UL"},{name:"custom",conversionName:"ulLineBall",type:"UL"},{name:"custom",conversionName:"ulDiamond",type:"UL"},{name:"custom",conversionName:"ulTick",type:"UL"},{name:"custom",conversionName:"ulFingerPointer",type:"UL"},{name:"custom",conversionName:"ulPencil",type:"UL"},{name:"custom",conversionName:"ulOutlineStar",type:"UL"},{name:"custom",conversionName:"ulFilledHeart",type:"UL"},{name:"custom",conversionName:"ulRightArrow",type:"UL"},{name:"custom",conversionName:"ulBallThreeDots",type:"UL"},{name:"custom",conversionName:"ulPlus",type:"UL"},{name:"custom",conversionName:"ulRightPointer",type:"UL"},{name:"custom",conversionName:"ulCrossPlus",type:"UL"},{name:"custom",conversionName:"ulFolder",type:"UL"},{name:"custom",conversionName:"ulClock",type:"UL"},{name:"custom",conversionName:"ulSideCube",type:"UL"},{name:"custom",conversionName:"ulSmiley",type:"UL"},{name:"custom",conversionName:"ulGlobe",type:"UL"},{name:"custom",conversionName:"ulDocument",type:"UL"}],shortcuts:{66:[{value:"fontWeight",ctrl:!0,scope:"Word",css:"bold"}],73:[{value:"fontStyle",ctrl:!0,scope:"Word",css:"italic"}],85:[{value:"textDecoration",ctrl:!0,scope:"Word",css:"underline"},{value:"list",ctrl:!0,shift:!0,scope:"Para"}],79:[{value:"ordered",ctrl:!0,shift:!0,scope:"Para"}],187:[{value:"verticalAlign",ctrl:!0,scope:"Word",css:"sub"},{value:"verticalAlign",shift:!0,ctrl:!0,scope:"Word",css:"super"}],90:[{value:"undo",ctrl:!0},{value:"redo",ctrl:!0,shift:!0}],89:[{value:"redo",ctrl:!0}],53:[{value:"lyteEditorBlockquote",alt:!0,ctrl:!0,scope:"Para"}],75:[{value:"link",ctrl:!0}],13:[{value:"openAnchor",alt:!0},{value:"splitPara",shift:!0},{value:"splitPara"}],8:[{value:"backspaceLine",ctrl:!0,scope:"Word"},{value:"backspaceWord",alt:!0,scope:"Word"},{value:"backspace",scope:"Word",any:!0}],46:[{value:"deleteLine",ctrl:!0,scope:"Word"},{value:"deleteWord",alt:!0,scope:"Word"},{value:"delete",scope:"Word",any:!0}],9:[{value:"tab",any:!0}],65:[{value:"selectAll",ctrl:!0},{value:"toggleUpperCase",ctrl:!0,shift:!0}],67:[{value:"toggleCaptilize",ctrl:!0,shift:!0}],33:[{value:"pageup",any:!0}],34:[{value:"pagedown",any:!0}],35:[{value:"end",any:!0}],36:[{value:"home",any:!0}],37:[{value:"moveLeft",any:!0}],39:[{value:"moveRight",any:!0}],38:[{value:"moveTop",any:!0}],40:[{value:"moveBottom",any:!0}],76:[{value:"textAlign",ctrl:!0,shift:!0,css:"left",scope:"Para"},{value:"toggleLowerCase",ctrl:!0}],74:[{value:"textAlign",ctrl:!0,shift:!0,css:"justify",scope:"Para"}],82:[{value:"textAlign",ctrl:!0,shift:!0,css:"right",scope:"Para"}],70:[{value:"textAlign",ctrl:!0,shift:!0,css:"center",scope:"Para"}],188:[{value:"fontDecrease",shift:!0,ctrl:!0}],190:[{value:"fontIncrease",shift:!0,ctrl:!0}],219:[{value:"textIndentDecrease",ctrl:!0}],221:[{value:"textIndentIncrease",ctrl:!0}],70:[{value:"find",ctrl:!0}]},listStyle:{"padding-inline-start":"20px"},defaultTable:{row:2,column:2},anchorProperty:{target:"_blank"},anchorStyle:{color:"#2c7bd0",textDecoration:"underline"},headerTags:["lyteEditorH1","lyteEditorH2","lyteEditorH3","lyteEditorH4","lyteEditorH5","lyteEditorH6"],tagConversion:{h1:"lyteEditorH1",h2:"lyteEditorH2",h3:"lyteEditorH3",h4:"lyteEditorH4",h5:"lyteEditorH5",h6:"lyteEditorH6",paragraph:"p",word:"span",blockquote:"lyteEditorBlockquote",sub:"lyteSubScript",sup:"lyteSuperScript",hr:"lyteEditorHrTag"},blockquoteClasses:function(){var t="lyteEditorQuote";return ext_classes=[t+"Left",t+"Top",t+"TopDashed",t+"TopBottom",t+"TopBottomDashed",t+"LeftRight"]}(),config:{},mixins:["table","anchor","mention","caption","resize","image","blockquote","list","find","bluepencil","code-snippet"].map((function(t){return"lyte-editor-"+t})),replaceLetters:{"&nbsp;":" "}};!function(){var t="lyteEditorBlockquote",e="PopoverBlockQuote",i="toggleWordClass",a="{{selected}}";function o(t){var e="<div class='lyteUIEditorOlPopoverButton'>";return t.forEach((function(t){e+="<div class='lyteUIEditorOlIconPara'><span>"+t+".</span><div class='lyteUIEditorOlIconLine'></div></div>"})),e+"</div>"}function n(t){var e="lyteUIEditorPopoverBlockquote";return"<div class='"+e+t+"Icon'><div class='"+e+t+"Text'>Lorem ipsum dolor sit amet consectetur</div></div>"}$L.extend(_lyteUiEditor,{icons:[{class:"lyteUIEditorPanelTextFormat",subIcons:[{type:"switch",name:"bold",display:"",functionName:i,arguments:["fontWeight","bold"],active:!1,title:_lyteUiEditor.i18n("Bold"),disabled:!1},{type:"switch",name:"italic",display:"",functionName:i,arguments:["fontStyle","italic"],active:!1,title:_lyteUiEditor.i18n("Italic"),disabled:!1},{type:"switch",name:"underline",display:"",functionName:i,arguments:["textDecoration","underline"],active:!1,title:_lyteUiEditor.i18n("Underline"),disabled:!1},{type:"switch",name:"strike",display:"",functionName:i,arguments:["textDecoration","line-through"],active:!1,title:_lyteUiEditor.i18n("Strike through"),disabled:!1}]},{class:"Formatting",subIcons:[{type:"switch",name:"sub",display:"",functionName:i,arguments:["lyteSubScript"],removeClass:["lyteSuperScript"],active:!1,title:_lyteUiEditor.i18n("Sub script"),disabled:!1},{type:"switch",name:"super",display:"",functionName:i,arguments:["lyteSuperScript"],removeClass:["lyteSubScript"],active:!1,title:_lyteUiEditor.i18n("Super script"),disabled:!1}]},{class:"lyteUIEditorPanelColorpicker",subIcons:[{type:"colorpicker",name:"color",display:"",selected:"black",functionName:i,arguments:["color",a],active:!1,title:_lyteUiEditor.i18n("Color"),disabled:!1},{type:"colorpicker",name:"bg",display:"",selected:"white",functionName:i,arguments:["backgroundColor",a],active:!1,title:_lyteUiEditor.i18n("Background color"),disabled:!1}]},{class:"lyteUIEditorPanelParaAlign",subIcons:[{type:"switch",name:"alignCenter",display:"",functionName:"toggleParaClass",arguments:["textAlign","center"],active:!1,title:_lyteUiEditor.i18n("Align center"),disabled:!1},{type:"switch",name:"alignLeft",display:"",functionName:"toggleParaClass",arguments:["textAlign","left"],active:!1,title:_lyteUiEditor.i18n("Align left"),disabled:!1},{type:"switch",name:"alignRight",display:"",functionName:"toggleParaClass",arguments:["textAlign","right"],active:!1,title:_lyteUiEditor.i18n("Align right"),disabled:!1},{type:"switch",name:"alignJustify",display:"",functionName:"toggleParaClass",arguments:["textAlign","justify"],active:!1,title:_lyteUiEditor.i18n("Align justify"),disabled:!1}]},{class:"lyteUIEditorPanelTextIndent",subIcons:[{type:"switch",name:"textIndentIncrease",display:"",functionName:"textIndentIncrease",arguments:[""],ignore:!1,active:!1,activeClass:"lyteEditorPanelIconDisabled",title:_lyteUiEditor.i18n("Text indent increase"),prevent_true:!0,disabled:!1},{type:"switch",name:"textIndentDecrease",display:"",functionName:"textIndentDecrease",arguments:[""],ignore:!1,active:!1,activeClass:"lyteEditorPanelIconDisabled",title:_lyteUiEditor.i18n("Text indent decrease"),prevent_true:!0,disabled:!1}]},{class:"lyteUIEditorPanelLineHeight",subIcons:[{type:"dropdown",name:"lineHeight",title:_lyteUiEditor.i18n("Line height"),display:["1","1.5","2","2.5","3","3.5"],value:["1","1.5","2","2.5","3","3.5"],selected:"1.5",functionName:"toggleParaClass",arguments:["lineHeight",a],displayValue:"",active:!1,ignore:!0,disabled:!1}]},{class:"lyteUIEditorPanelList",subIcons:[{type:"list",name:"Ul",display:"",title:_lyteUiEditor.i18n("Unordered list"),list:[{type:"switch",name:"removeUL",lower:!1,functionName:"removeList",arguments:[],display:_lyteUiEditor.i18n("None"),ignore:!0},{type:"switch",name:"ulVolume",lower:!1,functionName:"list",selected:"4",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"disc",lower:!1,functionName:"list",selected:"1",arguments:[a],conversionName:"disc",suffix:""},{type:"switch",name:"circle",lower:!1,functionName:"list",selected:"2",arguments:[a],conversionName:"circle",suffix:""},{type:"switch",name:"square",lower:!1,functionName:"list",selected:"3",arguments:[a],conversionName:"square",suffix:""},{type:"switch",name:"ulSquareOutline",lower:!1,functionName:"list",selected:"5",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulDisclosureClosed",lower:!1,functionName:"list",selected:"6",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulLineBall",lower:!1,functionName:"list",selected:"7",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulDiamond",lower:!1,functionName:"list",selected:"8",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulTick",lower:!1,functionName:"list",selected:"9",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulFingerPointer",lower:!1,functionName:"list",selected:"10",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulPencil",lower:!1,functionName:"list",selected:"11",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulOutlineStar",lower:!1,functionName:"list",selected:"12",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulFilledHeart",lower:!1,functionName:"list",selected:"13",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulRightArrow",lower:!1,functionName:"list",selected:"14",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulBallThreeDots",lower:!1,functionName:"list",selected:"15",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulPlus",lower:!1,functionName:"list",selected:"16",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulRightPointer",lower:!1,functionName:"list",selected:"17",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulCrossPlus",lower:!1,functionName:"list",selected:"18",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulFolder",lower:!1,functionName:"list",selected:"19",arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulClock",lower:!1,functionName:"list",selected:20,arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulSideCube",lower:!1,functionName:"list",selected:21,arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulSmiley",lower:!1,functionName:"list",selected:22,arguments:[a],conversionName:"smiley",suffix:""},{type:"switch",name:"ulGlobe",lower:!1,functionName:"list",selected:23,arguments:[a],conversionName:"custom",suffix:""},{type:"switch",name:"ulDocument",lower:!1,functionName:"list",selected:24,arguments:[a],conversionName:"custom",suffix:""}],disabled:!1},{type:"list",name:"Ol",display:"",title:_lyteUiEditor.i18n("Ordered list"),list:[{type:"switch",name:"removeOL",lower:!1,functionName:"removeList",arguments:[],display:"None",ignore:!0},{type:"switch",name:"olDecimal",display:o([1,2,3]),functionName:"ordered",selected:"3",arguments:[a],active:!1},{type:"switch",name:"olLowerAlpha",display:o(["a","b","c"]),functionName:"ordered",selected:"5",arguments:[a],active:!1},{type:"switch",name:"olUpperAlpha",display:o(["A","B","C"]),functionName:"ordered",selected:"6",arguments:[a],active:!1},{type:"switch",name:"olLowerRoman",display:o(["i","ii","iii"]),functionName:"ordered",selected:"1",arguments:[a],active:!1},{type:"switch",name:"olUpperRoman",display:o(["I","II","III"]),functionName:"ordered",selected:"2",arguments:[a],active:!1},{type:"switch",name:"olDecimalLeadingZero",display:o(["01","02","03"]),functionName:"ordered",selected:"4",arguments:[a],active:!1}],active:!1,disabled:!1}]},{class:"undoredo",subIcons:[{type:"undo",name:"undo",display:"",functionName:"undo",activeClass:"lyteEditorPanelIconDisabled",active:!1,title:_lyteUiEditor.i18n("Undo"),prevent_true:!0,disabled:!1},{type:"undo",name:"redo",display:"",functionName:"redo",activeClass:"lyteEditorPanelIconDisabled",active:!1,title:_lyteUiEditor.i18n("Redo"),prevent_true:!0,disabled:!1}]},{class:"blockquoteSection",subIcons:[{type:"list",name:"Blockquote",display:"",title:_lyteUiEditor.i18n("Blockquote"),list:[{type:"switch",name:"removeBlockquote",display:"None",functionName:"removeBlockquote",arguments:[],ignore:!0},{type:"switch",name:e,display:n("Left"),functionName:t,arguments:["lyteEditorQuoteLeft"],active:!1},{type:"switch",name:e,display:n("TopBottom"),functionName:t,arguments:["lyteEditorQuoteTopBottom"],active:!1},{type:"switch",name:e,display:n("Top"),functionName:t,arguments:["lyteEditorQuoteTop"],active:!1},{type:"switch",name:e,display:n("TopDashed"),functionName:t,arguments:["lyteEditorQuoteTopDashed"],active:!1},{type:"switch",name:e,display:n("TopBottomDashed"),functionName:t,arguments:["lyteEditorQuoteTopBottomDashed"],active:!1},{type:"switch",name:e,display:n("LeftRight"),functionName:t,arguments:["lyteEditorQuoteLeftRight"],active:!1}],active:!1,disabled:!1}]},{class:"lyteUIEditorTable",subIcons:[{type:"table",name:"table",title:_lyteUiEditor.i18n("Table"),display:"",functionName:"table",arguments:[],active:!1,ignore:!0,disabled:!1}]},{class:"lyteUIEditorPanelLink",subIcons:[{type:"anchor",name:"anchor",functionName:i,arguments:["anchor"],activeClass:"lyteEditorPanelIconDisabled",title:_lyteUiEditor.i18n("Link"),active:!1,disabled:!1}]},{class:"lyteUIEditorImageAlign",subIcons:[{type:"image",name:"image",ignore:!1,display:"Image",title:_lyteUiEditor.i18n("Insert image"),disabled:!1},{type:"switch",name:"rightAlignImage",functionName:"alignImage",arguments:["right"],active:!1,title:_lyteUiEditor.i18n("Image right align"),disabled:!1},{type:"switch",name:"leftAlignImage",functionName:"alignImage",arguments:["left"],active:!1,title:_lyteUiEditor.i18n("Image left align"),disabled:!1}]},{class:"lyteUIEditorClearformatting",subIcons:[{type:"switch",name:"clear",functionName:"clearFormat",title:"clear format",arguments:[""],active:!1,title:_lyteUiEditor.i18n("Clear"),prevent_true:!0,disabled:!1}]}]}),$L.extend(_lyteUiEditor,{config:function(){let t={};return["listVariable","tabSize","wordStyle","paraStyle","tdStyle","tableStyle","imageStyle","wordStyleConversion","captionStyle","paraStyleConversion","orderedList","unOrderedList","listStyle","defaultTable","anchorProperty","headerTags","tagConversion","wordAttributes","blockquoteClasses","convertStyle"].forEach((function(e){t[e]=_lyteUiEditor[e]})),t}()}),Object.defineProperty(Array.prototype,"lsplice",{value:function(){var t=Array.from(arguments),e=!1,i=t.shift();let a=[],o=this.length;var n=t.shift();let r=t.length;if(i<0&&(i=o+i<0?0:o+i,null==n&&(n=o-i,e=!0)),n<0&&(n=0),i=parseInt(i),n=e?n:arguments.length>1&&(null==n||n==1/0||isNaN(n))?0:arguments.length>1&&!isNaN(n)?n:o,i>o&&0==r||arguments[0]==1/0)return a;i>o?(i=o,n=0):isNaN(arguments[0])&&(i=0,n=arguments.length>1?arguments[1]?n:0:o),isNaN(n)&&(n=0),(n==1/0||i+n>o)&&(n=o-i);let s=i+n,l=i+r;if(0==r){for(let t=i;t<s;t++)a.push(this[t]),this[t]=this[t+n];for(let t=s;t<o-n;t++)this[t]=this[t+n];return this.length-=n,a}{let e=[];if(n>r){for(let t=l,i=s;t<o&&i<o;t++,i++)t<s&&e.push(this[t]),this[t]=this[i];for(let e=i,o=0;e<l;e++,o++)a.push(this[e]),this[e]=t[o];for(let t=r+(o-n);t<s;t++)e.push(this[t]);for(let t=0,i=a.length;t<e.length;t++,i++)a[i]=e[t];return this.length=o-n+r,a}for(let t=o-n+r,e=o;e>s;t--,e--)this[t-1]=this[e-1];for(let e=i,o=0;e<l;e++,o++)e<s&&a.push(this[e]),this[e]=t[o];return a}},enumerable:!1,writable:!0,configurable:!0})}(),Lyte.Component.registerHelper("lyteUiEditorHighlight",(function(t,e){if(e){var i=new RegExp("("+(e||"").replace(/(\\|\'|\"|\?|\^|\$|\.|\||\*|\+|\(|\)|\[|\]|\{|\})/g,"\\$1")+")","gi");return t.replace(i,'<span class="lyteEditorMentionHighlight">$1</span>')}return t})),Lyte.Component.registerHelper("lyteUiEditorI18n",(function(t){return _lyteUiEditor.i18n(t)})),$L.extend(_lyteUiEditor,{randomId:function(t){if(t)return"LyteEditor"+Date.now()+parseInt(1e3*Math.random());for(var e,i=[],a=0;a<20;a++)e=0|42*Math.random(),i[a]=String.fromCharCode(48+(e>9&&e<18?18+e:e));return"LyteEditor"+i.join("")},last:function(t){return $L(t).get(-1)},first:function(t){return t[0]},dasherize:function(t){return/^(webkit|moz|ms|(o[A-Z]))/.test(t)&&(t="-"+t),t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},camelCase:function(t){return t.replace(/^\-/,"").replace(/(-\w)/g,(function(t){return t[1].toUpperCase()}))},getProp:function(t){return this.config[t]||this[t]},getIndex:function(t,e){return t?t.indexOf(e):-1},inlineStyle:function(t,e){var i="",a=this.config.convertStyle||{};for(var o in!e||-1==e.indexOf("lyteSuperScript")&&-1==e.indexOf("lyteSubScript")||"smaller"==t.fontSize&&delete t.fontSize,t){var n=a[o],r=t[o];n&&n.value==r?(o=n.name,r=n.replaceValue):n&&n.fallBackValue==r&&(o=n.name,r="normal"),i+=this.dasherize(o)+":"+r+";"}return i.replace(/;;/g,";").replace(/(^;+$)|(;$)/g,"")},isTable:function(t){if(t&&t.data){var e=t.data[0];if(e.details&&"table"==e.details.type)return!0}},isSection:function(t){if(t&&t.data){var e=t.data[0];if(e&&e.details&&"section"==e.details.type)return!0}},isCodeEditor:function(t){if(t&&t.details&&t.details.snippet)return!0},isHr:function(t){return-1!=this.getIndex(t.classList||[],"lyteEditorHrTag")},isImage:function(t){var e=t.data||[];return 1==e.length&&-1!=this.getIndex(e[0].classList,"lyteEditorImage")&&"false"!=(e[0].attr||{}).editable},isEmptyPara:function(t,e){if(this.__ignore_empty)return!1;if(!0===e&&t.style&&(t.style.backgroundColor||t.style.background))return!1;var i=t.data,a=!0;return i.forEach(function(t){return(t.text||(t.data||[]).length)&&(a=!1),a}.bind(this)),a&&-1==this.getIndex(t.classList,"lyteEditorHrTag")},colgroupConstruct:function(t){var e=t.data[0].data,i="<colgroup>";return e.forEach(function(t){var e=this.inlineStyle({width:t.style.width});i+="<col"+(e?" style='"+e:"")+"'></col>"}.bind(this)),i+"</colgroup>"},tableBckConversion:function(t,e,i){var a=t.data[0],o=a.data,n=o[0],r=-1!=this.getIndex(n.classList||[],"lyteEditorNoHeadTable"),s=this,l=function(t){return"</"+t.tag+">"},d=function(t,e){return"<"+t.tag+(this.config.wordAttributes?this.convertAttr(t):"")+(e?" style='"+e+"'":"")}.bind(this),c=null!=i?$L.extend({},i.style):{},p=d(a,this.inlineStyle($L.extend(c,a.style)))+">";return o.forEach((function(t,i){r&&0==i?p+=s.colgroupConstruct(t):(p+=d(t,s.inlineStyle(t.style))+">",t.data.forEach((function(t){p+=d(t,s.inlineStyle(t.style))+">",t.data.forEach((function(t){if("none"!=t.style.display){e&&(t.style.width=a.style.width),p+=d(t,s.inlineStyle(t.style));var i=t.details,o=i.rowSpan||0,n=i.colSpan||0;o>1&&(p+=" rowspan="+t.details.rowSpan),n>1&&(p+=" colspan="+t.details.colSpan),p+=">"+s.jsonToString(t.data),p+=l(t)}})),p+=l(t)})),p+=l(t))})),p+l(a)},sectionBckConversion:function(t,e){var i,a=t.data[0].data,o=this.convertBckInlineStyle(e),n=this.convertBckInlineStyle(t),r=(this.getCorrectTag(e,"paragraph"),this.isCodeEditor(a[0]||{})),s=r?a[0].details.snippet.language:"";return i=this._jsonToString(a),"<div"+(this.config.wordAttributes?this.convertAttr(e):"")+(o?" style='"+o+"'":"")+"><div "+(t.classList.length?'class="'+t.classList.join(" ")+'"':"")+" data-section "+(n?"style='"+n+"' ":"")+(r?"editor-language='"+s+"'":"")+">"+i+"</div></div>"},removeUndef:function(t,e,i){return i||null!=e&&null!=e[t]?t+":"+(e[t]||i)+";":""},convertBckInlineStyleWord:function(t,e){var i=e||this.getProp("wordStyleConversion"),a=t.classList,o="";for(var n in i)-1!=this.getIndex(a,n)&&(o+=(i[n].constructor==Array?i[n][0]:i[n]).replace(/\s/g,"")+";",o+=";");return(this.inlineStyle(t.style,t.classList)+";"+o).replace(/;;/g,";").replace(/(^;+$)|(;$)/g,"").replace(/\"/g,"&quot;")},escapeText:function(t){return t.replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g," ")},unescapeText:function(t){return t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/\t/g,this.getSpaceForTab()).replace(/&quot;/g,'"').replace(/&amp;/g,"&")},getSpaceForTab:function(){for(var t=this.data?this.data.ltPropTabSize:this.config.tabSize,e="",i=0;i<t;i++)e+=" ";return e},convertMention:function(t){var e=t.details,i=e.module,a=-1!=t.classList.indexOf("lyteSuperScript")?"sup":-1!=t.classList.indexOf("lyteSubScript")?"sub":"";a&&"smaller"===t.style.fontSize&&delete t.style.fontSize;var o=this.convertBckInlineStyle(t);return"<span"+this.convertAttr(t)+(o?" style='"+o+"'":"")+">"+(a?"<"+a+">":"")+"@["+t.text+":"+e.id+(i?":"+i:"")+"]"+(a?"</"+a+">":"")+"</span>"},getCorrectTag:function(t,e,i){var a,o=t.classList||[],n=this.getProp("tagConversion");for(var r in n)if(-1!=this.getIndex(o,n[r])){if(a=r,!i)break;i.push(a)}return i||(a=a||n[e])},convertAttr:function(t){var e="",i=t.attr;for(var a in i)e+=" "+a+"='"+i[a]+"'";return e},convertAnchor:function(t,e){var i=t.attr||{};["lt-prop-title","lt-prop-tooltip-config"].forEach((function(t){delete i[t]}));var a,o="<a"+(this.config.wordAttributes?this.convertAttr(t):"")+" style='"+this.convertBckInlineStyleWord(t),n=t.details.anchor,r=this.getCorrectTag(t,"word",[]);for(var s in n)o+="' "+s+"='"+n[s];return a=o+"'>"+(e||this.escapeText(t.text))+"</a>",r.forEach((function(t){a="<"+t+">"+a+"</"+t+">"})),a},check_url:function(t){var e=this.config.component.check_urls(new Text(t));return e&&e.tagName?e.innerHTML:t},url_detection:function(t){let e=document.createElement("div");return e.innerHTML=t,e.normalize,e.childNodes.forEach(this.checkForInnerNodes.bind(this)),e},checkForInnerNodes:function(t){if(t.constructor==Text){let e=this.check_urls(t);e.constructor!=Text&&e.children.length>1?(Array.from(e.childNodes).forEach((function(e){t.parentElement.insertBefore(e,t)})),t.parentElement.removeChild(t)):t.parentElement.replaceChild(e.constructor==Text?new Text(e.nodeValue):e.children[0],t)}else"A"!==t.tagName&&t.childNodes.forEach(this.checkForInnerNodes.bind(this))},check_urls:function(t,e){var i=_lyteUiEditor.url_rgx,a=t.nodeValue,o=function(e,i){var a=this.check_other_links(e);a!=e?function(t,e){var i=document.createElement("span");i.innerHTML=e,Array.from(i.childNodes).forEach((function(e){t.appendChild(e)}))}(t=i||this.create("span"),a):i&&i.appendChild(new Text(e))}.bind(this),n=function(e){e&&t.parentNode&&t.parentNode.replaceChild(e,t)};if(i.test(a)){var r=a.match(i)||[];if(r.length){var s=this.create("span");return r.forEach(function(t){var e=a.indexOf(t),i=this.create("a");i.target="_blank",e&&o(a.slice(0,e),s),i.innerText=t,i.href=(/^http[s]{0,1}:/i.test(t)?"":"http://")+t,s.appendChild(i),a=a.substring(e+t.length)}.bind(this)),a&&o(a,s),e?n(s):s}}else o(a);return e?n(t):t},create:function(t){return document.createElement(t)},check_other_links:function(t){var e=function(e){t=t.replace(e,"$1<a href='http://$2' target='_blank'>$2</a>")};return e(/(^|\ |\s)(([\w\d\-]+\.)+((?!js|cp|do)[a-z]){2})(?=(\s| |$))/gi),e(/(^|\ |\s)(([\w\d-]+\.)+(com|org|net|int|edu|gov|mil|biz|info))(?=(\s| |$))/gi),t},convertEvents:function(t){var e="",i=(t.details||{}).event||{};for(var a in i)e+=" "+a+"='"+i[a]+"'";return e},convertBckWord:function(t,e){var i=t.details;if(i.anchor)return this.convertAnchor(t,e);if("mention"==i.type)return this.convertMention(t);if("image"==i.type)return this.imageBckConversion(t);var a=this.getCorrectTag(t,"word"),o=this.convertBckInlineStyleWord(t),n=this.config,r=e||this.escapeText(t.text),s=t.attr||{},l=n.urlDetection&&0!=s["url-detection"]?this.check_url(r):r,d="<"+a+(n.wordAttributes?this.convertAttr(t):"")+(o?" style='"+o+"'":"")+this.convertEvents(t)+">"+l+"</"+a+">";return i.parent?this.convertBckWord(i.parent,d):d},imageBckConversion:function(t,e){var i="<"+t.details.tag+(this.config.wordAttributes?this.convertAttr(t):"")+" style='",a=t.data[0].data[0].details,o=t.data[1].data[0];for(var n in e&&e.style.float&&(i+="float:"+e.style.float+";"),t.style.float&&(i+="float:"+t.style.float+";"),t.style.verticalAlign&&(i+="vertical-align:"+t.style.verticalAlign+";"),i+=this.removeUndef("width",t.style,"100%")+this.removeUndef("height",t.style)+this.removeUndef("margin",t.style)+this.removeUndef("marginTop",t.style)+this.removeUndef("border",t.style)+this.removeUndef("marginBottom",t.style)+this.removeUndef("marginInlineStart",t.style)+this.removeUndef("marginInlineEnd",t.style)+this.removeUndef("marginInline",t.style)+this.removeUndef("padding",t.style)+"' ",a){null!=a[n]&&(i+=n+"='"+a[n]+"' ")}return"false"==(t.attr||{}).editable&&(i+="editable='false' "),i=i.trim()+">",e&&o&&(i="<figure style='margin:0;display:table;float:"+(e.style.float||"")+"'>"+i+"<figcaption style = 'display:table-caption;caption-side:bottom'>",i+=this.convertBckPara(o)+"</figcaption></figure>"),t.details.parent?this.convertBckWord(t.details.parent,i):i},hrConversion:function(t){var e=this.convertBckInlineStyle(t);return e?"<hr"+(this.config.wordAttributes?this.convertAttr(t):"")+" style='"+e+"'>":"<hr>"},convertBckPara:function(t){var e,i,a=this.isTable(t),o=this.isImage(t),n=this.isHr(t),r=this.isSection(t),s=this.isEmptyPara(t),l=!!t.style.backgroundColor||!!t.style.background,d=this.getCorrectTag(t,"paragraph"),c="";if(s&&!(a||o||n||r))return l?(i=this.convertBckInlineStyle(t),"<"+d+(this.config.wordAttributes?this.convertAttr(t):"")+c+(i?" style='"+i+"'":"")+">\n</"+d+">"):"<br>";var p=this.getProp("component");if(p&&(t=p.mergeWordsData(t,{},!0)),a)return this.tableBckConversion(t.data[0],void 0,t);if(r)return this.sectionBckConversion(t.data[0],t);if(o)return this.imageBckConversion(t.data[0],t);if("blockquote"==d){var h=t.classList;(this.data?this.data.ltPropBlockquoteClasses:this.config.blockquoteClasses).every(function(t){if(!(this.getIndex(h,t)+1))return!0;e=t}.bind(this)),c=e?" lyte-blockquote-type='"+e+"'":""}if(i=this.convertBckInlineStyle(t),e){h=t.classList;var u="lyteBlockquoteFirst";switch(e){case"lyteEditorQuoteTopBottom":case"lyteEditorQuoteTopBottomDashed":-1==this.getIndex(h,u)&&(i+="border-top:0;"),-1==this.getIndex(h,"lyteBlockquoteLast")&&(i+="border-bottom:0;");break;case"lyteEditorQuoteTopDashed":case"lyteEditorQuoteTop":-1==this.getIndex(h,u)&&(i+="border-top:0;")}}var m="<"+d+(this.config.wordAttributes?this.convertAttr(t):"")+c+(i?" style='"+i+"'":"")+">",f=t.data;return n||(f.forEach(function(t){m+=this.convertBckWord(t)}.bind(this)),m+="</"+d+">"),m},changeCustomListColorInData:function(t,e){var i="fill:"+encodeURIComponent(t)+"%3B",a=/fill:%23(.*?)%3B/g;return e=e.replace(a,i),a=/fill:rgb(.*?)%3B/g,i="fill:"+encodeURIComponent(t)+"%3B",e=e.replace(a,i),a=/stroke:%23(.*?)%3B/g,i="stroke:"+encodeURIComponent(t)+"%3B",e=e.replace(a,i)},convertBckInlineStyle:function(t){var e="",i=t.classList,a=this.getProp("paraStyleConversion"),o=t.style;for(var n in e+=this.inlineStyle(o)+";",a)-1!=this.getIndex(i.map((function(t){return t.replace(/:\s+/g,":")})),n.replace(/:\s+/g,":"))&&(e+=a[n].join(";")+";");return e.replace(/;;/g,";").replace(/(^;+$)|(;$)/g,"").replace(/\"/g,"&quot;")},_jsonToString:function(t){var e="",i=[],a=this.config,o=0!=a.listVariable,n=this.getProp("listStyle")||{},r=this.getProp("wordStyle")||{},s=a.fromCopy,l=this,d=function(t,e){var i=l.config.convertStyle,a=e.style;for(let t in i){let e=i[t];null!=a[t]&&(a[t]==e.value?(delete a[t],a[e.name]=e.replaceValue):a[t]==e.fallBackValue&&delete a[t])}var r=t.customValue,s="marginInlineStart",d=a[s],c=a.color,p=a["--lyte-texteditor-li-color"],h=a.textAlign,u=a.fontStyle,m=a.fontWeight,f=n["list-style-position"];d&&delete a[s],c&&delete a.color,p&&delete a["--lyte-texteditor-li-color"],u&&delete a.fontStyle,m&&delete a.fontWeight,h&&f?delete a.textAlign:h=void 0,f&&(a.display="inline");var g="";return r||d||c||h||u||m?(g+=" style='",r?g+=o?"list-style-image:var(--tabstyle);":"":o||(g+="list-style-image:none;"),d&&(g+="margin-inline-start:"+d+";"),c&&(g+="color:"+c+";"),u&&(g+="font-style:"+u+";"),m&&(g+="font-weight:"+m+";"),h&&(g+="text-align:"+h+";",f&&(g+="white-space:nowrap;")),g+="'"):r||(g+=" style='list-style-image:none;'"),g},c=function(e,i,a){for(var o,n=t.length,r=1/0,s=a;s<n;s++){var l=t[s],d=l.details.tab;if(!d)break;var c=i-l.attr.tabLevel;if(c>=0&&c<r&&(o=d,r=c),0==c)break}return o},p=function(t){return"<"+t.type.toLowerCase()+(s?" list-style-type='"+t.conversionName+"'":"")+" style='list-style-type:"+t.conversionName+";"+function(t){var e=t.customValue;return e&&o?"--tabstyle:"+e+";":e?"list-style-image:"+e+";":""}(t)+this.inlineStyle(n)+"'>"}.bind(this);return t.forEach(function(t,a){var o,n=t.details.tab,s=this.last(i);if(s)if(n){var l,h=s.level,u=t.attr.tabLevel,m=n.type==s.tab.type&&n.conversionName==s.tab.conversionName;if(this.config.customListColor&&n.customValue&&(m=m&&s.color==(t.style.color||""),n.customValue=this.changeCustomListColorInData(t.style.color||r.color,n.customValue)),!m||u!=h){if(h>=u){l=!0;for(var f=!0,g=s.tab.type.toLowerCase(),y=function(a){var o=p(n);a?e+=o:e=o+e,f?(i.push({tab:n,level:u,color:t.style.color||""}),f=!1):e+="</"+g+">"}.bind(this),v=u;v<=h;v++)if(i.length&&f){if(v==h&&v!=u&&m)break;e+="</"+g+">",i.pop(),s=this.last(i)||s,m=n.type==s.tab.type&&n.conversionName==s.tab.conversionName,g=s.tab.type.toLowerCase(),m||v!=h||(y(!0),u==h&&(l=void 0))}else y()}if(h<=u){l||h++;for(v=h;v<=u;v++){var b=c(0,v,a)||n;e+=p(b),i.push({tab:b,level:v,color:t.style.color||""})}}}e+="<li"+d(n,t)+">",o=!0}else i.reverse().forEach((function(t){e+="</"+t.tab.type.toLowerCase()+">"})),i=[];else if(n){var x=t.attr.tabLevel,_=t.style.color||"";for(this.config.customListColor&&n.customValue&&(n.customValue=this.changeCustomListColorInData(t.style.color||r.color,n.customValue));x>1;){var P={tab:{type:"UL",conversionName:"",level:--x}};e+=p(P.tab),i.push(P)}e+=p(n),i.push({tab:n,level:t.attr.tabLevel,color:_}),e+="<li"+d(n,t)+">",o=!0}e+=this.convertBckPara(t),o&&(e+="</li>")}.bind(this)),i.reverse().forEach((function(t){e+="</"+t.tab.type.toLowerCase()+">"})),e},jsonToString:function(t,e){var i=this.config||{};e&&(this.config=e);var a=this._jsonToString(t);return this.config=i,a},construct_outer:function(t,e,i){var a=t.tagName.toLowerCase(),o=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"].indexOf(a)+1,n="<"+a+" ",r="",s="",l=t.attributes,d=l.length;if(i){s=i(s);var c=/(.*<\/\w>)(<\w>.*)/.exec(e);null!=c&&null!=c[1]&&null!=c[2]&&(r=c[1],e=c[2])}for(var p=0;p<d;p++){var h=l[p];n+=h.nodeName+"='"+h.nodeValue+"' "}return r+n.trim()+">"+e+s+(o?"":"</"+a+">")},limitFilter:function(t,e,i,a){if(e==1/0&&!i)return t;var o,n=function(t,e,i){var o=t.tagName||"",r=!1;if(/^(br|hr)$/i.test(o))return{length:0,html:t.outerHTML};if(/^img|video$/i.test(o))return{length:0,html:this.construct_outer(t,t.innerHTML)};if(t.constructor==Comment||"#comment"==t.nodeName)return{length:0,html:""};if(/input|textarea/i.test(o))return{html:this.construct_outer(t,t.innerText),length:t.value.length};var s="",l=Array.from(t.childNodes);if(l.length){var d,c=0;return l.every((function(i){var a=n(i,e);if(c+=a.length,(e-=a.length)<=0){var o=a.html;return e<0?(c+=e,s+=o.slice(0,o.length+e),d=t.tagName.toLowerCase(),r=!0):s+=o,!1}return s+=a.html,!0})),i||(s=this.construct_outer(t,s)),{html:s,length:c,tag:d,flag:r}}var p=t.nodeValue||"";return s+=a?p:_lyteUiEditor.escapeText(p),{html:o?this.construct_outer(t,s):s,length:p.length}}.bind(this);if("string"==typeof t){if(/^<img/.test(t)&&t.indexOf(">")+1==t.length)return{html:t,length:0,tag:"img"};(o=document.createElement("div")).innerHTML=Lyte.Component.registeredHelpers.unescape(t,void 0,Lyte.Security.createSanitizer({GLOBAL_TAGS:["mention_div"],GLOBAL_ATTRIBUTES:["editable","module","editor-language","display-type"],ADD_URI_SAFE_ATTR:["style","module"],ALLOWED_STYLE:"ALL",STYLE_VALIDATION:!1})).innerHTML}else o=t;if(t){var r=n(o,e,!0);return i?r:r.html}return i?{html:t,length:0}:t},setDefault:function(t){$L.extend(this,t)},copy_image:function(t,e,i,a){var o,n=document.createElement("canvas"),r=n.getContext("2d"),s=(e||"0px 0px").split(" ").map((function(t){return parseFloat(t)}));n.width=1*i,n.height=1*a,r.drawImage(t,-s[0],-s[1],i,a,0,0,1*i,1*a);try{return n.toDataURL()}catch(t){o=""}return o}}),function(){var t=window,e=document;function i(t){var i=_lyteUiEditor,a="_editorresizetime";clearTimeout(i[a]),i[a]=setTimeout((function(){delete i[a];for(var t=e.body.getElementsByTagName("lyte-texteditor"),o=t.length,n=0;n<o;n++){var r=t[n].component,s=r.$node.panel;r.common_positioning(),r.closedropdown(),s&&s.data.ltPropMoreIcon&&s.check_availability()}}),500)}1!=window.__lyteUiEditorResizeEvent&&(window.__lyteUiEditorResizeEvent=!0,["resize","orientationchange"].forEach((function(e){t.addEventListener(e,i,!0)})))}(),_lyteUiEditor.is_dark=function(t){function e(t){var i=[],a=function(t){return t.replace(/\s/g,"").split(",").map((function(t){return t}))};if(/^hsl/.test(t={aliceblue:"xf0f8ff",antiquewhite:"xfaebd7",aqua:"x00ffff",aquamarine:"x7fffd4",azure:"xf0ffff",beige:"xf5f5dc",bisque:"xffe4c4",black:"x000000",blanchedalmond:"xffebcd",blue:"x0000ff",blueviolet:"x8a2be2",brown:"xa52a2a",burlywood:"xdeb887",cadetblue:"x5f9ea0",chartreuse:"x7fff00",chocolate:"xd2691e",coral:"xff7f50",cornflowerblue:"x6495ed",cornsilk:"xfff8dc",crimson:"xdc143c",cyan:"x00ffff",darkblue:"x00008b",darkcyan:"x008b8b",darkgoldenrod:"xb8860b",darkgray:"xa9a9a9",darkgrey:"xa9a9a9",darkgreen:"x006400",darkkhaki:"xbdb76b",darkmagenta:"x8b008b",darkolivegreen:"x556b2f",darkorange:"xff8c00",darkorchid:"x9932cc",darkred:"x8b0000",darksalmon:"xe9967a",darkseagreen:"x8fbc8f",darkslateblue:"x483d8b",darkslategray:"x2f4f4f",darkslategrey:"x2f4f4f",darkturquoise:"x00ced1",darkviolet:"x9400d3",deeppink:"xff1493",deepskyblue:"x00bfff",dimgray:"x696969",dimgrey:"x696969",dodgerblue:"x1e90ff",firebrick:"xb22222",floralwhite:"xfffaf0",forestgreen:"x228b22",fuchsia:"xff00ff",gainsboro:"xdcdcdc",ghostwhite:"xf8f8ff",gold:"xffd700",goldenrod:"xdaa520",gray:"x808080",grey:"x808080",green:"x008000",greenyellow:"xadff2f",honeydew:"xf0fff0",hotpink:"xff69b4",indianred:"xcd5c5c",indigo:"x4b0082",ivory:"xfffff0",khaki:"xf0e68c",lavender:"xe6e6fa",lavenderblush:"xfff0f5",lawngreen:"x7cfc00",lemonchiffon:"xfffacd",lightblue:"xadd8e6",lightcoral:"xf08080",lightcyan:"xe0ffff",lightgoldenrodyellow:"xfafad2",lightgray:"xd3d3d3",lightgrey:"xd3d3d3",lightgreen:"x90ee90",lightpink:"xffb6c1",lightsalmon:"xffa07a",lightseagreen:"x20b2aa",lightskyblue:"x87cefa",lightslategray:"x778899",lightslategrey:"x778899",lightsteelblue:"xb0c4de",lightyellow:"xffffe0",lime:"x00ff00",limegreen:"x32cd32",linen:"xfaf0e6",magenta:"xff00ff",maroon:"x800000",mediumaquamarine:"x66cdaa",mediumblue:"x0000cd",mediumorchid:"xba55d3",mediumpurple:"x9370db",mediumseagreen:"x3cb371",mediumslateblue:"x7b68ee",mediumspringgreen:"x00fa9a",mediumturquoise:"x48d1cc",mediumvioletred:"xc71585",midnightblue:"x191970",mintcream:"xf5fffa",mistyrose:"xffe4e1",moccasin:"xffe4b5",navajowhite:"xffdead",navy:"x000080",oldlace:"xfdf5e6",olive:"x808000",olivedrab:"x6b8e23",orange:"xffa500",orangered:"xff4500",orchid:"xda70d6",palegoldenrod:"xeee8aa",palegreen:"x98fb98",paleturquoise:"xafeeee",palevioletred:"xdb7093",papayawhip:"xffefd5",peachpuff:"xffdab9",peru:"xcd853f",pink:"xffc0cb",plum:"xdda0dd",powderblue:"xb0e0e6",purple:"x800080",rebeccapurple:"x663399",red:"xff0000",rosybrown:"xbc8f8f",royalblue:"x4169e1",saddlebrown:"x8b4513",salmon:"xfa8072",sandybrown:"xf4a460",seagreen:"x2e8b57",seashell:"xfff5ee",sienna:"xa0522d",silver:"xc0c0c0",skyblue:"x87ceeb",slateblue:"x6a5acd",slategray:"x708090",slategrey:"x708090",snow:"xfffafa",springgreen:"x00ff7f",steelblue:"x4682b4",tan:"xd2b48c",teal:"x008080",thistle:"xd8bfd8",tomato:"xff6347",turquoise:"x40e0d0",violet:"xee82ee",wheat:"xf5deb3",white:"xffffff",whitesmoke:"xf5f5f5",yellow:"xffff00",yellowgreen:"x9acd32"}[t]||t)){var o=a(/hsl\((.+)\)/.exec(t)[1]),n={hue:parseInt(o[0]),saturation:parseInt(o[1]),lightness:parseInt(o[2])};[0,120,240].forEach((t=>{i.push(function(t,e){var i=(t-60+360)%360,a=(t+60)%360,o=(t-120+360)%360,n=(t+120)%360,r=e.hue||360,s=e.saturation||100,l=e.lightness||50,d=function(t,e){return t>e&&(e+=360),e>=r&&r>=t},c=128*(100-s)/100,p=parseInt(c),h=function(t){var e=255-255*Math.abs(t)/60;return e=128+s*(e-128)/100,parseInt(e)},u=Math.round(c);d(i,t)||d(t,a)?u=Math.round(255-p):d(o,i)?u=h(i-r):d(a,n)&&(u=h(a-r));l>50?u+=(255-u)*(100-l)/50:u-=u*(50-l)/50;return Math.max(0,Math.min(Math.round(u),255))}(t,n))}))}else if(/^x/.test(t))i=function(t){var e=/x(..)(..)(..)/.exec(t);return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}(t);else if(/^hwb/.test(t)){var r=a(/hwb\((.+)\)/.exec(t)[1]),s={hue:parseInt(r[0]),whiteness:parseInt(r[1]),blackness:parseInt(r[2])};i=function(t){var i=t.whiteness/100,a=t.blackness/100,o=e("hsl("+t.hue+",100%,50%)"),n=i+a;n>1&&(i/=n,a/=n);return o.map((function(t){return t*=1-i-a,t+=255*i,Math.round(t)}))}(s)}else if(/^cmyk/.test(t)){var l=a(/cmyk\((.+)\)/.exec(t)[1]),d={cyan:parseInt(l[0]),magenta:parseInt(l[1]),yellow:parseInt(l[2]),black:parseInt(l[3])};i=function(t){var e=t.black/100,i=t.cyan/100,a=t.magenta/100,o=t.yellow/100,n=1-e;return[255-255*Math.min(1,i*n+e),255-255*Math.min(1,a*n+e),255-255*Math.min(1,o*n+e)].map(Math.round)}(d)}else/^rgb/.test(t)&&(i=a(/\((.+)\)/.exec(t)[1]).map((function(t){return parseInt(t)})));return i}return function(t){var i=e(t);return Math.sqrt(.299*i[0]*i[0]+.587*i[1]*i[1]+.114*i[2]*i[2])<127.5}(t||"")},_lyteUiEditor.fiterOut_meta=function(t){var e=[];t.forEach((function(t,i){"meta"==t.type&&e.push(i)}));for(var i=e.length,a=t.length-1,o=0,n=i-1;n>=0&&e[n]==a-o++;n--)e.splice(n,1),i--;o=0;for(n=0;n<i--&&e[n]==o+++n;n++)e.splice(n--,1);return e.reverse().forEach((function(e){t.splice(e,1)})),t},_lyteUiEditor.operations=function(t){var e=this;function i(t){return $L(e.$node).find("#"+t)}function a(t){var i=t.get(0);if(i==e._maindiv)return"";var o=t.parent(),n=o.data("list"),r=_lyteUiEditor.getIndex(n,i),s=a(o);return s?s+"arr:"+r+".data.":"arr:"+r+".data."}function o(t){return JSON.stringify(t)}function n(t){var e=t.id,n=t.index,r=t.wordIndex,s=a(i(e)),l="arr:"+n+".data.arr:"+r+".text",d="arr:"+n+".data.arr:"+r;return function(t){return t.oldValue==t.newValue}(t)?{type:"meta",operations:s+d,value:o(t.current)}:[{type:"update",operations:s+l,value:o({oldValue:t.oldValue,newValue:t.newValue})},{type:"meta",operations:s+d,value:o(t.current)}]}function r(t,e){var n=t.id,r=t.index;return{type:e||"paragraphCreate",operations:a(i(n))+("arr:"+r),value:o(t.data)}}function s(t){return r(t,"paragraphRemove")}function l(t){var e=t.id,n=t.index,r=a(i(e)),s="",l=t.prop;return n?t.table?s="arr:"+n.paraIndex+".data.arr:0.data.arr:0.style."+t.prop:t.word?s="arr:"+n.paraIndex+".data.arr:"+n.wordIndex+".style."+t.prop:t.paragraph&&(s="arr:"+n.paraIndex+".style."+t.prop):(r=r.replace(/data\.$/,""),s="style."+l),{type:"styleSet",operations:r+s,value:o({oldValue:t.oldValue,newValue:t.newValue})}}function d(t){var e=t.id,n=t.index;return{type:"tablevelUpdate",operations:a(i(e))+("arr:"+n+".details.tab.order"),value:o({oldValue:t.oldValue,newValue:t.newValue})}}function c(t){return{type:"spanSet",operations:a(i(t.id)).replace(/data\.$/,"")+("details."+t.property),value:o({oldValue:t.oldValue,newValue:t.newValue})}}function p(t,e){var n=t.id,r=t.index;return{type:e||"rowCreate",operations:a(i(n))+("arr:"+r+".data.arr:0.data.arr:0.data.arr:1.data.arr:"+t.rowIndex),value:o(t.data)}}function h(t){return p(t,"rowDelete")}function u(t,e){var n=[];return t.data.forEach((function(r,s){n.push(function(t,e,n){var r=t.id,s=t.index;return{type:n||"cellInsert",operations:a(i(r))+"arr:"+s+".data.arr:0.data.arr:0.data.arr:"+(e?1:0)+".data.arr:"+Math.max(e-1,0)+".data.arr:"+t.cellIndex,value:o(t.data[e])}}(t,s,e))})),n}function m(t){return u(t,"cellDelete")}function f(t,e){var n=t.id,r=t.index,s=r.paraIndex,l=r.wordIndex;return{type:e||"wordInsert",operations:a(i(n))+("arr:"+s+".data.arr:"+l),value:o(t.data)}}function g(t){return f(t,"wordDelete")}function y(t){var e=t.id,n=t.index,r=t.wordIndex;return{type:"mention",operations:a(i(e))+("arr:"+n+".data.arr:"+r+".details"),value:o(t.oldValue)}}function v(t){var e=a(i(t.id));return{type:t.prop,operations:e+t.element,value:t.value}}function b(t){return{type:"properties",operations:a(i(t.id))+t.prop,value:o({oldValue:t.oldValue,newValue:t.newValue})}}function x(t){return{type:"attribute",operations:a(i(t.id))+t.prop,value:o({oldValue:t.oldValue,newValue:t.newValue})}}return function(t){var e;switch(t.operation){case"update":e=n;break;case"paragraphCreate":e=r;break;case"paragraphRemove":e=s;break;case"styleSet":e=l;break;case"tablevelUpdate":e=d;break;case"spanSet":e=c;break;case"rowCreate":e=p;break;case"rowDelete":e=h;break;case"cellInsert":e=u;break;case"cellDelete":e=m;break;case"wordInsert":e=f;break;case"wordDelete":e=g;break;case"mention":e=y;break;case"class":e=v;break;case"properties":e=b;break;case"attribute":e=x}var i=e(t);if("meta"==i.type||!i.oldValue||i.oldValue!=i.newValue)return i}(t)},function(){function t(e,i,a,o,n,r){var s="",l=e.tagName;if(e.constructor==Text){var d="";return a.forEach((function(t){s+="<"+t+">",d="</"+t+">"+d})),s+=_lyteUiEditor.escapeText(e.nodeValue)+d}if(!/^li$/i.test(l))for(var c in i){var p=i[c],h=e.style[c];if(h){var u,m={};for(var c in p.forEach((function(t){var e=t.value;-1!=h.indexOf(e)?(u=1,"P"!=l&&a.push(t.tag),h=h.replace(e,"").trim()):"A"==l&&"underline"==e&&(m[c]="none")})),m){p=m[c];h+=(" "+p).trim()}u&&(e.style[c]=h)}}var f,g=function(){var o;Array.from(e.childNodes).forEach((function(e){s+=t(e,i,a.slice(),o,n,r),o=e}))},y=(l=e.tagName,/span/i.test(l));if(/^p$/i.test(l)&&(/^li$/i.test(e.parentNode.tagName||"")?Array.from(e.children).forEach((function(t){t.style.color||(t.style.color=r.color),t.style.fontWeight||(t.style.fontWeight="normal"),t.style.fontStyle||(t.style.fontStyle="normal")})):(e.style.color="",e.style.fontWeight="",e.style.fontStyle="")),y&&"inline"==e.style.display&&(e.style.display=""),(""==(f=e.getAttribute("style"))||null==f)&&(e.removeAttribute("style"),0==e.attributes.length&&y&&(e.childNodes[0]||{}).constructor==Text))return g()||s;if(n){if(/^p$/i.test(l)&&0==e.attributes.length&&0==e.style.length)return(g()||s)+"<br>";if(/^br$/i.test(l))return s+="<br>"}return _lyteUiEditor.construct_outer(e,g()||s)}_lyteUiEditor.convert_simple=function(e,i,a){var o=e.data.ltPropWordSimpleConversion||{},n=document.createElement("div");return n.innerHTML=i,function(e,i,a,o){var n,r="";return e.forEach((function(e){r+=t(e,i,[],n,a,o),n=e})),r}(Array.from(n.childNodes),o,a,e.data.ltPropWordStyle||{color:"initial"})}}(),Lyte.Component.registerHelper("lyteUiEditorHighlight",(function(t,e){if(e){var i=new RegExp("("+(e||"").replace(/(\\|\'|\"|\?|\^|\$|\.|\||\*|\+|\(|\)|\[|\]|\{|\})/g,"\\$1")+")","gi");return t.replace(i,'<span class="lyteEditorMentionHighlight">$1</span>')}return t})),Lyte.Component.registerHelper("lyteUiEditorI18n",(function(t){return _lyteUiEditor.i18n(t)})),Lyte.Mixin.register("lyte-editor-bluepencil",{actions:{mainPaste:function(t){if(null!=this.__empty_pencil_time)return!1;var e=t.clipboardData.getData("text/html");return 0!=this.paste(t,!0)&&(this._editdiv.innerHTML=e),t.preventDefault(),!1},mainInput:function(t){var e="__blue_ignore";if(this[e])return delete this[e],!1;var i=t.inputType;if("insertFromPaste"==i)return this[e]=!0,this.reset_entire();if("insertCompositionText"!=i){var a=window.getSelection().getRangeAt(0);if(a.collapsed){var o=a.commonAncestorContainer.parentNode,n=a.startOffset,r=o.textContent,s=t.data,l=this.data,d=(l.range,"onAfterInput");this.$node.contains(l.currentNode)&&this.reset_current_word(l.currentNode,o,l.cursor,r,n,s),this.getMethods(d)&&this.executeMethod(d,l.currentNode,l.cursor,this.$node)}}},mainKey:function(t){this.copy_evt(t);this.keydown(t);this._editdiv.focus(),this.remove_evt()}},reset_entire:function(t){var e=this._maindiv,i=e.innerHTML,a=event,o=function(){var t=$L(e).data("list")[0],o=this.$node,n=this.__place;Array.from(e.childNodes).forEach((function(t){t.remove()})),n&&this.append(o,n),this.append(this._maindiv,this._cursor),this.append(e,t),i&&o.insertHTML(i),this.execute("onAfterPaste",this._editdiv,a,this.$node),this.checkPlaceholder(),delete this.__blue_ignore}.bind(this);t?o():(clearTimeout(this.__empty_pencil_time),delete this.__empty_pencil_time,setTimeout(o,100))},dispatch_input:function(){this.__blue_ignore=!0,this._maindiv.dispatchEvent(new Event("input",{bubbles:!0}))},__blue_undo:function(){var t=window.getSelection(),e=document.createRange(),i=this.data,a=i.currentNode.childNodes[0],o=i.cursor;t.removeAllRanges(),e.setStart(a,o),e.setEnd(a,o),t.addRange(e),this.dispatch_input()},blue_undo:function(){clearTimeout(this.__blue),this.__blue=setTimeout(this.__blue_undo.bind(this))},pencil_index:function(t,e){var i=t.parentNode||e.parentNode,a=$L(i),o=a.closest(".listHolderElement"),n=o.attr("id"),r=a.data("list"),s=this.getIndex(o.data("list"),i);return{wordIndex:this.getIndex(r,t),paraIndex:s,id:n}},positional_update:function(t,e,i,a,o){var n=this.pencil_index(t,i),r=null==o;this.pushToQueue({operation:"update",oldValue:a,newValue:r?a:o,id:n.id,index:n.paraIndex,wordIndex:n.wordIndex,current:{index:{wordIndex:n.wordIndex,position:e},bluepencil:!0}}),r||this.update_count(o.length-a.length)},modify_pencil_nodes:function(t){t.forEach(function(t){var e=t.act_text;this.positional_update(t.node,e.length,void 0,t.ori_text,e),t.data.text=e}.bind(this))},remove_pencil_nodes:function(t,e){var i=e.parentNode,a=$L(i),o=a.closest(".listHolderElement"),n=o.attr("id"),r=a.data("list"),s=a.data("data").data,l=this.getIndex(o.data("list"),i);t.forEach(function(t){var e=this.getIndex(r,t),i=s[e];this.pushToQueue({operation:"wordDelete",data:i,index:{id:n,paraIndex:l,wordIndex:e},id:n}),this.update_count(-i.text.length),r.splice(e,1),s.splice(e,1)}.bind(this))},reset_current_word:function(t,e,i,a,o,n){var r=$L(t).data("data").text,s=this.get_removed_words(e.parentNode),l=s.removed,d=s.modified;this.positional_update(t,i,e,r),this.remove_pencil_nodes(l,e),this.modify_pencil_nodes(d),this.positional_update(e,o,void 0,a),this.setData({currentNode:e,cursor:o}),this.common_positioning()},get_removed_words:function(t){var e=Array.from(t.children),i=$L(t).data("list"),a=[];return{removed:i.filter((function(t){var i=-1==e.indexOf(t);if(!i){var o=t.textContent,n=$L(t).data("data"),r=n.text;o!=r&&a.push({node:t,act_text:o,ori_text:r,data:n})}return i})),modified:a}},before_edit_open:function(){this.selectAll();var t=this.$node.getHTML().replace(/<br>/g,'<p><span style = "display:inline-block;"></span></p>'),e=Array.from($L(t)),i=window.getSelection(),a=document.createRange(),o=this.__place,n=this._maindiv.querySelector(".lyteEditorCursor"),r=Lyte.Component;this.removeSelected(),n||this._maindiv.appendChild(n=e.shift()),this.toArray(this._editdiv.childNodes).forEach((function(t){t.tagName?t.remove():t.nodeValue&&(t.nodeValue="")})),this.createRange(this._editdiv.childNodes[0],0),Array.from(n.parentNode.querySelectorAll(this.getTag("paragraph"))).forEach((function(t){t.remove()})),e.forEach((function(t){t.removeAttribute("id"),r.insertAfter(n,n=t)})),this._cursor.remove(),o&&o.remove(),i.removeAllRanges();var s,l=$L(n.childNodes).get(-1)||n,d=l.nodeValue;s=d?d.length:((l.childNodes||[]).length||1)-1,a.setStart(l,s),a.setEnd(l,s),i.addRange(a),window.requestAnimationFrame(this.common_evt_fn.bind(this,"add"))},common_evt_fn:function(t){var e,i="__pencil_evt",a="__pencil_close",o=this[i];"add"==t?(o=this[i]=this.pencil_move.bind(this),e=this[a]=this.pencil_close.bind(this)):(delete this[i],this._maindiv.removeEventListener("bpe_pocketeditor_close",this[a])),document.body[t+"EventListener"]("click",o,!0),this._maindiv.addEventListener("bpe_pocketeditor_close",e)},pencil_move:function(t){t.target},pencil_close:function(){this.common_evt_fn("remove"),this._maindiv.focus(),this.__empty_pencil_time=setTimeout(function(){delete this.__empty_pencil_time,this.reset_entire(!0)}.bind(this),100)},append_cursor:function(t){var e=t.parentNode,i=$L((e||{}).children).get(-1);e&&i!=t&&e.appendChild(t)}}),Lyte.Component.register("lyte-editor-item",{_template:'<template tag-name="lyte-editor-item" onkeydown="{{action(\'keydown\',event)}}"> <template is="switch" value="{{item.type}}"><template case="switch"></template><template case="undo"></template><template case="anchor"></template><template case="list"><template is="if" value="{{item.display}}"><template case="true"><template is="if" value="{{fromList}}"><template case="true"> {{unescape(item.display,undefined,sanitizer.attr)}} </template><template case="false"> {{item.display}} </template></template></template></template></template><template case="dropdown"> <lyte-dropdown lt-prop="{{ltPropDropdown}}" lt-prop-is-open="{{lbind(cpShow)}}" lt-prop-selected="{{lbind(item.selected)}}" on-option-selected="{{method(\'throw\',\'dropItemSelected\',item)}}" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-display-value="{{lbind(item.displayValue)}}" on-show="{{method(\'throw\',\'elementOpen\')}}" on-hide="{{method(\'throw\',\'elementClose\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="editor-dropdown lyteEditorPanelDropdown {{item.class}} {{ltPropWrapperClass}}"> <lyte-drop-body> <template is="for" items="{{item.display}}" item="dropItem" index="index"> <lyte-drop-item class="lyteEditorPanelDropItem" data-value="{{item.value[index]}}" style="--editorPanelDropValue:{{item.value[index]}}"> {{dropItem}} </lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template><template case="colorpicker"> {{item.display}} <lyte-colorpicker lt-prop-yield="{{isFont}}" lt-prop-no-fill-button="{{expHandlers(isFont,\'!\')}}" class="editor-colorpicker lyteEditorPanelColorPicker" lt-prop-origin-element="{{editorOrigin}}" on-select="{{method(\'throw\',\'colorPickerSelect\',item)}}" lt-prop-wrapper-class="{{editorId}}{{item.name}}colorpicker {{ltPropWrapperClass}}" style="display: none;" lt-prop="{{ltPropColorPicker}}" lt-prop-show="{{lbind(cpShow)}}" on-open="{{method(\'throw\',\'elementOpen\')}}" on-before-open="{{method(\'throw\',\'elementBeforeOpen\')}}" on-close="{{method(\'throw\',\'elementClose\',item)}}" lt-prop-popover="{{ltPropPopover}}" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-selected-color="{{lbind(item.selectedColor)}}" lt-prop-used-colors-list="{{lbind(item.usedColorsList)}}"> <template is="registerYield" yield-name="cpyield"> <span class="lyteEditorPanelDefaultColor" onclick="{{action(\'reset\')}}">{{lyteUiEditorI18n("Reset to default color")}}</span> </template> </lyte-colorpicker> <span class="lyteEditorColorIconClass" style="background: {{item.selected}};"></span> </template><template case="emoji"> {{item.display}} <lyte-popover lt-prop-focus-on-close="true" lt-prop-origin-elem="{{editorOrigin}}" lt-prop-show="{{lbind(item.active)}}" class="lyteEditorEmojiPopover" lt-prop-duration="{{undef}}" lt-prop-wrapper-class="lyteEditorEmojiPopoverWrapper {{editorId}}{{item.name}}Popover {{ltPropWrapperClass}}" lt-prop-allow-multiple="true" lt-prop="{{ltPropPopover}}" on-show="{{method(\'throw\',\'elementOpen\')}}" on-before-close="{{method(\'emojiClose\')}}" on-close="{{method(\'throw\',\'elementClose\')}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="popover"> <template is="if" value="{{expHandlers(item.input,\'!=\',undefined)}}"><template case="true"> <lyte-emoji on-emoji-select="{{method(\'throw\',\'emojiselect\',item)}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-no-match-text="{{item.noMatchText}}" lt-prop-input="{{item.input}}"></lyte-emoji> </template><template case="false"> <lyte-emoji on-emoji-select="{{method(\'throw\',\'emojiselect\',item)}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}"></lyte-emoji> </template></template> </template> </lyte-popover> </template><template case="custom"> <lyte-yield yield-name="editor-custom" item="{{item}}"></lyte-yield> </template><template case="image"><template is="if" value="{{item.display}}"><template case="true"> {{item.display}} </template></template> <lyte-modal lt-prop-wrapper-class="{{setImageModalClass()}}" lt-prop-show-close-button="false" lt-prop-show="{{lbind(cpShow)}}" lt-prop-duration="{{undef}}" lt-prop="{{ltPropModal}}" on-show="{{method(\'throw\',\'elementOpen\')}}" on-close="{{method(\'throw\',\'elementClose\')}}" on-before-show="{{method(\'popoverOpen\')}}" on-before-close="{{method(\'popoverClose\')}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header class="lyteEditorImageHeader"> {{lyteUiEditorI18n("Insert Image")}} </lyte-modal-header> <lyte-modal-content class="lyteEditorImageContent"> <div class="lyteEditorInsertImageRadioWrap"> <lyte-radiobutton class="lyteEditorUploadImageRadio" lt-prop-type="primary" lt-prop-name="{{editorId}}" lt-prop-checked="{{expHandlers(isUrl,\'!\')}}" lt-prop-value="image" lt-prop-label="Upload image"></lyte-radiobutton> <lyte-radiobutton lt-prop-type="primary" lt-prop-name="{{editorId}}" lt-prop-checked="{{lbind(isUrl)}}" lt-prop-value="url" lt-prop-label="Upload from Url"></lyte-radiobutton> </div> <div class="lyteEditorImageUpload {{if(isUrl,\'lyteEditorHide\',\'\')}}"> <input class="lyteEditorOriginalImageUpload" type="file" onchange="{{action(\'change\',this)}}" accept="image/jpg,image/png,image/jpeg,image/gif,image/bmp"> <lyte-button onclick="{{action(\'openfile\',this)}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Upload from computer")}} </template> </lyte-button> <template is="if" value="{{url}}"><template case="true"> <div style="position: relative;"> <span class="lyteEditorPreviewImageClose" onclick="{{action(\'removeImg\')}}"></span> <img crossorigin="anonymus" class="lyteEditorPreviewImage" src="{{url}}" onload="{{action(\'imageLoad\',true)}}" onerror="{{action(\'imageLoad\',false)}}"> </div> </template><template case="false"> <div class="lyteEditorInsertImagePlaceholder"> {{lyteUiEditorI18n("Image preview will be shown here.")}} </div> </template></template> </div> <template is="if" value="{{renderUrl}}"><template case="true"> <div class="lyteEditorImageUrl {{if(isUrl,\'\',\'lyteEditorHide\')}}"> <lyte-input class="lyteEditorImageUrlInput" lt-prop-appearance="box" lt-prop-placeholder="Enter valid image URL" lt-prop-value="{{lbind(url)}}" lt-prop-focus="{{isUrl}}"></lyte-input> <template is="if" value="{{imageError}}"><template case="true"> <div class="lyteEditorImageErrorMessage"> {{lyteUiEditorI18n("Error in loading the image. Pls check the URL.")}} </div> </template></template> <template is="if" value="{{expHandlers(url,\'&amp;&amp;\',expHandlers(imageError,\'!\'))}}"><template case="true"> <div class="lyteEditorImagePreview {{if(imageError,\'lyteEditorImageError\',\'\')}}"> <span class="lyteEditorPreviewImageClose" style="position: absolute;right: 5px;top: 5px;width: 15px;height: 15px;display: inline-block;border: 1px solid black" onclick="{{action(\'removeImg\')}}"></span> <img crossorigin="anonymus" class="lyteEditorPreviewImage" src="{{url}}" onload="{{action(\'imageLoad\',true)}}" onerror="{{action(\'imageLoad\',false)}}"> </div> </template><template case="false"> <div class="lyteEditorInsertImagePlaceholder"> {{lyteUiEditorI18n("Image preview will be shown here.")}} </div> </template></template> </div> </template></template> <div class="lyteEditorImageSizeControl"> <lyte-radiobutton lt-prop-checked="{{lbind(fitToScreen)}}" lt-prop-value="fit_to_screen" lt-prop-type="primary" lt-prop-name="image_size _{{editorId}}" lt-prop-label="Fit to screen"></lyte-radiobutton> <lyte-radiobutton lt-prop-checked="{{lbind(small)}}" lt-prop-value="small" lt-prop-type="primary" lt-prop-name="image_size _{{editorId}}" lt-prop-label="small"></lyte-radiobutton> <lyte-radiobutton lt-prop-checked="{{lbind(actualSize)}}" lt-prop-value="actual_size" lt-prop-type="primary" lt-prop-name="image_size _{{editorId}}" lt-prop-label="Actual size"></lyte-radiobutton> </div> <template is="if" value="{{ltPropShowWrapImage}}"><template case="true"> <div class="lyteEditorImageWrapContainer"> <lyte-checkbox lt-prop-name="checkbox" lt-prop-checked="{{lbind(wrapImage)}}" lt-prop-label="{{lyteUiEditorI18n(\'Wrap Image\')}}" lt-prop-value="val" lt-prop-id="checkbox"></lyte-checkbox> </div> </template></template> <template is="if" value="{{expHandlers(item.advancedOptions,\'&amp;&amp;\',expHandlers(url,\'||\',loaded))}}"><template case="true"> <lyte-accordion> <template is="registerYield" yield-name="yield"> <lyte-accordion-item> <lyte-accordion-header>Advanced Options<lyte-icon class="lyteAccordionArrow"></lyte-icon></lyte-accordion-header> <lyte-accordion-body> <template is="for" items="{{ltPropImageOptions}}" item="optionsItem" index="index"> <div class="{{optionsItem.class}}"> <template is="if" value="{{optionsItem.label}}"><template case="true"><div> {{optionsItem.label}} </div></template></template> <template items="{{optionsItem.subItems}}" item="subItem" index="index" is="for"> <template value="{{subItem.type}}" is="switch">      <template case="input"> <div class="{{subItem.class}}"> {{subItem.label}} <lyte-input class="{{subItem.class}}" lt-prop="{{stringify(subItem.prop)}}" lt-prop-value="{{lbind(subItem.value)}}"></lyte-input> </div> </template><template case="number"> <div class="{{subItem.class}}"> {{subItem.label}} <lyte-number lt-prop="{{stringify(subItem.prop)}}" lt-prop-label="{{lbind(subItem.unit)}}" lt-prop-value="{{lbind(subItem.value)}}" on-value-change="{{method(\'numberValueChange\',subItem.purpose)}}"></lyte-number> </div> </template><template case="radioButtonGroup"> <div class="{{subItem.class}}"> {{subItem.label}} <lyte-radiobutton-group lt-prop="{{stringify(subItem.prop)}}" lt-prop-selected="{{lbind(subItem.selected)}}" lt-prop-user-value="{{subItem.userValue}}" lt-prop-system-value="{{subItem.systemValue}}" lt-prop-options="{{subItem.options}}" on-checked="{{method(\'alignChange\')}}"></lyte-radiobutton-group> </div> </template><template case="dropdown"> <div class="{{subItem.class}}"> {{subItem.label}} <lyte-dropdown lt-prop-options="{{subItem.options}}" lt-prop-user-value="{{subItem.userValue}}" lt-prop-system-value="{{subItem.systemValue}}" on-option-selected="{{method(\'changeunit\')}}"></lyte-dropdown> </div> </template><template case="checkBox"> <div class="{{subItem.class}}"> <lyte-checkbox lt-prop="{{stringify(subItem.prop)}}" lt-prop-label="{{subItem.label}}" lt-prop-checked="{{lbind(maintainAspectRatio)}}"></lyte-checkbox> </div> </template></template> </template> </div> </template> </lyte-accordion-body> </lyte-accordion-item> </template> </lyte-accordion> </template></template> </lyte-modal-content> <lyte-modal-footer class="right lyteEditorImageFooter"> <lyte-button onclick="{{action(\'insert\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Cancel")}} </template> </lyte-button> <lyte-button lt-prop-disabled="{{disabled}}" lt-prop-appearance="primary" onclick="{{action(\'insert\',this)}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Insert")}} </template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </template><template case="codeEditor"> <lyte-modal lt-prop="{{ltPropModal}}" lt-prop-show="{{lbind(cpShow)}}" lt-prop-wrapper-class="lyteEditorSnippetModal" lt-prop-width="70%" lt-prop-height="70%" lt-prop-set-content-height="true" lt-prop-show-close-button="false" lt-prop-transition="{&quot;animation&quot;:&quot;fadeIn&quot;, &quot;duration&quot;:&quot;0.3&quot;}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <span>Insert code</span> <div class="lyteEditorSnippetModalLanguageSection"> <span class="lyteEditorSnippetChooseLangLabel">Choose language: </span> <lyte-dropdown lt-prop-options="{{languagesSupported}}" lt-prop-selected="{{lbind(languageSelected)}}"> </lyte-dropdown> </div> </lyte-modal-header> <lyte-modal-content class="lyteFilterContent"> <textarea class="lyteEditorSnippetTextarea" spellcheck="false"></textarea> </lyte-modal-content> <lyte-modal-footer class="right"> <lyte-button onclick="{{action(\'insertCode\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Cancel")}} </template> </lyte-button> <lyte-button lt-prop-appearance="primary" onclick="{{action(\'insertCode\',this)}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Insert")}} </template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </template><template case="insertHTML"> <lyte-modal lt-prop="{{ltPropModal}}" lt-prop-show="{{lbind(cpShow)}}" lt-prop-wrapper-class="lyteEditorInsertHTMLModal" lt-prop-width="auto" lt-prop-height="auto" lt-prop-set-content-height="true" lt-prop-show-close-button="false" lt-prop-transition="{&quot;animation&quot;:&quot;fadeIn&quot;, &quot;duration&quot;:&quot;0.3&quot;}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <template is="if" value="{{showPreview}}"><template case="true"> <span class="lyteEditorInsertHTMLBack" onclick="{{action(\'hidePreview\',this)}}">---</span> <span>{{lyteUiEditorI18n("Preview")}}</span> </template><template case="false"> <span>{{lyteUiEditorI18n("Insert HTML")}}</span> </template></template> </lyte-modal-header> <lyte-modal-content class="lyteFilterContent"> <template is="if" value="{{showPreview}}"><template case="true"> <div class="lyteEditorInsertHTMLPreview">{{unescape(ltPropPreviewContent,undefined,sanitizer.attr)}}</div> </template><template case="false"> <textarea class="lyteEditorInsertHTMLTextarea" spellcheck="false" value="{{lbind(ltPropPreviewContent)}}"></textarea> <div onclick="{{action(\'showPreview\',this)}}">Preview</div> </template></template> </lyte-modal-content> <lyte-modal-footer class="right"> <lyte-button lt-prop-appearance="primary" onclick="{{action(\'insertHTML\',this)}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Insert")}} </template> </lyte-button> <lyte-button onclick="{{action(\'insertHTML\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Cancel")}} </template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{switch:{dynamicNodes:[],additional:{next:"undo"}},undo:{dynamicNodes:[],additional:{next:"anchor"}},anchor:{dynamicNodes:[],additional:{next:"list"}},list:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]},dropdown:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'--editorPanelDropValue:'","item.value[index]"]}}}},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},colorpicker:{dynamicNodes:[{type:"text",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","item.selected","';'"]}}}}]},emoji:{dynamicNodes:[{type:"text",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},{type:"componentDynamic",position:[3]}]},custom:{dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},image:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"attr",position:[2]},{type:"registerYield",position:[2,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1,1]},{type:"componentDynamic",position:[3,1,1]},{type:"attr",position:[3,1,3]},{type:"componentDynamic",position:[3,1,3]},{type:"attr",position:[3,3]},{type:"attr",position:[3,3,1]},{type:"attr",position:[3,3,3]},{type:"registerYield",position:[3,3,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3,3,3]},{type:"attr",position:[3,3,5]},{type:"if",position:[3,3,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,3]}]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[3,5]},{type:"if",position:[3,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"attr",position:[1,3]}]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}}]}},default:{}},{type:"attr",position:[3,7,1]},{type:"componentDynamic",position:[3,7,1]},{type:"attr",position:[3,7,3]},{type:"componentDynamic",position:[3,7,3]},{type:"attr",position:[3,7,5]},{type:"componentDynamic",position:[3,7,5]},{type:"attr",position:[3,9]},{type:"if",position:[3,9],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"attr",position:[3,11]},{type:"if",position:[3,11],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[0,1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"for",position:[1,3],dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{input:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},number:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},radioButtonGroup:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},dropdown:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},checkBox:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[2]}]},codeEditor:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,3,3]},{type:"componentDynamic",position:[1,3,3]},{type:"componentDynamic",position:[1]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[1]}]},insertHTML:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[3,0]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]}]}},default:{}},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[1]}]}},default:{}}],_templateAttributes:{type:"attr",position:[]},_observedAttributes:["ltPropDropdown","ltPropPopover","ltPropColorPicker","ltPropTabindex","ltPropWrapperClass","ltPropFreeze","ltPropPreviewContent","ltPropSanitizer","item","editorId","ltPropTooltipConfig","active","activeClass","editorOrigin","cpShow","languagesSupported","languageSelected","sanitizer","fromList","isFont","isUrl","url","imageError","disabled","loaded","renderUrl","fitToScreen","small","actualSize","maintainAspectRatio","showPreview","wrapImage"],data:function(){var t=Lyte.attr.bind(Lyte),e="string",i="boolean",a=!1;return{ltPropDropdown:t(e,{default:"{}"}),ltPropPopover:t(e,{default:"{}"}),ltPropColorPicker:t(e,{default:"{}"}),ltPropTabindex:t(e,{default:"-1"}),ltPropWrapperClass:Lyte.attr("string",{default:""}),ltPropFreeze:Lyte.attr("boolean",{default:!1}),ltPropPreviewContent:t(e,{default:""}),ltPropSanitizer:t("object",{default:{}}),item:t("object"),editorId:t(e),ltPropTooltipConfig:t(e),active:t(i),activeClass:t(e),editorOrigin:t(e),cpShow:t(i,{default:a}),languagesSupported:t("array",{default:["HTML","CSS","JS","JAVA","PYTHON","JSON","XML","LYTE"]}),languageSelected:t("string",{default:"HTML"}),sanitizer:t("object",{default:{}}),fromList:t(i,{default:a}),isFont:t(i,{default:a}),isUrl:t(i,{default:a}),url:t(e,{default:""}),imageError:t(i,{default:a}),disabled:t(i,{default:!0}),loaded:t(i,{default:a}),renderUrl:t(i,{default:a}),fitToScreen:t(i,{default:!0}),small:t(i,{default:a}),actualSize:t(i,{default:a}),maintainAspectRatio:t(i,{default:a}),showPreview:t(i,{default:a}),wrapImage:t(i,{default:a})}},init_fn:function(t){var e=this.data.item;this.setData("isFont","colorpicker"==e.type&&"color"==e.name),t||"colorpicker"!=e.type||null!=e.usedColorsList||Lyte.objectUtils(e,"add","usedColorsList",[])}.observes("item.type","item").on("init"),obs:function(t){var e=this.data.item,i=_lyteUiUtils.capitalize,a="lyteEditorTextFormatIcons lyteEditor"+i(e.name)+"Icon",o=e.type;e.active&&(a+=" "+(e.activeClass||this.data.activeClass)),e.disabled&&(a+=" lyteEditorPanelIconDisabled"),e.class&&(a+=" "+e.class),o&&(a+=" lyte"+i(o)+"Icon"),this.$node.setAttribute("class",a),e.active&&e.prevent_true?this.$node.setAttribute("tabindex",-1):this.$node.setAttribute("tabindex",this.data.ltPropTabindex),t||$L(this.$node).attr(e.attr||{})}.observes("active","item.type","item.disabled").on("didConnect"),url_obs:function(t){this.data.cpShow&&this.alignModal(),t.newValue&&this.setData("renderUrl",!0),this.setData({url:"",fitToScreen:!0})}.observes("isUrl"),displayTypeObs:function(t){if(this.data.item.advancedOptions&&this.data.url&&this.data.loaded){let e=this._imagePop.querySelector(".lyteEditorPreviewImage"),i="",a="";"actualSize"==t.item&&t.newValue&&(i=e.naturalWidth,a=e.naturalHeight);let o=this._imagePop.querySelector(".lyteEditorPanelImageWidthInput").querySelector("lyte-number"),n=this._imagePop.querySelector(".lyteEditorPanelImageHeightInput").querySelector("lyte-number");o.ltProp("value",i),n.ltProp("value",a)}}.observes("actualSize"),alignModal:function(){this.$node.querySelector("lyte-modal").alignModal()},init:function(){this.data.editorOrigin="#"+this.data.editorId+" .lyteEditor"+_lyteUiUtils.capitalize(this.data.item.name)+"Icon"},cp_obs:function(t){$L(this.$node)[t.newValue?"addClass":"removeClass"]("lyteEditor"+("colorpicker"==this.data.item.type?"Colorpicker":"imageModal")+"Opened")}.observes("cpShow"),disabled_obs:function(t){var e=this.data,i=t.oldValue;"url"==t.item&&i&&URL.revokeObjectURL(i),!this.data.url&&!this.data.loaded&&this.resetAdvancedOptions(),this.setData("disabled",!(e.loaded&&e.url))}.observes("loaded","url"),sel_obs:function(t){if("colorpicker"==this.data.item.type){var e=t.newValue,i=this.$node.getElementsByTagName("lyte-colorpicker")[0],a=""!=e?/rgb/i.test(e)?{rgb:e}:{hex:e}:{};i.selectColor?i.selectColor(/rgba/i.test(e)?{rgba:e}:/rgb/i.test(e)?{rgb:e}:{hex:e}):i.component.setData("ltPropSelectedColor",a)}}.observes("item.selected"),drop:function(t){t.preventDefault();let e=t.dataTransfer.files,i=["image/png","image/jpeg","image/jpg","image/gif","image/bmp"];for(let t=0;t<e.length;t++){let a=e[t];-1!=i.indexOf(a.type)&&(this.setData("url",URL.createObjectURL(a)),this.setData("imageError",!1))}},preventDefaults:function(t){t.preventDefault(),t.stopPropagation()},resetAdvancedOptions:function(){this.data.item.advancedOptions&&this.data.ltPropImageOptions.forEach((function(t){t.subItems.forEach((function(t){switch(t.purpose){case"height":case"width":Lyte.objectUtils(t,"add","value",""),Lyte.objectUtils(t,"add","unit","px");break;case"align":Lyte.objectUtils(t,"add","selected",{});break;default:Lyte.objectUtils(t,"add","value","")}}))})),this.setData("wrapImage",!1)},methods:{throw:function(){this.throwEvent.apply(this,arguments)},emojiClose:function(t,e){let i="onBeforeEmojiClose";if(this.getMethods(i))return this.executeMethod(i,t,e)},popoverOpen:function(t){let e=this._imagePop=this._imagePop||$L(t.childComp).find(".lyteEditorImageModal").get(0).children[0];this._preventDefault=this.preventDefaults.bind(this),["dragenter","dragover","dragleave"].forEach((t=>{e.addEventListener(t,this._preventDefault,!1)})),this._drop=this.drop.bind(this),e.addEventListener("drop",this._drop,!1)},popoverClose:function(){["dragenter","dragover","dragleave"].forEach((t=>{this._imagePop.removeEventListener(t,this._preventDefault,!1)})),this._imagePop.removeEventListener("drop",this._drop,!1)},changeunit:function(t,e,i,a){let o=i.$node.parentElement.parentElement;$L(o).find("lyte-number");$L(o).find(".lyteEditorPanelImageWidthInput").find("lyte-number").get(0).ltProp("label",e),$L(o).find(".lyteEditorPanelImageHeightInput").find("lyte-number").get(0).ltProp("label",e)},numberValueChange:function(t,e,i){if(!e.newValue&&0!==e.newValue||!this.data.maintainAspectRatio)return;let a=this._image=this._image||this._imagePop.querySelector(".lyteEditorPreviewImage"),o=i.parentElement.parentElement,n=a.naturalWidth,r=a.naturalHeight,s=0,l=0,d=a.margin||0;if(this.data.actualSize)s=n,l=r;else if(this.data.small)s=200,l=r/n*s;else{let t={};this.throwEvent("getCurrentParaClient",t),t=t.client,s=t.width-d,l=r/n*100-d}let c,p=s/l;"width"==t?(c=o.querySelector(".lyteEditorPanelImageHeightInput").getElementsByTagName("lyte-number")[0],c.ltProp("value",e.newValue/p)):"height"==t&&(c=o.querySelector(".lyteEditorPanelImageWidthInput").getElementsByTagName("lyte-number")[0],c.ltProp("value",e.newValue*p))},alignChange:function(t,e){this.data.wrapImage?"left"!=e.value&&"right"!=e.value&&this.setData("wrapImage",!1):"left"!=e.value&&"right"!=e.value||this.setData("wrapImage",!0)}},actions:{keydown:function(t){"Enter"==t.key&&t.target==this.$node&&("dropdown"==this.data.item.type?setTimeout(function(){this.$node.getElementsByTagName("lyte-dropdown")[0].open()}.bind(this)):this.$node.click(),t.preventDefault())},removeImg:function(){this.setData("url","")},change:function(t){let e,i=URL.createObjectURL(t.files[0]);this.getMethods("onBeforeImageUpload")&&(e=this.executeMethod("onBeforeImageUpload",i,t,this.$node));let a=function(){this.setData("url",i),t.value="",this._image=void 0}.bind(this);e&&e.then?e.then(a):!1!==e&&a()},openfile:function(t){t.previousElementSibling.click()},reset:function(){return this.throwEvent("colorPickerSelect",this.data.item,0,{},this.$node.querySelector("lyte-colorpicker").component),Lyte.objectUtils(this.data.item,"add","selectedColor",this.data.item.selected),!1},imageLoad:function(t){this.setData({imageError:!t,loaded:t}),this.alignModal()},insert:function(t){var e=this.data,i=(e.url,e.isUrl,!1);if(t){var a,o,n,r,s,l,d,c,p,h=t.closest(".lyteEditorImageModal").querySelector("img"),u=h.naturalWidth,m=h.naturalHeight,f=document.getElementById(this.data.editorId).parentNode.component.getThis().getData("ltPropImageStyle").margin||"0px",g="";e.actualSize?(o=u,n=m,p="actualSize"):e.small?(n=m/u*(o=200),p="small"):(o="calc( 100% - "+f+" - "+f+" )",n="calc( "+m/u*100+"% - "+f+" - "+f+" )",p="fitToScreen"),this.data.ltPropImageOptions.forEach((function(t){t.subItems.forEach((function(t){switch(t.purpose){case"alt":g=t.value;break;case"height":null!=t.value&&""!=t.value&&(n=t.value+t.unit,p="custom");break;case"width":null!=t.value&&""!=t.value&&(o=t.value+t.unit,p="custom");break;case"align":t.selected.value&&("left"==t.selected.value||"right"==t.selected.value?s=t.selected.value:r=t.selected.value);break;case"horizontal":t&&(l=t.value);break;case"vertical":t&&(d=t.value);break;case"border":t&&(border=t.value)}}))}));try{a=_lyteUiEditor.copy_image(h,"",u,m)}catch(t){a=h.src}m==parseInt(n)&&u==parseInt(o)&&(p="actualSize"),this.data.wrapImage&&(s||r||(s="left")),c="' style='"+(s?"float:"+s+";":"")+(border?"border:"+border+"px solid black;":"")+(r?"vertical-align:"+r+";":"")+(l?"margin-left:"+l+"px;margin-right:"+l+"px;":"")+(d?"margin-top:"+d+"px;margin-bottom:"+d+"px;":"")+"' ",this.throwEvent("insertImage","<img src='"+a+"' alt='"+g+"' display-type='"+p+"' height='"+n+"' width='"+o+("' style='"!=c?""+c:"")+"' >",this._imgElm,this.data.wrapImage)}this.setData({cpShow:i,isUrl:i,loaded:i,url:"",fitToScreen:!0}),this._imgElm=void 0,this.resetAdvancedOptions()},insertCode:function(t){if(t){var e=$L($L(this.$node).find("lyte-modal")[0].component.childComp).find("textarea")[0].value;this.throwEvent("insertCodeText",e,this.data.languageSelected),this.setData({cpShow:!1})}else this.setData({cpShow:!1})},insertHTML:function(t){t&&this.throwEvent("insertHTML",this.data.ltPropPreviewContent),this.setData("cpShow",!1)},showPreview:function(t){this.setData("ltPropPreviewContent",t.previousElementSibling.value),this.setData("showPreview",!0)},hidePreview:function(t){let e=t.parentElement.nextElementSibling;this.setData("ltPropPreviewContent",$L(e).find(".lyteEditorInsertHTMLPreview").get(0).innerHTML),this.setData("showPreview",!1)}}}),Lyte.Component.registerHelper("setImageModalClass",(function(t){return(this.component.data.item.advancedOptions?"lyteEditorInsertImgModalWrap":"")+" lyteEditorImageModal "+this.component.getData("ltPropWrapperClass")})),Lyte.Component.register("lyte-editorpanel",{_template:'<template tag-name="lyte-editorpanel"> <div class="lyteEditorIconsDiv" id="{{editorId}}"> <template is="if" value="{{isGrouped}}"><template case="true"> <template is="for" items="{{renderingOptions}}" item="sub" index="subIndex"> <div class="LyteEditorFormatSection {{sub.class}}" index="{{subIndex}}"> <template is="for" items="{{sub.subIcons}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" active="{{item.active}}" onclick="{{action(\'iconClick\',item,event)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" sanitizer="{{sanitizer}}" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-wrapper-class="{{ltPropWrapperClass}}" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template></div></template>  </template><template case="false"> <template is="for" items="{{renderingOptions}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" index="{{index}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" active="{{item.active}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" onclick="{{action(\'iconClick\',item,event)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" sanitizer="{{sanitizer}}" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-wrapper-class="{{ltPropWrapperClass}}" lt-prop-freeze="{{ltPropFreeze}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template></template></template> <span class="lyteEditorMoreOptions {{extraIconClass}} {{if(moreOptionsShow,\'lyteEditorMoreOptionsOpened\',\'\')}}" lt-prop-title="{{ltPropMoreOptions}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" onclick="{{action(\'showmore\',event)}}" onkeydown="{{action(\'showmore\',event)}}" tabindex="{{ltPropTabindex}}"></span> <template is="if" value="{{renderExtraIcon}}"><template case="true"> <lyte-popover class="moreOptionsPopover" lt-prop-focus-on-close="true" lt-prop-wrapper-class="lyteEditorPanelMoreOptionPopover {{ltPropMoreOptionsWrapperClass}} {{ltPropWrapperClass}}" lt-prop-show="{{lbind(moreOptionsShow)}}" lt-prop-origin-elem="#{{editorId}} .lyteEditorMoreOptions" lt-prop-force-scroll="{{ltPropForcePopScroll}}" lt-prop="{{ltPropMoreOptionsPopover}}" on-before-close="{{method(\'moreBeforeClose\')}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="popover"> <div class="lyteEditorIconsDiv {{if(isSelected,\'lyteEditorTextSelected\',\'\')}}" id="{{editorId}}"> <template is="if" value="{{isGrouped}}"><template case="true"> <template is="for" items="{{extraOptions}}" item="sub" index="subIndex"> <div class="LyteEditorFormatSection {{item.class}}"> <template is="for" items="{{sub.subIcons}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" active="{{item.active}}" onclick="{{action(\'iconClick\',item,event)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" sanitizer="{{sanitizer}}" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-wrapper-class="{{ltPropWrapperClass}}" lt-prop-freeze="{{ltPropFreeze}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template></div></template>  </template><template case="false"> <template is="for" items="{{extraOptions}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" active="{{item.active}}" onclick="{{action(\'iconClick\',item,event)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" sanitizer="{{sanitizer}}" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-wrapper-class="{{ltPropWrapperClass}}" lt-prop-freeze="{{ltPropFreeze}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template></template></template> </div> </template> </lyte-popover> </template></template> </div> <template is="if" value="{{allowListPop}}"><template case="true"> <lyte-popover lt-prop-duration="{{undef}}" lt-prop-wrapper-class="lyteEditorPanelListPopover {{ltPropWrapperClass}}" lt-prop-show="{{lbind(listPopShow)}}" lt-prop-origin-elem=".{{randomId}}" lt-prop-allow-multiple="true" lt-prop="{{ltPropPopover}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="lyteEditorPanelListPopContent {{listPanelClass}}"> <template is="for" items="{{listRendering.list}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" active="{{item.active}}" onclick="{{action(\'listClick\',item,event,listRendering)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" sanitizer="{{sanitizer}}" from-list="true" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-freeze="{{ltPropFreeze}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template> </lyte-popover-content> </template> </lyte-popover> </template></template> <template is="if" value="{{renderTablePop}}"><template case="true"> <lyte-popover class="lyteEditorTablePopover" lt-prop-duration="{{undef}}" lt-prop-wrapper-class="lyteEditorPanelTableInsertPopover {{ltPropWrapperClass}}" lt-prop-show="{{lbind(tableShow)}}" lt-prop-origin-elem="#{{editorId}} .lyteTableIcon" lt-prop-allow-multiple="true" lt-prop="{{ltPropPopover}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-header class="">{{lyteUiEditorI18n("Insert Table")}}</lyte-popover-header> <lyte-popover-content> <div class="{{if(tableSelect,\'lyteEditorHide\',\'\')}}"> <div class="lyteEditorTableSelectWrapper"> <template is="for" items="{{tableData}}" item="row" index="row_index"> <div class="lyteEditorRow"> <template is="for" items="{{row}}" item="col" index="col_index"> <span class="{{col.class}}" onclick="{{action(\'table_click\',row_index,col_index)}}" onmouseenter="{{action(\'table_enter\',row_index,col_index)}}"></span> </template> </div> </template> </div> <div class="lyteEditorPanelTableSelected">{{rowCount}} * {{colCount}}</div> <div class="lyteEditorPanelTableCustomSwitch" onclick="{{action(\'columnSwitch\')}}">Show more options</div> </div> <div class="lyteEditorPanelTableInsertCustom {{if(tableSelect,\'\',\'lyteEditorHide\')}}"> <div class="lyteEditorTableOptionsWrap"> <template is="for" items="{{ltPropTableOptions}}" item="item" index="index"> <div class="lyteEditorTableOptions {{item.hidden}}"> <template is="switch" value="{{item.type}}"><template case="number"> <lyte-number lt-prop-min="{{item.min}}" lt-prop-max="{{item.max}}" lt-prop-label="{{item.label}}" lt-prop-placeholder="{{item.placeholder}}" lt-prop-value="{{lbind(item.value)}}" class="{{item.class}}"></lyte-number> <template is="if" value="{{item.subtype}}"><template case="true"> <lyte-dropdown class="{{item.subtype.class}}" lt-prop-selected="{{lbind(item.subtype.value)}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="lyteEditorTableDropbox {{ltPropWrapperClass}}"> <lyte-drop-body> <template is="for" items="{{item.subtype.options}}" item="inneritem" index="index"> <lyte-drop-item class="{{inneritem.class}}" data-value="{{inneritem.system}}">{{inneritem.display}}</lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template></template></template><template case="dropdown"><template is="if" value="{{item.label}}"><template case="true"> <div class="lyteEditorTableDropdownLabel">{{item.label}}</div> </template></template> <lyte-dropdown class="{{item.class}}" lt-prop-selected="{{lbind(item.value)}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="lyteEditorTableDropbox {{ltPropWrapperClass}}"> <lyte-drop-body> <template is="for" items="{{item.options}}" item="inneritem" index="index"> <lyte-drop-item class="{{inneritem.class}}" data-value="{{inneritem.system}}">{{inneritem.display}}</lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template></template> </div> </template> </div> <div class="lyteEditorPanelTableButtons"> <lyte-button class="lyteEditorPanelTableCancelBtn" onclick="{{action(\'table_cancel\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Cancel")}} </template> </lyte-button> <lyte-button lt-prop-appearance="primary" onclick="{{action(\'table_click\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Apply")}} </template> </lyte-button> </div> </div> </lyte-popover-content> </template> </lyte-popover> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]}]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]}]}},default:{}},{type:"attr",position:[1,3]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]}]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]}]}},default:{}}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"attr",position:[3,1,1,1]},{type:"for",position:[3,1,1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]}]}]},{type:"text",position:[3,1,3,0]},{type:"text",position:[3,1,3,2]},{type:"attr",position:[3,1,5]},{type:"attr",position:[3,3]},{type:"attr",position:[3,3,1,1]},{type:"for",position:[3,3,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"switch",position:[1,1],cases:{number:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},dropdown:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[2]},{type:"registerYield",position:[2,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[2]}]}},default:{}}]},{type:"attr",position:[3,3,3,1]},{type:"registerYield",position:[3,3,3,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3,3,3,1]},{type:"attr",position:[3,3,3,3]},{type:"registerYield",position:[3,3,3,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3,3,3,3]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1]}]}},default:{}}],_observedAttributes:["ltPropIcons","ltPropEditor","ltPropActiveClass","ltPropTooltipConfig","ltPropTooltipClass","ltPropMoreOptions","ltPropMoreIcon","ltPropDropdown","ltPropPopover","ltPropColorPicker","ltPropMoreOptionsPopover","ltPropMoreOptionsWrapperClass","ltPropSortable","ltPropSortableOptions","ltPropTableOptions","ltPropTabindex","ltPropForcePopScroll","ltPropWrapperClass","ltPropFreeze","ltPropEmojiAsWord","ltPropImageAdvancedOptions","ltPropShowWrapImage","renderingOptions","extraOptions","renderExtraIcon","extraIconClass","moreOptionsShow","isSelected","listRendering","isGrouped","listPopShow","allowListPop","listPanelClass","undef","randomId","editorId","sanitizer","renderTablePop","tableSelect","tableShow","tableData","rowCount","colCount"],data:function(){return{ltPropIcons:Lyte.attr("array",{default:JSON.parse(JSON.stringify(_lyteUiEditor.icons))}),ltPropEditor:Lyte.attr("string",{default:""}),ltPropActiveClass:Lyte.attr("string",{default:"lyteEditorTextFormatSelected"}),ltPropTooltipConfig:Lyte.attr("string",{default:'{"position" : "bottom", "showdelay" : 500}'}),ltPropTooltipClass:Lyte.attr("string",{default:"lyteEditorPanelTooltip"}),ltPropMoreOptions:Lyte.attr("string",{default:_lyteUiEditor.i18n("More options")}),ltPropMoreIcon:Lyte.attr("boolean",{default:!0}),ltPropDropdown:Lyte.attr("string",{default:"{}"}),ltPropPopover:Lyte.attr("string",{default:'{"showCloseButton" : false, "headerPadding" : "", "contentPadding" : "", "footerPadding": "", "scrollable" : true, "focusOnClose" : false }'}),ltPropColorPicker:Lyte.attr("string",{default:"{}"}),ltPropMoreOptionsPopover:Lyte.attr("string",{default:'{"duration":"","allowMultiple":true,"showCloseButton":false,"placement":"topLeft top bottom","type":"callout","scrollable":true}'}),ltPropMoreOptionsWrapperClass:Lyte.attr("string",{default:""}),ltPropSortable:Lyte.attr("boolean",{default:!1}),ltPropSortableOptions:Lyte.attr("object",{default:{}}),ltPropTableOptions:Lyte.attr("array",{default:[{type:"number",purpose:"row",min:1,max:10,label:_lyteUiEditor.i18n("Rows"),placeholder:_lyteUiEditor.i18n("{{0}} to {{1}}",1,10),defaultValue:2,value:2,class:"lyteEditorPanelTableRowInput",render:!0},{type:"number",purpose:"column",min:1,max:10,label:_lyteUiEditor.i18n("Columns"),placeholder:_lyteUiEditor.i18n("{{0}} to {{1}}",1,10),defaultValue:2,value:2,class:"lyteEditorPanelTableColumnInput",render:!0},{type:"number",purpose:"width",min:1,max:1/0,label:_lyteUiEditor.i18n("Width"),placeholder:"0 to 100",defaultValue:100,value:100,class:"lyteEditorPanelTableWidthInput",subtype:{type:"dropdown",options:[{system:"%",display:"%"},{system:"px",display:"px"}],value:"%",defaultValue:"%",class:"lyteEditorPanelTableUnitDropdown"}},{type:"number",purpose:"height",min:1,max:1/0,label:_lyteUiEditor.i18n("Height"),placeholder:"0 to 100",defaultValue:100,value:100,class:"lyteEditorPanelTableHeightInput",subtype:{type:"dropdown",options:[{system:"%",display:"%"},{system:"px",display:"px"}],value:"%",defaultValue:"%",class:"lyteEditorPanelTableUnitDropdown"}},{type:"number",purpose:"borderWidth",min:0,max:20,label:_lyteUiEditor.i18n("Border Size"),placeholder:"0 to 20",defaultValue:1,value:1,class:"lyteEditorPanelTableBorderSizeInput"},{type:"dropdown",purpose:"alignment",value:"none",defaultValue:"none",label:_lyteUiEditor.i18n("Align"),options:[{system:"none",display:_lyteUiEditor.i18n("None")},{system:"left",display:_lyteUiEditor.i18n("Left")},{system:"right",display:_lyteUiEditor.i18n("Right")},{system:"center",display:_lyteUiEditor.i18n("Center")}]}]}),ltPropTabindex:Lyte.attr("string",{default:"-1"}),ltPropForcePopScroll:Lyte.attr("boolean",{default:!1}),ltPropWrapperClass:Lyte.attr("string",{default:""}),ltPropFreeze:Lyte.attr("boolean",{default:!1}),ltPropEmojiAsWord:Lyte.attr("boolean",{default:!1}),ltPropImageAdvancedOptions:Lyte.attr("array",{default:[{label:"Alternate Text",class:"lyteEditorPanelImageAltInput",subItems:[{prop:{placeholder:"Enter alternate text for image",appearance:"box"},type:"input",purpose:"alt",value:""}]},{label:"Transform",class:"lyteEditorPanelImageTransformGroup",subItems:[{label:"Width",type:"number",purpose:"width",unit:"px",class:"lyteEditorPanelImageWidthInput",prop:{placeholder:""}},{label:"Height",type:"number",purpose:"height",class:"lyteEditorPanelImageHeightInput",unit:"px",prop:{placeholder:""}},{type:"dropdown",purpose:"unit",prop:{},userValue:"name",systemValue:"value",options:[{name:"px",value:"px"},{name:"%",value:"%"}]},{label:"Keep aspect ratio",class:"lyteEditorPanelImageAspectRatio",type:"checkBox",purpose:"maintainAspectRatio",prop:{type:"primary",name:"maintainAspectRatio",value:"maintainAspectRatio"}},{label:"Horizontal",type:"number",purpose:"horizontal",unit:"px",prop:{placeholder:""}},{label:"Vertical",type:"number",purpose:"vertical",unit:"px",prop:{placeholder:""}},{label:"Border",type:"number",purpose:"border",unit:"px",prop:{placeholder:""}}]},{label:"Alignment",class:"lyteEditorPanelImageAlignGroup",subItems:[{type:"radioButtonGroup",prop:{name:"group"},purpose:"align",userValue:"name",systemValue:"value",selected:{},options:[{name:"Left",value:"left"},{name:"Right",value:"right"},{name:"Center",value:"middle"},{name:"Top",value:"top"},{name:"Bottom",value:"bottom"}]}]}]}),ltPropShowWrapImage:Lyte.attr("boolean",{default:!1}),renderingOptions:Lyte.attr("array",{default:[]}),extraOptions:Lyte.attr("array",{default:[]}),renderExtraIcon:Lyte.attr("boolean",{default:!1}),extraIconClass:Lyte.attr("string",{default:""}),moreOptionsShow:Lyte.attr("boolean",{default:!1}),isSelected:Lyte.attr("boolean",{default:!1}),listRendering:Lyte.attr("object",{default:{}}),isGrouped:Lyte.attr("boolean",{default:!1}),listPopShow:Lyte.attr("boolean",{default:!1}),allowListPop:Lyte.attr("boolean",{default:!1}),listPanelClass:Lyte.attr("string",{default:""}),undef:Lyte.attr("string",{default:void 0}),randomId:Lyte.attr("string",{default:""}),editorId:Lyte.attr("string",{default:"lyteEditorPanel"+parseInt(1e5*Math.random())}),sanitizer:Lyte.attr("object",{default:{attr:Lyte.Security.createSanitizer({GLOBAL_TAGS:["mention_div"],GLOBAL_ATTRIBUTES:["editable","module","editor-language"],ADD_URI_SAFE_ATTR:["style"],ALLOWED_STYLE:"ALL",STYLE_VALIDATION:!1})}}),renderTablePop:Lyte.attr("boolean",{default:!1}),tableSelect:Lyte.attr("boolean",{default:!1}),tableShow:Lyte.attr("boolean",{default:!1}),tableData:Lyte.attr("array",{default:[]}),rowCount:Lyte.attr("number"),colCount:Lyte.attr("number")}},didConnect:function(){var t=this,e=t.data,i="afterRender",a=t.$node;(t.editor=$L(e.ltPropEditor).get(0)).panel=t,a.refresh=function(){this.updateIconBarRange();var t=this.getThis().data;this.undoRedo(t.undoqueue,t.redoqueue)}.bind(t),e.ltPropMoreIcon?(a.checkWidth=t.check_availability.bind(t),t.check_availability()):(t.setData({renderingOptions:e.ltPropIcons,extraIconClass:"lyteEditorpanelHide"}),e.ltPropSortable&&t.bind_sort()),t.getMethods(i)&&t.executeMethod(i,a),window.requestAnimationFrame(function(){!this.__called&&a.refresh()}.bind(this))},bind_sort:function(){var t,e=this,i=e.data,a=i.isGrouped,o={},n=$L(e.$node).children(".lyteEditorIconsDiv"),r=Lyte.arrayUtils,s=function(t,i,a){var o=r(a||t,"removeAt",i[3]),n="onSortDrop",s=i[4],l=i[1];r(t,"insertAt",s,o),l.addToSortable(l.children[s]),e.getMethods(n)&&((i=Array.from(i)).unshift(n),e.executeMethod.apply(e,i))},l=i.ltPropIcons;a?(n=n.children(".LyteEditorFormatSection"),t=function(t,e){var i=arguments;s(l[e.getAttribute("index")].subIcons,i,l[i[5].getAttribute("index")].subIcons)}):(o.restrict=".lyteEditorMoreOptions,lyte-popover",t=function(){s(l,arguments)}),o.onDrop=t.bind(this),o.onBeforeDrop=function(){var t="onBeforeSortDrop";if(e.getMethods(t)){var i=Array.from(arguments);return i.unshift(t),e.executeMethod.apply(e,i)}},n.sortable($L.extend(o,i.ltPropSortableOptions))},remove_sort:function(){var t=$L(this.$node).children(".lyteEditorIconsDiv");this.data.isGrouped&&(t=t.children(".LyteEditorFormatSection")),t.sortable("destroy")},__bind_sort:function(t){t.newValue?this.bind_sort():this.remove_sort()}.observes("ltPropSortable"),check_availability:function(t){var e=this;e.setData("moreOptionsShow",!1),clearTimeout(e._rendertime),e._rendertime=setTimeout((function(){var t=e.data.ltPropIcons,i=$L.fastdom,a="renderingOptions",o=0,n=Array.from(e.$node.children).filter((function(t){return $L(t).hasClass("lyteEditorIconsDiv")}))[0],r="extraIconClass";e.setData(a,t),e.setData(r,""),i.clear(e._fdm),e._fdm=i.measure((function(){var s=0,l=function(t){var e=t.offsetWidth,i=window.getComputedStyle(t),a=parseFloat(i.marginLeft)+parseFloat(i.marginRight);return o+=a+e},d=n.getElementsByClassName("lyteEditorMoreOptions")[0],c=e.$node.offsetWidth-l(d);o=0,t.every((function(t,e){var i=n.children[e];return!(l(i)>c)&&(s=++e,!0)})),i.mutate((function(){e.setData(a,t.slice(0,s));var i=t.slice(s),o="";i.length?(e.setData("extraOptions",i),e.setData("renderExtraIcon",!0)):o="lyteEditorpanelHide",e.setData(r,o),e.data.ltPropSortable&&e.bind_sort()}))}))}),0)},listObs:function(){var t=this.data.ltPropIcons,e=!1,i=t[0]||{};this.setData("isGrouped",!!i.subIcons),t.every((function(t){return(t.subIcons||[t]).every((function(t){return!(e="list"==t.type)})),!e})),this.setData("allowListPop",e)}.observes("ltPropIcons").on("init"),initObs:function(){this.getMethods("beforeRender")&&this.executeMethod("beforeRender",this.$node)}.on("init"),didDestroy:function(){delete this.editor.panel,delete this.editor,$L.fastdom.clear(this._fdm),clearTimeout(this._rendertime)},callBeforeClick:function(t,e,i){if(this.getMethods("onBeforeClick"))return 0==this.executeMethod("onBeforeClick",t,e,i,this.$none)},callClick:function(t,e,i){if(this.getMethods("onClick"))return this.executeMethod("onClick",t,e,i,this.$node)},processArg:function(t){var e=$L.extend(!0,[],t.arguments||[]),i=t.selected||"",a=t.removeClass;if(null!=i){var o=e.indexOf("{{selected}}");o+1&&(/^([0-9]+)$/.test(i)&&(i=parseInt(i)),e.splice(o,1,i))}return a&&(e[3]=a),e},callFn:function(t){var e=this.getThis();return e[t.functionName].apply(e,this.processArg(t))||{applied:[],toApply:[]}},clickAction:function(t,e,i){if(this.callBeforeClick(t,e,i))return!1;var a=this.getThis(),o=!0,n=this,r=window;if(!a.isCodeEditor($L(a.data.currentNode.parentElement).data("data")))switch(t.type){case"switch":case"undo":if(t.active&&/^(undo|redo|clear)$/i.test(t.name))return;this.callFn(t);break;case"colorpicker":this.colorpicker(e.target);break;case"anchor":if(t.active)return;this.anchorIconClick.call(a,e.target),o=!1;break;case"list":var s=this.data.randomId,l=$L(e.target).closest(".lyteEditorTextFormatIcons",this.$none);if(s||this.setData("randomId",s=this.getThis().randomId()),l.hasClass(s))return void this.setData("listPopShow",!0);$L("."+s).removeClass(s),l.addClass(s),this.setData("listPanelClass",t.name?"lyteList"+t.name+"IconsWrap":""),window.requestAnimationFrame((function(){r.requestAnimationFrame((function(){n.setData("listRendering",t),n.setData("listPopShow",!0)}))}));break;case"emoji":Lyte.objectUtils(t,"add","active",!0);break;case"table":this.table_click(t);break;case"image":this.colorpicker(e.target,"lyte-modal");break;case"codeEditor":$L(e.target).find("lyte-modal").get(0).ltProp("show",!0);break;case"insertHTML":e.target.ltProp("previewContent",a.$node.getHTML(!0,!0)),$L(e.target).find("lyte-modal").get(0).ltProp("show",!0)}o&&a.$node.focus(),this.callClick(t,e,i)},table_render_obs:function(){var t,e,i=[];this.data.ltPropTableOptions.forEach((function(i){var a=i.purpose;/row/i.test(a)?t=i.max:/column/i.test(a)&&(e=i.max)}));for(var a=0;a<t;a++){for(var o=[],n=0;n<e;n++)o.push({class:""});i.push(o)}this.setData("tableData",i),this.modify_selection()}.observes("renderTablePop"),modify_selection:function(){var t=this.data,e=t.tableData,i=t.rowCount,a=t.colCount,o=Lyte.objectUtils;e.forEach((function(t,e){t.forEach((function(t,n){var r="lyteEditorColumn";e<i&&n<a&&(r+=" lyteEditorCellSelected"),o(t,"add","class",r)}))}))},table_click:function(t){this.setData("renderTablePop",!0),this.setData("tableShow",!0)},list_obs:function(t){var e="removeClass",i=t.newValue;i&&(e="addClass"),$L("."+this.data.randomId)[e]("lyteEditorPanelListPopOpened"),this["call_"+(i?"show":"hide")]()}.observes("listPopShow"),close_all_pop:function(){this.data.extraOptions.forEach((function(t){t&&t.subIcons.forEach((function(t){"emoji"==t.name&&Lyte.objectUtils(t,"add","active",!1)}))})),this.setData("listPopShow",!1);var t=this.getThis()._popover;t&&t.ltProp("show",!1)},methods:{moreBeforeClose:function(t){$L((t||{}).target).hasClass("lyteEditorMoreOptions")&&(this._ignore_click=!0),this.close_all_pop()},emojiClose:function(t,e){let i="onBeforeEmojiClose";if(this.getMethods(i))return this.executeMethod(i,t,e)},onBeforeImageUpload:function(){}},count_obs:function(){clearTimeout(this.__rowobs),this.__rowobs=setTimeout(function(){this.modify_selection()}.bind(this),0)}.observes("rowCount","colCount"),tableShow_obs:function(t){var e="call_show";t.newValue||(this.reset_table(),this.setData("tableSelect",!1),e="call_hide"),this[e]()}.observes("tableShow"),call_show:function(t){var e="onShow",i=this.getThis();t||i.setData("isPanelOpen",!0),this.getMethods(e)&&this.executeMethod(e,this.$node)},call_hide:function(t){var e="onHide",i=this.getThis();t||i.setData("isPanelOpen",!1),this.data.moreOptionsShow||this.getMethods(e)&&this.executeMethod(e,this.$node)},more_obs:function(t){this["call_"+(t.newValue?"show":"hide")](!0)}.observes("moreOptionsShow"),select_color:function(t,e,i){var a,o=this.getThis();i||(e.hex=o.data.ltPropWordStyle[t.arguments[0]]),e.nofill&&(e.hex=o.data.ltPropWordStyle[t.arguments[0]]||"#FFFFFF"),a=e.nofill?e.hex?this.getRequiredColorFormat(e.hex):"unset":e.rgba||(e.hex?this.getRequiredColorFormat(e.hex):"unset"),Lyte.objectUtils(t,"add","selected",a),this.callFn(t),o.$node.focus(),this.callClick(t,i)},getRequiredColorFormat:function(t,e){var i,a,o,n=document.createElement("canvas").getContext("2d");n.fillStyle=t.toLowerCase();var r=n.fillStyle;if(i=parseInt(r.substring(1,3),16),a=parseInt(r.substring(3,5),16),o=parseInt(r.substring(5,7),16),9==r.length){parseInt(r.substring(7,9),16)}return"rgb("+i+","+a+","+o+")"},actions:{elementOpen:function(){this.call_show()},elementBeforeOpen:function(){var t="onBeforeShow";this.getMethods(t)&&this.executeMethod(t,this.$node)},elementClose:function(t,e,i){if(this.call_hide(),i){var a=i.data;a.ltPropBasicColorPicker||this.select_color(t,a.ltPropSelectedColor,e)}},insertImage:function(t,e,i){var a=function(t){let a=this.getThis();a.data.wrapImage=Boolean(i),a.data.ltPropInlineImage&&!e?a.$node.insertHTML(t,!0):e?a.replaceImage(t,e):(this.getThis().$node.insertHTML(t,!0),this.callClick({},{}))}.bind(this);if(this.getMethods("onImageInsert")){var o=this.executeMethod("onImageInsert",this.$node,t);o&&o.then?o.then(function(t){a(t)}.bind(this)):!1!==o&&a(t)}else a(t)},insertCodeText:function(t,e){this.getThis().insertCodeText(t,e)},insertHTML:function(t){this.getThis().$node.insertHTML(t)},getCurrentParaClient:function(t){t.client=this.getThis().getCurrentParaClient()},showmore:function(t){if("keydown"!=t.type||32==t.keyCode||13==t.keyCode){"keydown"==t.type&&t.preventDefault();var e="_ignore_click";this[e]?delete this[e]:this.setData("moreOptionsShow",!0)}},emojiselect:function(t,e){var i=this.getThis().$node;this.data.ltPropEmojiAsWord?i.insertHTML(e.encode):i.insertTextInWord(e.value),Lyte.objectUtils(t,"add","active",!1),i.focus(),this.callClick(t,{})},dropItemSelected:function(t){this.callFn(t),this.getThis().$node.focus(),this.callClick(t,{})},colorPickerSelect:function(t,e,i,a){a.getData("ltPropBasicColorPicker")&&(a.$node.ltProp("show",!1),this.select_color(t,i,e))},iconClick:function(t,e){this.clickAction(t,e)},listClick:function(t,e,i){this.setData("listPopShow",!1),this.clickAction(t,e,i)},table_enter:function(t,e){this.setData({rowCount:t+1,colCount:e+1})},table_click:function(t,e){this.insert_table(t+1,e+1),this.setData("tableShow",!1),this.callClick({},{})},table_cancel:function(){this.setData("tableShow",!1)},columnSwitch:function(){this.reset_table(),this.setData("tableSelect",!0)}},colorpicker:function(t,e){$L(t).find(e||"lyte-colorpicker").get(0).ltProp("show",!0)},anchorIconClick:function(t){var e,i="popOrigin"+this.data.randomId,a="",o=this.data.range.isRange,n=function(){return this.convert_html_to_txt(this.getSelectedText()).replace(/\n/g,"")}.bind(this);if(o)e=n();else{var r=this.data.selectedWords,s=r.filter((function(t){if($L(t.node).data("data").details.anchor)return!0}));s.length>1||r.length>s.length?e="":1==s.length&&(e=n(),a=$L(s[0].node).data("data").details.anchor.href),this.setData("userInput","")}Lyte.objectUtils(this.data.anchorEdit,"add","text",e),Lyte.objectUtils(this.data.anchorEdit,"add","href",a),Lyte.objectUtils(this.data.anchorEdit,"add","newWindow",!0),Lyte.objectUtils(this.data.anchorEdit,"add","mailId",""),Lyte.objectUtils(this.data.anchorEdit,"add","mailSubject",""),Lyte.objectUtils(this.data.anchorEdit,"add","title",""),Lyte.objectUtils(this.data.anchorEdit,"add","telephone",""),this.setData("userInput",e),this.setData("isEditLink",!1),$L("."+i).removeClass(i),$L(t).addClass(i),this._popover.ltProp("show",!0)},activeCheck:function(t){var e=this.callFn(t);return e.applied.length>e.toApply.length},indivUpdate:function(t){if(!t.ignore){var e=t.type||"switch",i=this.getThis();switch(e){case"custom":Lyte.objectUtils(t,"add","active",!!this.callCustomIconUpdate(t));break;case"switch":case"colorpicker":var a=this.activeCheck(t);if(/^colorpicker$/i.test(e))Lyte.objectUtils(t,"add","selected",i.data.currentNode.style[t.arguments[0]]);else if(/^textIndentIncrease$/i.test(t.name)){let e=this.activeCheck(t);Lyte.objectUtils(t,"add","active",e)}else if(/^textIndentDecrease$/i.test(t.name)){let e=this.activeCheck(t);Lyte.objectUtils(t,"add","active",e)}else Lyte.objectUtils(t,"add","active",a);break;case"dropdown":var o,n=t.value,r=(t.selected,t.selected);if(n.every(function(e){return t.selected=e,!e||!this.activeCheck(t)||(o=e,!1)}.bind(this)),t.selected=r,!o&&/^fontSize|lineHeight$/i.test(t.name)){var s,l="";if("fontSize"==t.name){var d=i.getProp("fontSize",i.data.currentNode),c=this.get_unit(d);l=this.get_unit(t.value[0]||""),h=this.convert_to_unit(c,l,d),s=i.getIndex(t.value,h+l)}else if("lineHeight"==t.name){var p=i.data.currentNode.parentNode,h=i.getProp("lineHeight",p);if(/px$/i.test(h)){var u=i.getProp("fontSize",p);h=parseFloat(h)/parseFloat(u),l="px"}s=i.getIndex(t.value,h+l)}o=h+l,this.remove_fake(t,h),-1==s&&this.push_extra_value(t,h,l)}Lyte.objectUtils(t,"add","selected",o||""),Lyte.objectUtils(t,"add","active",!!o);break;case"list":var m=t.list,f=!1;m.forEach(function(t){this.indivUpdate(t),f=f||t.active}.bind(this)),Lyte.objectUtils(t,"add","active",f);break;case"anchor":var g=i.data.selectedWords,y=!1;if(i.data.ltPropDisableAnchorInMentions)for(let t=0;t<g.length;t++)if(g[t].node.classList.contains("lyteEditorMentionWord")){y=!0;break}Lyte.objectUtils(t,"add","active",1==g.length&&$L(g[0].node).hasClass("lyteEditorAnchor")||y)}}},remove_fake:function(t,e){for(var i=t.fake||[],a=t.display,o=t.value,n=i.length,r=function(t,e){Lyte.arrayUtils(t,"removeAt",e)},s=0;s<n;s++){var l=i[s];if(l!=e){var d=a.indexOf(l);r(o,d),r(a,d),i.splice(s--,1),n--}}},push_extra_value:function(t,e,i){var a=t.display,o=t.value,n=1,r=t.fake,s=function(t,e){Lyte.arrayUtils(t,"insertAt",n,e)};r||(r=t.fake=[]),-1==r.indexOf(e)&&(a.every((function(t){return Number(t)<e&&n++})),--n,s(o,e+i),s(a,e),r.push(e))},get_unit:function(t){return t.match(/px|pt|cm|mm|in/i)[0]},convert_to_unit:function(t,e,i){var a={px:1,pt:1.3281472327365,in:96,cm:37.795275591,mm:3.7795275591},o=a[e];return a[t]*Number(i.replace(/px|pt|cm|mm|in/,""))/o},updateIconBarRange:function(){this.__called=!0;var t=this.data.ltPropIcons,e=this.getThis(),i=e.data.range;e.iconUpdate(),t.forEach(function(t){(t.subIcons||[t]).forEach(this.indivUpdate.bind(this))}.bind(this)),this.callUpdate(),e.removeIconUpdate(),$L(this.$node)[i.isRange?"addClass":"removeClass"]("lyteEditorTextSelected"),this.setData("isSelected",i.isRange)},callCustomIconUpdate:function(t){if(this.getMethods("onCustomIconUpdate")){var e=this.getThis().data;return this.executeMethod("onCustomIconUpdate",t,this.$node,this.editor,e.currentNode,e.cursor,e.range,e.range.isRange)}},callUpdate:function(){this.getMethods("onIconbarUpdate")&&this.executeMethod("onIconbarUpdate",this.$node,this.editor)},getThis:function(){return this.editor.component},undoRedo:function(t,e){this.data.ltPropIcons.forEach((function(i){(i.subIcons||[i]).forEach((function(i){"undo"==i.type&&Lyte.objectUtils(i,"add","active","undo"==i.name?!t.length:!e.length)}))}))},disableAll:function(t){this.data.ltPropIcons.forEach((function(e){e.subIcons?e.subIcons.forEach((function(e){(t&&e.disabled||!t&&!e.disabled)&&Lyte.objectUtils(e,"add","disabled",!t)})):(t&&e.disabled||!t&&!e.disabled)&&Lyte.objectUtils(e,"add","disabled",!t)}))},reset_table:function(t){(t||this.data.ltPropTableOptions).forEach(function(t){var e=t.subtype;Lyte.objectUtils(t,"add","value",t.defaultValue),e&&this.reset_table([e])}.bind(this)),t&&this.setData({rowCount:0,colCount:0})},insert_table:function(t,e){var i={};this.data.ltPropTableOptions.forEach((function(t){var e=t.subtype,a=t.value;e&&(a+=e.value),i[t.purpose]=a})),this.getThis().table(t,e,i)}}),Lyte.Component.register("lyte-editor-item",{_template:'<template tag-name="lyte-editor-item" onkeydown="{{action(\'keydown\',event)}}"> <template is="switch" value="{{item.type}}"><template case="switch"></template><template case="undo"></template><template case="anchor"></template><template case="list"><template is="if" value="{{item.display}}"><template case="true"><template is="if" value="{{fromList}}"><template case="true"> {{unescape(item.display,undefined,sanitizer.attr)}} </template><template case="false"> {{item.display}} </template></template></template></template></template><template case="dropdown"> <lyte-dropdown lt-prop="{{ltPropDropdown}}" lt-prop-is-open="{{lbind(cpShow)}}" lt-prop-selected="{{lbind(item.selected)}}" on-option-selected="{{method(\'throw\',\'dropItemSelected\',item)}}" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-display-value="{{lbind(item.displayValue)}}" on-show="{{method(\'throw\',\'elementOpen\')}}" on-hide="{{method(\'throw\',\'elementClose\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="editor-dropdown lyteEditorPanelDropdown {{item.class}} {{ltPropWrapperClass}}"> <lyte-drop-body> <template is="for" items="{{item.display}}" item="dropItem" index="index"> <lyte-drop-item class="lyteEditorPanelDropItem" data-value="{{item.value[index]}}" style="--editorPanelDropValue:{{item.value[index]}}"> {{dropItem}} </lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template><template case="colorpicker"> {{item.display}} <lyte-colorpicker lt-prop-yield="{{isFont}}" lt-prop-no-fill-button="{{expHandlers(isFont,\'!\')}}" class="editor-colorpicker lyteEditorPanelColorPicker" lt-prop-origin-element="{{editorOrigin}}" on-select="{{method(\'throw\',\'colorPickerSelect\',item)}}" lt-prop-wrapper-class="{{editorId}}{{item.name}}colorpicker {{ltPropWrapperClass}}" style="display: none;" lt-prop="{{ltPropColorPicker}}" lt-prop-show="{{lbind(cpShow)}}" on-open="{{method(\'throw\',\'elementOpen\')}}" on-before-open="{{method(\'throw\',\'elementBeforeOpen\')}}" on-close="{{method(\'throw\',\'elementClose\',item)}}" lt-prop-popover="{{ltPropPopover}}" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-selected-color="{{lbind(item.selectedColor)}}" lt-prop-used-colors-list="{{lbind(item.usedColorsList)}}"> <template is="registerYield" yield-name="cpyield"> <span class="lyteEditorPanelDefaultColor" onclick="{{action(\'reset\')}}">{{lyteUiEditorI18n("Reset to default color")}}</span> </template> </lyte-colorpicker> <span class="lyteEditorColorIconClass" style="background: {{item.selected}};"></span> </template><template case="emoji"> {{item.display}} <lyte-popover lt-prop-focus-on-close="true" lt-prop-origin-elem="{{editorOrigin}}" lt-prop-show="{{lbind(item.active)}}" class="lyteEditorEmojiPopover" lt-prop-duration="{{undef}}" lt-prop-wrapper-class="lyteEditorEmojiPopoverWrapper {{editorId}}{{item.name}}Popover {{ltPropWrapperClass}}" lt-prop-allow-multiple="true" lt-prop="{{ltPropPopover}}" on-show="{{method(\'throw\',\'elementOpen\')}}" on-before-close="{{method(\'emojiClose\')}}" on-close="{{method(\'throw\',\'elementClose\')}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="popover"> <template is="if" value="{{expHandlers(item.input,\'!=\',undefined)}}"><template case="true"> <lyte-emoji on-emoji-select="{{method(\'throw\',\'emojiselect\',item)}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-no-match-text="{{item.noMatchText}}" lt-prop-input="{{item.input}}"></lyte-emoji> </template><template case="false"> <lyte-emoji on-emoji-select="{{method(\'throw\',\'emojiselect\',item)}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}"></lyte-emoji> </template></template> </template> </lyte-popover> </template><template case="custom"> <lyte-yield yield-name="editor-custom" item="{{item}}"></lyte-yield> </template><template case="image"><template is="if" value="{{item.display}}"><template case="true"> {{item.display}} </template></template> <lyte-modal lt-prop-wrapper-class="{{setImageModalClass()}}" lt-prop-show-close-button="false" lt-prop-show="{{lbind(cpShow)}}" lt-prop-duration="{{undef}}" lt-prop="{{ltPropModal}}" on-show="{{method(\'throw\',\'elementOpen\')}}" on-close="{{method(\'throw\',\'elementClose\')}}" on-before-show="{{method(\'popoverOpen\')}}" on-before-close="{{method(\'popoverClose\')}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header class="lyteEditorImageHeader"> {{lyteUiEditorI18n("Insert Image")}} </lyte-modal-header> <lyte-modal-content class="lyteEditorImageContent"> <div class="lyteEditorInsertImageRadioWrap"> <lyte-radiobutton class="lyteEditorUploadImageRadio" lt-prop-type="primary" lt-prop-name="{{editorId}}" lt-prop-checked="{{expHandlers(isUrl,\'!\')}}" lt-prop-value="image" lt-prop-label="Upload image"></lyte-radiobutton> <lyte-radiobutton lt-prop-type="primary" lt-prop-name="{{editorId}}" lt-prop-checked="{{lbind(isUrl)}}" lt-prop-value="url" lt-prop-label="Upload from Url"></lyte-radiobutton> </div> <div class="lyteEditorImageUpload {{if(isUrl,\'lyteEditorHide\',\'\')}}"> <input class="lyteEditorOriginalImageUpload" type="file" onchange="{{action(\'change\',this)}}" accept="image/jpg,image/png,image/jpeg,image/gif,image/bmp"> <lyte-button onclick="{{action(\'openfile\',this)}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Upload from computer")}} </template> </lyte-button> <template is="if" value="{{url}}"><template case="true"> <div style="position: relative;"> <span class="lyteEditorPreviewImageClose" onclick="{{action(\'removeImg\')}}"></span> <img crossorigin="anonymus" class="lyteEditorPreviewImage" src="{{url}}" onload="{{action(\'imageLoad\',true)}}" onerror="{{action(\'imageLoad\',false)}}"> </div> </template><template case="false"> <div class="lyteEditorInsertImagePlaceholder"> {{lyteUiEditorI18n("Image preview will be shown here.")}} </div> </template></template> </div> <template is="if" value="{{renderUrl}}"><template case="true"> <div class="lyteEditorImageUrl {{if(isUrl,\'\',\'lyteEditorHide\')}}"> <lyte-input class="lyteEditorImageUrlInput" lt-prop-appearance="box" lt-prop-placeholder="Enter valid image URL" lt-prop-value="{{lbind(url)}}" lt-prop-focus="{{isUrl}}"></lyte-input> <template is="if" value="{{imageError}}"><template case="true"> <div class="lyteEditorImageErrorMessage"> {{lyteUiEditorI18n("Error in loading the image. Pls check the URL.")}} </div> </template></template> <template is="if" value="{{expHandlers(url,\'&amp;&amp;\',expHandlers(imageError,\'!\'))}}"><template case="true"> <div class="lyteEditorImagePreview {{if(imageError,\'lyteEditorImageError\',\'\')}}"> <span class="lyteEditorPreviewImageClose" style="position: absolute;right: 5px;top: 5px;width: 15px;height: 15px;display: inline-block;border: 1px solid black" onclick="{{action(\'removeImg\')}}"></span> <img crossorigin="anonymus" class="lyteEditorPreviewImage" src="{{url}}" onload="{{action(\'imageLoad\',true)}}" onerror="{{action(\'imageLoad\',false)}}"> </div> </template><template case="false"> <div class="lyteEditorInsertImagePlaceholder"> {{lyteUiEditorI18n("Image preview will be shown here.")}} </div> </template></template> </div> </template></template> <div class="lyteEditorImageSizeControl"> <lyte-radiobutton lt-prop-checked="{{lbind(fitToScreen)}}" lt-prop-value="fit_to_screen" lt-prop-type="primary" lt-prop-name="image_size _{{editorId}}" lt-prop-label="Fit to screen"></lyte-radiobutton> <lyte-radiobutton lt-prop-checked="{{lbind(small)}}" lt-prop-value="small" lt-prop-type="primary" lt-prop-name="image_size _{{editorId}}" lt-prop-label="small"></lyte-radiobutton> <lyte-radiobutton lt-prop-checked="{{lbind(actualSize)}}" lt-prop-value="actual_size" lt-prop-type="primary" lt-prop-name="image_size _{{editorId}}" lt-prop-label="Actual size"></lyte-radiobutton> </div> <template is="if" value="{{ltPropShowWrapImage}}"><template case="true"> <div class="lyteEditorImageWrapContainer"> <lyte-checkbox lt-prop-name="checkbox" lt-prop-checked="{{lbind(wrapImage)}}" lt-prop-label="{{lyteUiEditorI18n(\'Wrap Image\')}}" lt-prop-value="val" lt-prop-id="checkbox"></lyte-checkbox> </div> </template></template> <template is="if" value="{{expHandlers(item.advancedOptions,\'&amp;&amp;\',expHandlers(url,\'||\',loaded))}}"><template case="true"> <lyte-accordion> <template is="registerYield" yield-name="yield"> <lyte-accordion-item> <lyte-accordion-header>Advanced Options<lyte-icon class="lyteAccordionArrow"></lyte-icon></lyte-accordion-header> <lyte-accordion-body> <template is="for" items="{{ltPropImageOptions}}" item="optionsItem" index="index"> <div class="{{optionsItem.class}}"> <template is="if" value="{{optionsItem.label}}"><template case="true"><div> {{optionsItem.label}} </div></template></template> <template items="{{optionsItem.subItems}}" item="subItem" index="index" is="for"> <template value="{{subItem.type}}" is="switch">      <template case="input"> <div class="{{subItem.class}}"> {{subItem.label}} <lyte-input class="{{subItem.class}}" lt-prop="{{stringify(subItem.prop)}}" lt-prop-value="{{lbind(subItem.value)}}"></lyte-input> </div> </template><template case="number"> <div class="{{subItem.class}}"> {{subItem.label}} <lyte-number lt-prop="{{stringify(subItem.prop)}}" lt-prop-label="{{lbind(subItem.unit)}}" lt-prop-value="{{lbind(subItem.value)}}" on-value-change="{{method(\'numberValueChange\',subItem.purpose)}}"></lyte-number> </div> </template><template case="radioButtonGroup"> <div class="{{subItem.class}}"> {{subItem.label}} <lyte-radiobutton-group lt-prop="{{stringify(subItem.prop)}}" lt-prop-selected="{{lbind(subItem.selected)}}" lt-prop-user-value="{{subItem.userValue}}" lt-prop-system-value="{{subItem.systemValue}}" lt-prop-options="{{subItem.options}}" on-checked="{{method(\'alignChange\')}}"></lyte-radiobutton-group> </div> </template><template case="dropdown"> <div class="{{subItem.class}}"> {{subItem.label}} <lyte-dropdown lt-prop-options="{{subItem.options}}" lt-prop-user-value="{{subItem.userValue}}" lt-prop-system-value="{{subItem.systemValue}}" on-option-selected="{{method(\'changeunit\')}}"></lyte-dropdown> </div> </template><template case="checkBox"> <div class="{{subItem.class}}"> <lyte-checkbox lt-prop="{{stringify(subItem.prop)}}" lt-prop-label="{{subItem.label}}" lt-prop-checked="{{lbind(maintainAspectRatio)}}"></lyte-checkbox> </div> </template></template> </template> </div> </template> </lyte-accordion-body> </lyte-accordion-item> </template> </lyte-accordion> </template></template> </lyte-modal-content> <lyte-modal-footer class="right lyteEditorImageFooter"> <lyte-button onclick="{{action(\'insert\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Cancel")}} </template> </lyte-button> <lyte-button lt-prop-disabled="{{disabled}}" lt-prop-appearance="primary" onclick="{{action(\'insert\',this)}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Insert")}} </template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </template><template case="codeEditor"> <lyte-modal lt-prop="{{ltPropModal}}" lt-prop-show="{{lbind(cpShow)}}" lt-prop-wrapper-class="lyteEditorSnippetModal" lt-prop-width="70%" lt-prop-height="70%" lt-prop-set-content-height="true" lt-prop-show-close-button="false" lt-prop-transition="{&quot;animation&quot;:&quot;fadeIn&quot;, &quot;duration&quot;:&quot;0.3&quot;}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <span>Insert code</span> <div class="lyteEditorSnippetModalLanguageSection"> <span class="lyteEditorSnippetChooseLangLabel">Choose language: </span> <lyte-dropdown lt-prop-options="{{languagesSupported}}" lt-prop-selected="{{lbind(languageSelected)}}"> </lyte-dropdown> </div> </lyte-modal-header> <lyte-modal-content class="lyteFilterContent"> <textarea class="lyteEditorSnippetTextarea" spellcheck="false"></textarea> </lyte-modal-content> <lyte-modal-footer class="right"> <lyte-button onclick="{{action(\'insertCode\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Cancel")}} </template> </lyte-button> <lyte-button lt-prop-appearance="primary" onclick="{{action(\'insertCode\',this)}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Insert")}} </template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </template><template case="insertHTML"> <lyte-modal lt-prop="{{ltPropModal}}" lt-prop-show="{{lbind(cpShow)}}" lt-prop-wrapper-class="lyteEditorInsertHTMLModal" lt-prop-width="auto" lt-prop-height="auto" lt-prop-set-content-height="true" lt-prop-show-close-button="false" lt-prop-transition="{&quot;animation&quot;:&quot;fadeIn&quot;, &quot;duration&quot;:&quot;0.3&quot;}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <template is="if" value="{{showPreview}}"><template case="true"> <span class="lyteEditorInsertHTMLBack" onclick="{{action(\'hidePreview\',this)}}">---</span> <span>{{lyteUiEditorI18n("Preview")}}</span> </template><template case="false"> <span>{{lyteUiEditorI18n("Insert HTML")}}</span> </template></template> </lyte-modal-header> <lyte-modal-content class="lyteFilterContent"> <template is="if" value="{{showPreview}}"><template case="true"> <div class="lyteEditorInsertHTMLPreview">{{unescape(ltPropPreviewContent,undefined,sanitizer.attr)}}</div> </template><template case="false"> <textarea class="lyteEditorInsertHTMLTextarea" spellcheck="false" value="{{lbind(ltPropPreviewContent)}}"></textarea> <div onclick="{{action(\'showPreview\',this)}}">Preview</div> </template></template> </lyte-modal-content> <lyte-modal-footer class="right"> <lyte-button lt-prop-appearance="primary" onclick="{{action(\'insertHTML\',this)}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Insert")}} </template> </lyte-button> <lyte-button onclick="{{action(\'insertHTML\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Cancel")}} </template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{switch:{dynamicNodes:[],additional:{next:"undo"}},undo:{dynamicNodes:[],additional:{next:"anchor"}},anchor:{dynamicNodes:[],additional:{next:"list"}},list:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]},dropdown:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'--editorPanelDropValue:'","item.value[index]"]}}}},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},colorpicker:{dynamicNodes:[{type:"text",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","item.selected","';'"]}}}}]},emoji:{dynamicNodes:[{type:"text",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},{type:"componentDynamic",position:[3]}]},custom:{dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},image:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"attr",position:[2]},{type:"registerYield",position:[2,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1,1]},{type:"componentDynamic",position:[3,1,1]},{type:"attr",position:[3,1,3]},{type:"componentDynamic",position:[3,1,3]},{type:"attr",position:[3,3]},{type:"attr",position:[3,3,1]},{type:"attr",position:[3,3,3]},{type:"registerYield",position:[3,3,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3,3,3]},{type:"attr",position:[3,3,5]},{type:"if",position:[3,3,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,3]}]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[3,5]},{type:"if",position:[3,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"attr",position:[1,3]}]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}}]}},default:{}},{type:"attr",position:[3,7,1]},{type:"componentDynamic",position:[3,7,1]},{type:"attr",position:[3,7,3]},{type:"componentDynamic",position:[3,7,3]},{type:"attr",position:[3,7,5]},{type:"componentDynamic",position:[3,7,5]},{type:"attr",position:[3,9]},{type:"if",position:[3,9],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"attr",position:[3,11]},{type:"if",position:[3,11],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[0,1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"for",position:[1,3],dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{input:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},number:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},radioButtonGroup:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},dropdown:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},checkBox:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[2]}]},codeEditor:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,3,3]},{type:"componentDynamic",position:[1,3,3]},{type:"componentDynamic",position:[1]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[1]}]},insertHTML:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[3,0]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]}]}},default:{}},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[1]}]}},default:{}}],_templateAttributes:{type:"attr",position:[]},_observedAttributes:["ltPropDropdown","ltPropPopover","ltPropColorPicker","ltPropTabindex","ltPropWrapperClass","ltPropFreeze","ltPropPreviewContent","ltPropSanitizer","item","editorId","ltPropTooltipConfig","active","activeClass","editorOrigin","cpShow","languagesSupported","languageSelected","sanitizer","fromList","isFont","isUrl","url","imageError","disabled","loaded","renderUrl","fitToScreen","small","actualSize","maintainAspectRatio","showPreview","wrapImage"],data:function(){var t=Lyte.attr.bind(Lyte),e="string",i="boolean",a=!1;return{ltPropDropdown:t(e,{default:"{}"}),ltPropPopover:t(e,{default:"{}"}),ltPropColorPicker:t(e,{default:"{}"}),ltPropTabindex:t(e,{default:"-1"}),ltPropWrapperClass:Lyte.attr("string",{default:""}),ltPropFreeze:Lyte.attr("boolean",{default:!1}),ltPropPreviewContent:t(e,{default:""}),ltPropSanitizer:t("object",{default:{}}),item:t("object"),editorId:t(e),ltPropTooltipConfig:t(e),active:t(i),activeClass:t(e),editorOrigin:t(e),cpShow:t(i,{default:a}),languagesSupported:t("array",{default:["HTML","CSS","JS","JAVA","PYTHON","JSON","XML","LYTE"]}),languageSelected:t("string",{default:"HTML"}),sanitizer:t("object",{default:{}}),fromList:t(i,{default:a}),isFont:t(i,{default:a}),isUrl:t(i,{default:a}),url:t(e,{default:""}),imageError:t(i,{default:a}),disabled:t(i,{default:!0}),loaded:t(i,{default:a}),renderUrl:t(i,{default:a}),fitToScreen:t(i,{default:!0}),small:t(i,{default:a}),actualSize:t(i,{default:a}),maintainAspectRatio:t(i,{default:a}),showPreview:t(i,{default:a}),wrapImage:t(i,{default:a})}},init_fn:function(t){var e=this.data.item;this.setData("isFont","colorpicker"==e.type&&"color"==e.name),t||"colorpicker"!=e.type||null!=e.usedColorsList||Lyte.objectUtils(e,"add","usedColorsList",[])}.observes("item.type","item").on("init"),obs:function(t){var e=this.data.item,i=_lyteUiUtils.capitalize,a="lyteEditorTextFormatIcons lyteEditor"+i(e.name)+"Icon",o=e.type;e.active&&(a+=" "+(e.activeClass||this.data.activeClass)),e.disabled&&(a+=" lyteEditorPanelIconDisabled"),e.class&&(a+=" "+e.class),o&&(a+=" lyte"+i(o)+"Icon"),this.$node.setAttribute("class",a),e.active&&e.prevent_true?this.$node.setAttribute("tabindex",-1):this.$node.setAttribute("tabindex",this.data.ltPropTabindex),t||$L(this.$node).attr(e.attr||{})}.observes("active","item.type","item.disabled").on("didConnect"),url_obs:function(t){this.data.cpShow&&this.alignModal(),t.newValue&&this.setData("renderUrl",!0),this.setData({url:"",fitToScreen:!0})}.observes("isUrl"),displayTypeObs:function(t){if(this.data.item.advancedOptions&&this.data.url&&this.data.loaded){let e=this._imagePop.querySelector(".lyteEditorPreviewImage"),i="",a="";"actualSize"==t.item&&t.newValue&&(i=e.naturalWidth,a=e.naturalHeight);let o=this._imagePop.querySelector(".lyteEditorPanelImageWidthInput").querySelector("lyte-number"),n=this._imagePop.querySelector(".lyteEditorPanelImageHeightInput").querySelector("lyte-number");o.ltProp("value",i),n.ltProp("value",a)}}.observes("actualSize"),alignModal:function(){this.$node.querySelector("lyte-modal").alignModal()},init:function(){this.data.editorOrigin="#"+this.data.editorId+" .lyteEditor"+_lyteUiUtils.capitalize(this.data.item.name)+"Icon"},cp_obs:function(t){$L(this.$node)[t.newValue?"addClass":"removeClass"]("lyteEditor"+("colorpicker"==this.data.item.type?"Colorpicker":"imageModal")+"Opened")}.observes("cpShow"),disabled_obs:function(t){var e=this.data,i=t.oldValue;"url"==t.item&&i&&URL.revokeObjectURL(i),!this.data.url&&!this.data.loaded&&this.resetAdvancedOptions(),this.setData("disabled",!(e.loaded&&e.url))}.observes("loaded","url"),sel_obs:function(t){if("colorpicker"==this.data.item.type){var e=t.newValue,i=this.$node.getElementsByTagName("lyte-colorpicker")[0],a=""!=e?/rgb/i.test(e)?{rgb:e}:{hex:e}:{};i.selectColor?i.selectColor(/rgba/i.test(e)?{rgba:e}:/rgb/i.test(e)?{rgb:e}:{hex:e}):i.component.setData("ltPropSelectedColor",a)}}.observes("item.selected"),drop:function(t){t.preventDefault();let e=t.dataTransfer.files,i=["image/png","image/jpeg","image/jpg","image/gif","image/bmp"];for(let t=0;t<e.length;t++){let a=e[t];-1!=i.indexOf(a.type)&&(this.setData("url",URL.createObjectURL(a)),this.setData("imageError",!1))}},preventDefaults:function(t){t.preventDefault(),t.stopPropagation()},resetAdvancedOptions:function(){this.data.item.advancedOptions&&this.data.ltPropImageOptions.forEach((function(t){t.subItems.forEach((function(t){switch(t.purpose){case"height":case"width":Lyte.objectUtils(t,"add","value",""),Lyte.objectUtils(t,"add","unit","px");break;case"align":Lyte.objectUtils(t,"add","selected",{});break;default:Lyte.objectUtils(t,"add","value","")}}))})),this.setData("wrapImage",!1)},methods:{throw:function(){this.throwEvent.apply(this,arguments)},emojiClose:function(t,e){let i="onBeforeEmojiClose";if(this.getMethods(i))return this.executeMethod(i,t,e)},popoverOpen:function(t){let e=this._imagePop=this._imagePop||$L(t.childComp).find(".lyteEditorImageModal").get(0).children[0];this._preventDefault=this.preventDefaults.bind(this),["dragenter","dragover","dragleave"].forEach((t=>{e.addEventListener(t,this._preventDefault,!1)})),this._drop=this.drop.bind(this),e.addEventListener("drop",this._drop,!1)},popoverClose:function(){["dragenter","dragover","dragleave"].forEach((t=>{this._imagePop.removeEventListener(t,this._preventDefault,!1)})),this._imagePop.removeEventListener("drop",this._drop,!1)},changeunit:function(t,e,i,a){let o=i.$node.parentElement.parentElement;$L(o).find("lyte-number");$L(o).find(".lyteEditorPanelImageWidthInput").find("lyte-number").get(0).ltProp("label",e),$L(o).find(".lyteEditorPanelImageHeightInput").find("lyte-number").get(0).ltProp("label",e)},numberValueChange:function(t,e,i){if(!e.newValue&&0!==e.newValue||!this.data.maintainAspectRatio)return;let a=this._image=this._image||this._imagePop.querySelector(".lyteEditorPreviewImage"),o=i.parentElement.parentElement,n=a.naturalWidth,r=a.naturalHeight,s=0,l=0,d=a.margin||0;if(this.data.actualSize)s=n,l=r;else if(this.data.small)s=200,l=r/n*s;else{let t={};this.throwEvent("getCurrentParaClient",t),t=t.client,s=t.width-d,l=r/n*100-d}let c,p=s/l;"width"==t?(c=o.querySelector(".lyteEditorPanelImageHeightInput").getElementsByTagName("lyte-number")[0],c.ltProp("value",e.newValue/p)):"height"==t&&(c=o.querySelector(".lyteEditorPanelImageWidthInput").getElementsByTagName("lyte-number")[0],c.ltProp("value",e.newValue*p))},alignChange:function(t,e){this.data.wrapImage?"left"!=e.value&&"right"!=e.value&&this.setData("wrapImage",!1):"left"!=e.value&&"right"!=e.value||this.setData("wrapImage",!0)}},actions:{keydown:function(t){"Enter"==t.key&&t.target==this.$node&&("dropdown"==this.data.item.type?setTimeout(function(){this.$node.getElementsByTagName("lyte-dropdown")[0].open()}.bind(this)):this.$node.click(),t.preventDefault())},removeImg:function(){this.setData("url","")},change:function(t){let e,i=URL.createObjectURL(t.files[0]);this.getMethods("onBeforeImageUpload")&&(e=this.executeMethod("onBeforeImageUpload",i,t,this.$node));let a=function(){this.setData("url",i),t.value="",this._image=void 0}.bind(this);e&&e.then?e.then(a):!1!==e&&a()},openfile:function(t){t.previousElementSibling.click()},reset:function(){return this.throwEvent("colorPickerSelect",this.data.item,0,{},this.$node.querySelector("lyte-colorpicker").component),Lyte.objectUtils(this.data.item,"add","selectedColor",this.data.item.selected),!1},imageLoad:function(t){this.setData({imageError:!t,loaded:t}),this.alignModal()},insert:function(t){var e=this.data,i=(e.url,e.isUrl,!1);if(t){var a,o,n,r,s,l,d,c,p,h=t.closest(".lyteEditorImageModal").querySelector("img"),u=h.naturalWidth,m=h.naturalHeight,f=document.getElementById(this.data.editorId).parentNode.component.getThis().getData("ltPropImageStyle").margin||"0px",g="";e.actualSize?(o=u,n=m,p="actualSize"):e.small?(n=m/u*(o=200),p="small"):(o="calc( 100% - "+f+" - "+f+" )",n="calc( "+m/u*100+"% - "+f+" - "+f+" )",p="fitToScreen"),this.data.ltPropImageOptions.forEach((function(t){t.subItems.forEach((function(t){switch(t.purpose){case"alt":g=t.value;break;case"height":null!=t.value&&""!=t.value&&(n=t.value+t.unit,p="custom");break;case"width":null!=t.value&&""!=t.value&&(o=t.value+t.unit,p="custom");break;case"align":t.selected.value&&("left"==t.selected.value||"right"==t.selected.value?s=t.selected.value:r=t.selected.value);break;case"horizontal":t&&(l=t.value);break;case"vertical":t&&(d=t.value);break;case"border":t&&(border=t.value)}}))}));try{a=_lyteUiEditor.copy_image(h,"",u,m)}catch(t){a=h.src}m==parseInt(n)&&u==parseInt(o)&&(p="actualSize"),this.data.wrapImage&&(s||r||(s="left")),c="' style='"+(s?"float:"+s+";":"")+(border?"border:"+border+"px solid black;":"")+(r?"vertical-align:"+r+";":"")+(l?"margin-left:"+l+"px;margin-right:"+l+"px;":"")+(d?"margin-top:"+d+"px;margin-bottom:"+d+"px;":"")+"' ",this.throwEvent("insertImage","<img src='"+a+"' alt='"+g+"' display-type='"+p+"' height='"+n+"' width='"+o+("' style='"!=c?""+c:"")+"' >",this._imgElm,this.data.wrapImage)}this.setData({cpShow:i,isUrl:i,loaded:i,url:"",fitToScreen:!0}),this._imgElm=void 0,this.resetAdvancedOptions()},insertCode:function(t){if(t){var e=$L($L(this.$node).find("lyte-modal")[0].component.childComp).find("textarea")[0].value;this.throwEvent("insertCodeText",e,this.data.languageSelected),this.setData({cpShow:!1})}else this.setData({cpShow:!1})},insertHTML:function(t){t&&this.throwEvent("insertHTML",this.data.ltPropPreviewContent),this.setData("cpShow",!1)},showPreview:function(t){this.setData("ltPropPreviewContent",t.previousElementSibling.value),this.setData("showPreview",!0)},hidePreview:function(t){let e=t.parentElement.nextElementSibling;this.setData("ltPropPreviewContent",$L(e).find(".lyteEditorInsertHTMLPreview").get(0).innerHTML),this.setData("showPreview",!1)}}}),Lyte.Component.registerHelper("setImageModalClass",(function(t){return(this.component.data.item.advancedOptions?"lyteEditorInsertImgModalWrap":"")+" lyteEditorImageModal "+this.component.getData("ltPropWrapperClass")})),Lyte.Component.register("lyte-editorpanel",{_template:'<template tag-name="lyte-editorpanel"> <div class="lyteEditorIconsDiv" id="{{editorId}}"> <template is="if" value="{{isGrouped}}"><template case="true"> <template is="for" items="{{renderingOptions}}" item="sub" index="subIndex"> <div class="LyteEditorFormatSection {{sub.class}}" index="{{subIndex}}"> <template is="for" items="{{sub.subIcons}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" active="{{item.active}}" onclick="{{action(\'iconClick\',item,event)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" sanitizer="{{sanitizer}}" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-wrapper-class="{{ltPropWrapperClass}}" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template></div></template>  </template><template case="false"> <template is="for" items="{{renderingOptions}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" index="{{index}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" active="{{item.active}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" onclick="{{action(\'iconClick\',item,event)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" sanitizer="{{sanitizer}}" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-wrapper-class="{{ltPropWrapperClass}}" lt-prop-freeze="{{ltPropFreeze}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template></template></template> <span class="lyteEditorMoreOptions {{extraIconClass}} {{if(moreOptionsShow,\'lyteEditorMoreOptionsOpened\',\'\')}}" lt-prop-title="{{ltPropMoreOptions}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" onclick="{{action(\'showmore\',event)}}" onkeydown="{{action(\'showmore\',event)}}" tabindex="{{ltPropTabindex}}"></span> <template is="if" value="{{renderExtraIcon}}"><template case="true"> <lyte-popover class="moreOptionsPopover" lt-prop-focus-on-close="true" lt-prop-wrapper-class="lyteEditorPanelMoreOptionPopover {{ltPropMoreOptionsWrapperClass}} {{ltPropWrapperClass}}" lt-prop-show="{{lbind(moreOptionsShow)}}" lt-prop-origin-elem="#{{editorId}} .lyteEditorMoreOptions" lt-prop-force-scroll="{{ltPropForcePopScroll}}" lt-prop="{{ltPropMoreOptionsPopover}}" on-before-close="{{method(\'moreBeforeClose\')}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="popover"> <div class="lyteEditorIconsDiv {{if(isSelected,\'lyteEditorTextSelected\',\'\')}}" id="{{editorId}}"> <template is="if" value="{{isGrouped}}"><template case="true"> <template is="for" items="{{extraOptions}}" item="sub" index="subIndex"> <div class="LyteEditorFormatSection {{item.class}}"> <template is="for" items="{{sub.subIcons}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" active="{{item.active}}" onclick="{{action(\'iconClick\',item,event)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" sanitizer="{{sanitizer}}" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-wrapper-class="{{ltPropWrapperClass}}" lt-prop-freeze="{{ltPropFreeze}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template></div></template>  </template><template case="false"> <template is="for" items="{{extraOptions}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" active="{{item.active}}" onclick="{{action(\'iconClick\',item,event)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" sanitizer="{{sanitizer}}" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-wrapper-class="{{ltPropWrapperClass}}" lt-prop-freeze="{{ltPropFreeze}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template></template></template> </div> </template> </lyte-popover> </template></template> </div> <template is="if" value="{{allowListPop}}"><template case="true"> <lyte-popover lt-prop-duration="{{undef}}" lt-prop-wrapper-class="lyteEditorPanelListPopover {{ltPropWrapperClass}}" lt-prop-show="{{lbind(listPopShow)}}" lt-prop-origin-elem=".{{randomId}}" lt-prop-allow-multiple="true" lt-prop="{{ltPropPopover}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="lyteEditorPanelListPopContent {{listPanelClass}}"> <template is="for" items="{{listRendering.list}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" active="{{item.active}}" onclick="{{action(\'listClick\',item,event,listRendering)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" sanitizer="{{sanitizer}}" from-list="true" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-freeze="{{ltPropFreeze}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template> </lyte-popover-content> </template> </lyte-popover> </template></template> <template is="if" value="{{renderTablePop}}"><template case="true"> <lyte-popover class="lyteEditorTablePopover" lt-prop-duration="{{undef}}" lt-prop-wrapper-class="lyteEditorPanelTableInsertPopover {{ltPropWrapperClass}}" lt-prop-show="{{lbind(tableShow)}}" lt-prop-origin-elem="#{{editorId}} .lyteTableIcon" lt-prop-allow-multiple="true" lt-prop="{{ltPropPopover}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-header class="">{{lyteUiEditorI18n("Insert Table")}}</lyte-popover-header> <lyte-popover-content> <div class="{{if(tableSelect,\'lyteEditorHide\',\'\')}}"> <div class="lyteEditorTableSelectWrapper"> <template is="for" items="{{tableData}}" item="row" index="row_index"> <div class="lyteEditorRow"> <template is="for" items="{{row}}" item="col" index="col_index"> <span class="{{col.class}}" onclick="{{action(\'table_click\',row_index,col_index)}}" onmouseenter="{{action(\'table_enter\',row_index,col_index)}}"></span> </template> </div> </template> </div> <div class="lyteEditorPanelTableSelected">{{rowCount}} * {{colCount}}</div> <div class="lyteEditorPanelTableCustomSwitch" onclick="{{action(\'columnSwitch\')}}">Show more options</div> </div> <div class="lyteEditorPanelTableInsertCustom {{if(tableSelect,\'\',\'lyteEditorHide\')}}"> <div class="lyteEditorTableOptionsWrap"> <template is="for" items="{{ltPropTableOptions}}" item="item" index="index"> <div class="lyteEditorTableOptions {{item.hidden}}"> <template is="switch" value="{{item.type}}"><template case="number"> <lyte-number lt-prop-min="{{item.min}}" lt-prop-max="{{item.max}}" lt-prop-label="{{item.label}}" lt-prop-placeholder="{{item.placeholder}}" lt-prop-value="{{lbind(item.value)}}" class="{{item.class}}"></lyte-number> <template is="if" value="{{item.subtype}}"><template case="true"> <lyte-dropdown class="{{item.subtype.class}}" lt-prop-selected="{{lbind(item.subtype.value)}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="lyteEditorTableDropbox {{ltPropWrapperClass}}"> <lyte-drop-body> <template is="for" items="{{item.subtype.options}}" item="inneritem" index="index"> <lyte-drop-item class="{{inneritem.class}}" data-value="{{inneritem.system}}">{{inneritem.display}}</lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template></template></template><template case="dropdown"><template is="if" value="{{item.label}}"><template case="true"> <div class="lyteEditorTableDropdownLabel">{{item.label}}</div> </template></template> <lyte-dropdown class="{{item.class}}" lt-prop-selected="{{lbind(item.value)}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="lyteEditorTableDropbox {{ltPropWrapperClass}}"> <lyte-drop-body> <template is="for" items="{{item.options}}" item="inneritem" index="index"> <lyte-drop-item class="{{inneritem.class}}" data-value="{{inneritem.system}}">{{inneritem.display}}</lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template></template> </div> </template> </div> <div class="lyteEditorPanelTableButtons"> <lyte-button class="lyteEditorPanelTableCancelBtn" onclick="{{action(\'table_cancel\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Cancel")}} </template> </lyte-button> <lyte-button lt-prop-appearance="primary" onclick="{{action(\'table_click\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Apply")}} </template> </lyte-button> </div> </div> </lyte-popover-content> </template> </lyte-popover> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]}]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]}]}},default:{}},{type:"attr",position:[1,3]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]}]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]}]}},default:{}}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"attr",position:[3,1,1,1]},{type:"for",position:[3,1,1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]}]}]},{type:"text",position:[3,1,3,0]},{type:"text",position:[3,1,3,2]},{type:"attr",position:[3,1,5]},{type:"attr",position:[3,3]},{type:"attr",position:[3,3,1,1]},{type:"for",position:[3,3,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"switch",position:[1,1],cases:{number:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},dropdown:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[2]},{type:"registerYield",position:[2,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[2]}]}},default:{}}]},{type:"attr",position:[3,3,3,1]},{type:"registerYield",position:[3,3,3,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3,3,3,1]},{type:"attr",position:[3,3,3,3]},{type:"registerYield",position:[3,3,3,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3,3,3,3]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1]}]}},default:{}}],_observedAttributes:["ltPropIcons","ltPropEditor","ltPropActiveClass","ltPropTooltipConfig","ltPropTooltipClass","ltPropMoreOptions","ltPropMoreIcon","ltPropDropdown","ltPropPopover","ltPropColorPicker","ltPropMoreOptionsPopover","ltPropMoreOptionsWrapperClass","ltPropSortable","ltPropSortableOptions","ltPropTableOptions","ltPropTabindex","ltPropForcePopScroll","ltPropWrapperClass","ltPropFreeze","ltPropEmojiAsWord","ltPropImageAdvancedOptions","ltPropShowWrapImage","renderingOptions","extraOptions","renderExtraIcon","extraIconClass","moreOptionsShow","isSelected","listRendering","isGrouped","listPopShow","allowListPop","listPanelClass","undef","randomId","editorId","sanitizer","renderTablePop","tableSelect","tableShow","tableData","rowCount","colCount"],data:function(){return{ltPropIcons:Lyte.attr("array",{default:JSON.parse(JSON.stringify(_lyteUiEditor.icons))}),ltPropEditor:Lyte.attr("string",{default:""}),ltPropActiveClass:Lyte.attr("string",{default:"lyteEditorTextFormatSelected"}),ltPropTooltipConfig:Lyte.attr("string",{default:'{"position" : "bottom", "showdelay" : 500}'}),ltPropTooltipClass:Lyte.attr("string",{default:"lyteEditorPanelTooltip"}),ltPropMoreOptions:Lyte.attr("string",{default:_lyteUiEditor.i18n("More options")}),ltPropMoreIcon:Lyte.attr("boolean",{default:!0}),ltPropDropdown:Lyte.attr("string",{default:"{}"}),ltPropPopover:Lyte.attr("string",{default:'{"showCloseButton" : false, "headerPadding" : "", "contentPadding" : "", "footerPadding": "", "scrollable" : true, "focusOnClose" : false }'}),ltPropColorPicker:Lyte.attr("string",{default:"{}"}),ltPropMoreOptionsPopover:Lyte.attr("string",{default:'{"duration":"","allowMultiple":true,"showCloseButton":false,"placement":"topLeft top bottom","type":"callout","scrollable":true}'}),ltPropMoreOptionsWrapperClass:Lyte.attr("string",{default:""}),ltPropSortable:Lyte.attr("boolean",{default:!1}),ltPropSortableOptions:Lyte.attr("object",{default:{}}),ltPropTableOptions:Lyte.attr("array",{default:[{type:"number",purpose:"row",min:1,max:10,label:_lyteUiEditor.i18n("Rows"),placeholder:_lyteUiEditor.i18n("{{0}} to {{1}}",1,10),defaultValue:2,value:2,class:"lyteEditorPanelTableRowInput",render:!0},{type:"number",purpose:"column",min:1,max:10,label:_lyteUiEditor.i18n("Columns"),placeholder:_lyteUiEditor.i18n("{{0}} to {{1}}",1,10),defaultValue:2,value:2,class:"lyteEditorPanelTableColumnInput",render:!0},{type:"number",purpose:"width",min:1,max:1/0,label:_lyteUiEditor.i18n("Width"),placeholder:"0 to 100",defaultValue:100,value:100,class:"lyteEditorPanelTableWidthInput",subtype:{type:"dropdown",options:[{system:"%",display:"%"},{system:"px",display:"px"}],value:"%",defaultValue:"%",class:"lyteEditorPanelTableUnitDropdown"}},{type:"number",purpose:"height",min:1,max:1/0,label:_lyteUiEditor.i18n("Height"),placeholder:"0 to 100",defaultValue:100,value:100,class:"lyteEditorPanelTableHeightInput",subtype:{type:"dropdown",options:[{system:"%",display:"%"},{system:"px",display:"px"}],value:"%",defaultValue:"%",class:"lyteEditorPanelTableUnitDropdown"}},{type:"number",purpose:"borderWidth",min:0,max:20,label:_lyteUiEditor.i18n("Border Size"),placeholder:"0 to 20",defaultValue:1,value:1,class:"lyteEditorPanelTableBorderSizeInput"},{type:"dropdown",purpose:"alignment",value:"none",defaultValue:"none",label:_lyteUiEditor.i18n("Align"),options:[{system:"none",display:_lyteUiEditor.i18n("None")},{system:"left",display:_lyteUiEditor.i18n("Left")},{system:"right",display:_lyteUiEditor.i18n("Right")},{system:"center",display:_lyteUiEditor.i18n("Center")}]}]}),ltPropTabindex:Lyte.attr("string",{default:"-1"}),ltPropForcePopScroll:Lyte.attr("boolean",{default:!1}),ltPropWrapperClass:Lyte.attr("string",{default:""}),ltPropFreeze:Lyte.attr("boolean",{default:!1}),ltPropEmojiAsWord:Lyte.attr("boolean",{default:!1}),ltPropImageAdvancedOptions:Lyte.attr("array",{default:[{label:"Alternate Text",class:"lyteEditorPanelImageAltInput",subItems:[{prop:{placeholder:"Enter alternate text for image",appearance:"box"},type:"input",purpose:"alt",value:""}]},{label:"Transform",class:"lyteEditorPanelImageTransformGroup",subItems:[{label:"Width",type:"number",purpose:"width",unit:"px",class:"lyteEditorPanelImageWidthInput",prop:{placeholder:""}},{label:"Height",type:"number",purpose:"height",class:"lyteEditorPanelImageHeightInput",unit:"px",prop:{placeholder:""}},{type:"dropdown",purpose:"unit",prop:{},userValue:"name",systemValue:"value",options:[{name:"px",value:"px"},{name:"%",value:"%"}]},{label:"Keep aspect ratio",class:"lyteEditorPanelImageAspectRatio",type:"checkBox",purpose:"maintainAspectRatio",prop:{type:"primary",name:"maintainAspectRatio",value:"maintainAspectRatio"}},{label:"Horizontal",type:"number",purpose:"horizontal",unit:"px",prop:{placeholder:""}},{label:"Vertical",type:"number",purpose:"vertical",unit:"px",prop:{placeholder:""}},{label:"Border",type:"number",purpose:"border",unit:"px",prop:{placeholder:""}}]},{label:"Alignment",class:"lyteEditorPanelImageAlignGroup",subItems:[{type:"radioButtonGroup",prop:{name:"group"},purpose:"align",userValue:"name",systemValue:"value",selected:{},options:[{name:"Left",value:"left"},{name:"Right",value:"right"},{name:"Center",value:"middle"},{name:"Top",value:"top"},{name:"Bottom",value:"bottom"}]}]}]}),ltPropShowWrapImage:Lyte.attr("boolean",{default:!1}),renderingOptions:Lyte.attr("array",{default:[]}),extraOptions:Lyte.attr("array",{default:[]}),renderExtraIcon:Lyte.attr("boolean",{default:!1}),extraIconClass:Lyte.attr("string",{default:""}),moreOptionsShow:Lyte.attr("boolean",{default:!1}),isSelected:Lyte.attr("boolean",{default:!1}),listRendering:Lyte.attr("object",{default:{}}),isGrouped:Lyte.attr("boolean",{default:!1}),listPopShow:Lyte.attr("boolean",{default:!1}),allowListPop:Lyte.attr("boolean",{default:!1}),listPanelClass:Lyte.attr("string",{default:""}),undef:Lyte.attr("string",{default:void 0}),randomId:Lyte.attr("string",{default:""}),editorId:Lyte.attr("string",{default:"lyteEditorPanel"+parseInt(1e5*Math.random())}),sanitizer:Lyte.attr("object",{default:{attr:Lyte.Security.createSanitizer({GLOBAL_TAGS:["mention_div"],GLOBAL_ATTRIBUTES:["editable","module","editor-language"],ADD_URI_SAFE_ATTR:["style"],ALLOWED_STYLE:"ALL",STYLE_VALIDATION:!1})}}),renderTablePop:Lyte.attr("boolean",{default:!1}),tableSelect:Lyte.attr("boolean",{default:!1}),tableShow:Lyte.attr("boolean",{default:!1}),tableData:Lyte.attr("array",{default:[]}),rowCount:Lyte.attr("number"),colCount:Lyte.attr("number")}},didConnect:function(){var t=this,e=t.data,i="afterRender",a=t.$node;(t.editor=$L(e.ltPropEditor).get(0)).panel=t,a.refresh=function(){this.updateIconBarRange();var t=this.getThis().data;this.undoRedo(t.undoqueue,t.redoqueue)}.bind(t),e.ltPropMoreIcon?(a.checkWidth=t.check_availability.bind(t),t.check_availability()):(t.setData({renderingOptions:e.ltPropIcons,extraIconClass:"lyteEditorpanelHide"}),e.ltPropSortable&&t.bind_sort()),t.getMethods(i)&&t.executeMethod(i,a),window.requestAnimationFrame(function(){!this.__called&&a.refresh()}.bind(this))},bind_sort:function(){var t,e=this,i=e.data,a=i.isGrouped,o={},n=$L(e.$node).children(".lyteEditorIconsDiv"),r=Lyte.arrayUtils,s=function(t,i,a){var o=r(a||t,"removeAt",i[3]),n="onSortDrop",s=i[4],l=i[1];r(t,"insertAt",s,o),l.addToSortable(l.children[s]),e.getMethods(n)&&((i=Array.from(i)).unshift(n),e.executeMethod.apply(e,i))},l=i.ltPropIcons;a?(n=n.children(".LyteEditorFormatSection"),t=function(t,e){var i=arguments;s(l[e.getAttribute("index")].subIcons,i,l[i[5].getAttribute("index")].subIcons)}):(o.restrict=".lyteEditorMoreOptions,lyte-popover",t=function(){s(l,arguments)}),o.onDrop=t.bind(this),o.onBeforeDrop=function(){var t="onBeforeSortDrop";if(e.getMethods(t)){var i=Array.from(arguments);return i.unshift(t),e.executeMethod.apply(e,i)}},n.sortable($L.extend(o,i.ltPropSortableOptions))},remove_sort:function(){var t=$L(this.$node).children(".lyteEditorIconsDiv");this.data.isGrouped&&(t=t.children(".LyteEditorFormatSection")),t.sortable("destroy")},__bind_sort:function(t){t.newValue?this.bind_sort():this.remove_sort()}.observes("ltPropSortable"),check_availability:function(t){var e=this;e.setData("moreOptionsShow",!1),clearTimeout(e._rendertime),e._rendertime=setTimeout((function(){var t=e.data.ltPropIcons,i=$L.fastdom,a="renderingOptions",o=0,n=Array.from(e.$node.children).filter((function(t){return $L(t).hasClass("lyteEditorIconsDiv")}))[0],r="extraIconClass";e.setData(a,t),e.setData(r,""),i.clear(e._fdm),e._fdm=i.measure((function(){var s=0,l=function(t){var e=t.offsetWidth,i=window.getComputedStyle(t),a=parseFloat(i.marginLeft)+parseFloat(i.marginRight);return o+=a+e},d=n.getElementsByClassName("lyteEditorMoreOptions")[0],c=e.$node.offsetWidth-l(d);o=0,t.every((function(t,e){var i=n.children[e];return!(l(i)>c)&&(s=++e,!0)})),i.mutate((function(){e.setData(a,t.slice(0,s));var i=t.slice(s),o="";i.length?(e.setData("extraOptions",i),e.setData("renderExtraIcon",!0)):o="lyteEditorpanelHide",e.setData(r,o),e.data.ltPropSortable&&e.bind_sort()}))}))}),0)},listObs:function(){var t=this.data.ltPropIcons,e=!1,i=t[0]||{};this.setData("isGrouped",!!i.subIcons),t.every((function(t){return(t.subIcons||[t]).every((function(t){return!(e="list"==t.type)})),!e})),this.setData("allowListPop",e)}.observes("ltPropIcons").on("init"),initObs:function(){this.getMethods("beforeRender")&&this.executeMethod("beforeRender",this.$node)}.on("init"),didDestroy:function(){delete this.editor.panel,delete this.editor,$L.fastdom.clear(this._fdm),clearTimeout(this._rendertime)},callBeforeClick:function(t,e,i){if(this.getMethods("onBeforeClick"))return 0==this.executeMethod("onBeforeClick",t,e,i,this.$none)},callClick:function(t,e,i){if(this.getMethods("onClick"))return this.executeMethod("onClick",t,e,i,this.$node)},processArg:function(t){var e=$L.extend(!0,[],t.arguments||[]),i=t.selected||"",a=t.removeClass;if(null!=i){var o=e.indexOf("{{selected}}");o+1&&(/^([0-9]+)$/.test(i)&&(i=parseInt(i)),e.splice(o,1,i))}return a&&(e[3]=a),e},callFn:function(t){var e=this.getThis();return e[t.functionName].apply(e,this.processArg(t))||{applied:[],toApply:[]}},clickAction:function(t,e,i){if(this.callBeforeClick(t,e,i))return!1;var a=this.getThis(),o=!0,n=this,r=window;if(!a.isCodeEditor($L(a.data.currentNode.parentElement).data("data")))switch(t.type){case"switch":case"undo":if(t.active&&/^(undo|redo|clear)$/i.test(t.name))return;this.callFn(t);break;case"colorpicker":this.colorpicker(e.target);break;case"anchor":if(t.active)return;this.anchorIconClick.call(a,e.target),o=!1;break;case"list":var s=this.data.randomId,l=$L(e.target).closest(".lyteEditorTextFormatIcons",this.$none);if(s||this.setData("randomId",s=this.getThis().randomId()),l.hasClass(s))return void this.setData("listPopShow",!0);$L("."+s).removeClass(s),l.addClass(s),this.setData("listPanelClass",t.name?"lyteList"+t.name+"IconsWrap":""),window.requestAnimationFrame((function(){r.requestAnimationFrame((function(){n.setData("listRendering",t),n.setData("listPopShow",!0)}))}));break;case"emoji":Lyte.objectUtils(t,"add","active",!0);break;case"table":this.table_click(t);break;case"image":this.colorpicker(e.target,"lyte-modal");break;case"codeEditor":$L(e.target).find("lyte-modal").get(0).ltProp("show",!0);break;case"insertHTML":e.target.ltProp("previewContent",a.$node.getHTML(!0,!0)),$L(e.target).find("lyte-modal").get(0).ltProp("show",!0)}o&&a.$node.focus(),this.callClick(t,e,i)},table_render_obs:function(){var t,e,i=[];this.data.ltPropTableOptions.forEach((function(i){var a=i.purpose;/row/i.test(a)?t=i.max:/column/i.test(a)&&(e=i.max)}));for(var a=0;a<t;a++){for(var o=[],n=0;n<e;n++)o.push({class:""});i.push(o)}this.setData("tableData",i),this.modify_selection()}.observes("renderTablePop"),modify_selection:function(){var t=this.data,e=t.tableData,i=t.rowCount,a=t.colCount,o=Lyte.objectUtils;e.forEach((function(t,e){t.forEach((function(t,n){var r="lyteEditorColumn";e<i&&n<a&&(r+=" lyteEditorCellSelected"),o(t,"add","class",r)}))}))},table_click:function(t){this.setData("renderTablePop",!0),this.setData("tableShow",!0)},list_obs:function(t){var e="removeClass",i=t.newValue;i&&(e="addClass"),$L("."+this.data.randomId)[e]("lyteEditorPanelListPopOpened"),this["call_"+(i?"show":"hide")]()}.observes("listPopShow"),close_all_pop:function(){this.data.extraOptions.forEach((function(t){t&&t.subIcons.forEach((function(t){"emoji"==t.name&&Lyte.objectUtils(t,"add","active",!1)}))})),this.setData("listPopShow",!1);var t=this.getThis()._popover;t&&t.ltProp("show",!1)},methods:{moreBeforeClose:function(t){$L((t||{}).target).hasClass("lyteEditorMoreOptions")&&(this._ignore_click=!0),this.close_all_pop()},emojiClose:function(t,e){let i="onBeforeEmojiClose";if(this.getMethods(i))return this.executeMethod(i,t,e)},onBeforeImageUpload:function(){}},count_obs:function(){clearTimeout(this.__rowobs),this.__rowobs=setTimeout(function(){this.modify_selection()}.bind(this),0)}.observes("rowCount","colCount"),tableShow_obs:function(t){var e="call_show";t.newValue||(this.reset_table(),this.setData("tableSelect",!1),e="call_hide"),this[e]()}.observes("tableShow"),call_show:function(t){var e="onShow",i=this.getThis();t||i.setData("isPanelOpen",!0),this.getMethods(e)&&this.executeMethod(e,this.$node)},call_hide:function(t){var e="onHide",i=this.getThis();t||i.setData("isPanelOpen",!1),this.data.moreOptionsShow||this.getMethods(e)&&this.executeMethod(e,this.$node)},more_obs:function(t){this["call_"+(t.newValue?"show":"hide")](!0)}.observes("moreOptionsShow"),select_color:function(t,e,i){var a,o=this.getThis();i||(e.hex=o.data.ltPropWordStyle[t.arguments[0]]),e.nofill&&(e.hex=o.data.ltPropWordStyle[t.arguments[0]]||"#FFFFFF"),a=e.nofill?e.hex?this.getRequiredColorFormat(e.hex):"unset":e.rgba||(e.hex?this.getRequiredColorFormat(e.hex):"unset"),Lyte.objectUtils(t,"add","selected",a),this.callFn(t),o.$node.focus(),this.callClick(t,i)},getRequiredColorFormat:function(t,e){var i,a,o,n=document.createElement("canvas").getContext("2d");n.fillStyle=t.toLowerCase();var r=n.fillStyle;if(i=parseInt(r.substring(1,3),16),a=parseInt(r.substring(3,5),16),o=parseInt(r.substring(5,7),16),9==r.length){parseInt(r.substring(7,9),16)}return"rgb("+i+","+a+","+o+")"},actions:{elementOpen:function(){this.call_show()},elementBeforeOpen:function(){var t="onBeforeShow";this.getMethods(t)&&this.executeMethod(t,this.$node)},elementClose:function(t,e,i){if(this.call_hide(),i){var a=i.data;a.ltPropBasicColorPicker||this.select_color(t,a.ltPropSelectedColor,e)}},insertImage:function(t,e,i){var a=function(t){let a=this.getThis();a.data.wrapImage=Boolean(i),a.data.ltPropInlineImage&&!e?a.$node.insertHTML(t,!0):e?a.replaceImage(t,e):(this.getThis().$node.insertHTML(t,!0),this.callClick({},{}))}.bind(this);if(this.getMethods("onImageInsert")){var o=this.executeMethod("onImageInsert",this.$node,t);o&&o.then?o.then(function(t){a(t)}.bind(this)):!1!==o&&a(t)}else a(t)},insertCodeText:function(t,e){this.getThis().insertCodeText(t,e)},insertHTML:function(t){this.getThis().$node.insertHTML(t)},getCurrentParaClient:function(t){t.client=this.getThis().getCurrentParaClient()},showmore:function(t){if("keydown"!=t.type||32==t.keyCode||13==t.keyCode){"keydown"==t.type&&t.preventDefault();var e="_ignore_click";this[e]?delete this[e]:this.setData("moreOptionsShow",!0)}},emojiselect:function(t,e){var i=this.getThis().$node;this.data.ltPropEmojiAsWord?i.insertHTML(e.encode):i.insertTextInWord(e.value),Lyte.objectUtils(t,"add","active",!1),i.focus(),this.callClick(t,{})},dropItemSelected:function(t){this.callFn(t),this.getThis().$node.focus(),this.callClick(t,{})},colorPickerSelect:function(t,e,i,a){a.getData("ltPropBasicColorPicker")&&(a.$node.ltProp("show",!1),this.select_color(t,i,e))},iconClick:function(t,e){this.clickAction(t,e)},listClick:function(t,e,i){this.setData("listPopShow",!1),this.clickAction(t,e,i)},table_enter:function(t,e){this.setData({rowCount:t+1,colCount:e+1})},table_click:function(t,e){this.insert_table(t+1,e+1),this.setData("tableShow",!1),this.callClick({},{})},table_cancel:function(){this.setData("tableShow",!1)},columnSwitch:function(){this.reset_table(),this.setData("tableSelect",!0)}},colorpicker:function(t,e){$L(t).find(e||"lyte-colorpicker").get(0).ltProp("show",!0)},anchorIconClick:function(t){var e,i="popOrigin"+this.data.randomId,a="",o=this.data.range.isRange,n=function(){return this.convert_html_to_txt(this.getSelectedText()).replace(/\n/g,"")}.bind(this);if(o)e=n();else{var r=this.data.selectedWords,s=r.filter((function(t){if($L(t.node).data("data").details.anchor)return!0}));s.length>1||r.length>s.length?e="":1==s.length&&(e=n(),a=$L(s[0].node).data("data").details.anchor.href),this.setData("userInput","")}Lyte.objectUtils(this.data.anchorEdit,"add","text",e),Lyte.objectUtils(this.data.anchorEdit,"add","href",a),Lyte.objectUtils(this.data.anchorEdit,"add","newWindow",!0),Lyte.objectUtils(this.data.anchorEdit,"add","mailId",""),Lyte.objectUtils(this.data.anchorEdit,"add","mailSubject",""),Lyte.objectUtils(this.data.anchorEdit,"add","title",""),Lyte.objectUtils(this.data.anchorEdit,"add","telephone",""),this.setData("userInput",e),this.setData("isEditLink",!1),$L("."+i).removeClass(i),$L(t).addClass(i),this._popover.ltProp("show",!0)},activeCheck:function(t){var e=this.callFn(t);return e.applied.length>e.toApply.length},indivUpdate:function(t){if(!t.ignore){var e=t.type||"switch",i=this.getThis();switch(e){case"custom":Lyte.objectUtils(t,"add","active",!!this.callCustomIconUpdate(t));break;case"switch":case"colorpicker":var a=this.activeCheck(t);if(/^colorpicker$/i.test(e))Lyte.objectUtils(t,"add","selected",i.data.currentNode.style[t.arguments[0]]);else if(/^textIndentIncrease$/i.test(t.name)){let e=this.activeCheck(t);Lyte.objectUtils(t,"add","active",e)}else if(/^textIndentDecrease$/i.test(t.name)){let e=this.activeCheck(t);Lyte.objectUtils(t,"add","active",e)}else Lyte.objectUtils(t,"add","active",a);break;case"dropdown":var o,n=t.value,r=(t.selected,t.selected);if(n.every(function(e){return t.selected=e,!e||!this.activeCheck(t)||(o=e,!1)}.bind(this)),t.selected=r,!o&&/^fontSize|lineHeight$/i.test(t.name)){var s,l="";if("fontSize"==t.name){var d=i.getProp("fontSize",i.data.currentNode),c=this.get_unit(d);l=this.get_unit(t.value[0]||""),h=this.convert_to_unit(c,l,d),s=i.getIndex(t.value,h+l)}else if("lineHeight"==t.name){var p=i.data.currentNode.parentNode,h=i.getProp("lineHeight",p);if(/px$/i.test(h)){var u=i.getProp("fontSize",p);h=parseFloat(h)/parseFloat(u),l="px"}s=i.getIndex(t.value,h+l)}o=h+l,this.remove_fake(t,h),-1==s&&this.push_extra_value(t,h,l)}Lyte.objectUtils(t,"add","selected",o||""),Lyte.objectUtils(t,"add","active",!!o);break;case"list":var m=t.list,f=!1;m.forEach(function(t){this.indivUpdate(t),f=f||t.active}.bind(this)),Lyte.objectUtils(t,"add","active",f);break;case"anchor":var g=i.data.selectedWords,y=!1;if(i.data.ltPropDisableAnchorInMentions)for(let t=0;t<g.length;t++)if(g[t].node.classList.contains("lyteEditorMentionWord")){y=!0;break}Lyte.objectUtils(t,"add","active",1==g.length&&$L(g[0].node).hasClass("lyteEditorAnchor")||y)}}},remove_fake:function(t,e){for(var i=t.fake||[],a=t.display,o=t.value,n=i.length,r=function(t,e){Lyte.arrayUtils(t,"removeAt",e)},s=0;s<n;s++){var l=i[s];if(l!=e){var d=a.indexOf(l);r(o,d),r(a,d),i.splice(s--,1),n--}}},push_extra_value:function(t,e,i){var a=t.display,o=t.value,n=1,r=t.fake,s=function(t,e){Lyte.arrayUtils(t,"insertAt",n,e)};r||(r=t.fake=[]),-1==r.indexOf(e)&&(a.every((function(t){return Number(t)<e&&n++})),--n,s(o,e+i),s(a,e),r.push(e))},get_unit:function(t){return t.match(/px|pt|cm|mm|in/i)[0]},convert_to_unit:function(t,e,i){var a={px:1,pt:1.3281472327365,in:96,cm:37.795275591,mm:3.7795275591},o=a[e];return a[t]*Number(i.replace(/px|pt|cm|mm|in/,""))/o},updateIconBarRange:function(){this.__called=!0;var t=this.data.ltPropIcons,e=this.getThis(),i=e.data.range;e.iconUpdate(),t.forEach(function(t){(t.subIcons||[t]).forEach(this.indivUpdate.bind(this))}.bind(this)),this.callUpdate(),e.removeIconUpdate(),$L(this.$node)[i.isRange?"addClass":"removeClass"]("lyteEditorTextSelected"),this.setData("isSelected",i.isRange)},callCustomIconUpdate:function(t){if(this.getMethods("onCustomIconUpdate")){var e=this.getThis().data;return this.executeMethod("onCustomIconUpdate",t,this.$node,this.editor,e.currentNode,e.cursor,e.range,e.range.isRange)}},callUpdate:function(){this.getMethods("onIconbarUpdate")&&this.executeMethod("onIconbarUpdate",this.$node,this.editor)},getThis:function(){return this.editor.component},undoRedo:function(t,e){this.data.ltPropIcons.forEach((function(i){(i.subIcons||[i]).forEach((function(i){"undo"==i.type&&Lyte.objectUtils(i,"add","active","undo"==i.name?!t.length:!e.length)}))}))},disableAll:function(t){this.data.ltPropIcons.forEach((function(e){e.subIcons?e.subIcons.forEach((function(e){(t&&e.disabled||!t&&!e.disabled)&&Lyte.objectUtils(e,"add","disabled",!t)})):(t&&e.disabled||!t&&!e.disabled)&&Lyte.objectUtils(e,"add","disabled",!t)}))},reset_table:function(t){(t||this.data.ltPropTableOptions).forEach(function(t){var e=t.subtype;Lyte.objectUtils(t,"add","value",t.defaultValue),e&&this.reset_table([e])}.bind(this)),t&&this.setData({rowCount:0,colCount:0})},insert_table:function(t,e){var i={};this.data.ltPropTableOptions.forEach((function(t){var e=t.subtype,a=t.value;e&&(a+=e.value),i[t.purpose]=a})),this.getThis().table(t,e,i)}}),Lyte.Component.register("lyte-texteditor",{_template:'<template tag-name="lyte-texteditor" onclick="{{action(\'click\',event)}}"> <div class="lyteEditorContentEditable" tabindex="{{ltPropTabindex}}" contenteditable="{{isEditable}}" oncompositionstart="{{action(\'compositionStart\',event)}}" oncompositionupdate="{{action(\'compositionUpdate\',event)}}" oncompositionend="{{action(\'compositionEnd\',event)}}" oninput="{{action(\'input\',event,this)}}" onfocus="{{action(\'focus\',event)}}" onblur="{{action(\'blur\',event)}}" onkeydown="{{action(\'keydown\',event,this)}}" onpaste="{{action(\'paste\',event,this)}}" oncut="{{action(\'cut\',event)}}" oncopy="{{action(\'copy\',event)}}"></div> <canvas></canvas> <div class="lyteEditorMainDiv" contenteditable="{{ltPropBluePencil}}" tabindex="-1" onmousedown="{{action(\'mousedown\',event,this)}}" ontouchstart="{{action(\'mousedown\',event,this)}}" onkeydown="{{action(\'mainKey\',event,this)}}" oninput="{{action(\'mainInput\',event,this)}}" onfocus="{{action(\'focus\',event)}}" onblur="{{action(\'blur\',event)}}" onpaste="{{action(\'mainPaste\',event)}}" oncut="{{action(\'cut\',event)}}" oncopy="{{action(\'copy\',event)}}" onclick="{{action(\'mainClick\')}}"></div> <template is="if" value="{{expHandlers(isMac,\'||\',renderFrame)}}"><template case="true"> <iframe class="lyteEditorContentEditable" onload="{{action(\'frameLoad\',this)}}" tabindex="-1"></iframe> </template></template><template is="if" value="{{navCheck}}"><template case="true"> <div class="lyteEditorNavigationElement lyteEditorMainDiv" contenteditable="true"></div> </template></template> <lyte-modal lt-prop-show="{{lbind(ltPropFindShow)}}" lt-prop-id="findModal" id="findModal" lt-prop-freeze="false" lt-prop-width="300px" on-close="{{method(\'removeHighlight\')}}" lt-prop-offset="{&quot;top&quot;:&quot;0px&quot;,&quot;right&quot;:&quot;0px&quot;}"> <template is="registerYield" yield-name="modal"> <lyte-input lt-prop-appearance="box" lt-prop-id="findInput" on-value-change="{{method(\'onDataChange\',ltPropWordStyle)}}" lt-prop-placeholder="find" lt-prop-value="{{lbind(findInput)}}"> </lyte-input> <span class="lyteUiEditorFindUpArrow" lt-prop-id="up-arrow" onclick="{{action(\'upArrow\')}}"></span> <span class="lyteUiEditorFindDownArrow" lt-prop-id="down-arrow" onclick="{{action(\'downArrow\')}}"></span> <lyte-input lt-prop-appearance="box" lt-prop-id="replaceInput" lt-prop-placeholder="replace" lt-prop-value="{{lbind(replaceInput)}}"></lyte-input> <template is="if" value="{{expHandlers(expHandlers(findInput,\'!=\',&quot;&quot;),\'&amp;&amp;\',expHandlers(currentHighlight,\'!=\',undefined))}}"><template case="true"> <span class="lyte-find-count">{{expHandlers(currentHighlight,\'+\',1)}}/{{selectedRange.length}}</span> </template><template case="false"><template is="if" value="{{findInput}}"><template case="true"> <span class="lyte-find-count">0/0</span> </template></template></template></template> <lyte-button lt-prop-appearance="primary" lt-prop-id="replaceButton" onclick="{{action(\'replaceText\')}}"> <template is="registerYield" yield-name="text"> REPLACE </template> </lyte-button> <lyte-button lt-prop-appearance="primary" lt-prop-id="replaceAllButton" onclick="{{action(\'replaceAllText\')}}"> <template is="registerYield" yield-name="text"> REPLACE ALL </template> </lyte-button> </template> </lyte-modal> <lyte-popover lt-prop-focus-on-close="true" lt-prop-content-padding="" lt-prop-show-close-button="false" class="lyteEditorPopoverLink" lt-prop-scrollable="true" lt-prop-duration="{{undef}}" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-wrapper-class="lyteEditorPopover {{ltPropWrapperClass}}" lt-prop-show="{{lbind(anchorShow)}}" lt-prop-prevent-focus="true" lt-prop-boundary="{{ltPropAnchorPopBoundary}}" lt-prop-force-scroll="{{ltPropForcePopScroll}}" on-show="{{method(\'anchorShow\')}}" on-close="{{method(\'anchorClose\')}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="{{anchorPopClass}}"> <template is="if" value="{{expHandlers(ltPropAnchorAdvancedOption.showMail,\'||\',ltPropAnchorAdvancedOption.showTel)}}"><template case="true"> <div class="lyteEditorLinkType"> <lyte-radiobutton lt-prop-type="primary" lt-prop-checked="{{lbind(linkChecked)}}" lt-prop-name="primary" lt-prop-value="1" lt-prop-label="{{lyteUiEditorI18n(\'Link\')}}" on-checked="{{method(\'linkCheckBoxClick\',\'link\')}}"></lyte-radiobutton> <template is="if" value="{{ltPropAnchorAdvancedOption.showMail}}"><template case="true"> <lyte-radiobutton lt-prop-type="primary" lt-prop-name="primary" lt-prop-checked="{{lbind(emailChecked)}}" lt-prop-value="2" lt-prop-label="{{lyteUiEditorI18n(\'Email\')}}" on-checked="{{method(\'linkCheckBoxClick\',\'email\')}}"></lyte-radiobutton> </template></template> <template is="if" value="{{ltPropAnchorAdvancedOption.showTel}}"><template case="true"> <lyte-radiobutton lt-prop-type="primary" lt-prop-name="primary" lt-prop-checked="{{lbind(telephoneChecked)}}" lt-prop-value="3" lt-prop-label="{{lyteUiEditorI18n(\'Telephone\')}}" on-checked="{{method(\'linkCheckBoxClick\',\'telephone\')}}"></lyte-radiobutton> </template></template> </div> </template></template> <div class="lyteEditorLinkCreatePopup"> <div class="lyteEditorLinkTextInput lyteEditorLinkRow"> <span class="lyteEditorLinkTextLabel lyteEditorLinkLabel">{{lyteUiEditorI18n("Text")}}:</span> <template is="if" value="{{expHandlers(ltPropAnchorTextEdit,\'!\')}}"><template case="true"> <lyte-text class="lyteEditorLinkDisplayValue" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-value="{{anchorEdit.text}}"></lyte-text> </template></template> <lyte-input class="lyteEditorLinkUserInput" lt-prop-appearance="box" lt-prop-direction="horizontal" lt-prop-value="{{lbind(userInput)}}" lt-prop-update-delay="{{undef}}" onkeydown="{{action(\'check_key\',event)}}"></lyte-input> </div> <template is="if" value="{{expHandlers(currentAnchorType,\'==\',\'link\')}}"><template case="true"> <div class="lyteEditorLinkURLInputWrapper lyteEditorLinkRow"> <span class="lyteEditorLinkTextLabel lyteEditorLinkLabel">{{ltPropText.link}}:</span> <lyte-input class="lyteEditorLinkURLInput" lt-prop-appearance="box" lt-prop-direction="horizontal" lt-prop-value="{{lbind(anchorEdit.href)}}" lt-prop-update-delay="{{undef}}" lt-prop-focus="{{lbind(inputFocus)}}" lt-prop-focus-at-end="true" onkeydown="{{action(\'check_key\',event)}}"></lyte-input> </div> </template><template case="false"><template is="if" value="{{expHandlers(currentAnchorType,\'==\',\'email\')}}"><template case="true"> <div class="lyteEditorEmailId lyteEditorLinkRow"> <span class="lyteEditorMailIdLabel lyteEditorLinkLabel">{{lyteUiEditorI18n(\'Mail\')}}:</span> <lyte-input class="lyteEditorMailIdInput" lt-prop-appearance="box" lt-prop-direction="horizontal" lt-prop-value="{{lbind(anchorEdit.mailId)}}" lt-prop-update-delay="{{undef}}"></lyte-input> </div> <div class="lyteEditorEmailSubject lyteEditorLinkRow"> <span class="lyteEditorEmailSubjectLabel lyteEditorLinkLabel">{{lyteUiEditorI18n(\'Subject\')}}:</span> <lyte-input class="lyteEditorEmailSubjectInput" lt-prop-appearance="box" lt-prop-direction="horizontal" lt-prop-value="{{lbind(anchorEdit.mailSubject)}}" lt-prop-update-delay="{{undef}}"></lyte-input> </div> </template><template case="false"><template is="if" value="{{expHandlers(currentAnchorType,\'==\',\'telephone\')}}"><template case="true"> <div class="lyteEditorTelphone lyteEditorLinkRow"> <span class="lyteEditorTelphoneNumber lyteEditorLinkLabel">{{lyteUiEditorI18n(\'Telephone\')}}:</span> <lyte-input class="lyteEditorTelphoneNumberInput" lt-prop-appearance="box" lt-prop-direction="horizontal" lt-prop-value="{{lbind(anchorEdit.telephone)}}" lt-prop-update-delay="{{undef}}"></lyte-input> </div> </template></template></template></template></template></template> <template is="if" value="{{ltPropAnchorAdvancedOption.showTitle}}"><template case="true"> <div class="lyteEditorAnchorTittle lyteEditorLinkRow"> <span class="lyteEditorAnchorTittleLabel lyteEditorLinkLabel">{{lyteUiEditorI18n(\'Title\')}}:</span> <lyte-input class="lyteEditorAnchorTittleInput" lt-prop-appearance="box" lt-prop-direction="horizontal" lt-prop-value="{{lbind(anchorEdit.title)}}" lt-prop-update-delay="{{undef}}"></lyte-input> </div> </template></template> <lyte-yield yield-name="anchor-popover"></lyte-yield> <div class="lyteEditorFormWrapper"> <template is="if" value="{{expHandlers(ltPropCheckbox.prevent,\'!\')}}"><template case="true"><lyte-checkbox class="lyteEditorAnchorCheckbox" lt-prop="{{stringify(ltPropCheckbox)}}" lt-prop-checked="{{lbind(anchorEdit.newWindow)}}"></lyte-checkbox></template></template> <lyte-button lt-prop="{{ltPropButtonStyle}}" lt-prop-appearance="primary" onclick="{{action(\'applyLink\')}}" lt-prop-disabled="{{buttonDisable}}"> <template is="registerYield" yield-name="text"> {{ltPropText.link}} </template> </lyte-button> </div> </div> <div class="lyteEditorLinkViewPopup lyteEditorOldLink"> <div class="lyteEditorLinkTextInput lyteEditorLinkRow"> <span class="lyteEditorLinkTextLabel lyteEditorLinkLabel">{{lyteUiEditorI18n("Text")}}:</span> <lyte-text lt-prop-value="{{anchorEdit.text}}"></lyte-text> </div> <div class="lyteEditorLinkValueView lyteEditorLinkRow"> <span class="lyteEditorLinkTextLabel lyteEditorLinkLabel">{{ltPropText.link}}:</span> <a class="lyteEditorHrefClass" target="{{if(anchorEdit.newWindow,\'_blank\',\'_self\')}}" href="{{anchorEdit.href}}" onclick="{{action(\'anchorClick\',event)}}">{{anchorEdit.href}}</a> </div> <div class="lyteEditorLinkButtonWrap"> <lyte-button class="lyteEditorEditIcon" onclick="{{action(\'editLink\')}}" lt-prop="{{ltPropButtonStyle}}"> <template is="registerYield" yield-name="text"> {{ltPropText.edit}} </template> </lyte-button> <lyte-button class="lyteEditorRemoveIcon" onclick="{{action(\'removeWord\')}}" lt-prop="{{ltPropButtonStyle}}"> <template is="registerYield" yield-name="text"> {{ltPropText.remove}} </template> </lyte-button> </div> </div> </lyte-popover-content> </template> </lyte-popover> <template is="if" value="{{isMobile}}"><template case="true"> <lyte-popover class="lyteEditorMobileOptions" lt-prop-focus-on-close="true" lt-prop-content-padding="" lt-prop-duration="{{undef}}" lt-prop-placement="top topLeft topRight bottom" lt-prop-type="box" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-wrapper-class="lyteEditorMobileOptionsPopover {{if(isTextSelected,\'textSelected\',\'\')}} {{ltPropWrapperClass}}" lt-prop-offset="{{mobileOffset}}" lt-prop-show-close-button="false" lt-prop-prevent-focus="true"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <ul class="lyteEditorMobileOptionsUl"> <template is="for" items="{{ltPropMobileOptions}}" item="item" index="index"> <li class="lyteEditorMobileOptionsList {{item}}" onclick="{{action(\'mobileClick\',item)}}">{{ltPropText[item]}}</li> </template> </ul> </lyte-popover-content> </template> </lyte-popover> </template></template> <template is="if" value="{{ltPropTriggerCharacter}}"><template case="true"> <div class="lyteEditorMentionDropbox lyteEditorHide {{ltPropWrapperClass}}" onscroll="{{action(\'scroll\')}}"> <template is="for" items="{{triggersArray}}" item="item" index="index"> <lyte-editor-mention-item onclick="{{action(\'itemClick\',item,event,this)}}" class="{{if(item.group,\'lyteMentionsSubMenuContainer\')}} {{item.class}}" onmouseenter="{{action(\'mouseenter\',event,this)}}"> <template is="if" value="{{item.avatar}}"><template case="true"> <img class="lyteEditorMentionAvatar" src="{{item.avatar}}"> </template></template> <span class="lyteEditorMentionName" data-value="{{item.id}}">{{unescape(lyteUiEditorHighlight(item.name,searchValue))}}</span> <template is="if" value="{{item.email}}"><template case="true"> <span class="lyteEditorMentionEmail" data-value="{{item.id}}">{{unescape(lyteUiEditorHighlight(item.email,searchValue))}}</span> </template></template> </lyte-editor-mention-item> </template> </div> </template></template> <template is="if" value="{{ltPropMentionsSubMenu}}"><template case="true"> <lyte-menu lt-prop-freeze="false" class="lyteEditorMentionsSubMenu" lt-prop-event="click" lt-prop-position="right" lt-prop-yield="true" lt-prop-callout="true" lt-prop-query=".lyteMentionsSubMenuContainer"> <template is="registerYield" yield-name="yield"> <lyte-menu-body class="someClass"> <template is="for" items="{{mentionsGroup}}" item="item" index="index"> <lyte-menu-item data-value="{{item.name}}" onclick="{{action(\'itemClick\',item,event,this)}}" class="{{if(item.group,\'lyteMentionsSubMenuContainer\')}} {{item.class}}" onmouseenter="{{action(\'mouseenter\',event,this)}}"> <template is="if" value="{{item.avatar}}"><template case="true"> <img class="lyteEditorMentionAvatar" src="{{item.avatar}}"> </template></template> <span class="lyteEditorMentionName" data-value="{{item.id}}">{{unescape(lyteUiEditorHighlight(item.name,searchValue))}}</span> <template is="if" value="{{item.email}}"><template case="true"> <span class="lyteEditorMentionEmail" data-value="{{item.id}}">{{unescape(lyteUiEditorHighlight(item.email,searchValue))}}</span> </template></template> </lyte-menu-item> </template> </lyte-menu-body> </template> </lyte-menu> </template></template> <template is="if" value="{{ltPropPasteHandling}}"><template case="true"> <div class="lyteTextEditorPasteHandling lyteEditorHide lytePaste{{randomId}}"> <div class="lyteTextEditorPasteIcon"></div> <lyte-icon class="dropdown"></lyte-icon> </div> <lyte-menu lt-prop-yield="true" lt-prop-wrapper-class="lyteTextEditorPasteMenu {{ltPropWrapperClass}}" lt-prop-query=".lytePaste{{randomId}}" lt-prop-callout="false" on-before-close="{{method(\'beforeCloseMenu\')}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body> <lyte-menu-item onclick="{{action(\'pasteHandling\',\'source\')}}">{{lyteUiEditorI18n("Keep source formatting")}}</lyte-menu-item> <lyte-menu-item onclick="{{action(\'pasteHandling\',\'destination\')}}">{{lyteUiEditorI18n("Match destination formatting")}}</lyte-menu-item> <lyte-menu-item onclick="{{action(\'pasteHandling\',\'text\')}}">{{lyteUiEditorI18n("Text only")}}</lyte-menu-item> </lyte-menu-body> </template> </lyte-menu> </template></template><template is="if" value="{{resizeHandlerClass}}"><template case="true"> <div class="lyteEditorResizeHandler{{resizeHandlerClass}}" ontouchstart="{{action(\'resize_mousedown\',event)}}" onmousedown="{{action(\'resize_mousedown\',event)}}"></div> </template></template><template is="if" value="{{ltPropContextMenu}}"><template case="true"> <lyte-menu lt-prop-yield="true" lt-prop-wrapper-class="lyteTextEditorContextMenu lyteTextEditorMenu {{ltPropWrapperClass}}" lt-prop-query="{{tableQuery}}" lt-prop-event="contextmenu" on-before-open="{{method(\'beforeTableOpen\')}}" on-menu-click="{{method(\'tableSelect\')}}" on-close="{{method(\'menuclose\')}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body> <template is="for" items="{{tableMenu}}" item="item" index="index"> <lyte-menu-group class="lyteTextEditorContextMenuGroup {{item.class}}"> <template is="for" items="{{item.options}}" item="inner_item" index="index"> <lyte-menu-item lt-prop-title="{{if(expHandlers(expHandlers(inner_item.display,\'==\',\'Paste\'),\'&amp;&amp;\',expHandlers(inner_item.disabled,\'==\',\'true\')),ltPropDisabledPasteTooltip)}}" lt-prop-tooltip-config="{&quot;position&quot; : &quot;right&quot;}" data-value="{{inner_item.purpose}}" class="{{inner_item.class}}" lt-prop-disabled="{{inner_item.disabled}}">{{inner_item.display}}</lyte-menu-item> </template> </lyte-menu-group> </template> </lyte-menu-body> </template> </lyte-menu> </template></template><template is="if" value="{{ltPropImageOptions}}"><template case="true"> <lyte-menu lt-prop-yield="true" lt-prop-wrapper-class="lyteTextEditorImageMenu lyteTextEditorMenu {{ltPropWrapperClass}}" lt-prop-query="{{imageQuery}}" lt-prop-set-css="false" lt-prop-freeze="{{ltPropFreeze}}" on-menu-click="{{method(\'imageSelect\')}}" lt-prop-boundary="{{imageBoundary}}" on-open="{{method(\'imageMenuOpen\')}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body> <template is="for" items="{{ltPropImageMenuOptions}}" item="item" index="index"> <lyte-menu-item class="lyteEditorImageMenu{{item.value}}" data-value="{{item.value}}">{{item.name}}</lyte-menu-item> </template> </lyte-menu-body> </template> </lyte-menu> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[5]},{type:"attr",position:[7]},{type:"if",position:[7],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[8]},{type:"if",position:[8],cases:{true:{dynamicNodes:[]}},default:{}},{type:"attr",position:[10]},{type:"registerYield",position:[10,1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"attr",position:[5]},{type:"attr",position:[7]},{type:"componentDynamic",position:[7]},{type:"attr",position:[9]},{type:"if",position:[9],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"text",position:[1,2]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[]}},default:{}}]}},default:{}},{type:"attr",position:[11]},{type:"registerYield",position:[11,1],dynamicNodes:[]},{type:"componentDynamic",position:[11]},{type:"attr",position:[13]},{type:"registerYield",position:[13,1],dynamicNodes:[]},{type:"componentDynamic",position:[13]}]},{type:"componentDynamic",position:[10]},{type:"attr",position:[12]},{type:"registerYield",position:[12,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"text",position:[1,3,1,1,0]},{type:"attr",position:[1,3,1,3]},{type:"if",position:[1,3,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3,1,5]},{type:"componentDynamic",position:[1,3,1,5]},{type:"attr",position:[1,3,3]},{type:"if",position:[1,3,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]},{type:"text",position:[3,1,0]},{type:"attr",position:[3,3]},{type:"componentDynamic",position:[3,3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3,5]},{type:"if",position:[1,3,5],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]}},default:{}},{type:"insertYield",position:[1,3,7]},{type:"attr",position:[1,3,9,1]},{type:"if",position:[1,3,9,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"componentDynamic",position:[0]}]}},default:{}},{type:"attr",position:[1,3,9,3]},{type:"registerYield",position:[1,3,9,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1,3,9,3]},{type:"text",position:[1,5,1,1,0]},{type:"attr",position:[1,5,1,3]},{type:"componentDynamic",position:[1,5,1,3]},{type:"text",position:[1,5,3,1,0]},{type:"attr",position:[1,5,3,3]},{type:"text",position:[1,5,3,3,0]},{type:"attr",position:[1,5,5,1]},{type:"registerYield",position:[1,5,5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1,5,5,1]},{type:"attr",position:[1,5,5,3]},{type:"registerYield",position:[1,5,5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1,5,5,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[12]},{type:"attr",position:[14]},{type:"if",position:[14],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[16]},{type:"if",position:[16],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1]}]}]}},default:{}},{type:"attr",position:[18]},{type:"if",position:[18],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[20]},{type:"if",position:[20],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5]},{type:"text",position:[1,5,0]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}},{type:"attr",position:[21]},{type:"if",position:[21],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[22]},{type:"if",position:[22],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[23]},{type:"if",position:[23],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}],_templateAttributes:{type:"attr",position:[]},_observedAttributes:["ltPropWordStyle","ltPropParaStyle","ltPropTdStyle","ltPropTableStyle","ltPropImageStyle","ltPropFocus","ltPropListLevel","ltPropMaxUndoCount","ltPropShortcuts","ltPropWordStyleConversion","ltPropCaptionStyle","ltPropParaStyleConversion","ltPropParaChildConversion","ltPropOrderedList","ltPropUnOrderedList","ltPropListStyle","ltPropQueueUpdateTime","ltPropDefaultTable","ltPropTags","ltPropTableResize","ltPropImageResize","ltPropAnchorProperty","ltPropAnchorStyle","ltPropUpperCase","ltPropFontIncrease","ltPropMarginIncrease","ltPropMaxFont","ltPropMaxMargin","ltPropHeaderTags","ltPropTagConversion","ltPropTabSize","ltPropTriggerCharacter","ltPropRestrict","ltPropAllowedTags","ltPropAllowedStyles","ltPropCursorClass","ltPropTriggerDelay","ltPropPlaceholder","ltPropMultipleProperty","ltPropMobileOptions","ltPropText","ltPropButtonStyle","ltPropPasteHandling","ltPropDefaultPaste","ltPropCheckbox","ltPropMaxlength","ltPropCharacterCount","ltPropResize","ltPropWordAttributes","ltPropTableHandling","ltPropBlockquoteClasses","ltPropTooltipConfig","ltPropConvertInlineImages","ltPropGenerateId","ltPropPreventScroll","ltPropScrollToOptions","ltPropDisabled","ltPropReadonly","ltPropData","ltPropTabindex","ltPropRemoveDefaultStyle","ltPropPreventInitialScroll","ltPropBluePencil","ltPropParaToWordStyle","ltPropContextMenu","ltPropListVariable","ltPropImageOptions","ltPropSelectionDelay","ltPropAnchorPopBoundary","ltPropSourceDirection","ltPropUrlDetection","ltPropUrlDetectionOptions","ltPropClearParaProperties","ltPropClearParaOnFullSelection","ltPropAnchorTextEdit","ltPropForcePopScroll","ltPropWrapperClass","ltPropFreeze","ltPropRuler","ltPropCountNewLine","ltPropIgnoreMac","ltPropJoinStyle","ltPropReplaceLetters","ltPropReplaceStyle","ltPropConvertStyle","ltPropWordToParaStyle","ltPropReadFromClipboard","ltPropMentionsEditable","ltPropMobileView","ltPropDiacriticHandler","ltPropFindShow","ltPropCapitalizeWord","ltPropFindInput","ltPropMentionsSubMenu","ltPropWordSimpleConversion","ltPropDisabledPasteTooltip","ltPropFindAndReplace","ltPropCustomListColor","ltPropUnformattedPasteOption","ltPropAnchorAdvancedOption","ltPropImageMenuOptions","ltPropInlineImage","ltPropMentionsBgEditable","ltPropMentionsBg","ltPropDisableAnchorInMentions","ltPropAutoAdjustHeight","ltPropAnchorFollowup","ltPropAriaAttributes","ltPropDetectList","ltPropListMatchMap","isEditable","cursor","currentNode","undoqueue","_undoqueue","redoqueue","range","activeOverlay","selectedParagraph","selectedWords","alignQueue","topLevelElement","randomId","findWords","tabClass","wordLines","showPlaceholder","imageMapping","anchorEdit","isEditLink","undef","touchTest","isMobile","mobileOffset","userInput","anchorPopClass","anchorShow","textModified","inputFocus","isTextSelected","buttonDisable","resizeHandlerClass","searchValue","triggersArray","triggersArrayFinal","tableMenu","tableQuery","imageQuery","isMac","renderFrame","navCheck","isPanelOpen","imageBoundary","listMapping","highlightSpan","highlightInnerSpan","currentHighlight","convertToLineData","lineOffsetDataForFind","search","snippetUtils","spaceDetails","codeEditorLanguage","findInput","replaceInput","rulerClassArr","mentionsGroup","shortCutCheckObject","currentAnchorType","linkChecked","emailChecked","telephoneChecked","wrapImage","listRegex"],data:function(){return{ltPropWordStyle:Lyte.attr("object",{default:_lyteUiEditor.wordStyle}),ltPropParaStyle:Lyte.attr("object",{default:_lyteUiEditor.paraStyle}),ltPropTdStyle:Lyte.attr("object",{default:_lyteUiEditor.tdStyle}),ltPropTableStyle:Lyte.attr("object",{default:_lyteUiEditor.tableStyle}),ltPropImageStyle:Lyte.attr("object",{default:_lyteUiEditor.imageStyle}),ltPropFocus:Lyte.attr("boolean",{default:!1}),ltPropListLevel:Lyte.attr("number",{default:7}),ltPropMaxUndoCount:Lyte.attr("number",{default:void 0}),ltPropShortcuts:Lyte.attr("object",{default:_lyteUiEditor.shortcuts}),ltPropWordStyleConversion:Lyte.attr("object",{default:_lyteUiEditor.wordStyleConversion}),ltPropCaptionStyle:Lyte.attr("object",{default:_lyteUiEditor.captionStyle}),ltPropParaStyleConversion:Lyte.attr("object",{default:_lyteUiEditor.paraStyleConversion}),ltPropParaChildConversion:Lyte.attr("object",{default:_lyteUiEditor.paraChildConversion}),ltPropOrderedList:Lyte.attr("array",{default:_lyteUiEditor.orderedList}),ltPropUnOrderedList:Lyte.attr("array",{default:_lyteUiEditor.unOrderedList}),ltPropListStyle:Lyte.attr("object",{default:_lyteUiEditor.listStyle}),ltPropQueueUpdateTime:Lyte.attr("number",{default:250}),ltPropDefaultTable:Lyte.attr("object",{default:_lyteUiUtils.defaultTable}),ltPropTags:Lyte.attr("object",{default:{word:"lyte-word",paragraph:"lyte-paragraph",overlayHandle:"lyte-handle",table:"table",thead:"thead",tbody:"tbody",tr:"tr",th:"th",td:"td",overlay:"lyte-overlay",find:"lyte-find"}}),ltPropTableResize:Lyte.attr("boolean",{default:!0}),ltPropImageResize:Lyte.attr("boolean",{default:!0}),ltPropAnchorProperty:Lyte.attr("object",{default:_lyteUiEditor.anchorProperty}),ltPropAnchorStyle:Lyte.attr("object",{default:_lyteUiEditor.anchorStyle}),ltPropUpperCase:Lyte.attr("string",{default:void 0}),ltPropFontIncrease:Lyte.attr("number",{default:1}),ltPropMarginIncrease:Lyte.attr("number",{default:20}),ltPropMaxFont:Lyte.attr("number",{default:100}),ltPropMaxMargin:Lyte.attr("number"),ltPropHeaderTags:Lyte.attr("array",{default:_lyteUiEditor.headerTags}),ltPropTagConversion:Lyte.attr("object",{default:_lyteUiEditor.tagConversion}),ltPropTabSize:Lyte.attr("number",{default:3}),ltPropTriggerCharacter:Lyte.attr("string",{default:"@"}),ltPropRestrict:Lyte.attr("array",{default:["script","template"]}),ltPropAllowedTags:Lyte.attr("object",{default:{}}),ltPropAllowedStyles:Lyte.attr("array",{default:[]}),ltPropCursorClass:Lyte.attr("string",{default:""}),ltPropTriggerDelay:Lyte.attr("number",{default:250}),ltPropPlaceholder:Lyte.attr("string",{default:_lyteUiEditor.i18n("Add here ...")}),ltPropMultipleProperty:Lyte.attr("array",{default:["textDecoration","textDecorationLine"]}),ltPropMobileOptions:Lyte.attr("array",{default:["cut","copy","paste","selectWord","selectLine"]}),ltPropText:Lyte.attr("object",{default:{link:_lyteUiEditor.i18n("Link"),removeSelected:_lyteUiEditor.i18n("Remove selected"),edit:_lyteUiEditor.i18n("Edit"),remove:_lyteUiEditor.i18n("Remove"),cut:_lyteUiEditor.i18n("Cut"),copy:_lyteUiEditor.i18n("Copy"),paste:_lyteUiEditor.i18n("Paste"),selectWord:_lyteUiEditor.i18n("Select word"),selectLine:_lyteUiEditor.i18n("Select line")}}),ltPropButtonStyle:Lyte.attr("string",{default:'{"size" : "small"}'}),ltPropPasteHandling:Lyte.attr("boolean",{default:!1}),ltPropDefaultPaste:Lyte.attr("string"),ltPropCheckbox:Lyte.attr("object",{default:{label:_lyteUiEditor.i18n("Open in new window")}}),ltPropMaxlength:Lyte.attr("number",{default:1/0}),ltPropCharacterCount:Lyte.attr("number",{default:0}),ltPropResize:Lyte.attr("object",{default:{horizontal:!1,vertical:!0}}),ltPropWordAttributes:Lyte.attr("boolean",{default:!1}),ltPropTableHandling:Lyte.attr("boolean",{default:!1}),ltPropBlockquoteClasses:Lyte.attr("array",{default:_lyteUiEditor.blockquoteClasses}),ltPropTooltipConfig:Lyte.attr("string",{default:'{"position" : "bottom","showdelay" : 500}'}),ltPropConvertInlineImages:Lyte.attr("boolean",{default:!1}),ltPropGenerateId:Lyte.attr("boolean",{default:!1}),ltPropPreventScroll:Lyte.attr("boolean",{default:!1}),ltPropScrollToOptions:Lyte.attr("object",{default:{duration:400}}),ltPropDisabled:Lyte.attr("boolean",{default:!1}),ltPropReadonly:Lyte.attr("boolean",{default:!1}),ltPropData:Lyte.attr("string",{default:""}),ltPropTabindex:Lyte.attr("string",{default:"0"}),ltPropRemoveDefaultStyle:Lyte.attr("boolean",{default:!1}),ltPropPreventInitialScroll:Lyte.attr("boolean",{default:!1}),ltPropBluePencil:Lyte.attr("string",{default:""}),ltPropParaToWordStyle:Lyte.attr("array",{default:["color","fontSize","fontWeight","fontStyle"]}),ltPropContextMenu:Lyte.attr("boolean",{default:!1}),ltPropListVariable:Lyte.attr("boolean",{default:!0}),ltPropImageOptions:Lyte.attr("boolean",{default:!1}),ltPropSelectionDelay:Lyte.attr("number",{default:500}),ltPropAnchorPopBoundary:Lyte.attr("object",{default:{}}),ltPropSourceDirection:Lyte.attr("boolean",{default:!1}),ltPropUrlDetection:Lyte.attr("boolean",{default:!1}),ltPropUrlDetectionOptions:Lyte.attr("object",{default:{insert:!0,paste:!0,input:!0,output:!0,merge:!0}}),ltPropClearParaProperties:Lyte.attr("boolean",{default:!0}),ltPropClearParaOnFullSelection:Lyte.attr("boolean",{default:!1}),ltPropAnchorTextEdit:Lyte.attr("boolean",{default:!1}),ltPropForcePopScroll:Lyte.attr("boolean",{default:!1}),ltPropWrapperClass:Lyte.attr("string",{default:""}),ltPropFreeze:Lyte.attr("boolean",{default:!1}),ltPropRuler:Lyte.attr("boolean"),ltPropCountNewLine:Lyte.attr("boolean",{default:!1}),ltPropIgnoreMac:Lyte.attr("boolean",{default:!1}),ltPropJoinStyle:Lyte.attr("array",{default:[]}),ltPropReplaceLetters:Lyte.attr("object",{default:_lyteUiEditor.replaceLetters}),ltPropReplaceStyle:Lyte.attr("object",{default:{}}),ltPropConvertStyle:Lyte.attr("object"),ltPropWordToParaStyle:Lyte.attr("array",{default:["color"]}),ltPropReadFromClipboard:Lyte.attr("boolean",{default:!1}),ltPropMentionsEditable:Lyte.attr("boolean",{default:!0}),ltPropMobileView:Lyte.attr("boolean",{default:!1}),ltPropDiacriticHandler:Lyte.attr("boolean",{default:!1}),ltPropFindShow:Lyte.attr("boolean",{default:!1}),ltPropCapitalizeWord:Lyte.attr("boolean",{default:!1}),ltPropFindInput:Lyte.attr("boolean",{default:""}),ltPropMentionsSubMenu:Lyte.attr("boolean",{default:!1}),ltPropWordSimpleConversion:Lyte.attr("object",{default:_lyteUiEditor.wordSimpleConversion}),ltPropDisabledPasteTooltip:Lyte.attr("string",{default:""}),ltPropFindAndReplace:Lyte.attr("boolean",{default:!1}),ltPropCustomListColor:Lyte.attr("boolean",{default:!1}),ltPropUnformattedPasteOption:Lyte.attr("string",{default:void 0}),ltPropAnchorAdvancedOption:Lyte.attr("object",{default:{showMail:!1,showTel:!1,showTittle:!1}}),ltPropImageMenuOptions:Lyte.attr("array",{default:[{name:_lyteUiEditor.i18n("Small"),value:"small"},{name:_lyteUiEditor.i18n("Fit to screen"),value:"fit_to_screen"},{name:_lyteUiEditor.i18n("Actual size"),value:"actual_size"},{name:_lyteUiEditor.i18n("Remove"),value:"remove"}]}),ltPropInlineImage:Lyte.attr("boolean",{default:!1}),ltPropMentionsBgEditable:Lyte.attr("boolean",{default:!1}),ltPropMentionsBg:Lyte.attr("string",{default:"#e9f4ff"}),ltPropDisableAnchorInMentions:Lyte.attr("boolean",{default:!1}),ltPropAutoAdjustHeight:Lyte.attr("boolean",{default:!1}),ltPropAnchorFollowup:Lyte.attr("boolean",{default:!0}),ltPropAriaAttributes:Lyte.attr("object",{default:{}}),ltPropDetectList:Lyte.attr("boolean",{default:!1}),ltPropListMatchMap:Lyte.attr("object",{default:{disc:"disc",olDecimal:"olDecimal",olLowerAlpha:"olLowerAlpha",olLowerRoman:"olLowerRoman",olUpperAlpha:"olUpperAlpha",olUpperRoman:"olUpperRoman",olDecimalLeadingZero:"olDecimalLeadingZero"}}),isEditable:Lyte.attr("string",{default:"true"}),cursor:Lyte.attr("number",{default:0}),currentNode:Lyte.attr("object",{default:void 0}),undoqueue:Lyte.attr("array",{default:[]}),_undoqueue:Lyte.attr("array",{default:[]}),redoqueue:Lyte.attr("array",{default:[]}),range:Lyte.attr("object",{default:{left:0,right:0,startNode:void 0,endNode:void 0,isRange:!1}}),activeOverlay:Lyte.attr("array",{default:[]}),selectedParagraph:Lyte.attr("array",{default:[]}),selectedWords:Lyte.attr("array",{default:[]}),alignQueue:Lyte.attr("array",{default:[]}),topLevelElement:Lyte.attr("object"),randomId:Lyte.attr("string",{default:""}),findWords:Lyte.attr("array",{default:[]}),tabClass:Lyte.attr("string",{default:"lyteEditorTab"}),wordLines:Lyte.attr("array",{default:[]}),showPlaceholder:Lyte.attr("boolean",{default:!0}),imageMapping:Lyte.attr("object",{default:{}}),anchorEdit:Lyte.attr("object",{default:{text:"",href:"",newWindow:!0,mailId:"",mailSubject:"",telephone:"",title:""}}),isEditLink:Lyte.attr("boolean",{default:!1}),undef:Lyte.attr("boolean",{default:void 0}),touchTest:Lyte.attr("boolean",{default:!1}),isMobile:Lyte.attr("boolean",{default:!1}),mobileOffset:Lyte.attr("object",{default:{}}),userInput:Lyte.attr("string",{default:""}),anchorPopClass:Lyte.attr("string",{default:"lyteAnchorEditPopover"}),anchorShow:Lyte.attr("boolean",{default:!1}),textModified:Lyte.attr("boolean",{default:!1}),inputFocus:Lyte.attr("boolean",{default:!1}),isTextSelected:Lyte.attr("boolean",{default:!1}),buttonDisable:Lyte.attr("boolean",{default:!1}),resizeHandlerClass:Lyte.attr("string"),searchValue:Lyte.attr("string",{default:""}),triggersArray:Lyte.attr("array",{default:[]}),triggersArrayFinal:Lyte.attr("array",{default:[]}),tableMenu:Lyte.attr("array",{default:[{options:[{display:_lyteUiEditor.i18n("Cut"),purpose:"cut",class:"lyteEditorCut"},{display:_lyteUiEditor.i18n("Copy"),purpose:"copy",class:"lyteEditorCopy"},{display:_lyteUiEditor.i18n("Paste"),purpose:"paste",class:"lyteEditorPaste"},{display:_lyteUiEditor.i18n("Select all"),purpose:"selectall",class:"lyteEditorSelectAll"}]},{options:[{display:_lyteUiEditor.i18n("Undo"),purpose:"undo",class:"lyteEditorUndo"},{display:_lyteUiEditor.i18n("Redo"),purpose:"redo",class:"lyteEditorRedo"}]}]}),tableQuery:Lyte.attr("string"),imageQuery:Lyte.attr("string"),isMac:Lyte.attr("boolean",{default:!0}),renderFrame:Lyte.attr("boolean",{default:!1}),navCheck:Lyte.attr("boolean",{default:!1}),isPanelOpen:Lyte.attr("boolean",{default:!1}),imageBoundary:Lyte.attr("object",{default:{}}),listMapping:Lyte.attr("object",{default:{}}),highlightSpan:Lyte.attr("array",{default:[]}),highlightInnerSpan:Lyte.attr("array",{default:[]}),currentHighlight:Lyte.attr("number",{default:void 0}),convertToLineData:Lyte.attr("object",{default:{node:void 0,data:void 0}}),lineOffsetDataForFind:Lyte.attr("array",{default:[]}),search:Lyte.attr("string",{default:void 0}),snippetUtils:Lyte.attr("object",{default:{lyteTagNameCls:{color:"rgb(0, 68, 255)"},lytePunctuationCls:{color:"rgb(0, 68, 255)"},lyteContentCls:{color:"rgb(51, 51, 51)"},lyteAttributeEqualsCls:{color:"rgb(128, 0, 128)"},lyteAttributeNameCls:{color:"rgb(128, 0, 128)"},lyteAttributeValueCls:{color:"rgb(0, 98, 3)"},lyteEntityCls:{color:"rgb(255, 47, 47)"},lyteCSSComment:{color:"rgb(115, 115, 115)"},lyteCommentCls:{color:"rgb(115, 115, 115)"},lyteCSSRuleName:{color:"rgb(51, 51, 51)"},lyteCSSPunctuation:{color:"rgb(51, 51, 51)"},lyteCSSValueFunction:{color:"rgb(178, 74, 0)"},lyteCSSRuleValue:{color:"rgb(178, 74, 0)"},lyteCSSCombinator:{color:"rgb(255, 0, 255)"},lyteCSSAttributeName:{color:"rgb(128, 0, 128)"},lyteCSSImportant:{color:"rgb(0, 68, 255)"},lyteCSSAttributeValue:{color:"rgb(0, 68, 255)"},lyteCSSColorValue:{color:"orange"},lyteJSKeyword:{color:"rgb(128, 0, 128)"},lyteJSIndentifier:{color:"rgb(51, 51, 51)"},lyteJSOperator:{color:"rgb(128, 0, 128)"},lyteJSPunctuator:{color:"rgb(26, 26, 26)"},lyteJSNumber:{color:"rgb(178, 74, 0)"},lyteJSStringLiteral:{color:"rgb(178, 74, 0)"},lyteJSComment:{color:"rgb(95, 87, 87)"},lyteJSRegex:{color:"rgb(0, 180, 131)"},lyteJSBoolean:{color:"rgb(108, 88, 255)"},lyteJSFunction:{color:"rgb(0, 98, 3)"},lyteJSNull:{color:"rgb(108, 88, 255)"},lyteJSUndefined:{color:"rgb(108, 88, 255)"}}}),spaceDetails:Lyte.attr("array",{default:void 0}),codeEditorLanguage:Lyte.attr("string",{default:void 0}),findInput:Lyte.attr("string",{default:""}),replaceInput:Lyte.attr("string",{default:""}),rulerClassArr:Lyte.attr("array",{default:[]}),mentionsGroup:Lyte.attr("array",{default:[]}),shortCutCheckObject:Lyte.attr("array",{default:["KeyU"]}),currentAnchorType:Lyte.attr("string",{default:"link"}),linkChecked:Lyte.attr("boolean",{default:!0}),emailChecked:Lyte.attr("boolean",{default:!1}),telephoneChecked:Lyte.attr("boolean",{default:!1}),wrapImage:Lyte.attr("boolean",{default:!1}),listRegex:Lyte.attr("object",{default:{olDecimal:/\b([1-9]\d*)\./,olLowerAlpha:/^[a-z]+\. /,olUpperAlpha:/^[A-Z]+\. /,olLowerRoman:/^m{0,3}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})\. /,olUpperRoman:/^M{0,3}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\. /,olDecimalLeadingZero:/^(0[1-9]|\d{2,})\. /,disc:/^\* /,hyphen:/^- /}})}},get_dir:function(t,e){var i;return(i=e?t.style.direction:t.parentNode.style.direction)?"rtl"==i:this._dir},anch_obs:function(t){var e=this.$node.panel;e&&e["call_"+(t.newValue?"show":"hide")]()}.observes("anchorShow"),aria_obs:function(){var t=this.data.ltPropAriaAttributes;if(t)for(var e in t)this._editdiv.setAttribute(e,t[e])}.observes("ltPropAriaAttributes").on("didConnect"),anchor_cls_obs:function(){var t=["lyteAnchorEditPopover"],e=this.data;e.isEditLink&&t.push("lytePopoverLinkEditMode"),e.range.isRange&&(t.push("lyteTextSelected"),e.ltPropAnchorTextEdit?t.push("lyteAnchorTextEdit"):t.push("lyteAnchorEditInputHidden")),this.setData("anchorPopClass",t.join(" "))}.observes("isEditLink","range.isRange","range"),show_obs:function(){var t=this.data.showPlaceholder;$L(this.__place).css("display",t?"":"none")}.observes("showPlaceholder").on("didConnect"),place_obs:function(t){var e=t.oldValue,i=t.newValue,a=this.__place;e&&i?$L(a).text(i):e?(this.setData("showPlaceholder",!1),a.remove(),delete this.__place):i&&(this.create_placeholder(i),this.setData("showPlaceholder",!0))}.observes("ltPropPlaceholder"),create_placeholder:function(t){this.append(this.$node,this.__place=$L(this.create("div")).css("display","none").addClass("lyteEditorPlaceholderDiv").text(t).get(0))},onetimeSetup:function(){this.__newparas=[];var t=function(t){return this.$node.getElementsByClassName(t)[0]}.bind(this),e="lyteEditor",i=this.data,a=i.ltPropPlaceholder,o=this._maindiv=t(e+"MainDiv");this._editdiv=t(e+"ContentEditable"),this._navigation=t(e+"NavigationElement"),this._cursor=$L(this.create("span")).addClass(e+"Cursor",this.data.ltPropCursorClass).get(0),this._canvas=this.$node.getElementsByTagName("canvas")[0].getContext("2d"),a&&this.create_placeholder(a),this._popover=t(e+"PopoverLink"),this._mobilepop=t(e+"MobileOptions"),this._pastediv=t("lyteTextEditorPasteHandling"),this._mouseup=this.mouseup.bind(this),this._mousemove=this.mousemove.bind(this),this._emojiRegex=/([\uD800-\uDBFF][\uDC00-\uDFFF])/i,this.__overall_emoji=/[\u{1f300}-\u{1f5ff}\u{1f900}-\u{1f9ff}\u{1f600}-\u{1f64f}\u{1f680}-\u{1f6ff}\u{2600}-\u{26ff}\u{2700}-\u{27bf}\u{1f1e6}-\u{1f1ff}\u{1f191}-\u{1f251}\u{1f004}\u{1f0cf}\u{1f170}-\u{1f171}\u{1f17e}-\u{1f17f}\u{1f18e}\u{3030}\u{2b50}\u{2b55}\u{2934}-\u{2935}\u{2b05}-\u{2b07}\u{2b1b}-\u{2b1c}\u{3297}\u{3299}\u{303d}\u{00a9}\u{00ae}\u{2122}\u{23f3}\u{24c2}\u{23e9}-\u{23ef}\u{25b6}\u{23f8}-\u{23fa}]/u,this.setUpRandomId(o),this.append(o,this._cursor),i.ltPropBluePencil&&$L(o).addClass("lyteEditorContentEditableMainDiv"),i.ltPropMentionsBgEditable&&$L(o).addClass("lyteEditorMentionWordDynamicBg"),i.isMobile&&o.classList.add("lyteTextEditorMobile"),$L(o).data({data:[],list:[]}),this.setData("randomId",this.randomId()),this.$node.focus=function(t){var e=this.data;if(!e.ltPropDisabled){this._editdiv.focus({preventScroll:!0});this.__compose;t||(e.range.isRange?(this._ignoreRangeCheck=!0,this.setRange(),this._ignoreRangeCheck=!1):this.setCursor(e.currentNode,e.cursor),$L.fastdom.measure(function(){$L.fastdom.mutate(function(){this.scrollIntoView(e.currentNode,e.cursor)}.bind(this))}.bind(this)))}}.bind(this),this.$node.blur=function(){this.data.ltPropDisabled||this._editdiv.blur()}.bind(this),/rv:11/.test(navigator.userAgent)&&this._editdiv.addEventListener("textinput",this.actions.input.bind(this)),this.$node.getHTML=function(t,e){var i=this.stringFromData(this.getJSON());return t?_lyteUiEditor.convert_simple(this,i,e):i}.bind(this),this.$node.getText=function(){return this.component.convert_html_to_txt(this.getHTML())},this.$node.getTextFromData=function(t){return this.stringFromData(t)}.bind(this),this.$node.findIndex=function(){return this.findIndex(arguments[0],arguments[1],!0)}.bind(this),["getMentions","nextFind","clear","previousFind","find","insertJSON","insertHTML","getJSON","resetQueue","undo","redo","getProp","getCursor","getRange","removeLetters","getCurrentNode","convertHtmlToData","insertTextInWord","showSuggestion","removeSuggestion","insertHr"].forEach(function(t){var e=this[t];e&&(this.$node[t]=e.bind(this))}.bind(this)),this._popover.ltProp("originElem",".popOrigin"+this.data.randomId),this.data.ltPropTriggerCharacter&&this.setup_mention(),this.setData("tableQuery","#"+o.id),this.setData("imageQuery","#"+o.id+" .lyteEditorImage"),$L.fastdom.mutate(function(){this.disable_check(),this.disable_check("Readonly")}.bind(this))},getCursor:function(){return this.data.cursor},getCurrentNode:function(){return this.data.currentNode},getRange:function(){return this.data.range},getProp:function(t,e){var i=e.style[t];return(!i||"fontSize"==t&&/em/.test(i))&&(i=this.comp_style(e)[t]),i},comp_style:function(t){return window.getComputedStyle(t)},clear:function(){this.selectAll();var t=this.data.range.isRange;this.backspace(),t&&this.backspace()},didConnect:function(){this.onetimeSetup(),this.initialParagraph(),this.data.ltPropDiacriticHandler&&this._editdiv.addEventListener("beforeinput",this.beforeInput.bind(this)),this._defaultPasteOption=this.data.ltPropDefaultPaste},data_obs:function(){var t,e=this.data,i=e.ltPropData,a="JSON",o=this.$node;if(i){try{i.indexOf("[")?(a="HTML",t=i):t=JSON.parse(i)}catch(e){a="HTML",t=i}i&&(o["insert"+a](t),$L.fastdom.mutate(function(){var t=o.panel;o.resetQueue(),t&&(t.$node.refresh(),t.undoRedo(e.undoqueue,e.redoqueue))}.bind(this)))}}.observes("ltPropData").on("didConnect"),didDestroy:function(){this.data.imageMapping={},delete this.__newparas,this.clear_time(),["_editdiv","_maindiv","_cursor","_popover","__place"].forEach(function(t){delete this[t]}.bind(this))},execute:function(t){if(this.getMethods(t))return this.executeMethod.apply(this,arguments)},resize_obs:function(){var t=this.data.ltPropResize,e="";t.horizontal&&(e+=" lyteHorizontalResize"),t.vertical&&(e+=" lyteVerticalResize"),this.setData("resizeHandlerClass",e)}.observes("ltPropResize","ltPropResize.{}").on("init"),init:function(){this.execute("beforeRender",this.$node),this._dir=_lyteUiUtils.getRTL(),this._sanitizer=Lyte.Security.createSanitizer({GLOBAL_TAGS:["mention_div"],GLOBAL_ATTRIBUTES:["editable","module","editor-language","display-type"],ADD_URI_SAFE_ATTR:["style"],ALLOWED_STYLE:"ALL",STYLE_VALIDATION:!1}),this.setData({isMac:(this._isMac=/Macintosh/i.test(navigator.userAgent))&&!this.data.ltPropIgnoreMac,isMobile:_lyteUiUtils.isMobile||this.data.touchTest});var t=this.data.ltPropReplaceStyle,e=this.data.ltPropConvertStyle;if(!e)for(var i in e=this.data.ltPropConvertStyle={},t){var a=t[i];e[a.name]={value:a.replaceValue,name:i,replaceValue:a.value,fallBackValue:a.fallBackValue}}},didConnectObs:function(){this.execute("afterRender",this.$node)}.on("didConnect"),focusObs:function(){var t="ltPropFocus";this.data[t]&&(this.$node.focus(),this.setData(t,!1))}.observes("ltPropFocus").on("didConnect"),randomId:_lyteUiEditor.randomId,disable_check:function(t){var e,i="remove",a="true",o=t||"Disabled",n="ltProp"+o,r=this.data,s=this.$node,l=s.panel;r[n]&&(i="add"),r.ltPropDisabled&&(a="false"),$L(s)[e=i+"Class"]("lyteTextEditor"+o),l&&$L(l.$node)[e]("lyteEditorPanel"+o),this.setData("isEditable",a)},dis_obs:function(){this.disable_check()}.observes("ltPropDisabled"),read_obs:function(){this.disable_check("Readonly")}.observes("ltPropReadonly"),setUpRandomId:function(t,e){e=e||this.randomId(),$L(t).addClass("listHolderElement").data({randomId:e}).attr("id",e)},emptyWordData:function(t){return{details:{},style:t?{}:this.extend(this.data.ltPropWordStyle),classList:[],text:"",tag:this.getTag("word")}},emptyParaData:function(){return{data:[this.emptyWordData()],details:{},style:this.extend(this.data.ltPropParaStyle),classList:[],attr:{},tag:this.getTag("paragraph")}},initialParagraph:function(){var t=this.emptyParaData(),e=this.render(t);t=this.data;this.pushParagraph(e,this._maindiv,0),this.setData("currentNode",this.getFirstWordInPara(e)),this.setData("cursor",0);var i=t.currentNode;t.selectedWords.push({node:i,left:0,right:0}),t.selectedParagraph.push(i.parentNode),this.resetQueue()},create:function(t){return document.createElement(t)},append:function(t,e){var i=!(t||{}).tagName;return t.get&&i&&(t=t.get(0)),e.get&&i&&(e=e.get(0)),t.appendChild(e)},extend:function(t,e){return $L.extend(!0,e||{},t)},getTag:function(t){return this.data.ltPropTags[t]||t},render:function(t){var e=$L(this.renderNode(t.tag,t)),i=t.data||[],a=[];return i.forEach(function(t){var i=this.render(t);a.push(i),this.append(e,i)}.bind(this)),e.data({data:t,list:a}),e.get(0)},renderNode:function(t,e){var i=$L(this.create(t)),a=i.get(0);if(e){var o=e.style||{},n="--tablevel",r="--lyte-texteditor-li-color",s=o[r],l=e.randomId,d=o[n],c=e.attr||{};this.data.ltPropGenerateId&&(e.attr=c,c.id=this.isUndo()?c.id:this.randomId(!0),l&&(l=c.id)),"bidi-override"!=o.unicodeBidi&&delete o.unicodeBidi,i.addClass(e.classList||[]).css(o).attr(c),"false"==c.editable&&i.addClass("lyteReadonlyNode"),s&&a.style.setProperty(r,s),d&&a.style.setProperty(n,d),i.data("data",e);var p=e.details||{},h=p.anchor,u=e.text;if(null!=u&&(a.textContent=u.replace(/ /g," ")),["rowSpan","colSpan","src","alt"].forEach((function(t){var e=p[t];e&&(a[t]=e)})),h&&h.href&&this.anchor_tooltip(i,h),p.resize){var m=this.extend(p.arguments);"table"==m.component&&(m.onBeforeSelect=this.tableselect.bind(this),m.onDrop=this.tabledrop.bind(this),m.onRelease=this.tableRelease.bind(this)),i.enableResize(m)}if("table"==p.type){i.addClass("lyteEditorTableWord");var f=$L(document.createElement("span")).addClass("lyteEditorTableSelectspan").click(this.selectTable.bind(this));this.append(a,f.get(0))}l&&this.setUpRandomId(i,l)}return a},isUndo:function(){return this._undomode},pushParagraph:function(t,e,i){var a=$L(e),o=a.data("list"),n=a.data("data"),r=$L(t).data("data"),s=this.isUndo(),l=Lyte.Component;null==i&&(i=o.length),this.data.ltPropCountNewLine&&this.update_count_in_insert(r,i,o.length),o.splice(i,0,t),(n.data||n).splice(i,0,r),1==o.length?this.append(e,t):0==i?l.insertBefore(o[1],t):l.insertAfter(o[i-1],t),s||(this.pushToQueue({operation:"paragraphCreate",index:i,id:a.data("randomId"),data:r}),this.tabCheck(e),this.blockquote_check(a.get(0)))},call_queue_push:function(t,e){t=t.constructor==Array?t:[t];var i=this,a="onQueuePush";this.getMethods(a)&&t.forEach((function(t){"meta"!=t.type&&i.executeMethod(a,t,e,i.$node)}))},pushToQueue:function(t){var e=this.data,i=e._undoqueue,a=e.ltPropQueueUpdateTime,o=e.ltPropMaxUndoCount,n=e.undoqueue,r=e.redoqueue,s=_lyteUiEditor.operations.call(this,t);if(s){if(e.ltPropAutoAdjustHeight&&this.update_height(),this.call_queue_push(s),this._pushToPrevious&&/*!_undoqueue.length &&*/n.length&&!r.length)return i.push.apply(i,s.constructor==Array?s:[s]),Lyte.arrayUtils(this.last(n),"push",i.splice(0)),this.callQueueUpdate();Lyte.arrayUtils(i,"push",s),clearTimeout(this._undotime),this._undotime=setTimeout(function(){if(delete this._undotime,i.length){var t=_lyteUiEditor.fiterOut_meta(i.splice(0));if(2==t.length){var e=t[0],a=t[1];if(e.value==a.value&&e.type==a.type&&e.operations==a.operations)return}n.push(t),r.splice(0);var s=n.length;null!=o&&s>o&&n.splice(0,s-o),this.callQueueUpdate()}}.bind(this),a)}},clearVariables:function(){delete this._widthMaintain},clear_time:function(){["_focus","_blur","_undotime","__emoji_compose"].forEach(function(t){clearTimeout(this[t])}.bind(this))},check_is_empty:function(){0==($L(this._maindiv).data("list")||[]).length&&this.initialParagraph()},check_range_reset:function(t){var e;this.data.selectedParagraph.every((function(i){return!(e=t.contains(i))})),e||this.resetRange(!0)},call_menu_before_open:function(t){var e="onBeforeMenuOpen";return this.getMethods(e)&&0==this.executeMethod(e,t,this.$node)},before_menu_open:function(t,e,i){if(!i&&this.call_menu_before_open(e))return!1;var a,o=this.data,n=o.range.isRange,r=e.target,s=-1,l=Lyte.objectUtils;if(i=i||[],!n&&"img"==this.getTagName(r))return!1;o.tableMenu.forEach((function(t,e){-1==i.indexOf(t)?(t.options.forEach((function(t){var e,i=t.purpose;switch(i){case"undo":e=!o.undoqueue.length;break;case"redo":e=!o.redoqueue.length;break;case"cut":case"copy":e=!n;break;case"paste":e="firefox"==_lyteUiUtils.getBrowser()}var a="lyteEditor"+_lyteUiUtils.capitalize(i);e&&(a+=" lyteEditorMenuDisabled"),l(t,"add","class",a),l(t,"add","disabled",(e||!1).toString())})),l(t,"add","class",""),s<e&&(s=e,a=t)):/lyteEditorOptionLast/i.test(t.class)&&s<e&&(s=e,a=t)})),a&&l(a,"add","class",(a.class+" lyteEditorOptionLast").trim())},table_menu_select:function(t){var e,i,a;switch(t){case"undo":case"redo":e=t;break;case"selectall":e="selectAll";break;case"cut":i=a=!0;break;case"copy":i=!0;break;case"paste":this.clipboardPaste()}e&&this[e].apply(this,[]),i&&_lyteUiUtils.copyFrmEvt(this.getSelectedText(),void 0,this.$node,function(){a&&this.removeSelected(),this.common_positioning(),this.$node.focus()}.bind(this))},methods:{menuclose:function(){delete this.__cell,delete this.__img;var t="onMenuClose",e=Array.from(arguments);e.push(this.$node),e.unshift(t),this.getMethods(t)&&this.executeMethod.apply(this,e)},beforeTableOpen:function(t,e){return this.before_menu_open(t,e)},tableSelect:function(t){this.table_menu_select(t)},beforeCloseMenu:function(t,e){var i=e.target;if(this._pastediv.contains(i))return!1;t.component.childComp.contains(i)||this.hide_paste_div()},onDataChange:function(t,e){let i=this.data.findInput;null!=i&&this.find(i),this.data.showFindModal=!0},removeHighlight:function(){let t=this.getData("highlightSpan");if(0!=t.length)for(let e=0;e<t.length;e++)t[e].remove();let e=this.getData("highlightInnerSpan");if(0!=e.length)for(let t=0;t<e.length;t++)e[t].remove();this.setData("findInput",void 0)},linkCheckBoxClick:function(t){this.setData("currentAnchorType",t)}},focus_blur:function(t,e,i,a){this[t]=setTimeout(function(){delete this[t],$L(this.$node)[e]("lyteEditorFocused")}.bind(this)),this.execute(i,a,this.$node)},copy_evt:function(t){this.__evt=t},remove_evt:function(){delete this.__evt},is_common_focus:function(t){var e=t.relatedTarget;return e==this._maindiv||e==this._editdiv},beforeInput:function(t){let e=window.getSelection().getRangeAt(0);t.isComposing||e.startOffset==e.endOffset?"insertReplacementText"!=t.inputType&&(this.toArray(t.target.childNodes).forEach((function(t){t.tagName?t.remove():t.nodeValue&&(t.nodeValue="")})),this.createRange(t.target)):this.data.range.isRange?this.removeSelected():this.removeLetters(e.endOffset-e.startOffset)},createRange:function(t,e,i){if(t){var a,o,n=document.createRange(),r=window.getSelection();r.removeAllRanges(),null!=i?(a=Math.min(e,i),o=Math.max(e,i)):(a=e,o=e),n.setStart(t,a),n.setEnd(t,o),r.addRange(n)}},actions:{frameLoad:function(t){this._iframe=t,this.__cache={},t.contentDocument.body.style.whiteSpace="nowrap"},focus:function(t){t.relatedTarget;this.__ignore_focusblur||this.data.ltPropDisabled||(t.target!=this._maindiv||this.__down_evt&&!this.data.isMobile&&!this.data.touchTest||setTimeout(function(){this.$node.focus()}.bind(this),100),this.is_common_focus(t)||(this.check_is_empty(),this.focus_blur("_focus","addClass","onFocus",t)))},blur:function(t){this.__ignore_focusblur||this.is_common_focus(t)||this.focus_blur("_blur","removeClass","onBlur",t)},click:function(t){var e=this.data,i=t.target;e.ltPropDisabled||e.ltPropReadonly||(this._maindiv.contains(i)?(this.hide_paste_div(),$L(i).hasClass("lyteEditorTableSelectspan")||this.nonFocusClick(t)):e.ltPropBluePencil&&i.closest(".zbp-badge-container")&&this.before_edit_open())},input:function(t,e){if(this._maindiv.classList.add("lyteEditorUserTyping"),clearTimeout(this._keydown),this._keydown=setTimeout(function(){this._maindiv.classList.remove("lyteEditorUserTyping")}.bind(this),300),(!/insertFromComposition/i.test(t.inputType)||"safari"!==_lyteUiUtils.getBrowser())&&(!/insertcompositiontext/i.test(t.inputType)||this.data.ltPropMobileView)){if(/deleteCompositionText/i.test(t.inputType))return this.clear_composition();var i="insertFromPaste"==t.inputType&&!this._pastePrevent;if(this.data.ltPropReadonly||i)return i&&(this._maindiv.innerHTML=this._editdiv.innerHTML,this.__blue_ignore=!0,this.reset_entire()),this.toArray(e.childNodes).forEach((function(t){t.remove()}));this.copy_evt(t),this.clearVariables(),this.processInput(e||t.target,t),this.remove_evt()}},mousedown:function(t){this.clearVariables(),2==t.buttons||$L(t.target).hasClass("lyteEditorTableSelectspan")||(this.copy_evt(t),this.mousedown(t),this.remove_evt(t),(this.data.isMobile||this.data.touchTest)&&this.nonFocusClick(t))},mainClick:function(){this.__down_evt&&this.mousedown(this.__down_evt,!0)},keydown:function(t){this.copy_evt(t),this.keydown(t),this.remove_evt()},paste:function(t){let e=this.data.ltPropUnformattedPasteOption;if(e&&(this.data.ltPropDefaultPaste=1==t.clipboardData.types.length&&t.clipboardData.types[0]==["text/plain"]?e:this._defaultPasteOption),null!=this.__empty_pencil_time)return!1;var i=this.data;i.ltPropDisabled||i.ltPropReadonly?t.preventDefault():(this.copy_evt(t),this.paste(t),this.remove_evt())},cut:function(t){var e=this.data;this.copy_evt(t),this.copyToClip(t),!e.ltPropReadonly&&!e.ltPropDisabled&&this.removeSelected(),this.remove_evt()},copy:function(t){this.copy_evt(t),this.copyToClip(t),this.data.range.isRange&&this.setRange(),this.remove_evt()},mobileClick:async function(t){if(this._mobilepop.ltProp("show",!1),this.$node.focus(),/^cut|copy$/i.test(t))document.execCommand(t);else if("paste"==t){await navigator.permissions.query({name:"clipboard-read"});this.clipboardPaste()}else this[t]()},pasteHandling:function(t){var e=this.data;if(!e.ltPropDisabled&&!e.ltPropReadonly){if(t!=this._prev_paste_state){this.undo();var i=this;$L.fastdom.measure((function(){$L.fastdom.mutate((function(){i._proceedPaste(i[{destination:"convertTextToDestination",text:"convertTextToPlainData",source:"convertHtmlToData"}[t]](i.__pasted_text)),i._prev_paste_state=t}))}))}return!1}},compositionStart:function(t){t.data&&this.data.ltPropDiacriticHandler&&!this.data.ltPropMobileView&&this.backspace()},compositionUpdate:function(t){this.data.ltPropMobileView||this.update_composition(t.data)},compositionEnd:function(t){this.data.ltPropMobileView||this.insert_and_clear(t)},upArrow:function(){let t=$L(this.$node).find(".lyteUiEditorFindHighlight"),e=$L(this.$node).find(`.lyteUiEdtorFindPartialHighlight.select${this.data.currentHighlight+1}`),i=this.data.selectedRange,a=this.data.currentHighlight;if(null!=a){for(let t=0;t<e.length;t++)e[t].classList.remove("current");t[this.data.currentHighlight].classList.remove("current"),0==this.data.currentHighlight?this.setData("currentHighlight",t.length-1):this.setData("currentHighlight",this.data.currentHighlight-1);let o=$L(this.$node).find(`.lyteUiEdtorFindPartialHighlight.select${this.data.currentHighlight+1}`);for(let t=0;t<o.length;t++)o[t].classList.add("current");this.setData("currentNode",i[this.data.currentHighlight].startNode),this.setCursor(i[a].startNode,i[this.data.currentHighlight].right),t[this.data.currentHighlight].classList.add("current")}},downArrow:function(){let t=$L(this.$node).find(".lyteUiEditorFindHighlight"),e=$L(this.$node).find(`.lyteUiEdtorFindPartialHighlight.select${this.data.currentHighlight+1}`),i=this.data.selectedRange;if(null!=this.data.currentHighlight){t[this.data.currentHighlight].classList.remove("current");for(let t=0;t<e.length;t++)e[t].classList.remove("current");this.data.currentHighlight==t.length-1?this.setData("currentHighlight",0):this.setData("currentHighlight",this.data.currentHighlight+1);let a=$L(this.$node).find(`.lyteUiEdtorFindPartialHighlight.select${this.data.currentHighlight+1}`);for(let t=0;t<a.length;t++)a[t].classList.add("current");this.setData("currentNode",i[this.data.currentHighlight].startNode),this.setCursor(i[this.data.currentHighlight].startNode,i[this.data.currentHighlight].right),t[this.data.currentHighlight].classList.add("current")}},replaceText:function(){let t=this.data.replaceInput;this.replaceCurrentText(this.getData("currentHighlight"),t)},replaceAllText:function(){let t=this.data.replaceInput;this.replaceAllText(t)}},changeHighlightData:function(t){this.setData("currentHighlight",t)},removeLineOffsetData:function(){this.setData("lineOffsetDataForFind",[])},callFind:function(){this.setData("convertToLineData",{node:void 0,data:void 0});let t=this.data.findInput;t&&this.find(t)},mousedown:function(t,e){if(!this._count){var i,a=t;if(t.touches){if(t.touches.length>1)return;i=!0,t=t.touches[0]}var o=t.target,n=!0;if(!$L(o).hasClass("lyteResize")){if(o!=this._maindiv||e||(n=!1,this.__down_evt=a),this.isSection(o))var r=$L(o).find("lyte-word").get(0);var s=this.check4nested(this.getNodeFromEvent(t,r)),l=t.shiftKey,d="addEventListener";if(s&&n){var c=this.data.range,p=($L(s).hasClass("lyteReadonlyNode"),this.getCursorPosition(s,t));this.getTagName(o)==this.getTag("overlayHandle")?(c.startNode==s&&c.left==p&&(c.startNode=c.endNode,c.left=c.right),c.endNode=s,c.right=p,this._touchselect=!0):l?(Lyte.objectUtils(c,"add","isRange",!(c.startNode==s&&p==c.left)),c.endNode=s,c.right=p,c.isRange&&this.setRange()):(this.setData("currentNode",s),this.setCursor(s,p),this.resetRange(!0))}e||(t.__ignore?t.stopPropagation():(document[d](i?"touchmove":"mousemove",this._mousemove,!0),document[d](i?"touchend":"mouseup",this._mouseup,!0),this._mup=!0,this._cy=t.clientY,(i||this.data.touchTest)&&($L(this.$node).addClass("lyteEditorTouchStart","lyteEditorCursorVisible"),this._longpresstime=setTimeout(function(){delete this._longpresstime}.bind(this),500))),!this.data.ltPropBluePencil&&a.preventDefault())}}},mousemove:function(t){var e=this.__down_evt;e&&(delete this.__down_evt,this.mousedown(e,!0));var i=window;if(!i._resizeelem){var a,o=t,n="cancelAnimationFrame";if(this.__moved=!0,t.touches){if(t.touches.length>1)return;a=!0,o=t.touches[0]}i[n](this._scrollFrame),i[n](this._scrollFrame2);var r=this.getNodeFromEvent(o);if(r){r=this.check4nested(r);var s=this.getCursorPosition(r,o),l=this.data.range,d=this._maindiv,c=this.getBcr(d),p=d.scrollTop,h=o.clientY,u=0,m=Lyte.objectUtils;if(this._touchselect||!a&&!this.data.touchTest?r==l.startNode&&l.left==s?(m(l,"add","isRange",!1),this.copyToRange()):(m(l,"add","isRange",!0),m(l,"add","right",s),m(l,"add","endNode",r),this.setRange()):(r&&(this.setData("cursor",s),this.setData("currentNode",r),this.setCursor(r,s)),t.preventDefault()),(this._cy!=t.clientY||t.custom)&&(c.top+5>=h?u=-1:c.bottom-5<=h&&(u=1)),u){var f=this,g="requestAnimationFrame";this._scrollFrame=i[g]((function(){d.scrollTop=p+10*u;var e=$L(t.target).closest(".lyteEditorMainDiv>"+f.getTag("paragraph")).get(0),a=$L(f._maindiv).data("list"),o=f.getIndex(a,e),n=t;e&&(f._scrollFrame2=i[g]((function(){var i=f.getBcr(e);-1==u?i.top<c.top&&o++:u&&i.bottom>c.bottom&&o--,o>0&&o<a.length-1&&(n={},["pageX","pageY","clientX","clientY","buttons","button","preventDefault"].forEach((function(e){n[e]=t[e]})),n.target=a[o+u],n.custom=!0,f.mousemove(n))})))}))}}}},copyToRange:function(){var t=this.data,e=t.range,i=t.currentNode,a=t.cursor,o=Lyte.objectUtils;o(e,"add","startNode",i),o(e,"add","endNode",i),o(e,"add","left",a),o(e,"add","right",a),o(e,"add","isRange",!1),$L(this.$node).removeClass("lyteTextSelected"),this.setData("isTextSelected",!1)},setRange:function(){if(this.reset(),this.data.ltPropMobileView&&this.data.range.isRange)if((e=this.data.range).startNode==e.endNode)this.updateEditorDiv(e.startNode,e.left,e.right);else{let t=this.findIndex(e.startNode),i=this.findIndex(e.endNode),a=this.getWordText(e.endNode).length,o=!1;t.paraIndex==i.paraIndex?t.wordIndex>i.wordIndex&&(o=!0):t.paraIndex>i.paraIndex&&(o=!0),this.updateEditorDiv(e.endNode,o?a:0,e.right)}var t=this.data,e=t.range,i=this.getSelected(e),a=this.getTag("overlay"),o=t.activeOverlay,n=this.getTag("overlayHandle"),r=i.length-1,s="lyteTextSelected",l=$L(this.$node),d="lyteEditorFirst",c="lyteEditorLast";this.resetOverlay(),l.hasClass(s)||(l.addClass(s),this.setData("isTextSelected",!0)),i.forEach(function(e,i){var s;if(o.every((function(t){return!t.classList.contains("inActive")||(s=t,!1)})),s)$L(s).removeClass("inActive");else{var l={data:[],tag:a};t.isMobile&&(0==i&&l.data.push({tag:n}),i==r&&l.data.push({tag:n})),s=this.render(l),o.push(s),this.append(this._maindiv,s),o.push(s)}if(!i){var p=this.rtlfunc("left");$L(this._editdiv).css(p,e[p])}$L(s).css({top:e.top,height:e.height,left:e.left,width:e.width,transform:e.transform,right:e.right}).data({start:e.start,end:e.end,node:e.node}).addClass(0==i?d:"",i==r?c:"").removeClass(0!=i?d:"",i!=r?c:"")}.bind(this)),this.updateReadOnlyRange(e)},updateReadOnlyRange:function(t){if(!this._ignoreRangeCheck){var e=!1,i=this.data.currentNode,a=$L(t.startNode).hasClass("lyteReadonlyNode"),o=$L(t.endNode).hasClass("lyteReadonlyNode");t.startNode==t.endNode?(a&&(t.left=0,t.right=this.getWordText(t.startNode).length),e=!0):(a&&(i==t.startNode?t.left=0:t.left=this.getWordText(t.startNode).length,e=!0),o&&(i==t.endNode?t.right=0:t.right=this.getWordText(t.endNode).length,e=!0)),e&&this.getSelected(t)}},getSelected:function(t,e){var i=t.startNode,a=t.endNode,o=this.getTag("paragraph"),n=$L(i).closest(o,this.$node),r=n.parent().get(0),s=$L(a).closest(o,this.$node).parent().get(0);if(this.data.selectedParagraph=[],this.data.selectedWords=[],this.data.topLevelElement=void 0,i==a)return this.data.topLevelElement=n.parent().get(0),this.copyInSameWord(a,t.left,t.right,e);if(r==s)return this.data.topLevelElement=s,this.copyWithinSame(t);var l=$L(r).closest(this.getTag("table"),this.$node).get(0),d=$L(s).closest(this.getTag("table"),this.$node).get(0);return d&&l==d?(this.data.topLevelElement=void 0,this.copyFromTable(r,s)):this.copyFrmDifferent(r,s,t)},copyWithinSame:function(t){var e=t.startNode,i=t.endNode,a=i.parentNode,o=this.findIndex(e),n=this.findIndex(i),r=t.left,s=t.right,l=o.paraIndex,d=n.paraIndex,c=a.parentNode,p=$L(c).data("list"),h=o.wordIndex,u=n.wordIndex,m=[];if(this.data.topLevelElement=c,this.data.selectedParagraph=[],l>d||l==d&&h>u){var f=e;e=i,i=f,f=l,l=d,d=f,f=r,r=s,s=f,f=h,h=u,u=f}for(var g=l;g<=d;g++){var y,v=p[g],b=$L(v).data("list"),x=0,_=b.length-1,P=0;g==d&&(_=u),g==l&&(x=h);for(var L=x;L<=_;L++)y=g==d&&L==_?s:void 0,P=g==l&&L==x?r:0,Lyte.arrayUtils(m,"push",this.copyInSameWord(b[L],P,y));L=0}return m},getTempLine:function(t,e,i){var a=$L(t).data("lineRef");return a&&a.length||($L(t).data("lineRef",a=this.convertToLine(t)),this.pushIfNot(this.data.wordLines,a),a._sL=e,a._sT=i),a.forEach((function(t){var o=t.client;["bottom","oriBottom","oriTop","top","y"].forEach((function(t){null!=o[t]&&(o[t]+=a._sT-i)})),["left","right","x"].forEach((function(t){o[t]+=a._sL-e}))})),a._sL=e,a._sT=i,a},copyInSameWord:function(t,e,i,a){var o=t.offsetParent,n=$L(t),r=n.data("data"),s=this.data.selectedWords,l=this.data.selectedParagraph,d=[],c=this._maindiv,p=c.offsetHeight,h=c.scrollHeight,u=c.scrollLeft,m=c.scrollTop;if(i=null==i?this.getWordText(t).length:i,e>i){var f=e;e=i,i=f}if(!o)return s.push({node:t,left:parseInt(e),right:parseInt(i)}),this.pushIfNot(l,t.parentNode),s;if(_lyteUiEditor.isTable({data:[r]})){var g=this.toArray($L(t).find(this.getTag("table")).eq(0).children().children().children());return this.copyFromTable(this.first(g),this.last(g))}if(_lyteUiEditor.isSection({data:[r]}))return this.copyFromSection(r);"image"==r.details.type&&(d=this.copyCaption(t));let y,v=this.getData("convertToLineData");a?null==v.node||v.node!=t?(this.setData("convertToLineData",{node:t,data:this.convertToLine(t)}),v=this.getData("convertToLineData"),y=v.data):y=v.node==t?v.data:this.convertToLine(t):y=this._mup?this.getTempLine(t,u,m):this.convertToLine(t);var b,x=y,_=[],P=this.comp_style(t),L=x[0].client,w={bottom:L.oriTop||L.top},I=this.getBcr(this._maindiv),E=m+(L.oriTop||L.top)-I.top,C=t.style.unicodeBidi,T=this.get_dir(t),N=T?p==h?0:_lyteUiUtils.getScrollBarWidth():0,S=parseFloat(P.paddingLeft)-N,k=(b=parseFloat(P.paddingTop))+parseFloat(P.paddingBottom);if(C=C&&T||!C&&!T,s.push({node:t,left:parseInt(e),right:parseInt(i)}),this.pushIfNot(l,t.parentNode),"image"!=r.details.type||this.data.ltPropInlineImage){var D=n.hasClass("lyteReadonlyNode"),$=this.data.ltPropInlineImage&&this.isImage({data:[n.data("data")]});x.forEach(function(o,n){var r=o.start,s=o.end,l=o.width,d=e>=r&&e<=s,c=i>=r&&i<=s,p=(o.client.oriBottom||o.client.bottom)-(w.oriBottom||w.bottom),h=o.client.height,m=r>e&&s<i,f=(this.rtlfunc("left"),o.client.left-I.left+u),g=p-(o.client.oriHeight||h)+(o.client.top-o.client.oriTop||0);if(w=o.client,D||$)_.push({node:t,left:f+S,width:l,start:r,end:s,height:h-k,top:E+g+b});else if(d&&c){var y,v=this.getData("lineOffsetDataForFind");if(a)if(null!=v[v.length-1]&&v[v.length-1].line==n&&v[v.length-1].node==t){let a=v[v.length-1],s=this.measureLength(o.text.slice(a.right-r,e-r),void 0,t,P,void 0,n).width,l=this.measureLength(o.text.slice(a.right-r,i-r),void 0,t,P,void 0,n).width;x=a.off1+s,y=a.off1+l,Lyte.arrayUtils(v,"push",{node:t,off1:y,off:x,right:i,line:n})}else x=this.measureLength(o.text.slice(r-r,e-r),void 0,t,P,void 0,n).width,y=this.measureLength(o.text.slice(r-r,i-r),void 0,t,P,void 0,n).width,Lyte.arrayUtils(v,"push",{node:t,off1:y,off:x,right:i,line:n});else x=this.measureLength(o.text.slice(r-r,e-r),void 0,t,P,void 0,n).width,y=this.measureLength(o.text.slice(r-r,i-r),void 0,t,P,void 0,n).width;_.push({node:t,left:f+(C?x:l-y)+S,width:y-x,start:e,end:i,height:h-k,top:E+g+b})}else if(d){var x=this.measureLength(o.text.slice(r-r,e-r),void 0,t,P,void 0,n).width;_.push({node:t,left:f+(C?x:0)+S,width:l-x,start:e,end:s,height:h-k,top:E+g+b})}else if(c){x=this.measureLength(o.text.slice(r-r,i-r),void 0,t,P,void 0,n).width;_.push({node:t,left:f+(C?0:l-x)+S,width:x,start:r,end:i,height:h-k,top:E+g+b})}else m&&_.push({node:t,left:f+S,width:l,start:r,end:s,height:h-k,top:E+g+b});E+=p}.bind(this))}else _.push({node:t,width:L.width,start:e,end:i,left:u+L.left-I.left,top:E,height:L.height});return _.concat(d)},copyFrmDifferent:function(t,e,i){var a,o=this.findOrder(t),n=this.findOrder(e),r=this.commonOrder(o,n),s=$L("#"+n[r],this.$node),l=this.findPara(i.startNode,s),d=this.findPara(i.endNode,s),c=s.data("list"),p=this.getIndex(c,l),h=this.getIndex(c,d);this.data.ltPropTags;if(p>h){var u=d;d=l,l=u,u=o,o=n,n=u,a=!0}var m=this.getFirstWordInPara(l,!0),f=this.getLastWordInPara(d,!0),g=$L("#"+o[r+1],this.$node),y=g.closest(this.getTag("table")),v=$L("#"+n[r+1],this.$node),b=v.closest(this.getTag("table")),x=y.length?0:a?i.right:i.left,_=b.length?this.getWordText(f).length:a?i.left:i.right;return b.length&&b.get(0)==y.get(0)?this.copyFromTable(g.get(0),v.get(0)):this.copyWithinSame({startNode:m,endNode:f,right:_,left:x})},copyFromSection:function(t){var e=$L(this.$node).find("#"+t.data[0].randomId).get(0).childNodes,i=[],a=function(t){Lyte.arrayUtils(i,"push",this.copyInSameWord(t,0))}.bind(this);return e.forEach(function(t){$L(t).data("list").forEach(a)}.bind(this)),i},findPara:function(t,e){for(var i=e.data("list"),a=0;a<i.length;a++){var o=i[a];if(o.contains(t))return o}},commonOrder:function(t,e){for(var i,a=Math.min(t.length,e.length),o=0;o<=a;o++){if(t[o]!=e[o])return i;i=o}},findOrder:function(t){var e=[t.id],i=$L(t).parent().closest(".listHolderElement",this.$node).get(0);return i&&Lyte.arrayUtils(e,"insertAt",0,this.findOrder(i)),e},reset:function(){var t=this.data,e=t.currentNode,i=t.cursor;t.selectedWords=[{node:e,left:i,right:i}],t.selectedParagraph=[e.parentNode],t.topLevelElement=$L(e).closest(".listHolderElement").get(0),delete this._rangemove},mouseup:function(t){var e;t.touches&&(e=!0);var i=this.data.range,a="cancelAnimationFrame",o="removeEventListener",n=this.__down_evt;i.isRange&&(this.setData("currentNode",i.endNode),this.setData("cursor",i.right),this.setCursor(i.endNode,i.right),this.updateReadOnlyRange(i)),window[a](this._scrollFrame),window[a](this._scrollFrame2),delete this._scrollFrame,delete this._scrollFrame2,delete this._mup,delete this._touchselect,delete this._cy,setTimeout(function(){delete this.__down_evt}.bind(this),10),(e||this.data.touchTest)&&$L(this.$node).removeClass("lyteEditorTouchStart","lyteEditorCursorVisible"),document[o](e?"touchmove":"mousemove",this._mousemove,!0),document[o](e?"touchend":"mouseup",this._mouseup,!0),this.resetWordLines(),!this.data.ltPropBluePencil&&!n&&this.$node.focus(this.__moved),delete this.__moved,(this.data.isMobile||this.data.touchTest)&&(1==this._mobilepop.ltProp("show")?this._mobilepop.ltProp("show",!1):(i.isRange||null==this._longpresstime)&&setTimeout(this.openMobilePop.bind(this),150)),clearTimeout(this._longpresstime),delete this._longpresstime},resetWordLines:function(){var t=this.data.wordLines;t.forEach((function(t){t.splice(0,t.length),delete t._sL,delete t._sT})),t.splice(0,t.length)},check4nested:function(t){if(t){var e=$L(t).data("data");return _lyteUiEditor.isTable(e)||_lyteUiEditor.isSection({data:[e]})?this.getLastWordInPara($L(t).find(this.getTag("paragraph")).get(-1)):t}},getTagName:function(t){return(t.tagName||"").toLowerCase()},getWordFromEventLine:function(t,e){var i=$L(t).data("list"),a=[],o=e.clientY;if(i.forEach(function(t){this.cRects(t).forEach((function(e){o>=e.top&&o<=e.bottom&&a.push({bcr:e,node:t})}))}.bind(this)),a.length){var n,r=1/0,s=e.clientX;return a.forEach((function(t){var e=t.bcr,i=Math.min(Math.abs(e.left-s),Math.abs(e.right-s));r>=i&&(r=i,n=t.node)})),n}var l=this.first(i),d=this.last(i);return this.getBcr(l).top>o?l:d},getNodeFromEvent:function(t,e){var i=e||t.target,a=this.getTagName(i),o=this._maindiv;if(!o.contains(i))return this.getWordFromEventLine(this.getWordFromEventLine(this._maindiv,t),t);if(i==o&&this.check_is_empty(),this.getTag("word")==a)return i;if(this.getTag("paragraph")==a)return this.getWordFromEventLine(i,t);if(/div/i.test(a)){if(this.getTag("word")==this.getTagName(i.parentNode))return i.parentNode}else{if(a==this.getTag("overlayHandle"))return this.getWordFromEventLine(this.getWordFromEventLine(this._maindiv,t),t);if("img"===a)return $L(i).closest("lyte-word",o).get(0)}return $L(i).hasClass("listHolderElement")?this.getWordFromEventLine(this.getWordFromEventLine(i,t),t):void 0},findNearest:function(t,e,i){var a,o=1/0,n=e[i];return t.forEach((function(t){var e=t.top,i=t.bottom,r=Math.min(Math.abs(e-n),Math.abs(i-n));r<o&&(o=r,a=t)})),a},setCursor:function(t,e,i,a){!i&&!a&&!this.data.range.isRange&&this.data.ltPropMobileView&&this.updateEditorDiv(t,e),!i&&this.setData("cursor",e);const o=this.isCodeEditor($L(t.parentElement).data("data"));this.$node.panel&&(o?this.$node.panel.disableAll():this.$node.panel.disableAll(!0));var n=this.data,r=function(){i||n.range.isRange||(this.reset(!0),this.copyToRange())}.bind(this);if(n.ltPropReadonly||n.ltPropDisabled)return r();$L.fastdom.clear(this._measure),this._measure=$L.fastdom.measure((function(){if(delete this._measure,this.$node.offsetParent){var i,a=this._cursor,o=!0,r=t.style.color,s=/var\((.+)\)/,l=window.getComputedStyle(t);if(r&&s.test(r)){var d=r.match(s)[1];if(1==d.split(",").length){var c="var("+d+","+l.color+")";$L(t).css("color",c),r=c}}if($L.fastdom.clear(this._mutate),this.data.navCheck&&this._iframe&&(i=this.cursor_pos(t,e))&&(o=!1),o){i=this.findCursorPos(t,e)||{};var p=parseFloat(l.paddingLeft),h=parseFloat(l.paddingTop),u=parseFloat(l.paddingBottom);i.left+=p,i.top+=h,i.height-=h+u}this._mutate=$L.fastdom.mutate((function(){delete this._mutate;var e,o,s=$L(a),l="lyteReadonlyNode";s.css(i),e="italic"==t.style.fontStyle?"addClass":"removeClass",o=$L(t).hasClass(l)?"addClass":"removeClass",s[e]("lyteCursorItalic")[o](l),s.css("background",r),n.ltPropBluePencil&&this.append_cursor(a)}),this)}}),this),r()},getCursorPosition:function(t,e){for(var i=this.lineBounds(this.cRects(t)),a=this.findNearest(i,e,"clientY"),o=window.getComputedStyle(t),n=t.style.unicodeBidi,r=this.get_dir(t),s=Math.min(a.width,r&&!n||!r&&n?a.right-e.clientX+parseFloat(o.paddingRight):e.clientX-a.left-parseFloat(o.paddingLeft)),l=this.getWordText(t),d=l,c=0,p=this.getIndex(i,a),h=this.comp_style(t),u=i.length,m=0;m<=p;m++){var f=m==p?s:i[m].width,g=this.data.navCheck&&this._iframe?this.m_width(l,f,h).cursor:this.measureLength(l,f,t,h,void 0,m).cursor;c+=g,l=l.slice(g),0==g&&u>1&&(c+=.5)}return n&&(c==d.length?c=0:c||(c=d.length)),c},convertToLine:function(t){for(var e=this.lineBounds(this.cRects(t)),i=this.comp_style(t),a=[],o=e.length,n=this.getWordText(t),r=0,s=i.whiteSpace,l=/normal|nowrap/i.test(s),d=0;d<o;d++){var c=0;l&&/^\s/.test(n)&&(c=n.match(/^\s+/).length);var p=e[d],h=(this.data.navCheck&&this._iframe?this.m_width(n.slice(c),p.width,i).cursor:this.measureLength(n.slice(c),p.width,t,i,void 0,d).cursor)+c;if(l){var u=n.slice(h);if(/^\s/.test(u))h+=u.match(/^\s+/).length}a.push({node:t,start:r,end:r+=h,width:p.width,text:n.slice(0,h),client:p}),n=n.slice(h)}return a},findCursorPos:function(t,e){var i=this.lineBounds(this.cRects(t)),a=i.length;if(0!=a){var o=this.getWordText(t),n=o.slice(0,parseInt(e)),r=this.comp_style(t),s=t.style.unicodeBidi,l=this.get_dir(t),d=this._maindiv,c=l&&s||!l&&!s,p=d.scrollTop,h=d.scrollHeight,u=d.offsetHeight,m=l?u==h?0:_lyteUiUtils.getScrollBarWidth():0,f=d.scrollLeft-m,g=this.getBcr(d),y=this.first(i),v=(y.oriTop||y.top)-g.top,b=r.whiteSpace,x=/normal|nowrap/i.test(b);e=Math.max(0,e);for(var _=0;_<a;_++){if(x&&/^\s/.test(n))e-=P=n.match(/^\s+/).length,n=n.slice(P);var P,L=i[_],w=L.width,I=this.data.navCheck&&this._iframe?this.m_width(n,w,r):this.measureLength(n,w,t,r,void 0,_),E=I.cursor;if(n=n.slice(E),x&&_==a-1)if(/^\s$/.test(n))E+=P=n.match(/^\s+/).length;if(E>=e||E==e+.5||.5==e||_+1==a){var C={height:L.oriHeight||L.height,top:p+v+(L.oriTop||L.top)-(i[0].oriTop||i[0].top),left:f+(c?I.width:L.width-I.width)+L.left-g.left};return s&&(o.length==E?C.left+=L.width*(l?-1:1):E||(C.left+=L.width*(l?1:-1))),C}e-=E}}},nonFocusClick:function(t){!this.data.ltPropBluePencil&&this.$node.focus();var e=this._count||0,i=this.data.ltPropSelectionDelay;clearTimeout(this._selectclick),this._count=e+1;var a,o,n=this._count;switch(n%4){case 2:o=a="selectWord";break;case 3:o=a="selectParagraph";break;default:n>3&&(a="resetRange")}a&&setTimeout(function(){o&&this.resetRange(),this[a]()}.bind(this),i/5),this._selectclick=setTimeout(function(){delete this._count}.bind(this),i);var r=$L(this.data.currentNode);if($L(t.target).closest(r,this._maindiv).length&&r.hasClass("lyteEditorAnchor"))if(this.metakeycheck(t))try{this.openAnchor()}catch(t){console.warn("Caught error at new tab opening"+t.message)}else this.anchorOpen()},getIndex:_lyteUiEditor.getIndex,first:_lyteUiEditor.first,last:_lyteUiEditor.last,cRects:function(t){return this.changeWithOtherword(this.toArray(t.getClientRects()).map((function(t){return{x:t.x,y:t.y,left:t.left,right:t.right,bottom:t.bottom,top:t.top,height:t.height,width:t.width}})),t.parentNode,t)},formLine:function(t){var e=t[0],i=t.length,a=[e],o=[a];if(0==i)return[];for(var n=1;n<i;n++){var r=t[n];e.client.top==r.client.top||e.client.top<=r.client.top&&e.client.bottom>=r.client.top||e.client.top<=r.client.bottom&&e.client.bottom>=r.client.bottom?a.push(r):(a=[r],o.push(a)),e=r}return o},changeWithOtherword:function(t,e,i){var a=$L(e).data("list")||[],o=this.last(t);return a.every(function(e){var a=this.toArray(e.getClientRects()),n=a[0];return e==i||!(!n||n.top>=o.bottom)&&(a.forEach(function(e){t.forEach(function(t){(e.top>=t.top&&e.bottom<=t.bottom||e.top<=t.top&&e.bottom>=t.bottom)&&(t.oriHeight=t.oriHeight||t.height,t.oriTop=t.oriTop||t.top,t.oriBottom=t.oriBottom||t.bottom,t.top=Math.min(t.top,e.top),t.bottom=Math.max(t.bottom,e.bottom),t.height=Math.max(t.height,e.height))}.bind(this))}.bind(this)),!0)}.bind(this)),t},lineBounds:function(t){for(var e=t[0],i=t.length,a=1;a<i;a++){var o=t[a];o.top==e.top?(e.width+=o.width,e.right=o.right,i--,t.splice(a,1),a--):e=o}return t},toArray:function(t){return Array.from?Array.from(t):Array.apply(Array,t)},isLastInLine:function(t,e){var i=this.last(e),a=this.last(this.cRects(this.getLastWordInPara(t.parentNode)));return i.top>=a.top&&i.bottom<=a.bottom||i.top<=a.top&&i.bottom>=a.bottom},findSpaceWidth:function(t,e,i,a,o,n){var r=[],s=0,l=this,d=l.getWordText(t),c=e.length-1,p=l.isLastInLine(t,e),h=l.measureWidth(" ",this.getFontFromStyle(i),i);return e.forEach((function(e,u){var m=d.slice(s);if(p&&u==c)v=0;else{var f=l.data.navCheck&&l._iframe?l.m_width(m,e.width,i).cursor:l.measureLength(m,e.width,t,i,!0).cursor,g=d.slice(s,f+s).lastIndexOf(" "),y=s+(-1==g?f:++g),v=e.width-l.measureLength(d.slice(s,y),void 0,t,i,!0).width;m=d.slice(s,y),s=y}if(null==a||a==u){for(var b=m.split(" "),x=0;""==l.last(b);)b.pop(),x++,v+=h;for(var _=b.length-1,P=0;P<_;P++)r.push(v/_+h+o+n);for(P=0;P<x;P++)r.push(0)}})),r},find_emoji:function(t,e,i,a){var o=this.__e_cache||(this.__e_cache={}),n=o[i]||(o[i]={}),r=n[t.charAt(0)];if(void 0!==r)return r;if(/^[A-z]/.test(t||""))return n[t.charAt(0)]=0;var s=new RegExp("(\\p{Emoji}|\\p{Extended_Pictographic})","u").exec(t);if(!s&&!(s=this.__overall_emoji.exec(t)))return n[t.charAt(0)]=0;var l=s[0];if(s.index)return n[t.charAt(0)]=0;var d=l.length,c=/[\uD800-\uDBFF][\uDC00-\uDFFF]/.exec(t.slice(d));if(c&&0==c.index){var p=c[0].length,h=this.measureWidth(t.slice(0,d),i,a,!0),u=this.measureWidth(t.slice(d,d+p,!0),i,a),m=this.measureWidth(t.slice(0,d+p),i,a,!0);0!=Math.round(Math.abs(h+u-m))&&(d+=p)}if([57343,57342,57341,57340,57339].forEach((function(e){t.charCodeAt(d)==e&&d++})),t[d]==e){var f=e.length;return n[t.charAt(0)]=d+f+this.find_emoji(t.slice(d+f),e)}return"️"==t[d]?n[t.charAt(0)]=d+"️".length:n[t.charAt(0)]=d},find_letters:function(t,e,i,a){if(/^[A-Z]$/i.test(t[0]||""))return 1;for(var o=this.measureWidth(t[0],e,i),n=1,r=t.length;n<r;n++){if(t[n]!=a){var s=this.measureWidth(t[n],e,i),l=this.measureWidth(t.slice(0,n+1),e,i);if(Math.abs(o+s-l)<1.5)break;o=l}}return n-0},measureLength:function(t,e,i,a,o,n){var r=a||this.comp_style(i),s=parseFloat(r.letterSpacing);switch(r.textTransform){case"uppercase":t=t.toUpperCase();break;case"lowercase":t=t.toLowerCase();break;case"capitalize":t=t.replace(/\b\w/g,(function(t){return t.toUpperCase()}))}if(s=isNaN(s)?0:s,this.data.navCheck&&this._iframe&&null==e)return this.m_width(t,e,r);var l,d=0,c=this._canvas.font=this.getFontFromStyle(r),p=i&&this.isSpaceWord($L(i).data("data")),h=t.length,u=p?this.getWordText(i).length:0,m=p?this.convertToPx(r.width):0,f=this.convertToPx(r.wordSpacing),g=[],y=[],v=0,b="justify"==r.textAlign&&!o,x=/normal|nowrap/i.test(r.whiteSpace),_=[8205].map((function(t){return String.fromCharCode(t)})),P=0;if(b){var L=this.lineBounds(this.cRects(i));y=this.findSpaceWidth(i,L,a,n,s,f)}for(var w=0;w<h;w++){var I;if(p&&m)I=m/u-s,g.push(t[w]);else{var E=t[w];if(/\s/.test(E))if(P=w,I=this.measureWidth(E,c,r),b){var C=y[v++];I=null==C?I:C}else{if(x&&/\s/.test(t[w-1]||"")){I=0,g[g.length-1]+=E;continue}I+=f+s,g.push(E)}else{var T,N=this.find_emoji(t.slice(w),_[0],c,r);T=N?w+N:w+this.find_letters(t.slice(w),c,r,_[0]),I=this.measureWidth(t.slice(P,T).trim(),c,r)-this.measureWidth(t.slice(P,w).trim(),c,r),I+=s,g.push(t.slice(w,T)),w=T-1}}if(null!=e&&(e-=I)<0){e+I>.5*I?(d+=I,w++,l=!0):w-=g.pop().length-1;break}d+=I}return{letters:g,width:d,excess:l,cursor:w,element:i,endSpace:0,endSpaceWid:0}},isSpaceWord:function(t){return/^\s+$/.test(t.text)},is_emoji:function(t,e){return!!this._emojiRegex.test(t)||(!!this.__overall_emoji.test(t)||t.length>=2&&(/^\&\#x/.test(t)||1==t.indexOf("️")))},split_emoji:function(t,e,i){for(var a=[],o=String.fromCharCode(8205),n="";t.length;){var r=this.find_emoji(t,o,e,i);r?a.push(t.slice(0,r)):(n+=t.slice(0,1),r=1),t=t.slice(r)}return n&&a.push(n),a},measureWidth:function(t,e,i,a){var o=this.__cache||(this.__cache={}),n=o[e]||(o[e]={}),r=n[t];if(null!=r)return r;if(this._iframe&&this.data.isMac&&this.is_emoji(t)){if(!a){var s=this.split_emoji(t,e,i);if(s.length>1){var l=0;return s.forEach(function(t){l+=this.measureWidth(t,e,i,!0)}.bind(this)),n[t]=l}}return n[t]=this.measureFrmFrame(t,e,i)}return n[t]=this._canvas.measureText(t).width},measureFrmFrame:function(t,e,i){var a=this.__cache||(this.__cache={}),o=a[e]||(a[e]={}),n=o[t];if(null!=n)return n;var r=this._iframe.contentDocument,s=r.body;s.innerHTML="<span style='font:"+e+"'></span>",a[e]=o;var l=s.children[0];return l.appendChild(r.createTextNode(t)),o[t]=l.getBoundingClientRect().width},convertToPx:function(t){var e=/px|pt|cm|mm|in/i;if(e.test(t)){var i=t.match(e)[0];return parseFloat(t)*({px:1,pt:1.3281472327365,in:96,cm:37.795275591,mm:3.7795275591}[i]||1)}return 0},getFontFromStyle:function(t){var e=t.font;if(e)return e;var i=[];return["fontStyle","fontVariant","fontWeight","fontSize","fontFamily"].forEach((function(e){var a=t[e];a&&i.push(a)})),i.join(" ")},getWordText:function(t){return t==this.__compose?t.innerText:$L(t).data("data").text},keydown:function(t){if(this.check_is_empty(),!this._mentionopen||!this.mentionsKeydown(t)){var e=this._popover;e&&e.ltProp("show",!1);var i=t.altKey,a=t.shiftKey,o=this.metakeycheck(t),n=(t.key,this.getValueForShortcut(t,o,a,i)),r=navigator.userAgent,s=this.data;if(n){var l=n.value,d="onShortcutApply",c=function(e){return this.getMethods(d)&&this.executeMethod(d,t,n,this.$node),e&&t.preventDefault(),!0}.bind(this);if(this[l]){if((s.ltPropReadonly||s.ltPropDisabled)&&!("selectAll"==l||/move/i.test(l)&&a))return;return this.getMethods("onBeforeShortcutApply")&&this.executeMethod("onBeforeShortcutApply",t,n,this.$node),c(0!=this[l](o,a,i,n.css))}return this["toggle"+(n.scope||"Word")+"Class"](n.value,n.css),c(1)}if(/firefox/i.test(r)&&/linux/i.test(r)){var p=_lyteUiUtils.copyFrmEvt,h=this.$node;if(p){var u=t.key;/^(x|c)$/i.test(u)&&p(this.getSelectedText(),t,h,h.focus)&&"x"==u&&!s.ltPropReadonly&&!s.ltPropDisabled&&this.removeSelected()}}}},getValueForShortcut:function(t,e,i,a){var o=_lyteUiUtils.getCorrectNumberCode(t.keyCode||t.which),n=this.data.ltPropShortcuts[o],r=this,s=this.data.shortCutCheckObject;if(229===t.keyCode&&"Process"===t.key&&t.ctrlKey){let e=s.indexOf(t.code),i=t.code.match(/^Key(\w+)$/);i&&-1!=e&&(n=this.data.ltPropShortcuts[i[1].charCodeAt(0)],n&&(this._editdiv.blur(),window.requestAnimationFrame((function(){r._editdiv.focus()}))))}if(n){for(var l,d=0;d<n.length;d++){var c=n[d];if(c.any)return c;!!c.ctrl==e&&!!c.shift==i&&!!c.alt==a&&(l=c)}return l}},metakeycheck:function(t){var e=this._isMac;return!e&&t.ctrlKey||e&&t.metaKey},remove_br:function(t){Array.from(t.childNodes).forEach(function(t){this.getTagName(t)&&t.remove()}.bind(this))},insertTextInWord:function(t){if(t){var e=this._editdiv;e.textContent=t,this.processInput(e)}},replace_text:function(t){var e=this.data.ltPropReplaceLetters;if(t)for(var i in e)t=t.replace(new RegExp(i,"g"),e[i]);return t},processInput:function(t,e){if(!this._pastePrevent){var i=this.data;i.range.isRange&&this.removeSelected(void 0,void 0,t.innerHTML),this.remove_br(t);var a=this.check_limit(this.convertCase(this.replace_text(this.data.ltPropMobileView||""!=t.innerHTML?t.innerHTML:e?e.data:"")),!0).html;if(!a&&!this.data.ltPropMobileView)return t.textContent="";if(this._suggestionWord){let t=this._suggestionWord.innerText;""==t&&this.removeSuggestion(),t[0]==a&&(this._suggestionWord.innerText=t.slice(1))}this.updateRangeNode();var o,n=i.currentNode,r=i.cursor,s=n.parentNode,l=$L(s).data("data"),d=this.data.ltPropMobileView,c=this.getWordText(n),p=d?a:c.slice(0,r)+a+c.slice(r),h=$L(n),u="onBeforeInput",m=i.range,f=function(e){var i=this.findIndex(n);e&&0!=r&&.5!=r?i.wordIndex++:e||i.wordIndex++,this.setData("currentNode",this.insertSingleWord(this.emptyWordData(),i)),this.setData("cursor",0),this.processInput(t)}.bind(this);if(this.data.ltPropDetectList&&n===this.getFirstWordInPara(s)&&" "==a&&-1==l.classList.indexOf("lyteEditorTab")){let t=this.detectList(s,p);t&&(this.updateNodeValue(n,p=""),this["ul"===t.type?"list":"ordered"](t.index),o=0)}if(!m.isRange&&n==this.getLastWordInPara(s)&&h.hasClass("lyteEditorAnchor")&&r==c.length)return f();if(h.hasClass("lyteEditorImage")||h.parent().hasClass("lyteEditorHrTag"))return this.imageText(n),this.processInput(t);if(h.hasClass("lyteReadonlyNode"))return f(!0);if(this.data.ltPropDiacriticHandler&&(!e||"insertReplacementText"!=e.inputType)||this.data.ltPropMobileView||(this.toArray(t.childNodes).forEach((function(t){t.tagName?t.remove():t.nodeValue&&(t.nodeValue="")})),this.createRange(t.childNodes[0],0)),!this.getMethods(u)||0!=this.executeMethod(u,n,c,i.cursor,a,this.$node)){if(this.isCodeEditor(l))return this.insertTextInSnippet(n,s,l,a);this.update_count(a.length),this.setData("cursor",d?window.getSelection().getRangeAt(0).endOffset:null!=o?o:i.cursor+a.length),this.updateNodeValue(n,p),this.setCursor(i.currentNode,i.cursor),this.check_rtl(s),this.checkTrigger(),this.scrollIntoView(i.currentNode,i.cursor),u="onAfterInput",this.getMethods(u)&&this.executeMethod(u,i.currentNode,i.cursor,this.$node),i.ltPropBluePencil&&this.dispatch_input(),i.ltPropUrlDetection&&i.ltPropUrlDetectionOptions.input&&/^\s$/.test(a)&&this.url_detection(),this.callFind()}}},detectList:function(t,e){let i=this.data.ltPropListMatchMap,a=this.data.listRegex;for(let o in i)if(a[o].test(e)){let n="olDecimal"===o?"olDecimalLeadingZero":"olDecimalLeadingZero"===o?"olDecimal":"";if(n&&a[n].test(e)){let e=t.previousElementSibling;if(e){let t=$L(e).data("data");-1!=t.classList.indexOf("lyteEditorTab")&&(o=_lyteUiEditor.camelCase("ol-"+this.data.ltPropOrderedList[t.attr.tabIndexValue-1].conversionName))}}let r=this.getListIndex(i[o]),s=this.data["ol"===r.type?"ltPropOrderedList":"ltPropUnOrderedList"][r.index-1];s.order=this.getTabIndex(t,1,r.index);let l=this.getBulltet(s);if("ul"==r.type||e.slice(0,-1)===l)return r}},getListIndex:function(t){if(t.startsWith("ol")){let e=this.data.ltPropOrderedList;for(let i=0;i<e.length;i++){let a=e[i];if(_lyteUiEditor.camelCase("ol-"+a.conversionName)==t)return{type:"ol",index:i+1}}}let e=this.data.ltPropUnOrderedList;for(let i=0;i<e.length;i++){let a=e[i];if(("custom"!==a.name?_lyteUiEditor.camelCase(a.name):a.conversionName)===t)return{type:"ul",index:i+1}}},updateNodeValue:function(t,e,i,a,o,n){var r=$L(t),s=r.data("data"),l=s.text,d=this.findIndex(t),c=e;if(null==e&&(e=l),this.data.ltPropCapitalizeWord&&0==d.wordIndex&&(e.includes(" ")||e.includes(" "))){let t,i,a=!1;for(t=1;t<=e.length;t++){if(a&&(" "==e.charAt(t-1)||" "==e.charAt(t-1))){i=t;break}a||" "==e.charAt(t-1)||" "==e.charAt(t-1)?" "==e.charAt(t-1)&&" "==e.charAt(t-1)&&(i=t):a=t}0!=a&&a<i&&(e=e.slice(0,a-1)+e.charAt(a-1).toUpperCase()+e.slice(a))}if(r.hasClass("lyteEditorImage")||s.text!=e&&(t.textContent=s.text=e),a||this.checkTrigger(),o&&(this.data.firstValue=l),!this.isUndo()){var p,h,u,m=this.data.range,f=r.closest(".listHolderElement").data("randomId");i||(u={wordIndex:d.wordIndex,position:this.data.cursor}),m.isRange&&t==m.startNode&&(p={wordIndex:d.wordIndex,position:m.left}),m.isRange&&t==m.endNode&&(h={wordIndex:d.wordIndex,position:m.right}),n&&(this.pushToQueue({operation:"update",oldValue:this.data.firstValue,newValue:e,id:f,index:d.paraIndex,wordIndex:d.wordIndex,current:{index:u,start:p,end:h}}),this.data.firstValue=void 0),null==o&&this.pushToQueue({operation:"update",oldValue:l,newValue:e,id:f,index:d.paraIndex,wordIndex:d.wordIndex,current:{index:u,start:p,end:h}}),!c||null!=s.attr&&null!=s.attr.editable&&0!=Object.keys(s.attr).length&&1!=s.attr.editable||this.mention_update(s,r,l,f,d)}},unescapeText:_lyteUiEditor.unescapeText,resetQueue:function(){clearTimeout(this._undotime);var t=this.data;t.undoqueue.splice(0),t._undoqueue.splice(0),t.redoqueue.splice(0),this.callQueueUpdate("reset")},getSpaceForTab:_lyteUiEditor.getSpaceForTab,convertCase:function(t){var e=this.data.ltPropUpperCase;return"lower"==e?t.toLowerCase():"upper"==e?t.toUpperCase():t},findIndex:function(t,e,i){var a=t.parentNode,o=$L(a).data("list"),n=$L(a).closest(".listHolderElement"),r=n.data("list")||[],s=o.indexOf(t),l=s,d=r.indexOf(a),c={id:n.data("randomId"),position:e,wordOrder:l,paraIndex:d,wordIndex:s};if(i){var p=this._maindiv==n.get(0),h=this.convertToLine(t),u=this.data.cursor;c.isFirstPara=p&&0==d&&h[0].start<=u&&h[0].end>=u,c.isLastPara=p&&d==$L(this._maindiv).data("list").length-1&&$L(h).get(-1).start<=u&&$L(h).get(-1).end>=u}return c},processWord:function(t){var e=this.data.currentNode,i=this.getValueForAlt(e,this.data.cursor,t),a=this.data.range;i&&(this.reset(),a={fakeRange:!0,isRange:!0,startNode:e,left:this.data.cursor,endNode:i.node,right:i.change},this.getSelected(a),this.removeSelected(a))},backspaceWord:function(){this.processWord()},deleteWord:function(){this.processWord(!0)},isInsideSection:function(t){let e=$L(t).closest(".listHolderElement").data("data");return!(!e.attr||!e.attr.hasOwnProperty("data-section"))},createSection:function(t,e){let i=this.emptyParaData(),a={attr:{"data-section":""},classList:e||[],data:[],tag:"div",randomId:this.randomId()};return $L.extend(a,t),i.data[0].attr={"data-section":"true"},i.data[0].details={type:"section"},i.data[0].data=[a],i},isSection:function(t){return _lyteUiEditor.isSection({data:[$L(t).data("data")]})},isSectionEmpty:function(t){let e=$L(t).closest(".listHolderElement").data("data");return e.data&&e.data.length<=1},removeSection:function(t){let e=this.getPreviousWord(t),i=$L(t).closest(".listHolderElement",this.$node).closest("lyte-paragraph",this.$node).get(0),a=$L(t).closest(".listHolderElement",this.$node).closest("lyte-word",this.$node).get(0),o=this.findIndex(a);if(e)this.removePara(i),this.setData("currentNode",e),this.setCursor(e,this.getWordText(e).length);else{this.deleteSingleWord(a,o),this.insertSingleWord(this.emptyWordData(),o);let t=this.getFirstWordInPara(i);this.setData("currentNode",t),this.setCursor(t,this.getWordText(t).length)}},backspace:function(t,e){var i=this.data,a=i.range;if(a.isRange)return this.removeSelected(),void((t||e)&&this.backspace());var o,n,r=i.currentNode,s=r.parentNode,l=$L(s).data("data"),d=parseInt(i.cursor),c=this.findIndex(r),p=this.__ignore?0:1,h=$L(r),u=h.hasClass("lyteReadonlyNode"),m=function(){var t=Lyte.objectUtils;t(a,"add","left",0),t(a,"add","right",d),t(a,"add","startNode",r),t(a,"add","endNode",r),t(a,"add","isRange",!!d),this.common_positioning()}.bind(this);if(0==d){if(h.hasClass("lyteEditorImage")||h.parent().hasClass("lyteEditorHrTag"))return this.deleteImage(r);var f=$L(s),g=f.data("data");if(this.isEmptyPara(g)&&0==c.paraIndex){var y=i._undoqueue,v=y.filter((function(t){return"meta"!=t.type})).length;if(this.isInsideSection(r)&&this.isSectionEmpty(r))return void this.removeSection(r);if(this.clearFormat(!0),v!=y.filter((function(t){return"meta"!=t.type})).length)return}if(f.hasClass(i.tabClass)&&0==c.wordIndex)return this.list(void 0,"OL"==g.details.tab.type?i.ltPropOrderedList:i.ltPropUnOrderedList,!0);var b=this.getPreviousWord(r,!0),x=$L(b),_=x.hasClass("lyteReadonlyNode");if(b&&b.parentNode==s&&_&&(this.updateRangeNode(),this.deleteSingleWord(b,this.findIndex(b)),b=this.getPreviousWord(r,!0),p=0,c.wordIndex--,c.wordOrder--,this.checkPlaceholder()),!b||x.closest(".listHolderElement").get(0)!=h.closest(".listHolderElement").get(0))return this.common_positioning();if(x.hasClass("lyteEditorImage")||x.parent().hasClass("lyteEditorHrTag"))return this.deleteImage(b);if(o=this.getWordText(r).length?void 0:r,b.parentNode!=r.parentNode){if(this.updateRangeNode(),this.mergePara(r))return this.setCursor(i.currentNode,i.cursor),this.updateRangeNode();p=0}!_&&x.hasClass("lyteEditorAnchor")&&(p=0,n=m),r=b,d=this.getWordText(b).length}else if(u){b=this.getPreviousWord(r,!0);this.update_count(-this.getWordText(r).length),o=r,b||(this.updateRangeNode(),b=this.insertSingleWord(this.emptyWordData(),c),c=this.findIndex(o)),d=this.getWordText(r=b).length,p=0}else if(d&&h.hasClass("lyteEditorAnchor")&&d==h.data("data").text.length)return m();var P,L=this.getWordText(r),w=L.slice(0,d);if(p=n||u?p:this.findPrevChar(w,r),P=d-p,o){this.updateRangeNode();var I=o.parentNode,E=$L(I).closest(".listHolderElement").data("list"),C=this.getIndex(E,I);1==$L(I).data("list").length?this.isCaption(I)||1==E.length||this.isTable($L(E[C-1]).data("data"))||this.removePara(I):this.deleteSingleWord(o,c)}else this.updateRangeNode();this.update_count(-p),this.setData("cursor",P),this.setData("currentNode",r),this.updateNodeValue(r,L.slice(0,P)+L.slice(P+p)),l.details.snippet?this.insertTextInSnippet(r,s,l):(this.setCursor(r,P),this.check_rtl(r.parentNode)),n&&n(),this.callFind()},delete:function(){var t=this.data,e=t.range;if(e.isRange)return this.removeSelected();var i,a,o=t.currentNode,n=parseInt(t.cursor),r=this.findIndex(o),s=1,l=$L(o).hasClass("lyteReadonlyNode"),d=function(){var t=Lyte.objectUtils;t(e,"add","left",0),t(e,"add","right",c),t(e,"add","startNode",o),t(e,"add","endNode",o),t(e,"add","isRange",!!c),this.common_positioning()}.bind(this),c=this.getWordText(o).length;if(n==c){var p=this.getNextWord(o,!0),h=$L(p),u=h.hasClass("lyteReadonlyNode");if(h.hasClass("lyteEditorImage")||$L(o).parent().hasClass("lyteEditorHrTag"))return this.deleteImage(p);if(this.isInsideSection(o)&&this.isSectionEmpty(o)&&this.isEmptyPara($L(o.parentNode).data("data")))return void this.removeSection(o);if(p&&p.parentNode==o.parentNode&&u&&(this.updateRangeNode(),this.deleteSingleWord(p,this.findIndex(p)),p=this.getNextWord(o,!0),s=0),!p||h.closest(".listHolderElement").get(0)!=h.closest(".listHolderElement").get(0))return this.checkPlaceholder(),this.common_positioning();if(i=this.getWordText(o).length?void 0:o,p.parentNode!=o.parentNode){if(this.updateRangeNode(),this.mergePara(p,!0))return this.setCursor(t.currentNode,t.cursor),this.updateRangeNode();s=0}!u&&h.hasClass("lyteEditorAnchor")&&(s=0,a=d,c=this.getWordText(p).length),o=p,n=0}else if(l){p=this.getNextWord(o,!0);this.update_count(-this.getWordText(o).length),i=o,p||(this.updateRangeNode(),p=this.insertSingleWord(this.emptyWordData(),r),r=this.findIndex(i)),n=0,s=0,o=p}else if(!n&&$L(o).hasClass("lyteEditorAnchor"))return d();var m=this.getWordText(o),f=m.slice(n),g=n;if(s=a?s:this.findPrevChar(f,o,!0),i){this.updateRangeNode();var y=i.parentNode,v=$L(y).closest(".listHolderElement").data("list"),b=this.getIndex(v,y);1==$L(y).data("data").length?this.isCaption(y)||1==v.length||this.isTable($L(v[b-1]).data("data"))||this.removePara(y):this.deleteSingleWord(i,r)}else this.updateRangeNode();this.update_count(-s),this.setData("cursor",g),this.updateNodeValue(o,m.slice(0,g)+m.slice(g+s)),this.setData("currentNode",o),this.setCursor(o,g),this.check_rtl(o.parentNode),this.callFind(),a&&a()},updateEditorDiv:function(t,e,i){if(this.data.ltPropMobileView){let a=t.textContent;this._editdiv.textContent!=a&&(this._editdiv.textContent=t.textContent),this.createRange(this._editdiv.childNodes[0],e,i)}},backspaceLine:function(){var t=this.data,e=t.currentNode,i=parseInt(t.cursor),a=this.getLWindex(e,t.cursor),o=a.lineIndex,n=a.wordIndex,r=a.lines[o];if(i==r[n].start)return this.backspace();if(0==i&&0==n)return 0==o&&this.mergePara(e)?(this.setCursor(t.currentNode,t.cursor),this.updateRangeNode()):this.backspace();this.updateRangeNode();for(var s=n-1;s>=0;s--){var l=r[s],d=l.node,c=(p=this.getWordText(d)).length;(p=p.slice(0,l.start)+p.slice(l.end))?this.updateNodeValue(d,p):this.deleteSingleWord(d,this.findIndex(d)),this.update_count(p.length-c)}var p,h=r[n];c=(p=this.getWordText(h.node)).length;p=p.slice(0,h.start)+p.slice(i),this.update_count(p.length-c),this.updateNodeValue(h.node,p),this.setCursor(t.currentNode,h.start==p.length?h.start:h.start+.5),this.resetRange(),this.check_rtl(t.currentNode.parentNode),this.updateRangeNode()},deleteLine:function(){var t=this.data,e=t.currentNode,i=parseInt(t.cursor),a=this.getLWindex(e,t.cursor),o=a.lineIndex,n=a.wordIndex,r=a.lines[o],s=r.length;if(i==r[n].end)return this.delete();if(i==this.getWordText(e).length&&n==r.length-1)return o==a.lines.length-1&&this.mergePara(e,!0)?(this.setCursor(t.currentNode,t.cursor),this.updateRangeNode()):this.delete();this.updateRangeNode();for(var l=n+1;l<s;l++){var d=r[l],c=d.node,p=(h=this.getWordText(c)).length;(h=h.slice(0,d.start)+h.slice(d.end))?this.updateNodeValue(c,h):this.deleteSingleWord(c,this.findIndex(c)),this.update_count(h.length-p)}var h,u=r[n];p=(h=this.getWordText(u.node)).length;h=h.slice(0,i)+h.slice(u.end),this.update_count(h.length-p),this.updateNodeValue(u.node,h),this.setCursor(t.currentNode,Math.min(h.length,i+(i==u.start?.5:0))),this.resetRange(),this.check_rtl(t.currentNode.parentNode),this.updateRangeNode()},getBcr:function(t,e){var i=t.getBoundingClientRect();return e?i[e]:i},break_rgx:function(){return this.__break_rgx||(this.__break_rgx=["32","160","11","16","17","18","28","3","14","15","61183","61182","19","13","10","9","96","126","33","64","35","36","37","94","38","42","40","41","8211","8212","45","95","43","61","124","123","125","91","93","59","58","34","8220","65533","63","47","92","46","44","8222","60","171","187","62","191","161"].map((function(t){return String.fromCharCode(Number(t))})))},split_word:function(t){if(!t)return[""];for(var e,i=this.break_rgx(),a=new RegExp("[\\u0028\\u005B\\u00AB\\u2018\\u201C\\u3008\\u300A\\u300C\\u300E\\u3010\\u3014\\u3016\\u3018\\u301D\\uFF08\\uFF3B\\uFF5F\\uFF5B]*[\\u2F00-\\u30FF\\u3190-\\u319F\\u31C0-\\u3AEF\\u4E00-\\u9FCF\\uF900-\\uFAFF\\uFE10-\\uFE1F\\uFE30-\\uFE4F\\uFF00-\\uFFEF][\\u002C\\u0029\\u005D\\u00BB\\u2019\\u201D\\u3001\\u3009\\u300B\\u300D\\u300F\\u3011\\u3015\\u3017\\u3019\\u301F\\u3005\\u303B\\u30FC\\u30FD\\u30FE\\u30A1\\u30A3\\u30A5\\u30A7\\u30A9\\u30C3\\u30E3\\u30E5\\u30E7\\u30EE\\u30F5\\u30F6\\u3041\\u3043\\u3045\\u3047\\u3049\\u3063\\u3083\\u3085\\u3087\\u308E\\u3095\\u3096\\u31F0\\u31F1\\u31F2\\u31F3\\u31F4\\u31F5\\u31F6\\u31F7\\u31F8\\u31F9\\u31FA\\u31FB\\u31FC\\u31FD\\u31FE\\u31FF\\u2010\\u2013\\u301C\\u30A0\\u0021\\u002E\\u003A\\u003B\\u003F\\u203C\\u2047\\u2048\\u2049\\u3001\\u3002\\u30FB\\uFF01\\uFF1F\\uFF09\\uFF3D\\uFF5D\\uFF60]*","gm"),o=[],n=t.length,r="",s=0;s<n;s++){var l=t[s];(e=a.test(l)||i.indexOf(l)+1)?(o.push(r),r=""):r+=l}return(r||e)&&o.push(r),o},getValueForAlt:function(t,e,i,a){var o,n=this.getWordText(t).slice(i?e:0,i?void 0:e),r=this.split_word(n),s=this.findIndex(t),l=a?0:1;if(1!=r.length)return{node:t,change:i?this[i?"first":"last"](r).length+l+e:e-(this[i?"first":"last"](r).length+l)};if(!i&&0==s.wordIndex&&(e&&a||!e))return{node:t,change:0};if(i&&n&&s.wordIndex==$L(t).parent().data("list").length-1)return{node:t,change:n.length+e};if(o=this[i?"getNextWord":"getPreviousWord"](t,!0,a)){var d,c=(d=i?this.getValueForAlt(o,0,!0,a):this.getValueForAlt(o,this.getWordText(o).length,!1,a)).node,p=d.change;if(i){if(p)return d}else if(p!=this.getWordText(c).length)return d}return{node:t,change:i?this.getWordText(t).length:0}},getNextWord:function(t,e,i,a){var o,n=this.findIndex(t),r=t.parentNode,s=$L(r),l=s.data("list"),d=s.closest(".listHolderElement").get(0),c=$L(d).data("list"),p=n.wordIndex,h=n.paraIndex,u=function(){return o.classList.contains("lyteEditorMentionWord")&&o.classList.contains("lyteReadonlyNode")&&a?(this._hadMention=!0,this.getNextWord(o,e,i,a)):o}.bind(this);if(p==l.length-1){if(h==c.length-1){if(e)return;return o=this.getNextElement(d),fn=function(){var t=s.closest(this.getTag("word")).get(0);if(t)return this.getNextWord(t)}.bind(this),o?this.getPreviousElement(o)==d?this.getFirstWordInPara(this.first($L(o).data("list"))):fn():fn()}if(i)return;return o=this.getFirstWordInPara(c[h+1]),u()}return o=l[p+1],u()},getPreviousWord:function(t,e,i,a){var o,n=this.findIndex(t),r=t.parentNode,s=$L(r),l=s.data("list"),d=s.closest(".listHolderElement").get(0),c=$L(d).data("list"),p=n.wordIndex,h=n.paraIndex,u=function(){return o.classList.contains("lyteEditorMentionWord")&&o.classList.contains("lyteReadonlyNode")&&a?(this._hadMention=!0,this.getPreviousWord(o,e,i,a)):o}.bind(this);if(0==p){if(0==h){if(e)return;return o=this.getPreviousElement(d),fn=function(){var t=s.closest(this.getTag("word")).get(0);if(t)return this.getPreviousWord(t)}.bind(this),o?this.getNextElement(o)==d?this.getLastWordInPara(this.last($L(o).data("list"))):fn():fn()}if(i)return;return o=this.getLastWordInPara(c[h-1]),u()}return o=l[p-1],u()},getNextElement:function(t){var e=$L(t),i=e.parent().closest(".listHolderElement",this.$node);if(i.length){if((this._vert||this.__shiftmove)&&-1!=this.getIndex([this.getTag("td"),this.getTag("th")],this.getTagName(t))){var a=this.table_next(e,t);if(a)return a}var o=this.changeToTopLevelForTable(this.toArray(i.find(".listHolderElement")).filter((function(t){return"none"!=t.style.display}))),n=this.getIndex(o,t);return n==o.length-1?this.getNextElement(i.get(0)):o[n+1]}},changeToTopLevelForTable:function(t){return t},getPreviousElement:function(t){var e=$L(t);if(e.parent().closest(".listHolderElement",this.$node).length){if((this._vert||this.__shiftmove)&&-1!=this.getIndex([this.getTag("td"),this.getTag("th")],this.getTagName(t))){var i=this.table_prev(e,t);if(i)return i}return $L(this.getPreviousWord($L(t).closest("lyte-word")[0])).closest(".listHolderElement")[0]}},deleteSingleWord:function(t,e,i){var a=t.parentNode,o=$L(a),n=o.data("data"),r=o.data("list"),s=e.wordIndex;i=i||e.id,n.data.splice(s,1),r.splice(s,1),t.remove(),this.isUndo()||this.pushToQueue({operation:"wordDelete",data:$L(t).data("data"),index:e,id:i})},insertSingleWord:function(t,e,i){i=e.id||i;var a=$L("#"+i,this._maindiv.parentNode).data("list")[e.paraIndex],o=$L(a),n=o.data("data"),r=o.data("list"),s=this.render(t),l=e.wordIndex,d=Lyte.Component;return n.data.splice(l,0,t),r.splice(l,0,s),1==r.length?this.append(a,s):0==l?d.insertBefore(r[1],s):d.insertAfter(r[l-1],s),this.isUndo()||this.pushToQueue({operation:"wordInsert",data:t,index:e,id:i}),s},convertToParaFormat:function(t){return this.extend($L(t).data("data"))},removePara:function(t){var e=$L(t),i=e.closest(".listHolderElement"),a=i.data("list"),o=i.data("data"),n=this.getIndex(a,t);if(this.data.ltPropCountNewLine&&this.update_count_in_delete(o,n,a.length),a.splice(n,1),(o.data||o).splice(n,1),this.isUndo()||this.pushToQueue({operation:"paragraphRemove",data:e.data("data"),id:i.data("randomId"),index:n}),t.remove(),!this.isUndo()){var r=i.get(0);this.tabCheck(r),this.blockquote_check(r)}},resetRange:function(t){Lyte.objectUtils(this.data.range,"add","isRange",!1),$L(this.$node).removeClass("lyteTextSelected"),this.setData("isTextSelected",!1),this.resetOverlay(t),this.copyToRange(),t&&this.reset()},resetOverlay:function(t){var e=this.data,i=e.activeOverlay;i.forEach((function(e){t?e.remove():$L(e).attr("style","").addClass("inActive").removeClass("lyteEditorFirst","lyteEditorLast").data({start:"",end:"",node:""})})),t&&(i.splice(0),e.selectedParagraph.splice(0))},pushIfNot:function(t,e){-1==this.getIndex(t,e)&&t.push(e)},getCrctPara:function(t,e){var i=$L(t).closest(".listHolderElement").data("list");return i[this.getIndex(i,t)+1*(e?1:-1)]},mergePara:function(t,e){var i=t.parentNode,a=this.getCrctPara(i),o=$L(i).closest(".listHolderElement"),n=o.data("list"),r=$L(a).data("data");if(a&&!this.isImage(r)&&!this.isTable(r)&&!this.isHr(r)){var s,l=this.convertToParaFormat(i),d=this.convertToParaFormat(a),c=d.data.length,p=this.data.currentNode.parentNode==a,h={wordIndex:c+(p?-1:0),position:p?this.data.cursor:0};return Lyte.arrayUtils(d.data,"push",l.data),s=this.render(this.removeEmptyWordsData(d,h)),this.setData("currentNode",$L(s).data("list")[h.wordIndex]),this.setData("cursor",h.position),this.pushParagraph(s,o,this.getIndex(n,i)),this.removePara(i),this.removePara(a),this.check_rtl(s),!0}},alterParasToDelete:function(t,e,i){var a={};for(var o in i.forEach(function(e){var i=e.parentNode,o="para"+this.getIndex(t,i),n=a[o];n||(n=a[o]={para:i,value:0,array:[]}),n.value++,n.array.push(e)}.bind(this)),a){var n=a[o];if(n){var r=n.para,s=$L(r).data("list");n.value==s.length?i.forEach(function(t,e){-1!=this.getIndex(s,t)&&i.splice(e,1)}.bind(this)):(t.splice(this.getIndex(t,r),1),this.pushIfNot(e,r))}}},removeSelected:function(t,e,i){var a=this.data,o=a.ltPropParaToWordStyle||[];if((t=t||a.range).isRange){this.update_count(-_lyteUiEditor.limitFilter(this.getSelectedText(e),1/0,!0,!0).length),this.updateRangeNode();var n,r=a.selectedWords,s=a.topLevelElement,l=[],d=[],c=[],p=[],h=a.currentNode,u=0,m=this.getPreviousWord(r[0].node),f=this.getNextWord(this.last(r).node);if(r.forEach(function(t){var e=this.getWordText(t.node);0==t.left&&t.right==e.length?(d.push(t.node),this.pushIfNot(p,t.node.parentNode)):(l.push(t),this.pushIfNot(c,t.node.parentNode))}.bind(this)),this.alterParasToDelete(p,c,d),c.forEach(function(t){var e=this.getIndex(p,t);-1!=e&&p.splice(e,1)}.bind(this)),s&&this.changeToTopLevel(p,s)||!s&&this.changeToTopLevelForTable(p),p.forEach(function(t,i){var a=$L(t).closest(".listHolderElement"),r=a.data("list");if(1==r.length||e||0==i&&!c.length){var s=this.extend($L(t).data("data"));s.data=[this.emptyWordData()],o.forEach((function(t){delete s.style[t]})),delete s.style.color,delete s.style["--lyte-texteditor-li-color"];var d=this.render(s);n||(n=d),this.pushParagraph(d,a,this.getIndex(r,t)),c.unshift(d),l.unshift({node:d.children[0],left:0,right:0})}if(t.contains(m))m=this.getLastWordInPara($L(t).prev(this.getTag("paragraph")).get(0));else if(!m){var p=$L(t).next(this.getTag("paragraph")).get(0);f=p?this.getFirstWordInPara(p):void 0}this.removePara(t)}.bind(this)),l.length)l.forEach(function(t,e){var a=t.node,o=this.getWordText(a);null!=i&&this.data.ltPropMobileView&&a==h?(this.updateNodeValue(a,i),u=window.getSelection().getRangeAt(0).startOffset,t.left=0==e?u:t.left):this.updateNodeValue(a,o.slice(0,t.left)+o.slice(t.right))}.bind(this));else{var g,y=n?this.getFirstWordInPara(n):m,v=0;y&&-1==d.indexOf(y)?(g=y,v=this.getWordText(g).length):f&&(g=f),this.setData("currentNode",g),this.setData("cursor",v)}if(d.forEach(function(t){this._maindiv.contains(t)&&this.deleteSingleWord(t,this.findIndex(t))}.bind(this)),this.resetRange(!0),l.length){var b=l[0];b.node!=h&&this.data.ltPropMobileView&&(b.left+=u),this.setData("currentNode",b.node),this.setData("cursor",b.left),c.length>1?this.mergePara(this.getFirstWordInPara($L(c).get(-1)),void 0,i):c.forEach(this.check_rtl.bind(this))}this.updateRangeNode(),this.setCursor(a.currentNode,a.cursor,!1,!0),h=a.currentNode,this.isCodeEditor($L(h.parentElement).data("data"))&&this.insertTextInSnippet(h,h.parentElement,$L(h.parentElement).data("data")),this.callFind()}},changeToTopLevel:function(t,e){for(var i,a,o=$L(e).data("list"),n=function(t){return i=$L(t).parent().closest(this.getTag("paragraph")).get(0),$L(i).closest(".listHolderElement").get(0)!=e?n(i):i}.bind(this),r=0;r<t.length;r++){var s=t[r];if(-1==this.getIndex(o,s)){if(i=n(s),a=$L(i).data("data"),this.isImage(a)||this.isHr(a))continue;-1!=this.getIndex(o,i)&&-1==this.getIndex(t,i)?t.splice(r,1,i):t.splice(r,1),r--}}},updateRangeNode:function(){var t=this.data,e=t.range,i=e.isRange,a=t.currentNode,o=(t.cursor,e.startNode),n=e.endNode;this.updateNodeValue(a),i&&a!=o&&this.updateNodeValue(o,void 0,!0),i&&a!=n&&n!=o&&this.updateNodeValue(n,void 0,!0)},splitPara:function(t,e){this.data.range.isRange&&this.removeSelected();var i=this.data,a=i.currentNode,o=i.cursor,n=this.findIndex(a),r=a.parentNode,s=$L(r).closest(".listHolderElement"),l=this.convertToParaFormat(r),d=this.extend(l),c=n.wordIndex,p=n.paraIndex,h=l.data,u=h[c];if(!t&&this.isEmptyPara(l)&&-1!=this.getIndex(l.classList,i.tabClass))return this.tabpress([r],!0);if(this.isCaption(r))return;if(this.updateRangeNode(),this.isImage(d)||this.isHr(d)||$L(a).hasClass("lyteReadonlyNode"))d=this.emptyParaData();else{var m=d.data,f=u.text;m.splice(0,c),h.splice(c+1),m[0].text=f.slice(o),this.last(h).text=f.slice(0,o)}if(e&&this.isCodeEditor(d)){let t=d.classList.indexOf("lyteEditorCodeEditor");-1!=t&&d.classList.splice(t,1),delete d.details.snippet}var g=d.data,y=g[0];if(y&&y.details.anchor){if(y.text){var v=this.extend(y,{});v.text="",g.unshift(y=v)}this.remove_anchor_data(y)}let b=this.data.ltPropReplaceStyle;return this.data.ltPropWordToParaStyle.forEach((function(t){if(b.hasOwnProperty(t)){t=b[t].name}d.style[t]=d.data[0].style[t],null==d.style[t]&&delete d.style[t]})),this.data.ltPropCustomListColor&&-1!=d.classList.indexOf("lyteEditorTab")&&d.style.color&&(d.style["--lyte-texteditor-li-color"]=d.style.color),t?[l,d]:i.ltPropCountNewLine&&i.ltPropMaxlength==i.ltPropCharacterCount?i._undoqueue.splice(0):(this.pushParagraph(this.render(this.removeEmptyWordsData(l)),s,p+1),this.pushParagraph(this.render(this.removeEmptyWordsData(d)),s,p+2),this.removePara(r),this.setData("currentNode",this.getFirstWordInPara(s.data("list")[p+1])),this.setCursor(i.currentNode,0),this.updateRangeNode(),void this.callFind())},isEmptyPara:_lyteUiEditor.isEmptyPara,getLastWordInPara:function(t,e,i){var a=$L(t);return!e&&this.isTable(a.data("data"))?this.getLastWordInPara(this.last($L(this.last(Array.from(a.find(this.getTag("table")).find(this.getTag("th")+","+this.getTag("td"))).filter((function(t){return"none"!=t.style.display})))).data("list"))):!i&&_lyteUiEditor.isSection(a.data("data"))?this.getLastWordInPara(this.last(a.get(0).children[0].children[0].children)):this.last(a.data("list"))},getFirstWordInPara:function(t,e,i){var a=$L(t);return!e&&this.isTable(a.data("data"))?this.getFirstWordInPara(this.first($L(this.first(Array.from(a.find(this.getTag("table")).find(this.getTag("th")+","+this.getTag("td"))).filter((function(t){return"none"!=t.style.display})))).data("list"))):e||i||!_lyteUiEditor.isSection(a.data("data"))?this.first(a.data("list")):this.getLastWordInPara(this.first(a.get(0).children[0].children[0].children))},isTable:_lyteUiEditor.isTable,isHr:_lyteUiEditor.isHr,isImage:_lyteUiEditor.isImage,isCodeEditor:_lyteUiEditor.isCodeEditor,tab:function(t,e,i){var a=this.data,o=this.$node,n=a.currentNode,r=a.range,s=".listHolderElement";if(r.isRange){var l=$L(r.startNode).closest(s,o).get(0),d=$L(r.endNode).closest(s,o).get(0);if(l==d&&-1!=this.getIndex([this.getTag("th"),this.getTag("td")],this.getTagName(d)))return this.navigateInTable(d,e)}else{var c=$L(n).closest(s,o).get(0);if(-1!=this.getIndex([this.getTag("th"),this.getTag("td")],this.getTagName(c)))return this.navigateInTable(c,e)}if(this._suggestionWord)this.applySuggestion();else{var p=a.selectedParagraph,h=[];if(p.forEach(function(t){$L(t).data("data").details.tab&&h.push(t)}.bind(this)),h.length)this.tabpress(h,e);else if(!(r.isRange||e||t||i)){var u=this._editdiv;u.innerHTML=this.getSpaceForTab(),this.processInput(u)}}},isUpdateIcon:function(){return!!this._iconUpdate},iconUpdate:function(){this._iconUpdate=!0},removeIconUpdate:function(){delete this._iconUpdate},getDefaultValue:function(t,e){return e?this.data["ltProp"+e+"Style"][t]||"":{fontWeight:400,fontSize:"unset"}[t]||""},checkReplaceStyle:function(t,e,i,a){var o=(this.data.ltPropReplaceStyle||{})[t];o&&(t=o.name,e=a?o.fallBackValue:o.replaceValue),i[t]=e},checkWordToParaStyle:function(t,e,i,a){let o=this;a=a||{},(Object.keys(t.style)||[]).forEach((function(t){-1!=i.indexOf(t)&&null==e.style[t]&&(t=a[t]?a[t].name:t,o.checkReplaceStyle(t,"normal",e.style,!0))}))},toggleWordClass:function(t,e,i,a){var o=this.isUpdateIcon();o||this.updateRangeNode();var n,r,s=this.data,l=s.selectedWords,d=[],c=[],p=s.range,h=p.isRange,u=s.currentNode,m=s.cursor,f=-1!=this.getIndex(s.ltPropMultipleProperty,t),g=this,y=s.ltPropReplaceStyle,v=this.data.ltPropWordToParaStyle,b=t,x=y[t];if(x&&e&&(t=x.name,e=x.replaceValue,r=x.fallBackValue),l.forEach((function(i){var a=i.node,o=$L(a).data("data"),n=$L(a.parentElement).data("data"),r=o.style,s=function(t){t.push(i)},l={data:[o]};if(!g.isCodeEditor(n)&&!(h&&parseInt(i.left)==parseInt(i.right)||g.isImage(l)||g.isHr(l)))if(e)if(f)-1==g.getIndex(r[t]||"",e)?s(c):s(d);else{var p=r[t];if("fontSize"==t&&g.is_super(a)){var u=parseFloat(p);p=(isNaN(u)?13:Math.round(u/.7))+"px"}s(p==e?d:c)}else-1==g.getIndex(o.classList,t)?s(c):s(d)})),o)return{toApply:c,applied:d};/^(color|backgroundColor)$/i.test(t)&&(d=[]);var _=c>=d,P=_?c:d,L=!/^clearFormat|fontChange|anchorChange$/i.test(t);-1!=v.indexOf(b)&&(this.toggleParaClass(t,e,function(t){return this.is_fully_selected(t,l)}.bind(this),void 0,_),_||(_=!0,e=null!=r?r:"normal")),P.forEach((function(o){var r,s=o.node,l=parseInt(o.left),d=parseInt(o.right),c=g.getWordText(s),v=c.length,b=$L(s),x=b.data("data"),P=g.findIndex(s),w=x.style,I=x.classList;if(b.hasClass("lyteReadonlyNode")&&(l=0,d=v),e){var E,C={},T=w[t];if(C[t]=T,f)if(_)g.ifNotStyle(C,t,e);else{var N=C[t]||"",S=N.split(" "),k=g.getIndex(S,e);-1!=k&&(S.splice(k,1),N=C[t]=S.join(" ")),N||(N=C[t]=g.getDefaultValue(t,"Word")),N||-1==I.indexOf("lyteEditorAnchor")||(C[t]="unset")}else C[t]=_?e:g.getDefaultValue(t,"Word");if(E=C[t],T==E)return}else if(_){if(b.hasClass(t))return;r="addClass"}else{if(!b.hasClass(t))return;r="removeClass"}if(L&&i&&0==i(s,e?t:r,e?T:t,e?E:void 0))n=!0;else{var D=function(e,i){g.pushToQueue({operation:"class",prop:i||r,id:P.id,value:e||t,element:"arr:"+P.paraIndex+".data.arr:"+P.wordIndex})},$=a||[],A=function(t,e){$.forEach((function(i){var a=t.indexOf(i),o="removeClass";if(a+1){if(t.splice(a,1),e)return;D(i,o),b[o](i)}}))},M=[],U=g.is_super(s);if(0==l&&d==v){if(A(I),n=!0,!L)return i(s);if(r)b[r](t),_?I.push(t):I.splice(g.getIndex(I,t),1),D();else{var W=_lyteUiEditor.dasherize(t);if(E)w[t]=E,s.style.setProperty(W,E);else{W=_lyteUiEditor.dasherize(t);E?(w[t]=E,s.style.setProperty(W,E)):(delete w[t],s.style.removeProperty(W,E))}g.pushToQueue({operation:"styleSet",oldValue:T,newValue:E,prop:t,id:P.id,index:P,word:!0})}M.push(s)}else{var R,F=[],O=function(t,e,i){e||(P.wordIndex++,e=g.insertSingleWord(t.data,P));var a=function(e,i){if(i==s){if(h&&e>=t.left&&e<=t.right)return!0;if(!h&&e==t.left&&e==t.right)return!0}};if(i&&a(m,u)&&(g.setData("currentNode",e),g.setData("cursor",m-t.left)),h){var o=Lyte.objectUtils,n=p.left,r=p.right,l=t.left;i&&a(n,p.startNode)&&(o(p,"add","startNode",e),o(p,"add","left",n-l)),i&&a(r,p.endNode)&&(o(p,"add","endNode",e),o(p,"add","right",r-l))}return e};if(l&&F.push({data:g.copyWord(x,0,l),left:0,right:l}),L)if(R=g.copyWord(x,l,d),r){var B=R.classList;_?B.push(t):B.splice(g.getIndex(B,t),1)}else{var H=R.style;E?H[t]=E:delete H[t]}else{switch(t){case"clearFormat":R=g.emptyWordData();break;case"fontChange":case"anchorChange":i(R=g.extend(x))}if("clearFormat"==t){let t=s.closest(g.data.ltPropTags.paragraph),e=$L(t).data("data");for(let t in y){let i=y[t];e.style[i.name]&&e.style[i.name]==i.replaceValue&&(R.style[i.name]=i.fallBackValue)}}R.text=c.slice(l,d)}if(F.push({data:R,left:l,right:d}),v!=d&&F.push({data:g.copyWord(x,d,v),left:d,right:v}),M.push(s),3==F.length)g.updateNodeValue(s,c.slice(0,l)),O(F.shift(),s),F.forEach((function(t,e){var i=0==e;i&&A(t.data.classList,!0),M.push(O(t,void 0,i))}));else{var V=function(){var t=F.shift();A(t.data.classList,!0),M.push(O(t,void 0,!0))};l?(g.updateNodeValue(s,c.slice(0,l)),O(F.shift(),s),V()):(P.wordIndex--,V(),g.updateNodeValue(s,c.slice(d)),O(F.shift(),s))}}/lyteSubScript|lyteSuperScript/.test(t)&&M.forEach((function(t){g.check_sub_super(t,U)}))}})),this.updateRangeNode(),this.common_positioning(!0),n&&this.update_panel(),this.callFind()},is_super:function(t){var e=$L(t),i=this.data.ltPropTagConversion;return e.hasClass(i.sub)||e.hasClass(i.sup)},check_sub_super:function(t,e,i){var a=$L(t),o=this.is_super(a),n=a.data("data"),r=n.style.fontSize||"",s=r,l=parseFloat(r),d=isNaN(l);if(o?r=d?"smaller":l*(i||!e?.7:1)+"px":e&&(r=d?"":Math.round(l/.7)+"px"),s==r)return!0;var c=this.findIndex(t);this.pushToQueue({operation:"styleSet",oldValue:s,newValue:r,prop:"fontSize",id:c.id,index:c,word:!0}),n.style.fontSize=t.style.fontSize=r},toggleParaClass:function(t,e,i,a,o){var n=this,r=n.data,s=n._fakeSelectedPara||r.selectedParagraph,l=[],d=[];if(s.forEach((function(i){var a=$L(i).data("data");if(!n.isCodeEditor(a)&&!n.isImage(a)&&!n.isHr(a)){var o=function(t){t.push(i)};o(-1==(e?a.style[t]!=e?-1:0:n.getIndex(a.classList,t))?d:l)}})),this.isUpdateIcon())return{toApply:d,applied:l};o&&(l=[]);var c=d.length>l.length,p=r.currentNode,h=r.cursor;(c?d:l).forEach((function(o){var r,s,l=$L(o),d=l.data("data"),p=d.classList,h=d.style,u=o.style,m=d.details&&d.details.tab,f=e,g=n.findIndex(n.getFirstWordInPara(o)),y=function(e){n.pushToQueue({operation:"class",prop:s||"removeClass",id:g.id,value:e||t,element:"arr:"+g.paraIndex})},v=function(){n.pushToQueue({operation:"styleSet",oldValue:r,newValue:f,prop:t,id:g.id,index:g,paragraph:!0}),h[t]=f};if(!(n.isImage(d)||n.isHr(d)||i&&0==i(o,c))){if((a||[]).forEach((function(t){var e=p.indexOf(t);e+1&&(p.splice(e,1),l.removeClass(t),y(t))})),null!=f){if(c&&f==h[t])return}else{var b=l.hasClass(t);if(c&&b||!c&&!b)return}if(c)f?(u.setProperty(n.dasherize(t),f),n.data.ltPropCustomListColor&&"color"==t&&m&&m.customValue&&(t="--lyte-texteditor-li-color",u.setProperty(t,u.color),r=h[t],v(),t="color")):(s="addClass",p.push(t));else if(f){f=n.getDefaultValue(t,"Para");var x=n.dasherize(t);f?u.setProperty(x,f):u.removeProperty(x)}else s="removeClass",p.splice(n.getIndex(p,t),1);s?(l[s](t),y()):(r=h[t],v()),n.tabCheck(o.parentNode)}})),this.common_positioning(!0),p==r.currentNode&&h==r.cursor&&(delete this._fakeSelectedPara,this.update_panel(),this.checkPlaceholder()),this.callFind()},copyWord:function(t,e,i){return{text:t.text.slice(e,i),details:this.extend(t.details),classList:t.classList.slice(),style:this.extend(t.style),attr:this.extend(t.attr||{}),tag:t.tag}},mergeWords:function(t,e){for(var i,a,o=this.data,n=o.cursor,r=o.currentNode,s=o.range,l=s.isRange,d=$L(t).data("list"),c=d.length,p=d[0],h=$L(p).data("data"),u=Lyte.objectUtils,m=1;m<c;m++){var f=d[m],g=$L(f).data("data");if(this.compareTwoWords(g,h,void 0,e)){var y=s.startNode,v=s.endNode,b=h.text,x=b.length;f==r&&(!l||l&&f==y&&l&&f==v)&&this.updateRangeNode(),f==r&&this.setData({currentNode:p,cursor:n+x}),l&&f==y&&(u(s,"add","startNode",p),u(s,"add","left",s.left+x)),l&&f==v&&(u(s,"add","endNode",p),u(s,"add","right",s.right+x)),this.updateNodeValue(p,b+g.text),this.deleteSingleWord(f,this.findIndex(f)),c--,m--,a=!0,i=!0}else p=f,h=g}i&&this.updateRangeNode(),a&&this.common_positioning()},removeEmptyWords:function(t,e){for(var i=this.data,a=i.currentNode,o=i.range,n=$L(t).data("list"),r=n.length-1,s=0;s<r;s++){var l=n[s];a!=l&&o.startNode!=l&&o.endNode!=l&&(this.isEmptyPara({data:[$L(l).data("data")]})&&(this.deleteSingleWord(l,this.findIndex(l)),r--,s--))}this.mergeWords(t),e&&this.splitRtlWord(t)},compareTwoWords:function(t,e,i,a){var o=t.classList.slice(),n=e.classList.slice(),r=this.extend(t.style),s=this.extend(e.style),l=this.extend(t.details),d=this.extend(e.details),c=this.extend(t.attr)||{},p=this.extend(e.attr)||{};if(a||!l.tab&&!d.tab||(this.removeTabProp(l,r,c,o),this.removeTabProp(d,s,p,n)),l.type&&"mention"==l.type||d.type&&"mention"==d.type)return!1;var h=this.compareArray(o,n)&&this.compareObject(r,s,["width","display"].concat(a||[]))&&this.compareObject(d,l);if(h&&i&&(h=t.text==e.text),h&&this.getTag("word")==t.tag){if(this.data.ltPropWordAttributes&&("false"==c.editable||"false"==p.editable))return!1;h=this.compareObject(c,p,["id"])}return h},compareArray:function(t,e){if(t=t||[],(e=e||[]).length!=t.length)return!1;var i=!0;return e.every((function(e){return-1!=t.indexOf(e)||(i=!1)})),i},compareObject:function(t,e,i){t=t||{},e=e||{},(i=i||[]).forEach((function(i){delete t[i],delete e[i]}));var a=!0,o=Object.keys(t),n=Object.keys(e);return o.length==n.length&&(o.every(function(i){if(-1==n.indexOf(i))return a=!1;var o=t[i],r=e[i],s=r&&r.constructor;if(s==Object){if(!this.compareObject(r,o))return a=!1}else if(s==Array){if(!this.compareArray(r,o))return a=!1}else if(r!=o)return a=!1;return!0}.bind(this)),a)},common_positioning:function(t){var e=this.data;e.range.isRange?this.setRange():(t&&this.resetRange(t),this.setCursor(e.currentNode,e.cursor))},setStyle:function(t,e,i){var a,o=$L(t),n=o.data("data").style,r=n[e]||"",s=this.getTagName(t),l=s==this.getTag("table"),d=s==this.getTag("word"),c=s==this.getTag("paragraph");r!=i&&(n[e]=i,t.style[e]=i,"--tablevel"==e&&t.style.setProperty(e,i),l?a=this.findIndex(o.closest(this.getTag("word")).get(0)):d?a=this.findIndex(t):c&&(a=this.findIndex(this.getFirstWordInPara(t))),t=o.closest(".listHolderElement"),this.pushToQueue({operation:"styleSet",oldValue:r,newValue:i,prop:e,id:o.data("randomId")||a.id,index:a,table:l,word:d,paragraph:c}))},tabpress:function(){},tabCheck:function(){},getBulltet:function(t){var e=t.name;if(this[e]){var i=this[e](t.order,t.suffix);return t.lower&&(i=(i||"").toLowerCase()),i}return"custom"==e?t.conversionName:e},number:function(t,e){return t+(e||"")},katakana:function(t,e,i){var a=["ア","イ","ウ","エ","オ","カ","キ","ク","ケ","コ","サ","シ","ス","セ","ソ","タ","チ","ツ","テ","ト","ナ","ニ","ヌ","ネ","ノ","ハ","ヒ","フ","ヘ","ホ","マ","ミ","ム","メ","モ","ヤ","ユ","ヨ","ラ","リ","ル","レ","ロ","ワ","ヰ","ヱ","ヲ","ン"],o=a.length;return(t>48&&!i?this.katakana(parseInt((t-1)/48),"",!0):"")+a[(t%o||o)-1]+(e||"")},roman:function(t,e){var i={1:"I",4:"IV",5:"V",9:"IX",10:"X",40:"XL",50:"L",90:"XC",100:"C",400:"CD",500:"D",900:"CM",1e3:"M"},a=1;for(var o in i){if(t<=o)return i[t==o?t:a]+(t==o?"":this.roman(t-a))+(e||"");a=o}},alphabet:function(t,e){return String.fromCharCode(64+(t%26||26))+(t>26?this.alphabet(t-26):"")+(e||"")},zeronumber:function(t,e){return(t<10?"0":"")+t+(e||"")},selectAll:function(){var t=$L(this._maindiv).data("list"),e=this.getFirstWordInPara(this.first(t),void 0,!0),i=this.getLastWordInPara(this.last(t),void 0,!0),a=this.getWordText(i).length;(e!=i||0!=a||$L(i).hasClass("lyteEditorImage")||"section"===$L(i).data("data").details.type)&&(this.setData("range",{isRange:!0,startNode:e,endNode:i,left:0,right:a}),this.setData("currentNode",e),this.setData("cursor",0),this.setRange())},queueset:function(){var t=this.data,e=t._undoqueue;if(e.length){var i=t.undoqueue;t.undoqueue.push(e.splice(0)),clearTimeout(this._undotime),t.redoqueue=[];var a=t.ltPropMaxUndoCount,o=i.length;null!=a&&o>a&&i.splice(0,o-a)}},undo:function(){this._suggestionWord&&this.removeSuggestion();var t=this.data,e=t.undoqueue,i=t.redoqueue;if(this.queueset(),e.length){var a=e.pop();i.push(a),this.handleDo(a,!0),this.callFind()}},redo:function(){this._suggestionWord&&this.removeSuggestion();var t=this.data,e=t.undoqueue,i=t.redoqueue;if(this.queueset(),i.length){var a=i.pop();e.push(a),this.handleDo(a),this.callFind()}},handleDo:function(t,e){this._undomode=!0,e&&(t=this.toArray(t).reverse());var i=this.data,a=i.currentNode,o=i.cursor,n=e?"undo":"redo";t.forEach(function(t){this["do"+this.getCorrectOp(t.type,e)](t,e),this.call_queue_push(t,n)}.bind(this));var r=i.currentNode,s=i.cursor;this.common_positioning(!0),r==a&&s==o&&this.checkPlaceholder(),delete this._undomode,this.callQueueUpdate(n),null==this._nodeTime&&this.update_panel()},getCorrectOp:function(t,e){return{update:"Update",styleSet:"StyleSet",spanSet:"SpanSet",tablevelUpdate:"TablevelUpdate",meta:"Meta",properties:"Properties",attribute:"Attribute"}[t]||{undo:{paragraphRemove:"ParagraphCreate",paragraphCreate:"ParagraphRemove",rowCreate:"RowDelete",rowDelete:"RowCreate",cellInsert:"CellDelete",cellDelete:"CellInsert",wordDelete:"WordInsert",wordInsert:"WordDelete",mention:"AddMention",addClass:"RemoveClass",removeClass:"AddClass"},redo:{paragraphCreate:"ParagraphCreate",paragraphRemove:"ParagraphRemove",rowCreate:"RowCreate",rowDelete:"RowDelete",cellInsert:"CellInsert",cellDelete:"CellDelete",wordDelete:"WordDelete",wordInsert:"WordInsert",mention:"RemoveMention",addClass:"AddClass",removeClass:"RemoveClass"}}[e?"undo":"redo"][t]},doAttribute:function(t,e){var i=t.operations,a=$L(this.get_element_from_opr(i)),o=this.get_data_from_opr(i),n=this.do_parse(t.value)[this.get_name(e)],r=o.data,s=o.value;n?(r[s]=n,a.attr(s,n)):(delete r[s],a.removeAttr(s))},doProperties:function(t,e){var i=t.operations,a=this.get_data_from_opr(i),o=this.do_parse(t.value)[this.get_name(e)],n=a.data,r=a.value;o?n[r]=o:delete n[r]},doAddClass:function(t){var e=t.operations,i=this.get_element_from_opr(e),a=this.get_data_from_opr(e+".x"),o=t.value;$L(i).addClass(o),o.split(" ").forEach(function(t){this.pushIfNot(a.data.classList,t)}.bind(this))},doRemoveClass:function(t){var e=t.operations,i=this.get_element_from_opr(e),a=this.get_data_from_opr(e+".x"),o=t.value,n=a.data.classList;$L(i).removeClass(o),o.split(" ").forEach(function(t){n.splice(this.getIndex(n,t),1)}.bind(this))},doStyleSet:function(t,e){var i=t.operations,a=this.get_element_from_opr(i),o=this.get_data_from_opr(i),n=this.do_parse(t.value),r=this.get_name(e),s=o.value,l=n[r],d=a.style,c=_lyteUiEditor.dasherize(s);""==l||null==l?delete o.data[s]:o.data[s]=l,l?d.setProperty(c,l):d.removeProperty(c)},get_element_from_opr:function(t){var e=t.match(/(arr:(\d+))/g)||[],i=this._maindiv,a=$L(i).data("list");return e.forEach((function(t){var e=t.match(/arr:(\d+)/)[1];i=a[e],a=$L(i).data("list")})),i},get_number:function(t){if(/^arr/.test(t))return parseInt(t.replace("arr:",""))},get_data_from_opr:function(t){var e=t.split("."),i=e.pop(),a=$L(this._maindiv).data("data");return e.forEach(function(t){var e=this.get_number(t);a=a[null==e?t:e]}.bind(this)),{data:a,value:i}},get_name:function(t){return t?"oldValue":"newValue"},do_parse:function(t){return JSON.parse(t)},doMeta:function(t,e){var i=this.get_element_from_opr(t.operations),a=this.do_parse(t.value),o=this.data.range,n=this.checkIfAvailable(a.start),r=this.checkIfAvailable(a.end),s=a.index;this.checkIfAvailable(s)&&(this.setData("currentNode",i),this.setData("cursor",s.position)),n&&(o.startNode=i,o.left=a.start.position),r&&(o.endNode=i,o.right=a.end.position),Lyte.objectUtils(o,"add","isRange",!(!n&&!r)),n||r||this.copyToRange(),a.bluepencil&&this.blue_undo(a,e)},doUpdate:function(t,e){var i=t.operations,a=this.get_element_from_opr(i),o=this.do_parse(t.value)[this.get_name(e)];this.update_count(o.length-this.getWordText(a).length),this.updateNodeValue(a,o)},doParagraphRemove:function(t){this.doRowDelete(t)},doParagraphCreate:function(t){var e=t.operations.split("."),i=e.pop(),a=this.get_element_from_opr(e.join(".")),o=this.get_number(i),n=this.render(this.do_parse(t.value));this.pushParagraph(n,a,o),this.update_count(_lyteUiEditor.limitFilter(n,1/0,!0).length)},doWordDelete:function(t){this.doRowDelete(t)},doRowDelete:function(t){var e=t.operations,i=this.get_element_from_opr(e),a=this.get_data_from_opr(e),o=this.get_number(a.value),n=Lyte.arrayUtils;this.data.ltPropCountNewLine&&/paragraph/i.test(t.type)&&this.update_count_in_delete(a.data[o],o,a.data.length),n(a.data,"removeAt",o),n($L(i.parentNode).data("list"),"removeAt",o),this.update_count(-_lyteUiEditor.limitFilter(i,1/0,!0).length),i.remove()},doWordInsert:function(t){var e=t.operations.split("."),i=this.get_number(e.pop());e.pop();var a=this.get_number(e.pop()),o=this.get_element_from_opr(e.join(".")),n=(t.data,this.insertSingleWord(this.do_parse(t.value),{paraIndex:a,wordIndex:i},$L(o).data("randomId")));this.update_count(_lyteUiEditor.limitFilter(n,1/0,!0).length)},checkIfAvailable:function(t,e){return e=e||"wordIndex",(t=t||{}).hasOwnProperty(e)&&!isNaN(t[e])},callQueueUpdate:function(t){var e=this.data,i=e.undoqueue,a=e.redoqueue,o=this.$node,n=o.panel;n&&n.undoRedo(i,a),this.execute("onUndoRedoQueueUpdate",i,a,t,o),t&&e.ltPropAutoAdjustHeight&&this.update_height()},textChange:function(t,e){var i=this,a=i.data,o=a.ltPropMaxMargin,n=a.ltPropMarginIncrease;if(null==o){var r=i._maindiv,s=r.offsetWidth,l=r.offsetHeight<r.scrollHeight;o=s-n-(l?_lyteUiUtils.getScrollBarWidth():0)-parseFloat(this.comp_style(r).paddingInlineEnd)}i.toggleParaClass("fakeClass",void 0,(function(r){var s=$L(r);if(s.closest("."+a.ltPropHeaderTags.join(",.")).length)return!1;var l=s.data("data").style,d=i.findIndex(i.getFirstWordInPara(r)),c=l[e]||"0px",p=(c+"").match(/(px|pt|cm|mm|in|em|rem|%)/i)[0],h=parseFloat(c),u=Math.max(0,Math.min(o,h+t*n))+p;return c!=u&&(i.pushToQueue({operation:"styleSet",oldValue:l[e],newValue:u,prop:e,id:d.id,index:d,paragraph:!0}),l[e]=u,r.style.setProperty(i.dasherize(e),u)),!1}))},firstUppercase:function(t){return t.replace(/^./,(function(t){return t.toUpperCase()}))},textIndentDecrease:function(){return this._textindex(!0)},textIndentIncrease:function(){return this._textindex()},_textindex:function(t){var e=this.data.selectedParagraph.slice().reverse(),i=[],a=[],o=[],n=[];if(e.forEach(function(t){var e=$L(t);e.hasClass("lyteEditorTab")?this.tab_check_for_indent(e,i,a):this.pushIfNot(a,t)}.bind(this)),this.isUpdateIcon()){let e,r=this.data.ltPropMaxMargin,s=this.data.ltPropListLevel;return a.forEach((i=>{e=$L(i).data("data"),((t?"0px"===e.style.marginInlineStart||!e.style.marginInlineStart:e.style.marginInlineStart===r+"px")?o:n).push(i)})),i.forEach((i=>{e=$L(i).data("data"),((t?1===e.attr.tabLevel:e.attr.tabLevel===s)?o:n).push(i)})),o.length&&n.length&&(o=[]),{applied:o,toApply:n}}if(t)for(var r=i.length,s=0;s<r;s++){1==$L(i[s]).data("data").attr.tabLevel&&(i.splice(s--,1),r--)}i.length&&this.tabpress(i,t),this._fakeSelectedPara=a;var l=this.textChange(t?-1:1,"marginInlineStart");return delete this._fakeSelectedPara,this.callFind(),l},formatDOM:function(t){var e=[];return t.forEach(function(t){Lyte.arrayUtils(e,"push",this.processDivFormat(this.get_modified_elem(t)))}.bind(this)),e},mergeMultipleStyleProperty:function(t,e){var i=t.split(" "),a=e.split(" ");return Array.from(new Set(i.concat(a))).join(" ")},copyStyle:function(t,e){var i=($L(t).attr("style")||"").split(";"),a=this.data.ltPropMultipleProperty||[];return i.forEach(function(t){var i=t.trim().split(": "),o=this.camelCase(i[0]),n=e.style[o],r=i[1];/px/i.test(n)&&/px/i.test(r)?e.style[o]=parseInt(r)+parseInt(n)+"px":n&&!/initial|inherit/i.test(n)||!r?-1!=a.indexOf(o)&&n!=r&&(e.style[o]=this.mergeMultipleStyleProperty(r,n)):e.style[o]=r}.bind(this)),e},check_low_tags:function(t){var e=this.getTagName(t);if(!e)return t;var i,a=t.style,o=$L(t),n=this.ifNotStyle.bind(this);switch(e){case"b":case"strong":n(a,"fontWeight","bold");break;case"i":case"em":case"cite":case"dfn":case"var":n(a,"fontStyle","italic");break;case"u":case"ins":n(a,"textDecoration","underline");break;case"del":case"strike":case"s":n(a,"textDecoration","line-through");break;case"mark":n(a,"backgroundColor","yellow");break;case"small":n(a,"fontSize","smaller");break;case"bdo":n(a,"direction",o.attr("dir")||"");break;case"big":n(a,"fontSize","2em");break;case"center":n(a,"textAlign","center");break;case"code":case"kbd":case"samp":n(a,"fontFamily","monospace");break;case"dt":case"dd":case"detail":case"summary":case"length":case"fieldset":case"footer":case"header":case"main":i="div";break;case"dir":i="ul";break;case"pre":n(a,"fontFamily","monospace"),n(a,"whiteSpace","pre");break;case"font":n(a,"color",o.attr("color")),n(a,"fontSize",o.attr("size"))}return i&&(t=this.changeToNewDiv(t,Array.from(t.childNodes),"div")),t},remove_unwanted_style:function(t){var e={display:["contents","none"]};for(var i in e)-1!=e[i].indexOf(t[i]||"")&&(t[i]="")},get_modified_elem:function(t,e){var i=this.getTagName(this.check_low_tags(t));if(!i)return this.data.ltPropUrlDetection&&this.data.ltPropUrlDetectionOptions[this.__from?"paste":"insert"]?this.check_urls(t,e):t;var a=t,o=this.data,n=o.ltPropAllowedStyles,r=n.length,s=o.ltPropAllowedTags,l=s.word||[],d=l.length,c=s.paragraph||[],p=c.length,h=d&&-1==this.getIndex(l,i),u=p&&-1==this.getIndex(c,i),m="onNodeProcess",f=t.style;this.remove_unwanted_style(f||{}),h&&u&&(/^(p|div|span)$/i.test(i)||(t=/table|tr|td|th|tbody|thead|blockquote|li|ul|ol|h[1-6]/i.test(i)||"block"==f.display?this.replace_with(t,"p"):this.replace_with(t,"span"))),t.__processed=!0,r&&this.replace_styles(t,n);var g=f.marginLeft,y=f.marginRight,v=f.fontWeight,b=this._dir;return f&&(g&&(f.removeProperty("margin-left"),f["marginInline"+(b?"End":"Start")]=g),y&&(f.removeProperty("margin-right"),f["marginInline"+(b?"Start":"End")]=y),"bolder"==v&&(f.fontWeight="bold")),a!=t&&Lyte.Component.replaceWith(a,t),this.getMethods(m)&&this.executeMethod(m,t,this.$node),t},replace_styles:function(t,e){for(var i=t.style,a=i.length,o=[],n=0;n<a;n++){var r=i[n];-1==this.getIndex(e,r)&&o.push(r)}o.forEach((function(t){i.removeProperty(t)}))},replace_with:function(t,e){var i=document.createElement(e),a=Array.from(t.childNodes);return i.setAttribute("style",t.getAttribute("style")),a.forEach((function(t){i.appendChild(t)})),/input|textarea/i.test(t.tagName||"")&&(i.innerText=t.value),i},recursive_check:function(t){Array.from(t.childNodes||[]).forEach(function(t){t.constructor!=Text&&this.recursive_check(this.get_modified_elem(t))}.bind(this))},processDivFormat:function(t,e){var i=this,a=i.toArray(t.childNodes)||[],o=[],n=[],r=[],s=i.getTagName(t),l=function(a){(o.length||a)&&(n.push(i.changeToNewDiv(t,o,void 0,e)),o=[])},d=function(a){var o=i.processDivFormat(e?a:i.copyStyle(t,a));n.push.apply(n,o)},c=i.data,p=c.ltPropRestrict||[],h=c.ltPropAllowedTags||{},u=h.word||[],m=h.paragraph||[],f=/^(br|div|p|dl|ul|ol|blockquote|figure|dt|dd|caption-div|h[1-6]|hr)$/i;if(!(t.children||[]).length||/^(ul|ol|table)$/i.test(s))return/^(div|p|dl|blockquote|figure|dt|dd|h[1-6])$/i.test(s)&&!t.childNodes.length||-1!==this.getIndex(p,this.getTagName(t))?[]:(i.recursive_check(t),[t]);a.forEach((function(a,s){a.__processed||(a=i.get_modified_elem(a));var c=i.getTagName(a),h=a.style||{},u=!/inline/i.test(h.display||""),m=/^(block|flex|grid)$/i.test((a.style||{}).display||""),g="br"==c;if(a.hasAttribute&&a.hasAttribute("data-section"))!function(t){l();var e=t,a=i.formatDOM(i.toArray(t.childNodes)),o=document.createElement("div");e.innerHTML="",a.forEach((function(t){e.appendChild(t)})),o.appendChild(e),n.push(o)}(a);else if(-1!=i.getIndex(p,c)||g)g&&l(!0);else if((f.test(c)&&u||m)&&l(0===a.childNodes.length),f.test(c)&&u)d(a);else if("pre"!=c&&"pre"!=h.whiteSpace||!u)if("li"==c){var y=i.toArray(a.childNodes),v=[],b={elem:a,insert:[]};r.push(b),y.forEach((function(t){v.push(i.processDivFormat(t))})),v.reverse().forEach((function(t){b.insert.push(i.changeToNewDiv(a,t,"li",e))}))}else if(m)d(a);else{var x=i.processDivFormat(a);1==x.length&&x[0]==a?o.push(a):(o.length&&l(),x.forEach((function(e){i.copyStyle(t,e),n.push(e)})))}else{var _;o.length&&l(),Array.from(a.childNodes).forEach((function(t){var e=i.processDivFormat(t),a=i.getTagName(t),r=t.style||{};u=!/inline/i.test(r.display||""),m=/^(block|flex|grid)$/i.test(r.display||""),1!=e.length||e[0]!=t||f.test(a)&&u||m?(o.length&&l(),"br"==a&&_&&n.push(t)):o.push(t),_=a}))}})),r.forEach((function(t){t.insert.reverse().forEach((function(e){Lyte.Component.insertAfter(t.elem,e)})),t.elem.remove()}));var g=-1!=u.indexOf(s)||-1!=m.indexOf(s)?s:void 0;if(n.length);else if(!e)return[t];return o.length&&n.push(i.changeToNewDiv(t,o,g,e)),n},changeToNewDiv:function(t,e,i,a){var o=t.attributes||{},n=o.length,r=document.createElement(i||"div"),s=[],l=function(t,e,i){i.setAttribute(t,e)};if(e&&e.forEach((function(t){if(t.constructor==Text){var e=document.createElement("span");e.appendChild(t),s.push(t=e)}r.appendChild(t)})),!a)for(var d=0;d<n;d++){var c=o[d],p=c.nodeName,h=c.nodeValue;try{r.setAttribute(p,h),s.forEach(l.bind(this,p,h))}catch(t){}}return r},scrollIntoView:function(t,e){var i=this.data;t=t||i.currentNode;var a=$L.fastdom;a.clear(this.__fdm),this.__fdm=a.measure((function(){if(delete this.__fdm,this.$node&&this.$node.offsetParent&&t.parentNode&&!i.ltPropDisabled&&!i.ltPropReadonly){var o,n,r=this._maindiv,s=r.scrollHeight,l=r.offsetHeight,d=r.scrollTop,c=r.scrollWidth,p=$L(r).hasClass("lyteScrollbar")?0:_lyteUiUtils.getScrollBarWidth(),h=r.offsetWidth-(s>l?p:0),u=(r.scrollLeft,this.getLWindex(t,e)),m=this._cursor.style,f=parseFloat(m.top),g=parseFloat(m.height),y=this._pastediv,v=function(t){$L(y).css({left:m.left,right:m.right,top:t})},b=function(){var t=m.left,e=m.right,i=parseFloat(m.top),o=this;a.measure((function(){var n=r.scrollTop,s=r.offsetHeight,l=r.scrollLeft;a.mutate((function(){$L(o._editdiv).css({left:parseFloat(t)-l,right:parseFloat(e)-l,top:Math.min(i-n,s-parseFloat(m.height))+"px"})}))}))}.bind(this),x=$L(this.$node).hasClass("lyteEditorFocused"),_=i.ltPropScrollToOptions;if(l-=c>h?p:0,u){if(c>h){var P=parseFloat(m[this.rtlfunc("left")]||0);this._dir&&(P=c-P),n=Math.max(0,Math.min(P-.5*h,c-h))}if(f>d&&f+g<d+l)return null!=n&&(r.scrollLeft=n),b(),v(f-d);v(f-(o=Math.max(0,Math.min(f-.5*l,s-l)))),a.mutate((function(){if(i.ltPropPreventInitialScroll)return null!=n&&(r.scrollLeft=n),b(),this.setData("ltPropPreventInitialScroll",!1);if(i.ltPropPreventScroll&&!x)return null!=n&&(r.scrollLeft=n),b();var t={top:o};null!=n&&(r.scrollLeft=n),this._mup&&(_={}),_.onAfter=_.onAfter||b,_.axis="y",$L(r).scrollTo(t,_)}),this)}}}),this)},arrayExtend:function(t,e){return e.forEach(function(e){this.pushIfNot(t,e)}.bind(this)),t},is_fully_selected:function(t,e){var i=$L(t).data("list"),a=0;return e.forEach((function(e){var i=e.node;if(i.parentNode==t){var o=e.left,n=e.right;o||n!=$L(i).data("data").text.length||a++}})),i.length==a},reset_to_default:function(t,e,i,a,o){var n,r=$L(t),s=r.data("data"),l=s.style||{},d=s.attr||{},c=s.details||{},p=s.classList||[],h=a.style||{},u=a.attr||{},m=a.details||{},f=a.classList||[],g=this,y=function(t,e,i){for(var a in t){var o=t[a],n=e[a];o!=n?(i(a,o||"",n||""),delete e[a]):delete e[a]}for(var a in e)i(a,"",e[a])},v=function(t){return Object.fromEntries(Object.entries(t).reverse())};let b=v(d),x=v(l),_=v(c);y(b,u,(function(t,a,o){"id"!=t&&(o?(r.attr(t,o),d[t]=o):(r.removeAttr(t),delete d[t]),g.pushToQueue({operation:"attribute",prop:e+".attr."+t,id:i.id,oldValue:a,newValue:o}),n=!0)})),y(x,h,(function(e,a,s){/^\-\-/.test(e)?t.style.setProperty(e,s):r.css(e,s),s?l[e]=s:delete l[e],g.pushToQueue({operation:"styleSet",oldValue:a,newValue:s,prop:e,id:i.id,index:i,word:o,paragraph:!o}),n=!0})),y(_,m,(function(t,a,o){o?c[t]=o:delete c[t],g.pushToQueue({operation:"properties",prop:e+".details."+t,id:i.id,oldValue:a,newValue:o}),n=!0})),function(){for(var t=p.length,a=function(t,a){g.pushToQueue({operation:"class",prop:t,id:i.id,value:a,element:e}),r[t](a),n=!0},o=0;o<t;o++){var s=p[o],l=g.getIndex(f,s);l+1?f.splice(l,1):(p.splice(o--,1),t--,a("removeClass",s))}f.forEach((function(t){a("addClass",s),p.push(t)}))}(),n&&this.tabCheck(t.closest(".listHolderElement"))},clearFormat:function(t){var e=this.data,i=e.currentNode,a=t||e.ltPropClearParaProperties,o=t?0:e.ltPropClearParaOnFullSelection,n=this,r=n.emptyWordData(),s=n.emptyParaData(),l=e.selectedParagraph,d=[],c=[],p=e.selectedWords,h=[],u=e.range.isRange,m=[],f=this.data.ltPropWordToParaStyle||[],g=function(t){this.updateRangeNode(),t.forEach(function(t){f.forEach(function(e){var i,a=this.data.ltPropReplaceStyle||{};a.hasOwnProperty(e)&&(e=a[e].name),(i=t.style[e])&&(this._fakeSelectedPara=[t],this.toggleParaClass(e,i),delete this._fakeSelectedPara)}.bind(this))}.bind(this))}.bind(this);if(l.forEach((function(t){var e=$L(t).data("data");n.isEmptyPara(e,!0)||!n.is_fully_selected(t,p)||n.isCodeEditor(e)||m.push(t)})),a&&(u?h=m:o||h.push.apply(h,l)),this.isUpdateIcon()){var y=[],v=[];return p.forEach((function(t){var e=t.node,i=n.extend($L(e).data("data"));n.compareObject(i.details,r.details)&&n.compareObject(n.remove_merge_default(i.style),n.remove_merge_default(r.style),["display"])&&n.compareArray(i.classList,r.classList)?y.push(e):v.push(e)})),h.forEach((function(t){var e=$L(t).data("data");n.compareObject(e.details,s.details)&&n.compareObject(e.style,s.style)&&n.compareArray(e.classList,s.classList)&&n.compareObject(n.extend(e.attr),s.attr,["id"])?d.push(t):c.push(t)})),(v.length||c.length)&&(y=[],d=[]),{toApply:v.concat(c),applied:y.concat(d)}}if(u||!$L(i).hasClass("lyteEditorImage"))return h.length&&(this.updateRangeNode(),h.forEach((function(t){var e=n.getFirstWordInPara(t),i=n.findIndex(e),a="arr:"+i.paraIndex;n.reset_to_default(t,a,i,n.extend(s))}))),this.checkPlaceholder(),!a&&m.length?g(m):a&&!o&&g(l),n.toggleWordClass("clearFormat",void 0,(function(t){var e=n.findIndex(t),i="arr:"+e.paraIndex+".data.arr:"+e.wordIndex;return n.reset_to_default(t,i,e,n.extend(r),!0),!1}))},find:function(t,e){t?this.setFind(this.markFind(t,e)):this.resetFind()},moveFind:function(t){var e=this.data.findWords;if(e.length){var i,a=$L(".lyteEditorFindSeleced",this._maindiv),o=this.getIndex(e,a.eq(0).data("group"))+1*t;if(i=e[o=(o+e.length)%e.length]){a.removeClass("lyteEditorFindSeleced"),i.forEach(function(t){$L(t.dom).addClass("lyteEditorFindSeleced")}.bind(this));var n=i[0];this.scrollIntoView(n.node,n.start)}}},nextFind:function(){this.moveFind(1)},previousFind:function(){this.moveFind(-1)},resetFind:function(){var t=this.data.findWords;t.forEach((function(t){t.forEach((function(t){t.dom.remove()}))})),t.splice(0)},setFind:function(t){var e=[],i=this.data.findWords;t.forEach(function(t){var i=[];t.forEach(function(t){this.pushIfValid(i,this.copyInSameWord(t.word,t.start,t.end))}.bind(this)),e.push(i)}.bind(this)),this.resetFind(),e.forEach(function(e,a){e.forEach(function(i){var o=$L(this.renderNode(this.getTag("find")));o.css({left:i.left||"",width:i.width,right:i.right||"",top:i.top,height:i.height}),this.append(this._maindiv,o.get(0)),0==a&&o.addClass("lyteEditorFindSeleced"),i.dom=o.get(0);var n=t[a];o.data({group:e,word:i.node,start:n.start,end:n.end,previous:i.previousPartial,next:i.nextPartial})}.bind(this)),i.push(e)}.bind(this)),this.moveFind(0)},_replace:function(t,e){e=e||"",this.updateRangeNode();var i=[],a=[];t.reverse().forEach(function(t){t.reverse().forEach(function(t){var o,n,r=t.word,s=$L(r).closest(this.getTag("paragraph")).get(0),l=this.getIndex(i,s),d=a[l],c=this.findIndex(r),p=t.start,h=t.end;if(-1==l&&(i.push(s),d=this.convertToParaFormat(s),a.push(d)),n=(o=this.getText(d,c)).slice(0,p)+e+o.slice(h),this.setText(d,c,n),this.update_count(n.length-o.length),$L(t).hasClass("lyteEditorFindSeleced")){var u=this.toArray($L(r).children(this.getTag("find")));l=this.getIndex(u,t);this.setData("cursor",h+(l+1)*(h-p-e.length)),this.setData("currentNode",r)}}.bind(this))}.bind(this)),this.grpPara(i,a).forEach(function(t){var e=t.paras[0],i=this.isContainAlignedImage(e.para),a=i?void 0:t.paras.filter(function(t){return this.isImage(t.data)&&t.data.style.float}.bind(this));i||a?(i=i||e.para,this.minimumAlignRender(i,i,void 0,void 0,[],void 0,$L(t.paras).get(-1).para,t.paras)):this.minimumRendering(t.element,t.paras,t.width,void 0,[],0)}.bind(this)),this.resetFind(),this.resetRange(!0),this.setCursor(this.data.currentNode,this.data.cursor)},replace:function(t){this._replace([$L(".lyteEditorFindSeleced").data("group")],t)},replaceAll:function(t){this._replace(this.data.findWords,t)},markFind:function(t,e,i){var a=[],o=$L(i||this._maindiv).data("list");return e||(t=t.toLowerCase()),o.forEach(function(i){var o=$L(i).data("data");if(this.isImage(o)||this.isTable(o))return $L(i).find(".listHolderElement").each(function(i,o){this.pushIfValid(a,this.markFind(t,e,o))}.bind(this));this.pushIfValid(a,this.getTextInPara(i,t,e))}.bind(this)),a},getTextInPara:function(t,e,i){var a=this.convertParaToText(t),o=i?a.text:a.text.toLowerCase(),n=a.details,r=o.split(e),s=0,l=[],d=e.length;return r.forEach(function(t,e){0!=e?(l.push(this.wordsFormText(s,s+d,n)),s+=t.length+d):s+=t.length}.bind(this)),l},wordsFormText:function(t,e,i){var a=[],o=void 0;return i.every((function(i){var n=i.start,r=i.end,s={};return n<=t&&t<r&&(s.start=t-n),n<e&&e<=r&&(s.end=e-n),n>t&&e>r&&(s.start=0,s.end=r-n),s.start==o&&s.end==o||(s.end==o?(s.end=r-n,s.nextPartial=!0):s.start==o&&(s.start=0,s.previousPartial=!0),s.word=i.word,a.push(s)),!0})),a},convertParaToText:function(t){var e=$L(t).data("data"),i="",a=[],o=0;return e.data.forEach((function(e,n){var r=e.text,s=r.length;i+=r,o+=s,a.push({length:s,wordIndex:n,start:o-s,end:o,word:$L(t).data("list")[n]})})),{text:i,details:a}},pushIfValid:function(t,e){e&&e.constructor==Array||(e=[e]),e.forEach(function(e){e&&t.push(e)}.bind(this))},call_insert:function(t){return this.execute("onBeforeInsert",t,this.$node)},inline_image_html:function(t,e,i){e(t,i)},insertHTML:function(t,e){var i=this.call_insert(t);if(0!=i){var a=function(){var i=this.proceedPaste.bind(this);!e&&this.data.ltPropConvertInlineImages?this.inline_image_html(t,i):i(t)}.bind(this);i&&i.then?i.then((function(e){a(e||t)})):a()}},insertJSON:function(t){0!=this.call_insert(t)&&this._proceedPaste(t)},insertCodeText:function(t,e){t=t.replace(/\t/g,"    "),this.calculateCodeIndent(t);const i=$L.snippets.getBuilder(e.toLowerCase(),t).build().snippet;let a=this.convertSnippetToData(i,e.toLowerCase()),o=this.createSection({data:a});o.data[0].classList.push("lyteEditorCodeEditorContainer"),this._proceedPaste([o])},getCurrentParaClient:function(){return this.data.currentNode.parentElement.getBoundingClientRect()},calculateCodeIndent:function(t){var e="",i=0,a=[],o=[],n={},r=function(t){return n.indent=e,e="",t&&(n.value="",o.push(n),n={}),!0},s=function(){return n.indent=null==n.indent?"":n.indent,n.value=e,o.push(n),e="",n={},!0};for(var l of t)" "==l||" "==l?(2==i&&s(),e+=" ",i=0):"\n"==l?(2==i&&s()||0==i&&r(!0)||""!=e&&o.push({indent:e,value:""}),a.push(o),o=[],i=1):(0==i&&r(),e+=l,i=2);0==i&&r(!0)||2==i&&s(),a.push(o),this.data.spaceDetails=a},remove_style:function(t){var e=this,i=e.data,a=i.ltPropWordStyle||{},o=i.ltPropParaStyle||{},n=e.getTag("paragraph"),r=e.getTag("word"),s="onParaModification";t.forEach((function(t){var i,l=t.tag,d=t.style,c=void 0,p=t.data;if((i=l==n)?c=o:l==r&&(c=a),d&&c)for(var h in c)if(c[h]==d[h]){if("color"==h&&t.details.anchor)continue;delete d[h]}p&&e.remove_style(p),i&&e.getMethods(s)&&e.executeMethod(s,t,e.$node)}))},getJSON:function(){var t=$L(this._maindiv).data("list"),e=[];return t.forEach(function(t){e.push(this.mergeWordsData(this.convertToParaFormat(t),{},!0))}.bind(this)),this.data.ltPropRemoveDefaultStyle&&this.remove_style(e),e},mergeWordsData:function(t,e,i,a){this.removeEmptyWordsData(t,e,a);var o=t.data,n=o[0];if(i){var r=n.style;delete r.direction,delete r.unicodeBidi}for(var s=1;s<o.length;s++){var l=o[s];if(i){var d=l.style;delete d.direction,delete d.unicodeBidi}this.compareTwoWords(l,n)?(e&&e.wordIndex==s&&(e.wordIndex--,e.position+=n.text.length),n.text+=l.text,o.splice(s,1),e&&s<e.wordIndex&&e.wordIndex--,s--):n=o[s]}return i?t:this.splitRtlText(t,e,this.get_dir(t,!0))},removeEmptyWordsData:function(t,e,i){var a=t.data,o=a.length-1;let n=!1;if(0==o)return t;for(var r=0;r<=o;r++){let t=a[r];if(this.isEmptyPara({data:[t]})&&!n){if(e){var s=e.wordIndex;s!=r?r<s&&e.wordIndex--:(e.wordIndex--,e.position=0==r?0:a[r-1].text.length)}1!=a.length&&a.splice(r,1),o--,r--}n=t&&t.details&&"anchor"==t.details.type}return e&&e.wordIndex<0&&(e.wordIndex=0,e.position=0),t},splitRtlText:function(t,e,i){for(var a,o=t.data,n={},r=0,s=function(t,s,d,c){var p=this.extend(t),h=s.__isrtl;if(p.text=d,null==h[c]&&(h[c]=i),h[c]!=i){var u=p.style;u.unicodeBidi="bidi-override",u.direction=i?"ltr":"rtl"}n.index||(n.index=this.splitCursor(e,l,d,r,c)),Lyte.arrayUtils(o,"insertAt",a+c+1,p),r+=d.length},l=o.length-1;l>=0;l--){var d=o[l];if(d.text){var c=this.splitText(d.text,i,d,e,l);a=this.getIndex(o,d),r=0,c.forEach(s.bind(this,d,c)),Lyte.arrayUtils(o,"removeAt",a)}}return t},splitCursor:function(t,e,i,a,o){if(t&&t.wordIndex==e){var n=t.position;if(n>=a&&n<=a+i.length)return t.wordIndex=e+o,t.position=n-a,!0}},neutral:function(){return this.__neutral||(this.__neutral=new RegExp((t="",[91,45,33,36,37,94,38,42,64,40,41,95,43,124,35,126,61,96,123,125,92,91,92,93,58,34,59,39,8220,8221,60,62,63,44,46,92,92,92,47,48,45,57,92,102,92,114,92,110,92,118,92,120,50,48,92,117,48,48,65,48,92,117,48,48,48,101,92,117,48,48,48,102,92,117,48,48,49,51,48,45,57,178,45,179,185,188,45,190,1632,45,1641,1776,45,1785,1984,45,1993,2406,45,2415,2534,45,2543,2548,45,2553,2662,45,2671,2790,45,2799,2918,45,2927,3046,45,3058,3174,45,3183,3192,45,3198,3302,45,3311,3430,45,3445,3664,45,3673,3792,45,3801,3872,45,3891,4160,45,4169,4240,45,4249,4969,45,4988,92,117,49,54,101,101,45,92,117,49,54,102,48,6112,45,6121,6128,45,6137,6160,45,6169,6470,45,6479,6608,45,6617,6992,45,7001,7088,45,7097,7232,45,7241,7248,45,7257,8304,8308,45,8313,8320,45,8329,8531,45,92,117,50,49,56,50,92,117,50,49,56,53,45,92,117,50,49,56,56,9312,45,9371,9450,45,9471,10102,45,10131,11517,92,117,51,48,48,55,92,117,51,48,50,49,45,92,117,51,48,50,57,92,117,51,48,51,56,45,92,117,51,48,51,97,12690,45,12693,12832,45,12841,12881,45,12895,12928,45,12937,12977,45,12991,42528,45,42537,43216,45,43225,43264,45,43273,43600,45,43609,65296,45,65305,93,124,92,117,100,56,48,48,91,92,117,100,100,48,55,45,92,117,100,100,51,51,92,117,100,100,52,48,45,92,117,100,100,55,56,92,117,100,100,56,97,92,117,100,102,50,48,45,92,117,100,102,50,51,92,117,100,102,52,49,92,117,100,102,52,97,92,117,100,102,100,49,45,92,117,100,102,100,53,93,124,92,117,100,56,48,49,91,92,117,100,99,97,48,45,92,117,100,99,97,57,93,124,92,117,100,56,48,50,91,92,117,100,100,49,54,45,92,117,100,100,49,57,92,117,100,101,52,48,45,92,117,100,101,52,55,93,124,92,117,100,56,48,57,91,92,117,100,99,48,48,45,92,117,100,99,54,50,93,124,92,117,100,56,51,52,91,92,117,100,102,54,48,45,92,117,100,102,55,49,93,124,92,117,100,56,51,53,91,92,117,100,102,99,101,45,92,117,100,102,102,102,93].forEach((function(e){t+=String.fromCharCode(e)})),t)));var t},splitText:function(t,e,i,a,o){var n=t.length,r=/[\u0600-\u06EF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF\u0590-\u05FF\uFB1D-\uFB4F\u0700-\u074F\u0800-\u083F\u0840-\u085F]/,s=this.neutral();if(n&&r.test(t)){for(var l,d=[],c=(n=t.length,{N:void 0,R:!0,L:!1}),p=d.__isrtl=[],h=0;h<n;h++){var u=t[h],m=s.test(u),f=r.test(u);if(l==(_=m?"N":f?"R":"L"))d[d.length-1]+=u;else d.push(u),d.__isrtl.push(c[l=_])}var g=p[0];for(h=1;h<p.length;h++){var y=p[h],v=p[h+1];if(null!=g){var b=v==y;if((null==y||b&&g==e)&&(g==v||b)){d[h-1]+=d[h]+(d[h+1]||""),d.lsplice(h,2),p.lsplice(h,2),h--;continue}}else y==e&&(d[h-1]+=d[h],d.lsplice(h,1),p.lsplice(h-1,1),h--);g=y}return d}var x=[t||""];x.__isrtl=[void 0];for(let e=0;e<t.length;e++){var _=t[e];if(!s.test(_)){x.__isrtl=[!1];break}}return x},findFinalOccurence:function(t,e){for(let i=t.length-1;i>=0;i--)if(!e.test(t[i]))return i+1;return 0},splitRtlWord:function(t){for(var e,i,a=$L(t).data("list"),o=a.length,n=this.data,r=n.currentNode,s=n.range,l=s.isRange,d=s.startNode,c=s.endNode,p=n.cursor,h=s.left,u=s.right,m=Lyte.objectUtils,f=this.get_dir(t,!0),g=function(t,a){var o,n=this.copyWord(b,i,i+t.length),g=n.style,y=x.__isrtl;null==y[a]&&(y[a]=f),y[a]!=f?(g.unicodeBidi="bidi-override",g.direction=f?"ltr":"rtl"):(delete g.unicodeBidi,delete g.direction),P.wordIndex++,o=this.insertSingleWord(n,P),r==v&&p>=i&&p<=i+t.length&&(e||(this.updateRangeNode(),e=!0),this.setData("currentNode",o),this.setData("cursor",p-i)),l&&r==d&&h>=i&&h<=i+t.length&&(e||(this.updateRangeNode(),e=!0),m(s,"add","startNode",o),m(s,"add","left",h-i)),l&&r==c&&u>=i&&u<=i+t.length&&(e||(this.updateRangeNode(),e=!0),m(s,"add","endNode",o),m(s,"add","right",u-i)),i+=t.length}.bind(this),y=0;y<o;y++){var v=a[y],b=$L(v).data("data"),x=this.splitText(b.text,this.get_dir(v),b);i=0;var _=x.length;if(_>1||1==_&&!!x.__isrtl[0]!=!!f&&!b.style.unicodeBidi){e=!0;var P=this.findIndex(v);x.forEach(g),P.wordIndex-=_,this.deleteSingleWord(v,P)}}if(e)return this.updateRangeNode(),this.common_positioning(),!0},callCopy:function(t,e){var i="onBeforeCopy";if(this.getMethods(i)){var a=this.executeMethod(i,t,e,this.$node);null!=a&&(t=a)}return t},copyToClip:function(t){t.preventDefault();var e=this.getSelectedText(),i=t.clipboardData||window.clipboardData,a=this.callCopy(e,t)||"";i.setData("text/html",a),i.setData("text/plain",this.convert_html_to_txt(a))},convert_html_to_txt:function(t){var e=document.createElement("div"),i="",a=function(t){t.forEach((function(e,o){var n=e.tagName,r=Array.from(e.childNodes||[]);r.length&&a(r),/^(div|dt|dd|detail|summary|length|fieldset|footer|header|main|blockquote|p|caption-div|h[1-6]|hr|td|th|hr|img|video|br)$/i.test(n)?o+1!=t.length&&(i+="\n"):n||(i+=e.nodeValue)}))};return e.innerHTML=t,a(Array.from(e.childNodes)),i},getSelectedText:function(t){this.updateRangeNode();var e=this.data,i=e.selectedWords,a=e.selectedParagraph.slice(),o=e.topLevelElement,n=this.first(i),r=this.last(i),s=e.range,l=this.findIndex(n.node),d=this.findIndex(r.node),c=[];return s.isRange||t?o?(this.changeToTopLevel(a,o),a.forEach(function(t){var e=this.extend($L(t).data("data"));if(t.contains(n.node)){e.data.splice(0,l.wordIndex);var i=(a=e.data[0]).text;a.text=i.slice(n.left,n.right)}if(t.contains(r.node))if(n.node==r.node)e.data.splice(1);else{e.data.splice(d.wordIndex+1);var a;i=(a=this.last(e.data)).text;a.text=i.slice(r.left,r.right)}c.push(e)}.bind(this)),this.stringFromData(c,void 0,!0)):(this.changeToTopLevelForTable(a),this.tableCopy(a)):""},stringFromData:function(t,e,i){return _lyteUiEditor.jsonToString(t,this.construct_config(e,i))},construct_config:function(t,e){var i={};return["listVariable","tabSize","wordStyle","paraStyle","tdStyle","tableStyle","imageStyle","wordStyleConversion","captionStyle","paraStyleConversion","orderedList","unOrderedList","listStyle","defaultTable","anchorProperty","headerTags","tagConversion","wordAttributes","blockquoteClasses","convertStyle"].forEach(function(t){i[t]=this.data[_lyteUiEditor.camelCase("ltProp-"+t)]}.bind(this)),i.urlDetection=!e&&this.data.ltPropUrlDetection&&this.data.ltPropUrlDetectionOptions.output,i.fromCopy=e,i.component=this,i.customListColor=this.data.ltPropCustomListColor,e&&(i.listVariable=!1),i.crossOrigin=t,i},toggleUpperCase:function(t){this.selectWord(),$L.fastdom.measure(function(){this.toggleWordClass("textTransform",t?"uppercase":"lowercase")}.bind(this))},toggleLowerCase:function(){this.toggleUpperCase("lowercase")},toggleCaptilize:function(){this.toggleUpperCase("capitalize")},fontDecrease:function(){this.fontChange(-1,"fontSize")},fontIncrease:function(){this.fontChange(1,"fontSize")},fontChange:function(t,e){this.selectWord(),this.toggleWordClass("fontChange",void 0,function(i){var a,o=this.data,n=($L(i).data("data")||i).style,r=i.constructor!=Object,s=n[e]||this.getProp("fontSize",i),l=((s+"").match(/(px|pt|cm|mm|in|em|rem|%)/i)||[""])[0],d=this.is_super(i),c="smaller"==s?13:Math.round(parseFloat(s)/(d?.7:1)),p=r&&this.findIndex(i),h=i.style;return s==(a=n[e]=Math.max(1,Math.min(o.ltPropMaxFont,c+t*(d?.7:1)*o.ltPropFontIncrease))+l)||r&&(h.setProperty(this.dasherize(e),a),this.pushToQueue({operation:"styleSet",oldValue:s,newValue:a,prop:e,id:p.id,index:p,word:!0}),"fontSize"==e&&this.check_sub_super(i,void 0,!0)),!1}.bind(this))},removeHeaderContents:function(t,e){this.applyHeaderContents(t,e,!0)},applyHeaderContents:function(t,e,i){var a=_lyteUiEditor.getCorrectTag({classList:[e]}),o=this.data.ltPropParaChildConversion[a]||{},n=t.data("list"),r=this;n.forEach((function(t){var e,a=$L(t).data("data").style,n=t.style;for(var s in o){var l=i?r.getDefaultValue(s):o[s],d=a[s];l!=d&&(n.setProperty(r.dasherize(s),l),e=r.findIndex(t),r.pushToQueue({operation:"styleSet",oldValue:d,newValue:l,prop:s,id:e.id,index:e,word:!0}))}}))},headerTag:function(t){if(this.isUpdateIcon())return this.toggleParaClass(t);var e=this;return e.toggleParaClass(t,void 0,(function(i){var a=$L(i),o=a.data("data"),n=o.classList,r=e.findIndex(e.getFirstWordInPara(i));if(e.isCaption(o)||e.isImage(o)||e.isHr(o))return!1;var s=e.getIndex(n,e.data.tabClass);e.data.ltPropHeaderTags.forEach((function(i){var o=e.getIndex(n,i);i!=t&&-1!=o&&-1==s&&(n.splice(o,1),a.removeClass(i),e.pushToQueue({operation:"class",prop:"removeClass",id:r.id,value:i,element:"arr:"+r.paraIndex+".data.arr:"+r.wordIndex}),e.removeHeaderContents(a,i))})),t&&e.applyHeaderContents(a,t)})),!1},camelCase:_lyteUiEditor.camelCase,dasherize:_lyteUiEditor.dasherize,isCaption:function(t){return $L(t).closest(this.getTag("word"),this.$node).hasClass("lyteEditorImage")},convertTextToDestination:function(t){var e=this.convertHtmlToData(t),i=this.data.currentNode,a=this.convertToParaFormat(i.parentNode),o=this.findIndex(i),n=this,r=a.data[o.wordIndex],s=[];return a.data=[],e.forEach((function(t){var e=t.data;t.data=[];var i=n.extend(n.extend(a),t);e.forEach((function(t){t.style=n.extend(n.extend(r).style,t.style),i.data.push(t)})),s.push(i)})),s},convertTextToPlainData:function(t){(e=this.create("div")).innerHTML=this.check_limit(_lyteUiEditor.escapeText(t)).html;var e,i=(e=$L("<div>"+_lyteUiEditor.escapeText(e.innerText)+"</div>").get(0)).innerText.split("\n"),a=[];return i.forEach(function(t){var e=document.createElement("div");e.innerHTML=this.convertCase(this.filteroutMention(_lyteUiEditor.escapeText(t)));var i=this.formatPara(e);i.forEach((function(t){a.push(t)})),0==i.length&&a.push(this.emptyParaData())}.bind(this)),a},convertHtmlToData:function(t,e){var i,a,o=document.createElement("div"),n=function(t){let e=["COLGROUP","TBODY","THEAD","TFOOT","TR"],i=["TD","TH"];for(let a=0;a<t.childNodes.length;a++){let o=t.childNodes[a];"TABLE"===o.nodeName||-1!=e.indexOf(o.nodeName)?n(o):-1!=i.indexOf(o.nodeName)&&r(o)}},r=function(t){for(let e=0;e<t.childNodes.length;e++){let i=t.childNodes[e];if("TABLE"===i.nodeName)n(i);else if(i.nodeType==i.TEXT_NODE){let t=i.textContent.split("\n");if(t.length>1){let e=document.createDocumentFragment();t.forEach(((t,i)=>{i>0&&e.appendChild(document.createElement("br")),t.length>0&&e.appendChild(document.createTextNode(t))})),i.parentNode.replaceChild(e,i)}}else i.nodeType==i.ELEMENT_NODE&&r(i)}};return e?o=e:(t=this.check_limit(this.filteroutCaption(t.replace(/<meta charset=('|")utf-(\d+)('|")>/,""))).html,o.innerHTML=t,r(o),o.normalize()),i=this.formatDOM(this.toArray(o.childNodes)),o.children.length?a=this.formatHtml(this.formatbr(i)):(1==i.length&&i[0].constructor==Text&&(a=this.convertTextToPlainData(i[0].nodeValue)),a=this.formatHtml(i)),this.data.ltPropUrlDetectionOptions.paste&&(a=this.detectPasteUrls(a)),a},detectPasteUrls:function(t){let e=function(t){let i=t[t.length-1];return i.data?e(i.data):t},i=t.length?t[t.length-1]:[];if(i.data){let t=e(i.data);t[t.length-1].details&&"anchor"==t[t.length-1].details.type&&t.push(this.emptyWordData())}return t},formatbr:function(t){for(var e=t.length,i=function(t){return this.render({tag:t?"p":"br",text:t})},a=0;a<e;a++){var o=t[a];if(!o.tagName){var n=o.nodeValue,r=n.split("\n");if("\n"==n){t.splice(a,1,i.call(this,""));continue}if(1==r.length)continue;""==r[0]&&r.shift(),""==r[r.length-1]&&r.pop(),t.splice(a,1);var s=r.map(i.bind(this));Lyte.arrayUtils(t,"insertAt",a--,s),a+=s.length,e+=s.length-1}}return t},filteroutMention:function(t){return t},filteroutCaption:function(t){return this.filteroutMention(t)},formatDl:function(t){var e=[];if(t.forEach(function(t){Lyte.arrayUtils(e,"push",this.formatPara(this.toArray(t.children)))}.bind(this)),e.length>1&&this.isImage(e[0])){var i=e[1];if(!(this.isImage(i)||this.isTable(i)||this.isHr(i)))e[0].data[0].data[1].data=e.splice(1,1)}return e},formatUl:function(t,e){return this.formatHtml(Array.from(t.children))},indexOf:function(t,e,i){for(var a=0;a<t.length;a++)if(t[a].conversionName==e)return a+1;return i},formatHtml:function(t,e){var i,a=[],o=[];t.forEach(function(t){var n,r=this.getTagName(t),s=/^(block|flex|grid)$/i.test(t.style&&t.style.display||"");try{if(/^(dl|dt|dd)$/i.test(r))n=this.formatDl(this.toArray(t.children));else if(/^(div|blockquote|p|caption-div|h[1-6]|hr)$/i.test(r)||s){if(n=this.formatPara(t),/^(caption-div])$/i.test(r))n[0].data[0].data[1].data=n[0].data.splice(1);else if(/^(h[1-6]|blockquote)$/i.test(r)){var l=this.data.ltPropParaChildConversion[r]||{};n.forEach(function(t){for(var e in this.pushIfNot(t.classList,"lyteEditor"+_lyteUiUtils.capitalize(r)),t.data.forEach(function(t){t.style=this.extend(t.style,this.extend(l))}.bind(this)),l)t.style[e]=this.getDefaultValue(e)}.bind(this))}}else if("figure"==r)n=this.formatImage(t);else if(/^(ul|ol)$/i.test(r))n=this.formatUl(t,e);else if(/^(table|img|video)$/i.test(r)){if((n=this.emptyParaData()).data[0]=this.formatWord(t,n),/^img|video$/i.test(r)){var d=n.data[0].style,c=n.style;this.data.ltPropInlineImage&&(d.zIndex=d.zIndex||"10"),d.float&&(this.data.ltPropInlineImage?d.zIndex=d.zIndex||"10":(c.float=d.float,c.zIndex=c.zIndex||"10",delete d.float),d.width=d.width||"100%",d.maxWidth=d.maxWidth||"100%")}else if(/^table$/i.test(r)){var p=n.data[0].data[0].style,h=n.style;["float","margin","lineHeight"].forEach((function(t){h[t]=p[t],delete p[t]}))}}else if("br"==r){if(i){var u=this.getTagName(i)||"",m=i.style||{},f=!/inline/i.test(m.display||""),g=/^(block|flex|grid)$/i.test(m.display||"");if(!(/^(br|div|p|dl|ul|ol|blockquote|figure|dt|dd|caption-div|h[1-6]|hr)$/i.test(u)&&f||g))return o.push(-1),void(i=t)}n=this.emptyParaData()}else{if(t.constructor==Comment||"#comment"==t.nodeName)return;(n=this.emptyParaData()).data=this.formatWord(t,n),o.push(a.length)}this.pushIfValid(a,n)}catch(t){console.warn("Caught error at word formatting"+t.message)}i=t}.bind(this));for(var n=o.length-1;n>=1;n--){var r=o[n-1];-1!=r&&r+1==o[n]&&(Lyte.arrayUtils(a[o[n-1]].data,"push",a[o[n]].data),a.splice(o[n],1))}return this.check_imagePara(a),a},check_imagePara:function(t){return t},copyStylesToLi:function(t){if("LI"!=t.tagName){t.style;let e=t.getAttribute("style"),i=t.children,a=i.length;for(let t=0;t<a;t++)i[t].setAttribute("style",e+(i[t].getAttribute("style")||""));return this.copyStylesToLi(i[0])}return Array.from(t.parentElement.children)},formatPara:function(t){var e=this.toArray(t.childNodes),i=[this.emptyParaData()],a=i[0].data,o=this.getTagName(t),n=e.length,r=this._dir?"rtl":"ltr",s=this.data.ltPropSourceDirection?r:t.style.direction||t.getAttribute("dir")||r,l=r!=s;if(/hr/i.test(o))return[this.insertHr(!0)];l&&(t.style.direction=s),this.getInlineStyle(t,i[0],!0),n&&a.splice(0,1),/^blockquote$/i.test(o)&&this.format_blockquote(t,i,t.getAttribute("lyte-blockquote-type")),e.forEach(function(t){var e=t.hasAttribute?t.hasAttribute("data-section"):void 0;if(t.constructor!=Comment&&"#comment"!=t.nodeName){if(e){const e=t.hasAttribute("editor-language"),i=e?t.getAttribute("editor-language"):"";e&&this.setData("codeEditorLanguage",i);const o=this.convertHtmlToData(void 0,t);e&&this.setData("codeEditorLanguage",""),t.removeAttribute("editor-language"),t.innerHTML="";let n=this.formatWord(t),r={attr:{"data-section":""},tag:"div",data:o,randomId:this.randomId(),details:{}};return n[0].details.type="section",n[0].data=[r],void this.pushIfValid(a,n)}var o=this.getTagName(t);"figure"!=o?("br"==o&&(i.push(this.emptyParaData()),(a=this.last(i).data).splice(0,1)),this.pushIfValid(a,this.formatWord(t,this.last(i),void 0))):this.pushIfValid(a,this.formatImage(t)[0].data[0].data)}}.bind(this)),n&&!a.length&&i.splice(0,1);for(var d=0;d<i.length;d++){var c=this.checkIfContainsImage(i[d]);this.data.codeEditorLanguage&&(c[0].details={snippet:{language:this.data.codeEditorLanguage}}),Lyte.arrayUtils(i,"replaceAt",d,c),d+=c.length-1}return i.map(function(t){return 0==t.data.length&&t.data.push(this.emptyWordData()),this.mergeWordsData(t,{})}.bind(this))},checkIfContainsImage:function(t){if(this.data.ltPropInlineImage)return t;var e=[],i=[],a=t.data,o=t.data,n=this.extend(t);return a.forEach(function(t,e){var a={data:[t]};(this.isImage(a)||this.isTable(a)||this.isHr(a))&&i.push(e)}.bind(this)),i.reverse().forEach(function(t){var i,a=o.splice(t+1),r=o.splice(t);a.length&&((i=this.extend(n)).data=a,e.unshift(this.convertParaStyle(i)));(i=this.extend(n)).data=r,e.unshift(this.convertParaStyle(i)),r[0].style.float&&(i.style.float=r[0].style.float,delete r[0].style.float)}.bind(this)),o.length&&(n.data=o,e.unshift(this.convertParaStyle(n))),e},convertParaStyle:function(t){var e=t.style,i=t.classList,a=this.data.ltPropParaStyleConversion,o=function(t){return t.replace(": ",":")};for(var n in a){var r=a[n].map(o),s=[];for(var l in e){var d=this.dasherize(l)+":"+e[l];-1!=this.getIndex(r,d)&&s.push(l)}s.length==r.length&&(s.forEach(function(t){delete e[t]}.bind(this)),i.push(n))}return t},ifNotStyle:function(t,e,i){var a=t[e];/unset|none/.test(a)&&(a=""),-1==this.getIndex(a||"",i)&&(t[e]=((a||"")+" "+i).trim())},image_data:function(){return[]},add_para_style_to_word:function(t,e,i){var a=this.data,o=a.ltPropWordStyle||{},n=a.ltPropParaStyle||{},r=e.style||{},s=i.style||{},l=t.style||{};(a.ltPropParaToWordStyle||[]).forEach((function(t){var e=l[t],i=s[t];o[t];!i||e||t in n||(r[t]=i)}))},merge_style:function(t,e){["margin","margin-inline","margin-inline-start"].forEach((function(t){"0px"==e.style[t]&&(e.style[t]="")}));var i=t.style,a=i.length,o=e.style;if(o)for(var n=0;n<a;n++){var r=i[n],s=i[r],l=o[r];/^\-\-/i.test(r)||(l||(o[r]=s))}},formatWord:function(t,e,i,a){var o=this.emptyWordData(i),n=this.getTagName(t);t.__processed||(t=this.get_modified_elem(t),n=this.getTagName(t));var r=[],s=this.data.ltPropTagConversion,l=s[n],d=(t.style||{}).textDecorationLine,c="sup"==n||"sub"==n,p="table"===n;l&&(o.classList.push(l),n=""),d&&(t.style.textDecoration=d,t.style.removeProperty("textDecorationLine")),!p&&this.getInlineStyle(t,o),c&&null==o.style.fontSize&&(o.style.fontSize="smaller"),e&&!p&&this.add_para_style_to_word(t,o,e);o.style;try{switch(n){case"table":return o.data=[this.formatTable(t)],o.details.type="table",["float","borderCollapse","marginInline","width","lineHeight"].forEach((function(t){delete o.style[t]})),o;case"img":case"video":return this.image_data(o,t,n);case"a":this.anchor_prop(t,o);break;case"mention_div":this.mention_prop(o,t)}}catch(t){console.log("Error : "+t.message)}if(this.getEventListeners(t,o),(t.children||[]).length){a=t.hasAttribute&&t.hasAttribute("data-section");r=this.mergeWordDom(t,o,a)}else{var h=function(t){var e=this.getSpaceForTab();return t.replace(/\t/g,e)}.bind(this);o.text=this.convertCase(h(t.textContent)),this.data.ltPropWordAttributes&&(o.attr=$L.extend(o.attr||{},this.read_attributes(t))),r.push(o)}var u=(t.style||{}).verticalAlign;if(u){"super"==u&&(u="sup");var m=s[u];m&&(this.pushIfNot(o.classList,m),delete o.style.verticalAlign)}return r.filter((function(t){return"none"!=t.style.display}))},read_attributes:function(t){var e,i=t.attributes||[];if(e=i.length){for(var a={},o=0;o<e;o++){var n=i[o],r=n.nodeName;"style"!=r&&"on"!=r.slice(0,2)&&(a[r]=n.nodeValue)}return a}},extend_style:function(t,e,i){var a=this.data.ltPropMultipleProperty||[];for(var o in e)if(!(i&&this.getIndex(i,o)+1)){var n=e[o];if(a.indexOf(o)+1){var r=t[o];if(r){/none|unset|default/i.test(r)&&(r=""),t[o]=this.arrayExtend(r.split(" "),n.split(" ")).join(" ");continue}}t[o]=n}return t},mergeWordDom:function(t,e){var i=this.toArray(t.childNodes),a=[];return i.forEach(function(t){var i=this.formatWord(t,void 0,!0);if(i.constructor!=Array)return e.details.anchor&&(i.details.parent=e),void a.push(i);i.forEach(function(t){a.push(t),null!=(e.details.event||void 0)&&(t.details.event=$L.extend(this.extend(e.details.event),t.details.event)),t.style=this.extend_style(this.extend(e.style),t.style),t.details=$L.extend(this.extend(e.details),t.details),this.arrayExtend(t.classList,e.classList)}.bind(this))}.bind(this)),a},getInlineStyle:function(t,e,i){if(t.constructor!=Text){for(var a=e.classList,o=e.style,n=(t.getAttribute("style")||"").trim().split(";").reduce(((t,e)=>{let i=e.trim();return i&&t.push(i),t}),[]),r={},s=this.data.ltPropReplaceStyle,l=0;l<n.length;l++){let e=/([^:]+):(.+)/,o=n[l].match(e);if(null==o)continue;let c=this.camelCase(o[1]),p=o[2],h=s[c];if(!/^\-\-/.test(o[1])&&(p=p.replace("!important","").trim(),"fontWeight"==c&&parseFloat(p)>=700&&(p="bold"),h&&(c=h.name,p=h.value==p?h.replaceValue:h.fallBackValue,t.style[c]=p),c&&p&&(r[c.trim()]=p.trim()),!i)){var d=this.classFrmStyle(n[l]);d&&(delete r[c],this.pushIfNot(a,d))}}$L.extend(e.style,r),i||(null!=t.getAttribute("data-image")?o.display=o.display||"inline":t.hasAttribute("data-section")?o.display=o.display||"block":o.display="inline")}},getEventListeners:function(t,e){let i=t.attributes||[],a={};for(let t=0;t<i.length;t++)"on"==i[t].nodeName.slice(0,2)&&(a[i[t].nodeName]=i[t].nodeValue);0!=Object.keys(a).length&&(e.details.event=a)},classFrmStyle:function(t){var e=this.data.ltPropWordStyleConversion,i=function(t){return t.replace(/:\s+/g,":").replace(/^;+/,"").replace(/;+$/,"")};for(var a in e){var o=e[a];if("string"==typeof o&&(o=[o]),-1!=this.getIndex(o.map(i),i(t)))return a}},pasteHandling:function(){var t=this;$L.fastdom.measure((function(){$L.fastdom.mutate((function(){$L(t._pastediv).removeClass("lyteEditorHide")}))}))},proceedPaste:function(t,e){t=Lyte.Component.registeredHelpers.unescape(t,void 0,this._sanitizer).innerHTML,this.check_is_empty();var i,a=this.data.ltPropDefaultPaste;switch(this.__from=e,a){case"destination":i=this.convertTextToDestination(t);break;case"text":i=this.convertTextToPlainData(t);break;default:i=this.convertHtmlToData(t)}this._proceedPaste(i),!a&&e&&(this.__pasted_text=t,this.pasteHandling()),delete this.__from,this.callFind()},_proceedPaste:function(t){var e=this.data.cursor;this.updateRangeNode();var i,a=this.splitPara(!0)||[],o=this.data.currentNode,n=$L(o).closest(this.getTag("paragraph")).get(0),r=$L(n).closest(".listHolderElement"),s=r.data("list"),l=this.findIndex(o),d=this.last(t),c=this.first(t),p=this.data.ltPropWordToParaStyle,h=this.data.ltPropConvertStyle,u=this;if(this.isCaption(n)&&this.remove_for_caption(t,o),!t||!t.length||1==t.length&&this.isEmptyPara(t[0]))return this.setData("cursor",e),this.data._undoqueue.pop(),this.setCursor(this.data.currentNode,e);var m=this.last(d.data);if(i={wordIndex:d.data.length-1,position:m.text.length,paraIndex:t.length+this.getIndex(s,n)},a[1]){var f=d.data,g=1==t.length&&1==f.length&&this.is_emoji(f[0].text);if(this.isEmptyPara(a[1])&&!this.isTable(d)){if(u.data.ltPropAnchorFollowup){var y=f.length&&this.last(f).details.anchor;!y&&g&&(y=!0),y&&(Lyte.arrayUtils(f,"push",a[1].data),i.wordIndex++,i.position=0)}a.splice(1,1)}else g||this.isTable(d)||this.isImage(d)||this.isHr(d)||!this.compareTwoWords(d,a[1],void 0,!0)?(g||1==t.length&&this.compareTwoWords(this.emptyParaData(),c))&&(Lyte.arrayUtils(d.data,"push",a[1].data),a.splice(1,1),g&&(i.wordIndex++,i.position=0)):(Lyte.arrayUtils(d.data,"push",a[1].data),a.splice(1,1))}var v,b=a[0];if(!this.isEmptyPara(b)||b.classList.length||this.isTable(d)){if(!(this.isTable(c)||!this.data.ltPropInlineImage&&this.isImage(c)||this.isHr(d))&&(this.compareTwoWords(c,b,void 0,!0)||!(c.details||{}).tab&&this.compareTwoWords(this.emptyParaData(),c))){var x=b.data.length;v=b,c.data.forEach((function(t){u.checkWordToParaStyle(v,t,p,h)})),Lyte.arrayUtils(b.data,"push",c.data),t.splice(0,1),i.paraIndex--,0==t.length&&(i.wordIndex+=x)}}else a.splice(0,1),i.paraIndex--,1==t.length&&2==t[0].data.length&&y&&function(t,e){p.forEach((function(i){null!=t[0].style[i]&&null==e.style[i]&&"color"!=i&&(e.style[i]=t[0].style[i])}))}(t[0].data,t[0]);Lyte.arrayUtils(a,"insertAt",Math.min(1,a.length),t);let _=a.length;a.forEach(function(t,e){var a=i.paraIndex==e+l.paraIndex?i:void 0,o=this.render(this.mergeWordsData(t,a,void 0,e==_-1)),n=$L(o),s=n.data("list");n.hasClass(this.data.tabClass)&&this.setup_custom_tab(n),this.update_count(_lyteUiEditor.limitFilter(o,1/0,!0).length),this.pushParagraph(o,r,e+l.paraIndex+1),a?this.isTable(t)?(this.setData("currentNode",this.getLastWordInPara(o)),i.position=this.getWordText(this.data.currentNode).length):_lyteUiEditor.isSection(t)?(this.setData("currentNode",this.getFirstWordInPara(o)),i.position=0):this.setData("currentNode",s[a.wordIndex]):s.length>1&&this.removeEmptyWords(o,{})}.bind(this)),this.checkPlaceholder(),this.update_count(-_lyteUiEditor.limitFilter(n,1/0,!0).length),this.removePara(n),this.setData("cursor",i.position),this.updateRangeNode();for(var P=this.data,L=P.ltPropCharacterCount;P.ltPropCharacterCount>P.ltPropMaxlength&&(this.backspace(),L!=(L=P.ltPropCharacterCount)););this.setCursor(this.data.currentNode,this.data.cursor,!1,!0)},executePaste:function(t,e,i){return this.execute(i||"onPaste",t,e,this.$node)},_executePaste:function(){var t=this._editdiv,e=function(){var e=t.innerHTML;this.proceedPaste(e,!0),t.textContent="",this.data.ltPropMobileView&&this.setCursor(this.data.currentNode,this.data.cursor),delete this._pastePrevent}.bind(this);this.data.ltPropConvertInlineImages?Lyte.resolvePromises(this.convert_inline_image(t)).then(e):e()},image_paste:function(t,e){return e()},paste:function(t,e){if(0==this.execute("onBeforePaste",t,this.$node))return e||(t.preventDefault(),t.target.textContent=""),!1;var i=this.data.ltPropReadFromClipboard?t.clipboardData.getData("text/html"):"",a=function(){this._pastePrevent=!0,setTimeout(function(){var e=this._editdiv;if(e.childNodes.length){i&&(e.innerHTML=i);var a=this.executePaste(e,t);this.removeSelected(),a&&a.then?a.then(this._executePaste.bind(this),(function(){t.target.textContent=""})):this._executePaste(),this.executePaste(e,t,"onAfterPaste")}else delete this._pastePrevent}.bind(this),0)}.bind(this);this.image_paste(t,a)},setNode:function(t,e){t&&(this.setData("currentNode",t.node),this.setData("cursor",t.change),this.setCursor(t.node,t.change)),this.setCursor(this.data.currentNode,this.data.cursor),e&&this.resetRange(!0)},findPrevChar:function(t,e,i,a){var o=this.measureLength(t,void 0,e,void 0,!0).letters;return(this[i?"first":"last"](o)||"").length},moveLeftSingleChar:function(t,e,i,a){var o=this.data,n=o.range;if(!a&&n.isRange){var r=o.selectedWords[0];return{node:r.node,change:r.left}}if(o.navCheck&&this._iframe&&0==this.setup_focus("left",i,a))return!1;if(0==parseInt(e)){var s=this.getPreviousWord(t,void 0,void 0,!0);if(!s)return{node:t,change:e};t=s;var l=this.getWordText(t),d=this._hadMention?0:this.findPrevChar(l,t);return delete this._hadMention,{node:t,change:e=Math.max(0,l.length-d)}}var c=this.getWordText(t).slice(0,e),p=(d=this.findPrevChar(c,t),this.convertToLine(t));return e-d==p[this.lineIndex(p,e)].start?e-=d-.5:(e%1==.5&&(e-=.5),e-=d),{node:t,change:Math.max(0,e)}},moveRightSingleChar:function(t,e,i,a){var o=this.data,n=o.range;if(!a&&n.isRange){var r=$L(o.selectedWords).get(-1);return{node:r.node,change:r.right}}if(this.data.navCheck&&this._iframe&&0==this.setup_focus("right",i,a))return!1;var s=this.getWordText(t);if(e==s.length){var l=this.getNextWord(t,void 0,void 0,!0);if(!l)return{node:t,change:e};t=l;var d=this.getWordText(t),c=this._hadMention?0:this.findPrevChar(d,t,!0);return delete this._hadMention,{node:t,change:e=Math.min(c,d.length)}}s=s.slice(e);c=this.findPrevChar(s,t,!0);var p=this.convertToLine(t);return e+c==p[this.lineIndex(p,e)].end?e+=c+.5:(e%1==.5&&(e+=.5,c-=1),e+=c),{node:t,change:Math.min(e,this.getWordText(t).length)}},getCrctNodeForMove:function(t){var e=this.data.range;if(!e.isRange)return{word:this.data.currentNode,cursor:this.data.cursor,startNode:t?"startNode":"endNode",left:t?"left":"right"};var i=this.data.selectedWords;if(this._rangemove){var a=this._rangemove||(t?"left":"right");return{word:this["left"==a?"first":"last"](i).node,cursor:e[a],startNode:"left"==a?"startNode":"endNode",left:a}}var o,n,r=this[t?"first":"last"](i);return"left"==(n=e.startNode==e.endNode?e.left>e.right?t?"right":"left":t?"left":"right":t?r.node==e.startNode?"left":"right":r.node==e.endNode?"right":"left")?o="startNode":(n="right")&&(o="endNode"),{word:e[o],cursor:e[n],startNode:o,left:n}},commonSet:function(t,e,i,a){var o=t.startNode,n=t.left;i?a&&(e[o]=a.node,e[n]=a.change,e.startNode!=e.endNode||e.left!=e.right?(Lyte.objectUtils(e,"add","isRange",!0),this.setNode(a,!1),this.setRange(),this._rangemove=n):this.setNode(a,!0)):this.setNode(a,e.isRange)},getLines:function(t){var e=$L(t).data("list"),i=[];return e.forEach(function(t){Lyte.arrayUtils(i,"push",this.convertToLine(t))}.bind(this)),this.formLine(i)},getLWindex:function(t,e){var i=this.getLines(t.parentNode),a=i.length;e=Math.min(e,this.getWordText(t).length);for(var o=0;o<a;o++)for(var n=i[o],r=n.length,s=0;s<r;s++){var l=n[s];if(l.node==t&&l.start<=e&&e<=l.end)return{wordIndex:s,lineIndex:o,lines:i}}return{wordIndex:--s,lineIndex:--o,lines:i}},home:function(){this.moveLeft(!0)},end:function(){this.moveRight(!0)},pagedown:function(){this.common_page(1)},pageup:function(){this.common_page(-1)},common_page:function(t){var e=this._cursor,i=this._maindiv,a=this.getBcr(e),o=this.getBcr(this.$node),n=new Event("mousedown",{bubbles:!0});n.__ignore=!0,n.clientX=a.left,n.clientY=a.top+o.height*t,i.dispatchEvent(n)},moveLeft:function(t,e,i,a){this.__shiftmove=e,delete this._widthMaintain;var o,n=this.data.range,r=this.getCrctNodeForMove(!0),s=r.word,l=r.cursor;if(!a&&this.get_dir(s))return this.moveRight(t,e,i,!0);if(e&&n.isRange&&null==this.data.topLevelElement){var d=$L(s).closest(".listHolderElement",this._maindiv);-1!=this.getIndex([this.getTag("td"),this.getTag("th")],this.getTagName(d.get(0)))&&(l=0,s=this.getFirstWordInPara(this.first(d.data("list"))))}if(t){var c=this.getLWindex(s,l),p=this.first(c.lines[c.lineIndex]);o={node:p.node,change:p.start+.5}}else o=i?this.getValueForAlt(s,l):this.moveLeftSingleChar(s,l,r,e);if(0==o)return delete this.__shiftmove,o;this.commonSet(r,n,e,o),delete this.__shiftmove},moveRight:function(t,e,i,a){this.__shiftmove=e,delete this._widthMaintain;var o,n=this.data.range,r=this.getCrctNodeForMove(),s=r.word,l=r.cursor;if(!a&&this.get_dir(s))return this.moveLeft(t,e,i,!0);if(e&&n.isRange&&null==this.data.topLevelElement){var d=$L(s).closest(".listHolderElement",this._maindiv);-1!=this.getIndex([this.getTag("td"),this.getTag("th")],this.getTagName(d.get(0)))&&(s=this.getFirstWordInPara(this.last(d.data("list"))),l=this.getWordText(s).length)}if(t){var c=this.getLWindex(s,l),p=this.last(c.lines[c.lineIndex]);o={node:p.node,change:p.end}}else o=i?this.getValueForAlt(s,l,!0):this.moveRightSingleChar(s,l,r,e);if(0==o)return delete this.__shiftmove,o;this.commonSet(r,n,e,o),delete this.__shiftmove},altVerticalMove:function(t,e,i){delete this._widthMaintain;var a=t.parentNode,o=$L(a).data("list"),n=this.getIndex(o,t);if(i)return 0==n&&0==e?{change:0,node:(r=this.getPreviousWord(t))?this.first($L(r.parentNode).data("list")):t}:{change:0,node:this.first(o)};if(n==o.length-1&&e==this.getWordText(t).length){var r,s=(r=this.getNextWord(t))?this.last($L(r.parentNode).data("list")):t;return{change:this.getWordText(s).length,node:s}}return{node:s=this.last(o),change:this.getWordText(s).length}},lineIndex:function(t,e){for(var i=t.length,a=0;a<i;a++){var o=t[a];if(o.start<=e&&o.end>=e)return a}return--a},getFromNext:function(t,e,i){var a=e.lines,o=i?-1:1,n=e.lineIndex+1*o,r=a[n];if(r){for(var s,l=r.length,d=r[0].client,c=this.last(r),p=(o=this._dir?-1:1,this.rtlfunc("left")),h=0;h<l;h++){var u=r[h];if(t-=(u.client[p]-d[p])*o,d=u.client,t<=u.client.width){c=u;break}}return c.node.style.unicodeBidi&&(t=c.client.width-t),s=c.start+(this.data.navCheck&&this._iframe?this.m_width(c.text,t,this.comp_style(c.node)).cursor:this.measureLength(c.text,t,c.node).cursor),{node:c.node,change:s+(s==c.start?.5:0)}}var m=a[n-1*o],f=this[i?"getPreviousWord":"getNextWord"](this[i?"first":"last"](m).node);return f&&(e=this.getLWindex(f,i?this.getWordText(f).length:0)),e.lineIndex-=1*o,this.getFromNext(t,e,i)},getForVerticalMove:function(t,e,i){var a,o=this.getLWindex(t,e),n=o.lineIndex,r=o.lines[n][o.wordIndex],s=o.lines[n][0],l=this.rtlfunc("left");if(null==this._widthMaintain){var d=this.measureLength(r.text.slice(0,e-r.start),void 0,t).width;t.style.unicodeBidi&&(d=r.client.width-d),a=d+r.client[l]-s.client[l],this._widthMaintain=a}else a=this._widthMaintain;return this.getFromNext(a,o,i)},moveTop:function(t,e,i){this._vert=!0;var a,o=this.data.range,n=this.getCrctNodeForMove(!0),r=n.word,s=n.cursor;if(e&&o.isRange&&null==this.data.topLevelElement){var l=$L(r).closest(".listHolderElement",this._maindiv);-1!=this.getIndex([this.getTag("td"),this.getTag("th")],this.getTagName(l.get(0)))&&(r=this.getFirstWordInPara(this.first(l.data("list"))),s=0)}if(t||1==this.findIndex(r,void 0,!0).isFirstPara){delete this._widthMaintain;var d=this.first($L(this._maindiv).data("list"));a={node:this.getFirstWordInPara(d),change:0}}else a=i?this.altVerticalMove(r,s,!0):this.getForVerticalMove(r,s,!0);this.commonSet(n,o,e,a),delete this._vert},moveBottom:function(t,e,i){this._vert=!0;var a,o=this.data.range,n=this.getCrctNodeForMove(),r=n.word,s=n.cursor;if(e&&o.isRange&&null==this.data.topLevelElement){var l=$L(r).closest(".listHolderElement",this._maindiv);-1!=this.getIndex([this.getTag("td"),this.getTag("th")],this.getTagName(l.get(0)))&&(r=this.getFirstWordInPara(this.last(l.data("list"))),s=this.getWordText(r).length)}if(t||1==this.findIndex(r,void 0,!0).isLastPara){delete this._widthMaintain;var d=this.last($L(this._maindiv).data("list"));a={node:r=this.getLastWordInPara(d),change:this.getWordText(r).length}}else a=i?this.altVerticalMove(r,s):this.getForVerticalMove(r,s);this.commonSet(n,o,e,a),delete this._vert},checkPlaceholder:function(){var t=this.data;if(t.ltPropPlaceholder){var e=$L(this._maindiv).children(t.ltPropTags.paragraph),i=!1;if(e.length<=1){let t=function(t){return!(t.style.marginInlineStart&&"0px"!=t.style.marginInlineStart)};if(e=e.get(0)){var a=$L(e).data("data");i=a&&this.isEmptyPara(a)&&!a.classList.length&&t(a)}else i=!0}this.setData("showPlaceholder",i&&!this.__compose)}},cursorChange:function(t,e){var i=this.data;this.scrollIntoView(i.currentNode,i.cursor),this.checkPlaceholder(),this.execute("onCursorChange",t.oldValue,t.newValue,i.currentNode,this.$node,e)},update_panel:function(){var t=this.$node.panel;t&&t.updateIconBarRange()},nodeChange:function(t){this.update_panel();var e="lyteCurrentNode",i="lyteCurrentParagraph",a=$L("."+e,this._maindiv),o=t.oldValue,n=t.newValue,r=this.data;a.get(0)!=n&&(a.removeClass(e).parent().removeClass(i),$L(n).addClass(e).parent().addClass(i)),this.isUndo()||(this._pushToPrevious=!r._undoqueue.length,this.removeEmptyWords(n.parentNode),delete this._pushToPrevious),r.currentNode!=n&&this.setCursor(r.currentNode,r.cursor),this.scrollIntoView(r.currentNode,r.cursor),this.checkPlaceholder(),o&&this.execute("onWordChange",o,n,r.cursor,this.$node),r.navCheck&&this._iframe&&this.setup_nav(n)},rangeChange:function(t){var e=this.data.range;!this._mup&&this.scrollIntoView(e.endNode,e.right),this.execute("onSelect",t,e,this.$node)},rangeObs:function(t){(this.data.range.isRange||"range.isRange"==t.item)&&(clearTimeout(this._rangeTime),this._rangeTime=setTimeout(function(){delete this._rangeTime,this.update_panel(),this.data.range.isRange&&this.rangeChange(t)}.bind(this),0))}.observes("range","range.startNode","range.endNode","range.left","range.right","range.isRange"),cursorObs:function(t){clearTimeout(this._cursorTime);let e=this.__evt;this._cursorTime=setTimeout(function(){delete this._cursorTime,this.cursorChange(t,e)}.bind(this),20)}.observes("cursor"),nodeObs:function(t){clearTimeout(this._nodeTime),this._nodeTime=setTimeout(function(){delete this._nodeTime,this.nodeChange(t)}.bind(this),20)}.observes("currentNode"),rtlfunc:function(t,e,i){if(this._dir){if(e)return"right"==t?i-e.left:i-e.right;if("left"==t)return"right";if("right"==t)return"left"}return e?e[t]:t},selectWord:function(){var t=this.data,e=t.range;if(!e.isRange){var i=t.currentNode,a=t.cursor,o=this.getValueForAlt(i,a,void 0,!0),n=this.getValueForAlt(i,a,!0,!0),r=o.node.parentNode,s=function(t,i){Lyte.objectUtils(e,"add",t,i)};if(r!=n.node.parentNode){var l=this.getLastWordInPara(r);n={node:l,change:this.getWordText(l).length}}s("left",o.change),s("startNode",o.node),s("right",n.change),s("endNode",n.node),s("isRange",e.startNode!=e.endNode||e.left!=e.right),i==e.endNode?(this.setData("currentNode",i),this.setData("cursor",e.right)):(this.setData("currentNode",e.startNode),this.setData("cursor",e.left)),this.common_positioning(),t.isMobile&&e.isRange&&$L.fastdom.measure((function(){$L.fastdom.mutate(this.openMobilePop,this)}),this)}},selectParagraph:function(){this.selectLine(!0)},selectLine:function(t){var e=this.data,i=e.range;if(!i.isRange){var a,o=e.currentNode,n=Lyte.objectUtils;if(t){var r=o.parentNode,s=this.getLastWordInPara(r);a={start:-.5,node:this.getFirstWordInPara(r)},s={node:s,end:this.getWordText(s).length}}else{var l=e.cursor,d=this.getLWindex(o,l),c=d.lineIndex,p=d.lines[c];a=this.first(p),s=this.last(p)}n(i,"add","startNode",a.node),n(i,"add","left",a.start+.5),n(i,"add","endNode",s.node),n(i,"add","right",s.end),n(i,"add","isRange",!(i.startNode==i.endNode&&parseInt(i.left)==parseInt(i.right))),this._ignoreRangeCheck=!0,this.common_positioning(),this._ignoreRangeCheck=!1,e.isMobile&&$L.fastdom.measure((function(){$L.fastdom.mutate(this.openMobilePop,this)}),this)}},splitWordForSpace:function(t){var e=[],i=/\s+/.exec(t);if(i){var a=i.index,o=a+i[0].length;a&&e.push(t.slice(0,a)),final.push(t.slice(a,o)),Lyte.arrayUtils(final,"push",this.splitWordForSpace(t.slice(o)))}else t&&e.push(t);return e},openMobilePop:function(){var t=$L("lyte-overlay:not(.inActive)",this.$node),e=t.get(0),i=t.get(-1),a=e?this.getBcr(e):void 0,o=i?this.getBcr(i):void 0,n={};if(e||(o=a=this.getBcr(this._cursor)),n.left=Math.min(a.left,o.left),n.right=Math.max(a.right,o.right),n.top=Math.min(a.top,o.top),n.bottom=Math.max(a.bottom,o.bottom),n.height=n.bottom-n.top,n.width=n.right-n.left,n.width<50){var r=.5*(50-n.width);n.left-=r,n.right+=r,n.width=50}setTimeout(function(){this.setData("mobileOffset",n),this._mobilepop.ltProp("show",!0)}.bind(this),0)},inline_from_file:function(t,e){var i=new Image;i.onload=function(){var t=this.copy_image(i,void 0,i.naturalWidth,i.naturalHeight);URL.revokeObjectURL(i.src),e("<img src='"+t+"'>",!0)}.bind(this),i.onloadend=function(){this.updateEditorDiv(this.data.currentNode,this.data.cursor)}.bind(this),i.src=URL.createObjectURL(t)},clipboardPaste:function(){var t=this,e=function(){this.$node.focus(),window.requestAnimationFrame((function(){document.execCommand("paste",!0)}))}.bind(this),i=navigator.clipboard;i&&i.read?i.read().then((function(e){e.forEach((function(e){var i,a=e.types,o="image/png";if([o,"text/html","text/plain"].every((function(e){return-1!=t.getIndex(a,e)&&(i=e),!i})),i){var n=t.proceedPaste.bind(t);e.getType(i).then((function(e){if(i==o)t.inline_from_file(e,n);else{var a=new FileReader;a.onload=function(){if(0!=t.call_insert(a.result)){var e=a.result;t.data.ltPropConvertInlineImages?t.inline_image_html(e,n,!0):n(e,!0),t.executePaste(t._editdiv,event,"onAfterPaste")}},a.onloadend=function(){t.updateEditorDiv(t.data.currentNode,t.data.cursor)},a.readAsText(e)}}))}else n()}))})):e()},removeLetters:function(t,e){var i,a=this.data,o=a.currentNode,n=a.cursor;null!=e&&(i=t),this.reset();var r={fakeRange:!0,isRange:!0,startNode:o,left:null==i?n-t:i,endNode:o,right:null==e?n:e};this.getSelected(r),this.removeSelected(r,!0)},hide_paste_div:function(){$L(this._pastediv).addClass("lyteEditorHide"),delete this._prev_paste_state,delete this.__pasted_text},check_limit:function(t,e){var i=this.data,a=i.ltPropMaxlength,o=i.ltPropCharacterCount,n=a-o;let r=function(){this.getMethods("onMaxLengthReach")&&this.executeMethod("onMaxLengthReach")}.bind(this);if(n>0){let i=_lyteUiEditor.limitFilter(t,a-o,!0,e);return i.flag&&r(),i}return r(),{html:"",length:0}},update_count:function(t){var e="ltPropCharacterCount";this.setData(e,this.data[e]+t)},blockquote_check:function(){},insertHr:function(t){var e=this.emptyParaData();if(e.classList.push("lyteEditorHrTag"),t)return e;this.$node.insertJSON([e])},check_rtl:function(t){this.mergeWords(t,["unicodeBidi","direction"]),this.splitRtlWord(t)},create_compose:function(){var t=this.data.currentNode,e=this.render(this.extend($L(t).addClass("lyteEditorComposerNode").css("pointerEvents","none").data("data"),{})),i=this.data.cursor,a=this.getWordText(t),o=a.slice(0,i),n=a.slice(i);return t.innerText="",o&&t.appendChild(new Text(o)),t.appendChild(this.__compose=e),n&&t.appendChild(new Text(n)),this.checkPlaceholder(),e},update_composition:function(t){var e=this.__compose||this.create_compose();this.getWordText(e);e.innerText=t,$L(e).data("data").text=t,$L.fastdom.clear(this.__compose_time),delete this.__compose_time,this.__compose_time=$L.fastdom.measure(function(){delete this.__compose_time;var t=window.getSelection().getRangeAt(0);t.startContainer;this.setCursor(e,t.endOffset,!0)}.bind(this))},clear_composition:function(){var t=this.__compose;if(t){$L.fastdom.clear(this.__compose_time),delete this.__compose_time;var e=t.parentNode;t.remove(),delete this.__compose,e&&e.normalize(),window.requestAnimationFrame(this.checkPlaceholder.bind(this)),this.setCursor(this.data.currentNode,this.data.cursor)}},get_valid_new_lines:function(t,e){var i=t.data||[],a=i.filter((function(t){return t.tag==e})),o=0,n=a.length;return n&&(o+=n-1),i.forEach(function(t){o+=this.get_valid_new_lines(t,e,0)}.bind(this)),o},update_count_in_delete:function(t,e,i,a){var o=this.get_valid_new_lines(t,this.getTag("paragraph"));if(1!=i&&o++,a)return o;this.update_count(-1*o)},update_count_in_insert:function(t,e,i,a){var o=this.get_valid_new_lines(t,this.getTag("paragraph"));if(i&&o++,a)return o;this.update_count(o)},emoji_composition:function(t){clearTimeout(this.__emoji_compose),this.__emoji_compose=setTimeout(function(){this.processInput(this._editdiv)}.bind(this),0)},remove_merge_default:function(t){return this.data.ltPropMultipleProperty.forEach((function(e){/^(none|unset)$/i.test(t[e]||"")&&delete t[e]})),t},insert_and_clear:function(t){this.processInput(this._editdiv,t),this.clear_composition()},showSuggestion:function(t){this.data.cursor;let e=this.convertHtmlToData('<span class="lyteEditorSuggestionWord">'+t+"</span>")[0].data[0],i=this.render(e);this._suggestionWord=i,Lyte.Component.insertAfter(this.data.currentNode,i)},removeSuggestion:function(){this._suggestionWord.remove(),this._suggestionWord=null},applySuggestion:function(){let t=this.data.currentNode,e=this.getWordText(t),i=this._suggestionWord.innerText,a=this.data.cursor;this.updateNodeValue(t,e+i),this.setCursor(t,a+i.length),this.removeSuggestion()},setSuggestionWord:function(t){let e=$L(this.$node).find("#"+t.id).data("list");this._suggestionWord=$L(e[t.paraIndex]).data("list")[t.wordIndex]},update_height:function(){if(!this.__editor_manually_resized){var t=this._maindiv;t.style.height="auto",$L.fastdom.clear(this.___measure_q),this.___measure_q=$L.fastdom.measure((function(){delete this.___measure_q;var e=t.offsetHeight;$L.fastdom.mutate((function(){t.style.height=e+"px"}))}))}}},{mixins:_lyteUiEditor.mixins}),Lyte.Mixin.register("lyte-editor-anchor",{edit_value_change:function(t){var e=this.data,i=e.range.isRange,a=this.convert_html_to_txt(this.getSelectedText()||"").trim(),o=null!=t.newValue&&t.newValue.trim(),n=null!=e.userInput?e.userInput.trim():"",r=!((n||i)&&o);if(e.anchorShow&&!i){if(e.textModified)return this.setData("buttonDisable",r);this.setData("userInput",n=o)}this.setData("buttonDisable",!((n||a)&&o))}.observes("anchorEdit.href"),emailEditValueObs:function(t){this.checkIsValid(t)}.observes("anchorEdit.mailId","anchorEdit.text","anchorEdit.telephone"),checkIsValid:function(t){var e=t.newValue,i=!0,a=this.data.anchorEdit,o=this.data.currentAnchorType;"anchorEdit.mailId"!=t.item||/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/i.test(a.mailId)||"email"!=o||(i=!1),"anchorEdit.telephone"==t.item&&e&&!e.match(/^[+]*[(]{0,1}[0-9]{1,4}[)]{0,1}[-\s\./0-9]*$/g)&&"telephone"==o&&(i=!1),null!=a.text&&""!=a.text||this.data.userInput||(i=!1),this.setData("buttonDisable",!i)},isLinkObs:function(){this.setData("buttonDisable",!0)}.observes("isLink"),anchor_pop_show:function(t){var e="addClass";t.newValue||(this.setData("textModified",!1),e="removeClass"),$L(this.$node)[e]("lyteAnchorPopoverOpened")}.observes("anchorShow"),anchor_tooltip:function(t,e,i,a){var o=t.data("data"),n={"lt-prop-title":e.title||e.href,"lt-prop-tooltip-config":this.data.ltPropTooltipConfig},r=o.attr;for(var s in r||(o.attr=r={},a&&a("attr",void 0,{})),r.href&&(o.attr.href=e.href),n){var l=n[s],d=r[s];d!=l&&(r[s]=l,i&&i(d,l,s))}t.attr(n)},modify_anchor_text:function(t){var e=this.data,i=e.currentNode,a=e.userInput||t.text,o=this.data.range;this.getWordText(i)!=a&&o.startNode==o.endNode&&(this.updateRangeNode(),this.updateNodeValue(i,a),this.setData("cursor",a.length),this.resetRange(!0),this.updateRangeNode(),this.common_positioning())},applyLink:function(){if(!this.getMethods("onBeforeAnchorInsert")||0!=this.executeMethod("onBeforeAnchorInsert",this.data.anchorEdit.href,this.data.userInput,this.$node)){var t,e=this.data,i=e.anchorEdit,a=i.newWindow?"_blank":"_self",o=this.data.currentAnchorType,n=(this.data.ltPropAnchorAdvancedOption,i.title);switch(o){case"link":t=i.href;break;case"email":t="mailto:"+i.mailId+(i.mailSubject?"?Subject="+i.mailSubject:"");break;case"telephone":t="tel:"+i.telephone}if(t){"link"!=o||/^(htt(p|ps):\/\/)/.test(t)||(t="http://"+t),e.range.isRange?(this.anchor({href:t,target:a,title:n}),e.ltPropAnchorTextEdit&&this.modify_anchor_text(i)):this.$node.insertHTML("<a href='"+t+"' "+(n?"title='"+n+"' ":"")+"target='"+a+"' style='"+this.style_for_anchor(e.currentNode)+"'>"+_lyteUiEditor.escapeText(e.userInput)+"</a>",!0),this._popover.ltProp("show",!1),this.$node.focus();var r="onAnchorModification";this.getMethods(r)&&this.executeMethod(r,this.$node)}}},methods:{anchorShow:function(t){var e=this._popover.ltProp("originElem");$L(e).addClass("lyteEditorPanelListPopOpened"),this.setData("inputFocus",!0);var i=this.data,a="onAnchorShow";this.scrollIntoView(i.currentNode,i.cursor),this.getMethods(a)&&this.executeMethod(a,this.$node,t.actualModalDiv.getElementsByTagName("lyte-popover-content")[0])},anchorClose:function(){this.setData("currentAnchorType","link"),this.setData("linkChecked",!0);var t=this._popover.ltProp("originElem");$L(t).removeClass("lyteEditorPanelListPopOpened")}},actions:{check_key:function(t){"Enter"!=t.key||this.data.buttonDisable||(this.applyLink(),t.preventDefault())},anchorClick:function(t){return!1},applyLink:function(){this.applyLink()},editLink:function(){var t=this.data;this.setData({isEditLink:!1,inputFocus:!0,userInput:t.ltPropAnchorTextEdit?t.anchorEdit.text:""}),this.anchorEdit(t.currentNode),this._popover.alignPopover()},removeWord:function(){this.removeAnchorWord(),this._popover.ltProp("show",!1),this.$node.focus();var t="onAnchorModification";this.getMethods(t)&&this.executeMethod(t,this.$node)}},removeAnchorStyle:function(t){var e=t.style,i=this.data.ltPropWordStyle,a=(i.textDecoration||"").split(" "),o=(e.textDecoration||"").split(" "),n=o.length,r=(this.data.ltPropAnchorStyle,i.color||"");e.color;e.color=r;for(var s=0;s<n;s++){var l=o[s];if(!(a.indexOf(l)+1)&&"underline"==l){o.splice(s,1);break}}(e.textDecoration=o.join(" "))||delete e.textDecoration},addAnchorStyle:function(t,e,i){var a=this.data,o=a.ltPropAnchorStyle||{},n=a.ltPropMultipleProperty,r=t.style,s=this._popover,l=s&&s.ltProp("show");for(var d in o){var c=o[d],p=(e?e.style:r)[d];if(n.indexOf(d)+1){var h=r[d]?(r[d]||"").split(" "):[];if(h.indexOf(c)+1||this.data.ltPropMultipleProperty.indexOf(d)+1&&(h.indexOf("unset")+1||h.indexOf("none")+1))continue;h.push(c),c=h.join(" ")}!l&&p||(r[d]=c,e&&(e.style[d]=c,i&&i(p,c,d)))}},remove_anchor_data:function(t){this.removeAnchorStyle(t);var e=t.details||{},i=t.classList||{};delete e.type,delete e.anchor,Lyte.arrayUtils(i,"removeAt",this.getIndex(i,"lyteEditorAnchor")),this.reset_anchor(t)},removeAnchorWord:function(t,e){var i,a=this.data,o=a.currentNode,n=t||o,r=this.findIndex(n),s=$L(n),l=this.extend(s.data("data")),d=(l.details,l.classList,n==o),c="onBeforeAnchorRemove",p=!0;return d&&this.updateRangeNode(),this.getMethods(c)&&(i=n,p=0!=this.executeMethod(c,l,n,r,this.$node)),p&&this.remove_anchor_data(l),this.deleteSingleWord(n,r),i=this.insertSingleWord(l,this.extend(r)),d&&(this.setData("currentNode",i),this.setCursor(i,a.cursor)),this.resetRange(),d&&this.updateRangeNode(),i},openAnchor:function(){var t=this.data.currentNode;$L(t).hasClass("lyteEditorAnchor")&&window.open(t.data("data").details.anchor.href,"_blank")},anchorOpen:function(){var t=this.data,e=t.range,i=$L(t.currentNode),a="popOrigin"+t.randomId,o=t.selectedWords,n=!0;if(1==o.length){var r=o[0].node;n=!$L(r).hasClass("lyteEditorAnchor")}if(e.isRange&&n||this._popover.ltProp("show"))return this._ignore=!0,this._popover.ltProp("show",!1),void delete this._ignore;$L("."+a).removeClass(a),i.addClass(a);var s=i.data("data"),l=Lyte.objectUtils,d=this.data.anchorEdit;l(d,"add","href",(s.details.anchor||{}).href),l(d,"add","text",s.text),l(d,"add","title",(s.details.anchor||{}).title),this.setAnchorType(d.href),this.setData("isEditLink",!0),this.$node.focus(!0),this._popover.ltProp("show",!0)},setAnchorType:function(t){let e="link";/^mailto:/.test(t)?e="email":/^tel:/.test(t)&&(e="telephone"),this.setData(e+"Checked",!0),this.setData("currentAnchorType",e)},anchorEdit:function(t){var e=$L(t).data("data").details.anchor||{},i="popOrigin"+this.data.randomId,a=this.data.range,o=this.getWordText(t),n=Lyte.objectUtils;n(a,"add","left",0),n(a,"add","right",o.length),n(a,"add","startNode",t),n(a,"add","endNode",t),n(a,"add","isRange",0!=a.right),this.setRange();let r={};if(/^mailto:/.test(e.href)){let t=/\?Subject=([^&]*)/,i=e.href.match(t);r.mailSubject=i&&(i[1]||""),r.mailId=e.href.replace("mailto:","")}else/^tel:/.test(e.href)?r.telephone=e.href.replace("tel:",""):r.href=e.href;r.title=e.title||"",r.newWindow="_blank"==e.target,r.text=o,this.setData("anchorEdit",r),this.setData("buttonDisable",!0),$L("."+i).removeClass(i),$L(t).addClass(i),this._popover.ltProp("show",!0)},anchor:function(t){t.title||delete t.title;var e=this;return this.toggleWordClass("anchorChange",void 0,(function(i){var a=$L(i),o=a.data("data")||i,n=o.details,r=i.constructor!=Object,s=n.anchor;if(e.compareObject(s||{},t))return!1;var l,d=r&&e.findIndex(i),c="arr:"+d.paraIndex+".data.arr:"+d.wordIndex,p=function(t,i,a){e.pushToQueue({operation:"properties",prop:c+"."+t,id:d.id,oldValue:i,newValue:a})},h="lyteEditorAnchor",u=o.classList;return t?(l="addClass",e.pushIfNot(u,h),r&&p("details",n,{type:"anchor",anchor:t}),n.type="anchor",n.anchor=e.extend(t),r?e.addAnchorStyle(o,i,(function(t,i,a){e.pushToQueue({operation:"styleSet",oldValue:t,newValue:i,prop:a,id:d.id,index:d,word:!0})})):e.anchor_prop(void 0,o),r&&e.anchor_tooltip(a,n.anchor,(function(t,i,a){e.pushToQueue({operation:"attribute",prop:c+".attr."+a,id:d.id,oldValue:t,newValue:i})}),p)):(r&&p("details.type",n,{}),delete n.type,delete n.anchor,e.removeAnchorStyle(o),u.splice(e.getIndex(u,h),1),l="removeClass"),a[l](h),t&&s&&(l=""),r&&l&&e.pushToQueue({operation:"class",prop:l,id:d.id,value:h,element:c}),!1}))},link:function(){this.anchorEdit(this.data.currentNode)},userInput_mod:function(t){var e=this.data,i=e.anchorEdit.href.trim(),a=null!=t.newValue&&t.newValue.trim(),o=e.range.isRange;e.anchorShow&&a!=i&&!e.textModified&&this.setData("textModified",!0),e.anchorShow&&e.textModified&&this.setData("buttonDisable",!((a||o)&&i)),o||this.setData("buttonDisable",!(i&&a))}.observes("userInput"),reset_anchor:function(t){var e=t.attr||{},i=this.data.ltPropAnchorProperty;for(var a in["type","target","rel","referrerpolicy","ping","media","hreflang","href","download","lt-prop-title","lt-prop-tooltip-config"].forEach((function(t){delete e[t]})),i)delete e[a]},anchor_prop:function(t,e){var i=this.extend(this.data.ltPropAnchorProperty),a=e.details;t&&["type","target","rel","referrerpolicy","ping","media","hreflang","href","download","title"].forEach((function(e){t[e]?i[e]=t[e]:i[e]&&(t[e]=i[e])})),a.type="anchor",this.pushIfNot(e.classList,"lyteEditorAnchor"),a.anchor&&null!=a.anchor.href&&(i.href=a.anchor.href),a.anchor&&null!=a.anchor.title&&(i.title=a.anchor.title),a.anchor=i,"false"==i.editable&&(delete i.editable,e.attr=e.attr||{},e.attr.editable="false"),this.addAnchorStyle(e,t)},check_other_links:_lyteUiEditor.check_other_links,check_urls:_lyteUiEditor.check_urls,url_detection:function(){var t=this.data,e=t.currentNode,i=$L(e).data("data"),a=t.cursor-1,o=this.getWordText(e),n=o.slice(0,a).split(new RegExp(" |\\s")).pop(),r=this.check_urls(new Text(n));if(r.tagName){var s=o.slice(0,a-n.length),l=(r.innerHTML,o.slice(a)),d=this.findIndex(e);this.updateRangeNode(),this.setData("cursor",1),this.updateNodeValue(e,l);var c=this.mergeWordDom(r,this.extend(i));if(s){var p=this.extend(i);p.text=s,c.unshift(p)}c.reverse().forEach(function(t){this.insertSingleWord(t,this.extend(d))}.bind(this)),this.updateRangeNode(),this.common_positioning()}},style_for_anchor:function(t){var e=this.data,i=(this.extend(e.ltPropAnchorStyle),e.ltPropMultipleProperty),a=["color","display"],o=$L(t).data("data"),n=o.style,r="",s={},l=o.classList,d=this.data.ltPropTagConversion,c=d.sub,p=d.sup,h=this.data.ltPropWordStyleConversion||{},u=this.data.ltPropConvertStyle||{};for(var m in n)if(!(this.getIndex(a,m)+1)){var f=n[m];if(u[m]&&u[m].value==n[m]){let t=u[m];m=t.name,f=t.replaceValue}this.getIndex(i,m)+1?this.ifNotStyle(s,m,f):s[m]=f}for(var m in s)r+=this.dasherize(m)+":"+s[m]+";";return this.getIndex(l,c)+1?r+="vertical-align:sub;":this.getIndex(l,p)+1&&(r+="vertical-align:super;"),l.forEach((function(t){var e=h[t];t!=c&&t!=p&&e&&(r+=e.replace(/^;/,""))})),r}}),Lyte.Mixin.register("lyte-editor-bluepencil",{actions:{mainPaste:function(t){if(null!=this.__empty_pencil_time)return!1;var e=t.clipboardData.getData("text/html");return 0!=this.paste(t,!0)&&(this._editdiv.innerHTML=e),t.preventDefault(),!1},mainInput:function(t){var e="__blue_ignore";if(this[e])return delete this[e],!1;var i=t.inputType;if("insertFromPaste"==i)return this[e]=!0,this.reset_entire();if("insertCompositionText"!=i){var a=window.getSelection().getRangeAt(0);if(a.collapsed){var o=a.commonAncestorContainer.parentNode,n=a.startOffset,r=o.textContent,s=t.data,l=this.data,d=(l.range,"onAfterInput");this.$node.contains(l.currentNode)&&this.reset_current_word(l.currentNode,o,l.cursor,r,n,s),this.getMethods(d)&&this.executeMethod(d,l.currentNode,l.cursor,this.$node)}}},mainKey:function(t){this.copy_evt(t);this.keydown(t);this._editdiv.focus(),this.remove_evt()}},reset_entire:function(t){var e=this._maindiv,i=e.innerHTML,a=event,o=function(){var t=$L(e).data("list")[0],o=this.$node,n=this.__place;Array.from(e.childNodes).forEach((function(t){t.remove()})),n&&this.append(o,n),this.append(this._maindiv,this._cursor),this.append(e,t),i&&o.insertHTML(i),this.execute("onAfterPaste",this._editdiv,a,this.$node),this.checkPlaceholder(),delete this.__blue_ignore}.bind(this);t?o():(clearTimeout(this.__empty_pencil_time),delete this.__empty_pencil_time,setTimeout(o,100))},dispatch_input:function(){this.__blue_ignore=!0,this._maindiv.dispatchEvent(new Event("input",{bubbles:!0}))},__blue_undo:function(){var t=window.getSelection(),e=document.createRange(),i=this.data,a=i.currentNode.childNodes[0],o=i.cursor;t.removeAllRanges(),e.setStart(a,o),e.setEnd(a,o),t.addRange(e),this.dispatch_input()},blue_undo:function(){clearTimeout(this.__blue),this.__blue=setTimeout(this.__blue_undo.bind(this))},pencil_index:function(t,e){var i=t.parentNode||e.parentNode,a=$L(i),o=a.closest(".listHolderElement"),n=o.attr("id"),r=a.data("list"),s=this.getIndex(o.data("list"),i);return{wordIndex:this.getIndex(r,t),paraIndex:s,id:n}},positional_update:function(t,e,i,a,o){var n=this.pencil_index(t,i),r=null==o;this.pushToQueue({operation:"update",oldValue:a,newValue:r?a:o,id:n.id,index:n.paraIndex,wordIndex:n.wordIndex,current:{index:{wordIndex:n.wordIndex,position:e},bluepencil:!0}}),r||this.update_count(o.length-a.length)},modify_pencil_nodes:function(t){t.forEach(function(t){var e=t.act_text;this.positional_update(t.node,e.length,void 0,t.ori_text,e),t.data.text=e}.bind(this))},remove_pencil_nodes:function(t,e){var i=e.parentNode,a=$L(i),o=a.closest(".listHolderElement"),n=o.attr("id"),r=a.data("list"),s=a.data("data").data,l=this.getIndex(o.data("list"),i);t.forEach(function(t){var e=this.getIndex(r,t),i=s[e];this.pushToQueue({operation:"wordDelete",data:i,index:{id:n,paraIndex:l,wordIndex:e},id:n}),this.update_count(-i.text.length),r.splice(e,1),s.splice(e,1)}.bind(this))},reset_current_word:function(t,e,i,a,o,n){var r=$L(t).data("data").text,s=this.get_removed_words(e.parentNode),l=s.removed,d=s.modified;this.positional_update(t,i,e,r),this.remove_pencil_nodes(l,e),this.modify_pencil_nodes(d),this.positional_update(e,o,void 0,a),this.setData({currentNode:e,cursor:o}),this.common_positioning()},get_removed_words:function(t){var e=Array.from(t.children),i=$L(t).data("list"),a=[];return{removed:i.filter((function(t){var i=-1==e.indexOf(t);if(!i){var o=t.textContent,n=$L(t).data("data"),r=n.text;o!=r&&a.push({node:t,act_text:o,ori_text:r,data:n})}return i})),modified:a}},before_edit_open:function(){this.selectAll();var t=this.$node.getHTML().replace(/<br>/g,'<p><span style = "display:inline-block;"></span></p>'),e=Array.from($L(t)),i=window.getSelection(),a=document.createRange(),o=this.__place,n=this._maindiv.querySelector(".lyteEditorCursor"),r=Lyte.Component;this.removeSelected(),n||this._maindiv.appendChild(n=e.shift()),this.toArray(this._editdiv.childNodes).forEach((function(t){t.tagName?t.remove():t.nodeValue&&(t.nodeValue="")})),this.createRange(this._editdiv.childNodes[0],0),Array.from(n.parentNode.querySelectorAll(this.getTag("paragraph"))).forEach((function(t){t.remove()})),e.forEach((function(t){t.removeAttribute("id"),r.insertAfter(n,n=t)})),this._cursor.remove(),o&&o.remove(),i.removeAllRanges();var s,l=$L(n.childNodes).get(-1)||n,d=l.nodeValue;s=d?d.length:((l.childNodes||[]).length||1)-1,a.setStart(l,s),a.setEnd(l,s),i.addRange(a),window.requestAnimationFrame(this.common_evt_fn.bind(this,"add"))},common_evt_fn:function(t){var e,i="__pencil_evt",a="__pencil_close",o=this[i];"add"==t?(o=this[i]=this.pencil_move.bind(this),e=this[a]=this.pencil_close.bind(this)):(delete this[i],this._maindiv.removeEventListener("bpe_pocketeditor_close",this[a])),document.body[t+"EventListener"]("click",o,!0),this._maindiv.addEventListener("bpe_pocketeditor_close",e)},pencil_move:function(t){t.target},pencil_close:function(){this.common_evt_fn("remove"),this._maindiv.focus(),this.__empty_pencil_time=setTimeout(function(){delete this.__empty_pencil_time,this.reset_entire(!0)}.bind(this),100)},append_cursor:function(t){var e=t.parentNode,i=$L((e||{}).children).get(-1);e&&i!=t&&e.appendChild(t)}}),Lyte.Mixin.register("lyte-editor-caption",{copyCaption:function(t){var e=$L(t).find(this.getTag("paragraph")),i=[];e.length&&e.data("list").forEach(function(t){Lyte.arrayUtils(i,"push",this.copyInSameWord(t,0))}.bind(this));return i},caption:function(t){var e=this.data.range,i=$L(this.data.currentNode);if(!e.isRange&&i.hasClass("lyteEditorImage")){var a,o,n,r=i.data("data");this.containsCaption(r)||(this.updateRangeNode(),(a=this.emptyParaData()).style=this.extend(this.data.ltPropCaptionStyle),a.data[0].text=t,this.update_count(t.length),o=this.last(i.data("list")),n=this.render(a),this.pushParagraph(n,o,0),this.setData("currentNode",this.getLastWordInPara(n)),this.setData("cursor",this.getWordText(this.data.currentNode).length),this.updateRangeNode(),this.setCursor(this.data.currentNode,this.data.cursor))}},removeCaption:function(){this.updateRangeNode(),this.removeSelected();var t=$L(this.data.currentNode),e=t.closest(this.getTag("paragraph"));if(this.isCaption(e.get(0))&&(t=e.parent().closest(this.getTag("word"))),t.hasClass("lyteEditorImage")){var i=t.find(this.getTag("paragraph")).get(0);this.update_count(_lyteUiEditor.limitFilter(i,1/0,!0)),this.removePara(i),this.setData("currentNode",t.get(0)),this.setData("cursor",0),this.updateRangeNode(),this.setCursor(this.data.currentNode,this.data.cursor)}},filteroutCaption:function(t){return this.filteroutMention(this._filterout(/\[caption(.+)\]<img/i,"img",this._filterout(/\[caption(.+)\]<video/i,"video",t)))},_filterout:function(t,e,i){if(t.test(i)){var a=t.exec(i)[1].trim();i=(i=i.replace(t,"<caption-div "+a+"><"+e)).replace("[/caption]","</caption-div>"),i=this._filterout(t,e,i)}return i},remove_for_caption:function(t,e){for(var i=t.length,a=this.findIndex(e),o=0;o<i;o++){var n=t[o];(this.isTable(n)||this.isImage(n)||this.isHr(n))&&(t.splice(o,1),o--,i--)}if(i){t.forEach(function(t){t.data.forEach(function(t){this.insertSingleWord(t,a)}.bind(this))}.bind(this));var r=this.extend($L(e).data("data")),s=r.text,l=this.data.cursor;r.text=s.slice(0,l),this.insertSingleWord(r,a),this.setData("cursor",0),this.updateNodeValue(e,s.slice(l)),this.setCursor(e,0)}},containsCaption:function(t){return t.data[1].data.length}}),Lyte.Mixin.register("lyte-editor-code-snippet",{convertSnippetToData:function(t,e,i){const a=Array.from(t.childNodes||[]),o=this.data.spaceDetails,n=this.data.snippetUtils||{},r=this;let s,l=!1,d=null!=i,c=[],p=0,h=0,u=0,m="",f={},g=0,y=0;const v=function(){null!=o[h]&&(s=r.extend(r.emptyParaData()),s.details.snippet={language:e},""===t&&d||(s.data=[]),c.push(s))},b=function(t,e){y=e?y:t.length,i<=g+t.length?(f.nodeIndex=s.data.length-1,f.cursor=e?i-g+y:i-g,d=!1):g+=t.length},x=function(t){if(o[h]&&o[h].length!==p){let e=$L(c[0].data).get(-1);null==e&&(e=r.emptyWordData(),c[0].data.push(e));let i=$L(o[h]).get(-1).indent;e.text+=i,d&&b(i,t)}},_=function(){const t=o[h];let e=!1;if(t&&0===t.length||t&&1===t.length&&(e=""===t[0].value)){const a=r.emptyWordData();return e&&(a.text=t[0].indent),s.data.push(a),e&&b(t[0].indent),h++,null==i&&v(),_()}return!0};return v(),_(),""===t?{data:c,cursor:{nodeIndex:0,cursor:0}}:(a.forEach((function(t){const e=t.classList.value;let a=t.textContent;a=a.replace(/\n/g," "),(a.split(" ")||[]).forEach((function(t){if(""!=t.trim()){const a=r.extend(r.emptyWordData());a.style=n[e]||{};const c=o[h][p];let f;t===c.value?(u=0,m=c.indent+t,p++):(f=c.value.slice(u).indexOf(t),0==f&&(m=0===u?c.indent+t:t,u+=t.length),u===c.value.length&&(l=!0,u=0,p++)),a.text=m,s.data.push(a),d&&b(m);const g=o[h][p];(void 0!==g&&""===g.value||void 0===g)&&(l||0===u)&&(x(!0),h++,p=0,void 0===i&&v(),_()),l=!1}}))})),x(!0),Object.keys(f).length?{data:c,cursor:f}:c)},insertTextInSnippet:function(t,e,i,a){const o=this.findIndex(t),n=i.details.snippet.language,r=$L(e).closest(".listHolderElement");let s=0;for(let t=0;t<o.wordIndex;t++)s+=i.data[t].text.length;s+=this.data.cursor,a=null!=a?a.replace(/\u00a0/g," "):a;const l=e.innerText,d=null!=a,c=l.slice(0,s)+(d?a:"")+l.slice(s);this.calculateCodeIndent(c);const p=""!==c?$L.snippets.getBuilder(i.details.snippet.language,c).build().snippet:"",h=this.convertSnippetToData(p,n,s+(d?a.length:0));this.removePara(e),this.pushParagraph(this.render(h.data[0]),r,o.paraIndex),this.data.currentNode=$L("#"+o.id).data("list")[o.paraIndex].children[h.cursor.nodeIndex],this.data.cursor=h.cursor.cursor,this.setCursor(this.data.currentNode,this.data.cursor),d&&this.update_count(a.length),console.log()}}),Lyte.Mixin.register("lyte-editor-find",{find:function(t){if(!this.data.ltPropFindAndReplace)return;this.setData("selectedRange",[]);let e=this.getData("highlightSpan");if(0!=e.length)for(let t=0;t<e.length;t++)e[t].remove();let i=this.getData("highlightInnerSpan");if(0!=i.length)for(let t=0;t<i.length;t++)i[t].remove();null!=t&&this.setData("ltPropFindShow",!0);const a=this._maindiv;var o=[],n=[];let r=t,s=1;if(""!=r&&null!=r&&"boolean"!=typeof r&&(r=r.toLowerCase()),r&&"boolean"!=typeof r){let t="",e=[".","*","+","?",".","^","$","{","}","(",")","\\","[","]","=","|"],i="";for(let t=0;t<r.length;t++)e.includes(r[t])?i=i+"\\"+r[t]:i+=r[t];t=i.toLowerCase();let d=$L(this.$node).find("lyte-paragraph"),c=[],p=[],h={},u=[];for(let e=0;e<d.length;e++){const i=$L(d[e]).data("list");for(let e=0;e<i.length;e++){u=[];let a=this.getWordText(i[e]).toLowerCase();if(h.completelyFound){let t={left:h.startNodeIndex,right:h.endNodeIndex,startNode:h.startNode,endNode:h.endNode,isRange:!1},e=this.getSelected(t,!0);p.push(e),c.push(t)}null!=h.endNodeIndex&&u.push({node:i[e],index:[0,h.endNodeIndex-1]});let o=[],n=[];h.completelyFound?n=a.slice(h.endNodeIndex).toLowerCase().matchAll(t):o=a.toLowerCase().matchAll(t);for(const t of o)if(null==u[u.length-1]||u[u.length-1].index[1]<t.index){let a={left:t.index,right:t.index+r.length,startNode:i[e],endNode:i[e],isRange:!1},o=this.getSelected(a,!0);u.push({node:i[e],index:[t.index,t.index+r.length-1]}),p.push(o),c.push(a)}for(const t of n)if(null==u[u.length-1]||u[u.length-1].index[1]<t.index+h.endNodeIndex){let a={left:t.index+h.endNodeIndex,right:t.index+r.length+h.endNodeIndex,startNode:i[e],endNode:i[e],isRange:!1},o=this.getSelected(a,!0);u.push({node:i[e],index:[t.index,t.index+r.length-1]}),p.push(o),c.push(a)}if(h.completelyFound&&(h={completelyFound:void 0,value:void 0,size:void 0,foundlength:void 0,startNode:void 0,startNodeIndex:0,endNode:void 0,endNodeIndex:void 0}),""!=a){let t=a[a.length-1].toLowerCase(),o=r[0];function l(t,e){let i=[];for(let a=0;a<t.length;a++)t[a]==e&&i.push(a);return i}if(null!=h.startNode&&e+1<i.length){let t=this.getWordText(i[e+1]).toLowerCase(),o=r.length-h.foundLength;t.length>=o&&t.substring(0,o)==r.substring(r.length-o,r.length)?(h.value=h.value+a.substring(0,r.length-h.foundLength),h.foundLength=h.foundLength+o,h.completelyFound=!0,h.endNode=i[e+1],h.endNodeIndex=o,u={node:i[e+1],index:[0,o-1]}):t.substring(0,t.length)==r.substring(r.length-o,r.length-o+t.length)?(h.value=h.value+t,h.foundLength=h.foundLength+t.length,u.push({node:i[e],index:[0,t.length]})):h={completelyFound:void 0,value:void 0,size:void 0,foundlength:void 0,startNode:void 0,startNodeIndex:0,endNode:void 0,endNodeIndex:void 0}}else if(r.includes(t)){let t=l(a,o),n=t[t.length-1];for(let o=0;o<t.length;o++){let s=u[u.length-1];if((t[o]+1>(s&&s.index[1])||null==(s&&s.index[1])||0==u.length)&&e+1<i.length){let s=this.getWordText(i[e+1]).toLowerCase(),l=r.length-(a.length-t[o]);if(l=l<s.length?l:s.length,l>0){let d=(a.substring(t[o],a.length)+s.substring(0,l)).toLowerCase(),c=d.length;if(r.substring(0,c)==d){n=t[o],h.startNode=i[e],h.startNodeIndex=n,h.completelyFound=c==r.length,h.completelyFound&&(h.endNode=i[e+1]),h.endNodeIndex=l,h.foundLength=c,h.value=d,u.push({node:i[e],index:[n,l]});break}}}}}else h={}}}}for(let t=0;t<p.length;t++){const e=document.createElement("span");if(e.classList.add("lyteUiEditorFindHighlight"),1==p[t].length)e.style.top=p[t][0].top+"px",e.style.height=p[t][0].height+"px",e.style.left=p[t][0].left+"px",e.style.right=p[t][0].right+"px",e.style.width=p[t][0].width+"px",e.style.transform=p[t][0].transform;else{let i,o=0,r=0,l=0,d=0,c=[],h={};for(let e=0;e<p[t].length;e++){let i={top:p[t][e].top,left:p[t][e].left,height:p[t][e].height,width:p[t][e].width};c.push(i),i={}}0!=Object.keys(h).length&&c.push(h),e.style.top=d+"px",e.style.height=r+"px",e.style.left=l+"px",e.style.width=o+"px";for(let t of c)i=document.createElement("span"),i.classList.add("lyteUiEdtorFindPartialHighlight"),i.classList.add(`select${s}`),i.style.top=t.top+"px",i.style.height=t.height+"px",i.style.left=t.left+"px",i.style.width=t.width+"px",n.push(i),a.appendChild(i)}if(o.push(e),a.appendChild(e),1==s){e.classList.add("current");for(let t=0;t<n.length;t++)n[t].classList.add("current");this.changeHighlightData(0)}s++}p.length||this.setData("currentHighlight",void 0),this.setData("selectedRange",c),this.setData("highlightSpan",o),this.setData("highlightInnerSpan",n),this.removeLineOffsetData(),this.reset()}},replaceCurrentText:function(t,e,i,a,o,n){let r=null==o?this.getData("selectedRange")[t]:o[t];if(null!=r){let n=r.startNode,s=r.endNode,l=r.left,d=r.right;if(n==s){let r=n.textContent.slice(0,l)+e+n.textContent.slice(d);if(null!=o){this.updateRangeNode();let a=this.data.cursor;n==this.data.currentNode&&(a<=d&&a>=l?this.setData("cursor",l+e.length):a>d&&(i.length<e.length?this.setData("cursor",a-i.length+e.length):i.length>e.length&&this.setData("cursor",a+i.length-e.length))),t>0&&t<o.length-1&&o[t-1].startNode!=n&&o[t+1].endNode!=s?(this.updateNodeValue(n,r,void 0,!0,!0,!0),this.updateRangeNode()):t>0&&t<o.length-1&&o[t-1].startNode!=n&&o[t+1].endNode==s?this.updateNodeValue(n,r,void 0,!0,!0,!1):t>0&&t<o.length-1&&o[t-1].startNode==n&&o[t+1].endNode==s?this.updateNodeValue(n,r,void 0,!0,!1,!1):t>0&&t<o.length-1&&o[t-1].startNode==n&&o[t+1].endNode!=s?this.updateNodeValue(n,r,void 0,!0,!1,!0):0==t&&t<o.length-1&&o[t+1].endNode==s?this.updateNodeValue(n,r,void 0,!0,!0,!1):0==t&&t<o.length-1&&o[t+1].endNode!=s||0==t&&t==o.length-1?(this.updateNodeValue(n,r,void 0,!0,!0,!0),this.updateRangeNode()):t>0&&t==o.length-1&&o[t-1].startNode==n&&o[t-1].startNode==s?(this.updateNodeValue(n,r,void 0,!0,!1,!0),this.updateRangeNode()):t>0&&t==o.length-1&&o[t-1].endNode!=n||t>0&&"multiNode"==this.data.previousSelection&&n==s?(this.updateNodeValue(n,r,void 0,!0,!0,!0),this.updateRangeNode()):console.warn(o,t)}else this.updateNodeValue(n,r,void 0,!0);a||this.callFind(),this.data.previousSelection="singleNode"}else{this.updateRangeNode();let i=r.startNode.textContent.slice(0,l)+e;if(this.updateNodeValue(s,r.endNode.textContent.slice(d),void 0,!0),this.updateNodeValue(r.startNode,i),this.data.currentNode==r.startNode&&this.data.cursor>=l)this.setData("currentNode",r.endNode),this.setData("cursor",0),this.updateRangeNode();else if(this.data.currentNode==r.endNode&&this.data.cursor)this.setData("currentNode",r.endNode),this.setData("cursor",0),this.updateRangeNode();else{let t=r.startNode.nextSibling;for(;null!=t&&t!=r.endNode;)this.data.currentNode==t?(this.setData("currentNode",r.endNode),this.setData("cursor",0),this.updateRangeNode()):t=t.nextSibling}if(null!=o){let e=o[t];for(let i=t;i<o.length-1;i++)e.endNode==o[i+1].startNode&&e.endNode==o[i+1].endNode?(o[i+1].left=o[i+1].left-d,o[i+1].right=o[i+1].right-d):null!=o&&o.length>i+1&&e.endNode==o[i+1].startNode&&(o[i+1].left=o[i+1].left-d)}let n=r.startNode,c=[];if(null!=n&&null!=n)for(;null!=n&&r.endNode!=n.nextSibling;)c.push(n.nextSibling),n=n.nextSibling;for(let t of c)null!=t&&this.deleteSingleWord(t,this.findIndex(t));this.data.previousSelection="multiNode",a||this.callFind()}}},replaceAllText:function(t){let e=this.getData("selectedRange"),i=this.getData("findInput"),a=0;if(null!=e)for(let o=0;o<e.length;o++){let n=null!=i&&null!=a?a*(i.length-1):0,r=null!=a?a*(t.length-1):0;o>0&&(e[o-1].startNode==e[o-1].endNode&&e[o-1].endNode==e[o].startNode&&e[o].startNode==e[o].endNode?(e[o].left=e[o].left+r-n,e[o].right=e[o].right+r-n):e[o-1].startNode==e[o-1].endNode&&e[o-1].endNode==e[o].startNode&&(e[o].left=e[o].left+r-n)),this.replaceCurrentText(o,t,i,!0,e,a),a++,o+1<e.length&&e[o+1].startNode!=e[o].endNode&&(a=0)}this.callFind()}}),Lyte.Mixin.register("lyte-editor-image",{imageText:function(t){var e,i=t.parentNode,a=this.findIndex(t),o=$L(i).closest(".listHolderElement"),n=o.data("list")[a.paraIndex+1];let r=this.emptyParaData();if(this.data.ltPropInlineImage)return a.wordIndex++,this.insertSingleWord(this.emptyWordData(),a),void this.setData({currentNode:this.getNext(t),cursor:0});if(n){var s=$L(n).data("data");(this.isImage(s)||this.isTable(s)||this.isHr(s))&&(e=!0,n=this.render(r))}else e=!0,n=this.render(r);e&&this.pushParagraph(n,o,a.paraIndex+1),this.setData("currentNode",this.getFirstWordInPara(n)),this.setData("cursor",0)},deleteImage:function(t){this.updateRangeNode();var e,i,a=$L(t).closest(this.getTag("paragraph")).get(0),o=this.findIndex(t),n=$L(a).closest(".listHolderElement"),r=n.data("list"),s=r[o.paraIndex-1],l=r[o.paraIndex+1],d=s?$L(s).data("data"):void 0,c=l?$L(l).data("data"):void 0,p=d&&(this.isImage(d)||this.isTable(d)||this.isHr(d)),h=c&&(this.isImage(c)||this.isTable(c)||this.isHr(c));if(this.data.ltPropInlineImage){let n=this.getPreviousWord(t),r=this.getNextWord(t),s=$L(a).data("list");this.deleteSingleWord(t,o),n&&r?(e=r,i=0):n&&r?(e=n,i=this.getWordText(n).length):!n&&r?(e=r,i=0):n||r||(this.insertSingleWord(this.emptyWordData(),o),e=s[o.wordIndex],i=0),this.setData("currentNode",e),this.setData("cursor",i)}else{if(this.removePara(a),s&&l&&!p&&!h&&(e=this.getFirstWordInPara(l),i=0),s&&!l)e=this.getLastWordInPara(s),i=this.getWordText(this.data.currentNode).length;else if(!s&&l)e=this.getFirstWordInPara(l),i=0;else if(!s&&!l){var u=this.render(this.emptyParaData());this.pushParagraph(u,n,o.paraIndex),e=this.getFirstWordInPara(u),i=0}null!=e&&this.setData("currentNode",e),null!=i&&this.setData("cursor",i)}this.setCursor(this.data.currentNode,this.data.cursor),this.updateRangeNode()},inline_image_html:function(t,e,i){var a=this.create("div");a.innerHTML=t,Lyte.resolvePromises(this.convert_inline_image(a)).then((function(){e(a.innerHTML,i)}))},replaceImage:function(t,e){let i=this.data.ltPropTags,a=e.closest(i.word),o=this.findIndex(a);$L(this.$node).find("#"+o.id).get(0);t=Lyte.Component.registeredHelpers.unescape(t,void 0,this._sanitizer).innerHTML;let n=this.convertHtmlToData(t)[0];this.deleteSingleWord(a,o),this.insertSingleWord(n.data[0],o)},alignImage:function(t){var e=this.data.currentNode,i=$L(e);if(i.hasClass("lyteEditorImage")&&!this.data.range.isRange){var a=i.closest(this.getTag(this.data.ltPropInlineImage?"word":"paragraph")).get(0),o=this.isUpdateIcon();if(a.style.float==t)return{applied:[1],toApply:[]};if(o)return;this.setStyle(a,"float",t),this.setStyle(a,"zIndex","10"),this.setStyle(e,"margin","0 10px"),this.setStyle(e,"clear","both"),this.setCursor(e,0),this.update_panel()}},imageDrop:function(t,e){this.updateRangeNode();var i=$L(t).data("directions"),a=e.style.width,o=e.style.height;this.data.range;e.style.left="",e.style.top="",i.width&&this.setStyle(e,"width",a),i.height&&this.setStyle(e,"height",o),this.common_positioning(),this.updateRangeNode()},formatImage:function(t){var e=this.emptyParaData(),i=[],a=this.toArray(t.childNodes),o=this.emptyParaData();a.forEach(function(t){((t.childNodes||[]).length>1?this.toArray(t.childNodes):[t]).forEach(function(t){this.pushIfValid(i,this.formatWord(t))}.bind(this))}.bind(this)),e.data=[i[0]],e.data[0].data[1].data=[o],o.data=i.splice(1);var n=e.data[0].style,r=e.style;return n.float&&(r.float=n.float,r.zIndex=r.zIndex||"10",n.width=n.width||"100%",n.maxWidth=n.maxWidth||"100%",delete n.float),[e]},check_imagePara:function(t){var e=this;this.data.ltPropInlineImage||t.forEach((function(t){var i=t.data,a=e.get_images(i);i.length!=a.length&&a.forEach((function(t){var e=t.details,i=t.attr;delete e.resize,delete e.arguments,i||(t.attr=i={}),i.editable="false"}))}))},get_images:function(t){return t.filter((function(t){return"image"==t.details.type}))},emptyImage:function(t,e){return{details:{},data:[{tag:e,details:{src:((t=t||{}).attributes.src||{}).nodeValue||"",alt:t.alt||""},style:{margin:0}}],classList:["lyteEditorImageWrapper"],style:{width:"100%",height:"100%",overflow:"auto"},tag:"div"}},image_data:function(t,e,i){t.data=[this.emptyImage(e,i),{data:[],style:{pointerEvents:"none",width:"100%"},details:{type:"captionWrapper"},randomId:this.randomId(),tag:"div"}],$L.extend(t.style,this.data.ltPropImageStyle);var a=$L(e),o=function(t){return t&&/^[0-9]+$/.test(t)?t+"px":t||""},n=o(a.attr("width")),r=o(a.attr("height"));return n&&(t.style.width=n),r&&(t.style.height=r),t.style.zIndex=t.style.zIndex||"10",t.details.type="image",t.details.tag=i,t.details.displayType=e.getAttribute("display-type")||"fitToScreen",t.classList.push("lyteEditorImage"),"false"!=a.attr("editable")?(t.details.resize=this.data.ltPropImageResize,t.details.arguments={boundary:"lyte-texteditor, "+this.getTag("th")+", "+this.getTag("td"),minWidth:50,minHeight:50,onDrop:this.imageDrop.bind(this),clonedShape:!0}):t.attr={editable:"false"},t},convert_inline_image:function(t){var e=Array.from(t.getElementsByTagName("img")),i=[],a=(t=this,function(e,i,a){try{e.src=t.copy_image(i,"",i.naturalWidth,i.naturalHeight)}catch(t){console.warn("Can not convert to inline image"+t.message)}a()});return e.forEach((function(e){e.src;i.push(new Promise((function(i,o){var n,r=e.src;if(/^(data|blob):/i.test(r))return i();t.getMethods("onImagePaste")&&(n=t.executeMethod("onImagePaste",e.src,e,t.$node)),n&&n.then&&n.then((function(t){e.src=t}));var s=new Image;s.crossOrigin="Anonymous",s.src=r,s.onload=a.bind(t,e,s,i),s.onerror=function(){t.execute("onImageError",e,r,t.$node),i()}})))})),i},image_paste:function(t,e){var i=t.clipboardData.files||[],a=i[0];return this.data.ltPropConvertInlineImages&&a&&1==i.length&&/image\/*/i.test(a.type)?(this.inline_from_file(a,function(t){this._editdiv.innerHTML=t,e()}.bind(this)),t.preventDefault()):e()},methods:{imageMenuOpen:function(t,e){var i=e.clientX,a=e.clientY;t.ltProp("boundary",{left:i,top:a,bottom:a,right:i}),t.component.setContextCss(e,t.ltProp("position"))},imageSelect:function(t,e,i,a){if("remove"==t)this.deleteImage(a);else if("edit"==t){let t=$L(this.$node.panel.$node).find(".lyteEditorImageIcon")[0].component,e=a.getElementsByTagName("img")[0];var o=function(e){let i=$L(e).closest("lyte-word").get(0),a=$L(i).data("data"),o=a.details.displayType;t.data.ltPropImageOptions.forEach((function(t){t.subItems.forEach((function(t){let i,n=t.purpose;switch(n){case"alt":Lyte.objectUtils(t,"add","value",e.alt||"");break;case"height":case"width":i="","actualSize"==o?Lyte.objectUtils(t,"add","value",e["natural"+n]||""):"custom"==o?(Lyte.objectUtils(t,"add","value",parseInt(a.style[n])||""),/%$/.test(a.style.width)&&(i="%")):Lyte.objectUtils(t,"add","value",""),Lyte.objectUtils(t,"add","unit",i||"px");break;case"unit":i="","custom"==o&&/%$/.test(a.style.width)&&(i="%");break;case"horizontal":Lyte.objectUtils(t,"add","value",parseInt(a.style.marginInline)||"");break;case"vertical":Lyte.objectUtils(t,"add","value",parseInt(a.style.marginTop)||"");break;case"border":Lyte.objectUtils(t,"add","value",parseInt(a.style.border)||"");break;case"align":i=a.style.float?a.style.float:a.style.verticalAlign,Lyte.objectUtils(t,"add","value",i)}}))})),"custom"!=o&&t.setData(o,!0)}.bind(this);t._imgElm=e,t.setData("cpShow",!0),t.setData("url",e.src),o(e)}else{var n,r,s=a.getElementsByTagName("img")[0],l=$L($L(s).closest("lyte-word").get(0)).data("data"),d=s.naturalWidth,c=s.naturalHeight,p="actualSize",h=this.data.ltPropImageStyle.margin||"0px",u=this.findIndex(a),m=a.style,f=$L(a).data("data").style,g=function(t,e){var i=m[e];i!=t&&(f[e]=m[e]=t,this.pushToQueue({operation:"styleSet",oldValue:i,newValue:t,prop:e,id:u.id,index:u,word:!0}))}.bind(this),y=function(t,e){let i=l.details[e];this.pushToQueue({operation:"properties",prop:"arr:"+u.paraIndex+".data.arr:"+u.wordIndex+".details."+e,id:u.id,oldValue:i,newValue:t}),l.details[e]=t}.bind(this);switch(t){case"small":r=c/d*(n=200)+"px",n+="px",p="small";break;case"fit_to_screen":n="calc( 100% - "+h+" - "+h+" )",r="calc( "+c/d*100+"% - "+h+" - "+h+" )",p="fitToScreen";break;case"actual_size":n=d+"px",r=c+"px",p="actualSize"}g(n,"width"),g(r,"height"),y(p,"displayType")}this.$node.focus()}}}),Lyte.Mixin.register("lyte-editor-blockquote",{blockquote_check:function(t){var e=this,i="_blockquote";clearTimeout(t[i]),t[i]=setTimeout((function(){delete t[i],e.$node.contains(t)&&e.check_bq(t)}),0)},check_bq:function(t){var e,i,a,o,n=[],r=this.data.ltPropBlockquoteClasses,s=this,l=void 0,d=$L(t),c=(o=d.data("data")).data||o,p=d.data("list"),h=t.id,u="lyteBlockquoteFirst",m="lyteBlockquoteLast",f=function(){a=!0;var t=n.pop();y(e,u),t?(g(e,m),g(t,u),y(t,m)):y(e,m),n.forEach((function(t){g(t,u),g(t,m)})),i=e=l,n=[]},g=function(t,e){var i=c[t].classList,a=s.getIndex(i,e);a+1&&($L(p[t]).removeClass(e),i.splice(a,1),v("removeClass",e,t))},y=function(t,e){var i=c[t].classList;-1==s.getIndex(i,e)&&($L(p[t]).addClass(e),i.push(e),v("addClass",e,t))},v=function(t,e,i){s.pushToQueue({operation:"class",prop:t,id:h,value:e,element:"arr:"+i})};(c.data||c).forEach(function(t,a){_lyteUiEditor.isSection(t)&&this.check_bq($L("#"+t.data[0].data[0].randomId).get(0));var o=t.classList;if(s.getIndex(o,"lyteEditorBlockquote")+1){var d=function(t){var e;return r.every((function(i){return s.getIndex(t,i)+1&&(e=i),!e})),e}(o);e==l?(e=a,i=d):i==d?n.push(a):(f(),e=a,i=d)}else e!=l&&f()}.bind(this)),e!=l&&f(),a&&this.common_positioning()},lyteEditorBlockquote:function(t){var e=this.extend(this.data.ltPropBlockquoteClasses,[]),i="lyteEditorBlockquote",a=this.getIndex(e,t=t||"lyteEditorQuoteLeft"),o=this;return a+1&&e.splice(a,1),this.toggleParaClass(t,void 0,function(t,e){var n=o.findIndex(o.getFirstWordInPara(t)),r=$L(t),s=r.data("data");if(e){var l=s.details.tab;r.hasClass(i)||(o.pushToQueue({operation:"class",prop:"addClass",id:n.id,value:i,element:"arr:"+n.paraIndex}),r.addClass(i),s.classList.push(i)),l&&o.tab_common_fn(void 0,void 0,t,!1)}else[i,"lyteBlockquoteFirst","lyteBlockquoteLast"].forEach((function(t){var e=s.classList;(a=o.getIndex(e,t))+1&&(o.pushToQueue({operation:"class",prop:"removeClass",id:n.id,value:t,element:"arr:"+n.paraIndex}),r.removeClass(t),e.splice(a,1))}));this.blockquote_check(t.parentNode)}.bind(this),e)},removeBlockquote:function(){if(!this.isUpdateIcon()){var t,e=this.data,i=e.selectedParagraph,a=e.ltPropBlockquoteClasses,o=this;i.forEach((function(e){var i=$L(e),n=i.data("data").classList,r=o.findIndex(o.getFirstWordInPara(e)),s=function(t){var e=o.getIndex(n,t);if(e+1)return o.pushToQueue({operation:"class",prop:"removeClass",id:r.id,value:t,element:"arr:"+r.paraIndex}),i.removeClass(t),n.splice(e,1),!0};s("lyteEditorBlockquote")&&(t=!0,a.forEach(s),o.blockquote_check(e.parentNode))})),t&&this.common_positioning()}},format_blockquote:function(t,e,i){var a=this.data.ltPropParaStyleConversion[i=$L(t).attr("lyte-blockquote-type")]||[];e[0].classList.push(i),e.forEach(function(t){var e=t.style;a.forEach(function(t){delete e[this.camelCase(t.split(":")[0]||"")]}.bind(this))}.bind(this))}}),Lyte.Mixin.register("lyte-editor-list",{list_init:function(){this.data.listMapping={ulTick:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2212px%22 height = %2212px%22%3E%3Cpath d = %22M313.8,47l-7.4,8.2l-2.2-1.6H303l3.4,5.5l8.6-12h-1.2V47z%22 style=%22fill:%23313949%3Btransform:translate(-303px,-47px)%3B%22/%3E%3C/svg%3E",ulVolume:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2210px%22 height = %228px%22%3E%3Cpath d = %22M322.2,51.6L322.2,51.6c-0.3,0-0.5,0.1-0.7,0.3s-0.3,0.4-0.3,0.7v0.9c0,0.3,0.1,0.5,0.3,0.7 c0.2,0.2,0.4,0.3,0.7,0.3l0,0c0.1,0,0.3,0,0.4,0.1s0.2,0.1,0.3,0.2l1.7,2c0.3,0.3,0.8,0.1,0.8-0.3v-6.9c0-0.4-0.5-0.6-0.8-0.3 l-1.7,2c-0.1,0.1-0.2,0.2-0.3,0.2S322.3,51.6,322.2,51.6z M328.6,49.4c0,0-0.1-0.1-0.2-0.1s-0.1,0-0.2,0s-0.1,0-0.2,0 s-0.1,0.1-0.2,0.1s-0.1,0.1-0.1,0.2c0,0.1,0,0.1,0,0.2c0,0.1,0,0.1,0,0.2c0,0.1,0.1,0.1,0.1,0.2c1.7,1.6,1.7,4.3,0,5.9 c0,0-0.1,0.1-0.1,0.2c0,0.1,0,0.1,0,0.2c0,0.1,0,0.1,0,0.2c0,0.1,0.1,0.1,0.1,0.2c0,0,0.1,0.1,0.2,0.1s0.1,0,0.2,0s0.1,0,0.2,0 s0.1-0.1,0.2-0.1C330.7,54.7,330.7,51.4,328.6,49.4z M327.2,50.7c-0.1-0.1-0.2-0.1-0.3-0.1c-0.1,0-0.2,0.1-0.3,0.1 c-0.1,0.1-0.1,0.2-0.1,0.3s0.1,0.2,0.1,0.3c1,0.9,1,2.4,0,3.3c0,0-0.1,0.1-0.1,0.2c0,0.1,0,0.1,0,0.2c0,0.1,0,0.1,0,0.2 s0.1,0.1,0.1,0.2c0.1,0.1,0.2,0.1,0.3,0.1c0.1,0,0.1,0,0.2,0s0.1-0.1,0.2-0.1C328.6,54.1,328.6,52,327.2,50.7z%22 style=%22fill:%23313949%3Btransform:translate(-321px,-49px)%3Bfill-rule:evenodd%3Bclip-rule:evenodd%3B%22/%3E%3C/svg%3E",ulSquareOutline:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %228px%22 height = %228px%22%3E%3Cpath d = %22M0,0L8,0L8,8L0,8Z%22 style=%22fill:none%3Bstroke:%23313949%3Bstroke-width:1.5%3Bstroke-linecap:round%3Bstroke-linejoin:bevel%3B%22/%3E%3C/svg%3E",ulDisclosureClosed:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %229px%22 height = %2211px%22%3E%3Cpath d = %22M394.6,72l-7.8-4.9c-0.1-0.1-0.2-0.1-0.3-0.1c-0.1,0-0.2,0-0.3,0.1c-0.1,0-0.2,0.1-0.2,0.2 c-0.1,0.1-0.1,0.2-0.1,0.3v9.9c0,0.1,0,0.2,0.1,0.3c0.1,0.1,0.1,0.2,0.2,0.2s0.2,0.1,0.3,0.1c0.1,0,0.2,0,0.3-0.1l7.8-4.9 c0.1-0.1,0.1-0.1,0.2-0.2c0-0.1,0.1-0.2,0.1-0.3s0-0.2-0.1-0.3C394.7,72.1,394.7,72.1,394.6,72z%22 style=%22fill:%23313949%3Btransform:translate(-386px,-67px)%3B%22/%3E%3C/svg%3E",ulLineBall:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2212px%22 height = %2213px%22%3E%3Cpath d = %22M348.9,52.9c0-0.8-0.1-1.6-0.4-2.4c-0.3-0.8-0.8-1.4-1.3-2c-0.6-0.6-1.3-1-2-1.3c-0.8-0.3-1.6-0.4-2.4-0.4 c0.1,0.9-0.1,1.8-0.4,2.6l-1.1-0.5c0.3-0.6,0.4-1.3,0.3-2c-1.1,0.2-2.1,0.8-2.9,1.6s-1.4,1.8-1.6,2.9c0.5,0,1,0,1.5-0.2l0.3,1.2 c-0.7,0.2-1.4,0.3-2,0.2c0,0.8,0.1,1.6,0.4,2.4c0.3,0.8,0.8,1.4,1.3,2c0.6,0.6,1.3,1,2,1.3c0.8,0.3,1.6,0.4,2.4,0.4 c-0.1-0.7,0-1.4,0.2-2l1.2,0.3c-0.2,0.5-0.2,1-0.2,1.5c1.1-0.2,2.1-0.8,2.9-1.6s1.4-1.8,1.6-2.9c-0.7-0.1-1.3,0.1-2,0.3l-0.5-1.1 C347.2,52.9,348.1,52.8,348.9,52.9z M341.2,51c-0.4,0.4-0.8,0.7-1.3,1l-0.6-1.1c0.6-0.3,1.2-0.8,1.5-1.4l1,0.7 C341.7,50.5,341.5,50.8,341.2,51z M345.5,55.3c-0.3,0.3-0.6,0.6-0.8,1l-1.1-0.6c0.4-0.8,1-1.5,1.8-2l0.7,1 C345.9,54.9,345.7,55.1,345.5,55.3z%22 style=%22fill:%23313949%3Btransform:translate(-337px,-46px)%3B%22/%3E%3C/svg%3E",ulDiamond:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2212px%22 height = %2212px%22%3E%3Cpath d = %22M405.4,52.8c-0.1-0.1-0.2-0.2-0.2-0.4s0.1-0.3,0.2-0.4l5-5c0.1-0.1,0.2-0.2,0.4-0.2s0.3,0.1,0.4,0.2l5,5 c0.1,0.1,0.2,0.2,0.2,0.4c0,0.1-0.1,0.3-0.2,0.4l-5,5c-0.1,0.1-0.2,0.2-0.4,0.2s-0.3-0.1-0.4-0.2L405.4,52.8z%22 style=%22fill:%23313949%3Btransform:translate(-405px,-46px)%3B%22/%3E%3C/svg%3E",ulFingerPointer:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2213px%22 height = %2212px%22%3E%3Cpath d = %22M294.6,72.2h-7.2l0.7-1.8c0.1-0.1,0.1-0.3,0.1-0.5s0-0.3-0.1-0.5c-0.1-0.1-0.2-0.3-0.3-0.4 c-0.1-0.1-0.3-0.2-0.4-0.2l-0.2-0.1c-0.1,0-0.2,0-0.4,0s-0.2,0.1-0.3,0.2l-2.6,3c-0.1,0.1-0.1,0.2-0.1,0.4v6.2 c0,0.3,0.1,0.6,0.4,0.8s0.5,0.3,0.8,0.3h4.3c0.3,0,0.6-0.1,0.8-0.3c0.2-0.2,0.4-0.5,0.4-0.7l0.5-4.2h3.6c0.3,0,0.6-0.1,0.8-0.3 c0.2-0.2,0.4-0.5,0.4-0.8s-0.1-0.6-0.4-0.8C295.2,72.3,294.9,72.2,294.6,72.2z%22 style=%22fill:%23313949%3Btransform:translate(-283px,-68px)%3B%22/%3E%3C/svg%3E",ulPencil:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2210px%22 height = %229px%22%3E%3Cpath d = %22M375.7,68.1c-0.1-0.1-0.1-0.1-0.2-0.1s-0.2,0-0.2,0h-0.2c-0.1,0-0.1,0.1-0.2,0.1l-5.3,5.3v2.8 c0,0.2,0.1,0.3,0.2,0.5c0.1,0.1,0.3,0.2,0.5,0.2h2.8l5.3-5.3c0.1-0.1,0.1-0.1,0.1-0.2s0-0.2,0-0.2c0-0.1,0-0.2,0-0.2 s-0.1-0.1-0.1-0.2L375.7,68.1z%22 style=%22fill:%23313949%3Btransform:translate(-369px,-68px)%3B%22/%3E%3C/svg%3E",ulOutlineStar:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2213px%22 height = %2212px%22%3E%3Cpath d = %22M97.1,99.5l-3.4,1.9l0.6-4l-2.8-2.8l3.8-0.6l1.7-3.6l1.7,3.6l3.8,0.6l-2.8,2.8l0.6,4L97.1,99.5z%22 style=%22fill:none%3Btransform:translate(-91px,-90px)%3Bstroke:%23313949%3Bstroke-linecap:round%3Bstroke-linejoin:round%3B%22/%3E%3C/svg%3E",ulFilledHeart:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2211px%22 height = %229px%22%3E%3Cpath d = %22M305.9,69.8c-0.2-0.2-0.5-0.4-0.8-0.5s-0.6-0.2-0.9-0.2s-0.6,0.1-0.9,0.2s-0.6,0.3-0.8,0.5 c-0.2,0.2-0.4,0.5-0.5,0.8s-0.2,0.6-0.2,0.9s0.1,0.6,0.2,0.9s0.3,0.5,0.5,0.8l4.3,4.3l4.3-4.3c0.4-0.4,0.6-1,0.6-1.6 s-0.3-1.2-0.7-1.6c-0.4-0.4-1-0.7-1.6-0.7s-1.2,0.2-1.6,0.6l-1,1L305.9,69.8z%22 style=%22fill:%23313949%3Btransform:translate(-301px,-69px)%3B%22/%3E%3C/svg%3E",ulRightArrow:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %225px%22 height = %228px%22%3E%3Cpath d = %22M24.1,99l3.8-4l-3.8-4L23,92.2l2.7,2.8L23,97.8L24.1,99z%22 style=%22fill:%23313949%3Btransform:translate(-23px,-91px)%3B%22/%3E%3C/svg%3E",ulBallThreeDots:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2210px%22 height = %2211px%22%3E%3Cpath d = %22M359.9,47.7c-2.8,0-5,2.2-5,5s2.2,5,5,5s5-2.2,5-5S362.7,47.7,359.9,47.7z M357.2,52.7c-0.1,0-0.2,0-0.3-0.1 c-0.1,0-0.2-0.1-0.2-0.2c-0.1-0.1-0.1-0.2-0.2-0.2c0-0.1-0.1-0.2-0.1-0.3s0-0.2,0.1-0.3c0-0.1,0.1-0.2,0.2-0.2 c0.1-0.1,0.2-0.1,0.2-0.2c0.1,0,0.2-0.1,0.3-0.1c0.2,0,0.4,0.1,0.5,0.2c0.1,0.1,0.2,0.3,0.2,0.5s-0.1,0.4-0.2,0.5 C357.6,52.7,357.4,52.7,357.2,52.7z M358.4,50c0-0.2,0.1-0.4,0.2-0.5s0.3-0.2,0.5-0.2s0.4,0.1,0.5,0.2s0.2,0.3,0.2,0.5 s-0.1,0.4-0.2,0.5s-0.3,0.2-0.5,0.2s-0.4-0.1-0.5-0.2C358.5,50.4,358.4,50.2,358.4,50z M359.7,53.2c-0.1,0-0.2,0-0.3-0.1 c-0.1,0-0.2-0.1-0.2-0.2c-0.1-0.1-0.2-0.3-0.2-0.5c0-0.1,0-0.2,0.1-0.3c0-0.1,0.1-0.2,0.2-0.2c0.1-0.1,0.3-0.2,0.5-0.2 s0.4,0.1,0.5,0.2c0.1,0.1,0.2,0.3,0.2,0.5s-0.1,0.4-0.2,0.5C360.1,53.2,359.9,53.2,359.7,53.2z%22 style=%22fill:%23313949%3Btransform:translate(-355px,-47px)%3B%22/%3E%3C/svg%3E",ulPlus:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2210px%22 height = %2210px%22%3E%3Cpath d = %22M406.3,71.4v-3.9h1.3v3.9h3.9v1.3h-3.9v3.9h-1.3v-3.9h-3.9v-1.3H406.3z%22 style=%22fill-rule:evenodd%3Bclip-rule:evenodd%3Bfill:%23313949%3Btransform:translate(-402px,-67px)%3B%22/%3E%3C/svg%3E",ulRightPointer:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %229px%22 height = %229px%22%3E%3Cpath d = %22M14.6,95c0,0.1,0,0.1-0.1,0.2c0,0.1-0.1,0.1-0.2,0.1l-7,3.2c-0.1,0-0.1,0-0.2,0S7,98.4,6.9,98.4 c0,0-0.1-0.1-0.1-0.2s0-0.1,0-0.2l1.4-3.3l-1.3-3.4c0-0.1,0-0.1,0-0.2s0-0.1,0.1-0.2c0,0,0.1-0.1,0.2-0.1s0.1,0,0.2,0l6.9,3.7 c0.1,0,0.1,0.1,0.2,0.1S14.6,94.9,14.6,95z%22 style=%22fill:%23313949%3Btransform:translate(-6px,-90px)%3B%22/%3E%3C/svg%3E",ulCrossPlus:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2211px%22 height = %2211px%22%3E%3Cpath d = %22M328.9,75.4h-1.6c-0.1,0-0.2,0-0.3-0.1c-0.1-0.1-0.2-0.1-0.3-0.2l-1.2-1.2c-0.1-0.1-0.2-0.2-0.2-0.3 s0.1-0.2,0.2-0.3l1.2-1.2c0-0.1,0.1-0.1,0.3-0.2c0.1-0.1,0.3-0.1,0.3-0.1h1.6c0.2,0,0.3,0.1,0.4,0.2s0.2,0.3,0.2,0.4v2.5 c0,0.2-0.1,0.3-0.2,0.4C329.3,75.4,329.1,75.4,328.9,75.4z M326.1,71.4l-1.2,1.2c-0.1,0.1-0.2,0.2-0.3,0.2c-0.1,0-0.2-0.1-0.3-0.2 l-1.2-1.2c-0.1-0.1-0.1-0.2-0.2-0.3c-0.1-0.1-0.1-0.2-0.1-0.3v-1.6c0-0.2,0.1-0.3,0.2-0.4s0.3-0.2,0.4-0.2h2.5 c0.2,0,0.3,0.1,0.4,0.2s0.2,0.3,0.2,0.4v1.6c0,0.1,0,0.2-0.1,0.3C326.3,71.2,326.2,71.3,326.1,71.4z M323.6,73.9l-1.2,1.2 c-0.1,0.1-0.2,0.1-0.3,0.2c-0.1,0.1-0.2,0.1-0.3,0.1h-1.6c-0.2,0-0.3-0.1-0.4-0.2s-0.2-0.3-0.2-0.4v-2.5c0-0.2,0.1-0.3,0.2-0.4 s0.3-0.2,0.4-0.2h1.6c0.1,0,0.2,0,0.3,0.1c0.1,0.1,0.2,0.1,0.3,0.2l1.2,1.2c0.1,0.1,0.2,0.2,0.2,0.3S323.7,73.7,323.6,73.9z M324.2,74.5c0.1-0.1,0.2-0.2,0.3-0.2c0.1,0,0.2,0.1,0.3,0.2l1.2,1.2c0.1,0,0.1,0.1,0.2,0.3s0.1,0.3,0.1,0.3v1.6 c0,0.2-0.1,0.3-0.2,0.4s-0.3,0.2-0.4,0.2h-2.5c-0.2,0-0.3-0.1-0.4-0.2s-0.2-0.3-0.2-0.4v-1.6c0-0.1,0-0.2,0.1-0.3 c0.1-0.1,0.1-0.2,0.2-0.3L324.2,74.5z%22 style=%22fill:%23313949%3Btransform:translate(-319px,-68px)%3B%22/%3E%3C/svg%3E",ulFolder:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2211px%22 height = %229px%22%3E%3Cpath d = %22M254.3,71.9h-4.8l-0.9-0.9c0,0-0.1-0.1-0.2-0.1c-0.1,0-0.1,0-0.2,0h-2c-0.6,0-1,0.4-1,1v7c0,0.6,0.4,1,1,1h8 c0.6,0,1-0.4,1-1v-6C255.3,72.3,254.9,71.9,254.3,71.9z%22 style=%22fill:%23313949%3Btransform:translate(-245px,-71px)%3B%22/%3E%3C/svg%3E",ulClock:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2212px%22 height = %2213px%22%3E%3Cpath d = %22M392.9,46.6c-3.3,0-6,2.7-6,6s2.7,6,6,6s6-2.7,6-6S396.2,46.6,392.9,46.6z M395.2,54.4l-0.4,0.5l0,0l0,0l0,0 l0,0l-2.2-1.6l0,0l0,0v-3.7c0-0.1,0-0.1,0.1-0.1h0.6c0.1,0,0.1,0,0.1,0.1v3.3l1.9,1.4C395.3,54.3,395.3,54.4,395.2,54.4z%22 style=%22fill:%23313949%3Btransform:translate(-387px,-46px)%3B%22/%3E%3C/svg%3E",ulSideCube:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2210px%22 height = %2212px%22%3E%3Cpath d = %22M377.7,57.7c0,0.1,0,0.2,0.1,0.3s0.1,0.2,0.2,0.3s0.2,0.1,0.3,0.1c0.1,0,0.2,0,0.4-0.1l2.9-1.4 c0.1-0.1,0.2-0.2,0.3-0.3c0.1-0.1,0.1-0.2,0.1-0.4v-4.1c0-0.1,0-0.2-0.1-0.3s-0.1-0.2-0.2-0.3s-0.2-0.1-0.3-0.1 c-0.1,0-0.2,0-0.4,0.1l-2.9,1.4c-0.1,0.1-0.2,0.2-0.3,0.3c-0.1,0.1-0.1,0.2-0.1,0.4V57.7z%22 style=%22fill:%23313949%3Btransform:translate(-372px,-47px)%3B%22/%3E%3Cpath d = %22M380.7,50.1c0.1-0.1,0.2-0.2,0.3-0.3c0.1-0.1,0.1-0.2,0.1-0.4c0-0.1,0-0.3-0.1-0.4c-0.1-0.1-0.2-0.2-0.3-0.3 l-3.4-1.7c-0.1,0-0.2-0.1-0.3-0.1c-0.1,0-0.2,0-0.3,0.1l-3.4,1.7c-0.1,0.1-0.2,0.2-0.3,0.3c-0.1,0.1-0.1,0.2-0.1,0.4 c0,0.1,0,0.3,0.1,0.4c0.1,0.1,0.2,0.2,0.3,0.3l3.4,1.7c0.1,0,0.2,0.1,0.3,0.1c0.1,0,0.2,0,0.3-0.1L380.7,50.1z%22 style=%22fill:%23313949%3Btransform:translate(-372px,-47px)%3B%22/%3E%3Cpath d = %22M373,51.6c-0.1-0.1-0.2-0.1-0.4-0.1c-0.1,0-0.2,0-0.3,0.1c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.1-0.1,0.2-0.1,0.3 v4.1c0,0.1,0,0.3,0.1,0.4c0.1,0.1,0.2,0.2,0.3,0.3l2.9,1.4c0.1,0.1,0.2,0.1,0.4,0.1c0.1,0,0.2,0,0.3-0.1c0.1-0.1,0.2-0.2,0.2-0.3 c0.1-0.1,0.1-0.2,0.1-0.3v-4.1c0-0.1,0-0.3-0.1-0.4c-0.1-0.1-0.2-0.2-0.3-0.3L373,51.6z%22 style=%22fill:%23313949%3Btransform:translate(-372px,-47px)%3B%22/%3E%3C/svg%3E",ulSmiley:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2215px%22 height = %2214px%22%3E%3Cpath d = %22M42.2,90c3.9,0,7,3.1,7,7s-3.1,7-7,7s-7-3.1-7-7S38.3,90,42.2,90z M39.9,94.7c-0.5,0-0.9,0.4-0.9,0.9 s0.4,0.9,0.9,0.9s0.9-0.4,0.9-0.9C40.8,95.1,40.4,94.7,39.9,94.7z M44.4,94.7c-0.5,0-0.9,0.4-0.9,0.9s0.4,0.9,0.9,0.9 s0.9-0.4,0.9-0.9C45.3,95.1,44.9,94.7,44.4,94.7z M38.9,99.5c0.8,1,2,1.5,3.2,1.5s2.4-0.6,3.2-1.5c0.4-0.5-0.3-1-0.7-0.6 c-0.6,0.8-1.6,1.2-2.5,1.2s-1.9-0.4-2.5-1.2C39.2,98.5,38.5,99.1,38.9,99.5z%22 style=%22fill:%23313949%3Btransform:translate(-35px,-90px)%3B%22/%3E%3C/svg%3E",ulGlobe:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2214px%22 height = %2214px%22%3E%3Cpath d = %22M270.1,81.2c3.3,0,6-2.7,6-6s-2.7-6-6-6s-6,2.7-6,6S266.7,81.2,270.1,81.2z%22 style=%22fill:none%3Bstroke:%23313949%3Bstroke-width:1.5%3Bstroke-linecap:round%3Bstroke-linejoin:round%3Btransform:translate(-263px,-68px)%3B%22/%3E%3Cpath d = %22M267.7,75.2c0,3.3,1.1,6,2.4,6s2.4-2.7,2.4-6s-1.1-6-2.4-6S267.7,71.9,267.7,75.2z%22 style=%22fill:none%3Bstroke:%23313949%3Bstroke-width:1.5%3Bstroke-linecap:round%3Bstroke-linejoin:round%3Btransform:translate(-263px,-68px)%3B%22/%3E%3Cpath d = %22M264.1,75.2h12%22 style=%22fill:none%3Bstroke:%23313949%3Bstroke-width:1.5%3Bstroke-linecap:round%3Bstroke-linejoin:round%3Btransform:translate(-263px,-68px)%3B%22/%3E%3C/svg%3E",ulDocument:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %229px%22 height = %2210px%22%3E%3Cpath d = %22M352.6,70.4c-0.1,0.1-0.1,0.2-0.1,0.3v6.9c0,0.2,0.2,0.4,0.4,0.4h7.3c0.2,0,0.4-0.2,0.4-0.4v-9.3 c0-0.2-0.2-0.4-0.4-0.4h-4.8c-0.1,0-0.2,0-0.3,0.1L352.6,70.4z M353.4,70.8l2.1-2.1v2.1H353.4z%22 style=%22fill:%23313949%3Btransform:translate(-352px,-68px)%3B%22/%3E%3C/svg%3E"}}.on("init"),tabpress:function(t,e,i){var a=this.data,o=a.ltPropListLevel,n=this,r=a.tabClass,s=function(t,e,i){var a=e.attr;e.details.tab;if(i){var o=$L(i).data("data");if(!o)return;var n=o.details.tab,r=o.attr;if(n)return r.tabLevel+1==a.tabLevel?i:s(t,e,i.previousElementSibling)}};a.selectedParagraph=t,this.toggleParaClass("random_class",void 0,function(t,i){var l,d=$L(t),c=d.data("data"),p=c.details,h=e?s(t,c,t.previousElementSibling):void 0,u=h?$L(h).data("data"):void 0,m=a["OL"==(u?u.details:p).tab.type?"ltPropOrderedList":"ltPropUnOrderedList"],f=c.attr,g=c.style,y=t.style,v="tabLevel",b="tabIndexValue",x=f[v],_=n.findIndex(n.getFirstWordInPara(t)),P="--tablevel",L="arr:"+_.paraIndex,w=c.classList,I=function(t,e){n.pushToQueue({operation:"styleSet",oldValue:t,newValue:e,prop:P,id:_.id,index:_,paragraph:!0});var i=n.dasherize(P);e?(g[P]=e,y.setProperty(i,e)):(delete g[P],y.removeProperty(i))},E=function(t,e){n.pushToQueue({operation:"properties",prop:L+".details."+t,id:_.id,oldValue:p[t],newValue:e}),e?p[t]=e:delete p[t]},C=function(t,e){n.pushToQueue({operation:"attribute",prop:L+".attr."+t,id:_.id,oldValue:f[t],newValue:e}),e?(f[t]=e,d.attr(t,e)):(delete f[t],d.removeAttr(t))},T=(u?u.attr:f)[b],N=T;if(e){if(u&&N++,0==--x)return w.splice(n.getIndex(w,r),1),d.removeClass(r),n.pushToQueue({operation:"class",prop:"removeClass",id:_.id,value:r,element:L}),[v,"ulvalue","tabValue",b].forEach((function(t){C(t)})),I(g[P]),E("tab"),n.tabCheck(t.parentNode),!1;--N<=0&&(N+=m.length)}else x=Math.min(x+1,o),N=(T||1)%m.length+1;l=n.extend(m[N-1]);var S=n.getBulltet(l);function k(e){C(b,N),l.order=n.getTabIndex(d,x),E("tab",l),e&&(S=n.getBulltet(l)),C("tabValue",S),I(g[P],x),C(v,x),n.tabCheck(t.parentNode)}return(parseInt(t.getAttribute("tablevel"))!=o||x<o)&&("custom"==l.name?(d.attr("tabValue",S),n.background_process(t,k,N-1,m,l)):k(!0)),!1}.bind(this))},tabCheck:function(t){for(var e=$L(t).data("list").slice(),i=[],a=0;a<e.length;a++){var o=e[a],n=$L(o).data("data"),r=0,s=n.attr,l=n.details,d=l.tab;if(d&&!i[a]){1!=l.order&&this.updateTabLevel(o,1);for(var c=a+1;c<e.length;c++){var p=e[c],h=$L(p).data("data"),u=h.attr,m=h.details.tab;if(!m)break;if(s.tabLevel!=u.tabLevel){if(s.tabLevel<u.tabLevel)continue;break}if(s.tabIndexValue!=u.tabIndexValue||d.type!=m.type)break;r++,this.updateTabLevel(p,d.order+r),i[c]=!0}}}},format_into_single_para:function(t){for(var e=t[0].data;t.length>1;){var i=t[1].data,a=i[0];a||i.push(a=this.emptyWordData()),a.text="\n"+a.text,e.push.apply(e,i),t.splice(1,1)}},check_list_style:function(t,e){var i,a=t.style.listStyleType||t.style.listStyle||t.getAttribute("list-style-type");return e.every((function(t){return a==t.conversionName&&(i=!0),!i})),i},formatUl:function(t,e){e=e||{level:1};var i,a,o=this.toArray(t.children),n=[],r=0,s=this.data,l=s.ltPropOrderedList,d=s.ltPropUnOrderedList,c=t.style.listStyleType||t.getAttribute("list-style-type"),p=e.level,h=this.check_list_style(t,l),u=this.check_list_style(t,d),m=s.ltPropParaStyle,f=this,g="inside"==t.style.listStylePosition,y=(m=s.ltPropParaStyle,g?function(t){var e=t.style||{};e.display=m.display||"",e.whiteSpace=""}.bind(this):void 0);if(h?i=l:u?i=d:c?(i=l,h=!0,c="decimal"):(/ul/i.test(t.tagName)?(i=d,u=!0,c="disc"):(i=l,u=!1,c="decimal"),h=!u),a=this.indexOf(i,c,p),e.tagName=u?"UL":"OL","UL"==t.tagName||"OL"==t.tagName){["margin-left","margin-right","margin-top","margin-bottom","margin","margin-inline"].forEach((function(e){"initial"==t.style[e]&&(t.style[e]="")}))}let v={},b=0;o.forEach((function(t,e){if(-1==["LI","OL","UL","BR"].indexOf(t.tagName)){let i=f.copyStylesToLi(t);v[e]=i}}));for(let t in v)o.splice(t+b,1,...v[t]),b=v[t].length;return o.forEach(function(o){var l;if(-1!=this.getIndex(["ul","ol"],this.getTagName(o)))l=this.formatHtml(this.toArray([o]),{level:e.level+1});else if("br"===this.getTagName(o))l=this.formatHtml(this.toArray([o]),{level:e.level+1});else{var d=this.toArray(o.childNodes);d.forEach(this.merge_style.bind(this,o)),y&&d.forEach(y),l=this.formatHtml(d,{level:e.level+1}),this.format_into_single_para(l),l.forEach(function(n){if(this.isImage(n)||this.isTable(n)||this.isHr(n)||n.details.tab)r=0;else{var l=e.level,d=this.extend(i[(a-1)%i.length]),p=n.attr,h=n.style,u=t.style,m=["padding-inline-start","list-style-type","list-style-position","list-style-image"];a>=0&&c&&(delete h.listStyleImage,delete h.whiteSpace),s.ltPropCustomListColor&&o.style.color&&(h["--lyte-texteditor-li-color"]=o.style.color),u.fontWeight&&this.checkReplaceStyle("fontWeight",u.fontWeight,h),u.fontStyle&&this.checkReplaceStyle("fontStyle",u.fontStyle,h),delete h.paddingInlineStart,(n.data||[]).forEach((function(t){let e=t.style;for(let r=0;r<u.length;r++){var i=u[r];if("text-decoration-line"===i)e.textDecoration=u.textDecoration;else{if(-1!=m.indexOf(i))continue;var a=f.camelCase(i),o=u[a],n=f.classFrmStyle(i+":"+o);n?f.pushIfNot(t.classList,n):f.checkReplaceStyle(a,o,e)}}})),p.tabLevel=l,h["--tablevel"]=l,p.tabIndexValue=a,n.details.tab=d,d.order=++r,p.tabValue=this.getBulltet(d),this.pushIfNot(n.classList,s.tabClass)}}.bind(this))}l.forEach(function(t){var e=t.style,i=o.style,a=i.length;e||(t.style=e={}),"LI"==o.tagName&&(t.data||[]).forEach((function(t){for(var o=0;o<a;o++){var n=f.camelCase(i[o]),r=f.data.ltPropReplaceStyle[n];r&&(n=r.name);var s=e[n];/padding(inline|left|right)|listStyle|whitespace|\-\-/i.test(n)||("textDecorationLine"==n?t.style.textDecoration=i[n]:s||(t.style[n]=i[n]))}}));for(var n=0;n<a;n++){var r,s=this.camelCase(i[n]),l=f.data.ltPropReplaceStyle[s],d=i[s];l&&(r=s,s=l.name,l.value==d?i[s]=l.replaceValue:i[s]=l.fallBackValue,delete i[r]),/padding(inline|left|right)|listStyle|whitespace|\-\-/i.test(s)||i[s]&&(e[s]=i[s])}}.bind(this)),Lyte.arrayUtils(n,"push",l)}.bind(this)),n},is_same_tab:function(t,e){var i=t.attr.tabLevel==e.attr.tabLevel;return i&&["type","name","lower"].every((function(a){return i=i&&t.details.tab[a]==e.details.tab[a]})),i},pushForIndent:function(t,e,i){for(;;){var a=t.get(0),o=t.next(),n=this.getIndex(e,a);if(-1!=n&&e.splice(n,1),this.pushIfNot(i,a),!o.hasClass("lyteEditorTab")||!this.is_same_tab(t.data("data"),o.data("data")))break;t=o}},tab_check_for_indent:function(t,e,i){var a=t.prev(),o=t.data("data");if(-1==this.getIndex(e,t.get(0)))if(a.hasClass("lyteEditorTab")){var n=a.data("data");this.is_same_tab(o,n)?this.pushIfNot(e,t.get(0)):this.pushForIndent(t,i,e)}else this.pushForIndent(t,e,i)},doTablevelUpdate:function(t,e){var i=this.get_element_from_opr(t.operations),a=this.get_name(e),o=this.do_parse(t.value);this.updateTabLevel(i,o[a])},updateTabLevel:function(t,e){var i=$L(t),a=i.data("data"),o=a.details.tab,n=o.order,r=a.attr;if(o.order=e,n!=e&&(r.tabValue=this.getBulltet(o),i.attr("tabvalue",r.tabValue),!this.isUndo())){var s=i.closest(".listHolderElement"),l=this.getIndex(s.data("list"),t);this.pushToQueue({operation:"tablevelUpdate",index:l,oldValue:n,newValue:e,id:s.data("randomId")})}},getTabIndex:function(t,e,i){var a=$L(t).closest(".listHolderElement").data("list"),o=this.getIndex(a,t),n=1,r=$L(a[o-1]).data("data"),s=$L(a[o+1]).data("data");return!r||r.attr.tabLevel!=e||i&&r.attr.tabIndexValue!=i?s&&s.attr.tabLevel==e&&(n=s.details.tab.order):n=r.details.tab.order+1,n},ordered:function(t){return this.list("number"==typeof t?t:void 0,this.data.ltPropOrderedList)},background_process:function(t,e,i,a,o){var n=this.data.listMapping[o.conversionName];if(n){var r='url("'+n+'")';a[i].customValue=o.customValue=r,e&&e()}else this.__background_process.apply(this,arguments)},__background_process:function(t,e,i,a,o){var n=this;window.requestAnimationFrame((function(){var r=window.getComputedStyle(t,":before"),s=r.backgroundImage,l=n.data.imageMapping,d=n.retrive_url(s);if(d){var c=l[d],p=function(){c.addEventListener("load",h)},h=function(){var t=a[i],s=t.customValue;if(s)o.customValue=s;else{var l=t.customValue||n.copy_image(c,r.backgroundPosition,parseFloat(r.width),parseFloat(r.height));t.customValue=o.customValue="url("+l+")"}e(),n.update_panel(),n.checkPlaceholder()};if(c)return c.complete?h():p();(c=l[d]=new Image).src=d,p()}else e()}))},copy_image:_lyteUiEditor.copy_image,retrive_url:function(t){var e=/url\(\"(.+)\"\)/;return e.test(t)?e.exec(t)[1]:""},tab_common_fn:function(t,e,i,a){var o,n=this,r=$L(i),s=r.data("data"),l=s.details,d=s.attr,c=s.classList,p=n.findIndex(n.getFirstWordInPara(i)),h=s.style,u=i.style,m="--tablevel",f="--lyte-texteditor-li-color",g="arr:"+p.paraIndex,y=function(t){n.pushToQueue({operation:"class",prop:"removeClass",id:p.id,value:t,element:"arr:"+p.paraIndex})},v=function(t,e){n.pushToQueue({operation:"styleSet",oldValue:t,newValue:e,prop:m,id:p.id,index:p,paragraph:!0});var i=n.dasherize(m);e?(h[m]=e,u.setProperty(i,e)):(delete h[m],u.removeProperty(i))},b=function(t,e,i){n.pushToQueue({operation:"properties",prop:g+".details."+t,id:p.id,oldValue:e,newValue:i}),i?l[t]=i:delete l[t]},x=function(t,e,i){n.pushToQueue({operation:"attribute",prop:g+".attr."+t,id:p.id,oldValue:e,newValue:i}),i?(d[t]=i,r.attr(t,i)):(delete d[t],r.removeAttr(t))};if(!a){var _=l.tab;if(!(t&&t[0].type!=_.type||null!=e&&e!=d.tabIndexValue)){if(["tabValue","ulvalue","tabIndexValue","tabLevel"].forEach((function(t){x(t,d[t],void 0)})),b("tab",l.tab),v(h[m],void 0),h[m="--lyte-texteditor-li-color"]&&v(h[m],void 0),m="--tablevel",null==t){var P=n.data.tabClass;y(P),r.removeClass(P),c.splice(n.getIndex(c,P),1)}return}e=e||d.tabIndexValue,o=!1}t=t||n.data.ltPropUnOrderedList;var L=((e||1)-1)%t.length,w=n.extend(t[L]),I="tabLevel",E="tabIndexValue",C="tabValue";w.order=n.getTabIndex(i,1);var T=n.getBulltet(w),N="lyteEditorBlockquote";function S(){if(x(I,d.tabLevel,d.tabLevel||1),x(E,d.tabIndexValue,((e||1)-1)%t.length+1),b("tab",l.tab,w),v(h[m],d.tabLevel),m=f,n.data.ltPropCustomListColor&&(i.style.color?v(h[m],i.style.color):(v(h[m="color"],n.data.ltPropWordStyle.color),v(h[m=f],n.data.ltPropWordStyle.color))),x(C,d.tabValue,T),n.data.ltPropHeaderTags.concat(n.extend(n.data.ltPropBlockquoteClasses,[N,"lyteBlockquoteFirst","lyteBlockquoteLast"])).forEach((function(t){var e=n.getIndex(c,t);-1!=e&&(c.splice(e,1),y(t),r.removeClass(t),n.removeHeaderContents(r,t),t==N&&n.blockquote_check(i.parentNode))})),0==o)return n.tabCheck(i.parentNode),o}return"custom"==w.name?(r.attr(C,T),w.customValue?S():(n.background_process(i,S,L,t,w),o)):S()},pushSameLevelList:function(t,e){var i,a,o=$L(t),n=o.data("data"),r=o.closest(".listHolderElement").data("list"),s=e.length;r.every(function(o){var r=$L(o).data("data");if(a=a||o==t,r.details.tab)i=!0,this.is_same_tab(n,r)&&this.pushIfNot(e,o);else if(i){if(a)return!1;i=!1,e.splice(s)}return!0}.bind(this))},updateNodeForList:function(t){},removeList:function(){if(!this.isUpdateIcon()){var t,e=this,i=e.data.selectedParagraph,a=e.data.tabClass,o=[];i.forEach((function(i){$L(i).hasClass(a)&&(t=!0,e.tab_common_fn(void 0,void 0,i,!1),e.pushIfNot(o,i.parentNode))})),o.forEach(e.tabCheck.bind(e)),t&&e.common_positioning(),e.updateNodeForList(),this.update_panel(),this.checkPlaceholder(),this.callFind()}},_list:function(t,e,i){var a,o=this.data,n=o.selectedParagraph;if(1==n.length){var r=$L(n[0]).data("data").details.tab;r&&r.type!=t[0].type&&(a=!0)}if(this.isUpdateIcon()){var s=this.toggleParaClass(o.tabClass),l=s.toApply;return{applied:this.reduceCrctList(t,s.applied,l,e),toApply:l}}a&&this.updateNodeForList(i);var d=o.tabClass;this.toggleParaClass(d,void 0,this.tab_common_fn.bind(this,t,e)),delete this._fakeSelectedPara,this.callFind()},list:function(t,e,i){return this._list(e&&e.constructor==Array?e:this.data.ltPropUnOrderedList,"number"==typeof t?t:void 0,i)},reduceCrctList:function(t,e,i,a){var o=t[0].type;return e.filter(function(t){var e=$L(t).data("data"),n=e.details.tab;if(n&&n.type==o&&(null==a||e.attr.tabIndexValue==a))return!0;i.push(t)}.bind(this))},removeTabProp:function(t,e,i,a){t.tab&&(delete t.tab,delete i.tabLevel,delete i.tabValue,delete e["--tablevel"],Lyte.arrayUtils(a,"removeAt",this.getIndex(a,this.data.tabClass)))},setup_custom_tab:function(t){var e=t.data("data"),i=e.details.tab;if("custom"==i.name){var a=t.get(0),o=this.data["ltProp"+("UL"==i.type?"Un":"")+"OrderedList"],n=e.attr.tabIndexValue-1;this.background_process(a,void 0,n,o,i)}}}),Lyte.Mixin.register("lyte-editor-language-navigation",{lang_init:function(){this.setData({navCheck:!0,renderFrame:!0})}.on("init"),lang_destroy:function(){delete this._navigation,delete this.__nav_data_added}.on("didDestroy"),setup_nav:function(t){var e=t.parentNode,i=this.convertToParaFormat(e),a=(i.data,this._navigation);if(this.isImage(i)||this.isHr(i))delete this.__nav_data_added;else{var o=this.render(i);a.innerHTML="",a.appendChild(o),this.__nav_data_added=t}},setup_focus:function(t,e,i,a,o){if(!this.__nav_data_added)return!0;this.__ignore_focusblur=!0;var n=window.getSelection(),r=document.createRange(),s=this.data,l=a||s.currentNode,d=null==o?s.cursor:o,c=this.findIndex(l).wordIndex,p=this._navigation,h=p.children[0],u=$L(h).data("list"),m=u[c],f=m.childNodes[0],g=l.style.unicodeBidi,y=document.activeElement,v=f;if(g&&/firefox/i.test(navigator.userAgent)&&(t={left:"right",right:"left"}[t]),f||m.appendChild(f=new Text("")),"left"==t&&d==c&&!d||"right"==t&&c==u.length-1&&d==f.nodeValue.length)return!0;if(p.focus(),n.removeAllRanges(),r.setStart(f,d),r.setEnd(f,d),n.addRange(r),a){var b=this.getBcr(l),x=this.getBcr(m),_=v?this.getBcr(r):x,P=this.rtlfunc("left"),L=this._maindiv,w=L.scrollTop,I=L.scrollLeft,E=this.getBcr(L),C=this.get_dir(l),T=_[P]-x[P]+(b[P]-E[P])+I,N=C&&!g||!C&&g,S={height:_.height,top:w+_.top-x.top+b.top-E.top,transform:""};return C?(N&&(S.transform="translateX(100%)"),S.right=T,S.left=""):(N&&(S.transform="translateX(-100%)"),S.left=T,S.right=""),delete this.__ignore_focusblur,this.$node.contains(y)?this.$node.focus(!0):y.focus(),S}return setTimeout(function(){var a=n.getRangeAt(0),o=a[("left"==t?"start":"end")+"Offset"],r=a.startContainer.parentNode;if(this.$node.focus(!0),delete this.__ignore_focusblur,"lyte-word"==this.getTagName(r)){var d=this.findIndex(r);this.commonSet(e,s.range,i,{node:$L(l.parentNode).data("list")[d.wordIndex],change:o})}}.bind(this),50),!1},cursor_pos:function(t,e){return this.setup_nav(t),!!this.__nav_data_added&&this.setup_focus(void 0,void 0,void 0,t,e)},m_width:function(t,e,i){for(var a=this.getFontFromStyle(i),o=(parseFloat(i.fontSize),this._iframe.contentDocument.body),n=t.length,r="",s=null==e,l=s?n:0;l<=n;l++)r+="<span style='font:"+a+"'>"+t.slice(0,l)+"</span>";o.innerHTML=r;var d=Array.from(o.children),c=0,p=0,h=0;return s&&(e=1/0),d.every((function(t,i){var a=t.offsetWidth;if(e+4>=a)p=i,h=a;else if(++c>3)return!1;return!0})),o.innerHTML="",{cursor:s?n:p,width:h}}}),Lyte.Mixin.register("lyte-editor-resize",{resize_mousemove:function(t){if(/touch/.test(t.type)){var e=t.touches;if(e.length>1)return;t.preventDefault(),t=e[0]}var i=function(e){return t[e]-this["_"+e]}.bind(this),a=this.data.ltPropResize,o=a.horizontal?i("clientX")*(_lyteUiUtils.getRTL()?-1:1):0,n=a.vertical?i("clientY"):0,r=this._width+o,s=this._height+n,l=this.data,d=l.range;this.getMethods("onEditorResize")&&this.executeMethod("onEditorResize"),n&&(this.__editor_manually_resized=!0),this._width=r=Math.min(Math.max(r,this._minwidth,0),this._maxwidth),this._height=s=Math.min(Math.max(s,this._minheight),this._maxheight),$L(this.$node).css({width:r,height:s}),this._clientX=t.clientX,this._clientY=t.clientY,d.isRange?this.setRange():this.setCursor(l.currentNode,l.cursor),this.callFind()},resize_mouseup:function(t){var e="mousemove",i="mouseup",a=document,o="removeEventListener";/touch/.test(t.type)&&(e="touchmove",i="touchend"),a[o](e,this._mm,!0),a[o](i,this._mu,!0),["_mm","_mu","_width","_height","_minwidth","_minheight","_maxwidth","_maxheight","_clientX","_clientY"].forEach(function(t){delete this[t]}.bind(this)),$L(this.$node).removeClass("lyteEditorResizeSelect"),this.execute("onEditorResizeEnd",this.$node)},actions:{resize_mousedown:function(t){var e,i=t,a="mousemove",o="mouseup",n=document,r="addEventListener",s=window.getComputedStyle(this.$node),l=function(t,e){var i=parseFloat(s[t]);return isNaN(i)?e:i};if(this.getMethods("onEditorResizeStart")&&(e=this.executeMethod("onEditorResizeStart",this.$node)),!1!==e){if(this._width=l("width"),this._height=l("height"),this._minwidth=l("minWidth",0),this._maxwidth=l("maxWidth",1/0),this._minheight=l("minHeight",0),this._maxheight=l("maxHeight",1/0),this._clientX=i.clientX,this._clientY=i.clientY,/touch/.test(t.type)){var d=t.touches;if(d.length>1)return;i=d[0],a="touchmove",o="touchend"}this._mm=this.resize_mousemove.bind(this),this._mu=this.resize_mouseup.bind(this),n[r](a,this._mm,!0),n[r](o,this._mu,!0),$L(this.$node).addClass("lyteEditorResizeSelect"),t.preventDefault()}}}}),Lyte.Mixin.register("lyte-editor-mention",{callTrigger:function(t,e,i){var a="onTrigger";if(e){if(this.getMethods(a)){var o=this.data,n=this.executeMethod(a,t,this.$node,i),r=function(t){if(0!=n){var i="triggersArray";this.setData(i+"Final",t||[]),this.setData(i,o.triggersArrayFinal.slice(0,20)),this.showdropdown(e,this.$node)}else this.closedropdown()}.bind(this);o.searchValue=t,n&&n.then?n.then((function(t){r(t)}),this.closedropdown.bind(this)):r(n)}}else this.closedropdown()},closedropdown:function(t){if(!this._click)return;let e=t?$L(t.target).closest("lyte-editor-mention-item"):null;if(!e||!e.hasClass("lyteMentionsSubMenuContainer")){var i=this._mentiondrop,a="removeEventListener";document[a]("click",this._click,!0),window[a]("scroll",this._scroll,!0),delete this._click,delete this._scroll,i&&($L(i).addClass("lyteEditorHide").css({left:"",top:"",right:"",bottom:""}),$L(this.$node).removeClass("lyteEditorMentionOpen"),delete this._mentionopen,this.throwEvent("onMentionClose",i,this.$node)),this._mentionsSubMenuDrop&&this._mentionsSubMenuDrop.component.setData("ltPropShow",!1)}},scrollclose:function(t){this._mentiondrop.contains(t.target)||this.closedropdown()},showdropdown:function(t,e){var i=this._mentiondrop,a=$L(i).removeClass("lyteEditorHide"),o=window;$L.fastdom.measure((function(){var n=this.getBcr(i),r=this.getBcr(e),s=o.pageXOffset,l=o.pageYOffset,d=t.left+r.left,c=t.top+t.height+r.top,p=(o.innerWidth,o.innerHeigt),h={left:d+s,top:c+l,bottom:""};c+n.height>p&&(c-t.height>p-c?h.bottom=c-t.height+l:h.top=l+c),$L.fastdom.mutate((function(){if(a.css(h).data("editor",e),!this._click){this._click=this.closedropdown.bind(this),this._scroll=this.scrollclose.bind(this);var t="lyteEditorMentionSelection",i="addEventListener";document[i]("click",this._click,!0),o[i]("scroll",this._scroll,!0),$L(this.$node).addClass("lyteEditorMentionOpen"),this._mentionopen=!0,this.throwEvent("onMentionOpen",this._mentiondrop,this.$node),0==a.children("."+t).length&&a.children().eq(0).addClass(t)}}),this)}),this)},checkTrigger:function(){var t=this.data,e=t.ltPropTriggerCharacter,i=this.__evt,a="__final_evt";e&&(this[a]=this[a]||i,clearTimeout(this.__triggerdelay),this.__triggerdelay=setTimeout(function(){var i=t.currentNode,o=t.cursor,n=this.getWordText(i).slice(0,o),r=n.lastIndexOf(e),s=[];-1!=r&&s.push(n.slice(r+1),this.findCursorPos(i,r)),s.push(this[a]||{}),this.callTrigger.apply(this,s),delete this[a]}.bind(this),t.ltPropTriggerDelay))},mentionsClick:function(t,e,i){var a=this.data,o=t.module;this.data.ltPropMentionsSubMenu&&t.group?this.setData("mentionsGroup",t.group):(this.removeLetters(a.searchValue.length+1),this.$node.insertHTML("@["+_lyteUiEditor.escapeText(t.name)+":"+t.id+(o?":"+o:"")+"]<span> </span>",!0),this.throwEvent("onMentionSelect",t,e,i,this.$node),this.setCursor(a.currentNode,a.cursor),this.$node.focus())},mentionsKeydown:function(t){var e=t.which||t.keyCode,i="lyteEditorMentionSelection",a=this._mentiondrop,o=$L("."+i,a);if(o.length||(o=$L(a.children[0]).addClass(i)),/^(38|40)$/.test(e)){var n=o[38==e?"prev":"next"]();n.length&&(n.addClass(i),o.removeClass(i),n.get(0).scrollIntoView())}else 13==e&&o.click();if(/^(38|40|13)$/.test(e))return t.preventDefault(),!0},mention_scroll:function(){var t=this._mentiondrop,e=t.scrollTop,i=t.offsetHeight,a=t.scrollHeight,o=this.data,n=o.triggersArray,r=o.triggersArrayFinal;if(a==i+e){var s=n.length;if(r.length==n.length)return;Lyte.arrayUtils(n,"push",r.slice(s,s+20))}},getMentions:function(){return Array.from(this.$node.getElementsByClassName("lyteEditorMentionWord")).map((function(t){var e=$L(t).data("data"),i=e.details;return{id:i.id,text:e.text,module:i.module}}))},setup_mention:function(){this._mentiondrop=$L(this.$node).children(".lyteEditorMentionDropbox").get(0),Lyte.Component.appendChild(document.body,this._mentiondrop),this.data.ltPropMentionsSubMenu&&(this._mentionsSubMenuDrop=$L(this.$node).children(".lyteEditorMentionsSubMenu").get(0))},mention_clear:function(){var t="_mentiondrop",e=this[t];e&&(e.remove(),delete this[t],this.closedropdown()),clearTimeout(this.__triggerdelay)}.on("didDestroy"),actions:{itemClick:function(t,e,i){this.mentionsClick(t,e,i)},mouseenter:function(t,e){var i="lyteEditorMentionSelection";$L("."+i,this._mentiondrop).removeClass(i),this.data.ltPropMentionsSubMenu&&$L("."+i,this._mentionsSubMenuDrop.component.childComp).removeClass(i),$L(e).addClass(i)},scroll:function(){this.mention_scroll()}},mention_update:function(t,e,i,a,o){if("mention"==(t.details||{}).type){e.removeClass("lyteEditorMentionWord");var n=this.getMentionData(t,i);this.removeMention(t),this.pushToQueue({operation:"mention",oldValue:n,id:a,index:o.paraIndex,wordIndex:o.wordIndex})}},getMentionData:function(t,e){return{name:e,id:t.details.id,module:t.details.module}},removeMention:function(t){var e=t.classList,i=this.getIndex(e,"lyteEditorMentionWord");-1!=i&&(e.splice(i,1),t.details={})},doAddMention:function(t){var e=this.get_element_from_opr(t.operations),i=this.do_parse(t.value),a=$L(e).addClass("lyteEditorMentionWord").data("data");this.pushIfNot(a.classList,"lyteEditorMentionWord"),a.details={type:"mention",id:i.id,module:i.module||""}},doRemoveMention:function(t){var e=this.get_element_from_opr(t.operations),i=$L(e).removeClass("lyteEditorMentionWord").data("data");this.removeMention(i)},mention_prop:function(t,e){t.classList.push("lyteEditorMentionWord"),this.data.ltPropMentionsBgEditable&&(t.style.backgroundColor=this.data.ltPropMentionsBg),this.data.ltPropMentionsEditable||(t.attr?t.attr.editable="false":t.attr={editable:"false"}),t.details={type:"mention",id:e.id,module:e.getAttribute("module")}},filteroutMention:function(t){return t.replace(/<span([^>]+)>@\[([^<]+?):([^<]+?):(.{0,}?)\]<\/span>/g,(function(t,e,i,a,o){return'<mention_div id = "'+a+'" module="'+o+'"'+e.replace(/id=\w+\s?/,"")+">"+i+"</mention_div>"})).replace(/<span([^>]+)>@\[([^<]+?):([^<]+?)\]<\/span>/g,(function(t,e,i,a){return'<mention_div id = "'+a+'"'+e.replace(/id=\w+\s?/,"")+">"+i+"</mention_div>"})).replace(/@\[(.+?):(.+?):(.{0,}?)\]/g,(function(t,e,i,a){return'<mention_div id = "'+i+'" module = "'+a+'">'+e+"</mention_div>"})).replace(/@\[(.+?):(.+?)\]/g,(function(t,e,i){return'<mention_div id = "'+i+'">'+e+"</mention_div>"}))}}),Lyte.Mixin.register("lyte-editor-table",{doCellInsert:function(t){var e=t.operations,i=e.split("."),a=i.pop(),o=this.get_element_from_opr(i.join(".")),n=this.get_number(a),r=this.get_data_from_opr(e),s=this.do_parse(t.value),l=this.render(s),d=function(t,e){t.splice(n,0,e)},c=$L(o).data("list"),p=c[n],h=Lyte.Component;this.update_count(_lyteUiEditor.limitFilter(l,1/0,!0).length),p?h.insertBefore(p,l):h.appendChild(o,l),d(r.data,s),d(c,l)},doCellDelete:function(t){this.doRowDelete(t)},doSpanSet:function(t,e){var i=t.operations,a=this.get_element_from_opr(i),o=this.get_data_from_opr(i),n=this.get_name(e),r=this.do_parse(t.value)[n];a[o.value]=o.data[o.value]=r},doRowCreate:function(t){var e=t.operations.split("."),i=e.pop(),a=this.get_element_from_opr(e.join(".")),o=this.get_number(i),n=this.createRow($L(a.parentNode),o,this.do_parse(t.value));this.update_count(_lyteUiEditor.limitFilter(n,1/0,!0).length)},table_init:function(){var t=this.data,e=t.tableMenu;e&&t.ltPropTableHandling&&e.push.apply(e,[{options:[{display:"Insert row above",purpose:"insertRowAbove",class:"lyteEditorInsertRowAbove"},{display:"Insert row below",class:"lyteEditorInsertRowBelow",purpose:"insertRowBelow"},{display:"Insert column to left",class:"lyteEditorInsertColumnLeft",purpose:"insertColumnLeft"},{display:"Insert column to right",class:"lyteEditorInsertColumnRight",purpose:"insertColumnRight"}]},{options:[{display:"Delete row",class:"lyteEditorRemoveRow",purpose:"removeRow"},{display:"Delete column",class:"lyteEditorRemoveColumn",purpose:"removeColumn"},{display:"Delete table",class:"lyteEditorDeleteTable",purpose:"deleteTable"}]},{options:[{display:"split cell",class:"lyteEditorSplitCells",purpose:"splitCells"}]},{options:[{display:"Merge cells",class:"lyteEditorMergeCells",purpose:"mergeCells"}]},{options:[{display:"Select Cell",class:"lyteEditorSelectCell",purpose:"selectCell"},{display:"Select table",class:"lyteEditorSelectTable",purpose:"selectTable",arg:"target"}]}])}.on("init"),check_disable:function(t){var e,i,a,o=this.data.tableMenu,n=Lyte.objectUtils,r=this.data.range.isRange,s=t?this.getTagName(t):"",l=this.getTag("th"),d=this.getTag("table"),c=this.data.topLevelElement,p=this.data.selectedWords,h=[],u=function(){var e=t.parentNode,i=!0;return p.every((function(t){var a=t.node;return i=e.contains(a)})),!i}.bind(this),m=function(){var e=function(t){return this.getIndex(Array.from(t.parentNode.children),t)}.bind(this),i=e(t),a=$L(t.closest(d)),o=(Array.from(a.children().children()).map((function(t){return t.children[i]})),!0),n=l+","+this.getTag("td");return p.every((function(t){var a=t.node.closest(n);return o=a&&e(a)==i})),!o}.bind(this);return o.forEach((function(o){var d=0,p=o.options;p.forEach((function(a){var o,p,h;switch(a.purpose){case"insertRowAbove":case"insertRowBelow":case"removeRow":s?(o=l==s,null==e?(!o&&r&&(o=u()),e=o):o=e):o=!1;break;case"insertColumnLeft":case"insertColumnRight":case"removeColumn":o=!(!s||!r)&&(null==i?i=m():i);break;case"splitCells":o=s&&r&&c!=t;break;case"mergeCells":o=s&&(r&&c==t||!r);break;case"deleteTable":case"selectCell":case"selectTable":o=!1}null!=o&&(h=_lyteUiUtils.capitalize(a.purpose),p=o?"lyteEditor"+h+" lyteEditorMenuDisabled":"lyteEditor"+h,t||(p+=" lyteEditorHide",d++),n(a,"add","class",p),n(a,"add","disabled",(o||!1).toString()))})),n(o,"add","class",d==p.length?(h.push(o),"lyteEditorHide"):(a=o,""))})),a&&n(a,"add","class",(a.class+" lyteEditorOptionLast").trim()),h},methods:{beforeTableOpen:function(t,e){var i=this.$node.contains(t);if(i){if(this.call_menu_before_open(e))return!1;var a=e.target.closest(this.getTag("th")+","+this.getTag("td"));(this.__cell=a)&&this.check_range_reset(a),i=this.before_menu_open(t,e,this.check_disable(a))}return i},tableSelect:function(t){var e,i,a=t,o=[],n=this.__cell,r=function(){return n.closest(this.getTag("table"))}.bind(this);switch(t){case"insertRowAbove":a="insertRow",o.push("before"),i=!0;break;case"insertRowBelow":a="insertRow",i=!0;break;case"removeRow":i=!0;break;case"insertColumnLeft":a="insertColumn",o.push("before"),e=!0;break;case"insertColumnRight":a="insertColumn",e=!0;break;case"removeColumn":e=!0;break;case"selectCell":o.push(n);break;case"selectTable":o.push({target:r()});break;case"deleteTable":o.push(r());break;case"mergeCells":a="mergeCells";break;case"splitCells":a="splitCells";break;default:a="table_menu_select",o.push(t)}i&&(e=this.getTag("th")!=this.getTagName(n)),e&&(this.data.topLevelElement=n),this[a].apply(this,o),delete this.__cell,this.$node.focus()}},copyFromTable:function(t,e){for(var i=this.data.ltPropTags,a=($L(t).closest(i.table).get(0),t.parentNode),o=e.parentNode,n=this.toArray($L(o).closest(this.getTag("table")).children().children()),r=this.getIndex(n,a),s=this.getIndex(n,o),l=this.getIndex(this.toArray(a.children),t),d=this.getIndex(this.toArray(o.children),e),c=[],p=Math.min(r,s),h=Math.max(r+t.rowSpan-1,s+e.rowSpan-1),u=Math.min(l,d),m=Math.max(l+t.colSpan-1,d+e.colSpan-1),f=function(t){let e=this.copyInSameWord(t,0);null!=e&&Lyte.arrayUtils(c,"push",e)}.bind(this),g=function(t){$L(t).data("list").forEach(f)},y=p;y<=h;y++)if(!n[y].parentElement.classList.contains("lyteEditorNoHeadTable"))for(var v=u;v<=m;v++){var b=$L(n[y]).data("list")[v];$L(b).data("list").forEach(g)}return c},changeToTopLevelForTable:function(t){for(var e=0;e<t.length;e++)for(var i=t[e],a=e+1;a<t.length;a++){var o=t[a];if(i.contains(o))t.splice(a,1),a--;else if(o.contains(i)){t.splice(e,1),e--;break}}return t},table:function(t,e,i){t=t||i.row||2,e=e||i.column||2,this.splitPara();var a,o=this.data.currentNode,n=this.findIndex(o),r=this.emptyParaData(),s=o.parentNode,l=(i||{}).width||"",d=this.getBcr(s,"width"),c=/%/i.test(l)?parseFloat(l)*d/100:l||d,p=this.emptyTable(t,e,c),h=r.data[0];if(h.data=[p],h.details.type="table",i){var u=p.style,m=i.alignment,f={},g="",y=_lyteUiUtils.getRTL(),v={height:i.height,borderWidth:i.borderWidth+"px"},b=r.style;switch(m){case"left":g=y?"auto 0px":"0px auto",b.float="left";break;case"right":g=y?"0px auto":"auto 0px",b.float="right";break;case"center":g="auto"}f.marginInline=g,this.extend(f,u),p.data.forEach(function(t){t.data.forEach(function(t){t.data.forEach(function(t){this.extend(v,t.style)}.bind(this))}.bind(this))}.bind(this))}this.pushParagraph(a=this.render(r),$L(s).closest(".listHolderElement"),n.paraIndex);var x=this.getFirstWordInPara(a),_=this.getWordText(x).length;this.setData("currentNode",x),this.setCursor(x,_),this.$node.focus(),this.updateRangeNode()},emptyTable:function(t,e,i){var a=this.data;return{data:[this.thead(1,e,i),this.tbody(t,e)],style:this.extend(this.extend(a.ltPropTableStyle),{width:i+"px"}),details:{resize:a.ltPropTableResize,arguments:{boundary:"lyte-texteditor",component:"table",directions:[],preventTable:!0,tags:{table:this.getTag("table"),thead:this.getTag("thead"),tbody:this.getTag("tbody"),tr:this.getTag("tr"),th:this.getTag("th"),td:this.getTag("td")}}},tag:this.getTag("table")}},thead:function(t,e,i){return{data:[this.tr(e,"th",i)],style:{},details:{},tag:this.getTag("thead")}},alignTable:function(t){let e=this.data.currentNode,i=this.findIndex(e),a=$L(this.$node).find("#"+i.id).get(0);if(-1!=["TH","TD"].indexOf(a.tagName)){let e=$L(a).closest("table").get(0),i=$L(e).closest("lyte-paragraph").get(0);if(i.style.float==t)return{applied:[1],toApply:[]};if(this.isUpdateIcon())return;this.setStyle(i,"float",t),this.setStyle(i,"zIndex","10"),this.update_panel()}},tbody:function(t,e,i){for(var a=[],o=0;o<t;o++)a.push(this.tr(e,"td",i));return{data:a,style:{},details:{},tag:this.getTag("tbody")}},tr:function(t,e,i){for(var a=[],o=0;o<t;o++)a.push(this.cell(e,i/t));return{data:a,style:{},details:{},tag:this.getTag("tr")}},cell:function(t,e){return{data:[this.emptyParaData()],style:this.extend(this.extend(this.data.ltPropTdStyle),{width:e?e+"px":""}),details:{rowSpan:1,colSpan:1},tag:this.getTag(t),randomId:this.randomId()}},tableselect:function(t){$L(t).addClass("lyteEditorTableSelected")},tableRelease:function(t,e){$L(e).removeClass("lyteEditorTableSelected");var i=$L(t).data("directions"),a=this.toArray(t.parentNode.children);if(i.width){var o=this.getIndex(a,t);this.toArray($L(e).children().children()).forEach((function(t){var e=$L(t.children[o]);e.attr("style","").css(e.data("data").style)}))}else a.forEach((function(t){(t=$L(t)).attr("style","").css(t.data("data").style)})),(e=$L(e)).attr("style","").css(e.data("data").style)},tabledrop:function(t,e){$L(e).removeClass("lyteEditorTableSelected");var i=$L(t).data("directions"),a=this.data;if(i.width){this.updateRangeNode();var o=t.nextElementSibling;this.setStyle(t,"width",t.style.width),this.setStyle(o,"width",o.style.width)}else this.heightAdjust(t),this.setStyle(e,"height",e.style.height);a.range.isRange?this.setRange():this.setCursor(a.currentNode,a.cursor)},heightAdjust:function(t){var e=this.toArray(t.parentNode.children);this.updateRangeNode(),e.forEach(function(t){this.setStyle(t,"height",t.style.height)}.bind(this))},navigateInTable:function(t,e){var i;(i=e?this.getPrevious(t):this.getNext(t,!0))&&this.navigateTo(i)},navigateTo:function(t){var e=this.data,i=e.range,a=$L(t).data("list"),o=this.getFirstWordInPara(this.first(a)),n=this.getLastWordInPara(this.last(a)),r=this.getWordText(n).length;this.setData("currentNode",n),this.setData("cursor",r),o==n&&0==r?(i.isRange=!1,this.setCursor(e.currentNode,e.cursor),this.resetOverlay(!0)):(i.startNode=o,i.endNode=n,i.left=0,i.right=r,i.isRange=!0,this.setRange())},getPrevious:function(t){var e=t.parentNode,i=this.toArray(e.children),a=$L(t).closest(this.getTag("table")),o=this.getIndex(i,t),n=this.toArray(a.children().children()),r=this.getIndex(n,e),s=i[o-1];if(0==o){if(0==r)return;s=this.last(n[r-1].children)}return"none"==s.style.display?this.getPrevious(s):s},getNext:function(t,e){var i=t.parentNode,a=this.toArray(i.children),o=$L(t).closest(this.getTag("table")),n=this.getIndex(a,t),r=this.toArray(o.children().children()),s=this.getIndex(r,i),l=a[n+1],d=r.length,c=a.length;return n==c-1&&(s==d-1?l=this.createNewrow(o,d-1,c):e&&(l=this.first(r[s+1].children))),"none"==l.style.display?this.getNext(l,e):l},createNewrow:function(t,e,i){var a=this.getBcr(t.closest(this.getTag("paragraph")).get(0),"width"),o=this.getTag("td"),n=this.tr(i,o,a),r=$L($L($L(t.data("data").data).get(-1).data).get(-1).data).get(-1).style.borderWidth;return n.data.forEach(function(t){t.style.borderWidth=r}.bind(this)),this.createRow(t,e,n)},createRow:function(t,e,i){var a=this.render(i),o=t.find(this.getTag("tbody")).eq(0),n=o.data("data").data,r=o.children(),s=r.get(e),l=Lyte.arrayUtils,d=Lyte.Component,c=a.children[0];if(l(o.data("list"),"insertAt",e,a),l(n,"insertAt",e,i),s?d.insertBefore(s,a):d.insertAfter(r.get(-1),a),!this.isUndo()){var p=t.parent(),h=p.closest(this.getTag("paragraph")).parent(),u=this.findIndex(p.get(0));this.updateRangeNode(),this.pushToQueue({operation:"rowCreate",data:i,index:u.paraIndex,lineIndex:u.lineIndex,wordIndex:u.wordIndex,id:h.data("randomId"),rowIndex:e}),this.updateNodeValue(this.getFirstWordInPara(this.first($L(c).data("list"))))}return c},processDeleteRow:function(t,e){var i=t.find(this.getTag("tbody")),a=i.data("data").data,o=this.toArray(t.children().children()),n=o[e+1];if(o[e]&&(this.emptyRow(n),this.update_count(-_lyteUiEditor.limitFilter(n,1/0,!0,!0).length),n.remove(),Lyte.arrayUtils(a,"removeAt",e),Lyte.arrayUtils(i.data("list"),"removeAt",e),!this.isUndo())){var r=t.parent(),s=r.closest(this.getTag("paragraph")).parent(),l=this.findIndex(r.get(0));this.pushToQueue({operation:"rowDelete",data:$L(n).data("data"),index:l.paraIndex,lineIndex:l.lineIndex,wordIndex:l.wordIndex,id:s.data("randomId"),rowIndex:e})}},mergeCells:function(){var t=this.data,e=t.range,i=t.topLevelElement;if(e.isRange&&!i){var a=t.selectedParagraph,o=".listHolderElement",n=$L(this.first(a)).closest(o).get(0),r=$L(this.last(a)).closest(o).get(0);n!=r&&n&&r&&-1==this.getIndex([this.getTagName(n),this.getTagName(r)],this.getTag("th"))&&this.mergeTwoCells(n,r)}},spanSet:function(t,e,i){var a=$L(t),o=a.data("data").details,n=o[e];t[e]=o[e]=i,this.isUndo()||this.pushToQueue({operation:"spanSet",oldValue:n,newValue:i,property:e,id:a.data("randomId")})},mergeTwoCells:function(t,e){var i,a,o=t.parentNode,n=e.parentNode,r=this.getIndex(this.toArray(o.children),t),s=this.getIndex(this.toArray(n.children),e),l=this.toArray($L(n).closest(this.getTag("tbody")).get(0).children),d=this.getIndex(l,o),c=this.getIndex(l,n),p=$L(t).data("data").details,h=function(e){this.pushParagraph(this.render(e),t)}.bind(this);this.updateRangeNode();for(var u=d;u<=c;u++)for(var m=l[u],f=r;f<=s;f++){var g=m.children[f];if(g!=t&&"none"!=g.style.display){var y=$L(g).data("data").data;this.extend(y,[]).forEach(h),this.emptyCell(g),this.setStyle(g,"display","none"),u==d?this.spanSet(t,"colSpan",p.colSpan+g.colSpan):f==r&&this.spanSet(t,"rowSpan",p.rowSpan+g.rowSpan)}}this.resetRange(!0),this.setData("currentNode",i=this.getLastWordInPara(this.last(t.children))),this.setData("cursor",a=this.getWordText(i).length),this.setCursor(i,a),this.updateRangeNode()},emptyRow:function(t){this.toArray(t.children).forEach(function(t){this.emptyCell(t)}.bind(this))},emptyFullTable:function(t){var e=t.children[0];this.emptyBody(e),this.emptyBody(e)},emptyBody:function(t){this.toArray(t.children).forEach(function(t){this.emptyRow(t)}.bind(this))},emptyCell:function(t){for(var e=$L(t).data("list"),i=e.length,a=0;a<i;a++){var o=e[a];1==i&&this.pushParagraph(this.render(this.emptyParaData()),$L(o).closest(".listHolderElement"),0),this.removePara(o),1!=i&&(i--,a--)}},splitCells:function(){var t=this.data,e=t.range,i=t.topLevelElement;i&&!e.isRange&&this.getTagName(i)==this.getTag("td")&&(this.updateRangeNode(),this.processSplit(i))},processSplit:function(t){var e,i,a=t.rowSpan-1,o=t.colSpan-1,n=t.parentNode,r=this.toArray(n.parentNode.children),s=[];if(0==a&&0==o)return this.insertSplit(t),!0;e=this.getIndex($L(n).data("list"),t),i=this.getIndex(r,n);for(var l=0;l<=a;l++)for(var d=r[i+l].children,c=0;c<=o;c++)if(0!=l||0!=c){var p=d[c+e];s.push(p),this.setStyle(p,"display","")}a&&this.spanSet(t,"rowSpan",1),o&&this.spanSet(t,"colSpan",1),this.updateRangeNode();var h=this.last(s),u=this.data,m=u.currentNode;h&&(this.setData("currentNode",m=this.getLastWordInPara(this.last($L(h).data("list")))),this.setData("cursor",this.getWordText(m).length)),this.setCursor(m,u.cursor)},insertSplit:function(t){var e,i,a=t.parentNode,o=this.toArray(a.children),n=this.getIndex(o,t),r=$L(t).closest("table"),s=this.toArray(r.children().children()),l=this.getBcr(s[0].children[n],"width")/2,d=[];s.forEach(function(t,e){var i,o=this.cell(0==e?this.getTag("th"):this.getTag("td"),0==e?l:void 0),r=t.children[n];(t!=a&&0!=e&&(o.style.display="none"),"none"==r.style.display)&&(r=(i=this.originCell(r)).isSame?i.cell:void 0);r&&0!=e&&t!=a&&this.spanSet(r,"colSpan",r.colSpan+1),d.push(o)}.bind(this)),this.setStyle(s[0].children[n],"width",l+"px"),this.insertColumnAt(r,d,n+1),this.resetRange(!0),e=this.getLastWordInPara(this.last($L(this.last(a).children[n+1]).data("list"))),this.setData("currentNode",e),this.setData("cursor",i=this.getWordText(e).length),this.updateRangeNode(),this.$node.focus(),this.setCursor(e,i)},insertColumnAt:function(t,e,i){var a=this.toArray(t.children().children()),o=Lyte.arrayUtils,n=Lyte.Component;if(a.forEach(function(t,a){var r=$L(t),s=r.children().get(i),l=r.data("data"),d=r.data("list"),c=this.render(e[a]);o(l.data,"insertAt",i,e[a]),o(d,"insertAt",i,c),s?n.insertBefore(s,c):n.appendChild(t,c)}.bind(this)),!this.isUndo()){var r=t.closest(this.getTag("word")),s=this.findIndex(r.get(0));this.pushToQueue({operation:"cellInsert",id:r.closest(".listHolderElement",this.$node).data("randomId"),index:s.paraIndex,wordIndex:s.wordIndex,data:e,cellIndex:i})}},deleteColumnAt:function(t,e){var i=this.toArray(t.children().children()),a=[],o=Lyte.arrayUtils;if(i.forEach(function(t){var i=$L(t),n=i.children().get(e),r=i.data("data"),s=i.data("list");a.push(r.data[e]),o(r.data,"removeAt",e),o(s,"removeAt",e),this.update_count(-_lyteUiEditor.limitFilter(n,1/0,!0,!0).length),n.remove()}.bind(this)),!this.isUndo()){var n=t.closest(this.getTag("word")),r=this.findIndex(n.get(0));this.pushToQueue({operation:"cellDelete",id:n.closest(".listHolderElement",this.$node).data("randomId"),index:r.paraIndex,wordIndex:r.wordIndex,cellIndex:e,data:a})}},selectTable:function(t){var e=t.target,i=$L(e).closest(this.getTag("word")).get(0),a=(i.parentNode,this.data.range),o=Lyte.objectUtils;this.resetRange(!0),a.isRange=!0,o(a,"add","startNode",i),o(a,"add","left",0),o(a,"add","endNode",i),o(a,"add","right",0),this.setData("currentNode",a.startNode),this.setData("cursor",0),this.setRange(),this.$node.focus()},tableCopy:function(t){var e=this.first(t).parentNode,i=this.last(t).parentNode,a=e.parentNode,o=i.parentNode,n=$L(a).closest(this.getTag("table")),r=this.toArray(n.find(this.getTag("tbody")).children()),s=this.toArray(a.children),l=this.toArray(o.children),d=this.getIndex(s,e),c=this.getIndex(l,i),p=Math.max(0,this.getIndex(r,a)),h=Math.max(0,this.getIndex(r,o));n=this.extend(n.data("data"));return this.spliceCells(n.data[0].data[0].data,d,c),this.spliceCells(n.data[1].data,p,h),n.data[1].data.forEach(function(t){this.spliceCells(t.data,d,c)}.bind(this)),_lyteUiEditor.tableBckConversion({data:[n]})},spliceCells:function(t,e,i){t.splice(i+1),t.splice(0,e)},formatTable:function(t){var e=this.emptyTable(),i=this.toArray(t.children),a=[],o=e.style;if(this.getInlineStyle(t,e,!0),o.margin=0,o.width=o.width||"100%",e.data.splice(0,2),i.forEach(function(t){var i=this.getTagName(t);"colgroup"!=i?!/caption/i.test(i)&&t.children.length&&e.data.push(this["format"+i](t)):this.toArray(t.children).forEach(function(t){var e=t.getAttribute("width");null!=e?e+="px":e=t.style.width,a.push(e)}.bind(this))}.bind(this)),1==e.data.length){var n=e.data[0].data[0].data.length,r=this.thead(1,n);r.data[0].data.forEach((function(t,e){t.style.width=a[e]||100/n+"%"})),e.data.splice(0,0,r),(r.classList=r.classList||[]).push("lyteEditorNoHeadTable")}return e},formatthead:function(t){var e=this.thead();return this.getInlineStyle(t,e,!0),e.data=[this.formattr(t.children[0],this.getTag("th"))],e},formattbody:function(t){var e=this.tbody(),i=this.toArray(t.children),a=[];return this.getInlineStyle(t,e,!0),i.forEach(function(t,i){var o=[];a[i]=o,e.data.push(this.formattr(t,this.getTag("td"),o))}.bind(this)),this.pushExtraDataForRowSpan(e.data,a),e},pushExtraDataForRowSpan:function(t,e){var i=this;e.reverse().forEach((function(a,o){a.reverse().forEach((function(n,r){for(var s=1;s<=n.rowSpan;s++)for(var l=1;l<=n.colSpan;l++)if(1!=s||1!=l){var d=i.cell(i.getTag("td")),c=e.length-1-o+s-1,p=t[c];d.style.display="none",p||(p=i.tr(),t[c]=p),p.data.splice(a.length-r+l-1,0,d)}}))}))},formattr:function(t,e,i){var a=this.tr(),o=this.toArray(t.children),n=o.length;return this.getInlineStyle(t,a,!0),o.forEach(function(t,o){var r=this.cell(e),s=t.rowSpan,l=t.colSpan;this.getInlineStyle(t,r,!0);var d=r.details;d.rowSpan=s,d.colSpan=l,a.data.push(r),t.childNodes.length&&(r.data=this.formatHtml(this.formatDOM(this.toArray(t.childNodes)))),i&&(i[o]={rowSpan:s,colSpan:l}),e!=this.getTag("th")?delete r.style.width:r.style.width||(r.style.width=parseInt(1e4/n)/100+"%")}.bind(this)),a},formatcell:function(t,e){var i=this.cell(e),a=this.toArray(t.children);return this.getInlineStyle(t,i,!0),i.data=this.formatHtml(a),i},insertRow:function(t){var e=this.data.topLevelElement;if(e&&this.getTagName(e)==this.getTag("td")){this.updateRangeNode(),this.resetRange(!0);var i=e.parentNode,a=this.toArray(i.parentNode.children),o=this.getIndex(a,i),n=this.toArray(i.children),r=this.getIndex(n,e),s="before"==t,l=e.rowSpan;0!=o&&s&&(s=!1,i=a[o-1],o-=1,l=(e=i.children[r]).rowSpan),l>1&&!s&&(e=(i=a[o+l-1]).children[r],o+=l-1);var d,c=o+(s?0:1),p=$L(i).data("data"),h={data:[],details:this.extend(p.details),style:this.extend(p.style),tag:p.tag,data:[]},u=[];p.data.forEach(function(t,e){var a,o={randomId:this.randomId(),style:this.extend(t.style),details:this.extend(t.details),tag:t.tag};s||("none"==t.style.display?(a=this.originCell(i.children[e])).same||-1==this.getIndex(u,a.cell)&&u.push(a.cell):1!=t.details.rowSpan&&(u.push(i.children[e]),s||(o.style.display="none"))),o.data=[this.emptyParaData()],o.details.rowSpan=1,h.data.push(o)}.bind(this)),u.forEach(function(t){this.spanSet(t,"rowSpan",t.rowSpan+1)}.bind(this)),d=this.createRow($L(e).closest(this.getTag("table")),c,h),this.setData("currentNode",this.getLastWordInPara(this.last($L(d).data("list")))),this.setData("cursor",this.getWordText(this.data.currentNode).length),this.updateRangeNode(),this.common_positioning()}},removeRow:function(){var t=this.data.topLevelElement;if(t&&this.getTagName(t)==this.getTag("td")){this.updateRangeNode(),this.resetRange(!0);var e=t.parentNode,i=this.toArray(e.parentNode.children),a=this.getIndex(i,e),o=this.toArray(e.children),n=[];if(1!=i.length){o.forEach(function(t,i){if(1==t.rowSpan&&1==t.colSpan||this.processSplit(t),"none"==t.style.display){var a=this.originCell(e.children[i]);a.same||n.push(a.cell)}}.bind(this)),n.forEach(function(t){this.spanSet(t,"rowSpan",t.rowSpan-1)}.bind(this));var r=this.getPreviousWord(this.getFirstWordInPara(this.first($L(this.first(o)).data("list"))));this.processDeleteRow($L(e).closest(this.getTag("table")),a),this.setData("currentNode",r),this.setData("cursor",this.getWordText(r).length),this.updateRangeNode(),this.setCursor(r,this.data.cursor)}}},originCell:function(t){for(var e,i,a=t.parentNode,o=this.toArray(a.children),n=this.getIndex(o,t),r=t.previousElementSibling;r;){if("none"!=r.style.display){var s=this.getIndex(o,r);if(r.colSpan+s>n)return{cell:r,same:!0,index:s};break}r=r.previousElementSibling}e=this.toArray(a.parentNode.children);for(var l=(i=this.getIndex(e,a))-1;l>=0;l--)for(r=e[l].children[n];r;)if("none"!=r.style.display){s=this.getIndex(this.toArray(r.parentNode.children),r);if(r.colSpan+s>=n&&r.rowSpan+l>i)return{cell:r,index:s,rowIndex:l};r=r.previousElementSibling}else r=r.previousElementSibling},insertColumn:function(t){var e=this.data,i=e.topLevelElement;if(i&&-1!=[this.getTag("td"),this.getTag("th")].indexOf(this.getTagName(i))){this.updateRangeNode(),this.resetRange(!0);var a=i.parentNode,o=this.toArray(a.children),n=$L(i).closest(this.getTag("table")),r=n.closest(this.getTag("paragraph")),s=this.extend(r.data("data")).data[0].data[0],l=this.getBcr(n.get(0),"width"),d=this.toArray(n.children().children()),c=this.getIndex(d,a)+i.rowSpan-1,p="before"==t,h=this.getIndex(o,i),u=h+(p?0:i.colSpan),m=[],f=l/(s.data[0].data[0].data.length+1),g=n.children();this.toArray(g.eq(0).children().children()).forEach(function(t){this.setStyle(t,"width",f+"px")}.bind(this)),m.push(this.cell(this.getTag("th"),f)),s.data[1].data.forEach(function(t,e,i){var a=this.cell(this.getTag("td")),o=d[e+1].children[h],n=!1;if(p){if("none"==o.style.display){var r,s=i[(r=this.originCell(o)).rowIndex].data[r.index],l=r.cell,c=s.details;r.isSame||(c.rowSpan+=1,this.spanSet(l,"colSpan",c.rowSpan+1)),this.spanSet(l,"colSpan",c.colSpan+1),n=!0}}else if("none"==o.style.display){if((r=this.originCell(o)).cell.colSpan+r.index-1>h){s=i[r.rowIndex].data[r.index],l=r.cell,c=s.details;r.isSame||this.spanSet(l,"colSpan",c.rowSpan+1),this.spanSet(l,"colSpan",c.colSpan+1),n=!0}}else o.colSpan>1&&(this.spanSet(o,"colSpan",t.data[h].details.colSpan+1),n=!0);n&&(a.style.display="none"),a.style.height=o.style.height,m.push(a)}.bind(this)),this.insertColumnAt(n,m,u);var y=$L(g.children()[c].children[u]);"none"==y.get(0).style.display&&(y=$L(i)),this.setData("currentNode",this.getLastWordInPara(this.last(y.data("list")))),this.setData("cursor",this.getWordText(e.currentNode).length),this.updateRangeNode(),this.setCursor(e.currentNode,e.cursor)}},removeColumn:function(){var t=this.data,e=t.topLevelElement;if(e&&-1!=[this.getTag("td"),this.getTag("th")].indexOf(this.getTagName(e))){this.updateRangeNode(),this.resetRange(!0);var i=e.parentNode,a=this.toArray(i.children),o=$L(e).closest(this.getTag("table")),n=o.children().children(),r=this.toArray(n),s=this.getIndex(r,i),l=this.getIndex(a,e);if(1!=a.length){this.toArray(r[0].children).forEach(function(t,e){e!=l&&this.setStyle(t,"width, cellWidth")}.bind(this)),r.forEach(function(t,e){if(0!=e){var i=t.children[l];if("none"==i.style.display){var a=this.originCell(i);a.same?this.spanSet(a.cell,"colSpan",Math.max(1,a.cell.colSpan-1)):this.spanSet(a.cell,"rowSpan",Math.max(1,a.cell.rowSpan-1)),this.setStyle(i,"display","")}else 1==i.rowSpan&&1==i.colSpan||this.processSplit(i)}}.bind(this)),this.deleteColumnAt(o,l);var d=n[s].children,c=d[l]||this.last(d);this.setData("currentNode",this.getLastWordInPara(this.last($L(c).data("list")))),this.setData("cursor",this.getWordText(t.currentNode).length),this.updateRangeNode(),this.setCursor(t.currentNode,t.cursor)}}},selectCell:function(t){if(t){var e=$L(t).data("list"),i=this.getFirstWordInPara(e[0]),a=this.getLastWordInPara(this.last(e));this.resetRange(!0);var o=this.data.range,n=Lyte.objectUtils,r=this.getWordText(a).length,s={startNode:i,endNode:a,left:0,right:r,isRange:i!=a||r};for(var l in s)n(o,"add",l,s[l]);this.setData({currentNode:i,cursor:0}),this.common_positioning()}},deleteTable:function(t){this.updateRangeNode();var e,i=t.closest(this.getTag("paragraph")),a=i.parentNode,o=$L(a).data("list"),n=this.getIndex(o,i);1==o.length?(e=this.render(this.emptyParaData()),this.pushParagraph(e,a,0)):e=0==n?o[1]:o[0],this.removePara(i);var r=this[n?"getFirstWordInPara":"getLastWordInPara"](e),s=n?this.getWordText(r).length:0;this.setData("currentNode",r),this.setCursor(r,s),this.updateRangeNode()},table_next:function(t,e){var i=this.toArray(t.closest(this.getTag("table")).children().children()),a=e.parentNode,o=this.getIndex(i,a),n=i.length-1,r=a.children,s=this.getIndex(this.toArray(r),e);if(this.__shiftmove&&s!=r.length-1&&(o=n),o!=n){var l=i[o+1].children[s];return"none"==l.style.display&&(l=this.getNext(l)),l}},table_prev:function(t,e){var i=this.toArray(t.closest(this.getTag("table")).children().children()),a=e.parentNode,o=this.getIndex(i,a),n=this.getIndex(this.toArray(a.children),e);if(this.__shiftmove&&0!=n&&(o=0),0!=o){var r=i[o-1].children[n];return"none"==r.style.display&&(r=this.getPrevious(r)),r}}}),Lyte.Component.register("lyte-editor-item",{_template:'<template tag-name="lyte-editor-item" onkeydown="{{action(\'keydown\',event)}}"> <template is="switch" value="{{item.type}}"><template case="switch"></template><template case="undo"></template><template case="anchor"></template><template case="list"><template is="if" value="{{item.display}}"><template case="true"><template is="if" value="{{fromList}}"><template case="true"> {{unescape(item.display,undefined,sanitizer.attr)}} </template><template case="false"> {{item.display}} </template></template></template></template></template><template case="dropdown"> <lyte-dropdown lt-prop="{{ltPropDropdown}}" lt-prop-is-open="{{lbind(cpShow)}}" lt-prop-selected="{{lbind(item.selected)}}" on-option-selected="{{method(\'throw\',\'dropItemSelected\',item)}}" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-display-value="{{lbind(item.displayValue)}}" on-show="{{method(\'throw\',\'elementOpen\')}}" on-hide="{{method(\'throw\',\'elementClose\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="editor-dropdown lyteEditorPanelDropdown {{item.class}} {{ltPropWrapperClass}}"> <lyte-drop-body> <template is="for" items="{{item.display}}" item="dropItem" index="index"> <lyte-drop-item class="lyteEditorPanelDropItem" data-value="{{item.value[index]}}" style="--editorPanelDropValue:{{item.value[index]}}"> {{dropItem}} </lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template><template case="colorpicker"> {{item.display}} <lyte-colorpicker lt-prop-yield="{{isFont}}" lt-prop-no-fill-button="{{expHandlers(isFont,\'!\')}}" class="editor-colorpicker lyteEditorPanelColorPicker" lt-prop-origin-element="{{editorOrigin}}" on-select="{{method(\'throw\',\'colorPickerSelect\',item)}}" lt-prop-wrapper-class="{{editorId}}{{item.name}}colorpicker {{ltPropWrapperClass}}" style="display: none;" lt-prop="{{ltPropColorPicker}}" lt-prop-show="{{lbind(cpShow)}}" on-open="{{method(\'throw\',\'elementOpen\')}}" on-before-open="{{method(\'throw\',\'elementBeforeOpen\')}}" on-close="{{method(\'throw\',\'elementClose\',item)}}" lt-prop-popover="{{ltPropPopover}}" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-selected-color="{{lbind(item.selectedColor)}}" lt-prop-used-colors-list="{{lbind(item.usedColorsList)}}"> <template is="registerYield" yield-name="cpyield"> <span class="lyteEditorPanelDefaultColor" onclick="{{action(\'reset\')}}">{{lyteUiEditorI18n("Reset to default color")}}</span> </template> </lyte-colorpicker> <span class="lyteEditorColorIconClass" style="background: {{item.selected}};"></span> </template><template case="emoji"> {{item.display}} <lyte-popover lt-prop-focus-on-close="true" lt-prop-origin-elem="{{editorOrigin}}" lt-prop-show="{{lbind(item.active)}}" class="lyteEditorEmojiPopover" lt-prop-duration="{{undef}}" lt-prop-wrapper-class="lyteEditorEmojiPopoverWrapper {{editorId}}{{item.name}}Popover {{ltPropWrapperClass}}" lt-prop-allow-multiple="true" lt-prop="{{ltPropPopover}}" on-show="{{method(\'throw\',\'elementOpen\')}}" on-before-close="{{method(\'emojiClose\')}}" on-close="{{method(\'throw\',\'elementClose\')}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="popover"> <template is="if" value="{{expHandlers(item.input,\'!=\',undefined)}}"><template case="true"> <lyte-emoji on-emoji-select="{{method(\'throw\',\'emojiselect\',item)}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-no-match-text="{{item.noMatchText}}" lt-prop-input="{{item.input}}"></lyte-emoji> </template><template case="false"> <lyte-emoji on-emoji-select="{{method(\'throw\',\'emojiselect\',item)}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}"></lyte-emoji> </template></template> </template> </lyte-popover> </template><template case="custom"> <lyte-yield yield-name="editor-custom" item="{{item}}"></lyte-yield> </template><template case="image"><template is="if" value="{{item.display}}"><template case="true"> {{item.display}} </template></template> <lyte-modal lt-prop-wrapper-class="{{setImageModalClass()}}" lt-prop-show-close-button="false" lt-prop-show="{{lbind(cpShow)}}" lt-prop-duration="{{undef}}" lt-prop="{{ltPropModal}}" on-show="{{method(\'throw\',\'elementOpen\')}}" on-close="{{method(\'throw\',\'elementClose\')}}" on-before-show="{{method(\'popoverOpen\')}}" on-before-close="{{method(\'popoverClose\')}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header class="lyteEditorImageHeader"> {{lyteUiEditorI18n("Insert Image")}} </lyte-modal-header> <lyte-modal-content class="lyteEditorImageContent"> <div class="lyteEditorInsertImageRadioWrap"> <lyte-radiobutton class="lyteEditorUploadImageRadio" lt-prop-type="primary" lt-prop-name="{{editorId}}" lt-prop-checked="{{expHandlers(isUrl,\'!\')}}" lt-prop-value="image" lt-prop-label="Upload image"></lyte-radiobutton> <lyte-radiobutton lt-prop-type="primary" lt-prop-name="{{editorId}}" lt-prop-checked="{{lbind(isUrl)}}" lt-prop-value="url" lt-prop-label="Upload from Url"></lyte-radiobutton> </div> <div class="lyteEditorImageUpload {{if(isUrl,\'lyteEditorHide\',\'\')}}"> <input class="lyteEditorOriginalImageUpload" type="file" onchange="{{action(\'change\',this)}}" accept="image/jpg,image/png,image/jpeg,image/gif,image/bmp"> <lyte-button onclick="{{action(\'openfile\',this)}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Upload from computer")}} </template> </lyte-button> <template is="if" value="{{url}}"><template case="true"> <div style="position: relative;"> <span class="lyteEditorPreviewImageClose" onclick="{{action(\'removeImg\')}}"></span> <img crossorigin="anonymus" class="lyteEditorPreviewImage" src="{{url}}" onload="{{action(\'imageLoad\',true)}}" onerror="{{action(\'imageLoad\',false)}}"> </div> </template><template case="false"> <div class="lyteEditorInsertImagePlaceholder"> {{lyteUiEditorI18n("Image preview will be shown here.")}} </div> </template></template> </div> <template is="if" value="{{renderUrl}}"><template case="true"> <div class="lyteEditorImageUrl {{if(isUrl,\'\',\'lyteEditorHide\')}}"> <lyte-input class="lyteEditorImageUrlInput" lt-prop-appearance="box" lt-prop-placeholder="Enter valid image URL" lt-prop-value="{{lbind(url)}}" lt-prop-focus="{{isUrl}}"></lyte-input> <template is="if" value="{{imageError}}"><template case="true"> <div class="lyteEditorImageErrorMessage"> {{lyteUiEditorI18n("Error in loading the image. Pls check the URL.")}} </div> </template></template> <template is="if" value="{{expHandlers(url,\'&amp;&amp;\',expHandlers(imageError,\'!\'))}}"><template case="true"> <div class="lyteEditorImagePreview {{if(imageError,\'lyteEditorImageError\',\'\')}}"> <span class="lyteEditorPreviewImageClose" style="position: absolute;right: 5px;top: 5px;width: 15px;height: 15px;display: inline-block;border: 1px solid black" onclick="{{action(\'removeImg\')}}"></span> <img crossorigin="anonymus" class="lyteEditorPreviewImage" src="{{url}}" onload="{{action(\'imageLoad\',true)}}" onerror="{{action(\'imageLoad\',false)}}"> </div> </template><template case="false"> <div class="lyteEditorInsertImagePlaceholder"> {{lyteUiEditorI18n("Image preview will be shown here.")}} </div> </template></template> </div> </template></template> <div class="lyteEditorImageSizeControl"> <lyte-radiobutton lt-prop-checked="{{lbind(fitToScreen)}}" lt-prop-value="fit_to_screen" lt-prop-type="primary" lt-prop-name="image_size _{{editorId}}" lt-prop-label="Fit to screen"></lyte-radiobutton> <lyte-radiobutton lt-prop-checked="{{lbind(small)}}" lt-prop-value="small" lt-prop-type="primary" lt-prop-name="image_size _{{editorId}}" lt-prop-label="small"></lyte-radiobutton> <lyte-radiobutton lt-prop-checked="{{lbind(actualSize)}}" lt-prop-value="actual_size" lt-prop-type="primary" lt-prop-name="image_size _{{editorId}}" lt-prop-label="Actual size"></lyte-radiobutton> </div> <template is="if" value="{{ltPropShowWrapImage}}"><template case="true"> <div class="lyteEditorImageWrapContainer"> <lyte-checkbox lt-prop-name="checkbox" lt-prop-checked="{{lbind(wrapImage)}}" lt-prop-label="{{lyteUiEditorI18n(\'Wrap Image\')}}" lt-prop-value="val" lt-prop-id="checkbox"></lyte-checkbox> </div> </template></template> <template is="if" value="{{expHandlers(item.advancedOptions,\'&amp;&amp;\',expHandlers(url,\'||\',loaded))}}"><template case="true"> <lyte-accordion> <template is="registerYield" yield-name="yield"> <lyte-accordion-item> <lyte-accordion-header>Advanced Options<lyte-icon class="lyteAccordionArrow"></lyte-icon></lyte-accordion-header> <lyte-accordion-body> <template is="for" items="{{ltPropImageOptions}}" item="optionsItem" index="index"> <div class="{{optionsItem.class}}"> <template is="if" value="{{optionsItem.label}}"><template case="true"><div> {{optionsItem.label}} </div></template></template> <template items="{{optionsItem.subItems}}" item="subItem" index="index" is="for"> <template value="{{subItem.type}}" is="switch">      <template case="input"> <div class="{{subItem.class}}"> {{subItem.label}} <lyte-input class="{{subItem.class}}" lt-prop="{{stringify(subItem.prop)}}" lt-prop-value="{{lbind(subItem.value)}}"></lyte-input> </div> </template><template case="number"> <div class="{{subItem.class}}"> {{subItem.label}} <lyte-number lt-prop="{{stringify(subItem.prop)}}" lt-prop-label="{{lbind(subItem.unit)}}" lt-prop-value="{{lbind(subItem.value)}}" on-value-change="{{method(\'numberValueChange\',subItem.purpose)}}"></lyte-number> </div> </template><template case="radioButtonGroup"> <div class="{{subItem.class}}"> {{subItem.label}} <lyte-radiobutton-group lt-prop="{{stringify(subItem.prop)}}" lt-prop-selected="{{lbind(subItem.selected)}}" lt-prop-user-value="{{subItem.userValue}}" lt-prop-system-value="{{subItem.systemValue}}" lt-prop-options="{{subItem.options}}" on-checked="{{method(\'alignChange\')}}"></lyte-radiobutton-group> </div> </template><template case="dropdown"> <div class="{{subItem.class}}"> {{subItem.label}} <lyte-dropdown lt-prop-options="{{subItem.options}}" lt-prop-user-value="{{subItem.userValue}}" lt-prop-system-value="{{subItem.systemValue}}" on-option-selected="{{method(\'changeunit\')}}"></lyte-dropdown> </div> </template><template case="checkBox"> <div class="{{subItem.class}}"> <lyte-checkbox lt-prop="{{stringify(subItem.prop)}}" lt-prop-label="{{subItem.label}}" lt-prop-checked="{{lbind(maintainAspectRatio)}}"></lyte-checkbox> </div> </template></template> </template> </div> </template> </lyte-accordion-body> </lyte-accordion-item> </template> </lyte-accordion> </template></template> </lyte-modal-content> <lyte-modal-footer class="right lyteEditorImageFooter"> <lyte-button onclick="{{action(\'insert\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Cancel")}} </template> </lyte-button> <lyte-button lt-prop-disabled="{{disabled}}" lt-prop-appearance="primary" onclick="{{action(\'insert\',this)}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Insert")}} </template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </template><template case="codeEditor"> <lyte-modal lt-prop="{{ltPropModal}}" lt-prop-show="{{lbind(cpShow)}}" lt-prop-wrapper-class="lyteEditorSnippetModal" lt-prop-width="70%" lt-prop-height="70%" lt-prop-set-content-height="true" lt-prop-show-close-button="false" lt-prop-transition="{&quot;animation&quot;:&quot;fadeIn&quot;, &quot;duration&quot;:&quot;0.3&quot;}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <span>Insert code</span> <div class="lyteEditorSnippetModalLanguageSection"> <span class="lyteEditorSnippetChooseLangLabel">Choose language: </span> <lyte-dropdown lt-prop-options="{{languagesSupported}}" lt-prop-selected="{{lbind(languageSelected)}}"> </lyte-dropdown> </div> </lyte-modal-header> <lyte-modal-content class="lyteFilterContent"> <textarea class="lyteEditorSnippetTextarea" spellcheck="false"></textarea> </lyte-modal-content> <lyte-modal-footer class="right"> <lyte-button onclick="{{action(\'insertCode\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Cancel")}} </template> </lyte-button> <lyte-button lt-prop-appearance="primary" onclick="{{action(\'insertCode\',this)}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Insert")}} </template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </template><template case="insertHTML"> <lyte-modal lt-prop="{{ltPropModal}}" lt-prop-show="{{lbind(cpShow)}}" lt-prop-wrapper-class="lyteEditorInsertHTMLModal" lt-prop-width="auto" lt-prop-height="auto" lt-prop-set-content-height="true" lt-prop-show-close-button="false" lt-prop-transition="{&quot;animation&quot;:&quot;fadeIn&quot;, &quot;duration&quot;:&quot;0.3&quot;}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <template is="if" value="{{showPreview}}"><template case="true"> <span class="lyteEditorInsertHTMLBack" onclick="{{action(\'hidePreview\',this)}}">---</span> <span>{{lyteUiEditorI18n("Preview")}}</span> </template><template case="false"> <span>{{lyteUiEditorI18n("Insert HTML")}}</span> </template></template> </lyte-modal-header> <lyte-modal-content class="lyteFilterContent"> <template is="if" value="{{showPreview}}"><template case="true"> <div class="lyteEditorInsertHTMLPreview">{{unescape(ltPropPreviewContent,undefined,sanitizer.attr)}}</div> </template><template case="false"> <textarea class="lyteEditorInsertHTMLTextarea" spellcheck="false" value="{{lbind(ltPropPreviewContent)}}"></textarea> <div onclick="{{action(\'showPreview\',this)}}">Preview</div> </template></template> </lyte-modal-content> <lyte-modal-footer class="right"> <lyte-button lt-prop-appearance="primary" onclick="{{action(\'insertHTML\',this)}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Insert")}} </template> </lyte-button> <lyte-button onclick="{{action(\'insertHTML\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Cancel")}} </template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{switch:{dynamicNodes:[],additional:{next:"undo"}},undo:{dynamicNodes:[],additional:{next:"anchor"}},anchor:{dynamicNodes:[],additional:{next:"list"}},list:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]},dropdown:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'--editorPanelDropValue:'","item.value[index]"]}}}},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},colorpicker:{dynamicNodes:[{type:"text",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","item.selected","';'"]}}}}]},emoji:{dynamicNodes:[{type:"text",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},{type:"componentDynamic",position:[3]}]},custom:{dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},image:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"attr",position:[2]},{type:"registerYield",position:[2,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1,1]},{type:"componentDynamic",position:[3,1,1]},{type:"attr",position:[3,1,3]},{type:"componentDynamic",position:[3,1,3]},{type:"attr",position:[3,3]},{type:"attr",position:[3,3,1]},{type:"attr",position:[3,3,3]},{type:"registerYield",position:[3,3,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3,3,3]},{type:"attr",position:[3,3,5]},{type:"if",position:[3,3,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,3]}]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[3,5]},{type:"if",position:[3,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"attr",position:[1,3]}]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}}]}},default:{}},{type:"attr",position:[3,7,1]},{type:"componentDynamic",position:[3,7,1]},{type:"attr",position:[3,7,3]},{type:"componentDynamic",position:[3,7,3]},{type:"attr",position:[3,7,5]},{type:"componentDynamic",position:[3,7,5]},{type:"attr",position:[3,9]},{type:"if",position:[3,9],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"attr",position:[3,11]},{type:"if",position:[3,11],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[0,1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"for",position:[1,3],dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{input:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},number:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},radioButtonGroup:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},dropdown:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},checkBox:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[2]}]},codeEditor:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,3,3]},{type:"componentDynamic",position:[1,3,3]},{type:"componentDynamic",position:[1]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[1]}]},insertHTML:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[3,0]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]}]}},default:{}},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[1]}]}},default:{}}],_templateAttributes:{type:"attr",position:[]},_observedAttributes:["ltPropDropdown","ltPropPopover","ltPropColorPicker","ltPropTabindex","ltPropWrapperClass","ltPropFreeze","ltPropPreviewContent","ltPropSanitizer","item","editorId","ltPropTooltipConfig","active","activeClass","editorOrigin","cpShow","languagesSupported","languageSelected","sanitizer","fromList","isFont","isUrl","url","imageError","disabled","loaded","renderUrl","fitToScreen","small","actualSize","maintainAspectRatio","showPreview","wrapImage"],data:function(){var t=Lyte.attr.bind(Lyte),e="string",i="boolean",a=!1;return{ltPropDropdown:t(e,{default:"{}"}),ltPropPopover:t(e,{default:"{}"}),ltPropColorPicker:t(e,{default:"{}"}),ltPropTabindex:t(e,{default:"-1"}),ltPropWrapperClass:Lyte.attr("string",{default:""}),ltPropFreeze:Lyte.attr("boolean",{default:!1}),ltPropPreviewContent:t(e,{default:""}),ltPropSanitizer:t("object",{default:{}}),item:t("object"),editorId:t(e),ltPropTooltipConfig:t(e),active:t(i),activeClass:t(e),editorOrigin:t(e),cpShow:t(i,{default:a}),languagesSupported:t("array",{default:["HTML","CSS","JS","JAVA","PYTHON","JSON","XML","LYTE"]}),languageSelected:t("string",{default:"HTML"}),sanitizer:t("object",{default:{}}),fromList:t(i,{default:a}),isFont:t(i,{default:a}),isUrl:t(i,{default:a}),url:t(e,{default:""}),imageError:t(i,{default:a}),disabled:t(i,{default:!0}),loaded:t(i,{default:a}),renderUrl:t(i,{default:a}),fitToScreen:t(i,{default:!0}),small:t(i,{default:a}),actualSize:t(i,{default:a}),maintainAspectRatio:t(i,{default:a}),showPreview:t(i,{default:a}),wrapImage:t(i,{default:a})}},init_fn:function(t){var e=this.data.item;this.setData("isFont","colorpicker"==e.type&&"color"==e.name),t||"colorpicker"!=e.type||null!=e.usedColorsList||Lyte.objectUtils(e,"add","usedColorsList",[])}.observes("item.type","item").on("init"),obs:function(t){var e=this.data.item,i=_lyteUiUtils.capitalize,a="lyteEditorTextFormatIcons lyteEditor"+i(e.name)+"Icon",o=e.type;e.active&&(a+=" "+(e.activeClass||this.data.activeClass)),e.disabled&&(a+=" lyteEditorPanelIconDisabled"),e.class&&(a+=" "+e.class),o&&(a+=" lyte"+i(o)+"Icon"),this.$node.setAttribute("class",a),e.active&&e.prevent_true?this.$node.setAttribute("tabindex",-1):this.$node.setAttribute("tabindex",this.data.ltPropTabindex),t||$L(this.$node).attr(e.attr||{})}.observes("active","item.type","item.disabled").on("didConnect"),url_obs:function(t){this.data.cpShow&&this.alignModal(),t.newValue&&this.setData("renderUrl",!0),this.setData({url:"",fitToScreen:!0})}.observes("isUrl"),displayTypeObs:function(t){if(this.data.item.advancedOptions&&this.data.url&&this.data.loaded){let e=this._imagePop.querySelector(".lyteEditorPreviewImage"),i="",a="";"actualSize"==t.item&&t.newValue&&(i=e.naturalWidth,a=e.naturalHeight);let o=this._imagePop.querySelector(".lyteEditorPanelImageWidthInput").querySelector("lyte-number"),n=this._imagePop.querySelector(".lyteEditorPanelImageHeightInput").querySelector("lyte-number");o.ltProp("value",i),n.ltProp("value",a)}}.observes("actualSize"),alignModal:function(){this.$node.querySelector("lyte-modal").alignModal()},init:function(){this.data.editorOrigin="#"+this.data.editorId+" .lyteEditor"+_lyteUiUtils.capitalize(this.data.item.name)+"Icon"},cp_obs:function(t){$L(this.$node)[t.newValue?"addClass":"removeClass"]("lyteEditor"+("colorpicker"==this.data.item.type?"Colorpicker":"imageModal")+"Opened")}.observes("cpShow"),disabled_obs:function(t){var e=this.data,i=t.oldValue;"url"==t.item&&i&&URL.revokeObjectURL(i),!this.data.url&&!this.data.loaded&&this.resetAdvancedOptions(),this.setData("disabled",!(e.loaded&&e.url))}.observes("loaded","url"),sel_obs:function(t){if("colorpicker"==this.data.item.type){var e=t.newValue,i=this.$node.getElementsByTagName("lyte-colorpicker")[0],a=""!=e?/rgb/i.test(e)?{rgb:e}:{hex:e}:{};i.selectColor?i.selectColor(/rgba/i.test(e)?{rgba:e}:/rgb/i.test(e)?{rgb:e}:{hex:e}):i.component.setData("ltPropSelectedColor",a)}}.observes("item.selected"),drop:function(t){t.preventDefault();let e=t.dataTransfer.files,i=["image/png","image/jpeg","image/jpg","image/gif","image/bmp"];for(let t=0;t<e.length;t++){let a=e[t];-1!=i.indexOf(a.type)&&(this.setData("url",URL.createObjectURL(a)),this.setData("imageError",!1))}},preventDefaults:function(t){t.preventDefault(),t.stopPropagation()},resetAdvancedOptions:function(){this.data.item.advancedOptions&&this.data.ltPropImageOptions.forEach((function(t){t.subItems.forEach((function(t){switch(t.purpose){case"height":case"width":Lyte.objectUtils(t,"add","value",""),Lyte.objectUtils(t,"add","unit","px");break;case"align":Lyte.objectUtils(t,"add","selected",{});break;default:Lyte.objectUtils(t,"add","value","")}}))})),this.setData("wrapImage",!1)},methods:{throw:function(){this.throwEvent.apply(this,arguments)},emojiClose:function(t,e){let i="onBeforeEmojiClose";if(this.getMethods(i))return this.executeMethod(i,t,e)},popoverOpen:function(t){let e=this._imagePop=this._imagePop||$L(t.childComp).find(".lyteEditorImageModal").get(0).children[0];this._preventDefault=this.preventDefaults.bind(this),["dragenter","dragover","dragleave"].forEach((t=>{e.addEventListener(t,this._preventDefault,!1)})),this._drop=this.drop.bind(this),e.addEventListener("drop",this._drop,!1)},popoverClose:function(){["dragenter","dragover","dragleave"].forEach((t=>{this._imagePop.removeEventListener(t,this._preventDefault,!1)})),this._imagePop.removeEventListener("drop",this._drop,!1)},changeunit:function(t,e,i,a){let o=i.$node.parentElement.parentElement;$L(o).find("lyte-number");$L(o).find(".lyteEditorPanelImageWidthInput").find("lyte-number").get(0).ltProp("label",e),$L(o).find(".lyteEditorPanelImageHeightInput").find("lyte-number").get(0).ltProp("label",e)},numberValueChange:function(t,e,i){if(!e.newValue&&0!==e.newValue||!this.data.maintainAspectRatio)return;let a=this._image=this._image||this._imagePop.querySelector(".lyteEditorPreviewImage"),o=i.parentElement.parentElement,n=a.naturalWidth,r=a.naturalHeight,s=0,l=0,d=a.margin||0;if(this.data.actualSize)s=n,l=r;else if(this.data.small)s=200,l=r/n*s;else{let t={};this.throwEvent("getCurrentParaClient",t),t=t.client,s=t.width-d,l=r/n*100-d}let c,p=s/l;"width"==t?(c=o.querySelector(".lyteEditorPanelImageHeightInput").getElementsByTagName("lyte-number")[0],c.ltProp("value",e.newValue/p)):"height"==t&&(c=o.querySelector(".lyteEditorPanelImageWidthInput").getElementsByTagName("lyte-number")[0],c.ltProp("value",e.newValue*p))},alignChange:function(t,e){this.data.wrapImage?"left"!=e.value&&"right"!=e.value&&this.setData("wrapImage",!1):"left"!=e.value&&"right"!=e.value||this.setData("wrapImage",!0)}},actions:{keydown:function(t){"Enter"==t.key&&t.target==this.$node&&("dropdown"==this.data.item.type?setTimeout(function(){this.$node.getElementsByTagName("lyte-dropdown")[0].open()}.bind(this)):this.$node.click(),t.preventDefault())},removeImg:function(){this.setData("url","")},change:function(t){let e,i=URL.createObjectURL(t.files[0]);this.getMethods("onBeforeImageUpload")&&(e=this.executeMethod("onBeforeImageUpload",i,t,this.$node));let a=function(){this.setData("url",i),t.value="",this._image=void 0}.bind(this);e&&e.then?e.then(a):!1!==e&&a()},openfile:function(t){t.previousElementSibling.click()},reset:function(){return this.throwEvent("colorPickerSelect",this.data.item,0,{},this.$node.querySelector("lyte-colorpicker").component),Lyte.objectUtils(this.data.item,"add","selectedColor",this.data.item.selected),!1},imageLoad:function(t){this.setData({imageError:!t,loaded:t}),this.alignModal()},insert:function(t){var e=this.data,i=(e.url,e.isUrl,!1);if(t){var a,o,n,r,s,l,d,c,p,h=t.closest(".lyteEditorImageModal").querySelector("img"),u=h.naturalWidth,m=h.naturalHeight,f=document.getElementById(this.data.editorId).parentNode.component.getThis().getData("ltPropImageStyle").margin||"0px",g="";e.actualSize?(o=u,n=m,p="actualSize"):e.small?(n=m/u*(o=200),p="small"):(o="calc( 100% - "+f+" - "+f+" )",n="calc( "+m/u*100+"% - "+f+" - "+f+" )",p="fitToScreen"),this.data.ltPropImageOptions.forEach((function(t){t.subItems.forEach((function(t){switch(t.purpose){case"alt":g=t.value;break;case"height":null!=t.value&&""!=t.value&&(n=t.value+t.unit,p="custom");break;case"width":null!=t.value&&""!=t.value&&(o=t.value+t.unit,p="custom");break;case"align":t.selected.value&&("left"==t.selected.value||"right"==t.selected.value?s=t.selected.value:r=t.selected.value);break;case"horizontal":t&&(l=t.value);break;case"vertical":t&&(d=t.value);break;case"border":t&&(border=t.value)}}))}));try{a=_lyteUiEditor.copy_image(h,"",u,m)}catch(t){a=h.src}m==parseInt(n)&&u==parseInt(o)&&(p="actualSize"),this.data.wrapImage&&(s||r||(s="left")),c="' style='"+(s?"float:"+s+";":"")+(border?"border:"+border+"px solid black;":"")+(r?"vertical-align:"+r+";":"")+(l?"margin-left:"+l+"px;margin-right:"+l+"px;":"")+(d?"margin-top:"+d+"px;margin-bottom:"+d+"px;":"")+"' ",this.throwEvent("insertImage","<img src='"+a+"' alt='"+g+"' display-type='"+p+"' height='"+n+"' width='"+o+("' style='"!=c?""+c:"")+"' >",this._imgElm,this.data.wrapImage)}this.setData({cpShow:i,isUrl:i,loaded:i,url:"",fitToScreen:!0}),this._imgElm=void 0,this.resetAdvancedOptions()},insertCode:function(t){if(t){var e=$L($L(this.$node).find("lyte-modal")[0].component.childComp).find("textarea")[0].value;this.throwEvent("insertCodeText",e,this.data.languageSelected),this.setData({cpShow:!1})}else this.setData({cpShow:!1})},insertHTML:function(t){t&&this.throwEvent("insertHTML",this.data.ltPropPreviewContent),this.setData("cpShow",!1)},showPreview:function(t){this.setData("ltPropPreviewContent",t.previousElementSibling.value),this.setData("showPreview",!0)},hidePreview:function(t){let e=t.parentElement.nextElementSibling;this.setData("ltPropPreviewContent",$L(e).find(".lyteEditorInsertHTMLPreview").get(0).innerHTML),this.setData("showPreview",!1)}}}),Lyte.Component.registerHelper("setImageModalClass",(function(t){return(this.component.data.item.advancedOptions?"lyteEditorInsertImgModalWrap":"")+" lyteEditorImageModal "+this.component.getData("ltPropWrapperClass")})),Lyte.Component.register("lyte-editorpanel",{_template:'<template tag-name="lyte-editorpanel"> <div class="lyteEditorIconsDiv" id="{{editorId}}"> <template is="if" value="{{isGrouped}}"><template case="true"> <template is="for" items="{{renderingOptions}}" item="sub" index="subIndex"> <div class="LyteEditorFormatSection {{sub.class}}" index="{{subIndex}}"> <template is="for" items="{{sub.subIcons}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" active="{{item.active}}" onclick="{{action(\'iconClick\',item,event)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" sanitizer="{{sanitizer}}" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-wrapper-class="{{ltPropWrapperClass}}" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template></div></template>  </template><template case="false"> <template is="for" items="{{renderingOptions}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" index="{{index}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" active="{{item.active}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" onclick="{{action(\'iconClick\',item,event)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" sanitizer="{{sanitizer}}" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-wrapper-class="{{ltPropWrapperClass}}" lt-prop-freeze="{{ltPropFreeze}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template></template></template> <span class="lyteEditorMoreOptions {{extraIconClass}} {{if(moreOptionsShow,\'lyteEditorMoreOptionsOpened\',\'\')}}" lt-prop-title="{{ltPropMoreOptions}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" onclick="{{action(\'showmore\',event)}}" onkeydown="{{action(\'showmore\',event)}}" tabindex="{{ltPropTabindex}}"></span> <template is="if" value="{{renderExtraIcon}}"><template case="true"> <lyte-popover class="moreOptionsPopover" lt-prop-focus-on-close="true" lt-prop-wrapper-class="lyteEditorPanelMoreOptionPopover {{ltPropMoreOptionsWrapperClass}} {{ltPropWrapperClass}}" lt-prop-show="{{lbind(moreOptionsShow)}}" lt-prop-origin-elem="#{{editorId}} .lyteEditorMoreOptions" lt-prop-force-scroll="{{ltPropForcePopScroll}}" lt-prop="{{ltPropMoreOptionsPopover}}" on-before-close="{{method(\'moreBeforeClose\')}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="popover"> <div class="lyteEditorIconsDiv {{if(isSelected,\'lyteEditorTextSelected\',\'\')}}" id="{{editorId}}"> <template is="if" value="{{isGrouped}}"><template case="true"> <template is="for" items="{{extraOptions}}" item="sub" index="subIndex"> <div class="LyteEditorFormatSection {{item.class}}"> <template is="for" items="{{sub.subIcons}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" active="{{item.active}}" onclick="{{action(\'iconClick\',item,event)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" sanitizer="{{sanitizer}}" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-wrapper-class="{{ltPropWrapperClass}}" lt-prop-freeze="{{ltPropFreeze}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template></div></template>  </template><template case="false"> <template is="for" items="{{extraOptions}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" active="{{item.active}}" onclick="{{action(\'iconClick\',item,event)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" sanitizer="{{sanitizer}}" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-wrapper-class="{{ltPropWrapperClass}}" lt-prop-freeze="{{ltPropFreeze}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template></template></template> </div> </template> </lyte-popover> </template></template> </div> <template is="if" value="{{allowListPop}}"><template case="true"> <lyte-popover lt-prop-duration="{{undef}}" lt-prop-wrapper-class="lyteEditorPanelListPopover {{ltPropWrapperClass}}" lt-prop-show="{{lbind(listPopShow)}}" lt-prop-origin-elem=".{{randomId}}" lt-prop-allow-multiple="true" lt-prop="{{ltPropPopover}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="lyteEditorPanelListPopContent {{listPanelClass}}"> <template is="for" items="{{listRendering.list}}" item="item" index="index"> <lyte-editor-item role="button" aria-label="{{item.title}}" active-class="{{ltPropActiveClass}}" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-show-wrap-image="{{ltPropShowWrapImage}}" editor-id="{{editorId}}" item="{{item}}" lt-prop-title="{{item.title}}" lt-prop-tooltip-class="{{ltPropTooltipClass}}" active="{{item.active}}" onclick="{{action(\'listClick\',item,event,listRendering)}}" lt-prop-dropdown="{{ltPropDropdown}}" lt-prop-color-picker="{{ltPropColorPicker}}" lt-prop-popover="{{ltPropPopover}}" lt-prop-image-options="{{ltPropImageAdvancedOptions}}" sanitizer="{{sanitizer}}" from-list="true" tabindex="{{ltPropTabindex}}" lt-prop-tabindex="{{ltPropTabindex}}" lt-prop-freeze="{{ltPropFreeze}}" on-before-emoji-close="{{method(\'emojiClose\')}}" on-before-image-upload="{{method(\'onBeforeImageUpload\')}}"> <template is="registerYield" yield-name="editor-custom" icon-data="{{item}}" from-parent=""></template> </lyte-editor-item> </template> </lyte-popover-content> </template> </lyte-popover> </template></template> <template is="if" value="{{renderTablePop}}"><template case="true"> <lyte-popover class="lyteEditorTablePopover" lt-prop-duration="{{undef}}" lt-prop-wrapper-class="lyteEditorPanelTableInsertPopover {{ltPropWrapperClass}}" lt-prop-show="{{lbind(tableShow)}}" lt-prop-origin-elem="#{{editorId}} .lyteTableIcon" lt-prop-allow-multiple="true" lt-prop="{{ltPropPopover}}" lt-prop-freeze="{{ltPropFreeze}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-header class="">{{lyteUiEditorI18n("Insert Table")}}</lyte-popover-header> <lyte-popover-content> <div class="{{if(tableSelect,\'lyteEditorHide\',\'\')}}"> <div class="lyteEditorTableSelectWrapper"> <template is="for" items="{{tableData}}" item="row" index="row_index"> <div class="lyteEditorRow"> <template is="for" items="{{row}}" item="col" index="col_index"> <span class="{{col.class}}" onclick="{{action(\'table_click\',row_index,col_index)}}" onmouseenter="{{action(\'table_enter\',row_index,col_index)}}"></span> </template> </div> </template> </div> <div class="lyteEditorPanelTableSelected">{{rowCount}} * {{colCount}}</div> <div class="lyteEditorPanelTableCustomSwitch" onclick="{{action(\'columnSwitch\')}}">Show more options</div> </div> <div class="lyteEditorPanelTableInsertCustom {{if(tableSelect,\'\',\'lyteEditorHide\')}}"> <div class="lyteEditorTableOptionsWrap"> <template is="for" items="{{ltPropTableOptions}}" item="item" index="index"> <div class="lyteEditorTableOptions {{item.hidden}}"> <template is="switch" value="{{item.type}}"><template case="number"> <lyte-number lt-prop-min="{{item.min}}" lt-prop-max="{{item.max}}" lt-prop-label="{{item.label}}" lt-prop-placeholder="{{item.placeholder}}" lt-prop-value="{{lbind(item.value)}}" class="{{item.class}}"></lyte-number> <template is="if" value="{{item.subtype}}"><template case="true"> <lyte-dropdown class="{{item.subtype.class}}" lt-prop-selected="{{lbind(item.subtype.value)}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="lyteEditorTableDropbox {{ltPropWrapperClass}}"> <lyte-drop-body> <template is="for" items="{{item.subtype.options}}" item="inneritem" index="index"> <lyte-drop-item class="{{inneritem.class}}" data-value="{{inneritem.system}}">{{inneritem.display}}</lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template></template></template><template case="dropdown"><template is="if" value="{{item.label}}"><template case="true"> <div class="lyteEditorTableDropdownLabel">{{item.label}}</div> </template></template> <lyte-dropdown class="{{item.class}}" lt-prop-selected="{{lbind(item.value)}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="lyteEditorTableDropbox {{ltPropWrapperClass}}"> <lyte-drop-body> <template is="for" items="{{item.options}}" item="inneritem" index="index"> <lyte-drop-item class="{{inneritem.class}}" data-value="{{inneritem.system}}">{{inneritem.display}}</lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template></template> </div> </template> </div> <div class="lyteEditorPanelTableButtons"> <lyte-button class="lyteEditorPanelTableCancelBtn" onclick="{{action(\'table_cancel\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Cancel")}} </template> </lyte-button> <lyte-button lt-prop-appearance="primary" onclick="{{action(\'table_click\')}}"> <template is="registerYield" yield-name="text"> {{lyteUiEditorI18n("Apply")}} </template> </lyte-button> </div> </div> </lyte-popover-content> </template> </lyte-popover> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]}]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]}]}},default:{}},{type:"attr",position:[1,3]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]}]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]}]}},default:{}}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"attr",position:[3,1,1,1]},{type:"for",position:[3,1,1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]}]}]},{type:"text",position:[3,1,3,0]},{type:"text",position:[3,1,3,2]},{type:"attr",position:[3,1,5]},{type:"attr",position:[3,3]},{type:"attr",position:[3,3,1,1]},{type:"for",position:[3,3,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"switch",position:[1,1],cases:{number:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},dropdown:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[2]},{type:"registerYield",position:[2,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[2]}]}},default:{}}]},{type:"attr",position:[3,3,3,1]},{type:"registerYield",position:[3,3,3,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3,3,3,1]},{type:"attr",position:[3,3,3,3]},{type:"registerYield",position:[3,3,3,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3,3,3,3]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1]}]}},default:{}}],_observedAttributes:["ltPropIcons","ltPropEditor","ltPropActiveClass","ltPropTooltipConfig","ltPropTooltipClass","ltPropMoreOptions","ltPropMoreIcon","ltPropDropdown","ltPropPopover","ltPropColorPicker","ltPropMoreOptionsPopover","ltPropMoreOptionsWrapperClass","ltPropSortable","ltPropSortableOptions","ltPropTableOptions","ltPropTabindex","ltPropForcePopScroll","ltPropWrapperClass","ltPropFreeze","ltPropEmojiAsWord","ltPropImageAdvancedOptions","ltPropShowWrapImage","renderingOptions","extraOptions","renderExtraIcon","extraIconClass","moreOptionsShow","isSelected","listRendering","isGrouped","listPopShow","allowListPop","listPanelClass","undef","randomId","editorId","sanitizer","renderTablePop","tableSelect","tableShow","tableData","rowCount","colCount"],data:function(){return{ltPropIcons:Lyte.attr("array",{default:JSON.parse(JSON.stringify(_lyteUiEditor.icons))}),ltPropEditor:Lyte.attr("string",{default:""}),ltPropActiveClass:Lyte.attr("string",{default:"lyteEditorTextFormatSelected"}),ltPropTooltipConfig:Lyte.attr("string",{default:'{"position" : "bottom", "showdelay" : 500}'}),ltPropTooltipClass:Lyte.attr("string",{default:"lyteEditorPanelTooltip"}),ltPropMoreOptions:Lyte.attr("string",{default:_lyteUiEditor.i18n("More options")}),ltPropMoreIcon:Lyte.attr("boolean",{default:!0}),ltPropDropdown:Lyte.attr("string",{default:"{}"}),ltPropPopover:Lyte.attr("string",{default:'{"showCloseButton" : false, "headerPadding" : "", "contentPadding" : "", "footerPadding": "", "scrollable" : true, "focusOnClose" : false }'}),ltPropColorPicker:Lyte.attr("string",{default:"{}"}),ltPropMoreOptionsPopover:Lyte.attr("string",{default:'{"duration":"","allowMultiple":true,"showCloseButton":false,"placement":"topLeft top bottom","type":"callout","scrollable":true}'}),ltPropMoreOptionsWrapperClass:Lyte.attr("string",{default:""}),ltPropSortable:Lyte.attr("boolean",{default:!1}),ltPropSortableOptions:Lyte.attr("object",{default:{}}),ltPropTableOptions:Lyte.attr("array",{default:[{type:"number",purpose:"row",min:1,max:10,label:_lyteUiEditor.i18n("Rows"),placeholder:_lyteUiEditor.i18n("{{0}} to {{1}}",1,10),defaultValue:2,value:2,class:"lyteEditorPanelTableRowInput",render:!0},{type:"number",purpose:"column",min:1,max:10,label:_lyteUiEditor.i18n("Columns"),placeholder:_lyteUiEditor.i18n("{{0}} to {{1}}",1,10),defaultValue:2,value:2,class:"lyteEditorPanelTableColumnInput",render:!0},{type:"number",purpose:"width",min:1,max:1/0,label:_lyteUiEditor.i18n("Width"),placeholder:"0 to 100",defaultValue:100,value:100,class:"lyteEditorPanelTableWidthInput",subtype:{type:"dropdown",options:[{system:"%",display:"%"},{system:"px",display:"px"}],value:"%",defaultValue:"%",class:"lyteEditorPanelTableUnitDropdown"}},{type:"number",purpose:"height",min:1,max:1/0,label:_lyteUiEditor.i18n("Height"),placeholder:"0 to 100",defaultValue:100,value:100,class:"lyteEditorPanelTableHeightInput",subtype:{type:"dropdown",options:[{system:"%",display:"%"},{system:"px",display:"px"}],value:"%",defaultValue:"%",class:"lyteEditorPanelTableUnitDropdown"}},{type:"number",purpose:"borderWidth",min:0,max:20,label:_lyteUiEditor.i18n("Border Size"),placeholder:"0 to 20",defaultValue:1,value:1,class:"lyteEditorPanelTableBorderSizeInput"},{type:"dropdown",purpose:"alignment",value:"none",defaultValue:"none",label:_lyteUiEditor.i18n("Align"),options:[{system:"none",display:_lyteUiEditor.i18n("None")},{system:"left",display:_lyteUiEditor.i18n("Left")},{system:"right",display:_lyteUiEditor.i18n("Right")},{system:"center",display:_lyteUiEditor.i18n("Center")}]}]}),ltPropTabindex:Lyte.attr("string",{default:"-1"}),ltPropForcePopScroll:Lyte.attr("boolean",{default:!1}),ltPropWrapperClass:Lyte.attr("string",{default:""}),ltPropFreeze:Lyte.attr("boolean",{default:!1}),ltPropEmojiAsWord:Lyte.attr("boolean",{default:!1}),ltPropImageAdvancedOptions:Lyte.attr("array",{default:[{label:"Alternate Text",class:"lyteEditorPanelImageAltInput",subItems:[{prop:{placeholder:"Enter alternate text for image",appearance:"box"},type:"input",purpose:"alt",value:""}]},{label:"Transform",class:"lyteEditorPanelImageTransformGroup",subItems:[{label:"Width",type:"number",purpose:"width",unit:"px",class:"lyteEditorPanelImageWidthInput",prop:{placeholder:""}},{label:"Height",type:"number",purpose:"height",class:"lyteEditorPanelImageHeightInput",unit:"px",prop:{placeholder:""}},{type:"dropdown",purpose:"unit",prop:{},userValue:"name",systemValue:"value",options:[{name:"px",value:"px"},{name:"%",value:"%"}]},{label:"Keep aspect ratio",class:"lyteEditorPanelImageAspectRatio",type:"checkBox",purpose:"maintainAspectRatio",prop:{type:"primary",name:"maintainAspectRatio",value:"maintainAspectRatio"}},{label:"Horizontal",type:"number",purpose:"horizontal",unit:"px",prop:{placeholder:""}},{label:"Vertical",type:"number",purpose:"vertical",unit:"px",prop:{placeholder:""}},{label:"Border",type:"number",purpose:"border",unit:"px",prop:{placeholder:""}}]},{label:"Alignment",class:"lyteEditorPanelImageAlignGroup",subItems:[{type:"radioButtonGroup",prop:{name:"group"},purpose:"align",userValue:"name",systemValue:"value",selected:{},options:[{name:"Left",value:"left"},{name:"Right",value:"right"},{name:"Center",value:"middle"},{name:"Top",value:"top"},{name:"Bottom",value:"bottom"}]}]}]}),ltPropShowWrapImage:Lyte.attr("boolean",{default:!1}),renderingOptions:Lyte.attr("array",{default:[]}),extraOptions:Lyte.attr("array",{default:[]}),renderExtraIcon:Lyte.attr("boolean",{default:!1}),extraIconClass:Lyte.attr("string",{default:""}),moreOptionsShow:Lyte.attr("boolean",{default:!1}),isSelected:Lyte.attr("boolean",{default:!1}),listRendering:Lyte.attr("object",{default:{}}),isGrouped:Lyte.attr("boolean",{default:!1}),listPopShow:Lyte.attr("boolean",{default:!1}),allowListPop:Lyte.attr("boolean",{default:!1}),listPanelClass:Lyte.attr("string",{default:""}),undef:Lyte.attr("string",{default:void 0}),randomId:Lyte.attr("string",{default:""}),editorId:Lyte.attr("string",{default:"lyteEditorPanel"+parseInt(1e5*Math.random())}),sanitizer:Lyte.attr("object",{default:{attr:Lyte.Security.createSanitizer({GLOBAL_TAGS:["mention_div"],GLOBAL_ATTRIBUTES:["editable","module","editor-language"],ADD_URI_SAFE_ATTR:["style"],ALLOWED_STYLE:"ALL",STYLE_VALIDATION:!1})}}),renderTablePop:Lyte.attr("boolean",{default:!1}),tableSelect:Lyte.attr("boolean",{default:!1}),tableShow:Lyte.attr("boolean",{default:!1}),tableData:Lyte.attr("array",{default:[]}),rowCount:Lyte.attr("number"),colCount:Lyte.attr("number")}},didConnect:function(){var t=this,e=t.data,i="afterRender",a=t.$node;(t.editor=$L(e.ltPropEditor).get(0)).panel=t,a.refresh=function(){this.updateIconBarRange();var t=this.getThis().data;this.undoRedo(t.undoqueue,t.redoqueue)}.bind(t),e.ltPropMoreIcon?(a.checkWidth=t.check_availability.bind(t),t.check_availability()):(t.setData({renderingOptions:e.ltPropIcons,extraIconClass:"lyteEditorpanelHide"}),e.ltPropSortable&&t.bind_sort()),t.getMethods(i)&&t.executeMethod(i,a),window.requestAnimationFrame(function(){!this.__called&&a.refresh()}.bind(this))},bind_sort:function(){var t,e=this,i=e.data,a=i.isGrouped,o={},n=$L(e.$node).children(".lyteEditorIconsDiv"),r=Lyte.arrayUtils,s=function(t,i,a){var o=r(a||t,"removeAt",i[3]),n="onSortDrop",s=i[4],l=i[1];r(t,"insertAt",s,o),l.addToSortable(l.children[s]),e.getMethods(n)&&((i=Array.from(i)).unshift(n),e.executeMethod.apply(e,i))},l=i.ltPropIcons;a?(n=n.children(".LyteEditorFormatSection"),t=function(t,e){var i=arguments;s(l[e.getAttribute("index")].subIcons,i,l[i[5].getAttribute("index")].subIcons)}):(o.restrict=".lyteEditorMoreOptions,lyte-popover",t=function(){s(l,arguments)}),o.onDrop=t.bind(this),o.onBeforeDrop=function(){var t="onBeforeSortDrop";if(e.getMethods(t)){var i=Array.from(arguments);return i.unshift(t),e.executeMethod.apply(e,i)}},n.sortable($L.extend(o,i.ltPropSortableOptions))},remove_sort:function(){var t=$L(this.$node).children(".lyteEditorIconsDiv");this.data.isGrouped&&(t=t.children(".LyteEditorFormatSection")),t.sortable("destroy")},__bind_sort:function(t){t.newValue?this.bind_sort():this.remove_sort()}.observes("ltPropSortable"),check_availability:function(t){var e=this;e.setData("moreOptionsShow",!1),clearTimeout(e._rendertime),e._rendertime=setTimeout((function(){var t=e.data.ltPropIcons,i=$L.fastdom,a="renderingOptions",o=0,n=Array.from(e.$node.children).filter((function(t){return $L(t).hasClass("lyteEditorIconsDiv")}))[0],r="extraIconClass";e.setData(a,t),e.setData(r,""),i.clear(e._fdm),e._fdm=i.measure((function(){var s=0,l=function(t){var e=t.offsetWidth,i=window.getComputedStyle(t),a=parseFloat(i.marginLeft)+parseFloat(i.marginRight);return o+=a+e},d=n.getElementsByClassName("lyteEditorMoreOptions")[0],c=e.$node.offsetWidth-l(d);o=0,t.every((function(t,e){var i=n.children[e];return!(l(i)>c)&&(s=++e,!0)})),i.mutate((function(){e.setData(a,t.slice(0,s));var i=t.slice(s),o="";i.length?(e.setData("extraOptions",i),e.setData("renderExtraIcon",!0)):o="lyteEditorpanelHide",e.setData(r,o),e.data.ltPropSortable&&e.bind_sort()}))}))}),0)},listObs:function(){var t=this.data.ltPropIcons,e=!1,i=t[0]||{};this.setData("isGrouped",!!i.subIcons),t.every((function(t){return(t.subIcons||[t]).every((function(t){return!(e="list"==t.type)})),!e})),this.setData("allowListPop",e)}.observes("ltPropIcons").on("init"),initObs:function(){this.getMethods("beforeRender")&&this.executeMethod("beforeRender",this.$node)}.on("init"),didDestroy:function(){delete this.editor.panel,delete this.editor,$L.fastdom.clear(this._fdm),clearTimeout(this._rendertime)},callBeforeClick:function(t,e,i){if(this.getMethods("onBeforeClick"))return 0==this.executeMethod("onBeforeClick",t,e,i,this.$none)},callClick:function(t,e,i){if(this.getMethods("onClick"))return this.executeMethod("onClick",t,e,i,this.$node)},processArg:function(t){var e=$L.extend(!0,[],t.arguments||[]),i=t.selected||"",a=t.removeClass;if(null!=i){var o=e.indexOf("{{selected}}");o+1&&(/^([0-9]+)$/.test(i)&&(i=parseInt(i)),e.splice(o,1,i))}return a&&(e[3]=a),e},callFn:function(t){var e=this.getThis();return e[t.functionName].apply(e,this.processArg(t))||{applied:[],toApply:[]}},clickAction:function(t,e,i){if(this.callBeforeClick(t,e,i))return!1;var a=this.getThis(),o=!0,n=this,r=window;if(!a.isCodeEditor($L(a.data.currentNode.parentElement).data("data")))switch(t.type){case"switch":case"undo":if(t.active&&/^(undo|redo|clear)$/i.test(t.name))return;this.callFn(t);break;case"colorpicker":this.colorpicker(e.target);break;case"anchor":if(t.active)return;this.anchorIconClick.call(a,e.target),o=!1;break;case"list":var s=this.data.randomId,l=$L(e.target).closest(".lyteEditorTextFormatIcons",this.$none);if(s||this.setData("randomId",s=this.getThis().randomId()),l.hasClass(s))return void this.setData("listPopShow",!0);$L("."+s).removeClass(s),l.addClass(s),this.setData("listPanelClass",t.name?"lyteList"+t.name+"IconsWrap":""),window.requestAnimationFrame((function(){r.requestAnimationFrame((function(){n.setData("listRendering",t),n.setData("listPopShow",!0)}))}));break;case"emoji":Lyte.objectUtils(t,"add","active",!0);break;case"table":this.table_click(t);break;case"image":this.colorpicker(e.target,"lyte-modal");break;case"codeEditor":$L(e.target).find("lyte-modal").get(0).ltProp("show",!0);break;case"insertHTML":e.target.ltProp("previewContent",a.$node.getHTML(!0,!0)),$L(e.target).find("lyte-modal").get(0).ltProp("show",!0)}o&&a.$node.focus(),this.callClick(t,e,i)},table_render_obs:function(){var t,e,i=[];this.data.ltPropTableOptions.forEach((function(i){var a=i.purpose;/row/i.test(a)?t=i.max:/column/i.test(a)&&(e=i.max)}));for(var a=0;a<t;a++){for(var o=[],n=0;n<e;n++)o.push({class:""});i.push(o)}this.setData("tableData",i),this.modify_selection()}.observes("renderTablePop"),modify_selection:function(){var t=this.data,e=t.tableData,i=t.rowCount,a=t.colCount,o=Lyte.objectUtils;e.forEach((function(t,e){t.forEach((function(t,n){var r="lyteEditorColumn";e<i&&n<a&&(r+=" lyteEditorCellSelected"),o(t,"add","class",r)}))}))},table_click:function(t){this.setData("renderTablePop",!0),this.setData("tableShow",!0)},list_obs:function(t){var e="removeClass",i=t.newValue;i&&(e="addClass"),$L("."+this.data.randomId)[e]("lyteEditorPanelListPopOpened"),this["call_"+(i?"show":"hide")]()}.observes("listPopShow"),close_all_pop:function(){this.data.extraOptions.forEach((function(t){t&&t.subIcons.forEach((function(t){"emoji"==t.name&&Lyte.objectUtils(t,"add","active",!1)}))})),this.setData("listPopShow",!1);var t=this.getThis()._popover;t&&t.ltProp("show",!1)},methods:{moreBeforeClose:function(t){$L((t||{}).target).hasClass("lyteEditorMoreOptions")&&(this._ignore_click=!0),this.close_all_pop()},emojiClose:function(t,e){let i="onBeforeEmojiClose";if(this.getMethods(i))return this.executeMethod(i,t,e)},onBeforeImageUpload:function(){}},count_obs:function(){clearTimeout(this.__rowobs),this.__rowobs=setTimeout(function(){this.modify_selection()}.bind(this),0)}.observes("rowCount","colCount"),tableShow_obs:function(t){var e="call_show";t.newValue||(this.reset_table(),this.setData("tableSelect",!1),e="call_hide"),this[e]()}.observes("tableShow"),call_show:function(t){var e="onShow",i=this.getThis();t||i.setData("isPanelOpen",!0),this.getMethods(e)&&this.executeMethod(e,this.$node)},call_hide:function(t){var e="onHide",i=this.getThis();t||i.setData("isPanelOpen",!1),this.data.moreOptionsShow||this.getMethods(e)&&this.executeMethod(e,this.$node)},more_obs:function(t){this["call_"+(t.newValue?"show":"hide")](!0)}.observes("moreOptionsShow"),select_color:function(t,e,i){var a,o=this.getThis();i||(e.hex=o.data.ltPropWordStyle[t.arguments[0]]),e.nofill&&(e.hex=o.data.ltPropWordStyle[t.arguments[0]]||"#FFFFFF"),a=e.nofill?e.hex?this.getRequiredColorFormat(e.hex):"unset":e.rgba||(e.hex?this.getRequiredColorFormat(e.hex):"unset"),Lyte.objectUtils(t,"add","selected",a),this.callFn(t),o.$node.focus(),this.callClick(t,i)},getRequiredColorFormat:function(t,e){var i,a,o,n=document.createElement("canvas").getContext("2d");n.fillStyle=t.toLowerCase();var r=n.fillStyle;if(i=parseInt(r.substring(1,3),16),a=parseInt(r.substring(3,5),16),o=parseInt(r.substring(5,7),16),9==r.length){parseInt(r.substring(7,9),16)}return"rgb("+i+","+a+","+o+")"},actions:{elementOpen:function(){this.call_show()},elementBeforeOpen:function(){var t="onBeforeShow";this.getMethods(t)&&this.executeMethod(t,this.$node)},elementClose:function(t,e,i){if(this.call_hide(),i){var a=i.data;a.ltPropBasicColorPicker||this.select_color(t,a.ltPropSelectedColor,e)}},insertImage:function(t,e,i){var a=function(t){let a=this.getThis();a.data.wrapImage=Boolean(i),a.data.ltPropInlineImage&&!e?a.$node.insertHTML(t,!0):e?a.replaceImage(t,e):(this.getThis().$node.insertHTML(t,!0),this.callClick({},{}))}.bind(this);if(this.getMethods("onImageInsert")){var o=this.executeMethod("onImageInsert",this.$node,t);o&&o.then?o.then(function(t){a(t)}.bind(this)):!1!==o&&a(t)}else a(t)},insertCodeText:function(t,e){this.getThis().insertCodeText(t,e)},insertHTML:function(t){this.getThis().$node.insertHTML(t)},getCurrentParaClient:function(t){t.client=this.getThis().getCurrentParaClient()},showmore:function(t){if("keydown"!=t.type||32==t.keyCode||13==t.keyCode){"keydown"==t.type&&t.preventDefault();var e="_ignore_click";this[e]?delete this[e]:this.setData("moreOptionsShow",!0)}},emojiselect:function(t,e){var i=this.getThis().$node;this.data.ltPropEmojiAsWord?i.insertHTML(e.encode):i.insertTextInWord(e.value),Lyte.objectUtils(t,"add","active",!1),i.focus(),this.callClick(t,{})},dropItemSelected:function(t){this.callFn(t),this.getThis().$node.focus(),this.callClick(t,{})},colorPickerSelect:function(t,e,i,a){a.getData("ltPropBasicColorPicker")&&(a.$node.ltProp("show",!1),this.select_color(t,i,e))},iconClick:function(t,e){this.clickAction(t,e)},listClick:function(t,e,i){this.setData("listPopShow",!1),this.clickAction(t,e,i)},table_enter:function(t,e){this.setData({rowCount:t+1,colCount:e+1})},table_click:function(t,e){this.insert_table(t+1,e+1),this.setData("tableShow",!1),this.callClick({},{})},table_cancel:function(){this.setData("tableShow",!1)},columnSwitch:function(){this.reset_table(),this.setData("tableSelect",!0)}},colorpicker:function(t,e){$L(t).find(e||"lyte-colorpicker").get(0).ltProp("show",!0)},anchorIconClick:function(t){var e,i="popOrigin"+this.data.randomId,a="",o=this.data.range.isRange,n=function(){return this.convert_html_to_txt(this.getSelectedText()).replace(/\n/g,"")}.bind(this);if(o)e=n();else{var r=this.data.selectedWords,s=r.filter((function(t){if($L(t.node).data("data").details.anchor)return!0}));s.length>1||r.length>s.length?e="":1==s.length&&(e=n(),a=$L(s[0].node).data("data").details.anchor.href),this.setData("userInput","")}Lyte.objectUtils(this.data.anchorEdit,"add","text",e),Lyte.objectUtils(this.data.anchorEdit,"add","href",a),Lyte.objectUtils(this.data.anchorEdit,"add","newWindow",!0),Lyte.objectUtils(this.data.anchorEdit,"add","mailId",""),Lyte.objectUtils(this.data.anchorEdit,"add","mailSubject",""),Lyte.objectUtils(this.data.anchorEdit,"add","title",""),Lyte.objectUtils(this.data.anchorEdit,"add","telephone",""),this.setData("userInput",e),this.setData("isEditLink",!1),$L("."+i).removeClass(i),$L(t).addClass(i),this._popover.ltProp("show",!0)},activeCheck:function(t){var e=this.callFn(t);return e.applied.length>e.toApply.length},indivUpdate:function(t){if(!t.ignore){var e=t.type||"switch",i=this.getThis();switch(e){case"custom":Lyte.objectUtils(t,"add","active",!!this.callCustomIconUpdate(t));break;case"switch":case"colorpicker":var a=this.activeCheck(t);if(/^colorpicker$/i.test(e))Lyte.objectUtils(t,"add","selected",i.data.currentNode.style[t.arguments[0]]);else if(/^textIndentIncrease$/i.test(t.name)){let e=this.activeCheck(t);Lyte.objectUtils(t,"add","active",e)}else if(/^textIndentDecrease$/i.test(t.name)){let e=this.activeCheck(t);Lyte.objectUtils(t,"add","active",e)}else Lyte.objectUtils(t,"add","active",a);break;case"dropdown":var o,n=t.value,r=(t.selected,t.selected);if(n.every(function(e){return t.selected=e,!e||!this.activeCheck(t)||(o=e,!1)}.bind(this)),t.selected=r,!o&&/^fontSize|lineHeight$/i.test(t.name)){var s,l="";if("fontSize"==t.name){var d=i.getProp("fontSize",i.data.currentNode),c=this.get_unit(d);l=this.get_unit(t.value[0]||""),h=this.convert_to_unit(c,l,d),s=i.getIndex(t.value,h+l)}else if("lineHeight"==t.name){var p=i.data.currentNode.parentNode,h=i.getProp("lineHeight",p);if(/px$/i.test(h)){var u=i.getProp("fontSize",p);h=parseFloat(h)/parseFloat(u),l="px"}s=i.getIndex(t.value,h+l)}o=h+l,this.remove_fake(t,h),-1==s&&this.push_extra_value(t,h,l)}Lyte.objectUtils(t,"add","selected",o||""),Lyte.objectUtils(t,"add","active",!!o);break;case"list":var m=t.list,f=!1;m.forEach(function(t){this.indivUpdate(t),f=f||t.active}.bind(this)),Lyte.objectUtils(t,"add","active",f);break;case"anchor":var g=i.data.selectedWords,y=!1;if(i.data.ltPropDisableAnchorInMentions)for(let t=0;t<g.length;t++)if(g[t].node.classList.contains("lyteEditorMentionWord")){y=!0;break}Lyte.objectUtils(t,"add","active",1==g.length&&$L(g[0].node).hasClass("lyteEditorAnchor")||y)}}},remove_fake:function(t,e){for(var i=t.fake||[],a=t.display,o=t.value,n=i.length,r=function(t,e){Lyte.arrayUtils(t,"removeAt",e)},s=0;s<n;s++){var l=i[s];if(l!=e){var d=a.indexOf(l);r(o,d),r(a,d),i.splice(s--,1),n--}}},push_extra_value:function(t,e,i){var a=t.display,o=t.value,n=1,r=t.fake,s=function(t,e){Lyte.arrayUtils(t,"insertAt",n,e)};r||(r=t.fake=[]),-1==r.indexOf(e)&&(a.every((function(t){return Number(t)<e&&n++})),--n,s(o,e+i),s(a,e),r.push(e))},get_unit:function(t){return t.match(/px|pt|cm|mm|in/i)[0]},convert_to_unit:function(t,e,i){var a={px:1,pt:1.3281472327365,in:96,cm:37.795275591,mm:3.7795275591},o=a[e];return a[t]*Number(i.replace(/px|pt|cm|mm|in/,""))/o},updateIconBarRange:function(){this.__called=!0;var t=this.data.ltPropIcons,e=this.getThis(),i=e.data.range;e.iconUpdate(),t.forEach(function(t){(t.subIcons||[t]).forEach(this.indivUpdate.bind(this))}.bind(this)),this.callUpdate(),e.removeIconUpdate(),$L(this.$node)[i.isRange?"addClass":"removeClass"]("lyteEditorTextSelected"),this.setData("isSelected",i.isRange)},callCustomIconUpdate:function(t){if(this.getMethods("onCustomIconUpdate")){var e=this.getThis().data;return this.executeMethod("onCustomIconUpdate",t,this.$node,this.editor,e.currentNode,e.cursor,e.range,e.range.isRange)}},callUpdate:function(){this.getMethods("onIconbarUpdate")&&this.executeMethod("onIconbarUpdate",this.$node,this.editor)},getThis:function(){return this.editor.component},undoRedo:function(t,e){this.data.ltPropIcons.forEach((function(i){(i.subIcons||[i]).forEach((function(i){"undo"==i.type&&Lyte.objectUtils(i,"add","active","undo"==i.name?!t.length:!e.length)}))}))},disableAll:function(t){this.data.ltPropIcons.forEach((function(e){e.subIcons?e.subIcons.forEach((function(e){(t&&e.disabled||!t&&!e.disabled)&&Lyte.objectUtils(e,"add","disabled",!t)})):(t&&e.disabled||!t&&!e.disabled)&&Lyte.objectUtils(e,"add","disabled",!t)}))},reset_table:function(t){(t||this.data.ltPropTableOptions).forEach(function(t){var e=t.subtype;Lyte.objectUtils(t,"add","value",t.defaultValue),e&&this.reset_table([e])}.bind(this)),t&&this.setData({rowCount:0,colCount:0})},insert_table:function(t,e){var i={};this.data.ltPropTableOptions.forEach((function(t){var e=t.subtype,a=t.value;e&&(a+=e.value),i[t.purpose]=a})),this.getThis().table(t,e,i)}}),Lyte.Component.register("lyte-texteditor",{_template:'<template tag-name="lyte-texteditor" onclick="{{action(\'click\',event)}}"> <div class="lyteEditorContentEditable" tabindex="{{ltPropTabindex}}" contenteditable="{{isEditable}}" oncompositionstart="{{action(\'compositionStart\',event)}}" oncompositionupdate="{{action(\'compositionUpdate\',event)}}" oncompositionend="{{action(\'compositionEnd\',event)}}" oninput="{{action(\'input\',event,this)}}" onfocus="{{action(\'focus\',event)}}" onblur="{{action(\'blur\',event)}}" onkeydown="{{action(\'keydown\',event,this)}}" onpaste="{{action(\'paste\',event,this)}}" oncut="{{action(\'cut\',event)}}" oncopy="{{action(\'copy\',event)}}"></div> <canvas></canvas> <div class="lyteEditorMainDiv" contenteditable="{{ltPropBluePencil}}" tabindex="-1" onmousedown="{{action(\'mousedown\',event,this)}}" ontouchstart="{{action(\'mousedown\',event,this)}}" onkeydown="{{action(\'mainKey\',event,this)}}" oninput="{{action(\'mainInput\',event,this)}}" onfocus="{{action(\'focus\',event)}}" onblur="{{action(\'blur\',event)}}" onpaste="{{action(\'mainPaste\',event)}}" oncut="{{action(\'cut\',event)}}" oncopy="{{action(\'copy\',event)}}" onclick="{{action(\'mainClick\')}}"></div> <template is="if" value="{{expHandlers(isMac,\'||\',renderFrame)}}"><template case="true"> <iframe class="lyteEditorContentEditable" onload="{{action(\'frameLoad\',this)}}" tabindex="-1"></iframe> </template></template><template is="if" value="{{navCheck}}"><template case="true"> <div class="lyteEditorNavigationElement lyteEditorMainDiv" contenteditable="true"></div> </template></template> <lyte-modal lt-prop-show="{{lbind(ltPropFindShow)}}" lt-prop-id="findModal" id="findModal" lt-prop-freeze="false" lt-prop-width="300px" on-close="{{method(\'removeHighlight\')}}" lt-prop-offset="{&quot;top&quot;:&quot;0px&quot;,&quot;right&quot;:&quot;0px&quot;}"> <template is="registerYield" yield-name="modal"> <lyte-input lt-prop-appearance="box" lt-prop-id="findInput" on-value-change="{{method(\'onDataChange\',ltPropWordStyle)}}" lt-prop-placeholder="find" lt-prop-value="{{lbind(findInput)}}"> </lyte-input> <span class="lyteUiEditorFindUpArrow" lt-prop-id="up-arrow" onclick="{{action(\'upArrow\')}}"></span> <span class="lyteUiEditorFindDownArrow" lt-prop-id="down-arrow" onclick="{{action(\'downArrow\')}}"></span> <lyte-input lt-prop-appearance="box" lt-prop-id="replaceInput" lt-prop-placeholder="replace" lt-prop-value="{{lbind(replaceInput)}}"></lyte-input> <template is="if" value="{{expHandlers(expHandlers(findInput,\'!=\',&quot;&quot;),\'&amp;&amp;\',expHandlers(currentHighlight,\'!=\',undefined))}}"><template case="true"> <span class="lyte-find-count">{{expHandlers(currentHighlight,\'+\',1)}}/{{selectedRange.length}}</span> </template><template case="false"><template is="if" value="{{findInput}}"><template case="true"> <span class="lyte-find-count">0/0</span> </template></template></template></template> <lyte-button lt-prop-appearance="primary" lt-prop-id="replaceButton" onclick="{{action(\'replaceText\')}}"> <template is="registerYield" yield-name="text"> REPLACE </template> </lyte-button> <lyte-button lt-prop-appearance="primary" lt-prop-id="replaceAllButton" onclick="{{action(\'replaceAllText\')}}"> <template is="registerYield" yield-name="text"> REPLACE ALL </template> </lyte-button> </template> </lyte-modal> <lyte-popover lt-prop-focus-on-close="true" lt-prop-content-padding="" lt-prop-show-close-button="false" class="lyteEditorPopoverLink" lt-prop-scrollable="true" lt-prop-duration="{{undef}}" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-wrapper-class="lyteEditorPopover {{ltPropWrapperClass}}" lt-prop-show="{{lbind(anchorShow)}}" lt-prop-prevent-focus="true" lt-prop-boundary="{{ltPropAnchorPopBoundary}}" lt-prop-force-scroll="{{ltPropForcePopScroll}}" on-show="{{method(\'anchorShow\')}}" on-close="{{method(\'anchorClose\')}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="{{anchorPopClass}}"> <template is="if" value="{{expHandlers(ltPropAnchorAdvancedOption.showMail,\'||\',ltPropAnchorAdvancedOption.showTel)}}"><template case="true"> <div class="lyteEditorLinkType"> <lyte-radiobutton lt-prop-type="primary" lt-prop-checked="{{lbind(linkChecked)}}" lt-prop-name="primary" lt-prop-value="1" lt-prop-label="{{lyteUiEditorI18n(\'Link\')}}" on-checked="{{method(\'linkCheckBoxClick\',\'link\')}}"></lyte-radiobutton> <template is="if" value="{{ltPropAnchorAdvancedOption.showMail}}"><template case="true"> <lyte-radiobutton lt-prop-type="primary" lt-prop-name="primary" lt-prop-checked="{{lbind(emailChecked)}}" lt-prop-value="2" lt-prop-label="{{lyteUiEditorI18n(\'Email\')}}" on-checked="{{method(\'linkCheckBoxClick\',\'email\')}}"></lyte-radiobutton> </template></template> <template is="if" value="{{ltPropAnchorAdvancedOption.showTel}}"><template case="true"> <lyte-radiobutton lt-prop-type="primary" lt-prop-name="primary" lt-prop-checked="{{lbind(telephoneChecked)}}" lt-prop-value="3" lt-prop-label="{{lyteUiEditorI18n(\'Telephone\')}}" on-checked="{{method(\'linkCheckBoxClick\',\'telephone\')}}"></lyte-radiobutton> </template></template> </div> </template></template> <div class="lyteEditorLinkCreatePopup"> <div class="lyteEditorLinkTextInput lyteEditorLinkRow"> <span class="lyteEditorLinkTextLabel lyteEditorLinkLabel">{{lyteUiEditorI18n("Text")}}:</span> <template is="if" value="{{expHandlers(ltPropAnchorTextEdit,\'!\')}}"><template case="true"> <lyte-text class="lyteEditorLinkDisplayValue" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" lt-prop-value="{{anchorEdit.text}}"></lyte-text> </template></template> <lyte-input class="lyteEditorLinkUserInput" lt-prop-appearance="box" lt-prop-direction="horizontal" lt-prop-value="{{lbind(userInput)}}" lt-prop-update-delay="{{undef}}" onkeydown="{{action(\'check_key\',event)}}"></lyte-input> </div> <template is="if" value="{{expHandlers(currentAnchorType,\'==\',\'link\')}}"><template case="true"> <div class="lyteEditorLinkURLInputWrapper lyteEditorLinkRow"> <span class="lyteEditorLinkTextLabel lyteEditorLinkLabel">{{ltPropText.link}}:</span> <lyte-input class="lyteEditorLinkURLInput" lt-prop-appearance="box" lt-prop-direction="horizontal" lt-prop-value="{{lbind(anchorEdit.href)}}" lt-prop-update-delay="{{undef}}" lt-prop-focus="{{lbind(inputFocus)}}" lt-prop-focus-at-end="true" onkeydown="{{action(\'check_key\',event)}}"></lyte-input> </div> </template><template case="false"><template is="if" value="{{expHandlers(currentAnchorType,\'==\',\'email\')}}"><template case="true"> <div class="lyteEditorEmailId lyteEditorLinkRow"> <span class="lyteEditorMailIdLabel lyteEditorLinkLabel">{{lyteUiEditorI18n(\'Mail\')}}:</span> <lyte-input class="lyteEditorMailIdInput" lt-prop-appearance="box" lt-prop-direction="horizontal" lt-prop-value="{{lbind(anchorEdit.mailId)}}" lt-prop-update-delay="{{undef}}"></lyte-input> </div> <div class="lyteEditorEmailSubject lyteEditorLinkRow"> <span class="lyteEditorEmailSubjectLabel lyteEditorLinkLabel">{{lyteUiEditorI18n(\'Subject\')}}:</span> <lyte-input class="lyteEditorEmailSubjectInput" lt-prop-appearance="box" lt-prop-direction="horizontal" lt-prop-value="{{lbind(anchorEdit.mailSubject)}}" lt-prop-update-delay="{{undef}}"></lyte-input> </div> </template><template case="false"><template is="if" value="{{expHandlers(currentAnchorType,\'==\',\'telephone\')}}"><template case="true"> <div class="lyteEditorTelphone lyteEditorLinkRow"> <span class="lyteEditorTelphoneNumber lyteEditorLinkLabel">{{lyteUiEditorI18n(\'Telephone\')}}:</span> <lyte-input class="lyteEditorTelphoneNumberInput" lt-prop-appearance="box" lt-prop-direction="horizontal" lt-prop-value="{{lbind(anchorEdit.telephone)}}" lt-prop-update-delay="{{undef}}"></lyte-input> </div> </template></template></template></template></template></template> <template is="if" value="{{ltPropAnchorAdvancedOption.showTitle}}"><template case="true"> <div class="lyteEditorAnchorTittle lyteEditorLinkRow"> <span class="lyteEditorAnchorTittleLabel lyteEditorLinkLabel">{{lyteUiEditorI18n(\'Title\')}}:</span> <lyte-input class="lyteEditorAnchorTittleInput" lt-prop-appearance="box" lt-prop-direction="horizontal" lt-prop-value="{{lbind(anchorEdit.title)}}" lt-prop-update-delay="{{undef}}"></lyte-input> </div> </template></template> <lyte-yield yield-name="anchor-popover"></lyte-yield> <div class="lyteEditorFormWrapper"> <template is="if" value="{{expHandlers(ltPropCheckbox.prevent,\'!\')}}"><template case="true"><lyte-checkbox class="lyteEditorAnchorCheckbox" lt-prop="{{stringify(ltPropCheckbox)}}" lt-prop-checked="{{lbind(anchorEdit.newWindow)}}"></lyte-checkbox></template></template> <lyte-button lt-prop="{{ltPropButtonStyle}}" lt-prop-appearance="primary" onclick="{{action(\'applyLink\')}}" lt-prop-disabled="{{buttonDisable}}"> <template is="registerYield" yield-name="text"> {{ltPropText.link}} </template> </lyte-button> </div> </div> <div class="lyteEditorLinkViewPopup lyteEditorOldLink"> <div class="lyteEditorLinkTextInput lyteEditorLinkRow"> <span class="lyteEditorLinkTextLabel lyteEditorLinkLabel">{{lyteUiEditorI18n("Text")}}:</span> <lyte-text lt-prop-value="{{anchorEdit.text}}"></lyte-text> </div> <div class="lyteEditorLinkValueView lyteEditorLinkRow"> <span class="lyteEditorLinkTextLabel lyteEditorLinkLabel">{{ltPropText.link}}:</span> <a class="lyteEditorHrefClass" target="{{if(anchorEdit.newWindow,\'_blank\',\'_self\')}}" href="{{anchorEdit.href}}" onclick="{{action(\'anchorClick\',event)}}">{{anchorEdit.href}}</a> </div> <div class="lyteEditorLinkButtonWrap"> <lyte-button class="lyteEditorEditIcon" onclick="{{action(\'editLink\')}}" lt-prop="{{ltPropButtonStyle}}"> <template is="registerYield" yield-name="text"> {{ltPropText.edit}} </template> </lyte-button> <lyte-button class="lyteEditorRemoveIcon" onclick="{{action(\'removeWord\')}}" lt-prop="{{ltPropButtonStyle}}"> <template is="registerYield" yield-name="text"> {{ltPropText.remove}} </template> </lyte-button> </div> </div> </lyte-popover-content> </template> </lyte-popover> <template is="if" value="{{isMobile}}"><template case="true"> <lyte-popover class="lyteEditorMobileOptions" lt-prop-focus-on-close="true" lt-prop-content-padding="" lt-prop-duration="{{undef}}" lt-prop-placement="top topLeft topRight bottom" lt-prop-type="box" lt-prop-freeze="{{ltPropFreeze}}" lt-prop-wrapper-class="lyteEditorMobileOptionsPopover {{if(isTextSelected,\'textSelected\',\'\')}} {{ltPropWrapperClass}}" lt-prop-offset="{{mobileOffset}}" lt-prop-show-close-button="false" lt-prop-prevent-focus="true"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <ul class="lyteEditorMobileOptionsUl"> <template is="for" items="{{ltPropMobileOptions}}" item="item" index="index"> <li class="lyteEditorMobileOptionsList {{item}}" onclick="{{action(\'mobileClick\',item)}}">{{ltPropText[item]}}</li> </template> </ul> </lyte-popover-content> </template> </lyte-popover> </template></template> <template is="if" value="{{ltPropTriggerCharacter}}"><template case="true"> <div class="lyteEditorMentionDropbox lyteEditorHide {{ltPropWrapperClass}}" onscroll="{{action(\'scroll\')}}"> <template is="for" items="{{triggersArray}}" item="item" index="index"> <lyte-editor-mention-item onclick="{{action(\'itemClick\',item,event,this)}}" class="{{if(item.group,\'lyteMentionsSubMenuContainer\')}} {{item.class}}" onmouseenter="{{action(\'mouseenter\',event,this)}}"> <template is="if" value="{{item.avatar}}"><template case="true"> <img class="lyteEditorMentionAvatar" src="{{item.avatar}}"> </template></template> <span class="lyteEditorMentionName" data-value="{{item.id}}">{{unescape(lyteUiEditorHighlight(item.name,searchValue))}}</span> <template is="if" value="{{item.email}}"><template case="true"> <span class="lyteEditorMentionEmail" data-value="{{item.id}}">{{unescape(lyteUiEditorHighlight(item.email,searchValue))}}</span> </template></template> </lyte-editor-mention-item> </template> </div> </template></template> <template is="if" value="{{ltPropMentionsSubMenu}}"><template case="true"> <lyte-menu lt-prop-freeze="false" class="lyteEditorMentionsSubMenu" lt-prop-event="click" lt-prop-position="right" lt-prop-yield="true" lt-prop-callout="true" lt-prop-query=".lyteMentionsSubMenuContainer"> <template is="registerYield" yield-name="yield"> <lyte-menu-body class="someClass"> <template is="for" items="{{mentionsGroup}}" item="item" index="index"> <lyte-menu-item data-value="{{item.name}}" onclick="{{action(\'itemClick\',item,event,this)}}" class="{{if(item.group,\'lyteMentionsSubMenuContainer\')}} {{item.class}}" onmouseenter="{{action(\'mouseenter\',event,this)}}"> <template is="if" value="{{item.avatar}}"><template case="true"> <img class="lyteEditorMentionAvatar" src="{{item.avatar}}"> </template></template> <span class="lyteEditorMentionName" data-value="{{item.id}}">{{unescape(lyteUiEditorHighlight(item.name,searchValue))}}</span> <template is="if" value="{{item.email}}"><template case="true"> <span class="lyteEditorMentionEmail" data-value="{{item.id}}">{{unescape(lyteUiEditorHighlight(item.email,searchValue))}}</span> </template></template> </lyte-menu-item> </template> </lyte-menu-body> </template> </lyte-menu> </template></template> <template is="if" value="{{ltPropPasteHandling}}"><template case="true"> <div class="lyteTextEditorPasteHandling lyteEditorHide lytePaste{{randomId}}"> <div class="lyteTextEditorPasteIcon"></div> <lyte-icon class="dropdown"></lyte-icon> </div> <lyte-menu lt-prop-yield="true" lt-prop-wrapper-class="lyteTextEditorPasteMenu {{ltPropWrapperClass}}" lt-prop-query=".lytePaste{{randomId}}" lt-prop-callout="false" on-before-close="{{method(\'beforeCloseMenu\')}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body> <lyte-menu-item onclick="{{action(\'pasteHandling\',\'source\')}}">{{lyteUiEditorI18n("Keep source formatting")}}</lyte-menu-item> <lyte-menu-item onclick="{{action(\'pasteHandling\',\'destination\')}}">{{lyteUiEditorI18n("Match destination formatting")}}</lyte-menu-item> <lyte-menu-item onclick="{{action(\'pasteHandling\',\'text\')}}">{{lyteUiEditorI18n("Text only")}}</lyte-menu-item> </lyte-menu-body> </template> </lyte-menu> </template></template><template is="if" value="{{resizeHandlerClass}}"><template case="true"> <div class="lyteEditorResizeHandler{{resizeHandlerClass}}" ontouchstart="{{action(\'resize_mousedown\',event)}}" onmousedown="{{action(\'resize_mousedown\',event)}}"></div> </template></template><template is="if" value="{{ltPropContextMenu}}"><template case="true"> <lyte-menu lt-prop-yield="true" lt-prop-wrapper-class="lyteTextEditorContextMenu lyteTextEditorMenu {{ltPropWrapperClass}}" lt-prop-query="{{tableQuery}}" lt-prop-event="contextmenu" on-before-open="{{method(\'beforeTableOpen\')}}" on-menu-click="{{method(\'tableSelect\')}}" on-close="{{method(\'menuclose\')}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body> <template is="for" items="{{tableMenu}}" item="item" index="index"> <lyte-menu-group class="lyteTextEditorContextMenuGroup {{item.class}}"> <template is="for" items="{{item.options}}" item="inner_item" index="index"> <lyte-menu-item lt-prop-title="{{if(expHandlers(expHandlers(inner_item.display,\'==\',\'Paste\'),\'&amp;&amp;\',expHandlers(inner_item.disabled,\'==\',\'true\')),ltPropDisabledPasteTooltip)}}" lt-prop-tooltip-config="{&quot;position&quot; : &quot;right&quot;}" data-value="{{inner_item.purpose}}" class="{{inner_item.class}}" lt-prop-disabled="{{inner_item.disabled}}">{{inner_item.display}}</lyte-menu-item> </template> </lyte-menu-group> </template> </lyte-menu-body> </template> </lyte-menu> </template></template><template is="if" value="{{ltPropImageOptions}}"><template case="true"> <lyte-menu lt-prop-yield="true" lt-prop-wrapper-class="lyteTextEditorImageMenu lyteTextEditorMenu {{ltPropWrapperClass}}" lt-prop-query="{{imageQuery}}" lt-prop-set-css="false" lt-prop-freeze="{{ltPropFreeze}}" on-menu-click="{{method(\'imageSelect\')}}" lt-prop-boundary="{{imageBoundary}}" on-open="{{method(\'imageMenuOpen\')}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body> <template is="for" items="{{ltPropImageMenuOptions}}" item="item" index="index"> <lyte-menu-item class="lyteEditorImageMenu{{item.value}}" data-value="{{item.value}}">{{item.name}}</lyte-menu-item> </template> </lyte-menu-body> </template> </lyte-menu> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[5]},{type:"attr",position:[7]},{type:"if",position:[7],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[8]},{type:"if",position:[8],cases:{true:{dynamicNodes:[]}},default:{}},{type:"attr",position:[10]},{type:"registerYield",position:[10,1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"attr",position:[5]},{type:"attr",position:[7]},{type:"componentDynamic",position:[7]},{type:"attr",position:[9]},{type:"if",position:[9],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"text",position:[1,2]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[]}},default:{}}]}},default:{}},{type:"attr",position:[11]},{type:"registerYield",position:[11,1],dynamicNodes:[]},{type:"componentDynamic",position:[11]},{type:"attr",position:[13]},{type:"registerYield",position:[13,1],dynamicNodes:[]},{type:"componentDynamic",position:[13]}]},{type:"componentDynamic",position:[10]},{type:"attr",position:[12]},{type:"registerYield",position:[12,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"text",position:[1,3,1,1,0]},{type:"attr",position:[1,3,1,3]},{type:"if",position:[1,3,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3,1,5]},{type:"componentDynamic",position:[1,3,1,5]},{type:"attr",position:[1,3,3]},{type:"if",position:[1,3,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]},{type:"text",position:[3,1,0]},{type:"attr",position:[3,3]},{type:"componentDynamic",position:[3,3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3,5]},{type:"if",position:[1,3,5],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]}},default:{}},{type:"insertYield",position:[1,3,7]},{type:"attr",position:[1,3,9,1]},{type:"if",position:[1,3,9,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"componentDynamic",position:[0]}]}},default:{}},{type:"attr",position:[1,3,9,3]},{type:"registerYield",position:[1,3,9,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1,3,9,3]},{type:"text",position:[1,5,1,1,0]},{type:"attr",position:[1,5,1,3]},{type:"componentDynamic",position:[1,5,1,3]},{type:"text",position:[1,5,3,1,0]},{type:"attr",position:[1,5,3,3]},{type:"text",position:[1,5,3,3,0]},{type:"attr",position:[1,5,5,1]},{type:"registerYield",position:[1,5,5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1,5,5,1]},{type:"attr",position:[1,5,5,3]},{type:"registerYield",position:[1,5,5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1,5,5,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[12]},{type:"attr",position:[14]},{type:"if",position:[14],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[16]},{type:"if",position:[16],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1]}]}]}},default:{}},{type:"attr",position:[18]},{type:"if",position:[18],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[20]},{type:"if",position:[20],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5]},{type:"text",position:[1,5,0]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}},{type:"attr",position:[21]},{type:"if",position:[21],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[22]},{type:"if",position:[22],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[23]},{type:"if",position:[23],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}],_templateAttributes:{type:"attr",position:[]},_observedAttributes:["ltPropWordStyle","ltPropParaStyle","ltPropTdStyle","ltPropTableStyle","ltPropImageStyle","ltPropFocus","ltPropListLevel","ltPropMaxUndoCount","ltPropShortcuts","ltPropWordStyleConversion","ltPropCaptionStyle","ltPropParaStyleConversion","ltPropParaChildConversion","ltPropOrderedList","ltPropUnOrderedList","ltPropListStyle","ltPropQueueUpdateTime","ltPropDefaultTable","ltPropTags","ltPropTableResize","ltPropImageResize","ltPropAnchorProperty","ltPropAnchorStyle","ltPropUpperCase","ltPropFontIncrease","ltPropMarginIncrease","ltPropMaxFont","ltPropMaxMargin","ltPropHeaderTags","ltPropTagConversion","ltPropTabSize","ltPropTriggerCharacter","ltPropRestrict","ltPropAllowedTags","ltPropAllowedStyles","ltPropCursorClass","ltPropTriggerDelay","ltPropPlaceholder","ltPropMultipleProperty","ltPropMobileOptions","ltPropText","ltPropButtonStyle","ltPropPasteHandling","ltPropDefaultPaste","ltPropCheckbox","ltPropMaxlength","ltPropCharacterCount","ltPropResize","ltPropWordAttributes","ltPropTableHandling","ltPropBlockquoteClasses","ltPropTooltipConfig","ltPropConvertInlineImages","ltPropGenerateId","ltPropPreventScroll","ltPropScrollToOptions","ltPropDisabled","ltPropReadonly","ltPropData","ltPropTabindex","ltPropRemoveDefaultStyle","ltPropPreventInitialScroll","ltPropBluePencil","ltPropParaToWordStyle","ltPropContextMenu","ltPropListVariable","ltPropImageOptions","ltPropSelectionDelay","ltPropAnchorPopBoundary","ltPropSourceDirection","ltPropUrlDetection","ltPropUrlDetectionOptions","ltPropClearParaProperties","ltPropClearParaOnFullSelection","ltPropAnchorTextEdit","ltPropForcePopScroll","ltPropWrapperClass","ltPropFreeze","ltPropRuler","ltPropCountNewLine","ltPropIgnoreMac","ltPropJoinStyle","ltPropReplaceLetters","ltPropReplaceStyle","ltPropConvertStyle","ltPropWordToParaStyle","ltPropReadFromClipboard","ltPropMentionsEditable","ltPropMobileView","ltPropDiacriticHandler","ltPropFindShow","ltPropCapitalizeWord","ltPropFindInput","ltPropMentionsSubMenu","ltPropWordSimpleConversion","ltPropDisabledPasteTooltip","ltPropFindAndReplace","ltPropCustomListColor","ltPropUnformattedPasteOption","ltPropAnchorAdvancedOption","ltPropImageMenuOptions","ltPropInlineImage","ltPropMentionsBgEditable","ltPropMentionsBg","ltPropDisableAnchorInMentions","ltPropAutoAdjustHeight","ltPropAnchorFollowup","ltPropAriaAttributes","ltPropDetectList","ltPropListMatchMap","isEditable","cursor","currentNode","undoqueue","_undoqueue","redoqueue","range","activeOverlay","selectedParagraph","selectedWords","alignQueue","topLevelElement","randomId","findWords","tabClass","wordLines","showPlaceholder","imageMapping","anchorEdit","isEditLink","undef","touchTest","isMobile","mobileOffset","userInput","anchorPopClass","anchorShow","textModified","inputFocus","isTextSelected","buttonDisable","resizeHandlerClass","searchValue","triggersArray","triggersArrayFinal","tableMenu","tableQuery","imageQuery","isMac","renderFrame","navCheck","isPanelOpen","imageBoundary","listMapping","highlightSpan","highlightInnerSpan","currentHighlight","convertToLineData","lineOffsetDataForFind","search","snippetUtils","spaceDetails","codeEditorLanguage","findInput","replaceInput","rulerClassArr","mentionsGroup","shortCutCheckObject","currentAnchorType","linkChecked","emailChecked","telephoneChecked","wrapImage","listRegex"],data:function(){return{ltPropWordStyle:Lyte.attr("object",{default:_lyteUiEditor.wordStyle}),ltPropParaStyle:Lyte.attr("object",{default:_lyteUiEditor.paraStyle}),ltPropTdStyle:Lyte.attr("object",{default:_lyteUiEditor.tdStyle}),ltPropTableStyle:Lyte.attr("object",{default:_lyteUiEditor.tableStyle}),ltPropImageStyle:Lyte.attr("object",{default:_lyteUiEditor.imageStyle}),ltPropFocus:Lyte.attr("boolean",{default:!1}),ltPropListLevel:Lyte.attr("number",{default:7}),ltPropMaxUndoCount:Lyte.attr("number",{default:void 0}),ltPropShortcuts:Lyte.attr("object",{default:_lyteUiEditor.shortcuts}),ltPropWordStyleConversion:Lyte.attr("object",{default:_lyteUiEditor.wordStyleConversion}),ltPropCaptionStyle:Lyte.attr("object",{default:_lyteUiEditor.captionStyle}),ltPropParaStyleConversion:Lyte.attr("object",{default:_lyteUiEditor.paraStyleConversion}),ltPropParaChildConversion:Lyte.attr("object",{default:_lyteUiEditor.paraChildConversion}),ltPropOrderedList:Lyte.attr("array",{default:_lyteUiEditor.orderedList}),ltPropUnOrderedList:Lyte.attr("array",{default:_lyteUiEditor.unOrderedList}),ltPropListStyle:Lyte.attr("object",{default:_lyteUiEditor.listStyle}),ltPropQueueUpdateTime:Lyte.attr("number",{default:250}),ltPropDefaultTable:Lyte.attr("object",{default:_lyteUiUtils.defaultTable}),ltPropTags:Lyte.attr("object",{default:{word:"lyte-word",paragraph:"lyte-paragraph",overlayHandle:"lyte-handle",table:"table",thead:"thead",tbody:"tbody",tr:"tr",th:"th",td:"td",overlay:"lyte-overlay",find:"lyte-find"}}),ltPropTableResize:Lyte.attr("boolean",{default:!0}),ltPropImageResize:Lyte.attr("boolean",{default:!0}),ltPropAnchorProperty:Lyte.attr("object",{default:_lyteUiEditor.anchorProperty}),ltPropAnchorStyle:Lyte.attr("object",{default:_lyteUiEditor.anchorStyle}),ltPropUpperCase:Lyte.attr("string",{default:void 0}),ltPropFontIncrease:Lyte.attr("number",{default:1}),ltPropMarginIncrease:Lyte.attr("number",{default:20}),ltPropMaxFont:Lyte.attr("number",{default:100}),ltPropMaxMargin:Lyte.attr("number"),ltPropHeaderTags:Lyte.attr("array",{default:_lyteUiEditor.headerTags}),ltPropTagConversion:Lyte.attr("object",{default:_lyteUiEditor.tagConversion}),ltPropTabSize:Lyte.attr("number",{default:3}),ltPropTriggerCharacter:Lyte.attr("string",{default:"@"}),ltPropRestrict:Lyte.attr("array",{default:["script","template"]}),ltPropAllowedTags:Lyte.attr("object",{default:{}}),ltPropAllowedStyles:Lyte.attr("array",{default:[]}),ltPropCursorClass:Lyte.attr("string",{default:""}),ltPropTriggerDelay:Lyte.attr("number",{default:250}),ltPropPlaceholder:Lyte.attr("string",{default:_lyteUiEditor.i18n("Add here ...")}),ltPropMultipleProperty:Lyte.attr("array",{default:["textDecoration","textDecorationLine"]}),ltPropMobileOptions:Lyte.attr("array",{default:["cut","copy","paste","selectWord","selectLine"]}),ltPropText:Lyte.attr("object",{default:{link:_lyteUiEditor.i18n("Link"),removeSelected:_lyteUiEditor.i18n("Remove selected"),edit:_lyteUiEditor.i18n("Edit"),remove:_lyteUiEditor.i18n("Remove"),cut:_lyteUiEditor.i18n("Cut"),copy:_lyteUiEditor.i18n("Copy"),paste:_lyteUiEditor.i18n("Paste"),selectWord:_lyteUiEditor.i18n("Select word"),selectLine:_lyteUiEditor.i18n("Select line")}}),ltPropButtonStyle:Lyte.attr("string",{default:'{"size" : "small"}'}),ltPropPasteHandling:Lyte.attr("boolean",{default:!1}),ltPropDefaultPaste:Lyte.attr("string"),ltPropCheckbox:Lyte.attr("object",{default:{label:_lyteUiEditor.i18n("Open in new window")}}),ltPropMaxlength:Lyte.attr("number",{default:1/0}),ltPropCharacterCount:Lyte.attr("number",{default:0}),ltPropResize:Lyte.attr("object",{default:{horizontal:!1,vertical:!0}}),ltPropWordAttributes:Lyte.attr("boolean",{default:!1}),ltPropTableHandling:Lyte.attr("boolean",{default:!1}),ltPropBlockquoteClasses:Lyte.attr("array",{default:_lyteUiEditor.blockquoteClasses}),ltPropTooltipConfig:Lyte.attr("string",{default:'{"position" : "bottom","showdelay" : 500}'}),ltPropConvertInlineImages:Lyte.attr("boolean",{default:!1}),ltPropGenerateId:Lyte.attr("boolean",{default:!1}),ltPropPreventScroll:Lyte.attr("boolean",{default:!1}),ltPropScrollToOptions:Lyte.attr("object",{default:{duration:400}}),ltPropDisabled:Lyte.attr("boolean",{default:!1}),ltPropReadonly:Lyte.attr("boolean",{default:!1}),ltPropData:Lyte.attr("string",{default:""}),ltPropTabindex:Lyte.attr("string",{default:"0"}),ltPropRemoveDefaultStyle:Lyte.attr("boolean",{default:!1}),ltPropPreventInitialScroll:Lyte.attr("boolean",{default:!1}),ltPropBluePencil:Lyte.attr("string",{default:""}),ltPropParaToWordStyle:Lyte.attr("array",{default:["color","fontSize","fontWeight","fontStyle"]}),ltPropContextMenu:Lyte.attr("boolean",{default:!1}),ltPropListVariable:Lyte.attr("boolean",{default:!0}),ltPropImageOptions:Lyte.attr("boolean",{default:!1}),ltPropSelectionDelay:Lyte.attr("number",{default:500}),ltPropAnchorPopBoundary:Lyte.attr("object",{default:{}}),ltPropSourceDirection:Lyte.attr("boolean",{default:!1}),ltPropUrlDetection:Lyte.attr("boolean",{default:!1}),ltPropUrlDetectionOptions:Lyte.attr("object",{default:{insert:!0,paste:!0,input:!0,output:!0,merge:!0}}),ltPropClearParaProperties:Lyte.attr("boolean",{default:!0}),ltPropClearParaOnFullSelection:Lyte.attr("boolean",{default:!1}),ltPropAnchorTextEdit:Lyte.attr("boolean",{default:!1}),ltPropForcePopScroll:Lyte.attr("boolean",{default:!1}),ltPropWrapperClass:Lyte.attr("string",{default:""}),ltPropFreeze:Lyte.attr("boolean",{default:!1}),ltPropRuler:Lyte.attr("boolean"),ltPropCountNewLine:Lyte.attr("boolean",{default:!1}),ltPropIgnoreMac:Lyte.attr("boolean",{default:!1}),ltPropJoinStyle:Lyte.attr("array",{default:[]}),ltPropReplaceLetters:Lyte.attr("object",{default:_lyteUiEditor.replaceLetters}),ltPropReplaceStyle:Lyte.attr("object",{default:{}}),ltPropConvertStyle:Lyte.attr("object"),ltPropWordToParaStyle:Lyte.attr("array",{default:["color"]}),ltPropReadFromClipboard:Lyte.attr("boolean",{default:!1}),ltPropMentionsEditable:Lyte.attr("boolean",{default:!0}),ltPropMobileView:Lyte.attr("boolean",{default:!1}),ltPropDiacriticHandler:Lyte.attr("boolean",{default:!1}),ltPropFindShow:Lyte.attr("boolean",{default:!1}),ltPropCapitalizeWord:Lyte.attr("boolean",{default:!1}),ltPropFindInput:Lyte.attr("boolean",{default:""}),ltPropMentionsSubMenu:Lyte.attr("boolean",{default:!1}),ltPropWordSimpleConversion:Lyte.attr("object",{default:_lyteUiEditor.wordSimpleConversion}),ltPropDisabledPasteTooltip:Lyte.attr("string",{default:""}),ltPropFindAndReplace:Lyte.attr("boolean",{default:!1}),ltPropCustomListColor:Lyte.attr("boolean",{default:!1}),ltPropUnformattedPasteOption:Lyte.attr("string",{default:void 0}),ltPropAnchorAdvancedOption:Lyte.attr("object",{default:{showMail:!1,showTel:!1,showTittle:!1}}),ltPropImageMenuOptions:Lyte.attr("array",{default:[{name:_lyteUiEditor.i18n("Small"),value:"small"},{name:_lyteUiEditor.i18n("Fit to screen"),value:"fit_to_screen"},{name:_lyteUiEditor.i18n("Actual size"),value:"actual_size"},{name:_lyteUiEditor.i18n("Remove"),value:"remove"}]}),ltPropInlineImage:Lyte.attr("boolean",{default:!1}),ltPropMentionsBgEditable:Lyte.attr("boolean",{default:!1}),ltPropMentionsBg:Lyte.attr("string",{default:"#e9f4ff"}),ltPropDisableAnchorInMentions:Lyte.attr("boolean",{default:!1}),ltPropAutoAdjustHeight:Lyte.attr("boolean",{default:!1}),ltPropAnchorFollowup:Lyte.attr("boolean",{default:!0}),ltPropAriaAttributes:Lyte.attr("object",{default:{}}),ltPropDetectList:Lyte.attr("boolean",{default:!1}),ltPropListMatchMap:Lyte.attr("object",{default:{disc:"disc",olDecimal:"olDecimal",olLowerAlpha:"olLowerAlpha",olLowerRoman:"olLowerRoman",olUpperAlpha:"olUpperAlpha",olUpperRoman:"olUpperRoman",olDecimalLeadingZero:"olDecimalLeadingZero"}}),isEditable:Lyte.attr("string",{default:"true"}),cursor:Lyte.attr("number",{default:0}),currentNode:Lyte.attr("object",{default:void 0}),undoqueue:Lyte.attr("array",{default:[]}),_undoqueue:Lyte.attr("array",{default:[]}),redoqueue:Lyte.attr("array",{default:[]}),range:Lyte.attr("object",{default:{left:0,right:0,startNode:void 0,endNode:void 0,isRange:!1}}),activeOverlay:Lyte.attr("array",{default:[]}),selectedParagraph:Lyte.attr("array",{default:[]}),selectedWords:Lyte.attr("array",{default:[]}),alignQueue:Lyte.attr("array",{default:[]}),topLevelElement:Lyte.attr("object"),randomId:Lyte.attr("string",{default:""}),findWords:Lyte.attr("array",{default:[]}),tabClass:Lyte.attr("string",{default:"lyteEditorTab"}),wordLines:Lyte.attr("array",{default:[]}),showPlaceholder:Lyte.attr("boolean",{default:!0}),imageMapping:Lyte.attr("object",{default:{}}),anchorEdit:Lyte.attr("object",{default:{text:"",href:"",newWindow:!0,mailId:"",mailSubject:"",telephone:"",title:""}}),isEditLink:Lyte.attr("boolean",{default:!1}),undef:Lyte.attr("boolean",{default:void 0}),touchTest:Lyte.attr("boolean",{default:!1}),isMobile:Lyte.attr("boolean",{default:!1}),mobileOffset:Lyte.attr("object",{default:{}}),userInput:Lyte.attr("string",{default:""}),anchorPopClass:Lyte.attr("string",{default:"lyteAnchorEditPopover"}),anchorShow:Lyte.attr("boolean",{default:!1}),textModified:Lyte.attr("boolean",{default:!1}),inputFocus:Lyte.attr("boolean",{default:!1}),isTextSelected:Lyte.attr("boolean",{default:!1}),buttonDisable:Lyte.attr("boolean",{default:!1}),resizeHandlerClass:Lyte.attr("string"),searchValue:Lyte.attr("string",{default:""}),triggersArray:Lyte.attr("array",{default:[]}),triggersArrayFinal:Lyte.attr("array",{default:[]}),tableMenu:Lyte.attr("array",{default:[{options:[{display:_lyteUiEditor.i18n("Cut"),purpose:"cut",class:"lyteEditorCut"},{display:_lyteUiEditor.i18n("Copy"),purpose:"copy",class:"lyteEditorCopy"},{display:_lyteUiEditor.i18n("Paste"),purpose:"paste",class:"lyteEditorPaste"},{display:_lyteUiEditor.i18n("Select all"),purpose:"selectall",class:"lyteEditorSelectAll"}]},{options:[{display:_lyteUiEditor.i18n("Undo"),purpose:"undo",class:"lyteEditorUndo"},{display:_lyteUiEditor.i18n("Redo"),purpose:"redo",class:"lyteEditorRedo"}]}]}),tableQuery:Lyte.attr("string"),imageQuery:Lyte.attr("string"),isMac:Lyte.attr("boolean",{default:!0}),renderFrame:Lyte.attr("boolean",{default:!1}),navCheck:Lyte.attr("boolean",{default:!1}),isPanelOpen:Lyte.attr("boolean",{default:!1}),imageBoundary:Lyte.attr("object",{default:{}}),listMapping:Lyte.attr("object",{default:{}}),highlightSpan:Lyte.attr("array",{default:[]}),highlightInnerSpan:Lyte.attr("array",{default:[]}),currentHighlight:Lyte.attr("number",{default:void 0}),convertToLineData:Lyte.attr("object",{default:{node:void 0,data:void 0}}),lineOffsetDataForFind:Lyte.attr("array",{default:[]}),search:Lyte.attr("string",{default:void 0}),snippetUtils:Lyte.attr("object",{default:{lyteTagNameCls:{color:"rgb(0, 68, 255)"},lytePunctuationCls:{color:"rgb(0, 68, 255)"},lyteContentCls:{color:"rgb(51, 51, 51)"},lyteAttributeEqualsCls:{color:"rgb(128, 0, 128)"},lyteAttributeNameCls:{color:"rgb(128, 0, 128)"},lyteAttributeValueCls:{color:"rgb(0, 98, 3)"},lyteEntityCls:{color:"rgb(255, 47, 47)"},lyteCSSComment:{color:"rgb(115, 115, 115)"},lyteCommentCls:{color:"rgb(115, 115, 115)"},lyteCSSRuleName:{color:"rgb(51, 51, 51)"},lyteCSSPunctuation:{color:"rgb(51, 51, 51)"},lyteCSSValueFunction:{color:"rgb(178, 74, 0)"},lyteCSSRuleValue:{color:"rgb(178, 74, 0)"},lyteCSSCombinator:{color:"rgb(255, 0, 255)"},lyteCSSAttributeName:{color:"rgb(128, 0, 128)"},lyteCSSImportant:{color:"rgb(0, 68, 255)"},lyteCSSAttributeValue:{color:"rgb(0, 68, 255)"},lyteCSSColorValue:{color:"orange"},lyteJSKeyword:{color:"rgb(128, 0, 128)"},lyteJSIndentifier:{color:"rgb(51, 51, 51)"},lyteJSOperator:{color:"rgb(128, 0, 128)"},lyteJSPunctuator:{color:"rgb(26, 26, 26)"},lyteJSNumber:{color:"rgb(178, 74, 0)"},lyteJSStringLiteral:{color:"rgb(178, 74, 0)"},lyteJSComment:{color:"rgb(95, 87, 87)"},lyteJSRegex:{color:"rgb(0, 180, 131)"},lyteJSBoolean:{color:"rgb(108, 88, 255)"},lyteJSFunction:{color:"rgb(0, 98, 3)"},lyteJSNull:{color:"rgb(108, 88, 255)"},lyteJSUndefined:{color:"rgb(108, 88, 255)"}}}),spaceDetails:Lyte.attr("array",{default:void 0}),codeEditorLanguage:Lyte.attr("string",{default:void 0}),findInput:Lyte.attr("string",{default:""}),replaceInput:Lyte.attr("string",{default:""}),rulerClassArr:Lyte.attr("array",{default:[]}),mentionsGroup:Lyte.attr("array",{default:[]}),shortCutCheckObject:Lyte.attr("array",{default:["KeyU"]}),currentAnchorType:Lyte.attr("string",{default:"link"}),linkChecked:Lyte.attr("boolean",{default:!0}),emailChecked:Lyte.attr("boolean",{default:!1}),telephoneChecked:Lyte.attr("boolean",{default:!1}),wrapImage:Lyte.attr("boolean",{default:!1}),listRegex:Lyte.attr("object",{default:{olDecimal:/\b([1-9]\d*)\./,olLowerAlpha:/^[a-z]+\. /,olUpperAlpha:/^[A-Z]+\. /,olLowerRoman:/^m{0,3}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})\. /,olUpperRoman:/^M{0,3}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\. /,olDecimalLeadingZero:/^(0[1-9]|\d{2,})\. /,disc:/^\* /,hyphen:/^- /}})}},get_dir:function(t,e){var i;return(i=e?t.style.direction:t.parentNode.style.direction)?"rtl"==i:this._dir},anch_obs:function(t){var e=this.$node.panel;e&&e["call_"+(t.newValue?"show":"hide")]()}.observes("anchorShow"),aria_obs:function(){var t=this.data.ltPropAriaAttributes;if(t)for(var e in t)this._editdiv.setAttribute(e,t[e])}.observes("ltPropAriaAttributes").on("didConnect"),anchor_cls_obs:function(){var t=["lyteAnchorEditPopover"],e=this.data;e.isEditLink&&t.push("lytePopoverLinkEditMode"),e.range.isRange&&(t.push("lyteTextSelected"),e.ltPropAnchorTextEdit?t.push("lyteAnchorTextEdit"):t.push("lyteAnchorEditInputHidden")),this.setData("anchorPopClass",t.join(" "))}.observes("isEditLink","range.isRange","range"),show_obs:function(){var t=this.data.showPlaceholder;$L(this.__place).css("display",t?"":"none")}.observes("showPlaceholder").on("didConnect"),place_obs:function(t){var e=t.oldValue,i=t.newValue,a=this.__place;e&&i?$L(a).text(i):e?(this.setData("showPlaceholder",!1),a.remove(),delete this.__place):i&&(this.create_placeholder(i),this.setData("showPlaceholder",!0))}.observes("ltPropPlaceholder"),create_placeholder:function(t){this.append(this.$node,this.__place=$L(this.create("div")).css("display","none").addClass("lyteEditorPlaceholderDiv").text(t).get(0))},onetimeSetup:function(){this.__newparas=[];var t=function(t){return this.$node.getElementsByClassName(t)[0]}.bind(this),e="lyteEditor",i=this.data,a=i.ltPropPlaceholder,o=this._maindiv=t(e+"MainDiv");this._editdiv=t(e+"ContentEditable"),this._navigation=t(e+"NavigationElement"),this._cursor=$L(this.create("span")).addClass(e+"Cursor",this.data.ltPropCursorClass).get(0),this._canvas=this.$node.getElementsByTagName("canvas")[0].getContext("2d"),a&&this.create_placeholder(a),this._popover=t(e+"PopoverLink"),this._mobilepop=t(e+"MobileOptions"),this._pastediv=t("lyteTextEditorPasteHandling"),this._mouseup=this.mouseup.bind(this),this._mousemove=this.mousemove.bind(this),this._emojiRegex=/([\uD800-\uDBFF][\uDC00-\uDFFF])/i,this.__overall_emoji=/[\u{1f300}-\u{1f5ff}\u{1f900}-\u{1f9ff}\u{1f600}-\u{1f64f}\u{1f680}-\u{1f6ff}\u{2600}-\u{26ff}\u{2700}-\u{27bf}\u{1f1e6}-\u{1f1ff}\u{1f191}-\u{1f251}\u{1f004}\u{1f0cf}\u{1f170}-\u{1f171}\u{1f17e}-\u{1f17f}\u{1f18e}\u{3030}\u{2b50}\u{2b55}\u{2934}-\u{2935}\u{2b05}-\u{2b07}\u{2b1b}-\u{2b1c}\u{3297}\u{3299}\u{303d}\u{00a9}\u{00ae}\u{2122}\u{23f3}\u{24c2}\u{23e9}-\u{23ef}\u{25b6}\u{23f8}-\u{23fa}]/u,this.setUpRandomId(o),this.append(o,this._cursor),i.ltPropBluePencil&&$L(o).addClass("lyteEditorContentEditableMainDiv"),i.ltPropMentionsBgEditable&&$L(o).addClass("lyteEditorMentionWordDynamicBg"),i.isMobile&&o.classList.add("lyteTextEditorMobile"),$L(o).data({data:[],list:[]}),this.setData("randomId",this.randomId()),this.$node.focus=function(t){var e=this.data;if(!e.ltPropDisabled){this._editdiv.focus({preventScroll:!0});this.__compose;t||(e.range.isRange?(this._ignoreRangeCheck=!0,this.setRange(),this._ignoreRangeCheck=!1):this.setCursor(e.currentNode,e.cursor),$L.fastdom.measure(function(){$L.fastdom.mutate(function(){this.scrollIntoView(e.currentNode,e.cursor)}.bind(this))}.bind(this)))}}.bind(this),this.$node.blur=function(){this.data.ltPropDisabled||this._editdiv.blur()}.bind(this),/rv:11/.test(navigator.userAgent)&&this._editdiv.addEventListener("textinput",this.actions.input.bind(this)),this.$node.getHTML=function(t,e){var i=this.stringFromData(this.getJSON());return t?_lyteUiEditor.convert_simple(this,i,e):i}.bind(this),this.$node.getText=function(){return this.component.convert_html_to_txt(this.getHTML())},this.$node.getTextFromData=function(t){return this.stringFromData(t)}.bind(this),this.$node.findIndex=function(){return this.findIndex(arguments[0],arguments[1],!0)}.bind(this),["getMentions","nextFind","clear","previousFind","find","insertJSON","insertHTML","getJSON","resetQueue","undo","redo","getProp","getCursor","getRange","removeLetters","getCurrentNode","convertHtmlToData","insertTextInWord","showSuggestion","removeSuggestion","insertHr"].forEach(function(t){var e=this[t];e&&(this.$node[t]=e.bind(this))}.bind(this)),this._popover.ltProp("originElem",".popOrigin"+this.data.randomId),this.data.ltPropTriggerCharacter&&this.setup_mention(),this.setData("tableQuery","#"+o.id),this.setData("imageQuery","#"+o.id+" .lyteEditorImage"),$L.fastdom.mutate(function(){this.disable_check(),this.disable_check("Readonly")}.bind(this))},getCursor:function(){return this.data.cursor},getCurrentNode:function(){return this.data.currentNode},getRange:function(){return this.data.range},getProp:function(t,e){var i=e.style[t];return(!i||"fontSize"==t&&/em/.test(i))&&(i=this.comp_style(e)[t]),i},comp_style:function(t){return window.getComputedStyle(t)},clear:function(){this.selectAll();var t=this.data.range.isRange;this.backspace(),t&&this.backspace()},didConnect:function(){this.onetimeSetup(),this.initialParagraph(),this.data.ltPropDiacriticHandler&&this._editdiv.addEventListener("beforeinput",this.beforeInput.bind(this)),this._defaultPasteOption=this.data.ltPropDefaultPaste},data_obs:function(){var t,e=this.data,i=e.ltPropData,a="JSON",o=this.$node;if(i){try{i.indexOf("[")?(a="HTML",t=i):t=JSON.parse(i)}catch(e){a="HTML",t=i}i&&(o["insert"+a](t),$L.fastdom.mutate(function(){var t=o.panel;o.resetQueue(),t&&(t.$node.refresh(),t.undoRedo(e.undoqueue,e.redoqueue))}.bind(this)))}}.observes("ltPropData").on("didConnect"),didDestroy:function(){this.data.imageMapping={},delete this.__newparas,this.clear_time(),["_editdiv","_maindiv","_cursor","_popover","__place"].forEach(function(t){delete this[t]}.bind(this))},execute:function(t){if(this.getMethods(t))return this.executeMethod.apply(this,arguments)},resize_obs:function(){var t=this.data.ltPropResize,e="";t.horizontal&&(e+=" lyteHorizontalResize"),t.vertical&&(e+=" lyteVerticalResize"),this.setData("resizeHandlerClass",e)}.observes("ltPropResize","ltPropResize.{}").on("init"),init:function(){this.execute("beforeRender",this.$node),this._dir=_lyteUiUtils.getRTL(),this._sanitizer=Lyte.Security.createSanitizer({GLOBAL_TAGS:["mention_div"],GLOBAL_ATTRIBUTES:["editable","module","editor-language","display-type"],ADD_URI_SAFE_ATTR:["style"],ALLOWED_STYLE:"ALL",STYLE_VALIDATION:!1}),this.setData({isMac:(this._isMac=/Macintosh/i.test(navigator.userAgent))&&!this.data.ltPropIgnoreMac,isMobile:_lyteUiUtils.isMobile||this.data.touchTest});var t=this.data.ltPropReplaceStyle,e=this.data.ltPropConvertStyle;if(!e)for(var i in e=this.data.ltPropConvertStyle={},t){var a=t[i];e[a.name]={value:a.replaceValue,name:i,replaceValue:a.value,fallBackValue:a.fallBackValue}}},didConnectObs:function(){this.execute("afterRender",this.$node)}.on("didConnect"),focusObs:function(){var t="ltPropFocus";this.data[t]&&(this.$node.focus(),this.setData(t,!1))}.observes("ltPropFocus").on("didConnect"),randomId:_lyteUiEditor.randomId,disable_check:function(t){var e,i="remove",a="true",o=t||"Disabled",n="ltProp"+o,r=this.data,s=this.$node,l=s.panel;r[n]&&(i="add"),r.ltPropDisabled&&(a="false"),$L(s)[e=i+"Class"]("lyteTextEditor"+o),l&&$L(l.$node)[e]("lyteEditorPanel"+o),this.setData("isEditable",a)},dis_obs:function(){this.disable_check()}.observes("ltPropDisabled"),read_obs:function(){this.disable_check("Readonly")}.observes("ltPropReadonly"),setUpRandomId:function(t,e){e=e||this.randomId(),$L(t).addClass("listHolderElement").data({randomId:e}).attr("id",e)},emptyWordData:function(t){return{details:{},style:t?{}:this.extend(this.data.ltPropWordStyle),classList:[],text:"",tag:this.getTag("word")}},emptyParaData:function(){return{data:[this.emptyWordData()],details:{},style:this.extend(this.data.ltPropParaStyle),classList:[],attr:{},tag:this.getTag("paragraph")}},initialParagraph:function(){var t=this.emptyParaData(),e=this.render(t);t=this.data;this.pushParagraph(e,this._maindiv,0),this.setData("currentNode",this.getFirstWordInPara(e)),this.setData("cursor",0);var i=t.currentNode;t.selectedWords.push({node:i,left:0,right:0}),t.selectedParagraph.push(i.parentNode),this.resetQueue()},create:function(t){return document.createElement(t)},append:function(t,e){var i=!(t||{}).tagName;return t.get&&i&&(t=t.get(0)),e.get&&i&&(e=e.get(0)),t.appendChild(e)},extend:function(t,e){return $L.extend(!0,e||{},t)},getTag:function(t){return this.data.ltPropTags[t]||t},render:function(t){var e=$L(this.renderNode(t.tag,t)),i=t.data||[],a=[];return i.forEach(function(t){var i=this.render(t);a.push(i),this.append(e,i)}.bind(this)),e.data({data:t,list:a}),e.get(0)},renderNode:function(t,e){var i=$L(this.create(t)),a=i.get(0);if(e){var o=e.style||{},n="--tablevel",r="--lyte-texteditor-li-color",s=o[r],l=e.randomId,d=o[n],c=e.attr||{};this.data.ltPropGenerateId&&(e.attr=c,c.id=this.isUndo()?c.id:this.randomId(!0),l&&(l=c.id)),"bidi-override"!=o.unicodeBidi&&delete o.unicodeBidi,i.addClass(e.classList||[]).css(o).attr(c),"false"==c.editable&&i.addClass("lyteReadonlyNode"),s&&a.style.setProperty(r,s),d&&a.style.setProperty(n,d),i.data("data",e);var p=e.details||{},h=p.anchor,u=e.text;if(null!=u&&(a.textContent=u.replace(/ /g," ")),["rowSpan","colSpan","src","alt"].forEach((function(t){var e=p[t];e&&(a[t]=e)})),h&&h.href&&this.anchor_tooltip(i,h),p.resize){var m=this.extend(p.arguments);"table"==m.component&&(m.onBeforeSelect=this.tableselect.bind(this),m.onDrop=this.tabledrop.bind(this),m.onRelease=this.tableRelease.bind(this)),i.enableResize(m)}if("table"==p.type){i.addClass("lyteEditorTableWord");var f=$L(document.createElement("span")).addClass("lyteEditorTableSelectspan").click(this.selectTable.bind(this));this.append(a,f.get(0))}l&&this.setUpRandomId(i,l)}return a},isUndo:function(){return this._undomode},pushParagraph:function(t,e,i){var a=$L(e),o=a.data("list"),n=a.data("data"),r=$L(t).data("data"),s=this.isUndo(),l=Lyte.Component;null==i&&(i=o.length),this.data.ltPropCountNewLine&&this.update_count_in_insert(r,i,o.length),o.splice(i,0,t),(n.data||n).splice(i,0,r),1==o.length?this.append(e,t):0==i?l.insertBefore(o[1],t):l.insertAfter(o[i-1],t),s||(this.pushToQueue({operation:"paragraphCreate",index:i,id:a.data("randomId"),data:r}),this.tabCheck(e),this.blockquote_check(a.get(0)))},call_queue_push:function(t,e){t=t.constructor==Array?t:[t];var i=this,a="onQueuePush";this.getMethods(a)&&t.forEach((function(t){"meta"!=t.type&&i.executeMethod(a,t,e,i.$node)}))},pushToQueue:function(t){var e=this.data,i=e._undoqueue,a=e.ltPropQueueUpdateTime,o=e.ltPropMaxUndoCount,n=e.undoqueue,r=e.redoqueue,s=_lyteUiEditor.operations.call(this,t);if(s){if(e.ltPropAutoAdjustHeight&&this.update_height(),this.call_queue_push(s),this._pushToPrevious&&/*!_undoqueue.length &&*/n.length&&!r.length)return i.push.apply(i,s.constructor==Array?s:[s]),Lyte.arrayUtils(this.last(n),"push",i.splice(0)),this.callQueueUpdate();Lyte.arrayUtils(i,"push",s),clearTimeout(this._undotime),this._undotime=setTimeout(function(){if(delete this._undotime,i.length){var t=_lyteUiEditor.fiterOut_meta(i.splice(0));if(2==t.length){var e=t[0],a=t[1];if(e.value==a.value&&e.type==a.type&&e.operations==a.operations)return}n.push(t),r.splice(0);var s=n.length;null!=o&&s>o&&n.splice(0,s-o),this.callQueueUpdate()}}.bind(this),a)}},clearVariables:function(){delete this._widthMaintain},clear_time:function(){["_focus","_blur","_undotime","__emoji_compose"].forEach(function(t){clearTimeout(this[t])}.bind(this))},check_is_empty:function(){0==($L(this._maindiv).data("list")||[]).length&&this.initialParagraph()},check_range_reset:function(t){var e;this.data.selectedParagraph.every((function(i){return!(e=t.contains(i))})),e||this.resetRange(!0)},call_menu_before_open:function(t){var e="onBeforeMenuOpen";return this.getMethods(e)&&0==this.executeMethod(e,t,this.$node)},before_menu_open:function(t,e,i){if(!i&&this.call_menu_before_open(e))return!1;var a,o=this.data,n=o.range.isRange,r=e.target,s=-1,l=Lyte.objectUtils;if(i=i||[],!n&&"img"==this.getTagName(r))return!1;o.tableMenu.forEach((function(t,e){-1==i.indexOf(t)?(t.options.forEach((function(t){var e,i=t.purpose;switch(i){case"undo":e=!o.undoqueue.length;break;case"redo":e=!o.redoqueue.length;break;case"cut":case"copy":e=!n;break;case"paste":e="firefox"==_lyteUiUtils.getBrowser()}var a="lyteEditor"+_lyteUiUtils.capitalize(i);e&&(a+=" lyteEditorMenuDisabled"),l(t,"add","class",a),l(t,"add","disabled",(e||!1).toString())})),l(t,"add","class",""),s<e&&(s=e,a=t)):/lyteEditorOptionLast/i.test(t.class)&&s<e&&(s=e,a=t)})),a&&l(a,"add","class",(a.class+" lyteEditorOptionLast").trim())},table_menu_select:function(t){var e,i,a;switch(t){case"undo":case"redo":e=t;break;case"selectall":e="selectAll";break;case"cut":i=a=!0;break;case"copy":i=!0;break;case"paste":this.clipboardPaste()}e&&this[e].apply(this,[]),i&&_lyteUiUtils.copyFrmEvt(this.getSelectedText(),void 0,this.$node,function(){a&&this.removeSelected(),this.common_positioning(),this.$node.focus()}.bind(this))},methods:{menuclose:function(){delete this.__cell,delete this.__img;var t="onMenuClose",e=Array.from(arguments);e.push(this.$node),e.unshift(t),this.getMethods(t)&&this.executeMethod.apply(this,e)},beforeTableOpen:function(t,e){return this.before_menu_open(t,e)},tableSelect:function(t){this.table_menu_select(t)},beforeCloseMenu:function(t,e){var i=e.target;if(this._pastediv.contains(i))return!1;t.component.childComp.contains(i)||this.hide_paste_div()},onDataChange:function(t,e){let i=this.data.findInput;null!=i&&this.find(i),this.data.showFindModal=!0},removeHighlight:function(){let t=this.getData("highlightSpan");if(0!=t.length)for(let e=0;e<t.length;e++)t[e].remove();let e=this.getData("highlightInnerSpan");if(0!=e.length)for(let t=0;t<e.length;t++)e[t].remove();this.setData("findInput",void 0)},linkCheckBoxClick:function(t){this.setData("currentAnchorType",t)}},focus_blur:function(t,e,i,a){this[t]=setTimeout(function(){delete this[t],$L(this.$node)[e]("lyteEditorFocused")}.bind(this)),this.execute(i,a,this.$node)},copy_evt:function(t){this.__evt=t},remove_evt:function(){delete this.__evt},is_common_focus:function(t){var e=t.relatedTarget;return e==this._maindiv||e==this._editdiv},beforeInput:function(t){let e=window.getSelection().getRangeAt(0);t.isComposing||e.startOffset==e.endOffset?"insertReplacementText"!=t.inputType&&(this.toArray(t.target.childNodes).forEach((function(t){t.tagName?t.remove():t.nodeValue&&(t.nodeValue="")})),this.createRange(t.target)):this.data.range.isRange?this.removeSelected():this.removeLetters(e.endOffset-e.startOffset)},createRange:function(t,e,i){if(t){var a,o,n=document.createRange(),r=window.getSelection();r.removeAllRanges(),null!=i?(a=Math.min(e,i),o=Math.max(e,i)):(a=e,o=e),n.setStart(t,a),n.setEnd(t,o),r.addRange(n)}},actions:{frameLoad:function(t){this._iframe=t,this.__cache={},t.contentDocument.body.style.whiteSpace="nowrap"},focus:function(t){t.relatedTarget;this.__ignore_focusblur||this.data.ltPropDisabled||(t.target!=this._maindiv||this.__down_evt&&!this.data.isMobile&&!this.data.touchTest||setTimeout(function(){this.$node.focus()}.bind(this),100),this.is_common_focus(t)||(this.check_is_empty(),this.focus_blur("_focus","addClass","onFocus",t)))},blur:function(t){this.__ignore_focusblur||this.is_common_focus(t)||this.focus_blur("_blur","removeClass","onBlur",t)},click:function(t){var e=this.data,i=t.target;e.ltPropDisabled||e.ltPropReadonly||(this._maindiv.contains(i)?(this.hide_paste_div(),$L(i).hasClass("lyteEditorTableSelectspan")||this.nonFocusClick(t)):e.ltPropBluePencil&&i.closest(".zbp-badge-container")&&this.before_edit_open())},input:function(t,e){if(this._maindiv.classList.add("lyteEditorUserTyping"),clearTimeout(this._keydown),this._keydown=setTimeout(function(){this._maindiv.classList.remove("lyteEditorUserTyping")}.bind(this),300),(!/insertFromComposition/i.test(t.inputType)||"safari"!==_lyteUiUtils.getBrowser())&&(!/insertcompositiontext/i.test(t.inputType)||this.data.ltPropMobileView)){if(/deleteCompositionText/i.test(t.inputType))return this.clear_composition();var i="insertFromPaste"==t.inputType&&!this._pastePrevent;if(this.data.ltPropReadonly||i)return i&&(this._maindiv.innerHTML=this._editdiv.innerHTML,this.__blue_ignore=!0,this.reset_entire()),this.toArray(e.childNodes).forEach((function(t){t.remove()}));this.copy_evt(t),this.clearVariables(),this.processInput(e||t.target,t),this.remove_evt()}},mousedown:function(t){this.clearVariables(),2==t.buttons||$L(t.target).hasClass("lyteEditorTableSelectspan")||(this.copy_evt(t),this.mousedown(t),this.remove_evt(t),(this.data.isMobile||this.data.touchTest)&&this.nonFocusClick(t))},mainClick:function(){this.__down_evt&&this.mousedown(this.__down_evt,!0)},keydown:function(t){this.copy_evt(t),this.keydown(t),this.remove_evt()},paste:function(t){let e=this.data.ltPropUnformattedPasteOption;if(e&&(this.data.ltPropDefaultPaste=1==t.clipboardData.types.length&&t.clipboardData.types[0]==["text/plain"]?e:this._defaultPasteOption),null!=this.__empty_pencil_time)return!1;var i=this.data;i.ltPropDisabled||i.ltPropReadonly?t.preventDefault():(this.copy_evt(t),this.paste(t),this.remove_evt())},cut:function(t){var e=this.data;this.copy_evt(t),this.copyToClip(t),!e.ltPropReadonly&&!e.ltPropDisabled&&this.removeSelected(),this.remove_evt()},copy:function(t){this.copy_evt(t),this.copyToClip(t),this.data.range.isRange&&this.setRange(),this.remove_evt()},mobileClick:async function(t){if(this._mobilepop.ltProp("show",!1),this.$node.focus(),/^cut|copy$/i.test(t))document.execCommand(t);else if("paste"==t){await navigator.permissions.query({name:"clipboard-read"});this.clipboardPaste()}else this[t]()},pasteHandling:function(t){var e=this.data;if(!e.ltPropDisabled&&!e.ltPropReadonly){if(t!=this._prev_paste_state){this.undo();var i=this;$L.fastdom.measure((function(){$L.fastdom.mutate((function(){i._proceedPaste(i[{destination:"convertTextToDestination",text:"convertTextToPlainData",source:"convertHtmlToData"}[t]](i.__pasted_text)),i._prev_paste_state=t}))}))}return!1}},compositionStart:function(t){t.data&&this.data.ltPropDiacriticHandler&&!this.data.ltPropMobileView&&this.backspace()},compositionUpdate:function(t){this.data.ltPropMobileView||this.update_composition(t.data)},compositionEnd:function(t){this.data.ltPropMobileView||this.insert_and_clear(t)},upArrow:function(){let t=$L(this.$node).find(".lyteUiEditorFindHighlight"),e=$L(this.$node).find(`.lyteUiEdtorFindPartialHighlight.select${this.data.currentHighlight+1}`),i=this.data.selectedRange,a=this.data.currentHighlight;if(null!=a){for(let t=0;t<e.length;t++)e[t].classList.remove("current");t[this.data.currentHighlight].classList.remove("current"),0==this.data.currentHighlight?this.setData("currentHighlight",t.length-1):this.setData("currentHighlight",this.data.currentHighlight-1);let o=$L(this.$node).find(`.lyteUiEdtorFindPartialHighlight.select${this.data.currentHighlight+1}`);for(let t=0;t<o.length;t++)o[t].classList.add("current");this.setData("currentNode",i[this.data.currentHighlight].startNode),this.setCursor(i[a].startNode,i[this.data.currentHighlight].right),t[this.data.currentHighlight].classList.add("current")}},downArrow:function(){let t=$L(this.$node).find(".lyteUiEditorFindHighlight"),e=$L(this.$node).find(`.lyteUiEdtorFindPartialHighlight.select${this.data.currentHighlight+1}`),i=this.data.selectedRange;if(null!=this.data.currentHighlight){t[this.data.currentHighlight].classList.remove("current");for(let t=0;t<e.length;t++)e[t].classList.remove("current");this.data.currentHighlight==t.length-1?this.setData("currentHighlight",0):this.setData("currentHighlight",this.data.currentHighlight+1);let a=$L(this.$node).find(`.lyteUiEdtorFindPartialHighlight.select${this.data.currentHighlight+1}`);for(let t=0;t<a.length;t++)a[t].classList.add("current");this.setData("currentNode",i[this.data.currentHighlight].startNode),this.setCursor(i[this.data.currentHighlight].startNode,i[this.data.currentHighlight].right),t[this.data.currentHighlight].classList.add("current")}},replaceText:function(){let t=this.data.replaceInput;this.replaceCurrentText(this.getData("currentHighlight"),t)},replaceAllText:function(){let t=this.data.replaceInput;this.replaceAllText(t)}},changeHighlightData:function(t){this.setData("currentHighlight",t)},removeLineOffsetData:function(){this.setData("lineOffsetDataForFind",[])},callFind:function(){this.setData("convertToLineData",{node:void 0,data:void 0});let t=this.data.findInput;t&&this.find(t)},mousedown:function(t,e){if(!this._count){var i,a=t;if(t.touches){if(t.touches.length>1)return;i=!0,t=t.touches[0]}var o=t.target,n=!0;if(!$L(o).hasClass("lyteResize")){if(o!=this._maindiv||e||(n=!1,this.__down_evt=a),this.isSection(o))var r=$L(o).find("lyte-word").get(0);var s=this.check4nested(this.getNodeFromEvent(t,r)),l=t.shiftKey,d="addEventListener";if(s&&n){var c=this.data.range,p=($L(s).hasClass("lyteReadonlyNode"),this.getCursorPosition(s,t));this.getTagName(o)==this.getTag("overlayHandle")?(c.startNode==s&&c.left==p&&(c.startNode=c.endNode,c.left=c.right),c.endNode=s,c.right=p,this._touchselect=!0):l?(Lyte.objectUtils(c,"add","isRange",!(c.startNode==s&&p==c.left)),c.endNode=s,c.right=p,c.isRange&&this.setRange()):(this.setData("currentNode",s),this.setCursor(s,p),this.resetRange(!0))}e||(t.__ignore?t.stopPropagation():(document[d](i?"touchmove":"mousemove",this._mousemove,!0),document[d](i?"touchend":"mouseup",this._mouseup,!0),this._mup=!0,this._cy=t.clientY,(i||this.data.touchTest)&&($L(this.$node).addClass("lyteEditorTouchStart","lyteEditorCursorVisible"),this._longpresstime=setTimeout(function(){delete this._longpresstime}.bind(this),500))),!this.data.ltPropBluePencil&&a.preventDefault())}}},mousemove:function(t){var e=this.__down_evt;e&&(delete this.__down_evt,this.mousedown(e,!0));var i=window;if(!i._resizeelem){var a,o=t,n="cancelAnimationFrame";if(this.__moved=!0,t.touches){if(t.touches.length>1)return;a=!0,o=t.touches[0]}i[n](this._scrollFrame),i[n](this._scrollFrame2);var r=this.getNodeFromEvent(o);if(r){r=this.check4nested(r);var s=this.getCursorPosition(r,o),l=this.data.range,d=this._maindiv,c=this.getBcr(d),p=d.scrollTop,h=o.clientY,u=0,m=Lyte.objectUtils;if(this._touchselect||!a&&!this.data.touchTest?r==l.startNode&&l.left==s?(m(l,"add","isRange",!1),this.copyToRange()):(m(l,"add","isRange",!0),m(l,"add","right",s),m(l,"add","endNode",r),this.setRange()):(r&&(this.setData("cursor",s),this.setData("currentNode",r),this.setCursor(r,s)),t.preventDefault()),(this._cy!=t.clientY||t.custom)&&(c.top+5>=h?u=-1:c.bottom-5<=h&&(u=1)),u){var f=this,g="requestAnimationFrame";this._scrollFrame=i[g]((function(){d.scrollTop=p+10*u;var e=$L(t.target).closest(".lyteEditorMainDiv>"+f.getTag("paragraph")).get(0),a=$L(f._maindiv).data("list"),o=f.getIndex(a,e),n=t;e&&(f._scrollFrame2=i[g]((function(){var i=f.getBcr(e);-1==u?i.top<c.top&&o++:u&&i.bottom>c.bottom&&o--,o>0&&o<a.length-1&&(n={},["pageX","pageY","clientX","clientY","buttons","button","preventDefault"].forEach((function(e){n[e]=t[e]})),n.target=a[o+u],n.custom=!0,f.mousemove(n))})))}))}}}},copyToRange:function(){var t=this.data,e=t.range,i=t.currentNode,a=t.cursor,o=Lyte.objectUtils;o(e,"add","startNode",i),o(e,"add","endNode",i),o(e,"add","left",a),o(e,"add","right",a),o(e,"add","isRange",!1),$L(this.$node).removeClass("lyteTextSelected"),this.setData("isTextSelected",!1)},setRange:function(){if(this.reset(),this.data.ltPropMobileView&&this.data.range.isRange)if((e=this.data.range).startNode==e.endNode)this.updateEditorDiv(e.startNode,e.left,e.right);else{let t=this.findIndex(e.startNode),i=this.findIndex(e.endNode),a=this.getWordText(e.endNode).length,o=!1;t.paraIndex==i.paraIndex?t.wordIndex>i.wordIndex&&(o=!0):t.paraIndex>i.paraIndex&&(o=!0),this.updateEditorDiv(e.endNode,o?a:0,e.right)}var t=this.data,e=t.range,i=this.getSelected(e),a=this.getTag("overlay"),o=t.activeOverlay,n=this.getTag("overlayHandle"),r=i.length-1,s="lyteTextSelected",l=$L(this.$node),d="lyteEditorFirst",c="lyteEditorLast";this.resetOverlay(),l.hasClass(s)||(l.addClass(s),this.setData("isTextSelected",!0)),i.forEach(function(e,i){var s;if(o.every((function(t){return!t.classList.contains("inActive")||(s=t,!1)})),s)$L(s).removeClass("inActive");else{var l={data:[],tag:a};t.isMobile&&(0==i&&l.data.push({tag:n}),i==r&&l.data.push({tag:n})),s=this.render(l),o.push(s),this.append(this._maindiv,s),o.push(s)}if(!i){var p=this.rtlfunc("left");$L(this._editdiv).css(p,e[p])}$L(s).css({top:e.top,height:e.height,left:e.left,width:e.width,transform:e.transform,right:e.right}).data({start:e.start,end:e.end,node:e.node}).addClass(0==i?d:"",i==r?c:"").removeClass(0!=i?d:"",i!=r?c:"")}.bind(this)),this.updateReadOnlyRange(e)},updateReadOnlyRange:function(t){if(!this._ignoreRangeCheck){var e=!1,i=this.data.currentNode,a=$L(t.startNode).hasClass("lyteReadonlyNode"),o=$L(t.endNode).hasClass("lyteReadonlyNode");t.startNode==t.endNode?(a&&(t.left=0,t.right=this.getWordText(t.startNode).length),e=!0):(a&&(i==t.startNode?t.left=0:t.left=this.getWordText(t.startNode).length,e=!0),o&&(i==t.endNode?t.right=0:t.right=this.getWordText(t.endNode).length,e=!0)),e&&this.getSelected(t)}},getSelected:function(t,e){var i=t.startNode,a=t.endNode,o=this.getTag("paragraph"),n=$L(i).closest(o,this.$node),r=n.parent().get(0),s=$L(a).closest(o,this.$node).parent().get(0);if(this.data.selectedParagraph=[],this.data.selectedWords=[],this.data.topLevelElement=void 0,i==a)return this.data.topLevelElement=n.parent().get(0),this.copyInSameWord(a,t.left,t.right,e);if(r==s)return this.data.topLevelElement=s,this.copyWithinSame(t);var l=$L(r).closest(this.getTag("table"),this.$node).get(0),d=$L(s).closest(this.getTag("table"),this.$node).get(0);return d&&l==d?(this.data.topLevelElement=void 0,this.copyFromTable(r,s)):this.copyFrmDifferent(r,s,t)},copyWithinSame:function(t){var e=t.startNode,i=t.endNode,a=i.parentNode,o=this.findIndex(e),n=this.findIndex(i),r=t.left,s=t.right,l=o.paraIndex,d=n.paraIndex,c=a.parentNode,p=$L(c).data("list"),h=o.wordIndex,u=n.wordIndex,m=[];if(this.data.topLevelElement=c,this.data.selectedParagraph=[],l>d||l==d&&h>u){var f=e;e=i,i=f,f=l,l=d,d=f,f=r,r=s,s=f,f=h,h=u,u=f}for(var g=l;g<=d;g++){var y,v=p[g],b=$L(v).data("list"),x=0,_=b.length-1,P=0;g==d&&(_=u),g==l&&(x=h);for(var L=x;L<=_;L++)y=g==d&&L==_?s:void 0,P=g==l&&L==x?r:0,Lyte.arrayUtils(m,"push",this.copyInSameWord(b[L],P,y));L=0}return m},getTempLine:function(t,e,i){var a=$L(t).data("lineRef");return a&&a.length||($L(t).data("lineRef",a=this.convertToLine(t)),this.pushIfNot(this.data.wordLines,a),a._sL=e,a._sT=i),a.forEach((function(t){var o=t.client;["bottom","oriBottom","oriTop","top","y"].forEach((function(t){null!=o[t]&&(o[t]+=a._sT-i)})),["left","right","x"].forEach((function(t){o[t]+=a._sL-e}))})),a._sL=e,a._sT=i,a},copyInSameWord:function(t,e,i,a){var o=t.offsetParent,n=$L(t),r=n.data("data"),s=this.data.selectedWords,l=this.data.selectedParagraph,d=[],c=this._maindiv,p=c.offsetHeight,h=c.scrollHeight,u=c.scrollLeft,m=c.scrollTop;if(i=null==i?this.getWordText(t).length:i,e>i){var f=e;e=i,i=f}if(!o)return s.push({node:t,left:parseInt(e),right:parseInt(i)}),this.pushIfNot(l,t.parentNode),s;if(_lyteUiEditor.isTable({data:[r]})){var g=this.toArray($L(t).find(this.getTag("table")).eq(0).children().children().children());return this.copyFromTable(this.first(g),this.last(g))}if(_lyteUiEditor.isSection({data:[r]}))return this.copyFromSection(r);"image"==r.details.type&&(d=this.copyCaption(t));let y,v=this.getData("convertToLineData");a?null==v.node||v.node!=t?(this.setData("convertToLineData",{node:t,data:this.convertToLine(t)}),v=this.getData("convertToLineData"),y=v.data):y=v.node==t?v.data:this.convertToLine(t):y=this._mup?this.getTempLine(t,u,m):this.convertToLine(t);var b,x=y,_=[],P=this.comp_style(t),L=x[0].client,w={bottom:L.oriTop||L.top},I=this.getBcr(this._maindiv),E=m+(L.oriTop||L.top)-I.top,C=t.style.unicodeBidi,T=this.get_dir(t),N=T?p==h?0:_lyteUiUtils.getScrollBarWidth():0,S=parseFloat(P.paddingLeft)-N,k=(b=parseFloat(P.paddingTop))+parseFloat(P.paddingBottom);if(C=C&&T||!C&&!T,s.push({node:t,left:parseInt(e),right:parseInt(i)}),this.pushIfNot(l,t.parentNode),"image"!=r.details.type||this.data.ltPropInlineImage){var D=n.hasClass("lyteReadonlyNode"),$=this.data.ltPropInlineImage&&this.isImage({data:[n.data("data")]});x.forEach(function(o,n){var r=o.start,s=o.end,l=o.width,d=e>=r&&e<=s,c=i>=r&&i<=s,p=(o.client.oriBottom||o.client.bottom)-(w.oriBottom||w.bottom),h=o.client.height,m=r>e&&s<i,f=(this.rtlfunc("left"),o.client.left-I.left+u),g=p-(o.client.oriHeight||h)+(o.client.top-o.client.oriTop||0);if(w=o.client,D||$)_.push({node:t,left:f+S,width:l,start:r,end:s,height:h-k,top:E+g+b});else if(d&&c){var y,v=this.getData("lineOffsetDataForFind");if(a)if(null!=v[v.length-1]&&v[v.length-1].line==n&&v[v.length-1].node==t){let a=v[v.length-1],s=this.measureLength(o.text.slice(a.right-r,e-r),void 0,t,P,void 0,n).width,l=this.measureLength(o.text.slice(a.right-r,i-r),void 0,t,P,void 0,n).width;x=a.off1+s,y=a.off1+l,Lyte.arrayUtils(v,"push",{node:t,off1:y,off:x,right:i,line:n})}else x=this.measureLength(o.text.slice(r-r,e-r),void 0,t,P,void 0,n).width,y=this.measureLength(o.text.slice(r-r,i-r),void 0,t,P,void 0,n).width,Lyte.arrayUtils(v,"push",{node:t,off1:y,off:x,right:i,line:n});else x=this.measureLength(o.text.slice(r-r,e-r),void 0,t,P,void 0,n).width,y=this.measureLength(o.text.slice(r-r,i-r),void 0,t,P,void 0,n).width;_.push({node:t,left:f+(C?x:l-y)+S,width:y-x,start:e,end:i,height:h-k,top:E+g+b})}else if(d){var x=this.measureLength(o.text.slice(r-r,e-r),void 0,t,P,void 0,n).width;_.push({node:t,left:f+(C?x:0)+S,width:l-x,start:e,end:s,height:h-k,top:E+g+b})}else if(c){x=this.measureLength(o.text.slice(r-r,i-r),void 0,t,P,void 0,n).width;_.push({node:t,left:f+(C?0:l-x)+S,width:x,start:r,end:i,height:h-k,top:E+g+b})}else m&&_.push({node:t,left:f+S,width:l,start:r,end:s,height:h-k,top:E+g+b});E+=p}.bind(this))}else _.push({node:t,width:L.width,start:e,end:i,left:u+L.left-I.left,top:E,height:L.height});return _.concat(d)},copyFrmDifferent:function(t,e,i){var a,o=this.findOrder(t),n=this.findOrder(e),r=this.commonOrder(o,n),s=$L("#"+n[r],this.$node),l=this.findPara(i.startNode,s),d=this.findPara(i.endNode,s),c=s.data("list"),p=this.getIndex(c,l),h=this.getIndex(c,d);this.data.ltPropTags;if(p>h){var u=d;d=l,l=u,u=o,o=n,n=u,a=!0}var m=this.getFirstWordInPara(l,!0),f=this.getLastWordInPara(d,!0),g=$L("#"+o[r+1],this.$node),y=g.closest(this.getTag("table")),v=$L("#"+n[r+1],this.$node),b=v.closest(this.getTag("table")),x=y.length?0:a?i.right:i.left,_=b.length?this.getWordText(f).length:a?i.left:i.right;return b.length&&b.get(0)==y.get(0)?this.copyFromTable(g.get(0),v.get(0)):this.copyWithinSame({startNode:m,endNode:f,right:_,left:x})},copyFromSection:function(t){var e=$L(this.$node).find("#"+t.data[0].randomId).get(0).childNodes,i=[],a=function(t){Lyte.arrayUtils(i,"push",this.copyInSameWord(t,0))}.bind(this);return e.forEach(function(t){$L(t).data("list").forEach(a)}.bind(this)),i},findPara:function(t,e){for(var i=e.data("list"),a=0;a<i.length;a++){var o=i[a];if(o.contains(t))return o}},commonOrder:function(t,e){for(var i,a=Math.min(t.length,e.length),o=0;o<=a;o++){if(t[o]!=e[o])return i;i=o}},findOrder:function(t){var e=[t.id],i=$L(t).parent().closest(".listHolderElement",this.$node).get(0);return i&&Lyte.arrayUtils(e,"insertAt",0,this.findOrder(i)),e},reset:function(){var t=this.data,e=t.currentNode,i=t.cursor;t.selectedWords=[{node:e,left:i,right:i}],t.selectedParagraph=[e.parentNode],t.topLevelElement=$L(e).closest(".listHolderElement").get(0),delete this._rangemove},mouseup:function(t){var e;t.touches&&(e=!0);var i=this.data.range,a="cancelAnimationFrame",o="removeEventListener",n=this.__down_evt;i.isRange&&(this.setData("currentNode",i.endNode),this.setData("cursor",i.right),this.setCursor(i.endNode,i.right),this.updateReadOnlyRange(i)),window[a](this._scrollFrame),window[a](this._scrollFrame2),delete this._scrollFrame,delete this._scrollFrame2,delete this._mup,delete this._touchselect,delete this._cy,setTimeout(function(){delete this.__down_evt}.bind(this),10),(e||this.data.touchTest)&&$L(this.$node).removeClass("lyteEditorTouchStart","lyteEditorCursorVisible"),document[o](e?"touchmove":"mousemove",this._mousemove,!0),document[o](e?"touchend":"mouseup",this._mouseup,!0),this.resetWordLines(),!this.data.ltPropBluePencil&&!n&&this.$node.focus(this.__moved),delete this.__moved,(this.data.isMobile||this.data.touchTest)&&(1==this._mobilepop.ltProp("show")?this._mobilepop.ltProp("show",!1):(i.isRange||null==this._longpresstime)&&setTimeout(this.openMobilePop.bind(this),150)),clearTimeout(this._longpresstime),delete this._longpresstime},resetWordLines:function(){var t=this.data.wordLines;t.forEach((function(t){t.splice(0,t.length),delete t._sL,delete t._sT})),t.splice(0,t.length)},check4nested:function(t){if(t){var e=$L(t).data("data");return _lyteUiEditor.isTable(e)||_lyteUiEditor.isSection({data:[e]})?this.getLastWordInPara($L(t).find(this.getTag("paragraph")).get(-1)):t}},getTagName:function(t){return(t.tagName||"").toLowerCase()},getWordFromEventLine:function(t,e){var i=$L(t).data("list"),a=[],o=e.clientY;if(i.forEach(function(t){this.cRects(t).forEach((function(e){o>=e.top&&o<=e.bottom&&a.push({bcr:e,node:t})}))}.bind(this)),a.length){var n,r=1/0,s=e.clientX;return a.forEach((function(t){var e=t.bcr,i=Math.min(Math.abs(e.left-s),Math.abs(e.right-s));r>=i&&(r=i,n=t.node)})),n}var l=this.first(i),d=this.last(i);return this.getBcr(l).top>o?l:d},getNodeFromEvent:function(t,e){var i=e||t.target,a=this.getTagName(i),o=this._maindiv;if(!o.contains(i))return this.getWordFromEventLine(this.getWordFromEventLine(this._maindiv,t),t);if(i==o&&this.check_is_empty(),this.getTag("word")==a)return i;if(this.getTag("paragraph")==a)return this.getWordFromEventLine(i,t);if(/div/i.test(a)){if(this.getTag("word")==this.getTagName(i.parentNode))return i.parentNode}else{if(a==this.getTag("overlayHandle"))return this.getWordFromEventLine(this.getWordFromEventLine(this._maindiv,t),t);if("img"===a)return $L(i).closest("lyte-word",o).get(0)}return $L(i).hasClass("listHolderElement")?this.getWordFromEventLine(this.getWordFromEventLine(i,t),t):void 0},findNearest:function(t,e,i){var a,o=1/0,n=e[i];return t.forEach((function(t){var e=t.top,i=t.bottom,r=Math.min(Math.abs(e-n),Math.abs(i-n));r<o&&(o=r,a=t)})),a},setCursor:function(t,e,i,a){!i&&!a&&!this.data.range.isRange&&this.data.ltPropMobileView&&this.updateEditorDiv(t,e),!i&&this.setData("cursor",e);const o=this.isCodeEditor($L(t.parentElement).data("data"));this.$node.panel&&(o?this.$node.panel.disableAll():this.$node.panel.disableAll(!0));var n=this.data,r=function(){i||n.range.isRange||(this.reset(!0),this.copyToRange())}.bind(this);if(n.ltPropReadonly||n.ltPropDisabled)return r();$L.fastdom.clear(this._measure),this._measure=$L.fastdom.measure((function(){if(delete this._measure,this.$node.offsetParent){var i,a=this._cursor,o=!0,r=t.style.color,s=/var\((.+)\)/,l=window.getComputedStyle(t);if(r&&s.test(r)){var d=r.match(s)[1];if(1==d.split(",").length){var c="var("+d+","+l.color+")";$L(t).css("color",c),r=c}}if($L.fastdom.clear(this._mutate),this.data.navCheck&&this._iframe&&(i=this.cursor_pos(t,e))&&(o=!1),o){i=this.findCursorPos(t,e)||{};var p=parseFloat(l.paddingLeft),h=parseFloat(l.paddingTop),u=parseFloat(l.paddingBottom);i.left+=p,i.top+=h,i.height-=h+u}this._mutate=$L.fastdom.mutate((function(){delete this._mutate;var e,o,s=$L(a),l="lyteReadonlyNode";s.css(i),e="italic"==t.style.fontStyle?"addClass":"removeClass",o=$L(t).hasClass(l)?"addClass":"removeClass",s[e]("lyteCursorItalic")[o](l),s.css("background",r),n.ltPropBluePencil&&this.append_cursor(a)}),this)}}),this),r()},getCursorPosition:function(t,e){for(var i=this.lineBounds(this.cRects(t)),a=this.findNearest(i,e,"clientY"),o=window.getComputedStyle(t),n=t.style.unicodeBidi,r=this.get_dir(t),s=Math.min(a.width,r&&!n||!r&&n?a.right-e.clientX+parseFloat(o.paddingRight):e.clientX-a.left-parseFloat(o.paddingLeft)),l=this.getWordText(t),d=l,c=0,p=this.getIndex(i,a),h=this.comp_style(t),u=i.length,m=0;m<=p;m++){var f=m==p?s:i[m].width,g=this.data.navCheck&&this._iframe?this.m_width(l,f,h).cursor:this.measureLength(l,f,t,h,void 0,m).cursor;c+=g,l=l.slice(g),0==g&&u>1&&(c+=.5)}return n&&(c==d.length?c=0:c||(c=d.length)),c},convertToLine:function(t){for(var e=this.lineBounds(this.cRects(t)),i=this.comp_style(t),a=[],o=e.length,n=this.getWordText(t),r=0,s=i.whiteSpace,l=/normal|nowrap/i.test(s),d=0;d<o;d++){var c=0;l&&/^\s/.test(n)&&(c=n.match(/^\s+/).length);var p=e[d],h=(this.data.navCheck&&this._iframe?this.m_width(n.slice(c),p.width,i).cursor:this.measureLength(n.slice(c),p.width,t,i,void 0,d).cursor)+c;if(l){var u=n.slice(h);if(/^\s/.test(u))h+=u.match(/^\s+/).length}a.push({node:t,start:r,end:r+=h,width:p.width,text:n.slice(0,h),client:p}),n=n.slice(h)}return a},findCursorPos:function(t,e){var i=this.lineBounds(this.cRects(t)),a=i.length;if(0!=a){var o=this.getWordText(t),n=o.slice(0,parseInt(e)),r=this.comp_style(t),s=t.style.unicodeBidi,l=this.get_dir(t),d=this._maindiv,c=l&&s||!l&&!s,p=d.scrollTop,h=d.scrollHeight,u=d.offsetHeight,m=l?u==h?0:_lyteUiUtils.getScrollBarWidth():0,f=d.scrollLeft-m,g=this.getBcr(d),y=this.first(i),v=(y.oriTop||y.top)-g.top,b=r.whiteSpace,x=/normal|nowrap/i.test(b);e=Math.max(0,e);for(var _=0;_<a;_++){if(x&&/^\s/.test(n))e-=P=n.match(/^\s+/).length,n=n.slice(P);var P,L=i[_],w=L.width,I=this.data.navCheck&&this._iframe?this.m_width(n,w,r):this.measureLength(n,w,t,r,void 0,_),E=I.cursor;if(n=n.slice(E),x&&_==a-1)if(/^\s$/.test(n))E+=P=n.match(/^\s+/).length;if(E>=e||E==e+.5||.5==e||_+1==a){var C={height:L.oriHeight||L.height,top:p+v+(L.oriTop||L.top)-(i[0].oriTop||i[0].top),left:f+(c?I.width:L.width-I.width)+L.left-g.left};return s&&(o.length==E?C.left+=L.width*(l?-1:1):E||(C.left+=L.width*(l?1:-1))),C}e-=E}}},nonFocusClick:function(t){!this.data.ltPropBluePencil&&this.$node.focus();var e=this._count||0,i=this.data.ltPropSelectionDelay;clearTimeout(this._selectclick),this._count=e+1;var a,o,n=this._count;switch(n%4){case 2:o=a="selectWord";break;case 3:o=a="selectParagraph";break;default:n>3&&(a="resetRange")}a&&setTimeout(function(){o&&this.resetRange(),this[a]()}.bind(this),i/5),this._selectclick=setTimeout(function(){delete this._count}.bind(this),i);var r=$L(this.data.currentNode);if($L(t.target).closest(r,this._maindiv).length&&r.hasClass("lyteEditorAnchor"))if(this.metakeycheck(t))try{this.openAnchor()}catch(t){console.warn("Caught error at new tab opening"+t.message)}else this.anchorOpen()},getIndex:_lyteUiEditor.getIndex,first:_lyteUiEditor.first,last:_lyteUiEditor.last,cRects:function(t){return this.changeWithOtherword(this.toArray(t.getClientRects()).map((function(t){return{x:t.x,y:t.y,left:t.left,right:t.right,bottom:t.bottom,top:t.top,height:t.height,width:t.width}})),t.parentNode,t)},formLine:function(t){var e=t[0],i=t.length,a=[e],o=[a];if(0==i)return[];for(var n=1;n<i;n++){var r=t[n];e.client.top==r.client.top||e.client.top<=r.client.top&&e.client.bottom>=r.client.top||e.client.top<=r.client.bottom&&e.client.bottom>=r.client.bottom?a.push(r):(a=[r],o.push(a)),e=r}return o},changeWithOtherword:function(t,e,i){var a=$L(e).data("list")||[],o=this.last(t);return a.every(function(e){var a=this.toArray(e.getClientRects()),n=a[0];return e==i||!(!n||n.top>=o.bottom)&&(a.forEach(function(e){t.forEach(function(t){(e.top>=t.top&&e.bottom<=t.bottom||e.top<=t.top&&e.bottom>=t.bottom)&&(t.oriHeight=t.oriHeight||t.height,t.oriTop=t.oriTop||t.top,t.oriBottom=t.oriBottom||t.bottom,t.top=Math.min(t.top,e.top),t.bottom=Math.max(t.bottom,e.bottom),t.height=Math.max(t.height,e.height))}.bind(this))}.bind(this)),!0)}.bind(this)),t},lineBounds:function(t){for(var e=t[0],i=t.length,a=1;a<i;a++){var o=t[a];o.top==e.top?(e.width+=o.width,e.right=o.right,i--,t.splice(a,1),a--):e=o}return t},toArray:function(t){return Array.from?Array.from(t):Array.apply(Array,t)},isLastInLine:function(t,e){var i=this.last(e),a=this.last(this.cRects(this.getLastWordInPara(t.parentNode)));return i.top>=a.top&&i.bottom<=a.bottom||i.top<=a.top&&i.bottom>=a.bottom},findSpaceWidth:function(t,e,i,a,o,n){var r=[],s=0,l=this,d=l.getWordText(t),c=e.length-1,p=l.isLastInLine(t,e),h=l.measureWidth(" ",this.getFontFromStyle(i),i);return e.forEach((function(e,u){var m=d.slice(s);if(p&&u==c)v=0;else{var f=l.data.navCheck&&l._iframe?l.m_width(m,e.width,i).cursor:l.measureLength(m,e.width,t,i,!0).cursor,g=d.slice(s,f+s).lastIndexOf(" "),y=s+(-1==g?f:++g),v=e.width-l.measureLength(d.slice(s,y),void 0,t,i,!0).width;m=d.slice(s,y),s=y}if(null==a||a==u){for(var b=m.split(" "),x=0;""==l.last(b);)b.pop(),x++,v+=h;for(var _=b.length-1,P=0;P<_;P++)r.push(v/_+h+o+n);for(P=0;P<x;P++)r.push(0)}})),r},find_emoji:function(t,e,i,a){var o=this.__e_cache||(this.__e_cache={}),n=o[i]||(o[i]={}),r=n[t.charAt(0)];if(void 0!==r)return r;if(/^[A-z]/.test(t||""))return n[t.charAt(0)]=0;var s=new RegExp("(\\p{Emoji}|\\p{Extended_Pictographic})","u").exec(t);if(!s&&!(s=this.__overall_emoji.exec(t)))return n[t.charAt(0)]=0;var l=s[0];if(s.index)return n[t.charAt(0)]=0;var d=l.length,c=/[\uD800-\uDBFF][\uDC00-\uDFFF]/.exec(t.slice(d));if(c&&0==c.index){var p=c[0].length,h=this.measureWidth(t.slice(0,d),i,a,!0),u=this.measureWidth(t.slice(d,d+p,!0),i,a),m=this.measureWidth(t.slice(0,d+p),i,a,!0);0!=Math.round(Math.abs(h+u-m))&&(d+=p)}if([57343,57342,57341,57340,57339].forEach((function(e){t.charCodeAt(d)==e&&d++})),t[d]==e){var f=e.length;return n[t.charAt(0)]=d+f+this.find_emoji(t.slice(d+f),e)}return"️"==t[d]?n[t.charAt(0)]=d+"️".length:n[t.charAt(0)]=d},find_letters:function(t,e,i,a){if(/^[A-Z]$/i.test(t[0]||""))return 1;for(var o=this.measureWidth(t[0],e,i),n=1,r=t.length;n<r;n++){if(t[n]!=a){var s=this.measureWidth(t[n],e,i),l=this.measureWidth(t.slice(0,n+1),e,i);if(Math.abs(o+s-l)<1.5)break;o=l}}return n-0},measureLength:function(t,e,i,a,o,n){var r=a||this.comp_style(i),s=parseFloat(r.letterSpacing);switch(r.textTransform){case"uppercase":t=t.toUpperCase();break;case"lowercase":t=t.toLowerCase();break;case"capitalize":t=t.replace(/\b\w/g,(function(t){return t.toUpperCase()}))}if(s=isNaN(s)?0:s,this.data.navCheck&&this._iframe&&null==e)return this.m_width(t,e,r);var l,d=0,c=this._canvas.font=this.getFontFromStyle(r),p=i&&this.isSpaceWord($L(i).data("data")),h=t.length,u=p?this.getWordText(i).length:0,m=p?this.convertToPx(r.width):0,f=this.convertToPx(r.wordSpacing),g=[],y=[],v=0,b="justify"==r.textAlign&&!o,x=/normal|nowrap/i.test(r.whiteSpace),_=[8205].map((function(t){return String.fromCharCode(t)})),P=0;if(b){var L=this.lineBounds(this.cRects(i));y=this.findSpaceWidth(i,L,a,n,s,f)}for(var w=0;w<h;w++){var I;if(p&&m)I=m/u-s,g.push(t[w]);else{var E=t[w];if(/\s/.test(E))if(P=w,I=this.measureWidth(E,c,r),b){var C=y[v++];I=null==C?I:C}else{if(x&&/\s/.test(t[w-1]||"")){I=0,g[g.length-1]+=E;continue}I+=f+s,g.push(E)}else{var T,N=this.find_emoji(t.slice(w),_[0],c,r);T=N?w+N:w+this.find_letters(t.slice(w),c,r,_[0]),I=this.measureWidth(t.slice(P,T).trim(),c,r)-this.measureWidth(t.slice(P,w).trim(),c,r),I+=s,g.push(t.slice(w,T)),w=T-1}}if(null!=e&&(e-=I)<0){e+I>.5*I?(d+=I,w++,l=!0):w-=g.pop().length-1;break}d+=I}return{letters:g,width:d,excess:l,cursor:w,element:i,endSpace:0,endSpaceWid:0}},isSpaceWord:function(t){return/^\s+$/.test(t.text)},is_emoji:function(t,e){return!!this._emojiRegex.test(t)||(!!this.__overall_emoji.test(t)||t.length>=2&&(/^\&\#x/.test(t)||1==t.indexOf("️")))},split_emoji:function(t,e,i){for(var a=[],o=String.fromCharCode(8205),n="";t.length;){var r=this.find_emoji(t,o,e,i);r?a.push(t.slice(0,r)):(n+=t.slice(0,1),r=1),t=t.slice(r)}return n&&a.push(n),a},measureWidth:function(t,e,i,a){var o=this.__cache||(this.__cache={}),n=o[e]||(o[e]={}),r=n[t];if(null!=r)return r;if(this._iframe&&this.data.isMac&&this.is_emoji(t)){if(!a){var s=this.split_emoji(t,e,i);if(s.length>1){var l=0;return s.forEach(function(t){l+=this.measureWidth(t,e,i,!0)}.bind(this)),n[t]=l}}return n[t]=this.measureFrmFrame(t,e,i)}return n[t]=this._canvas.measureText(t).width},measureFrmFrame:function(t,e,i){var a=this.__cache||(this.__cache={}),o=a[e]||(a[e]={}),n=o[t];if(null!=n)return n;var r=this._iframe.contentDocument,s=r.body;s.innerHTML="<span style='font:"+e+"'></span>",a[e]=o;var l=s.children[0];return l.appendChild(r.createTextNode(t)),o[t]=l.getBoundingClientRect().width},convertToPx:function(t){var e=/px|pt|cm|mm|in/i;if(e.test(t)){var i=t.match(e)[0];return parseFloat(t)*({px:1,pt:1.3281472327365,in:96,cm:37.795275591,mm:3.7795275591}[i]||1)}return 0},getFontFromStyle:function(t){var e=t.font;if(e)return e;var i=[];return["fontStyle","fontVariant","fontWeight","fontSize","fontFamily"].forEach((function(e){var a=t[e];a&&i.push(a)})),i.join(" ")},getWordText:function(t){return t==this.__compose?t.innerText:$L(t).data("data").text},keydown:function(t){if(this.check_is_empty(),!this._mentionopen||!this.mentionsKeydown(t)){var e=this._popover;e&&e.ltProp("show",!1);var i=t.altKey,a=t.shiftKey,o=this.metakeycheck(t),n=(t.key,this.getValueForShortcut(t,o,a,i)),r=navigator.userAgent,s=this.data;if(n){var l=n.value,d="onShortcutApply",c=function(e){return this.getMethods(d)&&this.executeMethod(d,t,n,this.$node),e&&t.preventDefault(),!0}.bind(this);if(this[l]){if((s.ltPropReadonly||s.ltPropDisabled)&&!("selectAll"==l||/move/i.test(l)&&a))return;return this.getMethods("onBeforeShortcutApply")&&this.executeMethod("onBeforeShortcutApply",t,n,this.$node),c(0!=this[l](o,a,i,n.css))}return this["toggle"+(n.scope||"Word")+"Class"](n.value,n.css),c(1)}if(/firefox/i.test(r)&&/linux/i.test(r)){var p=_lyteUiUtils.copyFrmEvt,h=this.$node;if(p){var u=t.key;/^(x|c)$/i.test(u)&&p(this.getSelectedText(),t,h,h.focus)&&"x"==u&&!s.ltPropReadonly&&!s.ltPropDisabled&&this.removeSelected()}}}},getValueForShortcut:function(t,e,i,a){var o=_lyteUiUtils.getCorrectNumberCode(t.keyCode||t.which),n=this.data.ltPropShortcuts[o],r=this,s=this.data.shortCutCheckObject;if(229===t.keyCode&&"Process"===t.key&&t.ctrlKey){let e=s.indexOf(t.code),i=t.code.match(/^Key(\w+)$/);i&&-1!=e&&(n=this.data.ltPropShortcuts[i[1].charCodeAt(0)],n&&(this._editdiv.blur(),window.requestAnimationFrame((function(){r._editdiv.focus()}))))}if(n){for(var l,d=0;d<n.length;d++){var c=n[d];if(c.any)return c;!!c.ctrl==e&&!!c.shift==i&&!!c.alt==a&&(l=c)}return l}},metakeycheck:function(t){var e=this._isMac;return!e&&t.ctrlKey||e&&t.metaKey},remove_br:function(t){Array.from(t.childNodes).forEach(function(t){this.getTagName(t)&&t.remove()}.bind(this))},insertTextInWord:function(t){if(t){var e=this._editdiv;e.textContent=t,this.processInput(e)}},replace_text:function(t){var e=this.data.ltPropReplaceLetters;if(t)for(var i in e)t=t.replace(new RegExp(i,"g"),e[i]);return t},processInput:function(t,e){if(!this._pastePrevent){var i=this.data;i.range.isRange&&this.removeSelected(void 0,void 0,t.innerHTML),this.remove_br(t);var a=this.check_limit(this.convertCase(this.replace_text(this.data.ltPropMobileView||""!=t.innerHTML?t.innerHTML:e?e.data:"")),!0).html;if(!a&&!this.data.ltPropMobileView)return t.textContent="";if(this._suggestionWord){let t=this._suggestionWord.innerText;""==t&&this.removeSuggestion(),t[0]==a&&(this._suggestionWord.innerText=t.slice(1))}this.updateRangeNode();var o,n=i.currentNode,r=i.cursor,s=n.parentNode,l=$L(s).data("data"),d=this.data.ltPropMobileView,c=this.getWordText(n),p=d?a:c.slice(0,r)+a+c.slice(r),h=$L(n),u="onBeforeInput",m=i.range,f=function(e){var i=this.findIndex(n);e&&0!=r&&.5!=r?i.wordIndex++:e||i.wordIndex++,this.setData("currentNode",this.insertSingleWord(this.emptyWordData(),i)),this.setData("cursor",0),this.processInput(t)}.bind(this);if(this.data.ltPropDetectList&&n===this.getFirstWordInPara(s)&&" "==a&&-1==l.classList.indexOf("lyteEditorTab")){let t=this.detectList(s,p);t&&(this.updateNodeValue(n,p=""),this["ul"===t.type?"list":"ordered"](t.index),o=0)}if(!m.isRange&&n==this.getLastWordInPara(s)&&h.hasClass("lyteEditorAnchor")&&r==c.length)return f();if(h.hasClass("lyteEditorImage")||h.parent().hasClass("lyteEditorHrTag"))return this.imageText(n),this.processInput(t);if(h.hasClass("lyteReadonlyNode"))return f(!0);if(this.data.ltPropDiacriticHandler&&(!e||"insertReplacementText"!=e.inputType)||this.data.ltPropMobileView||(this.toArray(t.childNodes).forEach((function(t){t.tagName?t.remove():t.nodeValue&&(t.nodeValue="")})),this.createRange(t.childNodes[0],0)),!this.getMethods(u)||0!=this.executeMethod(u,n,c,i.cursor,a,this.$node)){if(this.isCodeEditor(l))return this.insertTextInSnippet(n,s,l,a);this.update_count(a.length),this.setData("cursor",d?window.getSelection().getRangeAt(0).endOffset:null!=o?o:i.cursor+a.length),this.updateNodeValue(n,p),this.setCursor(i.currentNode,i.cursor),this.check_rtl(s),this.checkTrigger(),this.scrollIntoView(i.currentNode,i.cursor),u="onAfterInput",this.getMethods(u)&&this.executeMethod(u,i.currentNode,i.cursor,this.$node),i.ltPropBluePencil&&this.dispatch_input(),i.ltPropUrlDetection&&i.ltPropUrlDetectionOptions.input&&/^\s$/.test(a)&&this.url_detection(),this.callFind()}}},detectList:function(t,e){let i=this.data.ltPropListMatchMap,a=this.data.listRegex;for(let o in i)if(a[o].test(e)){let n="olDecimal"===o?"olDecimalLeadingZero":"olDecimalLeadingZero"===o?"olDecimal":"";if(n&&a[n].test(e)){let e=t.previousElementSibling;if(e){let t=$L(e).data("data");-1!=t.classList.indexOf("lyteEditorTab")&&(o=_lyteUiEditor.camelCase("ol-"+this.data.ltPropOrderedList[t.attr.tabIndexValue-1].conversionName))}}let r=this.getListIndex(i[o]),s=this.data["ol"===r.type?"ltPropOrderedList":"ltPropUnOrderedList"][r.index-1];s.order=this.getTabIndex(t,1,r.index);let l=this.getBulltet(s);if("ul"==r.type||e.slice(0,-1)===l)return r}},getListIndex:function(t){if(t.startsWith("ol")){let e=this.data.ltPropOrderedList;for(let i=0;i<e.length;i++){let a=e[i];if(_lyteUiEditor.camelCase("ol-"+a.conversionName)==t)return{type:"ol",index:i+1}}}let e=this.data.ltPropUnOrderedList;for(let i=0;i<e.length;i++){let a=e[i];if(("custom"!==a.name?_lyteUiEditor.camelCase(a.name):a.conversionName)===t)return{type:"ul",index:i+1}}},updateNodeValue:function(t,e,i,a,o,n){var r=$L(t),s=r.data("data"),l=s.text,d=this.findIndex(t),c=e;if(null==e&&(e=l),this.data.ltPropCapitalizeWord&&0==d.wordIndex&&(e.includes(" ")||e.includes(" "))){let t,i,a=!1;for(t=1;t<=e.length;t++){if(a&&(" "==e.charAt(t-1)||" "==e.charAt(t-1))){i=t;break}a||" "==e.charAt(t-1)||" "==e.charAt(t-1)?" "==e.charAt(t-1)&&" "==e.charAt(t-1)&&(i=t):a=t}0!=a&&a<i&&(e=e.slice(0,a-1)+e.charAt(a-1).toUpperCase()+e.slice(a))}if(r.hasClass("lyteEditorImage")||s.text!=e&&(t.textContent=s.text=e),a||this.checkTrigger(),o&&(this.data.firstValue=l),!this.isUndo()){var p,h,u,m=this.data.range,f=r.closest(".listHolderElement").data("randomId");i||(u={wordIndex:d.wordIndex,position:this.data.cursor}),m.isRange&&t==m.startNode&&(p={wordIndex:d.wordIndex,position:m.left}),m.isRange&&t==m.endNode&&(h={wordIndex:d.wordIndex,position:m.right}),n&&(this.pushToQueue({operation:"update",oldValue:this.data.firstValue,newValue:e,id:f,index:d.paraIndex,wordIndex:d.wordIndex,current:{index:u,start:p,end:h}}),this.data.firstValue=void 0),null==o&&this.pushToQueue({operation:"update",oldValue:l,newValue:e,id:f,index:d.paraIndex,wordIndex:d.wordIndex,current:{index:u,start:p,end:h}}),!c||null!=s.attr&&null!=s.attr.editable&&0!=Object.keys(s.attr).length&&1!=s.attr.editable||this.mention_update(s,r,l,f,d)}},unescapeText:_lyteUiEditor.unescapeText,resetQueue:function(){clearTimeout(this._undotime);var t=this.data;t.undoqueue.splice(0),t._undoqueue.splice(0),t.redoqueue.splice(0),this.callQueueUpdate("reset")},getSpaceForTab:_lyteUiEditor.getSpaceForTab,convertCase:function(t){var e=this.data.ltPropUpperCase;return"lower"==e?t.toLowerCase():"upper"==e?t.toUpperCase():t},findIndex:function(t,e,i){var a=t.parentNode,o=$L(a).data("list"),n=$L(a).closest(".listHolderElement"),r=n.data("list")||[],s=o.indexOf(t),l=s,d=r.indexOf(a),c={id:n.data("randomId"),position:e,wordOrder:l,paraIndex:d,wordIndex:s};if(i){var p=this._maindiv==n.get(0),h=this.convertToLine(t),u=this.data.cursor;c.isFirstPara=p&&0==d&&h[0].start<=u&&h[0].end>=u,c.isLastPara=p&&d==$L(this._maindiv).data("list").length-1&&$L(h).get(-1).start<=u&&$L(h).get(-1).end>=u}return c},processWord:function(t){var e=this.data.currentNode,i=this.getValueForAlt(e,this.data.cursor,t),a=this.data.range;i&&(this.reset(),a={fakeRange:!0,isRange:!0,startNode:e,left:this.data.cursor,endNode:i.node,right:i.change},this.getSelected(a),this.removeSelected(a))},backspaceWord:function(){this.processWord()},deleteWord:function(){this.processWord(!0)},isInsideSection:function(t){let e=$L(t).closest(".listHolderElement").data("data");return!(!e.attr||!e.attr.hasOwnProperty("data-section"))},createSection:function(t,e){let i=this.emptyParaData(),a={attr:{"data-section":""},classList:e||[],data:[],tag:"div",randomId:this.randomId()};return $L.extend(a,t),i.data[0].attr={"data-section":"true"},i.data[0].details={type:"section"},i.data[0].data=[a],i},isSection:function(t){return _lyteUiEditor.isSection({data:[$L(t).data("data")]})},isSectionEmpty:function(t){let e=$L(t).closest(".listHolderElement").data("data");return e.data&&e.data.length<=1},removeSection:function(t){let e=this.getPreviousWord(t),i=$L(t).closest(".listHolderElement",this.$node).closest("lyte-paragraph",this.$node).get(0),a=$L(t).closest(".listHolderElement",this.$node).closest("lyte-word",this.$node).get(0),o=this.findIndex(a);if(e)this.removePara(i),this.setData("currentNode",e),this.setCursor(e,this.getWordText(e).length);else{this.deleteSingleWord(a,o),this.insertSingleWord(this.emptyWordData(),o);let t=this.getFirstWordInPara(i);this.setData("currentNode",t),this.setCursor(t,this.getWordText(t).length)}},backspace:function(t,e){var i=this.data,a=i.range;if(a.isRange)return this.removeSelected(),void((t||e)&&this.backspace());var o,n,r=i.currentNode,s=r.parentNode,l=$L(s).data("data"),d=parseInt(i.cursor),c=this.findIndex(r),p=this.__ignore?0:1,h=$L(r),u=h.hasClass("lyteReadonlyNode"),m=function(){var t=Lyte.objectUtils;t(a,"add","left",0),t(a,"add","right",d),t(a,"add","startNode",r),t(a,"add","endNode",r),t(a,"add","isRange",!!d),this.common_positioning()}.bind(this);if(0==d){if(h.hasClass("lyteEditorImage")||h.parent().hasClass("lyteEditorHrTag"))return this.deleteImage(r);var f=$L(s),g=f.data("data");if(this.isEmptyPara(g)&&0==c.paraIndex){var y=i._undoqueue,v=y.filter((function(t){return"meta"!=t.type})).length;if(this.isInsideSection(r)&&this.isSectionEmpty(r))return void this.removeSection(r);if(this.clearFormat(!0),v!=y.filter((function(t){return"meta"!=t.type})).length)return}if(f.hasClass(i.tabClass)&&0==c.wordIndex)return this.list(void 0,"OL"==g.details.tab.type?i.ltPropOrderedList:i.ltPropUnOrderedList,!0);var b=this.getPreviousWord(r,!0),x=$L(b),_=x.hasClass("lyteReadonlyNode");if(b&&b.parentNode==s&&_&&(this.updateRangeNode(),this.deleteSingleWord(b,this.findIndex(b)),b=this.getPreviousWord(r,!0),p=0,c.wordIndex--,c.wordOrder--,this.checkPlaceholder()),!b||x.closest(".listHolderElement").get(0)!=h.closest(".listHolderElement").get(0))return this.common_positioning();if(x.hasClass("lyteEditorImage")||x.parent().hasClass("lyteEditorHrTag"))return this.deleteImage(b);if(o=this.getWordText(r).length?void 0:r,b.parentNode!=r.parentNode){if(this.updateRangeNode(),this.mergePara(r))return this.setCursor(i.currentNode,i.cursor),this.updateRangeNode();p=0}!_&&x.hasClass("lyteEditorAnchor")&&(p=0,n=m),r=b,d=this.getWordText(b).length}else if(u){b=this.getPreviousWord(r,!0);this.update_count(-this.getWordText(r).length),o=r,b||(this.updateRangeNode(),b=this.insertSingleWord(this.emptyWordData(),c),c=this.findIndex(o)),d=this.getWordText(r=b).length,p=0}else if(d&&h.hasClass("lyteEditorAnchor")&&d==h.data("data").text.length)return m();var P,L=this.getWordText(r),w=L.slice(0,d);if(p=n||u?p:this.findPrevChar(w,r),P=d-p,o){this.updateRangeNode();var I=o.parentNode,E=$L(I).closest(".listHolderElement").data("list"),C=this.getIndex(E,I);1==$L(I).data("list").length?this.isCaption(I)||1==E.length||this.isTable($L(E[C-1]).data("data"))||this.removePara(I):this.deleteSingleWord(o,c)}else this.updateRangeNode();this.update_count(-p),this.setData("cursor",P),this.setData("currentNode",r),this.updateNodeValue(r,L.slice(0,P)+L.slice(P+p)),l.details.snippet?this.insertTextInSnippet(r,s,l):(this.setCursor(r,P),this.check_rtl(r.parentNode)),n&&n(),this.callFind()},delete:function(){var t=this.data,e=t.range;if(e.isRange)return this.removeSelected();var i,a,o=t.currentNode,n=parseInt(t.cursor),r=this.findIndex(o),s=1,l=$L(o).hasClass("lyteReadonlyNode"),d=function(){var t=Lyte.objectUtils;t(e,"add","left",0),t(e,"add","right",c),t(e,"add","startNode",o),t(e,"add","endNode",o),t(e,"add","isRange",!!c),this.common_positioning()}.bind(this),c=this.getWordText(o).length;if(n==c){var p=this.getNextWord(o,!0),h=$L(p),u=h.hasClass("lyteReadonlyNode");if(h.hasClass("lyteEditorImage")||$L(o).parent().hasClass("lyteEditorHrTag"))return this.deleteImage(p);if(this.isInsideSection(o)&&this.isSectionEmpty(o)&&this.isEmptyPara($L(o.parentNode).data("data")))return void this.removeSection(o);if(p&&p.parentNode==o.parentNode&&u&&(this.updateRangeNode(),this.deleteSingleWord(p,this.findIndex(p)),p=this.getNextWord(o,!0),s=0),!p||h.closest(".listHolderElement").get(0)!=h.closest(".listHolderElement").get(0))return this.checkPlaceholder(),this.common_positioning();if(i=this.getWordText(o).length?void 0:o,p.parentNode!=o.parentNode){if(this.updateRangeNode(),this.mergePara(p,!0))return this.setCursor(t.currentNode,t.cursor),this.updateRangeNode();s=0}!u&&h.hasClass("lyteEditorAnchor")&&(s=0,a=d,c=this.getWordText(p).length),o=p,n=0}else if(l){p=this.getNextWord(o,!0);this.update_count(-this.getWordText(o).length),i=o,p||(this.updateRangeNode(),p=this.insertSingleWord(this.emptyWordData(),r),r=this.findIndex(i)),n=0,s=0,o=p}else if(!n&&$L(o).hasClass("lyteEditorAnchor"))return d();var m=this.getWordText(o),f=m.slice(n),g=n;if(s=a?s:this.findPrevChar(f,o,!0),i){this.updateRangeNode();var y=i.parentNode,v=$L(y).closest(".listHolderElement").data("list"),b=this.getIndex(v,y);1==$L(y).data("data").length?this.isCaption(y)||1==v.length||this.isTable($L(v[b-1]).data("data"))||this.removePara(y):this.deleteSingleWord(i,r)}else this.updateRangeNode();this.update_count(-s),this.setData("cursor",g),this.updateNodeValue(o,m.slice(0,g)+m.slice(g+s)),this.setData("currentNode",o),this.setCursor(o,g),this.check_rtl(o.parentNode),this.callFind(),a&&a()},updateEditorDiv:function(t,e,i){if(this.data.ltPropMobileView){let a=t.textContent;this._editdiv.textContent!=a&&(this._editdiv.textContent=t.textContent),this.createRange(this._editdiv.childNodes[0],e,i)}},backspaceLine:function(){var t=this.data,e=t.currentNode,i=parseInt(t.cursor),a=this.getLWindex(e,t.cursor),o=a.lineIndex,n=a.wordIndex,r=a.lines[o];if(i==r[n].start)return this.backspace();if(0==i&&0==n)return 0==o&&this.mergePara(e)?(this.setCursor(t.currentNode,t.cursor),this.updateRangeNode()):this.backspace();this.updateRangeNode();for(var s=n-1;s>=0;s--){var l=r[s],d=l.node,c=(p=this.getWordText(d)).length;(p=p.slice(0,l.start)+p.slice(l.end))?this.updateNodeValue(d,p):this.deleteSingleWord(d,this.findIndex(d)),this.update_count(p.length-c)}var p,h=r[n];c=(p=this.getWordText(h.node)).length;p=p.slice(0,h.start)+p.slice(i),this.update_count(p.length-c),this.updateNodeValue(h.node,p),this.setCursor(t.currentNode,h.start==p.length?h.start:h.start+.5),this.resetRange(),this.check_rtl(t.currentNode.parentNode),this.updateRangeNode()},deleteLine:function(){var t=this.data,e=t.currentNode,i=parseInt(t.cursor),a=this.getLWindex(e,t.cursor),o=a.lineIndex,n=a.wordIndex,r=a.lines[o],s=r.length;if(i==r[n].end)return this.delete();if(i==this.getWordText(e).length&&n==r.length-1)return o==a.lines.length-1&&this.mergePara(e,!0)?(this.setCursor(t.currentNode,t.cursor),this.updateRangeNode()):this.delete();this.updateRangeNode();for(var l=n+1;l<s;l++){var d=r[l],c=d.node,p=(h=this.getWordText(c)).length;(h=h.slice(0,d.start)+h.slice(d.end))?this.updateNodeValue(c,h):this.deleteSingleWord(c,this.findIndex(c)),this.update_count(h.length-p)}var h,u=r[n];p=(h=this.getWordText(u.node)).length;h=h.slice(0,i)+h.slice(u.end),this.update_count(h.length-p),this.updateNodeValue(u.node,h),this.setCursor(t.currentNode,Math.min(h.length,i+(i==u.start?.5:0))),this.resetRange(),this.check_rtl(t.currentNode.parentNode),this.updateRangeNode()},getBcr:function(t,e){var i=t.getBoundingClientRect();return e?i[e]:i},break_rgx:function(){return this.__break_rgx||(this.__break_rgx=["32","160","11","16","17","18","28","3","14","15","61183","61182","19","13","10","9","96","126","33","64","35","36","37","94","38","42","40","41","8211","8212","45","95","43","61","124","123","125","91","93","59","58","34","8220","65533","63","47","92","46","44","8222","60","171","187","62","191","161"].map((function(t){return String.fromCharCode(Number(t))})))},split_word:function(t){if(!t)return[""];for(var e,i=this.break_rgx(),a=new RegExp("[\\u0028\\u005B\\u00AB\\u2018\\u201C\\u3008\\u300A\\u300C\\u300E\\u3010\\u3014\\u3016\\u3018\\u301D\\uFF08\\uFF3B\\uFF5F\\uFF5B]*[\\u2F00-\\u30FF\\u3190-\\u319F\\u31C0-\\u3AEF\\u4E00-\\u9FCF\\uF900-\\uFAFF\\uFE10-\\uFE1F\\uFE30-\\uFE4F\\uFF00-\\uFFEF][\\u002C\\u0029\\u005D\\u00BB\\u2019\\u201D\\u3001\\u3009\\u300B\\u300D\\u300F\\u3011\\u3015\\u3017\\u3019\\u301F\\u3005\\u303B\\u30FC\\u30FD\\u30FE\\u30A1\\u30A3\\u30A5\\u30A7\\u30A9\\u30C3\\u30E3\\u30E5\\u30E7\\u30EE\\u30F5\\u30F6\\u3041\\u3043\\u3045\\u3047\\u3049\\u3063\\u3083\\u3085\\u3087\\u308E\\u3095\\u3096\\u31F0\\u31F1\\u31F2\\u31F3\\u31F4\\u31F5\\u31F6\\u31F7\\u31F8\\u31F9\\u31FA\\u31FB\\u31FC\\u31FD\\u31FE\\u31FF\\u2010\\u2013\\u301C\\u30A0\\u0021\\u002E\\u003A\\u003B\\u003F\\u203C\\u2047\\u2048\\u2049\\u3001\\u3002\\u30FB\\uFF01\\uFF1F\\uFF09\\uFF3D\\uFF5D\\uFF60]*","gm"),o=[],n=t.length,r="",s=0;s<n;s++){var l=t[s];(e=a.test(l)||i.indexOf(l)+1)?(o.push(r),r=""):r+=l}return(r||e)&&o.push(r),o},getValueForAlt:function(t,e,i,a){var o,n=this.getWordText(t).slice(i?e:0,i?void 0:e),r=this.split_word(n),s=this.findIndex(t),l=a?0:1;if(1!=r.length)return{node:t,change:i?this[i?"first":"last"](r).length+l+e:e-(this[i?"first":"last"](r).length+l)};if(!i&&0==s.wordIndex&&(e&&a||!e))return{node:t,change:0};if(i&&n&&s.wordIndex==$L(t).parent().data("list").length-1)return{node:t,change:n.length+e};if(o=this[i?"getNextWord":"getPreviousWord"](t,!0,a)){var d,c=(d=i?this.getValueForAlt(o,0,!0,a):this.getValueForAlt(o,this.getWordText(o).length,!1,a)).node,p=d.change;if(i){if(p)return d}else if(p!=this.getWordText(c).length)return d}return{node:t,change:i?this.getWordText(t).length:0}},getNextWord:function(t,e,i,a){var o,n=this.findIndex(t),r=t.parentNode,s=$L(r),l=s.data("list"),d=s.closest(".listHolderElement").get(0),c=$L(d).data("list"),p=n.wordIndex,h=n.paraIndex,u=function(){return o.classList.contains("lyteEditorMentionWord")&&o.classList.contains("lyteReadonlyNode")&&a?(this._hadMention=!0,this.getNextWord(o,e,i,a)):o}.bind(this);if(p==l.length-1){if(h==c.length-1){if(e)return;return o=this.getNextElement(d),fn=function(){var t=s.closest(this.getTag("word")).get(0);if(t)return this.getNextWord(t)}.bind(this),o?this.getPreviousElement(o)==d?this.getFirstWordInPara(this.first($L(o).data("list"))):fn():fn()}if(i)return;return o=this.getFirstWordInPara(c[h+1]),u()}return o=l[p+1],u()},getPreviousWord:function(t,e,i,a){var o,n=this.findIndex(t),r=t.parentNode,s=$L(r),l=s.data("list"),d=s.closest(".listHolderElement").get(0),c=$L(d).data("list"),p=n.wordIndex,h=n.paraIndex,u=function(){return o.classList.contains("lyteEditorMentionWord")&&o.classList.contains("lyteReadonlyNode")&&a?(this._hadMention=!0,this.getPreviousWord(o,e,i,a)):o}.bind(this);if(0==p){if(0==h){if(e)return;return o=this.getPreviousElement(d),fn=function(){var t=s.closest(this.getTag("word")).get(0);if(t)return this.getPreviousWord(t)}.bind(this),o?this.getNextElement(o)==d?this.getLastWordInPara(this.last($L(o).data("list"))):fn():fn()}if(i)return;return o=this.getLastWordInPara(c[h-1]),u()}return o=l[p-1],u()},getNextElement:function(t){var e=$L(t),i=e.parent().closest(".listHolderElement",this.$node);if(i.length){if((this._vert||this.__shiftmove)&&-1!=this.getIndex([this.getTag("td"),this.getTag("th")],this.getTagName(t))){var a=this.table_next(e,t);if(a)return a}var o=this.changeToTopLevelForTable(this.toArray(i.find(".listHolderElement")).filter((function(t){return"none"!=t.style.display}))),n=this.getIndex(o,t);return n==o.length-1?this.getNextElement(i.get(0)):o[n+1]}},changeToTopLevelForTable:function(t){return t},getPreviousElement:function(t){var e=$L(t);if(e.parent().closest(".listHolderElement",this.$node).length){if((this._vert||this.__shiftmove)&&-1!=this.getIndex([this.getTag("td"),this.getTag("th")],this.getTagName(t))){var i=this.table_prev(e,t);if(i)return i}return $L(this.getPreviousWord($L(t).closest("lyte-word")[0])).closest(".listHolderElement")[0]}},deleteSingleWord:function(t,e,i){var a=t.parentNode,o=$L(a),n=o.data("data"),r=o.data("list"),s=e.wordIndex;i=i||e.id,n.data.splice(s,1),r.splice(s,1),t.remove(),this.isUndo()||this.pushToQueue({operation:"wordDelete",data:$L(t).data("data"),index:e,id:i})},insertSingleWord:function(t,e,i){i=e.id||i;var a=$L("#"+i,this._maindiv.parentNode).data("list")[e.paraIndex],o=$L(a),n=o.data("data"),r=o.data("list"),s=this.render(t),l=e.wordIndex,d=Lyte.Component;return n.data.splice(l,0,t),r.splice(l,0,s),1==r.length?this.append(a,s):0==l?d.insertBefore(r[1],s):d.insertAfter(r[l-1],s),this.isUndo()||this.pushToQueue({operation:"wordInsert",data:t,index:e,id:i}),s},convertToParaFormat:function(t){return this.extend($L(t).data("data"))},removePara:function(t){var e=$L(t),i=e.closest(".listHolderElement"),a=i.data("list"),o=i.data("data"),n=this.getIndex(a,t);if(this.data.ltPropCountNewLine&&this.update_count_in_delete(o,n,a.length),a.splice(n,1),(o.data||o).splice(n,1),this.isUndo()||this.pushToQueue({operation:"paragraphRemove",data:e.data("data"),id:i.data("randomId"),index:n}),t.remove(),!this.isUndo()){var r=i.get(0);this.tabCheck(r),this.blockquote_check(r)}},resetRange:function(t){Lyte.objectUtils(this.data.range,"add","isRange",!1),$L(this.$node).removeClass("lyteTextSelected"),this.setData("isTextSelected",!1),this.resetOverlay(t),this.copyToRange(),t&&this.reset()},resetOverlay:function(t){var e=this.data,i=e.activeOverlay;i.forEach((function(e){t?e.remove():$L(e).attr("style","").addClass("inActive").removeClass("lyteEditorFirst","lyteEditorLast").data({start:"",end:"",node:""})})),t&&(i.splice(0),e.selectedParagraph.splice(0))},pushIfNot:function(t,e){-1==this.getIndex(t,e)&&t.push(e)},getCrctPara:function(t,e){var i=$L(t).closest(".listHolderElement").data("list");return i[this.getIndex(i,t)+1*(e?1:-1)]},mergePara:function(t,e){var i=t.parentNode,a=this.getCrctPara(i),o=$L(i).closest(".listHolderElement"),n=o.data("list"),r=$L(a).data("data");if(a&&!this.isImage(r)&&!this.isTable(r)&&!this.isHr(r)){var s,l=this.convertToParaFormat(i),d=this.convertToParaFormat(a),c=d.data.length,p=this.data.currentNode.parentNode==a,h={wordIndex:c+(p?-1:0),position:p?this.data.cursor:0};return Lyte.arrayUtils(d.data,"push",l.data),s=this.render(this.removeEmptyWordsData(d,h)),this.setData("currentNode",$L(s).data("list")[h.wordIndex]),this.setData("cursor",h.position),this.pushParagraph(s,o,this.getIndex(n,i)),this.removePara(i),this.removePara(a),this.check_rtl(s),!0}},alterParasToDelete:function(t,e,i){var a={};for(var o in i.forEach(function(e){var i=e.parentNode,o="para"+this.getIndex(t,i),n=a[o];n||(n=a[o]={para:i,value:0,array:[]}),n.value++,n.array.push(e)}.bind(this)),a){var n=a[o];if(n){var r=n.para,s=$L(r).data("list");n.value==s.length?i.forEach(function(t,e){-1!=this.getIndex(s,t)&&i.splice(e,1)}.bind(this)):(t.splice(this.getIndex(t,r),1),this.pushIfNot(e,r))}}},removeSelected:function(t,e,i){var a=this.data,o=a.ltPropParaToWordStyle||[];if((t=t||a.range).isRange){this.update_count(-_lyteUiEditor.limitFilter(this.getSelectedText(e),1/0,!0,!0).length),this.updateRangeNode();var n,r=a.selectedWords,s=a.topLevelElement,l=[],d=[],c=[],p=[],h=a.currentNode,u=0,m=this.getPreviousWord(r[0].node),f=this.getNextWord(this.last(r).node);if(r.forEach(function(t){var e=this.getWordText(t.node);0==t.left&&t.right==e.length?(d.push(t.node),this.pushIfNot(p,t.node.parentNode)):(l.push(t),this.pushIfNot(c,t.node.parentNode))}.bind(this)),this.alterParasToDelete(p,c,d),c.forEach(function(t){var e=this.getIndex(p,t);-1!=e&&p.splice(e,1)}.bind(this)),s&&this.changeToTopLevel(p,s)||!s&&this.changeToTopLevelForTable(p),p.forEach(function(t,i){var a=$L(t).closest(".listHolderElement"),r=a.data("list");if(1==r.length||e||0==i&&!c.length){var s=this.extend($L(t).data("data"));s.data=[this.emptyWordData()],o.forEach((function(t){delete s.style[t]})),delete s.style.color,delete s.style["--lyte-texteditor-li-color"];var d=this.render(s);n||(n=d),this.pushParagraph(d,a,this.getIndex(r,t)),c.unshift(d),l.unshift({node:d.children[0],left:0,right:0})}if(t.contains(m))m=this.getLastWordInPara($L(t).prev(this.getTag("paragraph")).get(0));else if(!m){var p=$L(t).next(this.getTag("paragraph")).get(0);f=p?this.getFirstWordInPara(p):void 0}this.removePara(t)}.bind(this)),l.length)l.forEach(function(t,e){var a=t.node,o=this.getWordText(a);null!=i&&this.data.ltPropMobileView&&a==h?(this.updateNodeValue(a,i),u=window.getSelection().getRangeAt(0).startOffset,t.left=0==e?u:t.left):this.updateNodeValue(a,o.slice(0,t.left)+o.slice(t.right))}.bind(this));else{var g,y=n?this.getFirstWordInPara(n):m,v=0;y&&-1==d.indexOf(y)?(g=y,v=this.getWordText(g).length):f&&(g=f),this.setData("currentNode",g),this.setData("cursor",v)}if(d.forEach(function(t){this._maindiv.contains(t)&&this.deleteSingleWord(t,this.findIndex(t))}.bind(this)),this.resetRange(!0),l.length){var b=l[0];b.node!=h&&this.data.ltPropMobileView&&(b.left+=u),this.setData("currentNode",b.node),this.setData("cursor",b.left),c.length>1?this.mergePara(this.getFirstWordInPara($L(c).get(-1)),void 0,i):c.forEach(this.check_rtl.bind(this))}this.updateRangeNode(),this.setCursor(a.currentNode,a.cursor,!1,!0),h=a.currentNode,this.isCodeEditor($L(h.parentElement).data("data"))&&this.insertTextInSnippet(h,h.parentElement,$L(h.parentElement).data("data")),this.callFind()}},changeToTopLevel:function(t,e){for(var i,a,o=$L(e).data("list"),n=function(t){return i=$L(t).parent().closest(this.getTag("paragraph")).get(0),$L(i).closest(".listHolderElement").get(0)!=e?n(i):i}.bind(this),r=0;r<t.length;r++){var s=t[r];if(-1==this.getIndex(o,s)){if(i=n(s),a=$L(i).data("data"),this.isImage(a)||this.isHr(a))continue;-1!=this.getIndex(o,i)&&-1==this.getIndex(t,i)?t.splice(r,1,i):t.splice(r,1),r--}}},updateRangeNode:function(){var t=this.data,e=t.range,i=e.isRange,a=t.currentNode,o=(t.cursor,e.startNode),n=e.endNode;this.updateNodeValue(a),i&&a!=o&&this.updateNodeValue(o,void 0,!0),i&&a!=n&&n!=o&&this.updateNodeValue(n,void 0,!0)},splitPara:function(t,e){this.data.range.isRange&&this.removeSelected();var i=this.data,a=i.currentNode,o=i.cursor,n=this.findIndex(a),r=a.parentNode,s=$L(r).closest(".listHolderElement"),l=this.convertToParaFormat(r),d=this.extend(l),c=n.wordIndex,p=n.paraIndex,h=l.data,u=h[c];if(!t&&this.isEmptyPara(l)&&-1!=this.getIndex(l.classList,i.tabClass))return this.tabpress([r],!0);if(this.isCaption(r))return;if(this.updateRangeNode(),this.isImage(d)||this.isHr(d)||$L(a).hasClass("lyteReadonlyNode"))d=this.emptyParaData();else{var m=d.data,f=u.text;m.splice(0,c),h.splice(c+1),m[0].text=f.slice(o),this.last(h).text=f.slice(0,o)}if(e&&this.isCodeEditor(d)){let t=d.classList.indexOf("lyteEditorCodeEditor");-1!=t&&d.classList.splice(t,1),delete d.details.snippet}var g=d.data,y=g[0];if(y&&y.details.anchor){if(y.text){var v=this.extend(y,{});v.text="",g.unshift(y=v)}this.remove_anchor_data(y)}let b=this.data.ltPropReplaceStyle;return this.data.ltPropWordToParaStyle.forEach((function(t){if(b.hasOwnProperty(t)){t=b[t].name}d.style[t]=d.data[0].style[t],null==d.style[t]&&delete d.style[t]})),this.data.ltPropCustomListColor&&-1!=d.classList.indexOf("lyteEditorTab")&&d.style.color&&(d.style["--lyte-texteditor-li-color"]=d.style.color),t?[l,d]:i.ltPropCountNewLine&&i.ltPropMaxlength==i.ltPropCharacterCount?i._undoqueue.splice(0):(this.pushParagraph(this.render(this.removeEmptyWordsData(l)),s,p+1),this.pushParagraph(this.render(this.removeEmptyWordsData(d)),s,p+2),this.removePara(r),this.setData("currentNode",this.getFirstWordInPara(s.data("list")[p+1])),this.setCursor(i.currentNode,0),this.updateRangeNode(),void this.callFind())},isEmptyPara:_lyteUiEditor.isEmptyPara,getLastWordInPara:function(t,e,i){var a=$L(t);return!e&&this.isTable(a.data("data"))?this.getLastWordInPara(this.last($L(this.last(Array.from(a.find(this.getTag("table")).find(this.getTag("th")+","+this.getTag("td"))).filter((function(t){return"none"!=t.style.display})))).data("list"))):!i&&_lyteUiEditor.isSection(a.data("data"))?this.getLastWordInPara(this.last(a.get(0).children[0].children[0].children)):this.last(a.data("list"))},getFirstWordInPara:function(t,e,i){var a=$L(t);return!e&&this.isTable(a.data("data"))?this.getFirstWordInPara(this.first($L(this.first(Array.from(a.find(this.getTag("table")).find(this.getTag("th")+","+this.getTag("td"))).filter((function(t){return"none"!=t.style.display})))).data("list"))):e||i||!_lyteUiEditor.isSection(a.data("data"))?this.first(a.data("list")):this.getLastWordInPara(this.first(a.get(0).children[0].children[0].children))},isTable:_lyteUiEditor.isTable,isHr:_lyteUiEditor.isHr,isImage:_lyteUiEditor.isImage,isCodeEditor:_lyteUiEditor.isCodeEditor,tab:function(t,e,i){var a=this.data,o=this.$node,n=a.currentNode,r=a.range,s=".listHolderElement";if(r.isRange){var l=$L(r.startNode).closest(s,o).get(0),d=$L(r.endNode).closest(s,o).get(0);if(l==d&&-1!=this.getIndex([this.getTag("th"),this.getTag("td")],this.getTagName(d)))return this.navigateInTable(d,e)}else{var c=$L(n).closest(s,o).get(0);if(-1!=this.getIndex([this.getTag("th"),this.getTag("td")],this.getTagName(c)))return this.navigateInTable(c,e)}if(this._suggestionWord)this.applySuggestion();else{var p=a.selectedParagraph,h=[];if(p.forEach(function(t){$L(t).data("data").details.tab&&h.push(t)}.bind(this)),h.length)this.tabpress(h,e);else if(!(r.isRange||e||t||i)){var u=this._editdiv;u.innerHTML=this.getSpaceForTab(),this.processInput(u)}}},isUpdateIcon:function(){return!!this._iconUpdate},iconUpdate:function(){this._iconUpdate=!0},removeIconUpdate:function(){delete this._iconUpdate},getDefaultValue:function(t,e){return e?this.data["ltProp"+e+"Style"][t]||"":{fontWeight:400,fontSize:"unset"}[t]||""},checkReplaceStyle:function(t,e,i,a){var o=(this.data.ltPropReplaceStyle||{})[t];o&&(t=o.name,e=a?o.fallBackValue:o.replaceValue),i[t]=e},checkWordToParaStyle:function(t,e,i,a){let o=this;a=a||{},(Object.keys(t.style)||[]).forEach((function(t){-1!=i.indexOf(t)&&null==e.style[t]&&(t=a[t]?a[t].name:t,o.checkReplaceStyle(t,"normal",e.style,!0))}))},toggleWordClass:function(t,e,i,a){var o=this.isUpdateIcon();o||this.updateRangeNode();var n,r,s=this.data,l=s.selectedWords,d=[],c=[],p=s.range,h=p.isRange,u=s.currentNode,m=s.cursor,f=-1!=this.getIndex(s.ltPropMultipleProperty,t),g=this,y=s.ltPropReplaceStyle,v=this.data.ltPropWordToParaStyle,b=t,x=y[t];if(x&&e&&(t=x.name,e=x.replaceValue,r=x.fallBackValue),l.forEach((function(i){var a=i.node,o=$L(a).data("data"),n=$L(a.parentElement).data("data"),r=o.style,s=function(t){t.push(i)},l={data:[o]};if(!g.isCodeEditor(n)&&!(h&&parseInt(i.left)==parseInt(i.right)||g.isImage(l)||g.isHr(l)))if(e)if(f)-1==g.getIndex(r[t]||"",e)?s(c):s(d);else{var p=r[t];if("fontSize"==t&&g.is_super(a)){var u=parseFloat(p);p=(isNaN(u)?13:Math.round(u/.7))+"px"}s(p==e?d:c)}else-1==g.getIndex(o.classList,t)?s(c):s(d)})),o)return{toApply:c,applied:d};/^(color|backgroundColor)$/i.test(t)&&(d=[]);var _=c>=d,P=_?c:d,L=!/^clearFormat|fontChange|anchorChange$/i.test(t);-1!=v.indexOf(b)&&(this.toggleParaClass(t,e,function(t){return this.is_fully_selected(t,l)}.bind(this),void 0,_),_||(_=!0,e=null!=r?r:"normal")),P.forEach((function(o){var r,s=o.node,l=parseInt(o.left),d=parseInt(o.right),c=g.getWordText(s),v=c.length,b=$L(s),x=b.data("data"),P=g.findIndex(s),w=x.style,I=x.classList;if(b.hasClass("lyteReadonlyNode")&&(l=0,d=v),e){var E,C={},T=w[t];if(C[t]=T,f)if(_)g.ifNotStyle(C,t,e);else{var N=C[t]||"",S=N.split(" "),k=g.getIndex(S,e);-1!=k&&(S.splice(k,1),N=C[t]=S.join(" ")),N||(N=C[t]=g.getDefaultValue(t,"Word")),N||-1==I.indexOf("lyteEditorAnchor")||(C[t]="unset")}else C[t]=_?e:g.getDefaultValue(t,"Word");if(E=C[t],T==E)return}else if(_){if(b.hasClass(t))return;r="addClass"}else{if(!b.hasClass(t))return;r="removeClass"}if(L&&i&&0==i(s,e?t:r,e?T:t,e?E:void 0))n=!0;else{var D=function(e,i){g.pushToQueue({operation:"class",prop:i||r,id:P.id,value:e||t,element:"arr:"+P.paraIndex+".data.arr:"+P.wordIndex})},$=a||[],A=function(t,e){$.forEach((function(i){var a=t.indexOf(i),o="removeClass";if(a+1){if(t.splice(a,1),e)return;D(i,o),b[o](i)}}))},M=[],U=g.is_super(s);if(0==l&&d==v){if(A(I),n=!0,!L)return i(s);if(r)b[r](t),_?I.push(t):I.splice(g.getIndex(I,t),1),D();else{var W=_lyteUiEditor.dasherize(t);if(E)w[t]=E,s.style.setProperty(W,E);else{W=_lyteUiEditor.dasherize(t);E?(w[t]=E,s.style.setProperty(W,E)):(delete w[t],s.style.removeProperty(W,E))}g.pushToQueue({operation:"styleSet",oldValue:T,newValue:E,prop:t,id:P.id,index:P,word:!0})}M.push(s)}else{var R,F=[],O=function(t,e,i){e||(P.wordIndex++,e=g.insertSingleWord(t.data,P));var a=function(e,i){if(i==s){if(h&&e>=t.left&&e<=t.right)return!0;if(!h&&e==t.left&&e==t.right)return!0}};if(i&&a(m,u)&&(g.setData("currentNode",e),g.setData("cursor",m-t.left)),h){var o=Lyte.objectUtils,n=p.left,r=p.right,l=t.left;i&&a(n,p.startNode)&&(o(p,"add","startNode",e),o(p,"add","left",n-l)),i&&a(r,p.endNode)&&(o(p,"add","endNode",e),o(p,"add","right",r-l))}return e};if(l&&F.push({data:g.copyWord(x,0,l),left:0,right:l}),L)if(R=g.copyWord(x,l,d),r){var B=R.classList;_?B.push(t):B.splice(g.getIndex(B,t),1)}else{var H=R.style;E?H[t]=E:delete H[t]}else{switch(t){case"clearFormat":R=g.emptyWordData();break;case"fontChange":case"anchorChange":i(R=g.extend(x))}if("clearFormat"==t){let t=s.closest(g.data.ltPropTags.paragraph),e=$L(t).data("data");for(let t in y){let i=y[t];e.style[i.name]&&e.style[i.name]==i.replaceValue&&(R.style[i.name]=i.fallBackValue)}}R.text=c.slice(l,d)}if(F.push({data:R,left:l,right:d}),v!=d&&F.push({data:g.copyWord(x,d,v),left:d,right:v}),M.push(s),3==F.length)g.updateNodeValue(s,c.slice(0,l)),O(F.shift(),s),F.forEach((function(t,e){var i=0==e;i&&A(t.data.classList,!0),M.push(O(t,void 0,i))}));else{var V=function(){var t=F.shift();A(t.data.classList,!0),M.push(O(t,void 0,!0))};l?(g.updateNodeValue(s,c.slice(0,l)),O(F.shift(),s),V()):(P.wordIndex--,V(),g.updateNodeValue(s,c.slice(d)),O(F.shift(),s))}}/lyteSubScript|lyteSuperScript/.test(t)&&M.forEach((function(t){g.check_sub_super(t,U)}))}})),this.updateRangeNode(),this.common_positioning(!0),n&&this.update_panel(),this.callFind()},is_super:function(t){var e=$L(t),i=this.data.ltPropTagConversion;return e.hasClass(i.sub)||e.hasClass(i.sup)},check_sub_super:function(t,e,i){var a=$L(t),o=this.is_super(a),n=a.data("data"),r=n.style.fontSize||"",s=r,l=parseFloat(r),d=isNaN(l);if(o?r=d?"smaller":l*(i||!e?.7:1)+"px":e&&(r=d?"":Math.round(l/.7)+"px"),s==r)return!0;var c=this.findIndex(t);this.pushToQueue({operation:"styleSet",oldValue:s,newValue:r,prop:"fontSize",id:c.id,index:c,word:!0}),n.style.fontSize=t.style.fontSize=r},toggleParaClass:function(t,e,i,a,o){var n=this,r=n.data,s=n._fakeSelectedPara||r.selectedParagraph,l=[],d=[];if(s.forEach((function(i){var a=$L(i).data("data");if(!n.isCodeEditor(a)&&!n.isImage(a)&&!n.isHr(a)){var o=function(t){t.push(i)};o(-1==(e?a.style[t]!=e?-1:0:n.getIndex(a.classList,t))?d:l)}})),this.isUpdateIcon())return{toApply:d,applied:l};o&&(l=[]);var c=d.length>l.length,p=r.currentNode,h=r.cursor;(c?d:l).forEach((function(o){var r,s,l=$L(o),d=l.data("data"),p=d.classList,h=d.style,u=o.style,m=d.details&&d.details.tab,f=e,g=n.findIndex(n.getFirstWordInPara(o)),y=function(e){n.pushToQueue({operation:"class",prop:s||"removeClass",id:g.id,value:e||t,element:"arr:"+g.paraIndex})},v=function(){n.pushToQueue({operation:"styleSet",oldValue:r,newValue:f,prop:t,id:g.id,index:g,paragraph:!0}),h[t]=f};if(!(n.isImage(d)||n.isHr(d)||i&&0==i(o,c))){if((a||[]).forEach((function(t){var e=p.indexOf(t);e+1&&(p.splice(e,1),l.removeClass(t),y(t))})),null!=f){if(c&&f==h[t])return}else{var b=l.hasClass(t);if(c&&b||!c&&!b)return}if(c)f?(u.setProperty(n.dasherize(t),f),n.data.ltPropCustomListColor&&"color"==t&&m&&m.customValue&&(t="--lyte-texteditor-li-color",u.setProperty(t,u.color),r=h[t],v(),t="color")):(s="addClass",p.push(t));else if(f){f=n.getDefaultValue(t,"Para");var x=n.dasherize(t);f?u.setProperty(x,f):u.removeProperty(x)}else s="removeClass",p.splice(n.getIndex(p,t),1);s?(l[s](t),y()):(r=h[t],v()),n.tabCheck(o.parentNode)}})),this.common_positioning(!0),p==r.currentNode&&h==r.cursor&&(delete this._fakeSelectedPara,this.update_panel(),this.checkPlaceholder()),this.callFind()},copyWord:function(t,e,i){return{text:t.text.slice(e,i),details:this.extend(t.details),classList:t.classList.slice(),style:this.extend(t.style),attr:this.extend(t.attr||{}),tag:t.tag}},mergeWords:function(t,e){for(var i,a,o=this.data,n=o.cursor,r=o.currentNode,s=o.range,l=s.isRange,d=$L(t).data("list"),c=d.length,p=d[0],h=$L(p).data("data"),u=Lyte.objectUtils,m=1;m<c;m++){var f=d[m],g=$L(f).data("data");if(this.compareTwoWords(g,h,void 0,e)){var y=s.startNode,v=s.endNode,b=h.text,x=b.length;f==r&&(!l||l&&f==y&&l&&f==v)&&this.updateRangeNode(),f==r&&this.setData({currentNode:p,cursor:n+x}),l&&f==y&&(u(s,"add","startNode",p),u(s,"add","left",s.left+x)),l&&f==v&&(u(s,"add","endNode",p),u(s,"add","right",s.right+x)),this.updateNodeValue(p,b+g.text),this.deleteSingleWord(f,this.findIndex(f)),c--,m--,a=!0,i=!0}else p=f,h=g}i&&this.updateRangeNode(),a&&this.common_positioning()},removeEmptyWords:function(t,e){for(var i=this.data,a=i.currentNode,o=i.range,n=$L(t).data("list"),r=n.length-1,s=0;s<r;s++){var l=n[s];a!=l&&o.startNode!=l&&o.endNode!=l&&(this.isEmptyPara({data:[$L(l).data("data")]})&&(this.deleteSingleWord(l,this.findIndex(l)),r--,s--))}this.mergeWords(t),e&&this.splitRtlWord(t)},compareTwoWords:function(t,e,i,a){var o=t.classList.slice(),n=e.classList.slice(),r=this.extend(t.style),s=this.extend(e.style),l=this.extend(t.details),d=this.extend(e.details),c=this.extend(t.attr)||{},p=this.extend(e.attr)||{};if(a||!l.tab&&!d.tab||(this.removeTabProp(l,r,c,o),this.removeTabProp(d,s,p,n)),l.type&&"mention"==l.type||d.type&&"mention"==d.type)return!1;var h=this.compareArray(o,n)&&this.compareObject(r,s,["width","display"].concat(a||[]))&&this.compareObject(d,l);if(h&&i&&(h=t.text==e.text),h&&this.getTag("word")==t.tag){if(this.data.ltPropWordAttributes&&("false"==c.editable||"false"==p.editable))return!1;h=this.compareObject(c,p,["id"])}return h},compareArray:function(t,e){if(t=t||[],(e=e||[]).length!=t.length)return!1;var i=!0;return e.every((function(e){return-1!=t.indexOf(e)||(i=!1)})),i},compareObject:function(t,e,i){t=t||{},e=e||{},(i=i||[]).forEach((function(i){delete t[i],delete e[i]}));var a=!0,o=Object.keys(t),n=Object.keys(e);return o.length==n.length&&(o.every(function(i){if(-1==n.indexOf(i))return a=!1;var o=t[i],r=e[i],s=r&&r.constructor;if(s==Object){if(!this.compareObject(r,o))return a=!1}else if(s==Array){if(!this.compareArray(r,o))return a=!1}else if(r!=o)return a=!1;return!0}.bind(this)),a)},common_positioning:function(t){var e=this.data;e.range.isRange?this.setRange():(t&&this.resetRange(t),this.setCursor(e.currentNode,e.cursor))},setStyle:function(t,e,i){var a,o=$L(t),n=o.data("data").style,r=n[e]||"",s=this.getTagName(t),l=s==this.getTag("table"),d=s==this.getTag("word"),c=s==this.getTag("paragraph");r!=i&&(n[e]=i,t.style[e]=i,"--tablevel"==e&&t.style.setProperty(e,i),l?a=this.findIndex(o.closest(this.getTag("word")).get(0)):d?a=this.findIndex(t):c&&(a=this.findIndex(this.getFirstWordInPara(t))),t=o.closest(".listHolderElement"),this.pushToQueue({operation:"styleSet",oldValue:r,newValue:i,prop:e,id:o.data("randomId")||a.id,index:a,table:l,word:d,paragraph:c}))},tabpress:function(){},tabCheck:function(){},getBulltet:function(t){var e=t.name;if(this[e]){var i=this[e](t.order,t.suffix);return t.lower&&(i=(i||"").toLowerCase()),i}return"custom"==e?t.conversionName:e},number:function(t,e){return t+(e||"")},katakana:function(t,e,i){var a=["ア","イ","ウ","エ","オ","カ","キ","ク","ケ","コ","サ","シ","ス","セ","ソ","タ","チ","ツ","テ","ト","ナ","ニ","ヌ","ネ","ノ","ハ","ヒ","フ","ヘ","ホ","マ","ミ","ム","メ","モ","ヤ","ユ","ヨ","ラ","リ","ル","レ","ロ","ワ","ヰ","ヱ","ヲ","ン"],o=a.length;return(t>48&&!i?this.katakana(parseInt((t-1)/48),"",!0):"")+a[(t%o||o)-1]+(e||"")},roman:function(t,e){var i={1:"I",4:"IV",5:"V",9:"IX",10:"X",40:"XL",50:"L",90:"XC",100:"C",400:"CD",500:"D",900:"CM",1e3:"M"},a=1;for(var o in i){if(t<=o)return i[t==o?t:a]+(t==o?"":this.roman(t-a))+(e||"");a=o}},alphabet:function(t,e){return String.fromCharCode(64+(t%26||26))+(t>26?this.alphabet(t-26):"")+(e||"")},zeronumber:function(t,e){return(t<10?"0":"")+t+(e||"")},selectAll:function(){var t=$L(this._maindiv).data("list"),e=this.getFirstWordInPara(this.first(t),void 0,!0),i=this.getLastWordInPara(this.last(t),void 0,!0),a=this.getWordText(i).length;(e!=i||0!=a||$L(i).hasClass("lyteEditorImage")||"section"===$L(i).data("data").details.type)&&(this.setData("range",{isRange:!0,startNode:e,endNode:i,left:0,right:a}),this.setData("currentNode",e),this.setData("cursor",0),this.setRange())},queueset:function(){var t=this.data,e=t._undoqueue;if(e.length){var i=t.undoqueue;t.undoqueue.push(e.splice(0)),clearTimeout(this._undotime),t.redoqueue=[];var a=t.ltPropMaxUndoCount,o=i.length;null!=a&&o>a&&i.splice(0,o-a)}},undo:function(){this._suggestionWord&&this.removeSuggestion();var t=this.data,e=t.undoqueue,i=t.redoqueue;if(this.queueset(),e.length){var a=e.pop();i.push(a),this.handleDo(a,!0),this.callFind()}},redo:function(){this._suggestionWord&&this.removeSuggestion();var t=this.data,e=t.undoqueue,i=t.redoqueue;if(this.queueset(),i.length){var a=i.pop();e.push(a),this.handleDo(a),this.callFind()}},handleDo:function(t,e){this._undomode=!0,e&&(t=this.toArray(t).reverse());var i=this.data,a=i.currentNode,o=i.cursor,n=e?"undo":"redo";t.forEach(function(t){this["do"+this.getCorrectOp(t.type,e)](t,e),this.call_queue_push(t,n)}.bind(this));var r=i.currentNode,s=i.cursor;this.common_positioning(!0),r==a&&s==o&&this.checkPlaceholder(),delete this._undomode,this.callQueueUpdate(n),null==this._nodeTime&&this.update_panel()},getCorrectOp:function(t,e){return{update:"Update",styleSet:"StyleSet",spanSet:"SpanSet",tablevelUpdate:"TablevelUpdate",meta:"Meta",properties:"Properties",attribute:"Attribute"}[t]||{undo:{paragraphRemove:"ParagraphCreate",paragraphCreate:"ParagraphRemove",rowCreate:"RowDelete",rowDelete:"RowCreate",cellInsert:"CellDelete",cellDelete:"CellInsert",wordDelete:"WordInsert",wordInsert:"WordDelete",mention:"AddMention",addClass:"RemoveClass",removeClass:"AddClass"},redo:{paragraphCreate:"ParagraphCreate",paragraphRemove:"ParagraphRemove",rowCreate:"RowCreate",rowDelete:"RowDelete",cellInsert:"CellInsert",cellDelete:"CellDelete",wordDelete:"WordDelete",wordInsert:"WordInsert",mention:"RemoveMention",addClass:"AddClass",removeClass:"RemoveClass"}}[e?"undo":"redo"][t]},doAttribute:function(t,e){var i=t.operations,a=$L(this.get_element_from_opr(i)),o=this.get_data_from_opr(i),n=this.do_parse(t.value)[this.get_name(e)],r=o.data,s=o.value;n?(r[s]=n,a.attr(s,n)):(delete r[s],a.removeAttr(s))},doProperties:function(t,e){var i=t.operations,a=this.get_data_from_opr(i),o=this.do_parse(t.value)[this.get_name(e)],n=a.data,r=a.value;o?n[r]=o:delete n[r]},doAddClass:function(t){var e=t.operations,i=this.get_element_from_opr(e),a=this.get_data_from_opr(e+".x"),o=t.value;$L(i).addClass(o),o.split(" ").forEach(function(t){this.pushIfNot(a.data.classList,t)}.bind(this))},doRemoveClass:function(t){var e=t.operations,i=this.get_element_from_opr(e),a=this.get_data_from_opr(e+".x"),o=t.value,n=a.data.classList;$L(i).removeClass(o),o.split(" ").forEach(function(t){n.splice(this.getIndex(n,t),1)}.bind(this))},doStyleSet:function(t,e){var i=t.operations,a=this.get_element_from_opr(i),o=this.get_data_from_opr(i),n=this.do_parse(t.value),r=this.get_name(e),s=o.value,l=n[r],d=a.style,c=_lyteUiEditor.dasherize(s);""==l||null==l?delete o.data[s]:o.data[s]=l,l?d.setProperty(c,l):d.removeProperty(c)},get_element_from_opr:function(t){var e=t.match(/(arr:(\d+))/g)||[],i=this._maindiv,a=$L(i).data("list");return e.forEach((function(t){var e=t.match(/arr:(\d+)/)[1];i=a[e],a=$L(i).data("list")})),i},get_number:function(t){if(/^arr/.test(t))return parseInt(t.replace("arr:",""))},get_data_from_opr:function(t){var e=t.split("."),i=e.pop(),a=$L(this._maindiv).data("data");return e.forEach(function(t){var e=this.get_number(t);a=a[null==e?t:e]}.bind(this)),{data:a,value:i}},get_name:function(t){return t?"oldValue":"newValue"},do_parse:function(t){return JSON.parse(t)},doMeta:function(t,e){var i=this.get_element_from_opr(t.operations),a=this.do_parse(t.value),o=this.data.range,n=this.checkIfAvailable(a.start),r=this.checkIfAvailable(a.end),s=a.index;this.checkIfAvailable(s)&&(this.setData("currentNode",i),this.setData("cursor",s.position)),n&&(o.startNode=i,o.left=a.start.position),r&&(o.endNode=i,o.right=a.end.position),Lyte.objectUtils(o,"add","isRange",!(!n&&!r)),n||r||this.copyToRange(),a.bluepencil&&this.blue_undo(a,e)},doUpdate:function(t,e){var i=t.operations,a=this.get_element_from_opr(i),o=this.do_parse(t.value)[this.get_name(e)];this.update_count(o.length-this.getWordText(a).length),this.updateNodeValue(a,o)},doParagraphRemove:function(t){this.doRowDelete(t)},doParagraphCreate:function(t){var e=t.operations.split("."),i=e.pop(),a=this.get_element_from_opr(e.join(".")),o=this.get_number(i),n=this.render(this.do_parse(t.value));this.pushParagraph(n,a,o),this.update_count(_lyteUiEditor.limitFilter(n,1/0,!0).length)},doWordDelete:function(t){this.doRowDelete(t)},doRowDelete:function(t){var e=t.operations,i=this.get_element_from_opr(e),a=this.get_data_from_opr(e),o=this.get_number(a.value),n=Lyte.arrayUtils;this.data.ltPropCountNewLine&&/paragraph/i.test(t.type)&&this.update_count_in_delete(a.data[o],o,a.data.length),n(a.data,"removeAt",o),n($L(i.parentNode).data("list"),"removeAt",o),this.update_count(-_lyteUiEditor.limitFilter(i,1/0,!0).length),i.remove()},doWordInsert:function(t){var e=t.operations.split("."),i=this.get_number(e.pop());e.pop();var a=this.get_number(e.pop()),o=this.get_element_from_opr(e.join(".")),n=(t.data,this.insertSingleWord(this.do_parse(t.value),{paraIndex:a,wordIndex:i},$L(o).data("randomId")));this.update_count(_lyteUiEditor.limitFilter(n,1/0,!0).length)},checkIfAvailable:function(t,e){return e=e||"wordIndex",(t=t||{}).hasOwnProperty(e)&&!isNaN(t[e])},callQueueUpdate:function(t){var e=this.data,i=e.undoqueue,a=e.redoqueue,o=this.$node,n=o.panel;n&&n.undoRedo(i,a),this.execute("onUndoRedoQueueUpdate",i,a,t,o),t&&e.ltPropAutoAdjustHeight&&this.update_height()},textChange:function(t,e){var i=this,a=i.data,o=a.ltPropMaxMargin,n=a.ltPropMarginIncrease;if(null==o){var r=i._maindiv,s=r.offsetWidth,l=r.offsetHeight<r.scrollHeight;o=s-n-(l?_lyteUiUtils.getScrollBarWidth():0)-parseFloat(this.comp_style(r).paddingInlineEnd)}i.toggleParaClass("fakeClass",void 0,(function(r){var s=$L(r);if(s.closest("."+a.ltPropHeaderTags.join(",.")).length)return!1;var l=s.data("data").style,d=i.findIndex(i.getFirstWordInPara(r)),c=l[e]||"0px",p=(c+"").match(/(px|pt|cm|mm|in|em|rem|%)/i)[0],h=parseFloat(c),u=Math.max(0,Math.min(o,h+t*n))+p;return c!=u&&(i.pushToQueue({operation:"styleSet",oldValue:l[e],newValue:u,prop:e,id:d.id,index:d,paragraph:!0}),l[e]=u,r.style.setProperty(i.dasherize(e),u)),!1}))},firstUppercase:function(t){return t.replace(/^./,(function(t){return t.toUpperCase()}))},textIndentDecrease:function(){return this._textindex(!0)},textIndentIncrease:function(){return this._textindex()},_textindex:function(t){var e=this.data.selectedParagraph.slice().reverse(),i=[],a=[],o=[],n=[];if(e.forEach(function(t){var e=$L(t);e.hasClass("lyteEditorTab")?this.tab_check_for_indent(e,i,a):this.pushIfNot(a,t)}.bind(this)),this.isUpdateIcon()){let e,r=this.data.ltPropMaxMargin,s=this.data.ltPropListLevel;return a.forEach((i=>{e=$L(i).data("data"),((t?"0px"===e.style.marginInlineStart||!e.style.marginInlineStart:e.style.marginInlineStart===r+"px")?o:n).push(i)})),i.forEach((i=>{e=$L(i).data("data"),((t?1===e.attr.tabLevel:e.attr.tabLevel===s)?o:n).push(i)})),o.length&&n.length&&(o=[]),{applied:o,toApply:n}}if(t)for(var r=i.length,s=0;s<r;s++){1==$L(i[s]).data("data").attr.tabLevel&&(i.splice(s--,1),r--)}i.length&&this.tabpress(i,t),this._fakeSelectedPara=a;var l=this.textChange(t?-1:1,"marginInlineStart");return delete this._fakeSelectedPara,this.callFind(),l},formatDOM:function(t){var e=[];return t.forEach(function(t){Lyte.arrayUtils(e,"push",this.processDivFormat(this.get_modified_elem(t)))}.bind(this)),e},mergeMultipleStyleProperty:function(t,e){var i=t.split(" "),a=e.split(" ");return Array.from(new Set(i.concat(a))).join(" ")},copyStyle:function(t,e){var i=($L(t).attr("style")||"").split(";"),a=this.data.ltPropMultipleProperty||[];return i.forEach(function(t){var i=t.trim().split(": "),o=this.camelCase(i[0]),n=e.style[o],r=i[1];/px/i.test(n)&&/px/i.test(r)?e.style[o]=parseInt(r)+parseInt(n)+"px":n&&!/initial|inherit/i.test(n)||!r?-1!=a.indexOf(o)&&n!=r&&(e.style[o]=this.mergeMultipleStyleProperty(r,n)):e.style[o]=r}.bind(this)),e},check_low_tags:function(t){var e=this.getTagName(t);if(!e)return t;var i,a=t.style,o=$L(t),n=this.ifNotStyle.bind(this);switch(e){case"b":case"strong":n(a,"fontWeight","bold");break;case"i":case"em":case"cite":case"dfn":case"var":n(a,"fontStyle","italic");break;case"u":case"ins":n(a,"textDecoration","underline");break;case"del":case"strike":case"s":n(a,"textDecoration","line-through");break;case"mark":n(a,"backgroundColor","yellow");break;case"small":n(a,"fontSize","smaller");break;case"bdo":n(a,"direction",o.attr("dir")||"");break;case"big":n(a,"fontSize","2em");break;case"center":n(a,"textAlign","center");break;case"code":case"kbd":case"samp":n(a,"fontFamily","monospace");break;case"dt":case"dd":case"detail":case"summary":case"length":case"fieldset":case"footer":case"header":case"main":i="div";break;case"dir":i="ul";break;case"pre":n(a,"fontFamily","monospace"),n(a,"whiteSpace","pre");break;case"font":n(a,"color",o.attr("color")),n(a,"fontSize",o.attr("size"))}return i&&(t=this.changeToNewDiv(t,Array.from(t.childNodes),"div")),t},remove_unwanted_style:function(t){var e={display:["contents","none"]};for(var i in e)-1!=e[i].indexOf(t[i]||"")&&(t[i]="")},get_modified_elem:function(t,e){var i=this.getTagName(this.check_low_tags(t));if(!i)return this.data.ltPropUrlDetection&&this.data.ltPropUrlDetectionOptions[this.__from?"paste":"insert"]?this.check_urls(t,e):t;var a=t,o=this.data,n=o.ltPropAllowedStyles,r=n.length,s=o.ltPropAllowedTags,l=s.word||[],d=l.length,c=s.paragraph||[],p=c.length,h=d&&-1==this.getIndex(l,i),u=p&&-1==this.getIndex(c,i),m="onNodeProcess",f=t.style;this.remove_unwanted_style(f||{}),h&&u&&(/^(p|div|span)$/i.test(i)||(t=/table|tr|td|th|tbody|thead|blockquote|li|ul|ol|h[1-6]/i.test(i)||"block"==f.display?this.replace_with(t,"p"):this.replace_with(t,"span"))),t.__processed=!0,r&&this.replace_styles(t,n);var g=f.marginLeft,y=f.marginRight,v=f.fontWeight,b=this._dir;return f&&(g&&(f.removeProperty("margin-left"),f["marginInline"+(b?"End":"Start")]=g),y&&(f.removeProperty("margin-right"),f["marginInline"+(b?"Start":"End")]=y),"bolder"==v&&(f.fontWeight="bold")),a!=t&&Lyte.Component.replaceWith(a,t),this.getMethods(m)&&this.executeMethod(m,t,this.$node),t},replace_styles:function(t,e){for(var i=t.style,a=i.length,o=[],n=0;n<a;n++){var r=i[n];-1==this.getIndex(e,r)&&o.push(r)}o.forEach((function(t){i.removeProperty(t)}))},replace_with:function(t,e){var i=document.createElement(e),a=Array.from(t.childNodes);return i.setAttribute("style",t.getAttribute("style")),a.forEach((function(t){i.appendChild(t)})),/input|textarea/i.test(t.tagName||"")&&(i.innerText=t.value),i},recursive_check:function(t){Array.from(t.childNodes||[]).forEach(function(t){t.constructor!=Text&&this.recursive_check(this.get_modified_elem(t))}.bind(this))},processDivFormat:function(t,e){var i=this,a=i.toArray(t.childNodes)||[],o=[],n=[],r=[],s=i.getTagName(t),l=function(a){(o.length||a)&&(n.push(i.changeToNewDiv(t,o,void 0,e)),o=[])},d=function(a){var o=i.processDivFormat(e?a:i.copyStyle(t,a));n.push.apply(n,o)},c=i.data,p=c.ltPropRestrict||[],h=c.ltPropAllowedTags||{},u=h.word||[],m=h.paragraph||[],f=/^(br|div|p|dl|ul|ol|blockquote|figure|dt|dd|caption-div|h[1-6]|hr)$/i;if(!(t.children||[]).length||/^(ul|ol|table)$/i.test(s))return/^(div|p|dl|blockquote|figure|dt|dd|h[1-6])$/i.test(s)&&!t.childNodes.length||-1!==this.getIndex(p,this.getTagName(t))?[]:(i.recursive_check(t),[t]);a.forEach((function(a,s){a.__processed||(a=i.get_modified_elem(a));var c=i.getTagName(a),h=a.style||{},u=!/inline/i.test(h.display||""),m=/^(block|flex|grid)$/i.test((a.style||{}).display||""),g="br"==c;if(a.hasAttribute&&a.hasAttribute("data-section"))!function(t){l();var e=t,a=i.formatDOM(i.toArray(t.childNodes)),o=document.createElement("div");e.innerHTML="",a.forEach((function(t){e.appendChild(t)})),o.appendChild(e),n.push(o)}(a);else if(-1!=i.getIndex(p,c)||g)g&&l(!0);else if((f.test(c)&&u||m)&&l(0===a.childNodes.length),f.test(c)&&u)d(a);else if("pre"!=c&&"pre"!=h.whiteSpace||!u)if("li"==c){var y=i.toArray(a.childNodes),v=[],b={elem:a,insert:[]};r.push(b),y.forEach((function(t){v.push(i.processDivFormat(t))})),v.reverse().forEach((function(t){b.insert.push(i.changeToNewDiv(a,t,"li",e))}))}else if(m)d(a);else{var x=i.processDivFormat(a);1==x.length&&x[0]==a?o.push(a):(o.length&&l(),x.forEach((function(e){i.copyStyle(t,e),n.push(e)})))}else{var _;o.length&&l(),Array.from(a.childNodes).forEach((function(t){var e=i.processDivFormat(t),a=i.getTagName(t),r=t.style||{};u=!/inline/i.test(r.display||""),m=/^(block|flex|grid)$/i.test(r.display||""),1!=e.length||e[0]!=t||f.test(a)&&u||m?(o.length&&l(),"br"==a&&_&&n.push(t)):o.push(t),_=a}))}})),r.forEach((function(t){t.insert.reverse().forEach((function(e){Lyte.Component.insertAfter(t.elem,e)})),t.elem.remove()}));var g=-1!=u.indexOf(s)||-1!=m.indexOf(s)?s:void 0;if(n.length);else if(!e)return[t];return o.length&&n.push(i.changeToNewDiv(t,o,g,e)),n},changeToNewDiv:function(t,e,i,a){var o=t.attributes||{},n=o.length,r=document.createElement(i||"div"),s=[],l=function(t,e,i){i.setAttribute(t,e)};if(e&&e.forEach((function(t){if(t.constructor==Text){var e=document.createElement("span");e.appendChild(t),s.push(t=e)}r.appendChild(t)})),!a)for(var d=0;d<n;d++){var c=o[d],p=c.nodeName,h=c.nodeValue;try{r.setAttribute(p,h),s.forEach(l.bind(this,p,h))}catch(t){}}return r},scrollIntoView:function(t,e){var i=this.data;t=t||i.currentNode;var a=$L.fastdom;a.clear(this.__fdm),this.__fdm=a.measure((function(){if(delete this.__fdm,this.$node&&this.$node.offsetParent&&t.parentNode&&!i.ltPropDisabled&&!i.ltPropReadonly){var o,n,r=this._maindiv,s=r.scrollHeight,l=r.offsetHeight,d=r.scrollTop,c=r.scrollWidth,p=$L(r).hasClass("lyteScrollbar")?0:_lyteUiUtils.getScrollBarWidth(),h=r.offsetWidth-(s>l?p:0),u=(r.scrollLeft,this.getLWindex(t,e)),m=this._cursor.style,f=parseFloat(m.top),g=parseFloat(m.height),y=this._pastediv,v=function(t){$L(y).css({left:m.left,right:m.right,top:t})},b=function(){var t=m.left,e=m.right,i=parseFloat(m.top),o=this;a.measure((function(){var n=r.scrollTop,s=r.offsetHeight,l=r.scrollLeft;a.mutate((function(){$L(o._editdiv).css({left:parseFloat(t)-l,right:parseFloat(e)-l,top:Math.min(i-n,s-parseFloat(m.height))+"px"})}))}))}.bind(this),x=$L(this.$node).hasClass("lyteEditorFocused"),_=i.ltPropScrollToOptions;if(l-=c>h?p:0,u){if(c>h){var P=parseFloat(m[this.rtlfunc("left")]||0);this._dir&&(P=c-P),n=Math.max(0,Math.min(P-.5*h,c-h))}if(f>d&&f+g<d+l)return null!=n&&(r.scrollLeft=n),b(),v(f-d);v(f-(o=Math.max(0,Math.min(f-.5*l,s-l)))),a.mutate((function(){if(i.ltPropPreventInitialScroll)return null!=n&&(r.scrollLeft=n),b(),this.setData("ltPropPreventInitialScroll",!1);if(i.ltPropPreventScroll&&!x)return null!=n&&(r.scrollLeft=n),b();var t={top:o};null!=n&&(r.scrollLeft=n),this._mup&&(_={}),_.onAfter=_.onAfter||b,_.axis="y",$L(r).scrollTo(t,_)}),this)}}}),this)},arrayExtend:function(t,e){return e.forEach(function(e){this.pushIfNot(t,e)}.bind(this)),t},is_fully_selected:function(t,e){var i=$L(t).data("list"),a=0;return e.forEach((function(e){var i=e.node;if(i.parentNode==t){var o=e.left,n=e.right;o||n!=$L(i).data("data").text.length||a++}})),i.length==a},reset_to_default:function(t,e,i,a,o){var n,r=$L(t),s=r.data("data"),l=s.style||{},d=s.attr||{},c=s.details||{},p=s.classList||[],h=a.style||{},u=a.attr||{},m=a.details||{},f=a.classList||[],g=this,y=function(t,e,i){for(var a in t){var o=t[a],n=e[a];o!=n?(i(a,o||"",n||""),delete e[a]):delete e[a]}for(var a in e)i(a,"",e[a])},v=function(t){return Object.fromEntries(Object.entries(t).reverse())};let b=v(d),x=v(l),_=v(c);y(b,u,(function(t,a,o){"id"!=t&&(o?(r.attr(t,o),d[t]=o):(r.removeAttr(t),delete d[t]),g.pushToQueue({operation:"attribute",prop:e+".attr."+t,id:i.id,oldValue:a,newValue:o}),n=!0)})),y(x,h,(function(e,a,s){/^\-\-/.test(e)?t.style.setProperty(e,s):r.css(e,s),s?l[e]=s:delete l[e],g.pushToQueue({operation:"styleSet",oldValue:a,newValue:s,prop:e,id:i.id,index:i,word:o,paragraph:!o}),n=!0})),y(_,m,(function(t,a,o){o?c[t]=o:delete c[t],g.pushToQueue({operation:"properties",prop:e+".details."+t,id:i.id,oldValue:a,newValue:o}),n=!0})),function(){for(var t=p.length,a=function(t,a){g.pushToQueue({operation:"class",prop:t,id:i.id,value:a,element:e}),r[t](a),n=!0},o=0;o<t;o++){var s=p[o],l=g.getIndex(f,s);l+1?f.splice(l,1):(p.splice(o--,1),t--,a("removeClass",s))}f.forEach((function(t){a("addClass",s),p.push(t)}))}(),n&&this.tabCheck(t.closest(".listHolderElement"))},clearFormat:function(t){var e=this.data,i=e.currentNode,a=t||e.ltPropClearParaProperties,o=t?0:e.ltPropClearParaOnFullSelection,n=this,r=n.emptyWordData(),s=n.emptyParaData(),l=e.selectedParagraph,d=[],c=[],p=e.selectedWords,h=[],u=e.range.isRange,m=[],f=this.data.ltPropWordToParaStyle||[],g=function(t){this.updateRangeNode(),t.forEach(function(t){f.forEach(function(e){var i,a=this.data.ltPropReplaceStyle||{};a.hasOwnProperty(e)&&(e=a[e].name),(i=t.style[e])&&(this._fakeSelectedPara=[t],this.toggleParaClass(e,i),delete this._fakeSelectedPara)}.bind(this))}.bind(this))}.bind(this);if(l.forEach((function(t){var e=$L(t).data("data");n.isEmptyPara(e,!0)||!n.is_fully_selected(t,p)||n.isCodeEditor(e)||m.push(t)})),a&&(u?h=m:o||h.push.apply(h,l)),this.isUpdateIcon()){var y=[],v=[];return p.forEach((function(t){var e=t.node,i=n.extend($L(e).data("data"));n.compareObject(i.details,r.details)&&n.compareObject(n.remove_merge_default(i.style),n.remove_merge_default(r.style),["display"])&&n.compareArray(i.classList,r.classList)?y.push(e):v.push(e)})),h.forEach((function(t){var e=$L(t).data("data");n.compareObject(e.details,s.details)&&n.compareObject(e.style,s.style)&&n.compareArray(e.classList,s.classList)&&n.compareObject(n.extend(e.attr),s.attr,["id"])?d.push(t):c.push(t)})),(v.length||c.length)&&(y=[],d=[]),{toApply:v.concat(c),applied:y.concat(d)}}if(u||!$L(i).hasClass("lyteEditorImage"))return h.length&&(this.updateRangeNode(),h.forEach((function(t){var e=n.getFirstWordInPara(t),i=n.findIndex(e),a="arr:"+i.paraIndex;n.reset_to_default(t,a,i,n.extend(s))}))),this.checkPlaceholder(),!a&&m.length?g(m):a&&!o&&g(l),n.toggleWordClass("clearFormat",void 0,(function(t){var e=n.findIndex(t),i="arr:"+e.paraIndex+".data.arr:"+e.wordIndex;return n.reset_to_default(t,i,e,n.extend(r),!0),!1}))},find:function(t,e){t?this.setFind(this.markFind(t,e)):this.resetFind()},moveFind:function(t){var e=this.data.findWords;if(e.length){var i,a=$L(".lyteEditorFindSeleced",this._maindiv),o=this.getIndex(e,a.eq(0).data("group"))+1*t;if(i=e[o=(o+e.length)%e.length]){a.removeClass("lyteEditorFindSeleced"),i.forEach(function(t){$L(t.dom).addClass("lyteEditorFindSeleced")}.bind(this));var n=i[0];this.scrollIntoView(n.node,n.start)}}},nextFind:function(){this.moveFind(1)},previousFind:function(){this.moveFind(-1)},resetFind:function(){var t=this.data.findWords;t.forEach((function(t){t.forEach((function(t){t.dom.remove()}))})),t.splice(0)},setFind:function(t){var e=[],i=this.data.findWords;t.forEach(function(t){var i=[];t.forEach(function(t){this.pushIfValid(i,this.copyInSameWord(t.word,t.start,t.end))}.bind(this)),e.push(i)}.bind(this)),this.resetFind(),e.forEach(function(e,a){e.forEach(function(i){var o=$L(this.renderNode(this.getTag("find")));o.css({left:i.left||"",width:i.width,right:i.right||"",top:i.top,height:i.height}),this.append(this._maindiv,o.get(0)),0==a&&o.addClass("lyteEditorFindSeleced"),i.dom=o.get(0);var n=t[a];o.data({group:e,word:i.node,start:n.start,end:n.end,previous:i.previousPartial,next:i.nextPartial})}.bind(this)),i.push(e)}.bind(this)),this.moveFind(0)},_replace:function(t,e){e=e||"",this.updateRangeNode();var i=[],a=[];t.reverse().forEach(function(t){t.reverse().forEach(function(t){var o,n,r=t.word,s=$L(r).closest(this.getTag("paragraph")).get(0),l=this.getIndex(i,s),d=a[l],c=this.findIndex(r),p=t.start,h=t.end;if(-1==l&&(i.push(s),d=this.convertToParaFormat(s),a.push(d)),n=(o=this.getText(d,c)).slice(0,p)+e+o.slice(h),this.setText(d,c,n),this.update_count(n.length-o.length),$L(t).hasClass("lyteEditorFindSeleced")){var u=this.toArray($L(r).children(this.getTag("find")));l=this.getIndex(u,t);this.setData("cursor",h+(l+1)*(h-p-e.length)),this.setData("currentNode",r)}}.bind(this))}.bind(this)),this.grpPara(i,a).forEach(function(t){var e=t.paras[0],i=this.isContainAlignedImage(e.para),a=i?void 0:t.paras.filter(function(t){return this.isImage(t.data)&&t.data.style.float}.bind(this));i||a?(i=i||e.para,this.minimumAlignRender(i,i,void 0,void 0,[],void 0,$L(t.paras).get(-1).para,t.paras)):this.minimumRendering(t.element,t.paras,t.width,void 0,[],0)}.bind(this)),this.resetFind(),this.resetRange(!0),this.setCursor(this.data.currentNode,this.data.cursor)},replace:function(t){this._replace([$L(".lyteEditorFindSeleced").data("group")],t)},replaceAll:function(t){this._replace(this.data.findWords,t)},markFind:function(t,e,i){var a=[],o=$L(i||this._maindiv).data("list");return e||(t=t.toLowerCase()),o.forEach(function(i){var o=$L(i).data("data");if(this.isImage(o)||this.isTable(o))return $L(i).find(".listHolderElement").each(function(i,o){this.pushIfValid(a,this.markFind(t,e,o))}.bind(this));this.pushIfValid(a,this.getTextInPara(i,t,e))}.bind(this)),a},getTextInPara:function(t,e,i){var a=this.convertParaToText(t),o=i?a.text:a.text.toLowerCase(),n=a.details,r=o.split(e),s=0,l=[],d=e.length;return r.forEach(function(t,e){0!=e?(l.push(this.wordsFormText(s,s+d,n)),s+=t.length+d):s+=t.length}.bind(this)),l},wordsFormText:function(t,e,i){var a=[],o=void 0;return i.every((function(i){var n=i.start,r=i.end,s={};return n<=t&&t<r&&(s.start=t-n),n<e&&e<=r&&(s.end=e-n),n>t&&e>r&&(s.start=0,s.end=r-n),s.start==o&&s.end==o||(s.end==o?(s.end=r-n,s.nextPartial=!0):s.start==o&&(s.start=0,s.previousPartial=!0),s.word=i.word,a.push(s)),!0})),a},convertParaToText:function(t){var e=$L(t).data("data"),i="",a=[],o=0;return e.data.forEach((function(e,n){var r=e.text,s=r.length;i+=r,o+=s,a.push({length:s,wordIndex:n,start:o-s,end:o,word:$L(t).data("list")[n]})})),{text:i,details:a}},pushIfValid:function(t,e){e&&e.constructor==Array||(e=[e]),e.forEach(function(e){e&&t.push(e)}.bind(this))},call_insert:function(t){return this.execute("onBeforeInsert",t,this.$node)},inline_image_html:function(t,e,i){e(t,i)},insertHTML:function(t,e){var i=this.call_insert(t);if(0!=i){var a=function(){var i=this.proceedPaste.bind(this);!e&&this.data.ltPropConvertInlineImages?this.inline_image_html(t,i):i(t)}.bind(this);i&&i.then?i.then((function(e){a(e||t)})):a()}},insertJSON:function(t){0!=this.call_insert(t)&&this._proceedPaste(t)},insertCodeText:function(t,e){t=t.replace(/\t/g,"    "),this.calculateCodeIndent(t);const i=$L.snippets.getBuilder(e.toLowerCase(),t).build().snippet;let a=this.convertSnippetToData(i,e.toLowerCase()),o=this.createSection({data:a});o.data[0].classList.push("lyteEditorCodeEditorContainer"),this._proceedPaste([o])},getCurrentParaClient:function(){return this.data.currentNode.parentElement.getBoundingClientRect()},calculateCodeIndent:function(t){var e="",i=0,a=[],o=[],n={},r=function(t){return n.indent=e,e="",t&&(n.value="",o.push(n),n={}),!0},s=function(){return n.indent=null==n.indent?"":n.indent,n.value=e,o.push(n),e="",n={},!0};for(var l of t)" "==l||" "==l?(2==i&&s(),e+=" ",i=0):"\n"==l?(2==i&&s()||0==i&&r(!0)||""!=e&&o.push({indent:e,value:""}),a.push(o),o=[],i=1):(0==i&&r(),e+=l,i=2);0==i&&r(!0)||2==i&&s(),a.push(o),this.data.spaceDetails=a},remove_style:function(t){var e=this,i=e.data,a=i.ltPropWordStyle||{},o=i.ltPropParaStyle||{},n=e.getTag("paragraph"),r=e.getTag("word"),s="onParaModification";t.forEach((function(t){var i,l=t.tag,d=t.style,c=void 0,p=t.data;if((i=l==n)?c=o:l==r&&(c=a),d&&c)for(var h in c)if(c[h]==d[h]){if("color"==h&&t.details.anchor)continue;delete d[h]}p&&e.remove_style(p),i&&e.getMethods(s)&&e.executeMethod(s,t,e.$node)}))},getJSON:function(){var t=$L(this._maindiv).data("list"),e=[];return t.forEach(function(t){e.push(this.mergeWordsData(this.convertToParaFormat(t),{},!0))}.bind(this)),this.data.ltPropRemoveDefaultStyle&&this.remove_style(e),e},mergeWordsData:function(t,e,i,a){this.removeEmptyWordsData(t,e,a);var o=t.data,n=o[0];if(i){var r=n.style;delete r.direction,delete r.unicodeBidi}for(var s=1;s<o.length;s++){var l=o[s];if(i){var d=l.style;delete d.direction,delete d.unicodeBidi}this.compareTwoWords(l,n)?(e&&e.wordIndex==s&&(e.wordIndex--,e.position+=n.text.length),n.text+=l.text,o.splice(s,1),e&&s<e.wordIndex&&e.wordIndex--,s--):n=o[s]}return i?t:this.splitRtlText(t,e,this.get_dir(t,!0))},removeEmptyWordsData:function(t,e,i){var a=t.data,o=a.length-1;let n=!1;if(0==o)return t;for(var r=0;r<=o;r++){let t=a[r];if(this.isEmptyPara({data:[t]})&&!n){if(e){var s=e.wordIndex;s!=r?r<s&&e.wordIndex--:(e.wordIndex--,e.position=0==r?0:a[r-1].text.length)}1!=a.length&&a.splice(r,1),o--,r--}n=t&&t.details&&"anchor"==t.details.type}return e&&e.wordIndex<0&&(e.wordIndex=0,e.position=0),t},splitRtlText:function(t,e,i){for(var a,o=t.data,n={},r=0,s=function(t,s,d,c){var p=this.extend(t),h=s.__isrtl;if(p.text=d,null==h[c]&&(h[c]=i),h[c]!=i){var u=p.style;u.unicodeBidi="bidi-override",u.direction=i?"ltr":"rtl"}n.index||(n.index=this.splitCursor(e,l,d,r,c)),Lyte.arrayUtils(o,"insertAt",a+c+1,p),r+=d.length},l=o.length-1;l>=0;l--){var d=o[l];if(d.text){var c=this.splitText(d.text,i,d,e,l);a=this.getIndex(o,d),r=0,c.forEach(s.bind(this,d,c)),Lyte.arrayUtils(o,"removeAt",a)}}return t},splitCursor:function(t,e,i,a,o){if(t&&t.wordIndex==e){var n=t.position;if(n>=a&&n<=a+i.length)return t.wordIndex=e+o,t.position=n-a,!0}},neutral:function(){return this.__neutral||(this.__neutral=new RegExp((t="",[91,45,33,36,37,94,38,42,64,40,41,95,43,124,35,126,61,96,123,125,92,91,92,93,58,34,59,39,8220,8221,60,62,63,44,46,92,92,92,47,48,45,57,92,102,92,114,92,110,92,118,92,120,50,48,92,117,48,48,65,48,92,117,48,48,48,101,92,117,48,48,48,102,92,117,48,48,49,51,48,45,57,178,45,179,185,188,45,190,1632,45,1641,1776,45,1785,1984,45,1993,2406,45,2415,2534,45,2543,2548,45,2553,2662,45,2671,2790,45,2799,2918,45,2927,3046,45,3058,3174,45,3183,3192,45,3198,3302,45,3311,3430,45,3445,3664,45,3673,3792,45,3801,3872,45,3891,4160,45,4169,4240,45,4249,4969,45,4988,92,117,49,54,101,101,45,92,117,49,54,102,48,6112,45,6121,6128,45,6137,6160,45,6169,6470,45,6479,6608,45,6617,6992,45,7001,7088,45,7097,7232,45,7241,7248,45,7257,8304,8308,45,8313,8320,45,8329,8531,45,92,117,50,49,56,50,92,117,50,49,56,53,45,92,117,50,49,56,56,9312,45,9371,9450,45,9471,10102,45,10131,11517,92,117,51,48,48,55,92,117,51,48,50,49,45,92,117,51,48,50,57,92,117,51,48,51,56,45,92,117,51,48,51,97,12690,45,12693,12832,45,12841,12881,45,12895,12928,45,12937,12977,45,12991,42528,45,42537,43216,45,43225,43264,45,43273,43600,45,43609,65296,45,65305,93,124,92,117,100,56,48,48,91,92,117,100,100,48,55,45,92,117,100,100,51,51,92,117,100,100,52,48,45,92,117,100,100,55,56,92,117,100,100,56,97,92,117,100,102,50,48,45,92,117,100,102,50,51,92,117,100,102,52,49,92,117,100,102,52,97,92,117,100,102,100,49,45,92,117,100,102,100,53,93,124,92,117,100,56,48,49,91,92,117,100,99,97,48,45,92,117,100,99,97,57,93,124,92,117,100,56,48,50,91,92,117,100,100,49,54,45,92,117,100,100,49,57,92,117,100,101,52,48,45,92,117,100,101,52,55,93,124,92,117,100,56,48,57,91,92,117,100,99,48,48,45,92,117,100,99,54,50,93,124,92,117,100,56,51,52,91,92,117,100,102,54,48,45,92,117,100,102,55,49,93,124,92,117,100,56,51,53,91,92,117,100,102,99,101,45,92,117,100,102,102,102,93].forEach((function(e){t+=String.fromCharCode(e)})),t)));var t},splitText:function(t,e,i,a,o){var n=t.length,r=/[\u0600-\u06EF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF\u0590-\u05FF\uFB1D-\uFB4F\u0700-\u074F\u0800-\u083F\u0840-\u085F]/,s=this.neutral();if(n&&r.test(t)){for(var l,d=[],c=(n=t.length,{N:void 0,R:!0,L:!1}),p=d.__isrtl=[],h=0;h<n;h++){var u=t[h],m=s.test(u),f=r.test(u);if(l==(_=m?"N":f?"R":"L"))d[d.length-1]+=u;else d.push(u),d.__isrtl.push(c[l=_])}var g=p[0];for(h=1;h<p.length;h++){var y=p[h],v=p[h+1];if(null!=g){var b=v==y;if((null==y||b&&g==e)&&(g==v||b)){d[h-1]+=d[h]+(d[h+1]||""),d.lsplice(h,2),p.lsplice(h,2),h--;continue}}else y==e&&(d[h-1]+=d[h],d.lsplice(h,1),p.lsplice(h-1,1),h--);g=y}return d}var x=[t||""];x.__isrtl=[void 0];for(let e=0;e<t.length;e++){var _=t[e];if(!s.test(_)){x.__isrtl=[!1];break}}return x},findFinalOccurence:function(t,e){for(let i=t.length-1;i>=0;i--)if(!e.test(t[i]))return i+1;return 0},splitRtlWord:function(t){for(var e,i,a=$L(t).data("list"),o=a.length,n=this.data,r=n.currentNode,s=n.range,l=s.isRange,d=s.startNode,c=s.endNode,p=n.cursor,h=s.left,u=s.right,m=Lyte.objectUtils,f=this.get_dir(t,!0),g=function(t,a){var o,n=this.copyWord(b,i,i+t.length),g=n.style,y=x.__isrtl;null==y[a]&&(y[a]=f),y[a]!=f?(g.unicodeBidi="bidi-override",g.direction=f?"ltr":"rtl"):(delete g.unicodeBidi,delete g.direction),P.wordIndex++,o=this.insertSingleWord(n,P),r==v&&p>=i&&p<=i+t.length&&(e||(this.updateRangeNode(),e=!0),this.setData("currentNode",o),this.setData("cursor",p-i)),l&&r==d&&h>=i&&h<=i+t.length&&(e||(this.updateRangeNode(),e=!0),m(s,"add","startNode",o),m(s,"add","left",h-i)),l&&r==c&&u>=i&&u<=i+t.length&&(e||(this.updateRangeNode(),e=!0),m(s,"add","endNode",o),m(s,"add","right",u-i)),i+=t.length}.bind(this),y=0;y<o;y++){var v=a[y],b=$L(v).data("data"),x=this.splitText(b.text,this.get_dir(v),b);i=0;var _=x.length;if(_>1||1==_&&!!x.__isrtl[0]!=!!f&&!b.style.unicodeBidi){e=!0;var P=this.findIndex(v);x.forEach(g),P.wordIndex-=_,this.deleteSingleWord(v,P)}}if(e)return this.updateRangeNode(),this.common_positioning(),!0},callCopy:function(t,e){var i="onBeforeCopy";if(this.getMethods(i)){var a=this.executeMethod(i,t,e,this.$node);null!=a&&(t=a)}return t},copyToClip:function(t){t.preventDefault();var e=this.getSelectedText(),i=t.clipboardData||window.clipboardData,a=this.callCopy(e,t)||"";i.setData("text/html",a),i.setData("text/plain",this.convert_html_to_txt(a))},convert_html_to_txt:function(t){var e=document.createElement("div"),i="",a=function(t){t.forEach((function(e,o){var n=e.tagName,r=Array.from(e.childNodes||[]);r.length&&a(r),/^(div|dt|dd|detail|summary|length|fieldset|footer|header|main|blockquote|p|caption-div|h[1-6]|hr|td|th|hr|img|video|br)$/i.test(n)?o+1!=t.length&&(i+="\n"):n||(i+=e.nodeValue)}))};return e.innerHTML=t,a(Array.from(e.childNodes)),i},getSelectedText:function(t){this.updateRangeNode();var e=this.data,i=e.selectedWords,a=e.selectedParagraph.slice(),o=e.topLevelElement,n=this.first(i),r=this.last(i),s=e.range,l=this.findIndex(n.node),d=this.findIndex(r.node),c=[];return s.isRange||t?o?(this.changeToTopLevel(a,o),a.forEach(function(t){var e=this.extend($L(t).data("data"));if(t.contains(n.node)){e.data.splice(0,l.wordIndex);var i=(a=e.data[0]).text;a.text=i.slice(n.left,n.right)}if(t.contains(r.node))if(n.node==r.node)e.data.splice(1);else{e.data.splice(d.wordIndex+1);var a;i=(a=this.last(e.data)).text;a.text=i.slice(r.left,r.right)}c.push(e)}.bind(this)),this.stringFromData(c,void 0,!0)):(this.changeToTopLevelForTable(a),this.tableCopy(a)):""},stringFromData:function(t,e,i){return _lyteUiEditor.jsonToString(t,this.construct_config(e,i))},construct_config:function(t,e){var i={};return["listVariable","tabSize","wordStyle","paraStyle","tdStyle","tableStyle","imageStyle","wordStyleConversion","captionStyle","paraStyleConversion","orderedList","unOrderedList","listStyle","defaultTable","anchorProperty","headerTags","tagConversion","wordAttributes","blockquoteClasses","convertStyle"].forEach(function(t){i[t]=this.data[_lyteUiEditor.camelCase("ltProp-"+t)]}.bind(this)),i.urlDetection=!e&&this.data.ltPropUrlDetection&&this.data.ltPropUrlDetectionOptions.output,i.fromCopy=e,i.component=this,i.customListColor=this.data.ltPropCustomListColor,e&&(i.listVariable=!1),i.crossOrigin=t,i},toggleUpperCase:function(t){this.selectWord(),$L.fastdom.measure(function(){this.toggleWordClass("textTransform",t?"uppercase":"lowercase")}.bind(this))},toggleLowerCase:function(){this.toggleUpperCase("lowercase")},toggleCaptilize:function(){this.toggleUpperCase("capitalize")},fontDecrease:function(){this.fontChange(-1,"fontSize")},fontIncrease:function(){this.fontChange(1,"fontSize")},fontChange:function(t,e){this.selectWord(),this.toggleWordClass("fontChange",void 0,function(i){var a,o=this.data,n=($L(i).data("data")||i).style,r=i.constructor!=Object,s=n[e]||this.getProp("fontSize",i),l=((s+"").match(/(px|pt|cm|mm|in|em|rem|%)/i)||[""])[0],d=this.is_super(i),c="smaller"==s?13:Math.round(parseFloat(s)/(d?.7:1)),p=r&&this.findIndex(i),h=i.style;return s==(a=n[e]=Math.max(1,Math.min(o.ltPropMaxFont,c+t*(d?.7:1)*o.ltPropFontIncrease))+l)||r&&(h.setProperty(this.dasherize(e),a),this.pushToQueue({operation:"styleSet",oldValue:s,newValue:a,prop:e,id:p.id,index:p,word:!0}),"fontSize"==e&&this.check_sub_super(i,void 0,!0)),!1}.bind(this))},removeHeaderContents:function(t,e){this.applyHeaderContents(t,e,!0)},applyHeaderContents:function(t,e,i){var a=_lyteUiEditor.getCorrectTag({classList:[e]}),o=this.data.ltPropParaChildConversion[a]||{},n=t.data("list"),r=this;n.forEach((function(t){var e,a=$L(t).data("data").style,n=t.style;for(var s in o){var l=i?r.getDefaultValue(s):o[s],d=a[s];l!=d&&(n.setProperty(r.dasherize(s),l),e=r.findIndex(t),r.pushToQueue({operation:"styleSet",oldValue:d,newValue:l,prop:s,id:e.id,index:e,word:!0}))}}))},headerTag:function(t){if(this.isUpdateIcon())return this.toggleParaClass(t);var e=this;return e.toggleParaClass(t,void 0,(function(i){var a=$L(i),o=a.data("data"),n=o.classList,r=e.findIndex(e.getFirstWordInPara(i));if(e.isCaption(o)||e.isImage(o)||e.isHr(o))return!1;var s=e.getIndex(n,e.data.tabClass);e.data.ltPropHeaderTags.forEach((function(i){var o=e.getIndex(n,i);i!=t&&-1!=o&&-1==s&&(n.splice(o,1),a.removeClass(i),e.pushToQueue({operation:"class",prop:"removeClass",id:r.id,value:i,element:"arr:"+r.paraIndex+".data.arr:"+r.wordIndex}),e.removeHeaderContents(a,i))})),t&&e.applyHeaderContents(a,t)})),!1},camelCase:_lyteUiEditor.camelCase,dasherize:_lyteUiEditor.dasherize,isCaption:function(t){return $L(t).closest(this.getTag("word"),this.$node).hasClass("lyteEditorImage")},convertTextToDestination:function(t){var e=this.convertHtmlToData(t),i=this.data.currentNode,a=this.convertToParaFormat(i.parentNode),o=this.findIndex(i),n=this,r=a.data[o.wordIndex],s=[];return a.data=[],e.forEach((function(t){var e=t.data;t.data=[];var i=n.extend(n.extend(a),t);e.forEach((function(t){t.style=n.extend(n.extend(r).style,t.style),i.data.push(t)})),s.push(i)})),s},convertTextToPlainData:function(t){(e=this.create("div")).innerHTML=this.check_limit(_lyteUiEditor.escapeText(t)).html;var e,i=(e=$L("<div>"+_lyteUiEditor.escapeText(e.innerText)+"</div>").get(0)).innerText.split("\n"),a=[];return i.forEach(function(t){var e=document.createElement("div");e.innerHTML=this.convertCase(this.filteroutMention(_lyteUiEditor.escapeText(t)));var i=this.formatPara(e);i.forEach((function(t){a.push(t)})),0==i.length&&a.push(this.emptyParaData())}.bind(this)),a},convertHtmlToData:function(t,e){var i,a,o=document.createElement("div"),n=function(t){let e=["COLGROUP","TBODY","THEAD","TFOOT","TR"],i=["TD","TH"];for(let a=0;a<t.childNodes.length;a++){let o=t.childNodes[a];"TABLE"===o.nodeName||-1!=e.indexOf(o.nodeName)?n(o):-1!=i.indexOf(o.nodeName)&&r(o)}},r=function(t){for(let e=0;e<t.childNodes.length;e++){let i=t.childNodes[e];if("TABLE"===i.nodeName)n(i);else if(i.nodeType==i.TEXT_NODE){let t=i.textContent.split("\n");if(t.length>1){let e=document.createDocumentFragment();t.forEach(((t,i)=>{i>0&&e.appendChild(document.createElement("br")),t.length>0&&e.appendChild(document.createTextNode(t))})),i.parentNode.replaceChild(e,i)}}else i.nodeType==i.ELEMENT_NODE&&r(i)}};return e?o=e:(t=this.check_limit(this.filteroutCaption(t.replace(/<meta charset=('|")utf-(\d+)('|")>/,""))).html,o.innerHTML=t,r(o),o.normalize()),i=this.formatDOM(this.toArray(o.childNodes)),o.children.length?a=this.formatHtml(this.formatbr(i)):(1==i.length&&i[0].constructor==Text&&(a=this.convertTextToPlainData(i[0].nodeValue)),a=this.formatHtml(i)),this.data.ltPropUrlDetectionOptions.paste&&(a=this.detectPasteUrls(a)),a},detectPasteUrls:function(t){let e=function(t){let i=t[t.length-1];return i.data?e(i.data):t},i=t.length?t[t.length-1]:[];if(i.data){let t=e(i.data);t[t.length-1].details&&"anchor"==t[t.length-1].details.type&&t.push(this.emptyWordData())}return t},formatbr:function(t){for(var e=t.length,i=function(t){return this.render({tag:t?"p":"br",text:t})},a=0;a<e;a++){var o=t[a];if(!o.tagName){var n=o.nodeValue,r=n.split("\n");if("\n"==n){t.splice(a,1,i.call(this,""));continue}if(1==r.length)continue;""==r[0]&&r.shift(),""==r[r.length-1]&&r.pop(),t.splice(a,1);var s=r.map(i.bind(this));Lyte.arrayUtils(t,"insertAt",a--,s),a+=s.length,e+=s.length-1}}return t},filteroutMention:function(t){return t},filteroutCaption:function(t){return this.filteroutMention(t)},formatDl:function(t){var e=[];if(t.forEach(function(t){Lyte.arrayUtils(e,"push",this.formatPara(this.toArray(t.children)))}.bind(this)),e.length>1&&this.isImage(e[0])){var i=e[1];if(!(this.isImage(i)||this.isTable(i)||this.isHr(i)))e[0].data[0].data[1].data=e.splice(1,1)}return e},formatUl:function(t,e){return this.formatHtml(Array.from(t.children))},indexOf:function(t,e,i){for(var a=0;a<t.length;a++)if(t[a].conversionName==e)return a+1;return i},formatHtml:function(t,e){var i,a=[],o=[];t.forEach(function(t){var n,r=this.getTagName(t),s=/^(block|flex|grid)$/i.test(t.style&&t.style.display||"");try{if(/^(dl|dt|dd)$/i.test(r))n=this.formatDl(this.toArray(t.children));else if(/^(div|blockquote|p|caption-div|h[1-6]|hr)$/i.test(r)||s){if(n=this.formatPara(t),/^(caption-div])$/i.test(r))n[0].data[0].data[1].data=n[0].data.splice(1);else if(/^(h[1-6]|blockquote)$/i.test(r)){var l=this.data.ltPropParaChildConversion[r]||{};n.forEach(function(t){for(var e in this.pushIfNot(t.classList,"lyteEditor"+_lyteUiUtils.capitalize(r)),t.data.forEach(function(t){t.style=this.extend(t.style,this.extend(l))}.bind(this)),l)t.style[e]=this.getDefaultValue(e)}.bind(this))}}else if("figure"==r)n=this.formatImage(t);else if(/^(ul|ol)$/i.test(r))n=this.formatUl(t,e);else if(/^(table|img|video)$/i.test(r)){if((n=this.emptyParaData()).data[0]=this.formatWord(t,n),/^img|video$/i.test(r)){var d=n.data[0].style,c=n.style;this.data.ltPropInlineImage&&(d.zIndex=d.zIndex||"10"),d.float&&(this.data.ltPropInlineImage?d.zIndex=d.zIndex||"10":(c.float=d.float,c.zIndex=c.zIndex||"10",delete d.float),d.width=d.width||"100%",d.maxWidth=d.maxWidth||"100%")}else if(/^table$/i.test(r)){var p=n.data[0].data[0].style,h=n.style;["float","margin","lineHeight"].forEach((function(t){h[t]=p[t],delete p[t]}))}}else if("br"==r){if(i){var u=this.getTagName(i)||"",m=i.style||{},f=!/inline/i.test(m.display||""),g=/^(block|flex|grid)$/i.test(m.display||"");if(!(/^(br|div|p|dl|ul|ol|blockquote|figure|dt|dd|caption-div|h[1-6]|hr)$/i.test(u)&&f||g))return o.push(-1),void(i=t)}n=this.emptyParaData()}else{if(t.constructor==Comment||"#comment"==t.nodeName)return;(n=this.emptyParaData()).data=this.formatWord(t,n),o.push(a.length)}this.pushIfValid(a,n)}catch(t){console.warn("Caught error at word formatting"+t.message)}i=t}.bind(this));for(var n=o.length-1;n>=1;n--){var r=o[n-1];-1!=r&&r+1==o[n]&&(Lyte.arrayUtils(a[o[n-1]].data,"push",a[o[n]].data),a.splice(o[n],1))}return this.check_imagePara(a),a},check_imagePara:function(t){return t},copyStylesToLi:function(t){if("LI"!=t.tagName){t.style;let e=t.getAttribute("style"),i=t.children,a=i.length;for(let t=0;t<a;t++)i[t].setAttribute("style",e+(i[t].getAttribute("style")||""));return this.copyStylesToLi(i[0])}return Array.from(t.parentElement.children)},formatPara:function(t){var e=this.toArray(t.childNodes),i=[this.emptyParaData()],a=i[0].data,o=this.getTagName(t),n=e.length,r=this._dir?"rtl":"ltr",s=this.data.ltPropSourceDirection?r:t.style.direction||t.getAttribute("dir")||r,l=r!=s;if(/hr/i.test(o))return[this.insertHr(!0)];l&&(t.style.direction=s),this.getInlineStyle(t,i[0],!0),n&&a.splice(0,1),/^blockquote$/i.test(o)&&this.format_blockquote(t,i,t.getAttribute("lyte-blockquote-type")),e.forEach(function(t){var e=t.hasAttribute?t.hasAttribute("data-section"):void 0;if(t.constructor!=Comment&&"#comment"!=t.nodeName){if(e){const e=t.hasAttribute("editor-language"),i=e?t.getAttribute("editor-language"):"";e&&this.setData("codeEditorLanguage",i);const o=this.convertHtmlToData(void 0,t);e&&this.setData("codeEditorLanguage",""),t.removeAttribute("editor-language"),t.innerHTML="";let n=this.formatWord(t),r={attr:{"data-section":""},tag:"div",data:o,randomId:this.randomId(),details:{}};return n[0].details.type="section",n[0].data=[r],void this.pushIfValid(a,n)}var o=this.getTagName(t);"figure"!=o?("br"==o&&(i.push(this.emptyParaData()),(a=this.last(i).data).splice(0,1)),this.pushIfValid(a,this.formatWord(t,this.last(i),void 0))):this.pushIfValid(a,this.formatImage(t)[0].data[0].data)}}.bind(this)),n&&!a.length&&i.splice(0,1);for(var d=0;d<i.length;d++){var c=this.checkIfContainsImage(i[d]);this.data.codeEditorLanguage&&(c[0].details={snippet:{language:this.data.codeEditorLanguage}}),Lyte.arrayUtils(i,"replaceAt",d,c),d+=c.length-1}return i.map(function(t){return 0==t.data.length&&t.data.push(this.emptyWordData()),this.mergeWordsData(t,{})}.bind(this))},checkIfContainsImage:function(t){if(this.data.ltPropInlineImage)return t;var e=[],i=[],a=t.data,o=t.data,n=this.extend(t);return a.forEach(function(t,e){var a={data:[t]};(this.isImage(a)||this.isTable(a)||this.isHr(a))&&i.push(e)}.bind(this)),i.reverse().forEach(function(t){var i,a=o.splice(t+1),r=o.splice(t);a.length&&((i=this.extend(n)).data=a,e.unshift(this.convertParaStyle(i)));(i=this.extend(n)).data=r,e.unshift(this.convertParaStyle(i)),r[0].style.float&&(i.style.float=r[0].style.float,delete r[0].style.float)}.bind(this)),o.length&&(n.data=o,e.unshift(this.convertParaStyle(n))),e},convertParaStyle:function(t){var e=t.style,i=t.classList,a=this.data.ltPropParaStyleConversion,o=function(t){return t.replace(": ",":")};for(var n in a){var r=a[n].map(o),s=[];for(var l in e){var d=this.dasherize(l)+":"+e[l];-1!=this.getIndex(r,d)&&s.push(l)}s.length==r.length&&(s.forEach(function(t){delete e[t]}.bind(this)),i.push(n))}return t},ifNotStyle:function(t,e,i){var a=t[e];/unset|none/.test(a)&&(a=""),-1==this.getIndex(a||"",i)&&(t[e]=((a||"")+" "+i).trim())},image_data:function(){return[]},add_para_style_to_word:function(t,e,i){var a=this.data,o=a.ltPropWordStyle||{},n=a.ltPropParaStyle||{},r=e.style||{},s=i.style||{},l=t.style||{};(a.ltPropParaToWordStyle||[]).forEach((function(t){var e=l[t],i=s[t];o[t];!i||e||t in n||(r[t]=i)}))},merge_style:function(t,e){["margin","margin-inline","margin-inline-start"].forEach((function(t){"0px"==e.style[t]&&(e.style[t]="")}));var i=t.style,a=i.length,o=e.style;if(o)for(var n=0;n<a;n++){var r=i[n],s=i[r],l=o[r];/^\-\-/i.test(r)||(l||(o[r]=s))}},formatWord:function(t,e,i,a){var o=this.emptyWordData(i),n=this.getTagName(t);t.__processed||(t=this.get_modified_elem(t),n=this.getTagName(t));var r=[],s=this.data.ltPropTagConversion,l=s[n],d=(t.style||{}).textDecorationLine,c="sup"==n||"sub"==n,p="table"===n;l&&(o.classList.push(l),n=""),d&&(t.style.textDecoration=d,t.style.removeProperty("textDecorationLine")),!p&&this.getInlineStyle(t,o),c&&null==o.style.fontSize&&(o.style.fontSize="smaller"),e&&!p&&this.add_para_style_to_word(t,o,e);o.style;try{switch(n){case"table":return o.data=[this.formatTable(t)],o.details.type="table",["float","borderCollapse","marginInline","width","lineHeight"].forEach((function(t){delete o.style[t]})),o;case"img":case"video":return this.image_data(o,t,n);case"a":this.anchor_prop(t,o);break;case"mention_div":this.mention_prop(o,t)}}catch(t){console.log("Error : "+t.message)}if(this.getEventListeners(t,o),(t.children||[]).length){a=t.hasAttribute&&t.hasAttribute("data-section");r=this.mergeWordDom(t,o,a)}else{var h=function(t){var e=this.getSpaceForTab();return t.replace(/\t/g,e)}.bind(this);o.text=this.convertCase(h(t.textContent)),this.data.ltPropWordAttributes&&(o.attr=$L.extend(o.attr||{},this.read_attributes(t))),r.push(o)}var u=(t.style||{}).verticalAlign;if(u){"super"==u&&(u="sup");var m=s[u];m&&(this.pushIfNot(o.classList,m),delete o.style.verticalAlign)}return r.filter((function(t){return"none"!=t.style.display}))},read_attributes:function(t){var e,i=t.attributes||[];if(e=i.length){for(var a={},o=0;o<e;o++){var n=i[o],r=n.nodeName;"style"!=r&&"on"!=r.slice(0,2)&&(a[r]=n.nodeValue)}return a}},extend_style:function(t,e,i){var a=this.data.ltPropMultipleProperty||[];for(var o in e)if(!(i&&this.getIndex(i,o)+1)){var n=e[o];if(a.indexOf(o)+1){var r=t[o];if(r){/none|unset|default/i.test(r)&&(r=""),t[o]=this.arrayExtend(r.split(" "),n.split(" ")).join(" ");continue}}t[o]=n}return t},mergeWordDom:function(t,e){var i=this.toArray(t.childNodes),a=[];return i.forEach(function(t){var i=this.formatWord(t,void 0,!0);if(i.constructor!=Array)return e.details.anchor&&(i.details.parent=e),void a.push(i);i.forEach(function(t){a.push(t),null!=(e.details.event||void 0)&&(t.details.event=$L.extend(this.extend(e.details.event),t.details.event)),t.style=this.extend_style(this.extend(e.style),t.style),t.details=$L.extend(this.extend(e.details),t.details),this.arrayExtend(t.classList,e.classList)}.bind(this))}.bind(this)),a},getInlineStyle:function(t,e,i){if(t.constructor!=Text){for(var a=e.classList,o=e.style,n=(t.getAttribute("style")||"").trim().split(";").reduce(((t,e)=>{let i=e.trim();return i&&t.push(i),t}),[]),r={},s=this.data.ltPropReplaceStyle,l=0;l<n.length;l++){let e=/([^:]+):(.+)/,o=n[l].match(e);if(null==o)continue;let c=this.camelCase(o[1]),p=o[2],h=s[c];if(!/^\-\-/.test(o[1])&&(p=p.replace("!important","").trim(),"fontWeight"==c&&parseFloat(p)>=700&&(p="bold"),h&&(c=h.name,p=h.value==p?h.replaceValue:h.fallBackValue,t.style[c]=p),c&&p&&(r[c.trim()]=p.trim()),!i)){var d=this.classFrmStyle(n[l]);d&&(delete r[c],this.pushIfNot(a,d))}}$L.extend(e.style,r),i||(null!=t.getAttribute("data-image")?o.display=o.display||"inline":t.hasAttribute("data-section")?o.display=o.display||"block":o.display="inline")}},getEventListeners:function(t,e){let i=t.attributes||[],a={};for(let t=0;t<i.length;t++)"on"==i[t].nodeName.slice(0,2)&&(a[i[t].nodeName]=i[t].nodeValue);0!=Object.keys(a).length&&(e.details.event=a)},classFrmStyle:function(t){var e=this.data.ltPropWordStyleConversion,i=function(t){return t.replace(/:\s+/g,":").replace(/^;+/,"").replace(/;+$/,"")};for(var a in e){var o=e[a];if("string"==typeof o&&(o=[o]),-1!=this.getIndex(o.map(i),i(t)))return a}},pasteHandling:function(){var t=this;$L.fastdom.measure((function(){$L.fastdom.mutate((function(){$L(t._pastediv).removeClass("lyteEditorHide")}))}))},proceedPaste:function(t,e){t=Lyte.Component.registeredHelpers.unescape(t,void 0,this._sanitizer).innerHTML,this.check_is_empty();var i,a=this.data.ltPropDefaultPaste;switch(this.__from=e,a){case"destination":i=this.convertTextToDestination(t);break;case"text":i=this.convertTextToPlainData(t);break;default:i=this.convertHtmlToData(t)}this._proceedPaste(i),!a&&e&&(this.__pasted_text=t,this.pasteHandling()),delete this.__from,this.callFind()},_proceedPaste:function(t){var e=this.data.cursor;this.updateRangeNode();var i,a=this.splitPara(!0)||[],o=this.data.currentNode,n=$L(o).closest(this.getTag("paragraph")).get(0),r=$L(n).closest(".listHolderElement"),s=r.data("list"),l=this.findIndex(o),d=this.last(t),c=this.first(t),p=this.data.ltPropWordToParaStyle,h=this.data.ltPropConvertStyle,u=this;if(this.isCaption(n)&&this.remove_for_caption(t,o),!t||!t.length||1==t.length&&this.isEmptyPara(t[0]))return this.setData("cursor",e),this.data._undoqueue.pop(),this.setCursor(this.data.currentNode,e);var m=this.last(d.data);if(i={wordIndex:d.data.length-1,position:m.text.length,paraIndex:t.length+this.getIndex(s,n)},a[1]){var f=d.data,g=1==t.length&&1==f.length&&this.is_emoji(f[0].text);if(this.isEmptyPara(a[1])&&!this.isTable(d)){if(u.data.ltPropAnchorFollowup){var y=f.length&&this.last(f).details.anchor;!y&&g&&(y=!0),y&&(Lyte.arrayUtils(f,"push",a[1].data),i.wordIndex++,i.position=0)}a.splice(1,1)}else g||this.isTable(d)||this.isImage(d)||this.isHr(d)||!this.compareTwoWords(d,a[1],void 0,!0)?(g||1==t.length&&this.compareTwoWords(this.emptyParaData(),c))&&(Lyte.arrayUtils(d.data,"push",a[1].data),a.splice(1,1),g&&(i.wordIndex++,i.position=0)):(Lyte.arrayUtils(d.data,"push",a[1].data),a.splice(1,1))}var v,b=a[0];if(!this.isEmptyPara(b)||b.classList.length||this.isTable(d)){if(!(this.isTable(c)||!this.data.ltPropInlineImage&&this.isImage(c)||this.isHr(d))&&(this.compareTwoWords(c,b,void 0,!0)||!(c.details||{}).tab&&this.compareTwoWords(this.emptyParaData(),c))){var x=b.data.length;v=b,c.data.forEach((function(t){u.checkWordToParaStyle(v,t,p,h)})),Lyte.arrayUtils(b.data,"push",c.data),t.splice(0,1),i.paraIndex--,0==t.length&&(i.wordIndex+=x)}}else a.splice(0,1),i.paraIndex--,1==t.length&&2==t[0].data.length&&y&&function(t,e){p.forEach((function(i){null!=t[0].style[i]&&null==e.style[i]&&"color"!=i&&(e.style[i]=t[0].style[i])}))}(t[0].data,t[0]);Lyte.arrayUtils(a,"insertAt",Math.min(1,a.length),t);let _=a.length;a.forEach(function(t,e){var a=i.paraIndex==e+l.paraIndex?i:void 0,o=this.render(this.mergeWordsData(t,a,void 0,e==_-1)),n=$L(o),s=n.data("list");n.hasClass(this.data.tabClass)&&this.setup_custom_tab(n),this.update_count(_lyteUiEditor.limitFilter(o,1/0,!0).length),this.pushParagraph(o,r,e+l.paraIndex+1),a?this.isTable(t)?(this.setData("currentNode",this.getLastWordInPara(o)),i.position=this.getWordText(this.data.currentNode).length):_lyteUiEditor.isSection(t)?(this.setData("currentNode",this.getFirstWordInPara(o)),i.position=0):this.setData("currentNode",s[a.wordIndex]):s.length>1&&this.removeEmptyWords(o,{})}.bind(this)),this.checkPlaceholder(),this.update_count(-_lyteUiEditor.limitFilter(n,1/0,!0).length),this.removePara(n),this.setData("cursor",i.position),this.updateRangeNode();for(var P=this.data,L=P.ltPropCharacterCount;P.ltPropCharacterCount>P.ltPropMaxlength&&(this.backspace(),L!=(L=P.ltPropCharacterCount)););this.setCursor(this.data.currentNode,this.data.cursor,!1,!0)},executePaste:function(t,e,i){return this.execute(i||"onPaste",t,e,this.$node)},_executePaste:function(){var t=this._editdiv,e=function(){var e=t.innerHTML;this.proceedPaste(e,!0),t.textContent="",this.data.ltPropMobileView&&this.setCursor(this.data.currentNode,this.data.cursor),delete this._pastePrevent}.bind(this);this.data.ltPropConvertInlineImages?Lyte.resolvePromises(this.convert_inline_image(t)).then(e):e()},image_paste:function(t,e){return e()},paste:function(t,e){if(0==this.execute("onBeforePaste",t,this.$node))return e||(t.preventDefault(),t.target.textContent=""),!1;var i=this.data.ltPropReadFromClipboard?t.clipboardData.getData("text/html"):"",a=function(){this._pastePrevent=!0,setTimeout(function(){var e=this._editdiv;if(e.childNodes.length){i&&(e.innerHTML=i);var a=this.executePaste(e,t);this.removeSelected(),a&&a.then?a.then(this._executePaste.bind(this),(function(){t.target.textContent=""})):this._executePaste(),this.executePaste(e,t,"onAfterPaste")}else delete this._pastePrevent}.bind(this),0)}.bind(this);this.image_paste(t,a)},setNode:function(t,e){t&&(this.setData("currentNode",t.node),this.setData("cursor",t.change),this.setCursor(t.node,t.change)),this.setCursor(this.data.currentNode,this.data.cursor),e&&this.resetRange(!0)},findPrevChar:function(t,e,i,a){var o=this.measureLength(t,void 0,e,void 0,!0).letters;return(this[i?"first":"last"](o)||"").length},moveLeftSingleChar:function(t,e,i,a){var o=this.data,n=o.range;if(!a&&n.isRange){var r=o.selectedWords[0];return{node:r.node,change:r.left}}if(o.navCheck&&this._iframe&&0==this.setup_focus("left",i,a))return!1;if(0==parseInt(e)){var s=this.getPreviousWord(t,void 0,void 0,!0);if(!s)return{node:t,change:e};t=s;var l=this.getWordText(t),d=this._hadMention?0:this.findPrevChar(l,t);return delete this._hadMention,{node:t,change:e=Math.max(0,l.length-d)}}var c=this.getWordText(t).slice(0,e),p=(d=this.findPrevChar(c,t),this.convertToLine(t));return e-d==p[this.lineIndex(p,e)].start?e-=d-.5:(e%1==.5&&(e-=.5),e-=d),{node:t,change:Math.max(0,e)}},moveRightSingleChar:function(t,e,i,a){var o=this.data,n=o.range;if(!a&&n.isRange){var r=$L(o.selectedWords).get(-1);return{node:r.node,change:r.right}}if(this.data.navCheck&&this._iframe&&0==this.setup_focus("right",i,a))return!1;var s=this.getWordText(t);if(e==s.length){var l=this.getNextWord(t,void 0,void 0,!0);if(!l)return{node:t,change:e};t=l;var d=this.getWordText(t),c=this._hadMention?0:this.findPrevChar(d,t,!0);return delete this._hadMention,{node:t,change:e=Math.min(c,d.length)}}s=s.slice(e);c=this.findPrevChar(s,t,!0);var p=this.convertToLine(t);return e+c==p[this.lineIndex(p,e)].end?e+=c+.5:(e%1==.5&&(e+=.5,c-=1),e+=c),{node:t,change:Math.min(e,this.getWordText(t).length)}},getCrctNodeForMove:function(t){var e=this.data.range;if(!e.isRange)return{word:this.data.currentNode,cursor:this.data.cursor,startNode:t?"startNode":"endNode",left:t?"left":"right"};var i=this.data.selectedWords;if(this._rangemove){var a=this._rangemove||(t?"left":"right");return{word:this["left"==a?"first":"last"](i).node,cursor:e[a],startNode:"left"==a?"startNode":"endNode",left:a}}var o,n,r=this[t?"first":"last"](i);return"left"==(n=e.startNode==e.endNode?e.left>e.right?t?"right":"left":t?"left":"right":t?r.node==e.startNode?"left":"right":r.node==e.endNode?"right":"left")?o="startNode":(n="right")&&(o="endNode"),{word:e[o],cursor:e[n],startNode:o,left:n}},commonSet:function(t,e,i,a){var o=t.startNode,n=t.left;i?a&&(e[o]=a.node,e[n]=a.change,e.startNode!=e.endNode||e.left!=e.right?(Lyte.objectUtils(e,"add","isRange",!0),this.setNode(a,!1),this.setRange(),this._rangemove=n):this.setNode(a,!0)):this.setNode(a,e.isRange)},getLines:function(t){var e=$L(t).data("list"),i=[];return e.forEach(function(t){Lyte.arrayUtils(i,"push",this.convertToLine(t))}.bind(this)),this.formLine(i)},getLWindex:function(t,e){var i=this.getLines(t.parentNode),a=i.length;e=Math.min(e,this.getWordText(t).length);for(var o=0;o<a;o++)for(var n=i[o],r=n.length,s=0;s<r;s++){var l=n[s];if(l.node==t&&l.start<=e&&e<=l.end)return{wordIndex:s,lineIndex:o,lines:i}}return{wordIndex:--s,lineIndex:--o,lines:i}},home:function(){this.moveLeft(!0)},end:function(){this.moveRight(!0)},pagedown:function(){this.common_page(1)},pageup:function(){this.common_page(-1)},common_page:function(t){var e=this._cursor,i=this._maindiv,a=this.getBcr(e),o=this.getBcr(this.$node),n=new Event("mousedown",{bubbles:!0});n.__ignore=!0,n.clientX=a.left,n.clientY=a.top+o.height*t,i.dispatchEvent(n)},moveLeft:function(t,e,i,a){this.__shiftmove=e,delete this._widthMaintain;var o,n=this.data.range,r=this.getCrctNodeForMove(!0),s=r.word,l=r.cursor;if(!a&&this.get_dir(s))return this.moveRight(t,e,i,!0);if(e&&n.isRange&&null==this.data.topLevelElement){var d=$L(s).closest(".listHolderElement",this._maindiv);-1!=this.getIndex([this.getTag("td"),this.getTag("th")],this.getTagName(d.get(0)))&&(l=0,s=this.getFirstWordInPara(this.first(d.data("list"))))}if(t){var c=this.getLWindex(s,l),p=this.first(c.lines[c.lineIndex]);o={node:p.node,change:p.start+.5}}else o=i?this.getValueForAlt(s,l):this.moveLeftSingleChar(s,l,r,e);if(0==o)return delete this.__shiftmove,o;this.commonSet(r,n,e,o),delete this.__shiftmove},moveRight:function(t,e,i,a){this.__shiftmove=e,delete this._widthMaintain;var o,n=this.data.range,r=this.getCrctNodeForMove(),s=r.word,l=r.cursor;if(!a&&this.get_dir(s))return this.moveLeft(t,e,i,!0);if(e&&n.isRange&&null==this.data.topLevelElement){var d=$L(s).closest(".listHolderElement",this._maindiv);-1!=this.getIndex([this.getTag("td"),this.getTag("th")],this.getTagName(d.get(0)))&&(s=this.getFirstWordInPara(this.last(d.data("list"))),l=this.getWordText(s).length)}if(t){var c=this.getLWindex(s,l),p=this.last(c.lines[c.lineIndex]);o={node:p.node,change:p.end}}else o=i?this.getValueForAlt(s,l,!0):this.moveRightSingleChar(s,l,r,e);if(0==o)return delete this.__shiftmove,o;this.commonSet(r,n,e,o),delete this.__shiftmove},altVerticalMove:function(t,e,i){delete this._widthMaintain;var a=t.parentNode,o=$L(a).data("list"),n=this.getIndex(o,t);if(i)return 0==n&&0==e?{change:0,node:(r=this.getPreviousWord(t))?this.first($L(r.parentNode).data("list")):t}:{change:0,node:this.first(o)};if(n==o.length-1&&e==this.getWordText(t).length){var r,s=(r=this.getNextWord(t))?this.last($L(r.parentNode).data("list")):t;return{change:this.getWordText(s).length,node:s}}return{node:s=this.last(o),change:this.getWordText(s).length}},lineIndex:function(t,e){for(var i=t.length,a=0;a<i;a++){var o=t[a];if(o.start<=e&&o.end>=e)return a}return--a},getFromNext:function(t,e,i){var a=e.lines,o=i?-1:1,n=e.lineIndex+1*o,r=a[n];if(r){for(var s,l=r.length,d=r[0].client,c=this.last(r),p=(o=this._dir?-1:1,this.rtlfunc("left")),h=0;h<l;h++){var u=r[h];if(t-=(u.client[p]-d[p])*o,d=u.client,t<=u.client.width){c=u;break}}return c.node.style.unicodeBidi&&(t=c.client.width-t),s=c.start+(this.data.navCheck&&this._iframe?this.m_width(c.text,t,this.comp_style(c.node)).cursor:this.measureLength(c.text,t,c.node).cursor),{node:c.node,change:s+(s==c.start?.5:0)}}var m=a[n-1*o],f=this[i?"getPreviousWord":"getNextWord"](this[i?"first":"last"](m).node);return f&&(e=this.getLWindex(f,i?this.getWordText(f).length:0)),e.lineIndex-=1*o,this.getFromNext(t,e,i)},getForVerticalMove:function(t,e,i){var a,o=this.getLWindex(t,e),n=o.lineIndex,r=o.lines[n][o.wordIndex],s=o.lines[n][0],l=this.rtlfunc("left");if(null==this._widthMaintain){var d=this.measureLength(r.text.slice(0,e-r.start),void 0,t).width;t.style.unicodeBidi&&(d=r.client.width-d),a=d+r.client[l]-s.client[l],this._widthMaintain=a}else a=this._widthMaintain;return this.getFromNext(a,o,i)},moveTop:function(t,e,i){this._vert=!0;var a,o=this.data.range,n=this.getCrctNodeForMove(!0),r=n.word,s=n.cursor;if(e&&o.isRange&&null==this.data.topLevelElement){var l=$L(r).closest(".listHolderElement",this._maindiv);-1!=this.getIndex([this.getTag("td"),this.getTag("th")],this.getTagName(l.get(0)))&&(r=this.getFirstWordInPara(this.first(l.data("list"))),s=0)}if(t||1==this.findIndex(r,void 0,!0).isFirstPara){delete this._widthMaintain;var d=this.first($L(this._maindiv).data("list"));a={node:this.getFirstWordInPara(d),change:0}}else a=i?this.altVerticalMove(r,s,!0):this.getForVerticalMove(r,s,!0);this.commonSet(n,o,e,a),delete this._vert},moveBottom:function(t,e,i){this._vert=!0;var a,o=this.data.range,n=this.getCrctNodeForMove(),r=n.word,s=n.cursor;if(e&&o.isRange&&null==this.data.topLevelElement){var l=$L(r).closest(".listHolderElement",this._maindiv);-1!=this.getIndex([this.getTag("td"),this.getTag("th")],this.getTagName(l.get(0)))&&(r=this.getFirstWordInPara(this.last(l.data("list"))),s=this.getWordText(r).length)}if(t||1==this.findIndex(r,void 0,!0).isLastPara){delete this._widthMaintain;var d=this.last($L(this._maindiv).data("list"));a={node:r=this.getLastWordInPara(d),change:this.getWordText(r).length}}else a=i?this.altVerticalMove(r,s):this.getForVerticalMove(r,s);this.commonSet(n,o,e,a),delete this._vert},checkPlaceholder:function(){var t=this.data;if(t.ltPropPlaceholder){var e=$L(this._maindiv).children(t.ltPropTags.paragraph),i=!1;if(e.length<=1){let t=function(t){return!(t.style.marginInlineStart&&"0px"!=t.style.marginInlineStart)};if(e=e.get(0)){var a=$L(e).data("data");i=a&&this.isEmptyPara(a)&&!a.classList.length&&t(a)}else i=!0}this.setData("showPlaceholder",i&&!this.__compose)}},cursorChange:function(t,e){var i=this.data;this.scrollIntoView(i.currentNode,i.cursor),this.checkPlaceholder(),this.execute("onCursorChange",t.oldValue,t.newValue,i.currentNode,this.$node,e)},update_panel:function(){var t=this.$node.panel;t&&t.updateIconBarRange()},nodeChange:function(t){this.update_panel();var e="lyteCurrentNode",i="lyteCurrentParagraph",a=$L("."+e,this._maindiv),o=t.oldValue,n=t.newValue,r=this.data;a.get(0)!=n&&(a.removeClass(e).parent().removeClass(i),$L(n).addClass(e).parent().addClass(i)),this.isUndo()||(this._pushToPrevious=!r._undoqueue.length,this.removeEmptyWords(n.parentNode),delete this._pushToPrevious),r.currentNode!=n&&this.setCursor(r.currentNode,r.cursor),this.scrollIntoView(r.currentNode,r.cursor),this.checkPlaceholder(),o&&this.execute("onWordChange",o,n,r.cursor,this.$node),r.navCheck&&this._iframe&&this.setup_nav(n)},rangeChange:function(t){var e=this.data.range;!this._mup&&this.scrollIntoView(e.endNode,e.right),this.execute("onSelect",t,e,this.$node)},rangeObs:function(t){(this.data.range.isRange||"range.isRange"==t.item)&&(clearTimeout(this._rangeTime),this._rangeTime=setTimeout(function(){delete this._rangeTime,this.update_panel(),this.data.range.isRange&&this.rangeChange(t)}.bind(this),0))}.observes("range","range.startNode","range.endNode","range.left","range.right","range.isRange"),cursorObs:function(t){clearTimeout(this._cursorTime);let e=this.__evt;this._cursorTime=setTimeout(function(){delete this._cursorTime,this.cursorChange(t,e)}.bind(this),20)}.observes("cursor"),nodeObs:function(t){clearTimeout(this._nodeTime),this._nodeTime=setTimeout(function(){delete this._nodeTime,this.nodeChange(t)}.bind(this),20)}.observes("currentNode"),rtlfunc:function(t,e,i){if(this._dir){if(e)return"right"==t?i-e.left:i-e.right;if("left"==t)return"right";if("right"==t)return"left"}return e?e[t]:t},selectWord:function(){var t=this.data,e=t.range;if(!e.isRange){var i=t.currentNode,a=t.cursor,o=this.getValueForAlt(i,a,void 0,!0),n=this.getValueForAlt(i,a,!0,!0),r=o.node.parentNode,s=function(t,i){Lyte.objectUtils(e,"add",t,i)};if(r!=n.node.parentNode){var l=this.getLastWordInPara(r);n={node:l,change:this.getWordText(l).length}}s("left",o.change),s("startNode",o.node),s("right",n.change),s("endNode",n.node),s("isRange",e.startNode!=e.endNode||e.left!=e.right),i==e.endNode?(this.setData("currentNode",i),this.setData("cursor",e.right)):(this.setData("currentNode",e.startNode),this.setData("cursor",e.left)),this.common_positioning(),t.isMobile&&e.isRange&&$L.fastdom.measure((function(){$L.fastdom.mutate(this.openMobilePop,this)}),this)}},selectParagraph:function(){this.selectLine(!0)},selectLine:function(t){var e=this.data,i=e.range;if(!i.isRange){var a,o=e.currentNode,n=Lyte.objectUtils;if(t){var r=o.parentNode,s=this.getLastWordInPara(r);a={start:-.5,node:this.getFirstWordInPara(r)},s={node:s,end:this.getWordText(s).length}}else{var l=e.cursor,d=this.getLWindex(o,l),c=d.lineIndex,p=d.lines[c];a=this.first(p),s=this.last(p)}n(i,"add","startNode",a.node),n(i,"add","left",a.start+.5),n(i,"add","endNode",s.node),n(i,"add","right",s.end),n(i,"add","isRange",!(i.startNode==i.endNode&&parseInt(i.left)==parseInt(i.right))),this._ignoreRangeCheck=!0,this.common_positioning(),this._ignoreRangeCheck=!1,e.isMobile&&$L.fastdom.measure((function(){$L.fastdom.mutate(this.openMobilePop,this)}),this)}},splitWordForSpace:function(t){var e=[],i=/\s+/.exec(t);if(i){var a=i.index,o=a+i[0].length;a&&e.push(t.slice(0,a)),final.push(t.slice(a,o)),Lyte.arrayUtils(final,"push",this.splitWordForSpace(t.slice(o)))}else t&&e.push(t);return e},openMobilePop:function(){var t=$L("lyte-overlay:not(.inActive)",this.$node),e=t.get(0),i=t.get(-1),a=e?this.getBcr(e):void 0,o=i?this.getBcr(i):void 0,n={};if(e||(o=a=this.getBcr(this._cursor)),n.left=Math.min(a.left,o.left),n.right=Math.max(a.right,o.right),n.top=Math.min(a.top,o.top),n.bottom=Math.max(a.bottom,o.bottom),n.height=n.bottom-n.top,n.width=n.right-n.left,n.width<50){var r=.5*(50-n.width);n.left-=r,n.right+=r,n.width=50}setTimeout(function(){this.setData("mobileOffset",n),this._mobilepop.ltProp("show",!0)}.bind(this),0)},inline_from_file:function(t,e){var i=new Image;i.onload=function(){var t=this.copy_image(i,void 0,i.naturalWidth,i.naturalHeight);URL.revokeObjectURL(i.src),e("<img src='"+t+"'>",!0)}.bind(this),i.onloadend=function(){this.updateEditorDiv(this.data.currentNode,this.data.cursor)}.bind(this),i.src=URL.createObjectURL(t)},clipboardPaste:function(){var t=this,e=function(){this.$node.focus(),window.requestAnimationFrame((function(){document.execCommand("paste",!0)}))}.bind(this),i=navigator.clipboard;i&&i.read?i.read().then((function(e){e.forEach((function(e){var i,a=e.types,o="image/png";if([o,"text/html","text/plain"].every((function(e){return-1!=t.getIndex(a,e)&&(i=e),!i})),i){var n=t.proceedPaste.bind(t);e.getType(i).then((function(e){if(i==o)t.inline_from_file(e,n);else{var a=new FileReader;a.onload=function(){if(0!=t.call_insert(a.result)){var e=a.result;t.data.ltPropConvertInlineImages?t.inline_image_html(e,n,!0):n(e,!0),t.executePaste(t._editdiv,event,"onAfterPaste")}},a.onloadend=function(){t.updateEditorDiv(t.data.currentNode,t.data.cursor)},a.readAsText(e)}}))}else n()}))})):e()},removeLetters:function(t,e){var i,a=this.data,o=a.currentNode,n=a.cursor;null!=e&&(i=t),this.reset();var r={fakeRange:!0,isRange:!0,startNode:o,left:null==i?n-t:i,endNode:o,right:null==e?n:e};this.getSelected(r),this.removeSelected(r,!0)},hide_paste_div:function(){$L(this._pastediv).addClass("lyteEditorHide"),delete this._prev_paste_state,delete this.__pasted_text},check_limit:function(t,e){var i=this.data,a=i.ltPropMaxlength,o=i.ltPropCharacterCount,n=a-o;let r=function(){this.getMethods("onMaxLengthReach")&&this.executeMethod("onMaxLengthReach")}.bind(this);if(n>0){let i=_lyteUiEditor.limitFilter(t,a-o,!0,e);return i.flag&&r(),i}return r(),{html:"",length:0}},update_count:function(t){var e="ltPropCharacterCount";this.setData(e,this.data[e]+t)},blockquote_check:function(){},insertHr:function(t){var e=this.emptyParaData();if(e.classList.push("lyteEditorHrTag"),t)return e;this.$node.insertJSON([e])},check_rtl:function(t){this.mergeWords(t,["unicodeBidi","direction"]),this.splitRtlWord(t)},create_compose:function(){var t=this.data.currentNode,e=this.render(this.extend($L(t).addClass("lyteEditorComposerNode").css("pointerEvents","none").data("data"),{})),i=this.data.cursor,a=this.getWordText(t),o=a.slice(0,i),n=a.slice(i);return t.innerText="",o&&t.appendChild(new Text(o)),t.appendChild(this.__compose=e),n&&t.appendChild(new Text(n)),this.checkPlaceholder(),e},update_composition:function(t){var e=this.__compose||this.create_compose();this.getWordText(e);e.innerText=t,$L(e).data("data").text=t,$L.fastdom.clear(this.__compose_time),delete this.__compose_time,this.__compose_time=$L.fastdom.measure(function(){delete this.__compose_time;var t=window.getSelection().getRangeAt(0);t.startContainer;this.setCursor(e,t.endOffset,!0)}.bind(this))},clear_composition:function(){var t=this.__compose;if(t){$L.fastdom.clear(this.__compose_time),delete this.__compose_time;var e=t.parentNode;t.remove(),delete this.__compose,e&&e.normalize(),window.requestAnimationFrame(this.checkPlaceholder.bind(this)),this.setCursor(this.data.currentNode,this.data.cursor)}},get_valid_new_lines:function(t,e){var i=t.data||[],a=i.filter((function(t){return t.tag==e})),o=0,n=a.length;return n&&(o+=n-1),i.forEach(function(t){o+=this.get_valid_new_lines(t,e,0)}.bind(this)),o},update_count_in_delete:function(t,e,i,a){var o=this.get_valid_new_lines(t,this.getTag("paragraph"));if(1!=i&&o++,a)return o;this.update_count(-1*o)},update_count_in_insert:function(t,e,i,a){var o=this.get_valid_new_lines(t,this.getTag("paragraph"));if(i&&o++,a)return o;this.update_count(o)},emoji_composition:function(t){clearTimeout(this.__emoji_compose),this.__emoji_compose=setTimeout(function(){this.processInput(this._editdiv)}.bind(this),0)},remove_merge_default:function(t){return this.data.ltPropMultipleProperty.forEach((function(e){/^(none|unset)$/i.test(t[e]||"")&&delete t[e]})),t},insert_and_clear:function(t){this.processInput(this._editdiv,t),this.clear_composition()},showSuggestion:function(t){this.data.cursor;let e=this.convertHtmlToData('<span class="lyteEditorSuggestionWord">'+t+"</span>")[0].data[0],i=this.render(e);this._suggestionWord=i,Lyte.Component.insertAfter(this.data.currentNode,i)},removeSuggestion:function(){this._suggestionWord.remove(),this._suggestionWord=null},applySuggestion:function(){let t=this.data.currentNode,e=this.getWordText(t),i=this._suggestionWord.innerText,a=this.data.cursor;this.updateNodeValue(t,e+i),this.setCursor(t,a+i.length),this.removeSuggestion()},setSuggestionWord:function(t){let e=$L(this.$node).find("#"+t.id).data("list");this._suggestionWord=$L(e[t.paraIndex]).data("list")[t.wordIndex]},update_height:function(){if(!this.__editor_manually_resized){var t=this._maindiv;t.style.height="auto",$L.fastdom.clear(this.___measure_q),this.___measure_q=$L.fastdom.measure((function(){delete this.___measure_q;var e=t.offsetHeight;$L.fastdom.mutate((function(){t.style.height=e+"px"}))}))}}},{mixins:_lyteUiEditor.mixins}),Lyte.Mixin.register("lyte-editor-blockquote",{blockquote_check:function(t){var e=this,i="_blockquote";clearTimeout(t[i]),t[i]=setTimeout((function(){delete t[i],e.$node.contains(t)&&e.check_bq(t)}),0)},check_bq:function(t){var e,i,a,o,n=[],r=this.data.ltPropBlockquoteClasses,s=this,l=void 0,d=$L(t),c=(o=d.data("data")).data||o,p=d.data("list"),h=t.id,u="lyteBlockquoteFirst",m="lyteBlockquoteLast",f=function(){a=!0;var t=n.pop();y(e,u),t?(g(e,m),g(t,u),y(t,m)):y(e,m),n.forEach((function(t){g(t,u),g(t,m)})),i=e=l,n=[]},g=function(t,e){var i=c[t].classList,a=s.getIndex(i,e);a+1&&($L(p[t]).removeClass(e),i.splice(a,1),v("removeClass",e,t))},y=function(t,e){var i=c[t].classList;-1==s.getIndex(i,e)&&($L(p[t]).addClass(e),i.push(e),v("addClass",e,t))},v=function(t,e,i){s.pushToQueue({operation:"class",prop:t,id:h,value:e,element:"arr:"+i})};(c.data||c).forEach(function(t,a){_lyteUiEditor.isSection(t)&&this.check_bq($L("#"+t.data[0].data[0].randomId).get(0));var o=t.classList;if(s.getIndex(o,"lyteEditorBlockquote")+1){var d=function(t){var e;return r.every((function(i){return s.getIndex(t,i)+1&&(e=i),!e})),e}(o);e==l?(e=a,i=d):i==d?n.push(a):(f(),e=a,i=d)}else e!=l&&f()}.bind(this)),e!=l&&f(),a&&this.common_positioning()},lyteEditorBlockquote:function(t){var e=this.extend(this.data.ltPropBlockquoteClasses,[]),i="lyteEditorBlockquote",a=this.getIndex(e,t=t||"lyteEditorQuoteLeft"),o=this;return a+1&&e.splice(a,1),this.toggleParaClass(t,void 0,function(t,e){var n=o.findIndex(o.getFirstWordInPara(t)),r=$L(t),s=r.data("data");if(e){var l=s.details.tab;r.hasClass(i)||(o.pushToQueue({operation:"class",prop:"addClass",id:n.id,value:i,element:"arr:"+n.paraIndex}),r.addClass(i),s.classList.push(i)),l&&o.tab_common_fn(void 0,void 0,t,!1)}else[i,"lyteBlockquoteFirst","lyteBlockquoteLast"].forEach((function(t){var e=s.classList;(a=o.getIndex(e,t))+1&&(o.pushToQueue({operation:"class",prop:"removeClass",id:n.id,value:t,element:"arr:"+n.paraIndex}),r.removeClass(t),e.splice(a,1))}));this.blockquote_check(t.parentNode)}.bind(this),e)},removeBlockquote:function(){if(!this.isUpdateIcon()){var t,e=this.data,i=e.selectedParagraph,a=e.ltPropBlockquoteClasses,o=this;i.forEach((function(e){var i=$L(e),n=i.data("data").classList,r=o.findIndex(o.getFirstWordInPara(e)),s=function(t){var e=o.getIndex(n,t);if(e+1)return o.pushToQueue({operation:"class",prop:"removeClass",id:r.id,value:t,element:"arr:"+r.paraIndex}),i.removeClass(t),n.splice(e,1),!0};s("lyteEditorBlockquote")&&(t=!0,a.forEach(s),o.blockquote_check(e.parentNode))})),t&&this.common_positioning()}},format_blockquote:function(t,e,i){var a=this.data.ltPropParaStyleConversion[i=$L(t).attr("lyte-blockquote-type")]||[];e[0].classList.push(i),e.forEach(function(t){var e=t.style;a.forEach(function(t){delete e[this.camelCase(t.split(":")[0]||"")]}.bind(this))}.bind(this))}}),Lyte.Mixin.register("lyte-editor-bluepencil",{actions:{mainPaste:function(t){if(null!=this.__empty_pencil_time)return!1;var e=t.clipboardData.getData("text/html");return 0!=this.paste(t,!0)&&(this._editdiv.innerHTML=e),t.preventDefault(),!1},mainInput:function(t){var e="__blue_ignore";if(this[e])return delete this[e],!1;var i=t.inputType;if("insertFromPaste"==i)return this[e]=!0,this.reset_entire();if("insertCompositionText"!=i){var a=window.getSelection().getRangeAt(0);if(a.collapsed){var o=a.commonAncestorContainer.parentNode,n=a.startOffset,r=o.textContent,s=t.data,l=this.data,d=(l.range,"onAfterInput");this.$node.contains(l.currentNode)&&this.reset_current_word(l.currentNode,o,l.cursor,r,n,s),this.getMethods(d)&&this.executeMethod(d,l.currentNode,l.cursor,this.$node)}}},mainKey:function(t){this.copy_evt(t);this.keydown(t);this._editdiv.focus(),this.remove_evt()}},reset_entire:function(t){var e=this._maindiv,i=e.innerHTML,a=event,o=function(){var t=$L(e).data("list")[0],o=this.$node,n=this.__place;Array.from(e.childNodes).forEach((function(t){t.remove()})),n&&this.append(o,n),this.append(this._maindiv,this._cursor),this.append(e,t),i&&o.insertHTML(i),this.execute("onAfterPaste",this._editdiv,a,this.$node),this.checkPlaceholder(),delete this.__blue_ignore}.bind(this);t?o():(clearTimeout(this.__empty_pencil_time),delete this.__empty_pencil_time,setTimeout(o,100))},dispatch_input:function(){this.__blue_ignore=!0,this._maindiv.dispatchEvent(new Event("input",{bubbles:!0}))},__blue_undo:function(){var t=window.getSelection(),e=document.createRange(),i=this.data,a=i.currentNode.childNodes[0],o=i.cursor;t.removeAllRanges(),e.setStart(a,o),e.setEnd(a,o),t.addRange(e),this.dispatch_input()},blue_undo:function(){clearTimeout(this.__blue),this.__blue=setTimeout(this.__blue_undo.bind(this))},pencil_index:function(t,e){var i=t.parentNode||e.parentNode,a=$L(i),o=a.closest(".listHolderElement"),n=o.attr("id"),r=a.data("list"),s=this.getIndex(o.data("list"),i);return{wordIndex:this.getIndex(r,t),paraIndex:s,id:n}},positional_update:function(t,e,i,a,o){var n=this.pencil_index(t,i),r=null==o;this.pushToQueue({operation:"update",oldValue:a,newValue:r?a:o,id:n.id,index:n.paraIndex,wordIndex:n.wordIndex,current:{index:{wordIndex:n.wordIndex,position:e},bluepencil:!0}}),r||this.update_count(o.length-a.length)},modify_pencil_nodes:function(t){t.forEach(function(t){var e=t.act_text;this.positional_update(t.node,e.length,void 0,t.ori_text,e),t.data.text=e}.bind(this))},remove_pencil_nodes:function(t,e){var i=e.parentNode,a=$L(i),o=a.closest(".listHolderElement"),n=o.attr("id"),r=a.data("list"),s=a.data("data").data,l=this.getIndex(o.data("list"),i);t.forEach(function(t){var e=this.getIndex(r,t),i=s[e];this.pushToQueue({operation:"wordDelete",data:i,index:{id:n,paraIndex:l,wordIndex:e},id:n}),this.update_count(-i.text.length),r.splice(e,1),s.splice(e,1)}.bind(this))},reset_current_word:function(t,e,i,a,o,n){var r=$L(t).data("data").text,s=this.get_removed_words(e.parentNode),l=s.removed,d=s.modified;this.positional_update(t,i,e,r),this.remove_pencil_nodes(l,e),this.modify_pencil_nodes(d),this.positional_update(e,o,void 0,a),this.setData({currentNode:e,cursor:o}),this.common_positioning()},get_removed_words:function(t){var e=Array.from(t.children),i=$L(t).data("list"),a=[];return{removed:i.filter((function(t){var i=-1==e.indexOf(t);if(!i){var o=t.textContent,n=$L(t).data("data"),r=n.text;o!=r&&a.push({node:t,act_text:o,ori_text:r,data:n})}return i})),modified:a}},before_edit_open:function(){this.selectAll();var t=this.$node.getHTML().replace(/<br>/g,'<p><span style = "display:inline-block;"></span></p>'),e=Array.from($L(t)),i=window.getSelection(),a=document.createRange(),o=this.__place,n=this._maindiv.querySelector(".lyteEditorCursor"),r=Lyte.Component;this.removeSelected(),n||this._maindiv.appendChild(n=e.shift()),this.toArray(this._editdiv.childNodes).forEach((function(t){t.tagName?t.remove():t.nodeValue&&(t.nodeValue="")})),this.createRange(this._editdiv.childNodes[0],0),Array.from(n.parentNode.querySelectorAll(this.getTag("paragraph"))).forEach((function(t){t.remove()})),e.forEach((function(t){t.removeAttribute("id"),r.insertAfter(n,n=t)})),this._cursor.remove(),o&&o.remove(),i.removeAllRanges();var s,l=$L(n.childNodes).get(-1)||n,d=l.nodeValue;s=d?d.length:((l.childNodes||[]).length||1)-1,a.setStart(l,s),a.setEnd(l,s),i.addRange(a),window.requestAnimationFrame(this.common_evt_fn.bind(this,"add"))},common_evt_fn:function(t){var e,i="__pencil_evt",a="__pencil_close",o=this[i];"add"==t?(o=this[i]=this.pencil_move.bind(this),e=this[a]=this.pencil_close.bind(this)):(delete this[i],this._maindiv.removeEventListener("bpe_pocketeditor_close",this[a])),document.body[t+"EventListener"]("click",o,!0),this._maindiv.addEventListener("bpe_pocketeditor_close",e)},pencil_move:function(t){t.target},pencil_close:function(){this.common_evt_fn("remove"),this._maindiv.focus(),this.__empty_pencil_time=setTimeout(function(){delete this.__empty_pencil_time,this.reset_entire(!0)}.bind(this),100)},append_cursor:function(t){var e=t.parentNode,i=$L((e||{}).children).get(-1);e&&i!=t&&e.appendChild(t)}}),Lyte.Mixin.register("lyte-editor-anchor",{edit_value_change:function(t){var e=this.data,i=e.range.isRange,a=this.convert_html_to_txt(this.getSelectedText()||"").trim(),o=null!=t.newValue&&t.newValue.trim(),n=null!=e.userInput?e.userInput.trim():"",r=!((n||i)&&o);if(e.anchorShow&&!i){if(e.textModified)return this.setData("buttonDisable",r);this.setData("userInput",n=o)}this.setData("buttonDisable",!((n||a)&&o))}.observes("anchorEdit.href"),emailEditValueObs:function(t){this.checkIsValid(t)}.observes("anchorEdit.mailId","anchorEdit.text","anchorEdit.telephone"),checkIsValid:function(t){var e=t.newValue,i=!0,a=this.data.anchorEdit,o=this.data.currentAnchorType;"anchorEdit.mailId"!=t.item||/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/i.test(a.mailId)||"email"!=o||(i=!1),"anchorEdit.telephone"==t.item&&e&&!e.match(/^[+]*[(]{0,1}[0-9]{1,4}[)]{0,1}[-\s\./0-9]*$/g)&&"telephone"==o&&(i=!1),null!=a.text&&""!=a.text||this.data.userInput||(i=!1),this.setData("buttonDisable",!i)},isLinkObs:function(){this.setData("buttonDisable",!0)}.observes("isLink"),anchor_pop_show:function(t){var e="addClass";t.newValue||(this.setData("textModified",!1),e="removeClass"),$L(this.$node)[e]("lyteAnchorPopoverOpened")}.observes("anchorShow"),anchor_tooltip:function(t,e,i,a){var o=t.data("data"),n={"lt-prop-title":e.title||e.href,"lt-prop-tooltip-config":this.data.ltPropTooltipConfig},r=o.attr;for(var s in r||(o.attr=r={},a&&a("attr",void 0,{})),r.href&&(o.attr.href=e.href),n){var l=n[s],d=r[s];d!=l&&(r[s]=l,i&&i(d,l,s))}t.attr(n)},modify_anchor_text:function(t){var e=this.data,i=e.currentNode,a=e.userInput||t.text,o=this.data.range;this.getWordText(i)!=a&&o.startNode==o.endNode&&(this.updateRangeNode(),this.updateNodeValue(i,a),this.setData("cursor",a.length),this.resetRange(!0),this.updateRangeNode(),this.common_positioning())},applyLink:function(){if(!this.getMethods("onBeforeAnchorInsert")||0!=this.executeMethod("onBeforeAnchorInsert",this.data.anchorEdit.href,this.data.userInput,this.$node)){var t,e=this.data,i=e.anchorEdit,a=i.newWindow?"_blank":"_self",o=this.data.currentAnchorType,n=(this.data.ltPropAnchorAdvancedOption,i.title);switch(o){case"link":t=i.href;break;case"email":t="mailto:"+i.mailId+(i.mailSubject?"?Subject="+i.mailSubject:"");break;case"telephone":t="tel:"+i.telephone}if(t){"link"!=o||/^(htt(p|ps):\/\/)/.test(t)||(t="http://"+t),e.range.isRange?(this.anchor({href:t,target:a,title:n}),e.ltPropAnchorTextEdit&&this.modify_anchor_text(i)):this.$node.insertHTML("<a href='"+t+"' "+(n?"title='"+n+"' ":"")+"target='"+a+"' style='"+this.style_for_anchor(e.currentNode)+"'>"+_lyteUiEditor.escapeText(e.userInput)+"</a>",!0),this._popover.ltProp("show",!1),this.$node.focus();var r="onAnchorModification";this.getMethods(r)&&this.executeMethod(r,this.$node)}}},methods:{anchorShow:function(t){var e=this._popover.ltProp("originElem");$L(e).addClass("lyteEditorPanelListPopOpened"),this.setData("inputFocus",!0);var i=this.data,a="onAnchorShow";this.scrollIntoView(i.currentNode,i.cursor),this.getMethods(a)&&this.executeMethod(a,this.$node,t.actualModalDiv.getElementsByTagName("lyte-popover-content")[0])},anchorClose:function(){this.setData("currentAnchorType","link"),this.setData("linkChecked",!0);var t=this._popover.ltProp("originElem");$L(t).removeClass("lyteEditorPanelListPopOpened")}},actions:{check_key:function(t){"Enter"!=t.key||this.data.buttonDisable||(this.applyLink(),t.preventDefault())},anchorClick:function(t){return!1},applyLink:function(){this.applyLink()},editLink:function(){var t=this.data;this.setData({isEditLink:!1,inputFocus:!0,userInput:t.ltPropAnchorTextEdit?t.anchorEdit.text:""}),this.anchorEdit(t.currentNode),this._popover.alignPopover()},removeWord:function(){this.removeAnchorWord(),this._popover.ltProp("show",!1),this.$node.focus();var t="onAnchorModification";this.getMethods(t)&&this.executeMethod(t,this.$node)}},removeAnchorStyle:function(t){var e=t.style,i=this.data.ltPropWordStyle,a=(i.textDecoration||"").split(" "),o=(e.textDecoration||"").split(" "),n=o.length,r=(this.data.ltPropAnchorStyle,i.color||"");e.color;e.color=r;for(var s=0;s<n;s++){var l=o[s];if(!(a.indexOf(l)+1)&&"underline"==l){o.splice(s,1);break}}(e.textDecoration=o.join(" "))||delete e.textDecoration},addAnchorStyle:function(t,e,i){var a=this.data,o=a.ltPropAnchorStyle||{},n=a.ltPropMultipleProperty,r=t.style,s=this._popover,l=s&&s.ltProp("show");for(var d in o){var c=o[d],p=(e?e.style:r)[d];if(n.indexOf(d)+1){var h=r[d]?(r[d]||"").split(" "):[];if(h.indexOf(c)+1||this.data.ltPropMultipleProperty.indexOf(d)+1&&(h.indexOf("unset")+1||h.indexOf("none")+1))continue;h.push(c),c=h.join(" ")}!l&&p||(r[d]=c,e&&(e.style[d]=c,i&&i(p,c,d)))}},remove_anchor_data:function(t){this.removeAnchorStyle(t);var e=t.details||{},i=t.classList||{};delete e.type,delete e.anchor,Lyte.arrayUtils(i,"removeAt",this.getIndex(i,"lyteEditorAnchor")),this.reset_anchor(t)},removeAnchorWord:function(t,e){var i,a=this.data,o=a.currentNode,n=t||o,r=this.findIndex(n),s=$L(n),l=this.extend(s.data("data")),d=(l.details,l.classList,n==o),c="onBeforeAnchorRemove",p=!0;return d&&this.updateRangeNode(),this.getMethods(c)&&(i=n,p=0!=this.executeMethod(c,l,n,r,this.$node)),p&&this.remove_anchor_data(l),this.deleteSingleWord(n,r),i=this.insertSingleWord(l,this.extend(r)),d&&(this.setData("currentNode",i),this.setCursor(i,a.cursor)),this.resetRange(),d&&this.updateRangeNode(),i},openAnchor:function(){var t=this.data.currentNode;$L(t).hasClass("lyteEditorAnchor")&&window.open(t.data("data").details.anchor.href,"_blank")},anchorOpen:function(){var t=this.data,e=t.range,i=$L(t.currentNode),a="popOrigin"+t.randomId,o=t.selectedWords,n=!0;if(1==o.length){var r=o[0].node;n=!$L(r).hasClass("lyteEditorAnchor")}if(e.isRange&&n||this._popover.ltProp("show"))return this._ignore=!0,this._popover.ltProp("show",!1),void delete this._ignore;$L("."+a).removeClass(a),i.addClass(a);var s=i.data("data"),l=Lyte.objectUtils,d=this.data.anchorEdit;l(d,"add","href",(s.details.anchor||{}).href),l(d,"add","text",s.text),l(d,"add","title",(s.details.anchor||{}).title),this.setAnchorType(d.href),this.setData("isEditLink",!0),this.$node.focus(!0),this._popover.ltProp("show",!0)},setAnchorType:function(t){let e="link";/^mailto:/.test(t)?e="email":/^tel:/.test(t)&&(e="telephone"),this.setData(e+"Checked",!0),this.setData("currentAnchorType",e)},anchorEdit:function(t){var e=$L(t).data("data").details.anchor||{},i="popOrigin"+this.data.randomId,a=this.data.range,o=this.getWordText(t),n=Lyte.objectUtils;n(a,"add","left",0),n(a,"add","right",o.length),n(a,"add","startNode",t),n(a,"add","endNode",t),n(a,"add","isRange",0!=a.right),this.setRange();let r={};if(/^mailto:/.test(e.href)){let t=/\?Subject=([^&]*)/,i=e.href.match(t);r.mailSubject=i&&(i[1]||""),r.mailId=e.href.replace("mailto:","")}else/^tel:/.test(e.href)?r.telephone=e.href.replace("tel:",""):r.href=e.href;r.title=e.title||"",r.newWindow="_blank"==e.target,r.text=o,this.setData("anchorEdit",r),this.setData("buttonDisable",!0),$L("."+i).removeClass(i),$L(t).addClass(i),this._popover.ltProp("show",!0)},anchor:function(t){t.title||delete t.title;var e=this;return this.toggleWordClass("anchorChange",void 0,(function(i){var a=$L(i),o=a.data("data")||i,n=o.details,r=i.constructor!=Object,s=n.anchor;if(e.compareObject(s||{},t))return!1;var l,d=r&&e.findIndex(i),c="arr:"+d.paraIndex+".data.arr:"+d.wordIndex,p=function(t,i,a){e.pushToQueue({operation:"properties",prop:c+"."+t,id:d.id,oldValue:i,newValue:a})},h="lyteEditorAnchor",u=o.classList;return t?(l="addClass",e.pushIfNot(u,h),r&&p("details",n,{type:"anchor",anchor:t}),n.type="anchor",n.anchor=e.extend(t),r?e.addAnchorStyle(o,i,(function(t,i,a){e.pushToQueue({operation:"styleSet",oldValue:t,newValue:i,prop:a,id:d.id,index:d,word:!0})})):e.anchor_prop(void 0,o),r&&e.anchor_tooltip(a,n.anchor,(function(t,i,a){e.pushToQueue({operation:"attribute",prop:c+".attr."+a,id:d.id,oldValue:t,newValue:i})}),p)):(r&&p("details.type",n,{}),delete n.type,delete n.anchor,e.removeAnchorStyle(o),u.splice(e.getIndex(u,h),1),l="removeClass"),a[l](h),t&&s&&(l=""),r&&l&&e.pushToQueue({operation:"class",prop:l,id:d.id,value:h,element:c}),!1}))},link:function(){this.anchorEdit(this.data.currentNode)},userInput_mod:function(t){var e=this.data,i=e.anchorEdit.href.trim(),a=null!=t.newValue&&t.newValue.trim(),o=e.range.isRange;e.anchorShow&&a!=i&&!e.textModified&&this.setData("textModified",!0),e.anchorShow&&e.textModified&&this.setData("buttonDisable",!((a||o)&&i)),o||this.setData("buttonDisable",!(i&&a))}.observes("userInput"),reset_anchor:function(t){var e=t.attr||{},i=this.data.ltPropAnchorProperty;for(var a in["type","target","rel","referrerpolicy","ping","media","hreflang","href","download","lt-prop-title","lt-prop-tooltip-config"].forEach((function(t){delete e[t]})),i)delete e[a]},anchor_prop:function(t,e){var i=this.extend(this.data.ltPropAnchorProperty),a=e.details;t&&["type","target","rel","referrerpolicy","ping","media","hreflang","href","download","title"].forEach((function(e){t[e]?i[e]=t[e]:i[e]&&(t[e]=i[e])})),a.type="anchor",this.pushIfNot(e.classList,"lyteEditorAnchor"),a.anchor&&null!=a.anchor.href&&(i.href=a.anchor.href),a.anchor&&null!=a.anchor.title&&(i.title=a.anchor.title),a.anchor=i,"false"==i.editable&&(delete i.editable,e.attr=e.attr||{},e.attr.editable="false"),this.addAnchorStyle(e,t)},check_other_links:_lyteUiEditor.check_other_links,check_urls:_lyteUiEditor.check_urls,url_detection:function(){var t=this.data,e=t.currentNode,i=$L(e).data("data"),a=t.cursor-1,o=this.getWordText(e),n=o.slice(0,a).split(new RegExp(" |\\s")).pop(),r=this.check_urls(new Text(n));if(r.tagName){var s=o.slice(0,a-n.length),l=(r.innerHTML,o.slice(a)),d=this.findIndex(e);this.updateRangeNode(),this.setData("cursor",1),this.updateNodeValue(e,l);var c=this.mergeWordDom(r,this.extend(i));if(s){var p=this.extend(i);p.text=s,c.unshift(p)}c.reverse().forEach(function(t){this.insertSingleWord(t,this.extend(d))}.bind(this)),this.updateRangeNode(),this.common_positioning()}},style_for_anchor:function(t){var e=this.data,i=(this.extend(e.ltPropAnchorStyle),e.ltPropMultipleProperty),a=["color","display"],o=$L(t).data("data"),n=o.style,r="",s={},l=o.classList,d=this.data.ltPropTagConversion,c=d.sub,p=d.sup,h=this.data.ltPropWordStyleConversion||{},u=this.data.ltPropConvertStyle||{};for(var m in n)if(!(this.getIndex(a,m)+1)){var f=n[m];if(u[m]&&u[m].value==n[m]){let t=u[m];m=t.name,f=t.replaceValue}this.getIndex(i,m)+1?this.ifNotStyle(s,m,f):s[m]=f}for(var m in s)r+=this.dasherize(m)+":"+s[m]+";";return this.getIndex(l,c)+1?r+="vertical-align:sub;":this.getIndex(l,p)+1&&(r+="vertical-align:super;"),l.forEach((function(t){var e=h[t];t!=c&&t!=p&&e&&(r+=e.replace(/^;/,""))})),r}}),Lyte.Mixin.register("lyte-editor-caption",{copyCaption:function(t){var e=$L(t).find(this.getTag("paragraph")),i=[];e.length&&e.data("list").forEach(function(t){Lyte.arrayUtils(i,"push",this.copyInSameWord(t,0))}.bind(this));return i},caption:function(t){var e=this.data.range,i=$L(this.data.currentNode);if(!e.isRange&&i.hasClass("lyteEditorImage")){var a,o,n,r=i.data("data");this.containsCaption(r)||(this.updateRangeNode(),(a=this.emptyParaData()).style=this.extend(this.data.ltPropCaptionStyle),a.data[0].text=t,this.update_count(t.length),o=this.last(i.data("list")),n=this.render(a),this.pushParagraph(n,o,0),this.setData("currentNode",this.getLastWordInPara(n)),this.setData("cursor",this.getWordText(this.data.currentNode).length),this.updateRangeNode(),this.setCursor(this.data.currentNode,this.data.cursor))}},removeCaption:function(){this.updateRangeNode(),this.removeSelected();var t=$L(this.data.currentNode),e=t.closest(this.getTag("paragraph"));if(this.isCaption(e.get(0))&&(t=e.parent().closest(this.getTag("word"))),t.hasClass("lyteEditorImage")){var i=t.find(this.getTag("paragraph")).get(0);this.update_count(_lyteUiEditor.limitFilter(i,1/0,!0)),this.removePara(i),this.setData("currentNode",t.get(0)),this.setData("cursor",0),this.updateRangeNode(),this.setCursor(this.data.currentNode,this.data.cursor)}},filteroutCaption:function(t){return this.filteroutMention(this._filterout(/\[caption(.+)\]<img/i,"img",this._filterout(/\[caption(.+)\]<video/i,"video",t)))},_filterout:function(t,e,i){if(t.test(i)){var a=t.exec(i)[1].trim();i=(i=i.replace(t,"<caption-div "+a+"><"+e)).replace("[/caption]","</caption-div>"),i=this._filterout(t,e,i)}return i},remove_for_caption:function(t,e){for(var i=t.length,a=this.findIndex(e),o=0;o<i;o++){var n=t[o];(this.isTable(n)||this.isImage(n)||this.isHr(n))&&(t.splice(o,1),o--,i--)}if(i){t.forEach(function(t){t.data.forEach(function(t){this.insertSingleWord(t,a)}.bind(this))}.bind(this));var r=this.extend($L(e).data("data")),s=r.text,l=this.data.cursor;r.text=s.slice(0,l),this.insertSingleWord(r,a),this.setData("cursor",0),this.updateNodeValue(e,s.slice(l)),this.setCursor(e,0)}},containsCaption:function(t){return t.data[1].data.length}}),Lyte.Mixin.register("lyte-editor-code-snippet",{convertSnippetToData:function(t,e,i){const a=Array.from(t.childNodes||[]),o=this.data.spaceDetails,n=this.data.snippetUtils||{},r=this;let s,l=!1,d=null!=i,c=[],p=0,h=0,u=0,m="",f={},g=0,y=0;const v=function(){null!=o[h]&&(s=r.extend(r.emptyParaData()),s.details.snippet={language:e},""===t&&d||(s.data=[]),c.push(s))},b=function(t,e){y=e?y:t.length,i<=g+t.length?(f.nodeIndex=s.data.length-1,f.cursor=e?i-g+y:i-g,d=!1):g+=t.length},x=function(t){if(o[h]&&o[h].length!==p){let e=$L(c[0].data).get(-1);null==e&&(e=r.emptyWordData(),c[0].data.push(e));let i=$L(o[h]).get(-1).indent;e.text+=i,d&&b(i,t)}},_=function(){const t=o[h];let e=!1;if(t&&0===t.length||t&&1===t.length&&(e=""===t[0].value)){const a=r.emptyWordData();return e&&(a.text=t[0].indent),s.data.push(a),e&&b(t[0].indent),h++,null==i&&v(),_()}return!0};return v(),_(),""===t?{data:c,cursor:{nodeIndex:0,cursor:0}}:(a.forEach((function(t){const e=t.classList.value;let a=t.textContent;a=a.replace(/\n/g," "),(a.split(" ")||[]).forEach((function(t){if(""!=t.trim()){const a=r.extend(r.emptyWordData());a.style=n[e]||{};const c=o[h][p];let f;t===c.value?(u=0,m=c.indent+t,p++):(f=c.value.slice(u).indexOf(t),0==f&&(m=0===u?c.indent+t:t,u+=t.length),u===c.value.length&&(l=!0,u=0,p++)),a.text=m,s.data.push(a),d&&b(m);const g=o[h][p];(void 0!==g&&""===g.value||void 0===g)&&(l||0===u)&&(x(!0),h++,p=0,void 0===i&&v(),_()),l=!1}}))})),x(!0),Object.keys(f).length?{data:c,cursor:f}:c)},insertTextInSnippet:function(t,e,i,a){const o=this.findIndex(t),n=i.details.snippet.language,r=$L(e).closest(".listHolderElement");let s=0;for(let t=0;t<o.wordIndex;t++)s+=i.data[t].text.length;s+=this.data.cursor,a=null!=a?a.replace(/\u00a0/g," "):a;const l=e.innerText,d=null!=a,c=l.slice(0,s)+(d?a:"")+l.slice(s);this.calculateCodeIndent(c);const p=""!==c?$L.snippets.getBuilder(i.details.snippet.language,c).build().snippet:"",h=this.convertSnippetToData(p,n,s+(d?a.length:0));this.removePara(e),this.pushParagraph(this.render(h.data[0]),r,o.paraIndex),this.data.currentNode=$L("#"+o.id).data("list")[o.paraIndex].children[h.cursor.nodeIndex],this.data.cursor=h.cursor.cursor,this.setCursor(this.data.currentNode,this.data.cursor),d&&this.update_count(a.length),console.log()}}),Lyte.Mixin.register("lyte-editor-find",{find:function(t){if(!this.data.ltPropFindAndReplace)return;this.setData("selectedRange",[]);let e=this.getData("highlightSpan");if(0!=e.length)for(let t=0;t<e.length;t++)e[t].remove();let i=this.getData("highlightInnerSpan");if(0!=i.length)for(let t=0;t<i.length;t++)i[t].remove();null!=t&&this.setData("ltPropFindShow",!0);const a=this._maindiv;var o=[],n=[];let r=t,s=1;if(""!=r&&null!=r&&"boolean"!=typeof r&&(r=r.toLowerCase()),r&&"boolean"!=typeof r){let t="",e=[".","*","+","?",".","^","$","{","}","(",")","\\","[","]","=","|"],i="";for(let t=0;t<r.length;t++)e.includes(r[t])?i=i+"\\"+r[t]:i+=r[t];t=i.toLowerCase();let d=$L(this.$node).find("lyte-paragraph"),c=[],p=[],h={},u=[];for(let e=0;e<d.length;e++){const i=$L(d[e]).data("list");for(let e=0;e<i.length;e++){u=[];let a=this.getWordText(i[e]).toLowerCase();if(h.completelyFound){let t={left:h.startNodeIndex,right:h.endNodeIndex,startNode:h.startNode,endNode:h.endNode,isRange:!1},e=this.getSelected(t,!0);p.push(e),c.push(t)}null!=h.endNodeIndex&&u.push({node:i[e],index:[0,h.endNodeIndex-1]});let o=[],n=[];h.completelyFound?n=a.slice(h.endNodeIndex).toLowerCase().matchAll(t):o=a.toLowerCase().matchAll(t);for(const t of o)if(null==u[u.length-1]||u[u.length-1].index[1]<t.index){let a={left:t.index,right:t.index+r.length,startNode:i[e],endNode:i[e],isRange:!1},o=this.getSelected(a,!0);u.push({node:i[e],index:[t.index,t.index+r.length-1]}),p.push(o),c.push(a)}for(const t of n)if(null==u[u.length-1]||u[u.length-1].index[1]<t.index+h.endNodeIndex){let a={left:t.index+h.endNodeIndex,right:t.index+r.length+h.endNodeIndex,startNode:i[e],endNode:i[e],isRange:!1},o=this.getSelected(a,!0);u.push({node:i[e],index:[t.index,t.index+r.length-1]}),p.push(o),c.push(a)}if(h.completelyFound&&(h={completelyFound:void 0,value:void 0,size:void 0,foundlength:void 0,startNode:void 0,startNodeIndex:0,endNode:void 0,endNodeIndex:void 0}),""!=a){let t=a[a.length-1].toLowerCase(),o=r[0];function l(t,e){let i=[];for(let a=0;a<t.length;a++)t[a]==e&&i.push(a);return i}if(null!=h.startNode&&e+1<i.length){let t=this.getWordText(i[e+1]).toLowerCase(),o=r.length-h.foundLength;t.length>=o&&t.substring(0,o)==r.substring(r.length-o,r.length)?(h.value=h.value+a.substring(0,r.length-h.foundLength),h.foundLength=h.foundLength+o,h.completelyFound=!0,h.endNode=i[e+1],h.endNodeIndex=o,u={node:i[e+1],index:[0,o-1]}):t.substring(0,t.length)==r.substring(r.length-o,r.length-o+t.length)?(h.value=h.value+t,h.foundLength=h.foundLength+t.length,u.push({node:i[e],index:[0,t.length]})):h={completelyFound:void 0,value:void 0,size:void 0,foundlength:void 0,startNode:void 0,startNodeIndex:0,endNode:void 0,endNodeIndex:void 0}}else if(r.includes(t)){let t=l(a,o),n=t[t.length-1];for(let o=0;o<t.length;o++){let s=u[u.length-1];if((t[o]+1>(s&&s.index[1])||null==(s&&s.index[1])||0==u.length)&&e+1<i.length){let s=this.getWordText(i[e+1]).toLowerCase(),l=r.length-(a.length-t[o]);if(l=l<s.length?l:s.length,l>0){let d=(a.substring(t[o],a.length)+s.substring(0,l)).toLowerCase(),c=d.length;if(r.substring(0,c)==d){n=t[o],h.startNode=i[e],h.startNodeIndex=n,h.completelyFound=c==r.length,h.completelyFound&&(h.endNode=i[e+1]),h.endNodeIndex=l,h.foundLength=c,h.value=d,u.push({node:i[e],index:[n,l]});break}}}}}else h={}}}}for(let t=0;t<p.length;t++){const e=document.createElement("span");if(e.classList.add("lyteUiEditorFindHighlight"),1==p[t].length)e.style.top=p[t][0].top+"px",e.style.height=p[t][0].height+"px",e.style.left=p[t][0].left+"px",e.style.right=p[t][0].right+"px",e.style.width=p[t][0].width+"px",e.style.transform=p[t][0].transform;else{let i,o=0,r=0,l=0,d=0,c=[],h={};for(let e=0;e<p[t].length;e++){let i={top:p[t][e].top,left:p[t][e].left,height:p[t][e].height,width:p[t][e].width};c.push(i),i={}}0!=Object.keys(h).length&&c.push(h),e.style.top=d+"px",e.style.height=r+"px",e.style.left=l+"px",e.style.width=o+"px";for(let t of c)i=document.createElement("span"),i.classList.add("lyteUiEdtorFindPartialHighlight"),i.classList.add(`select${s}`),i.style.top=t.top+"px",i.style.height=t.height+"px",i.style.left=t.left+"px",i.style.width=t.width+"px",n.push(i),a.appendChild(i)}if(o.push(e),a.appendChild(e),1==s){e.classList.add("current");for(let t=0;t<n.length;t++)n[t].classList.add("current");this.changeHighlightData(0)}s++}p.length||this.setData("currentHighlight",void 0),this.setData("selectedRange",c),this.setData("highlightSpan",o),this.setData("highlightInnerSpan",n),this.removeLineOffsetData(),this.reset()}},replaceCurrentText:function(t,e,i,a,o,n){let r=null==o?this.getData("selectedRange")[t]:o[t];if(null!=r){let n=r.startNode,s=r.endNode,l=r.left,d=r.right;if(n==s){let r=n.textContent.slice(0,l)+e+n.textContent.slice(d);if(null!=o){this.updateRangeNode();let a=this.data.cursor;n==this.data.currentNode&&(a<=d&&a>=l?this.setData("cursor",l+e.length):a>d&&(i.length<e.length?this.setData("cursor",a-i.length+e.length):i.length>e.length&&this.setData("cursor",a+i.length-e.length))),t>0&&t<o.length-1&&o[t-1].startNode!=n&&o[t+1].endNode!=s?(this.updateNodeValue(n,r,void 0,!0,!0,!0),this.updateRangeNode()):t>0&&t<o.length-1&&o[t-1].startNode!=n&&o[t+1].endNode==s?this.updateNodeValue(n,r,void 0,!0,!0,!1):t>0&&t<o.length-1&&o[t-1].startNode==n&&o[t+1].endNode==s?this.updateNodeValue(n,r,void 0,!0,!1,!1):t>0&&t<o.length-1&&o[t-1].startNode==n&&o[t+1].endNode!=s?this.updateNodeValue(n,r,void 0,!0,!1,!0):0==t&&t<o.length-1&&o[t+1].endNode==s?this.updateNodeValue(n,r,void 0,!0,!0,!1):0==t&&t<o.length-1&&o[t+1].endNode!=s||0==t&&t==o.length-1?(this.updateNodeValue(n,r,void 0,!0,!0,!0),this.updateRangeNode()):t>0&&t==o.length-1&&o[t-1].startNode==n&&o[t-1].startNode==s?(this.updateNodeValue(n,r,void 0,!0,!1,!0),this.updateRangeNode()):t>0&&t==o.length-1&&o[t-1].endNode!=n||t>0&&"multiNode"==this.data.previousSelection&&n==s?(this.updateNodeValue(n,r,void 0,!0,!0,!0),this.updateRangeNode()):console.warn(o,t)}else this.updateNodeValue(n,r,void 0,!0);a||this.callFind(),this.data.previousSelection="singleNode"}else{this.updateRangeNode();let i=r.startNode.textContent.slice(0,l)+e;if(this.updateNodeValue(s,r.endNode.textContent.slice(d),void 0,!0),this.updateNodeValue(r.startNode,i),this.data.currentNode==r.startNode&&this.data.cursor>=l)this.setData("currentNode",r.endNode),this.setData("cursor",0),this.updateRangeNode();else if(this.data.currentNode==r.endNode&&this.data.cursor)this.setData("currentNode",r.endNode),this.setData("cursor",0),this.updateRangeNode();else{let t=r.startNode.nextSibling;for(;null!=t&&t!=r.endNode;)this.data.currentNode==t?(this.setData("currentNode",r.endNode),this.setData("cursor",0),this.updateRangeNode()):t=t.nextSibling}if(null!=o){let e=o[t];for(let i=t;i<o.length-1;i++)e.endNode==o[i+1].startNode&&e.endNode==o[i+1].endNode?(o[i+1].left=o[i+1].left-d,o[i+1].right=o[i+1].right-d):null!=o&&o.length>i+1&&e.endNode==o[i+1].startNode&&(o[i+1].left=o[i+1].left-d)}let n=r.startNode,c=[];if(null!=n&&null!=n)for(;null!=n&&r.endNode!=n.nextSibling;)c.push(n.nextSibling),n=n.nextSibling;for(let t of c)null!=t&&this.deleteSingleWord(t,this.findIndex(t));this.data.previousSelection="multiNode",a||this.callFind()}}},replaceAllText:function(t){let e=this.getData("selectedRange"),i=this.getData("findInput"),a=0;if(null!=e)for(let o=0;o<e.length;o++){let n=null!=i&&null!=a?a*(i.length-1):0,r=null!=a?a*(t.length-1):0;o>0&&(e[o-1].startNode==e[o-1].endNode&&e[o-1].endNode==e[o].startNode&&e[o].startNode==e[o].endNode?(e[o].left=e[o].left+r-n,e[o].right=e[o].right+r-n):e[o-1].startNode==e[o-1].endNode&&e[o-1].endNode==e[o].startNode&&(e[o].left=e[o].left+r-n)),this.replaceCurrentText(o,t,i,!0,e,a),a++,o+1<e.length&&e[o+1].startNode!=e[o].endNode&&(a=0)}this.callFind()}}),Lyte.Mixin.register("lyte-editor-image",{imageText:function(t){var e,i=t.parentNode,a=this.findIndex(t),o=$L(i).closest(".listHolderElement"),n=o.data("list")[a.paraIndex+1];let r=this.emptyParaData();if(this.data.ltPropInlineImage)return a.wordIndex++,this.insertSingleWord(this.emptyWordData(),a),void this.setData({currentNode:this.getNext(t),cursor:0});if(n){var s=$L(n).data("data");(this.isImage(s)||this.isTable(s)||this.isHr(s))&&(e=!0,n=this.render(r))}else e=!0,n=this.render(r);e&&this.pushParagraph(n,o,a.paraIndex+1),this.setData("currentNode",this.getFirstWordInPara(n)),this.setData("cursor",0)},deleteImage:function(t){this.updateRangeNode();var e,i,a=$L(t).closest(this.getTag("paragraph")).get(0),o=this.findIndex(t),n=$L(a).closest(".listHolderElement"),r=n.data("list"),s=r[o.paraIndex-1],l=r[o.paraIndex+1],d=s?$L(s).data("data"):void 0,c=l?$L(l).data("data"):void 0,p=d&&(this.isImage(d)||this.isTable(d)||this.isHr(d)),h=c&&(this.isImage(c)||this.isTable(c)||this.isHr(c));if(this.data.ltPropInlineImage){let n=this.getPreviousWord(t),r=this.getNextWord(t),s=$L(a).data("list");this.deleteSingleWord(t,o),n&&r?(e=r,i=0):n&&r?(e=n,i=this.getWordText(n).length):!n&&r?(e=r,i=0):n||r||(this.insertSingleWord(this.emptyWordData(),o),e=s[o.wordIndex],i=0),this.setData("currentNode",e),this.setData("cursor",i)}else{if(this.removePara(a),s&&l&&!p&&!h&&(e=this.getFirstWordInPara(l),i=0),s&&!l)e=this.getLastWordInPara(s),i=this.getWordText(this.data.currentNode).length;else if(!s&&l)e=this.getFirstWordInPara(l),i=0;else if(!s&&!l){var u=this.render(this.emptyParaData());this.pushParagraph(u,n,o.paraIndex),e=this.getFirstWordInPara(u),i=0}null!=e&&this.setData("currentNode",e),null!=i&&this.setData("cursor",i)}this.setCursor(this.data.currentNode,this.data.cursor),this.updateRangeNode()},inline_image_html:function(t,e,i){var a=this.create("div");a.innerHTML=t,Lyte.resolvePromises(this.convert_inline_image(a)).then((function(){e(a.innerHTML,i)}))},replaceImage:function(t,e){let i=this.data.ltPropTags,a=e.closest(i.word),o=this.findIndex(a);$L(this.$node).find("#"+o.id).get(0);t=Lyte.Component.registeredHelpers.unescape(t,void 0,this._sanitizer).innerHTML;let n=this.convertHtmlToData(t)[0];this.deleteSingleWord(a,o),this.insertSingleWord(n.data[0],o)},alignImage:function(t){var e=this.data.currentNode,i=$L(e);if(i.hasClass("lyteEditorImage")&&!this.data.range.isRange){var a=i.closest(this.getTag(this.data.ltPropInlineImage?"word":"paragraph")).get(0),o=this.isUpdateIcon();if(a.style.float==t)return{applied:[1],toApply:[]};if(o)return;this.setStyle(a,"float",t),this.setStyle(a,"zIndex","10"),this.setStyle(e,"margin","0 10px"),this.setStyle(e,"clear","both"),this.setCursor(e,0),this.update_panel()}},imageDrop:function(t,e){this.updateRangeNode();var i=$L(t).data("directions"),a=e.style.width,o=e.style.height;this.data.range;e.style.left="",e.style.top="",i.width&&this.setStyle(e,"width",a),i.height&&this.setStyle(e,"height",o),this.common_positioning(),this.updateRangeNode()},formatImage:function(t){var e=this.emptyParaData(),i=[],a=this.toArray(t.childNodes),o=this.emptyParaData();a.forEach(function(t){((t.childNodes||[]).length>1?this.toArray(t.childNodes):[t]).forEach(function(t){this.pushIfValid(i,this.formatWord(t))}.bind(this))}.bind(this)),e.data=[i[0]],e.data[0].data[1].data=[o],o.data=i.splice(1);var n=e.data[0].style,r=e.style;return n.float&&(r.float=n.float,r.zIndex=r.zIndex||"10",n.width=n.width||"100%",n.maxWidth=n.maxWidth||"100%",delete n.float),[e]},check_imagePara:function(t){var e=this;this.data.ltPropInlineImage||t.forEach((function(t){var i=t.data,a=e.get_images(i);i.length!=a.length&&a.forEach((function(t){var e=t.details,i=t.attr;delete e.resize,delete e.arguments,i||(t.attr=i={}),i.editable="false"}))}))},get_images:function(t){return t.filter((function(t){return"image"==t.details.type}))},emptyImage:function(t,e){return{details:{},data:[{tag:e,details:{src:((t=t||{}).attributes.src||{}).nodeValue||"",alt:t.alt||""},style:{margin:0}}],classList:["lyteEditorImageWrapper"],style:{width:"100%",height:"100%",overflow:"auto"},tag:"div"}},image_data:function(t,e,i){t.data=[this.emptyImage(e,i),{data:[],style:{pointerEvents:"none",width:"100%"},details:{type:"captionWrapper"},randomId:this.randomId(),tag:"div"}],$L.extend(t.style,this.data.ltPropImageStyle);var a=$L(e),o=function(t){return t&&/^[0-9]+$/.test(t)?t+"px":t||""},n=o(a.attr("width")),r=o(a.attr("height"));return n&&(t.style.width=n),r&&(t.style.height=r),t.style.zIndex=t.style.zIndex||"10",t.details.type="image",t.details.tag=i,t.details.displayType=e.getAttribute("display-type")||"fitToScreen",t.classList.push("lyteEditorImage"),"false"!=a.attr("editable")?(t.details.resize=this.data.ltPropImageResize,t.details.arguments={boundary:"lyte-texteditor, "+this.getTag("th")+", "+this.getTag("td"),minWidth:50,minHeight:50,onDrop:this.imageDrop.bind(this),clonedShape:!0}):t.attr={editable:"false"},t},convert_inline_image:function(t){var e=Array.from(t.getElementsByTagName("img")),i=[],a=(t=this,function(e,i,a){try{e.src=t.copy_image(i,"",i.naturalWidth,i.naturalHeight)}catch(t){console.warn("Can not convert to inline image"+t.message)}a()});return e.forEach((function(e){e.src;i.push(new Promise((function(i,o){var n,r=e.src;if(/^(data|blob):/i.test(r))return i();t.getMethods("onImagePaste")&&(n=t.executeMethod("onImagePaste",e.src,e,t.$node)),n&&n.then&&n.then((function(t){e.src=t}));var s=new Image;s.crossOrigin="Anonymous",s.src=r,s.onload=a.bind(t,e,s,i),s.onerror=function(){t.execute("onImageError",e,r,t.$node),i()}})))})),i},image_paste:function(t,e){var i=t.clipboardData.files||[],a=i[0];return this.data.ltPropConvertInlineImages&&a&&1==i.length&&/image\/*/i.test(a.type)?(this.inline_from_file(a,function(t){this._editdiv.innerHTML=t,e()}.bind(this)),t.preventDefault()):e()},methods:{imageMenuOpen:function(t,e){var i=e.clientX,a=e.clientY;t.ltProp("boundary",{left:i,top:a,bottom:a,right:i}),t.component.setContextCss(e,t.ltProp("position"))},imageSelect:function(t,e,i,a){if("remove"==t)this.deleteImage(a);else if("edit"==t){let t=$L(this.$node.panel.$node).find(".lyteEditorImageIcon")[0].component,e=a.getElementsByTagName("img")[0];var o=function(e){let i=$L(e).closest("lyte-word").get(0),a=$L(i).data("data"),o=a.details.displayType;t.data.ltPropImageOptions.forEach((function(t){t.subItems.forEach((function(t){let i,n=t.purpose;switch(n){case"alt":Lyte.objectUtils(t,"add","value",e.alt||"");break;case"height":case"width":i="","actualSize"==o?Lyte.objectUtils(t,"add","value",e["natural"+n]||""):"custom"==o?(Lyte.objectUtils(t,"add","value",parseInt(a.style[n])||""),/%$/.test(a.style.width)&&(i="%")):Lyte.objectUtils(t,"add","value",""),Lyte.objectUtils(t,"add","unit",i||"px");break;case"unit":i="","custom"==o&&/%$/.test(a.style.width)&&(i="%");break;case"horizontal":Lyte.objectUtils(t,"add","value",parseInt(a.style.marginInline)||"");break;case"vertical":Lyte.objectUtils(t,"add","value",parseInt(a.style.marginTop)||"");break;case"border":Lyte.objectUtils(t,"add","value",parseInt(a.style.border)||"");break;case"align":i=a.style.float?a.style.float:a.style.verticalAlign,Lyte.objectUtils(t,"add","value",i)}}))})),"custom"!=o&&t.setData(o,!0)}.bind(this);t._imgElm=e,t.setData("cpShow",!0),t.setData("url",e.src),o(e)}else{var n,r,s=a.getElementsByTagName("img")[0],l=$L($L(s).closest("lyte-word").get(0)).data("data"),d=s.naturalWidth,c=s.naturalHeight,p="actualSize",h=this.data.ltPropImageStyle.margin||"0px",u=this.findIndex(a),m=a.style,f=$L(a).data("data").style,g=function(t,e){var i=m[e];i!=t&&(f[e]=m[e]=t,this.pushToQueue({operation:"styleSet",oldValue:i,newValue:t,prop:e,id:u.id,index:u,word:!0}))}.bind(this),y=function(t,e){let i=l.details[e];this.pushToQueue({operation:"properties",prop:"arr:"+u.paraIndex+".data.arr:"+u.wordIndex+".details."+e,id:u.id,oldValue:i,newValue:t}),l.details[e]=t}.bind(this);switch(t){case"small":r=c/d*(n=200)+"px",n+="px",p="small";break;case"fit_to_screen":n="calc( 100% - "+h+" - "+h+" )",r="calc( "+c/d*100+"% - "+h+" - "+h+" )",p="fitToScreen";break;case"actual_size":n=d+"px",r=c+"px",p="actualSize"}g(n,"width"),g(r,"height"),y(p,"displayType")}this.$node.focus()}}}),Lyte.Mixin.register("lyte-editor-language-navigation",{lang_init:function(){this.setData({navCheck:!0,renderFrame:!0})}.on("init"),lang_destroy:function(){delete this._navigation,delete this.__nav_data_added}.on("didDestroy"),setup_nav:function(t){var e=t.parentNode,i=this.convertToParaFormat(e),a=(i.data,this._navigation);if(this.isImage(i)||this.isHr(i))delete this.__nav_data_added;else{var o=this.render(i);a.innerHTML="",a.appendChild(o),this.__nav_data_added=t}},setup_focus:function(t,e,i,a,o){if(!this.__nav_data_added)return!0;this.__ignore_focusblur=!0;var n=window.getSelection(),r=document.createRange(),s=this.data,l=a||s.currentNode,d=null==o?s.cursor:o,c=this.findIndex(l).wordIndex,p=this._navigation,h=p.children[0],u=$L(h).data("list"),m=u[c],f=m.childNodes[0],g=l.style.unicodeBidi,y=document.activeElement,v=f;if(g&&/firefox/i.test(navigator.userAgent)&&(t={left:"right",right:"left"}[t]),f||m.appendChild(f=new Text("")),"left"==t&&d==c&&!d||"right"==t&&c==u.length-1&&d==f.nodeValue.length)return!0;if(p.focus(),n.removeAllRanges(),r.setStart(f,d),r.setEnd(f,d),n.addRange(r),a){var b=this.getBcr(l),x=this.getBcr(m),_=v?this.getBcr(r):x,P=this.rtlfunc("left"),L=this._maindiv,w=L.scrollTop,I=L.scrollLeft,E=this.getBcr(L),C=this.get_dir(l),T=_[P]-x[P]+(b[P]-E[P])+I,N=C&&!g||!C&&g,S={height:_.height,top:w+_.top-x.top+b.top-E.top,transform:""};return C?(N&&(S.transform="translateX(100%)"),S.right=T,S.left=""):(N&&(S.transform="translateX(-100%)"),S.left=T,S.right=""),delete this.__ignore_focusblur,this.$node.contains(y)?this.$node.focus(!0):y.focus(),S}return setTimeout(function(){var a=n.getRangeAt(0),o=a[("left"==t?"start":"end")+"Offset"],r=a.startContainer.parentNode;if(this.$node.focus(!0),delete this.__ignore_focusblur,"lyte-word"==this.getTagName(r)){var d=this.findIndex(r);this.commonSet(e,s.range,i,{node:$L(l.parentNode).data("list")[d.wordIndex],change:o})}}.bind(this),50),!1},cursor_pos:function(t,e){return this.setup_nav(t),!!this.__nav_data_added&&this.setup_focus(void 0,void 0,void 0,t,e)},m_width:function(t,e,i){for(var a=this.getFontFromStyle(i),o=(parseFloat(i.fontSize),this._iframe.contentDocument.body),n=t.length,r="",s=null==e,l=s?n:0;l<=n;l++)r+="<span style='font:"+a+"'>"+t.slice(0,l)+"</span>";o.innerHTML=r;var d=Array.from(o.children),c=0,p=0,h=0;return s&&(e=1/0),d.every((function(t,i){var a=t.offsetWidth;if(e+4>=a)p=i,h=a;else if(++c>3)return!1;return!0})),o.innerHTML="",{cursor:s?n:p,width:h}}}),Lyte.Mixin.register("lyte-editor-list",{list_init:function(){this.data.listMapping={ulTick:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2212px%22 height = %2212px%22%3E%3Cpath d = %22M313.8,47l-7.4,8.2l-2.2-1.6H303l3.4,5.5l8.6-12h-1.2V47z%22 style=%22fill:%23313949%3Btransform:translate(-303px,-47px)%3B%22/%3E%3C/svg%3E",ulVolume:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2210px%22 height = %228px%22%3E%3Cpath d = %22M322.2,51.6L322.2,51.6c-0.3,0-0.5,0.1-0.7,0.3s-0.3,0.4-0.3,0.7v0.9c0,0.3,0.1,0.5,0.3,0.7 c0.2,0.2,0.4,0.3,0.7,0.3l0,0c0.1,0,0.3,0,0.4,0.1s0.2,0.1,0.3,0.2l1.7,2c0.3,0.3,0.8,0.1,0.8-0.3v-6.9c0-0.4-0.5-0.6-0.8-0.3 l-1.7,2c-0.1,0.1-0.2,0.2-0.3,0.2S322.3,51.6,322.2,51.6z M328.6,49.4c0,0-0.1-0.1-0.2-0.1s-0.1,0-0.2,0s-0.1,0-0.2,0 s-0.1,0.1-0.2,0.1s-0.1,0.1-0.1,0.2c0,0.1,0,0.1,0,0.2c0,0.1,0,0.1,0,0.2c0,0.1,0.1,0.1,0.1,0.2c1.7,1.6,1.7,4.3,0,5.9 c0,0-0.1,0.1-0.1,0.2c0,0.1,0,0.1,0,0.2c0,0.1,0,0.1,0,0.2c0,0.1,0.1,0.1,0.1,0.2c0,0,0.1,0.1,0.2,0.1s0.1,0,0.2,0s0.1,0,0.2,0 s0.1-0.1,0.2-0.1C330.7,54.7,330.7,51.4,328.6,49.4z M327.2,50.7c-0.1-0.1-0.2-0.1-0.3-0.1c-0.1,0-0.2,0.1-0.3,0.1 c-0.1,0.1-0.1,0.2-0.1,0.3s0.1,0.2,0.1,0.3c1,0.9,1,2.4,0,3.3c0,0-0.1,0.1-0.1,0.2c0,0.1,0,0.1,0,0.2c0,0.1,0,0.1,0,0.2 s0.1,0.1,0.1,0.2c0.1,0.1,0.2,0.1,0.3,0.1c0.1,0,0.1,0,0.2,0s0.1-0.1,0.2-0.1C328.6,54.1,328.6,52,327.2,50.7z%22 style=%22fill:%23313949%3Btransform:translate(-321px,-49px)%3Bfill-rule:evenodd%3Bclip-rule:evenodd%3B%22/%3E%3C/svg%3E",ulSquareOutline:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %228px%22 height = %228px%22%3E%3Cpath d = %22M0,0L8,0L8,8L0,8Z%22 style=%22fill:none%3Bstroke:%23313949%3Bstroke-width:1.5%3Bstroke-linecap:round%3Bstroke-linejoin:bevel%3B%22/%3E%3C/svg%3E",ulDisclosureClosed:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %229px%22 height = %2211px%22%3E%3Cpath d = %22M394.6,72l-7.8-4.9c-0.1-0.1-0.2-0.1-0.3-0.1c-0.1,0-0.2,0-0.3,0.1c-0.1,0-0.2,0.1-0.2,0.2 c-0.1,0.1-0.1,0.2-0.1,0.3v9.9c0,0.1,0,0.2,0.1,0.3c0.1,0.1,0.1,0.2,0.2,0.2s0.2,0.1,0.3,0.1c0.1,0,0.2,0,0.3-0.1l7.8-4.9 c0.1-0.1,0.1-0.1,0.2-0.2c0-0.1,0.1-0.2,0.1-0.3s0-0.2-0.1-0.3C394.7,72.1,394.7,72.1,394.6,72z%22 style=%22fill:%23313949%3Btransform:translate(-386px,-67px)%3B%22/%3E%3C/svg%3E",ulLineBall:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2212px%22 height = %2213px%22%3E%3Cpath d = %22M348.9,52.9c0-0.8-0.1-1.6-0.4-2.4c-0.3-0.8-0.8-1.4-1.3-2c-0.6-0.6-1.3-1-2-1.3c-0.8-0.3-1.6-0.4-2.4-0.4 c0.1,0.9-0.1,1.8-0.4,2.6l-1.1-0.5c0.3-0.6,0.4-1.3,0.3-2c-1.1,0.2-2.1,0.8-2.9,1.6s-1.4,1.8-1.6,2.9c0.5,0,1,0,1.5-0.2l0.3,1.2 c-0.7,0.2-1.4,0.3-2,0.2c0,0.8,0.1,1.6,0.4,2.4c0.3,0.8,0.8,1.4,1.3,2c0.6,0.6,1.3,1,2,1.3c0.8,0.3,1.6,0.4,2.4,0.4 c-0.1-0.7,0-1.4,0.2-2l1.2,0.3c-0.2,0.5-0.2,1-0.2,1.5c1.1-0.2,2.1-0.8,2.9-1.6s1.4-1.8,1.6-2.9c-0.7-0.1-1.3,0.1-2,0.3l-0.5-1.1 C347.2,52.9,348.1,52.8,348.9,52.9z M341.2,51c-0.4,0.4-0.8,0.7-1.3,1l-0.6-1.1c0.6-0.3,1.2-0.8,1.5-1.4l1,0.7 C341.7,50.5,341.5,50.8,341.2,51z M345.5,55.3c-0.3,0.3-0.6,0.6-0.8,1l-1.1-0.6c0.4-0.8,1-1.5,1.8-2l0.7,1 C345.9,54.9,345.7,55.1,345.5,55.3z%22 style=%22fill:%23313949%3Btransform:translate(-337px,-46px)%3B%22/%3E%3C/svg%3E",ulDiamond:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2212px%22 height = %2212px%22%3E%3Cpath d = %22M405.4,52.8c-0.1-0.1-0.2-0.2-0.2-0.4s0.1-0.3,0.2-0.4l5-5c0.1-0.1,0.2-0.2,0.4-0.2s0.3,0.1,0.4,0.2l5,5 c0.1,0.1,0.2,0.2,0.2,0.4c0,0.1-0.1,0.3-0.2,0.4l-5,5c-0.1,0.1-0.2,0.2-0.4,0.2s-0.3-0.1-0.4-0.2L405.4,52.8z%22 style=%22fill:%23313949%3Btransform:translate(-405px,-46px)%3B%22/%3E%3C/svg%3E",ulFingerPointer:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2213px%22 height = %2212px%22%3E%3Cpath d = %22M294.6,72.2h-7.2l0.7-1.8c0.1-0.1,0.1-0.3,0.1-0.5s0-0.3-0.1-0.5c-0.1-0.1-0.2-0.3-0.3-0.4 c-0.1-0.1-0.3-0.2-0.4-0.2l-0.2-0.1c-0.1,0-0.2,0-0.4,0s-0.2,0.1-0.3,0.2l-2.6,3c-0.1,0.1-0.1,0.2-0.1,0.4v6.2 c0,0.3,0.1,0.6,0.4,0.8s0.5,0.3,0.8,0.3h4.3c0.3,0,0.6-0.1,0.8-0.3c0.2-0.2,0.4-0.5,0.4-0.7l0.5-4.2h3.6c0.3,0,0.6-0.1,0.8-0.3 c0.2-0.2,0.4-0.5,0.4-0.8s-0.1-0.6-0.4-0.8C295.2,72.3,294.9,72.2,294.6,72.2z%22 style=%22fill:%23313949%3Btransform:translate(-283px,-68px)%3B%22/%3E%3C/svg%3E",ulPencil:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2210px%22 height = %229px%22%3E%3Cpath d = %22M375.7,68.1c-0.1-0.1-0.1-0.1-0.2-0.1s-0.2,0-0.2,0h-0.2c-0.1,0-0.1,0.1-0.2,0.1l-5.3,5.3v2.8 c0,0.2,0.1,0.3,0.2,0.5c0.1,0.1,0.3,0.2,0.5,0.2h2.8l5.3-5.3c0.1-0.1,0.1-0.1,0.1-0.2s0-0.2,0-0.2c0-0.1,0-0.2,0-0.2 s-0.1-0.1-0.1-0.2L375.7,68.1z%22 style=%22fill:%23313949%3Btransform:translate(-369px,-68px)%3B%22/%3E%3C/svg%3E",ulOutlineStar:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2213px%22 height = %2212px%22%3E%3Cpath d = %22M97.1,99.5l-3.4,1.9l0.6-4l-2.8-2.8l3.8-0.6l1.7-3.6l1.7,3.6l3.8,0.6l-2.8,2.8l0.6,4L97.1,99.5z%22 style=%22fill:none%3Btransform:translate(-91px,-90px)%3Bstroke:%23313949%3Bstroke-linecap:round%3Bstroke-linejoin:round%3B%22/%3E%3C/svg%3E",ulFilledHeart:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2211px%22 height = %229px%22%3E%3Cpath d = %22M305.9,69.8c-0.2-0.2-0.5-0.4-0.8-0.5s-0.6-0.2-0.9-0.2s-0.6,0.1-0.9,0.2s-0.6,0.3-0.8,0.5 c-0.2,0.2-0.4,0.5-0.5,0.8s-0.2,0.6-0.2,0.9s0.1,0.6,0.2,0.9s0.3,0.5,0.5,0.8l4.3,4.3l4.3-4.3c0.4-0.4,0.6-1,0.6-1.6 s-0.3-1.2-0.7-1.6c-0.4-0.4-1-0.7-1.6-0.7s-1.2,0.2-1.6,0.6l-1,1L305.9,69.8z%22 style=%22fill:%23313949%3Btransform:translate(-301px,-69px)%3B%22/%3E%3C/svg%3E",ulRightArrow:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %225px%22 height = %228px%22%3E%3Cpath d = %22M24.1,99l3.8-4l-3.8-4L23,92.2l2.7,2.8L23,97.8L24.1,99z%22 style=%22fill:%23313949%3Btransform:translate(-23px,-91px)%3B%22/%3E%3C/svg%3E",ulBallThreeDots:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2210px%22 height = %2211px%22%3E%3Cpath d = %22M359.9,47.7c-2.8,0-5,2.2-5,5s2.2,5,5,5s5-2.2,5-5S362.7,47.7,359.9,47.7z M357.2,52.7c-0.1,0-0.2,0-0.3-0.1 c-0.1,0-0.2-0.1-0.2-0.2c-0.1-0.1-0.1-0.2-0.2-0.2c0-0.1-0.1-0.2-0.1-0.3s0-0.2,0.1-0.3c0-0.1,0.1-0.2,0.2-0.2 c0.1-0.1,0.2-0.1,0.2-0.2c0.1,0,0.2-0.1,0.3-0.1c0.2,0,0.4,0.1,0.5,0.2c0.1,0.1,0.2,0.3,0.2,0.5s-0.1,0.4-0.2,0.5 C357.6,52.7,357.4,52.7,357.2,52.7z M358.4,50c0-0.2,0.1-0.4,0.2-0.5s0.3-0.2,0.5-0.2s0.4,0.1,0.5,0.2s0.2,0.3,0.2,0.5 s-0.1,0.4-0.2,0.5s-0.3,0.2-0.5,0.2s-0.4-0.1-0.5-0.2C358.5,50.4,358.4,50.2,358.4,50z M359.7,53.2c-0.1,0-0.2,0-0.3-0.1 c-0.1,0-0.2-0.1-0.2-0.2c-0.1-0.1-0.2-0.3-0.2-0.5c0-0.1,0-0.2,0.1-0.3c0-0.1,0.1-0.2,0.2-0.2c0.1-0.1,0.3-0.2,0.5-0.2 s0.4,0.1,0.5,0.2c0.1,0.1,0.2,0.3,0.2,0.5s-0.1,0.4-0.2,0.5C360.1,53.2,359.9,53.2,359.7,53.2z%22 style=%22fill:%23313949%3Btransform:translate(-355px,-47px)%3B%22/%3E%3C/svg%3E",ulPlus:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2210px%22 height = %2210px%22%3E%3Cpath d = %22M406.3,71.4v-3.9h1.3v3.9h3.9v1.3h-3.9v3.9h-1.3v-3.9h-3.9v-1.3H406.3z%22 style=%22fill-rule:evenodd%3Bclip-rule:evenodd%3Bfill:%23313949%3Btransform:translate(-402px,-67px)%3B%22/%3E%3C/svg%3E",ulRightPointer:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %229px%22 height = %229px%22%3E%3Cpath d = %22M14.6,95c0,0.1,0,0.1-0.1,0.2c0,0.1-0.1,0.1-0.2,0.1l-7,3.2c-0.1,0-0.1,0-0.2,0S7,98.4,6.9,98.4 c0,0-0.1-0.1-0.1-0.2s0-0.1,0-0.2l1.4-3.3l-1.3-3.4c0-0.1,0-0.1,0-0.2s0-0.1,0.1-0.2c0,0,0.1-0.1,0.2-0.1s0.1,0,0.2,0l6.9,3.7 c0.1,0,0.1,0.1,0.2,0.1S14.6,94.9,14.6,95z%22 style=%22fill:%23313949%3Btransform:translate(-6px,-90px)%3B%22/%3E%3C/svg%3E",ulCrossPlus:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2211px%22 height = %2211px%22%3E%3Cpath d = %22M328.9,75.4h-1.6c-0.1,0-0.2,0-0.3-0.1c-0.1-0.1-0.2-0.1-0.3-0.2l-1.2-1.2c-0.1-0.1-0.2-0.2-0.2-0.3 s0.1-0.2,0.2-0.3l1.2-1.2c0-0.1,0.1-0.1,0.3-0.2c0.1-0.1,0.3-0.1,0.3-0.1h1.6c0.2,0,0.3,0.1,0.4,0.2s0.2,0.3,0.2,0.4v2.5 c0,0.2-0.1,0.3-0.2,0.4C329.3,75.4,329.1,75.4,328.9,75.4z M326.1,71.4l-1.2,1.2c-0.1,0.1-0.2,0.2-0.3,0.2c-0.1,0-0.2-0.1-0.3-0.2 l-1.2-1.2c-0.1-0.1-0.1-0.2-0.2-0.3c-0.1-0.1-0.1-0.2-0.1-0.3v-1.6c0-0.2,0.1-0.3,0.2-0.4s0.3-0.2,0.4-0.2h2.5 c0.2,0,0.3,0.1,0.4,0.2s0.2,0.3,0.2,0.4v1.6c0,0.1,0,0.2-0.1,0.3C326.3,71.2,326.2,71.3,326.1,71.4z M323.6,73.9l-1.2,1.2 c-0.1,0.1-0.2,0.1-0.3,0.2c-0.1,0.1-0.2,0.1-0.3,0.1h-1.6c-0.2,0-0.3-0.1-0.4-0.2s-0.2-0.3-0.2-0.4v-2.5c0-0.2,0.1-0.3,0.2-0.4 s0.3-0.2,0.4-0.2h1.6c0.1,0,0.2,0,0.3,0.1c0.1,0.1,0.2,0.1,0.3,0.2l1.2,1.2c0.1,0.1,0.2,0.2,0.2,0.3S323.7,73.7,323.6,73.9z M324.2,74.5c0.1-0.1,0.2-0.2,0.3-0.2c0.1,0,0.2,0.1,0.3,0.2l1.2,1.2c0.1,0,0.1,0.1,0.2,0.3s0.1,0.3,0.1,0.3v1.6 c0,0.2-0.1,0.3-0.2,0.4s-0.3,0.2-0.4,0.2h-2.5c-0.2,0-0.3-0.1-0.4-0.2s-0.2-0.3-0.2-0.4v-1.6c0-0.1,0-0.2,0.1-0.3 c0.1-0.1,0.1-0.2,0.2-0.3L324.2,74.5z%22 style=%22fill:%23313949%3Btransform:translate(-319px,-68px)%3B%22/%3E%3C/svg%3E",ulFolder:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2211px%22 height = %229px%22%3E%3Cpath d = %22M254.3,71.9h-4.8l-0.9-0.9c0,0-0.1-0.1-0.2-0.1c-0.1,0-0.1,0-0.2,0h-2c-0.6,0-1,0.4-1,1v7c0,0.6,0.4,1,1,1h8 c0.6,0,1-0.4,1-1v-6C255.3,72.3,254.9,71.9,254.3,71.9z%22 style=%22fill:%23313949%3Btransform:translate(-245px,-71px)%3B%22/%3E%3C/svg%3E",ulClock:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2212px%22 height = %2213px%22%3E%3Cpath d = %22M392.9,46.6c-3.3,0-6,2.7-6,6s2.7,6,6,6s6-2.7,6-6S396.2,46.6,392.9,46.6z M395.2,54.4l-0.4,0.5l0,0l0,0l0,0 l0,0l-2.2-1.6l0,0l0,0v-3.7c0-0.1,0-0.1,0.1-0.1h0.6c0.1,0,0.1,0,0.1,0.1v3.3l1.9,1.4C395.3,54.3,395.3,54.4,395.2,54.4z%22 style=%22fill:%23313949%3Btransform:translate(-387px,-46px)%3B%22/%3E%3C/svg%3E",ulSideCube:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2210px%22 height = %2212px%22%3E%3Cpath d = %22M377.7,57.7c0,0.1,0,0.2,0.1,0.3s0.1,0.2,0.2,0.3s0.2,0.1,0.3,0.1c0.1,0,0.2,0,0.4-0.1l2.9-1.4 c0.1-0.1,0.2-0.2,0.3-0.3c0.1-0.1,0.1-0.2,0.1-0.4v-4.1c0-0.1,0-0.2-0.1-0.3s-0.1-0.2-0.2-0.3s-0.2-0.1-0.3-0.1 c-0.1,0-0.2,0-0.4,0.1l-2.9,1.4c-0.1,0.1-0.2,0.2-0.3,0.3c-0.1,0.1-0.1,0.2-0.1,0.4V57.7z%22 style=%22fill:%23313949%3Btransform:translate(-372px,-47px)%3B%22/%3E%3Cpath d = %22M380.7,50.1c0.1-0.1,0.2-0.2,0.3-0.3c0.1-0.1,0.1-0.2,0.1-0.4c0-0.1,0-0.3-0.1-0.4c-0.1-0.1-0.2-0.2-0.3-0.3 l-3.4-1.7c-0.1,0-0.2-0.1-0.3-0.1c-0.1,0-0.2,0-0.3,0.1l-3.4,1.7c-0.1,0.1-0.2,0.2-0.3,0.3c-0.1,0.1-0.1,0.2-0.1,0.4 c0,0.1,0,0.3,0.1,0.4c0.1,0.1,0.2,0.2,0.3,0.3l3.4,1.7c0.1,0,0.2,0.1,0.3,0.1c0.1,0,0.2,0,0.3-0.1L380.7,50.1z%22 style=%22fill:%23313949%3Btransform:translate(-372px,-47px)%3B%22/%3E%3Cpath d = %22M373,51.6c-0.1-0.1-0.2-0.1-0.4-0.1c-0.1,0-0.2,0-0.3,0.1c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.1-0.1,0.2-0.1,0.3 v4.1c0,0.1,0,0.3,0.1,0.4c0.1,0.1,0.2,0.2,0.3,0.3l2.9,1.4c0.1,0.1,0.2,0.1,0.4,0.1c0.1,0,0.2,0,0.3-0.1c0.1-0.1,0.2-0.2,0.2-0.3 c0.1-0.1,0.1-0.2,0.1-0.3v-4.1c0-0.1,0-0.3-0.1-0.4c-0.1-0.1-0.2-0.2-0.3-0.3L373,51.6z%22 style=%22fill:%23313949%3Btransform:translate(-372px,-47px)%3B%22/%3E%3C/svg%3E",ulSmiley:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2215px%22 height = %2214px%22%3E%3Cpath d = %22M42.2,90c3.9,0,7,3.1,7,7s-3.1,7-7,7s-7-3.1-7-7S38.3,90,42.2,90z M39.9,94.7c-0.5,0-0.9,0.4-0.9,0.9 s0.4,0.9,0.9,0.9s0.9-0.4,0.9-0.9C40.8,95.1,40.4,94.7,39.9,94.7z M44.4,94.7c-0.5,0-0.9,0.4-0.9,0.9s0.4,0.9,0.9,0.9 s0.9-0.4,0.9-0.9C45.3,95.1,44.9,94.7,44.4,94.7z M38.9,99.5c0.8,1,2,1.5,3.2,1.5s2.4-0.6,3.2-1.5c0.4-0.5-0.3-1-0.7-0.6 c-0.6,0.8-1.6,1.2-2.5,1.2s-1.9-0.4-2.5-1.2C39.2,98.5,38.5,99.1,38.9,99.5z%22 style=%22fill:%23313949%3Btransform:translate(-35px,-90px)%3B%22/%3E%3C/svg%3E",ulGlobe:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %2214px%22 height = %2214px%22%3E%3Cpath d = %22M270.1,81.2c3.3,0,6-2.7,6-6s-2.7-6-6-6s-6,2.7-6,6S266.7,81.2,270.1,81.2z%22 style=%22fill:none%3Bstroke:%23313949%3Bstroke-width:1.5%3Bstroke-linecap:round%3Bstroke-linejoin:round%3Btransform:translate(-263px,-68px)%3B%22/%3E%3Cpath d = %22M267.7,75.2c0,3.3,1.1,6,2.4,6s2.4-2.7,2.4-6s-1.1-6-2.4-6S267.7,71.9,267.7,75.2z%22 style=%22fill:none%3Bstroke:%23313949%3Bstroke-width:1.5%3Bstroke-linecap:round%3Bstroke-linejoin:round%3Btransform:translate(-263px,-68px)%3B%22/%3E%3Cpath d = %22M264.1,75.2h12%22 style=%22fill:none%3Bstroke:%23313949%3Bstroke-width:1.5%3Bstroke-linecap:round%3Bstroke-linejoin:round%3Btransform:translate(-263px,-68px)%3B%22/%3E%3C/svg%3E",ulDocument:"data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width = %229px%22 height = %2210px%22%3E%3Cpath d = %22M352.6,70.4c-0.1,0.1-0.1,0.2-0.1,0.3v6.9c0,0.2,0.2,0.4,0.4,0.4h7.3c0.2,0,0.4-0.2,0.4-0.4v-9.3 c0-0.2-0.2-0.4-0.4-0.4h-4.8c-0.1,0-0.2,0-0.3,0.1L352.6,70.4z M353.4,70.8l2.1-2.1v2.1H353.4z%22 style=%22fill:%23313949%3Btransform:translate(-352px,-68px)%3B%22/%3E%3C/svg%3E"}}.on("init"),tabpress:function(t,e,i){var a=this.data,o=a.ltPropListLevel,n=this,r=a.tabClass,s=function(t,e,i){var a=e.attr;e.details.tab;if(i){var o=$L(i).data("data");if(!o)return;var n=o.details.tab,r=o.attr;if(n)return r.tabLevel+1==a.tabLevel?i:s(t,e,i.previousElementSibling)}};a.selectedParagraph=t,this.toggleParaClass("random_class",void 0,function(t,i){var l,d=$L(t),c=d.data("data"),p=c.details,h=e?s(t,c,t.previousElementSibling):void 0,u=h?$L(h).data("data"):void 0,m=a["OL"==(u?u.details:p).tab.type?"ltPropOrderedList":"ltPropUnOrderedList"],f=c.attr,g=c.style,y=t.style,v="tabLevel",b="tabIndexValue",x=f[v],_=n.findIndex(n.getFirstWordInPara(t)),P="--tablevel",L="arr:"+_.paraIndex,w=c.classList,I=function(t,e){n.pushToQueue({operation:"styleSet",oldValue:t,newValue:e,prop:P,id:_.id,index:_,paragraph:!0});var i=n.dasherize(P);e?(g[P]=e,y.setProperty(i,e)):(delete g[P],y.removeProperty(i))},E=function(t,e){n.pushToQueue({operation:"properties",prop:L+".details."+t,id:_.id,oldValue:p[t],newValue:e}),e?p[t]=e:delete p[t]},C=function(t,e){n.pushToQueue({operation:"attribute",prop:L+".attr."+t,id:_.id,oldValue:f[t],newValue:e}),e?(f[t]=e,d.attr(t,e)):(delete f[t],d.removeAttr(t))},T=(u?u.attr:f)[b],N=T;if(e){if(u&&N++,0==--x)return w.splice(n.getIndex(w,r),1),d.removeClass(r),n.pushToQueue({operation:"class",prop:"removeClass",id:_.id,value:r,element:L}),[v,"ulvalue","tabValue",b].forEach((function(t){C(t)})),I(g[P]),E("tab"),n.tabCheck(t.parentNode),!1;--N<=0&&(N+=m.length)}else x=Math.min(x+1,o),N=(T||1)%m.length+1;l=n.extend(m[N-1]);var S=n.getBulltet(l);function k(e){C(b,N),l.order=n.getTabIndex(d,x),E("tab",l),e&&(S=n.getBulltet(l)),C("tabValue",S),I(g[P],x),C(v,x),n.tabCheck(t.parentNode)}return(parseInt(t.getAttribute("tablevel"))!=o||x<o)&&("custom"==l.name?(d.attr("tabValue",S),n.background_process(t,k,N-1,m,l)):k(!0)),!1}.bind(this))},tabCheck:function(t){for(var e=$L(t).data("list").slice(),i=[],a=0;a<e.length;a++){var o=e[a],n=$L(o).data("data"),r=0,s=n.attr,l=n.details,d=l.tab;if(d&&!i[a]){1!=l.order&&this.updateTabLevel(o,1);for(var c=a+1;c<e.length;c++){var p=e[c],h=$L(p).data("data"),u=h.attr,m=h.details.tab;if(!m)break;if(s.tabLevel!=u.tabLevel){if(s.tabLevel<u.tabLevel)continue;break}if(s.tabIndexValue!=u.tabIndexValue||d.type!=m.type)break;r++,this.updateTabLevel(p,d.order+r),i[c]=!0}}}},format_into_single_para:function(t){for(var e=t[0].data;t.length>1;){var i=t[1].data,a=i[0];a||i.push(a=this.emptyWordData()),a.text="\n"+a.text,e.push.apply(e,i),t.splice(1,1)}},check_list_style:function(t,e){var i,a=t.style.listStyleType||t.style.listStyle||t.getAttribute("list-style-type");return e.every((function(t){return a==t.conversionName&&(i=!0),!i})),i},formatUl:function(t,e){e=e||{level:1};var i,a,o=this.toArray(t.children),n=[],r=0,s=this.data,l=s.ltPropOrderedList,d=s.ltPropUnOrderedList,c=t.style.listStyleType||t.getAttribute("list-style-type"),p=e.level,h=this.check_list_style(t,l),u=this.check_list_style(t,d),m=s.ltPropParaStyle,f=this,g="inside"==t.style.listStylePosition,y=(m=s.ltPropParaStyle,g?function(t){var e=t.style||{};e.display=m.display||"",e.whiteSpace=""}.bind(this):void 0);if(h?i=l:u?i=d:c?(i=l,h=!0,c="decimal"):(/ul/i.test(t.tagName)?(i=d,u=!0,c="disc"):(i=l,u=!1,c="decimal"),h=!u),a=this.indexOf(i,c,p),e.tagName=u?"UL":"OL","UL"==t.tagName||"OL"==t.tagName){["margin-left","margin-right","margin-top","margin-bottom","margin","margin-inline"].forEach((function(e){"initial"==t.style[e]&&(t.style[e]="")}))}let v={},b=0;o.forEach((function(t,e){if(-1==["LI","OL","UL","BR"].indexOf(t.tagName)){let i=f.copyStylesToLi(t);v[e]=i}}));for(let t in v)o.splice(t+b,1,...v[t]),b=v[t].length;return o.forEach(function(o){var l;if(-1!=this.getIndex(["ul","ol"],this.getTagName(o)))l=this.formatHtml(this.toArray([o]),{level:e.level+1});else if("br"===this.getTagName(o))l=this.formatHtml(this.toArray([o]),{level:e.level+1});else{var d=this.toArray(o.childNodes);d.forEach(this.merge_style.bind(this,o)),y&&d.forEach(y),l=this.formatHtml(d,{level:e.level+1}),this.format_into_single_para(l),l.forEach(function(n){if(this.isImage(n)||this.isTable(n)||this.isHr(n)||n.details.tab)r=0;else{var l=e.level,d=this.extend(i[(a-1)%i.length]),p=n.attr,h=n.style,u=t.style,m=["padding-inline-start","list-style-type","list-style-position","list-style-image"];a>=0&&c&&(delete h.listStyleImage,delete h.whiteSpace),s.ltPropCustomListColor&&o.style.color&&(h["--lyte-texteditor-li-color"]=o.style.color),u.fontWeight&&this.checkReplaceStyle("fontWeight",u.fontWeight,h),u.fontStyle&&this.checkReplaceStyle("fontStyle",u.fontStyle,h),delete h.paddingInlineStart,(n.data||[]).forEach((function(t){let e=t.style;for(let r=0;r<u.length;r++){var i=u[r];if("text-decoration-line"===i)e.textDecoration=u.textDecoration;else{if(-1!=m.indexOf(i))continue;var a=f.camelCase(i),o=u[a],n=f.classFrmStyle(i+":"+o);n?f.pushIfNot(t.classList,n):f.checkReplaceStyle(a,o,e)}}})),p.tabLevel=l,h["--tablevel"]=l,p.tabIndexValue=a,n.details.tab=d,d.order=++r,p.tabValue=this.getBulltet(d),this.pushIfNot(n.classList,s.tabClass)}}.bind(this))}l.forEach(function(t){var e=t.style,i=o.style,a=i.length;e||(t.style=e={}),"LI"==o.tagName&&(t.data||[]).forEach((function(t){for(var o=0;o<a;o++){var n=f.camelCase(i[o]),r=f.data.ltPropReplaceStyle[n];r&&(n=r.name);var s=e[n];/padding(inline|left|right)|listStyle|whitespace|\-\-/i.test(n)||("textDecorationLine"==n?t.style.textDecoration=i[n]:s||(t.style[n]=i[n]))}}));for(var n=0;n<a;n++){var r,s=this.camelCase(i[n]),l=f.data.ltPropReplaceStyle[s],d=i[s];l&&(r=s,s=l.name,l.value==d?i[s]=l.replaceValue:i[s]=l.fallBackValue,delete i[r]),/padding(inline|left|right)|listStyle|whitespace|\-\-/i.test(s)||i[s]&&(e[s]=i[s])}}.bind(this)),Lyte.arrayUtils(n,"push",l)}.bind(this)),n},is_same_tab:function(t,e){var i=t.attr.tabLevel==e.attr.tabLevel;return i&&["type","name","lower"].every((function(a){return i=i&&t.details.tab[a]==e.details.tab[a]})),i},pushForIndent:function(t,e,i){for(;;){var a=t.get(0),o=t.next(),n=this.getIndex(e,a);if(-1!=n&&e.splice(n,1),this.pushIfNot(i,a),!o.hasClass("lyteEditorTab")||!this.is_same_tab(t.data("data"),o.data("data")))break;t=o}},tab_check_for_indent:function(t,e,i){var a=t.prev(),o=t.data("data");if(-1==this.getIndex(e,t.get(0)))if(a.hasClass("lyteEditorTab")){var n=a.data("data");this.is_same_tab(o,n)?this.pushIfNot(e,t.get(0)):this.pushForIndent(t,i,e)}else this.pushForIndent(t,e,i)},doTablevelUpdate:function(t,e){var i=this.get_element_from_opr(t.operations),a=this.get_name(e),o=this.do_parse(t.value);this.updateTabLevel(i,o[a])},updateTabLevel:function(t,e){var i=$L(t),a=i.data("data"),o=a.details.tab,n=o.order,r=a.attr;if(o.order=e,n!=e&&(r.tabValue=this.getBulltet(o),i.attr("tabvalue",r.tabValue),!this.isUndo())){var s=i.closest(".listHolderElement"),l=this.getIndex(s.data("list"),t);this.pushToQueue({operation:"tablevelUpdate",index:l,oldValue:n,newValue:e,id:s.data("randomId")})}},getTabIndex:function(t,e,i){var a=$L(t).closest(".listHolderElement").data("list"),o=this.getIndex(a,t),n=1,r=$L(a[o-1]).data("data"),s=$L(a[o+1]).data("data");return!r||r.attr.tabLevel!=e||i&&r.attr.tabIndexValue!=i?s&&s.attr.tabLevel==e&&(n=s.details.tab.order):n=r.details.tab.order+1,n},ordered:function(t){return this.list("number"==typeof t?t:void 0,this.data.ltPropOrderedList)},background_process:function(t,e,i,a,o){var n=this.data.listMapping[o.conversionName];if(n){var r='url("'+n+'")';a[i].customValue=o.customValue=r,e&&e()}else this.__background_process.apply(this,arguments)},__background_process:function(t,e,i,a,o){var n=this;window.requestAnimationFrame((function(){var r=window.getComputedStyle(t,":before"),s=r.backgroundImage,l=n.data.imageMapping,d=n.retrive_url(s);if(d){var c=l[d],p=function(){c.addEventListener("load",h)},h=function(){var t=a[i],s=t.customValue;if(s)o.customValue=s;else{var l=t.customValue||n.copy_image(c,r.backgroundPosition,parseFloat(r.width),parseFloat(r.height));t.customValue=o.customValue="url("+l+")"}e(),n.update_panel(),n.checkPlaceholder()};if(c)return c.complete?h():p();(c=l[d]=new Image).src=d,p()}else e()}))},copy_image:_lyteUiEditor.copy_image,retrive_url:function(t){var e=/url\(\"(.+)\"\)/;return e.test(t)?e.exec(t)[1]:""},tab_common_fn:function(t,e,i,a){var o,n=this,r=$L(i),s=r.data("data"),l=s.details,d=s.attr,c=s.classList,p=n.findIndex(n.getFirstWordInPara(i)),h=s.style,u=i.style,m="--tablevel",f="--lyte-texteditor-li-color",g="arr:"+p.paraIndex,y=function(t){n.pushToQueue({operation:"class",prop:"removeClass",id:p.id,value:t,element:"arr:"+p.paraIndex})},v=function(t,e){n.pushToQueue({operation:"styleSet",oldValue:t,newValue:e,prop:m,id:p.id,index:p,paragraph:!0});var i=n.dasherize(m);e?(h[m]=e,u.setProperty(i,e)):(delete h[m],u.removeProperty(i))},b=function(t,e,i){n.pushToQueue({operation:"properties",prop:g+".details."+t,id:p.id,oldValue:e,newValue:i}),i?l[t]=i:delete l[t]},x=function(t,e,i){n.pushToQueue({operation:"attribute",prop:g+".attr."+t,id:p.id,oldValue:e,newValue:i}),i?(d[t]=i,r.attr(t,i)):(delete d[t],r.removeAttr(t))};if(!a){var _=l.tab;if(!(t&&t[0].type!=_.type||null!=e&&e!=d.tabIndexValue)){if(["tabValue","ulvalue","tabIndexValue","tabLevel"].forEach((function(t){x(t,d[t],void 0)})),b("tab",l.tab),v(h[m],void 0),h[m="--lyte-texteditor-li-color"]&&v(h[m],void 0),m="--tablevel",null==t){var P=n.data.tabClass;y(P),r.removeClass(P),c.splice(n.getIndex(c,P),1)}return}e=e||d.tabIndexValue,o=!1}t=t||n.data.ltPropUnOrderedList;var L=((e||1)-1)%t.length,w=n.extend(t[L]),I="tabLevel",E="tabIndexValue",C="tabValue";w.order=n.getTabIndex(i,1);var T=n.getBulltet(w),N="lyteEditorBlockquote";function S(){if(x(I,d.tabLevel,d.tabLevel||1),x(E,d.tabIndexValue,((e||1)-1)%t.length+1),b("tab",l.tab,w),v(h[m],d.tabLevel),m=f,n.data.ltPropCustomListColor&&(i.style.color?v(h[m],i.style.color):(v(h[m="color"],n.data.ltPropWordStyle.color),v(h[m=f],n.data.ltPropWordStyle.color))),x(C,d.tabValue,T),n.data.ltPropHeaderTags.concat(n.extend(n.data.ltPropBlockquoteClasses,[N,"lyteBlockquoteFirst","lyteBlockquoteLast"])).forEach((function(t){var e=n.getIndex(c,t);-1!=e&&(c.splice(e,1),y(t),r.removeClass(t),n.removeHeaderContents(r,t),t==N&&n.blockquote_check(i.parentNode))})),0==o)return n.tabCheck(i.parentNode),o}return"custom"==w.name?(r.attr(C,T),w.customValue?S():(n.background_process(i,S,L,t,w),o)):S()},pushSameLevelList:function(t,e){var i,a,o=$L(t),n=o.data("data"),r=o.closest(".listHolderElement").data("list"),s=e.length;r.every(function(o){var r=$L(o).data("data");if(a=a||o==t,r.details.tab)i=!0,this.is_same_tab(n,r)&&this.pushIfNot(e,o);else if(i){if(a)return!1;i=!1,e.splice(s)}return!0}.bind(this))},updateNodeForList:function(t){},removeList:function(){if(!this.isUpdateIcon()){var t,e=this,i=e.data.selectedParagraph,a=e.data.tabClass,o=[];i.forEach((function(i){$L(i).hasClass(a)&&(t=!0,e.tab_common_fn(void 0,void 0,i,!1),e.pushIfNot(o,i.parentNode))})),o.forEach(e.tabCheck.bind(e)),t&&e.common_positioning(),e.updateNodeForList(),this.update_panel(),this.checkPlaceholder(),this.callFind()}},_list:function(t,e,i){var a,o=this.data,n=o.selectedParagraph;if(1==n.length){var r=$L(n[0]).data("data").details.tab;r&&r.type!=t[0].type&&(a=!0)}if(this.isUpdateIcon()){var s=this.toggleParaClass(o.tabClass),l=s.toApply;return{applied:this.reduceCrctList(t,s.applied,l,e),toApply:l}}a&&this.updateNodeForList(i);var d=o.tabClass;this.toggleParaClass(d,void 0,this.tab_common_fn.bind(this,t,e)),delete this._fakeSelectedPara,this.callFind()},list:function(t,e,i){return this._list(e&&e.constructor==Array?e:this.data.ltPropUnOrderedList,"number"==typeof t?t:void 0,i)},reduceCrctList:function(t,e,i,a){var o=t[0].type;return e.filter(function(t){var e=$L(t).data("data"),n=e.details.tab;if(n&&n.type==o&&(null==a||e.attr.tabIndexValue==a))return!0;i.push(t)}.bind(this))},removeTabProp:function(t,e,i,a){t.tab&&(delete t.tab,delete i.tabLevel,delete i.tabValue,delete e["--tablevel"],Lyte.arrayUtils(a,"removeAt",this.getIndex(a,this.data.tabClass)))},setup_custom_tab:function(t){var e=t.data("data"),i=e.details.tab;if("custom"==i.name){var a=t.get(0),o=this.data["ltProp"+("UL"==i.type?"Un":"")+"OrderedList"],n=e.attr.tabIndexValue-1;this.background_process(a,void 0,n,o,i)}}}),Lyte.Mixin.register("lyte-editor-mention",{callTrigger:function(t,e,i){var a="onTrigger";if(e){if(this.getMethods(a)){var o=this.data,n=this.executeMethod(a,t,this.$node,i),r=function(t){if(0!=n){var i="triggersArray";this.setData(i+"Final",t||[]),this.setData(i,o.triggersArrayFinal.slice(0,20)),this.showdropdown(e,this.$node)}else this.closedropdown()}.bind(this);o.searchValue=t,n&&n.then?n.then((function(t){r(t)}),this.closedropdown.bind(this)):r(n)}}else this.closedropdown()},closedropdown:function(t){if(!this._click)return;let e=t?$L(t.target).closest("lyte-editor-mention-item"):null;if(!e||!e.hasClass("lyteMentionsSubMenuContainer")){var i=this._mentiondrop,a="removeEventListener";document[a]("click",this._click,!0),window[a]("scroll",this._scroll,!0),delete this._click,delete this._scroll,i&&($L(i).addClass("lyteEditorHide").css({left:"",top:"",right:"",bottom:""}),$L(this.$node).removeClass("lyteEditorMentionOpen"),delete this._mentionopen,this.throwEvent("onMentionClose",i,this.$node)),this._mentionsSubMenuDrop&&this._mentionsSubMenuDrop.component.setData("ltPropShow",!1)}},scrollclose:function(t){this._mentiondrop.contains(t.target)||this.closedropdown()},showdropdown:function(t,e){var i=this._mentiondrop,a=$L(i).removeClass("lyteEditorHide"),o=window;$L.fastdom.measure((function(){var n=this.getBcr(i),r=this.getBcr(e),s=o.pageXOffset,l=o.pageYOffset,d=t.left+r.left,c=t.top+t.height+r.top,p=(o.innerWidth,o.innerHeigt),h={left:d+s,top:c+l,bottom:""};c+n.height>p&&(c-t.height>p-c?h.bottom=c-t.height+l:h.top=l+c),$L.fastdom.mutate((function(){if(a.css(h).data("editor",e),!this._click){this._click=this.closedropdown.bind(this),this._scroll=this.scrollclose.bind(this);var t="lyteEditorMentionSelection",i="addEventListener";document[i]("click",this._click,!0),o[i]("scroll",this._scroll,!0),$L(this.$node).addClass("lyteEditorMentionOpen"),this._mentionopen=!0,this.throwEvent("onMentionOpen",this._mentiondrop,this.$node),0==a.children("."+t).length&&a.children().eq(0).addClass(t)}}),this)}),this)},checkTrigger:function(){var t=this.data,e=t.ltPropTriggerCharacter,i=this.__evt,a="__final_evt";e&&(this[a]=this[a]||i,clearTimeout(this.__triggerdelay),this.__triggerdelay=setTimeout(function(){var i=t.currentNode,o=t.cursor,n=this.getWordText(i).slice(0,o),r=n.lastIndexOf(e),s=[];-1!=r&&s.push(n.slice(r+1),this.findCursorPos(i,r)),s.push(this[a]||{}),this.callTrigger.apply(this,s),delete this[a]}.bind(this),t.ltPropTriggerDelay))},mentionsClick:function(t,e,i){var a=this.data,o=t.module;this.data.ltPropMentionsSubMenu&&t.group?this.setData("mentionsGroup",t.group):(this.removeLetters(a.searchValue.length+1),this.$node.insertHTML("@["+_lyteUiEditor.escapeText(t.name)+":"+t.id+(o?":"+o:"")+"]<span> </span>",!0),this.throwEvent("onMentionSelect",t,e,i,this.$node),this.setCursor(a.currentNode,a.cursor),this.$node.focus())},mentionsKeydown:function(t){var e=t.which||t.keyCode,i="lyteEditorMentionSelection",a=this._mentiondrop,o=$L("."+i,a);if(o.length||(o=$L(a.children[0]).addClass(i)),/^(38|40)$/.test(e)){var n=o[38==e?"prev":"next"]();n.length&&(n.addClass(i),o.removeClass(i),n.get(0).scrollIntoView())}else 13==e&&o.click();if(/^(38|40|13)$/.test(e))return t.preventDefault(),!0},mention_scroll:function(){var t=this._mentiondrop,e=t.scrollTop,i=t.offsetHeight,a=t.scrollHeight,o=this.data,n=o.triggersArray,r=o.triggersArrayFinal;if(a==i+e){var s=n.length;if(r.length==n.length)return;Lyte.arrayUtils(n,"push",r.slice(s,s+20))}},getMentions:function(){return Array.from(this.$node.getElementsByClassName("lyteEditorMentionWord")).map((function(t){var e=$L(t).data("data"),i=e.details;return{id:i.id,text:e.text,module:i.module}}))},setup_mention:function(){this._mentiondrop=$L(this.$node).children(".lyteEditorMentionDropbox").get(0),Lyte.Component.appendChild(document.body,this._mentiondrop),this.data.ltPropMentionsSubMenu&&(this._mentionsSubMenuDrop=$L(this.$node).children(".lyteEditorMentionsSubMenu").get(0))},mention_clear:function(){var t="_mentiondrop",e=this[t];e&&(e.remove(),delete this[t],this.closedropdown()),clearTimeout(this.__triggerdelay)}.on("didDestroy"),actions:{itemClick:function(t,e,i){this.mentionsClick(t,e,i)},mouseenter:function(t,e){var i="lyteEditorMentionSelection";$L("."+i,this._mentiondrop).removeClass(i),this.data.ltPropMentionsSubMenu&&$L("."+i,this._mentionsSubMenuDrop.component.childComp).removeClass(i),$L(e).addClass(i)},scroll:function(){this.mention_scroll()}},mention_update:function(t,e,i,a,o){if("mention"==(t.details||{}).type){e.removeClass("lyteEditorMentionWord");var n=this.getMentionData(t,i);this.removeMention(t),this.pushToQueue({operation:"mention",oldValue:n,id:a,index:o.paraIndex,wordIndex:o.wordIndex})}},getMentionData:function(t,e){return{name:e,id:t.details.id,module:t.details.module}},removeMention:function(t){var e=t.classList,i=this.getIndex(e,"lyteEditorMentionWord");-1!=i&&(e.splice(i,1),t.details={})},doAddMention:function(t){var e=this.get_element_from_opr(t.operations),i=this.do_parse(t.value),a=$L(e).addClass("lyteEditorMentionWord").data("data");this.pushIfNot(a.classList,"lyteEditorMentionWord"),a.details={type:"mention",id:i.id,module:i.module||""}},doRemoveMention:function(t){var e=this.get_element_from_opr(t.operations),i=$L(e).removeClass("lyteEditorMentionWord").data("data");this.removeMention(i)},mention_prop:function(t,e){t.classList.push("lyteEditorMentionWord"),this.data.ltPropMentionsBgEditable&&(t.style.backgroundColor=this.data.ltPropMentionsBg),this.data.ltPropMentionsEditable||(t.attr?t.attr.editable="false":t.attr={editable:"false"}),t.details={type:"mention",id:e.id,module:e.getAttribute("module")}},filteroutMention:function(t){return t.replace(/<span([^>]+)>@\[([^<]+?):([^<]+?):(.{0,}?)\]<\/span>/g,(function(t,e,i,a,o){return'<mention_div id = "'+a+'" module="'+o+'"'+e.replace(/id=\w+\s?/,"")+">"+i+"</mention_div>"})).replace(/<span([^>]+)>@\[([^<]+?):([^<]+?)\]<\/span>/g,(function(t,e,i,a){return'<mention_div id = "'+a+'"'+e.replace(/id=\w+\s?/,"")+">"+i+"</mention_div>"})).replace(/@\[(.+?):(.+?):(.{0,}?)\]/g,(function(t,e,i,a){return'<mention_div id = "'+i+'" module = "'+a+'">'+e+"</mention_div>"})).replace(/@\[(.+?):(.+?)\]/g,(function(t,e,i){return'<mention_div id = "'+i+'">'+e+"</mention_div>"}))}}),Lyte.Mixin.register("lyte-editor-table",{doCellInsert:function(t){var e=t.operations,i=e.split("."),a=i.pop(),o=this.get_element_from_opr(i.join(".")),n=this.get_number(a),r=this.get_data_from_opr(e),s=this.do_parse(t.value),l=this.render(s),d=function(t,e){t.splice(n,0,e)},c=$L(o).data("list"),p=c[n],h=Lyte.Component;this.update_count(_lyteUiEditor.limitFilter(l,1/0,!0).length),p?h.insertBefore(p,l):h.appendChild(o,l),d(r.data,s),d(c,l)},doCellDelete:function(t){this.doRowDelete(t)},doSpanSet:function(t,e){var i=t.operations,a=this.get_element_from_opr(i),o=this.get_data_from_opr(i),n=this.get_name(e),r=this.do_parse(t.value)[n];a[o.value]=o.data[o.value]=r},doRowCreate:function(t){var e=t.operations.split("."),i=e.pop(),a=this.get_element_from_opr(e.join(".")),o=this.get_number(i),n=this.createRow($L(a.parentNode),o,this.do_parse(t.value));this.update_count(_lyteUiEditor.limitFilter(n,1/0,!0).length)},table_init:function(){var t=this.data,e=t.tableMenu;e&&t.ltPropTableHandling&&e.push.apply(e,[{options:[{display:"Insert row above",purpose:"insertRowAbove",class:"lyteEditorInsertRowAbove"},{display:"Insert row below",class:"lyteEditorInsertRowBelow",purpose:"insertRowBelow"},{display:"Insert column to left",class:"lyteEditorInsertColumnLeft",purpose:"insertColumnLeft"},{display:"Insert column to right",class:"lyteEditorInsertColumnRight",purpose:"insertColumnRight"}]},{options:[{display:"Delete row",class:"lyteEditorRemoveRow",purpose:"removeRow"},{display:"Delete column",class:"lyteEditorRemoveColumn",purpose:"removeColumn"},{display:"Delete table",class:"lyteEditorDeleteTable",purpose:"deleteTable"}]},{options:[{display:"split cell",class:"lyteEditorSplitCells",purpose:"splitCells"}]},{options:[{display:"Merge cells",class:"lyteEditorMergeCells",purpose:"mergeCells"}]},{options:[{display:"Select Cell",class:"lyteEditorSelectCell",purpose:"selectCell"},{display:"Select table",class:"lyteEditorSelectTable",purpose:"selectTable",arg:"target"}]}])}.on("init"),check_disable:function(t){var e,i,a,o=this.data.tableMenu,n=Lyte.objectUtils,r=this.data.range.isRange,s=t?this.getTagName(t):"",l=this.getTag("th"),d=this.getTag("table"),c=this.data.topLevelElement,p=this.data.selectedWords,h=[],u=function(){var e=t.parentNode,i=!0;return p.every((function(t){var a=t.node;return i=e.contains(a)})),!i}.bind(this),m=function(){var e=function(t){return this.getIndex(Array.from(t.parentNode.children),t)}.bind(this),i=e(t),a=$L(t.closest(d)),o=(Array.from(a.children().children()).map((function(t){return t.children[i]})),!0),n=l+","+this.getTag("td");return p.every((function(t){var a=t.node.closest(n);return o=a&&e(a)==i})),!o}.bind(this);return o.forEach((function(o){var d=0,p=o.options;p.forEach((function(a){var o,p,h;switch(a.purpose){case"insertRowAbove":case"insertRowBelow":case"removeRow":s?(o=l==s,null==e?(!o&&r&&(o=u()),e=o):o=e):o=!1;break;case"insertColumnLeft":case"insertColumnRight":case"removeColumn":o=!(!s||!r)&&(null==i?i=m():i);break;case"splitCells":o=s&&r&&c!=t;break;case"mergeCells":o=s&&(r&&c==t||!r);break;case"deleteTable":case"selectCell":case"selectTable":o=!1}null!=o&&(h=_lyteUiUtils.capitalize(a.purpose),p=o?"lyteEditor"+h+" lyteEditorMenuDisabled":"lyteEditor"+h,t||(p+=" lyteEditorHide",d++),n(a,"add","class",p),n(a,"add","disabled",(o||!1).toString()))})),n(o,"add","class",d==p.length?(h.push(o),"lyteEditorHide"):(a=o,""))})),a&&n(a,"add","class",(a.class+" lyteEditorOptionLast").trim()),h},methods:{beforeTableOpen:function(t,e){var i=this.$node.contains(t);if(i){if(this.call_menu_before_open(e))return!1;var a=e.target.closest(this.getTag("th")+","+this.getTag("td"));(this.__cell=a)&&this.check_range_reset(a),i=this.before_menu_open(t,e,this.check_disable(a))}return i},tableSelect:function(t){var e,i,a=t,o=[],n=this.__cell,r=function(){return n.closest(this.getTag("table"))}.bind(this);switch(t){case"insertRowAbove":a="insertRow",o.push("before"),i=!0;break;case"insertRowBelow":a="insertRow",i=!0;break;case"removeRow":i=!0;break;case"insertColumnLeft":a="insertColumn",o.push("before"),e=!0;break;case"insertColumnRight":a="insertColumn",e=!0;break;case"removeColumn":e=!0;break;case"selectCell":o.push(n);break;case"selectTable":o.push({target:r()});break;case"deleteTable":o.push(r());break;case"mergeCells":a="mergeCells";break;case"splitCells":a="splitCells";break;default:a="table_menu_select",o.push(t)}i&&(e=this.getTag("th")!=this.getTagName(n)),e&&(this.data.topLevelElement=n),this[a].apply(this,o),delete this.__cell,this.$node.focus()}},copyFromTable:function(t,e){for(var i=this.data.ltPropTags,a=($L(t).closest(i.table).get(0),t.parentNode),o=e.parentNode,n=this.toArray($L(o).closest(this.getTag("table")).children().children()),r=this.getIndex(n,a),s=this.getIndex(n,o),l=this.getIndex(this.toArray(a.children),t),d=this.getIndex(this.toArray(o.children),e),c=[],p=Math.min(r,s),h=Math.max(r+t.rowSpan-1,s+e.rowSpan-1),u=Math.min(l,d),m=Math.max(l+t.colSpan-1,d+e.colSpan-1),f=function(t){let e=this.copyInSameWord(t,0);null!=e&&Lyte.arrayUtils(c,"push",e)}.bind(this),g=function(t){$L(t).data("list").forEach(f)},y=p;y<=h;y++)if(!n[y].parentElement.classList.contains("lyteEditorNoHeadTable"))for(var v=u;v<=m;v++){var b=$L(n[y]).data("list")[v];$L(b).data("list").forEach(g)}return c},changeToTopLevelForTable:function(t){for(var e=0;e<t.length;e++)for(var i=t[e],a=e+1;a<t.length;a++){var o=t[a];if(i.contains(o))t.splice(a,1),a--;else if(o.contains(i)){t.splice(e,1),e--;break}}return t},table:function(t,e,i){t=t||i.row||2,e=e||i.column||2,this.splitPara();var a,o=this.data.currentNode,n=this.findIndex(o),r=this.emptyParaData(),s=o.parentNode,l=(i||{}).width||"",d=this.getBcr(s,"width"),c=/%/i.test(l)?parseFloat(l)*d/100:l||d,p=this.emptyTable(t,e,c),h=r.data[0];if(h.data=[p],h.details.type="table",i){var u=p.style,m=i.alignment,f={},g="",y=_lyteUiUtils.getRTL(),v={height:i.height,borderWidth:i.borderWidth+"px"},b=r.style;switch(m){case"left":g=y?"auto 0px":"0px auto",b.float="left";break;case"right":g=y?"0px auto":"auto 0px",b.float="right";break;case"center":g="auto"}f.marginInline=g,this.extend(f,u),p.data.forEach(function(t){t.data.forEach(function(t){t.data.forEach(function(t){this.extend(v,t.style)}.bind(this))}.bind(this))}.bind(this))}this.pushParagraph(a=this.render(r),$L(s).closest(".listHolderElement"),n.paraIndex);var x=this.getFirstWordInPara(a),_=this.getWordText(x).length;this.setData("currentNode",x),this.setCursor(x,_),this.$node.focus(),this.updateRangeNode()},emptyTable:function(t,e,i){var a=this.data;return{data:[this.thead(1,e,i),this.tbody(t,e)],style:this.extend(this.extend(a.ltPropTableStyle),{width:i+"px"}),details:{resize:a.ltPropTableResize,arguments:{boundary:"lyte-texteditor",component:"table",directions:[],preventTable:!0,tags:{table:this.getTag("table"),thead:this.getTag("thead"),tbody:this.getTag("tbody"),tr:this.getTag("tr"),th:this.getTag("th"),td:this.getTag("td")}}},tag:this.getTag("table")}},thead:function(t,e,i){return{data:[this.tr(e,"th",i)],style:{},details:{},tag:this.getTag("thead")}},alignTable:function(t){let e=this.data.currentNode,i=this.findIndex(e),a=$L(this.$node).find("#"+i.id).get(0);if(-1!=["TH","TD"].indexOf(a.tagName)){let e=$L(a).closest("table").get(0),i=$L(e).closest("lyte-paragraph").get(0);if(i.style.float==t)return{applied:[1],toApply:[]};if(this.isUpdateIcon())return;this.setStyle(i,"float",t),this.setStyle(i,"zIndex","10"),this.update_panel()}},tbody:function(t,e,i){for(var a=[],o=0;o<t;o++)a.push(this.tr(e,"td",i));return{data:a,style:{},details:{},tag:this.getTag("tbody")}},tr:function(t,e,i){for(var a=[],o=0;o<t;o++)a.push(this.cell(e,i/t));return{data:a,style:{},details:{},tag:this.getTag("tr")}},cell:function(t,e){return{data:[this.emptyParaData()],style:this.extend(this.extend(this.data.ltPropTdStyle),{width:e?e+"px":""}),details:{rowSpan:1,colSpan:1},tag:this.getTag(t),randomId:this.randomId()}},tableselect:function(t){$L(t).addClass("lyteEditorTableSelected")},tableRelease:function(t,e){$L(e).removeClass("lyteEditorTableSelected");var i=$L(t).data("directions"),a=this.toArray(t.parentNode.children);if(i.width){var o=this.getIndex(a,t);this.toArray($L(e).children().children()).forEach((function(t){var e=$L(t.children[o]);e.attr("style","").css(e.data("data").style)}))}else a.forEach((function(t){(t=$L(t)).attr("style","").css(t.data("data").style)})),(e=$L(e)).attr("style","").css(e.data("data").style)},tabledrop:function(t,e){$L(e).removeClass("lyteEditorTableSelected");var i=$L(t).data("directions"),a=this.data;if(i.width){this.updateRangeNode();var o=t.nextElementSibling;this.setStyle(t,"width",t.style.width),this.setStyle(o,"width",o.style.width)}else this.heightAdjust(t),this.setStyle(e,"height",e.style.height);a.range.isRange?this.setRange():this.setCursor(a.currentNode,a.cursor)},heightAdjust:function(t){var e=this.toArray(t.parentNode.children);this.updateRangeNode(),e.forEach(function(t){this.setStyle(t,"height",t.style.height)}.bind(this))},navigateInTable:function(t,e){var i;(i=e?this.getPrevious(t):this.getNext(t,!0))&&this.navigateTo(i)},navigateTo:function(t){var e=this.data,i=e.range,a=$L(t).data("list"),o=this.getFirstWordInPara(this.first(a)),n=this.getLastWordInPara(this.last(a)),r=this.getWordText(n).length;this.setData("currentNode",n),this.setData("cursor",r),o==n&&0==r?(i.isRange=!1,this.setCursor(e.currentNode,e.cursor),this.resetOverlay(!0)):(i.startNode=o,i.endNode=n,i.left=0,i.right=r,i.isRange=!0,this.setRange())},getPrevious:function(t){var e=t.parentNode,i=this.toArray(e.children),a=$L(t).closest(this.getTag("table")),o=this.getIndex(i,t),n=this.toArray(a.children().children()),r=this.getIndex(n,e),s=i[o-1];if(0==o){if(0==r)return;s=this.last(n[r-1].children)}return"none"==s.style.display?this.getPrevious(s):s},getNext:function(t,e){var i=t.parentNode,a=this.toArray(i.children),o=$L(t).closest(this.getTag("table")),n=this.getIndex(a,t),r=this.toArray(o.children().children()),s=this.getIndex(r,i),l=a[n+1],d=r.length,c=a.length;return n==c-1&&(s==d-1?l=this.createNewrow(o,d-1,c):e&&(l=this.first(r[s+1].children))),"none"==l.style.display?this.getNext(l,e):l},createNewrow:function(t,e,i){var a=this.getBcr(t.closest(this.getTag("paragraph")).get(0),"width"),o=this.getTag("td"),n=this.tr(i,o,a),r=$L($L($L(t.data("data").data).get(-1).data).get(-1).data).get(-1).style.borderWidth;return n.data.forEach(function(t){t.style.borderWidth=r}.bind(this)),this.createRow(t,e,n)},createRow:function(t,e,i){var a=this.render(i),o=t.find(this.getTag("tbody")).eq(0),n=o.data("data").data,r=o.children(),s=r.get(e),l=Lyte.arrayUtils,d=Lyte.Component,c=a.children[0];if(l(o.data("list"),"insertAt",e,a),l(n,"insertAt",e,i),s?d.insertBefore(s,a):d.insertAfter(r.get(-1),a),!this.isUndo()){var p=t.parent(),h=p.closest(this.getTag("paragraph")).parent(),u=this.findIndex(p.get(0));this.updateRangeNode(),this.pushToQueue({operation:"rowCreate",data:i,index:u.paraIndex,lineIndex:u.lineIndex,wordIndex:u.wordIndex,id:h.data("randomId"),rowIndex:e}),this.updateNodeValue(this.getFirstWordInPara(this.first($L(c).data("list"))))}return c},processDeleteRow:function(t,e){var i=t.find(this.getTag("tbody")),a=i.data("data").data,o=this.toArray(t.children().children()),n=o[e+1];if(o[e]&&(this.emptyRow(n),this.update_count(-_lyteUiEditor.limitFilter(n,1/0,!0,!0).length),n.remove(),Lyte.arrayUtils(a,"removeAt",e),Lyte.arrayUtils(i.data("list"),"removeAt",e),!this.isUndo())){var r=t.parent(),s=r.closest(this.getTag("paragraph")).parent(),l=this.findIndex(r.get(0));this.pushToQueue({operation:"rowDelete",data:$L(n).data("data"),index:l.paraIndex,lineIndex:l.lineIndex,wordIndex:l.wordIndex,id:s.data("randomId"),rowIndex:e})}},mergeCells:function(){var t=this.data,e=t.range,i=t.topLevelElement;if(e.isRange&&!i){var a=t.selectedParagraph,o=".listHolderElement",n=$L(this.first(a)).closest(o).get(0),r=$L(this.last(a)).closest(o).get(0);n!=r&&n&&r&&-1==this.getIndex([this.getTagName(n),this.getTagName(r)],this.getTag("th"))&&this.mergeTwoCells(n,r)}},spanSet:function(t,e,i){var a=$L(t),o=a.data("data").details,n=o[e];t[e]=o[e]=i,this.isUndo()||this.pushToQueue({operation:"spanSet",oldValue:n,newValue:i,property:e,id:a.data("randomId")})},mergeTwoCells:function(t,e){var i,a,o=t.parentNode,n=e.parentNode,r=this.getIndex(this.toArray(o.children),t),s=this.getIndex(this.toArray(n.children),e),l=this.toArray($L(n).closest(this.getTag("tbody")).get(0).children),d=this.getIndex(l,o),c=this.getIndex(l,n),p=$L(t).data("data").details,h=function(e){this.pushParagraph(this.render(e),t)}.bind(this);this.updateRangeNode();for(var u=d;u<=c;u++)for(var m=l[u],f=r;f<=s;f++){var g=m.children[f];if(g!=t&&"none"!=g.style.display){var y=$L(g).data("data").data;this.extend(y,[]).forEach(h),this.emptyCell(g),this.setStyle(g,"display","none"),u==d?this.spanSet(t,"colSpan",p.colSpan+g.colSpan):f==r&&this.spanSet(t,"rowSpan",p.rowSpan+g.rowSpan)}}this.resetRange(!0),this.setData("currentNode",i=this.getLastWordInPara(this.last(t.children))),this.setData("cursor",a=this.getWordText(i).length),this.setCursor(i,a),this.updateRangeNode()},emptyRow:function(t){this.toArray(t.children).forEach(function(t){this.emptyCell(t)}.bind(this))},emptyFullTable:function(t){var e=t.children[0];this.emptyBody(e),this.emptyBody(e)},emptyBody:function(t){this.toArray(t.children).forEach(function(t){this.emptyRow(t)}.bind(this))},emptyCell:function(t){for(var e=$L(t).data("list"),i=e.length,a=0;a<i;a++){var o=e[a];1==i&&this.pushParagraph(this.render(this.emptyParaData()),$L(o).closest(".listHolderElement"),0),this.removePara(o),1!=i&&(i--,a--)}},splitCells:function(){var t=this.data,e=t.range,i=t.topLevelElement;i&&!e.isRange&&this.getTagName(i)==this.getTag("td")&&(this.updateRangeNode(),this.processSplit(i))},processSplit:function(t){var e,i,a=t.rowSpan-1,o=t.colSpan-1,n=t.parentNode,r=this.toArray(n.parentNode.children),s=[];if(0==a&&0==o)return this.insertSplit(t),!0;e=this.getIndex($L(n).data("list"),t),i=this.getIndex(r,n);for(var l=0;l<=a;l++)for(var d=r[i+l].children,c=0;c<=o;c++)if(0!=l||0!=c){var p=d[c+e];s.push(p),this.setStyle(p,"display","")}a&&this.spanSet(t,"rowSpan",1),o&&this.spanSet(t,"colSpan",1),this.updateRangeNode();var h=this.last(s),u=this.data,m=u.currentNode;h&&(this.setData("currentNode",m=this.getLastWordInPara(this.last($L(h).data("list")))),this.setData("cursor",this.getWordText(m).length)),this.setCursor(m,u.cursor)},insertSplit:function(t){var e,i,a=t.parentNode,o=this.toArray(a.children),n=this.getIndex(o,t),r=$L(t).closest("table"),s=this.toArray(r.children().children()),l=this.getBcr(s[0].children[n],"width")/2,d=[];s.forEach(function(t,e){var i,o=this.cell(0==e?this.getTag("th"):this.getTag("td"),0==e?l:void 0),r=t.children[n];(t!=a&&0!=e&&(o.style.display="none"),"none"==r.style.display)&&(r=(i=this.originCell(r)).isSame?i.cell:void 0);r&&0!=e&&t!=a&&this.spanSet(r,"colSpan",r.colSpan+1),d.push(o)}.bind(this)),this.setStyle(s[0].children[n],"width",l+"px"),this.insertColumnAt(r,d,n+1),this.resetRange(!0),e=this.getLastWordInPara(this.last($L(this.last(a).children[n+1]).data("list"))),this.setData("currentNode",e),this.setData("cursor",i=this.getWordText(e).length),this.updateRangeNode(),this.$node.focus(),this.setCursor(e,i)},insertColumnAt:function(t,e,i){var a=this.toArray(t.children().children()),o=Lyte.arrayUtils,n=Lyte.Component;if(a.forEach(function(t,a){var r=$L(t),s=r.children().get(i),l=r.data("data"),d=r.data("list"),c=this.render(e[a]);o(l.data,"insertAt",i,e[a]),o(d,"insertAt",i,c),s?n.insertBefore(s,c):n.appendChild(t,c)}.bind(this)),!this.isUndo()){var r=t.closest(this.getTag("word")),s=this.findIndex(r.get(0));this.pushToQueue({operation:"cellInsert",id:r.closest(".listHolderElement",this.$node).data("randomId"),index:s.paraIndex,wordIndex:s.wordIndex,data:e,cellIndex:i})}},deleteColumnAt:function(t,e){var i=this.toArray(t.children().children()),a=[],o=Lyte.arrayUtils;if(i.forEach(function(t){var i=$L(t),n=i.children().get(e),r=i.data("data"),s=i.data("list");a.push(r.data[e]),o(r.data,"removeAt",e),o(s,"removeAt",e),this.update_count(-_lyteUiEditor.limitFilter(n,1/0,!0,!0).length),n.remove()}.bind(this)),!this.isUndo()){var n=t.closest(this.getTag("word")),r=this.findIndex(n.get(0));this.pushToQueue({operation:"cellDelete",id:n.closest(".listHolderElement",this.$node).data("randomId"),index:r.paraIndex,wordIndex:r.wordIndex,cellIndex:e,data:a})}},selectTable:function(t){var e=t.target,i=$L(e).closest(this.getTag("word")).get(0),a=(i.parentNode,this.data.range),o=Lyte.objectUtils;this.resetRange(!0),a.isRange=!0,o(a,"add","startNode",i),o(a,"add","left",0),o(a,"add","endNode",i),o(a,"add","right",0),this.setData("currentNode",a.startNode),this.setData("cursor",0),this.setRange(),this.$node.focus()},tableCopy:function(t){var e=this.first(t).parentNode,i=this.last(t).parentNode,a=e.parentNode,o=i.parentNode,n=$L(a).closest(this.getTag("table")),r=this.toArray(n.find(this.getTag("tbody")).children()),s=this.toArray(a.children),l=this.toArray(o.children),d=this.getIndex(s,e),c=this.getIndex(l,i),p=Math.max(0,this.getIndex(r,a)),h=Math.max(0,this.getIndex(r,o));n=this.extend(n.data("data"));return this.spliceCells(n.data[0].data[0].data,d,c),this.spliceCells(n.data[1].data,p,h),n.data[1].data.forEach(function(t){this.spliceCells(t.data,d,c)}.bind(this)),_lyteUiEditor.tableBckConversion({data:[n]})},spliceCells:function(t,e,i){t.splice(i+1),t.splice(0,e)},formatTable:function(t){var e=this.emptyTable(),i=this.toArray(t.children),a=[],o=e.style;if(this.getInlineStyle(t,e,!0),o.margin=0,o.width=o.width||"100%",e.data.splice(0,2),i.forEach(function(t){var i=this.getTagName(t);"colgroup"!=i?!/caption/i.test(i)&&t.children.length&&e.data.push(this["format"+i](t)):this.toArray(t.children).forEach(function(t){var e=t.getAttribute("width");null!=e?e+="px":e=t.style.width,a.push(e)}.bind(this))}.bind(this)),1==e.data.length){var n=e.data[0].data[0].data.length,r=this.thead(1,n);r.data[0].data.forEach((function(t,e){t.style.width=a[e]||100/n+"%"})),e.data.splice(0,0,r),(r.classList=r.classList||[]).push("lyteEditorNoHeadTable")}return e},formatthead:function(t){var e=this.thead();return this.getInlineStyle(t,e,!0),e.data=[this.formattr(t.children[0],this.getTag("th"))],e},formattbody:function(t){var e=this.tbody(),i=this.toArray(t.children),a=[];return this.getInlineStyle(t,e,!0),i.forEach(function(t,i){var o=[];a[i]=o,e.data.push(this.formattr(t,this.getTag("td"),o))}.bind(this)),this.pushExtraDataForRowSpan(e.data,a),e},pushExtraDataForRowSpan:function(t,e){var i=this;e.reverse().forEach((function(a,o){a.reverse().forEach((function(n,r){for(var s=1;s<=n.rowSpan;s++)for(var l=1;l<=n.colSpan;l++)if(1!=s||1!=l){var d=i.cell(i.getTag("td")),c=e.length-1-o+s-1,p=t[c];d.style.display="none",p||(p=i.tr(),t[c]=p),p.data.splice(a.length-r+l-1,0,d)}}))}))},formattr:function(t,e,i){var a=this.tr(),o=this.toArray(t.children),n=o.length;return this.getInlineStyle(t,a,!0),o.forEach(function(t,o){var r=this.cell(e),s=t.rowSpan,l=t.colSpan;this.getInlineStyle(t,r,!0);var d=r.details;d.rowSpan=s,d.colSpan=l,a.data.push(r),t.childNodes.length&&(r.data=this.formatHtml(this.formatDOM(this.toArray(t.childNodes)))),i&&(i[o]={rowSpan:s,colSpan:l}),e!=this.getTag("th")?delete r.style.width:r.style.width||(r.style.width=parseInt(1e4/n)/100+"%")}.bind(this)),a},formatcell:function(t,e){var i=this.cell(e),a=this.toArray(t.children);return this.getInlineStyle(t,i,!0),i.data=this.formatHtml(a),i},insertRow:function(t){var e=this.data.topLevelElement;if(e&&this.getTagName(e)==this.getTag("td")){this.updateRangeNode(),this.resetRange(!0);var i=e.parentNode,a=this.toArray(i.parentNode.children),o=this.getIndex(a,i),n=this.toArray(i.children),r=this.getIndex(n,e),s="before"==t,l=e.rowSpan;0!=o&&s&&(s=!1,i=a[o-1],o-=1,l=(e=i.children[r]).rowSpan),l>1&&!s&&(e=(i=a[o+l-1]).children[r],o+=l-1);var d,c=o+(s?0:1),p=$L(i).data("data"),h={data:[],details:this.extend(p.details),style:this.extend(p.style),tag:p.tag,data:[]},u=[];p.data.forEach(function(t,e){var a,o={randomId:this.randomId(),style:this.extend(t.style),details:this.extend(t.details),tag:t.tag};s||("none"==t.style.display?(a=this.originCell(i.children[e])).same||-1==this.getIndex(u,a.cell)&&u.push(a.cell):1!=t.details.rowSpan&&(u.push(i.children[e]),s||(o.style.display="none"))),o.data=[this.emptyParaData()],o.details.rowSpan=1,h.data.push(o)}.bind(this)),u.forEach(function(t){this.spanSet(t,"rowSpan",t.rowSpan+1)}.bind(this)),d=this.createRow($L(e).closest(this.getTag("table")),c,h),this.setData("currentNode",this.getLastWordInPara(this.last($L(d).data("list")))),this.setData("cursor",this.getWordText(this.data.currentNode).length),this.updateRangeNode(),this.common_positioning()}},removeRow:function(){var t=this.data.topLevelElement;if(t&&this.getTagName(t)==this.getTag("td")){this.updateRangeNode(),this.resetRange(!0);var e=t.parentNode,i=this.toArray(e.parentNode.children),a=this.getIndex(i,e),o=this.toArray(e.children),n=[];if(1!=i.length){o.forEach(function(t,i){if(1==t.rowSpan&&1==t.colSpan||this.processSplit(t),"none"==t.style.display){var a=this.originCell(e.children[i]);a.same||n.push(a.cell)}}.bind(this)),n.forEach(function(t){this.spanSet(t,"rowSpan",t.rowSpan-1)}.bind(this));var r=this.getPreviousWord(this.getFirstWordInPara(this.first($L(this.first(o)).data("list"))));this.processDeleteRow($L(e).closest(this.getTag("table")),a),this.setData("currentNode",r),this.setData("cursor",this.getWordText(r).length),this.updateRangeNode(),this.setCursor(r,this.data.cursor)}}},originCell:function(t){for(var e,i,a=t.parentNode,o=this.toArray(a.children),n=this.getIndex(o,t),r=t.previousElementSibling;r;){if("none"!=r.style.display){var s=this.getIndex(o,r);if(r.colSpan+s>n)return{cell:r,same:!0,index:s};break}r=r.previousElementSibling}e=this.toArray(a.parentNode.children);for(var l=(i=this.getIndex(e,a))-1;l>=0;l--)for(r=e[l].children[n];r;)if("none"!=r.style.display){s=this.getIndex(this.toArray(r.parentNode.children),r);if(r.colSpan+s>=n&&r.rowSpan+l>i)return{cell:r,index:s,rowIndex:l};r=r.previousElementSibling}else r=r.previousElementSibling},insertColumn:function(t){var e=this.data,i=e.topLevelElement;if(i&&-1!=[this.getTag("td"),this.getTag("th")].indexOf(this.getTagName(i))){this.updateRangeNode(),this.resetRange(!0);var a=i.parentNode,o=this.toArray(a.children),n=$L(i).closest(this.getTag("table")),r=n.closest(this.getTag("paragraph")),s=this.extend(r.data("data")).data[0].data[0],l=this.getBcr(n.get(0),"width"),d=this.toArray(n.children().children()),c=this.getIndex(d,a)+i.rowSpan-1,p="before"==t,h=this.getIndex(o,i),u=h+(p?0:i.colSpan),m=[],f=l/(s.data[0].data[0].data.length+1),g=n.children();this.toArray(g.eq(0).children().children()).forEach(function(t){this.setStyle(t,"width",f+"px")}.bind(this)),m.push(this.cell(this.getTag("th"),f)),s.data[1].data.forEach(function(t,e,i){var a=this.cell(this.getTag("td")),o=d[e+1].children[h],n=!1;if(p){if("none"==o.style.display){var r,s=i[(r=this.originCell(o)).rowIndex].data[r.index],l=r.cell,c=s.details;r.isSame||(c.rowSpan+=1,this.spanSet(l,"colSpan",c.rowSpan+1)),this.spanSet(l,"colSpan",c.colSpan+1),n=!0}}else if("none"==o.style.display){if((r=this.originCell(o)).cell.colSpan+r.index-1>h){s=i[r.rowIndex].data[r.index],l=r.cell,c=s.details;r.isSame||this.spanSet(l,"colSpan",c.rowSpan+1),this.spanSet(l,"colSpan",c.colSpan+1),n=!0}}else o.colSpan>1&&(this.spanSet(o,"colSpan",t.data[h].details.colSpan+1),n=!0);n&&(a.style.display="none"),a.style.height=o.style.height,m.push(a)}.bind(this)),this.insertColumnAt(n,m,u);var y=$L(g.children()[c].children[u]);"none"==y.get(0).style.display&&(y=$L(i)),this.setData("currentNode",this.getLastWordInPara(this.last(y.data("list")))),this.setData("cursor",this.getWordText(e.currentNode).length),this.updateRangeNode(),this.setCursor(e.currentNode,e.cursor)}},removeColumn:function(){var t=this.data,e=t.topLevelElement;if(e&&-1!=[this.getTag("td"),this.getTag("th")].indexOf(this.getTagName(e))){this.updateRangeNode(),this.resetRange(!0);var i=e.parentNode,a=this.toArray(i.children),o=$L(e).closest(this.getTag("table")),n=o.children().children(),r=this.toArray(n),s=this.getIndex(r,i),l=this.getIndex(a,e);if(1!=a.length){this.toArray(r[0].children).forEach(function(t,e){e!=l&&this.setStyle(t,"width, cellWidth")}.bind(this)),r.forEach(function(t,e){if(0!=e){var i=t.children[l];if("none"==i.style.display){var a=this.originCell(i);a.same?this.spanSet(a.cell,"colSpan",Math.max(1,a.cell.colSpan-1)):this.spanSet(a.cell,"rowSpan",Math.max(1,a.cell.rowSpan-1)),this.setStyle(i,"display","")}else 1==i.rowSpan&&1==i.colSpan||this.processSplit(i)}}.bind(this)),this.deleteColumnAt(o,l);var d=n[s].children,c=d[l]||this.last(d);this.setData("currentNode",this.getLastWordInPara(this.last($L(c).data("list")))),this.setData("cursor",this.getWordText(t.currentNode).length),this.updateRangeNode(),this.setCursor(t.currentNode,t.cursor)}}},selectCell:function(t){if(t){var e=$L(t).data("list"),i=this.getFirstWordInPara(e[0]),a=this.getLastWordInPara(this.last(e));this.resetRange(!0);var o=this.data.range,n=Lyte.objectUtils,r=this.getWordText(a).length,s={startNode:i,endNode:a,left:0,right:r,isRange:i!=a||r};for(var l in s)n(o,"add",l,s[l]);this.setData({currentNode:i,cursor:0}),this.common_positioning()}},deleteTable:function(t){this.updateRangeNode();var e,i=t.closest(this.getTag("paragraph")),a=i.parentNode,o=$L(a).data("list"),n=this.getIndex(o,i);1==o.length?(e=this.render(this.emptyParaData()),this.pushParagraph(e,a,0)):e=0==n?o[1]:o[0],this.removePara(i);var r=this[n?"getFirstWordInPara":"getLastWordInPara"](e),s=n?this.getWordText(r).length:0;this.setData("currentNode",r),this.setCursor(r,s),this.updateRangeNode()},table_next:function(t,e){var i=this.toArray(t.closest(this.getTag("table")).children().children()),a=e.parentNode,o=this.getIndex(i,a),n=i.length-1,r=a.children,s=this.getIndex(this.toArray(r),e);if(this.__shiftmove&&s!=r.length-1&&(o=n),o!=n){var l=i[o+1].children[s];return"none"==l.style.display&&(l=this.getNext(l)),l}},table_prev:function(t,e){var i=this.toArray(t.closest(this.getTag("table")).children().children()),a=e.parentNode,o=this.getIndex(i,a),n=this.getIndex(this.toArray(a.children),e);if(this.__shiftmove&&0!=n&&(o=0),0!=o){var r=i[o-1].children[n];return"none"==r.style.display&&(r=this.getPrevious(r)),r}}}),Lyte.Mixin.register("lyte-editor-resize",{resize_mousemove:function(t){if(/touch/.test(t.type)){var e=t.touches;if(e.length>1)return;t.preventDefault(),t=e[0]}var i=function(e){return t[e]-this["_"+e]}.bind(this),a=this.data.ltPropResize,o=a.horizontal?i("clientX")*(_lyteUiUtils.getRTL()?-1:1):0,n=a.vertical?i("clientY"):0,r=this._width+o,s=this._height+n,l=this.data,d=l.range;this.getMethods("onEditorResize")&&this.executeMethod("onEditorResize"),n&&(this.__editor_manually_resized=!0),this._width=r=Math.min(Math.max(r,this._minwidth,0),this._maxwidth),this._height=s=Math.min(Math.max(s,this._minheight),this._maxheight),$L(this.$node).css({width:r,height:s}),this._clientX=t.clientX,this._clientY=t.clientY,d.isRange?this.setRange():this.setCursor(l.currentNode,l.cursor),this.callFind()},resize_mouseup:function(t){var e="mousemove",i="mouseup",a=document,o="removeEventListener";/touch/.test(t.type)&&(e="touchmove",i="touchend"),a[o](e,this._mm,!0),a[o](i,this._mu,!0),["_mm","_mu","_width","_height","_minwidth","_minheight","_maxwidth","_maxheight","_clientX","_clientY"].forEach(function(t){delete this[t]}.bind(this)),$L(this.$node).removeClass("lyteEditorResizeSelect"),this.execute("onEditorResizeEnd",this.$node)},actions:{resize_mousedown:function(t){var e,i=t,a="mousemove",o="mouseup",n=document,r="addEventListener",s=window.getComputedStyle(this.$node),l=function(t,e){var i=parseFloat(s[t]);return isNaN(i)?e:i};if(this.getMethods("onEditorResizeStart")&&(e=this.executeMethod("onEditorResizeStart",this.$node)),!1!==e){if(this._width=l("width"),this._height=l("height"),this._minwidth=l("minWidth",0),this._maxwidth=l("maxWidth",1/0),this._minheight=l("minHeight",0),this._maxheight=l("maxHeight",1/0),this._clientX=i.clientX,this._clientY=i.clientY,/touch/.test(t.type)){var d=t.touches;if(d.length>1)return;i=d[0],a="touchmove",o="touchend"}this._mm=this.resize_mousemove.bind(this),this._mu=this.resize_mouseup.bind(this),n[r](a,this._mm,!0),n[r](o,this._mu,!0),$L(this.$node).addClass("lyteEditorResizeSelect"),t.preventDefault()}}}}),function(){var t=_lyteUiUtils;if(t){var e,i=navigator,a=i.userAgent,o=(/Macintosh/i.test(a)?"meta":"ctrl")+"Key";function n(t){var e=document.createElement("div"),i="",a=function(t){t.forEach((function(t){var e=t.tagName,o=Array.from(t.childNodes||[]);o.length&&a(o),/^(div|dt|dd|detail|summary|length|fieldset|footer|header|main|blockquote|p|caption-div|h[1-6]|hr|td|th|hr|img|video|br)$/i.test(e)?i+="\n":e||(i+=t.nodeValue)}))};return e.innerHTML=t,a(Array.from(e.childNodes)),i}function r(a,o,r){try{i.permissions.query({name:"clipboard-write"}).then((function(e){if(/^(granted|prompt)$/i.test(e.state)){var s=new ClipboardItem((c="text/plain",(l={})[d="text/html"]=new Blob([a],{type:d}),l[c]=new Blob([n(a)],{type:c}),l));i.clipboard.write([s]).then((function(){o&&o.apply(this,arguments)}),(function(){r&&r.apply(this,arguments)}))}else t.copyFrmEvt(a,void 0,void 0,o,r,!0);var l,d,c})).catch((function(i){e=void 0,t.copyFrmEvt(a,void 0,void 0,o,r,!0)}))}catch(t){r&&r.call(this,t)}}t.html2str=n,t.copy2clip=r,t.copyFrmEvt=function(t,i,a,n,s,l){if((!i||function(t){var e=t.key;return!!/^(c|x)$/i.test(e)&&t[o]}(i))&&null==e){if(e=setTimeout((function(){e=void 0}),20),l||"firefox"==_lyteUiUtils.getBrowser()){var d=document.createElement("div"),c=d.style;d.contentEditable=!0,a=a||document.body,d.tabindex=0,d.innerHTML=t,c.position="absolute",c.opacity="0",c.top="0",c.left="0",a.appendChild(d),d.focus({preventScroll:!0});var p=window.getSelection(),h=document.createRange();h.selectNodeContents(d),p.removeAllRanges(),p.addRange(h),i||document.execCommand("copy"),setTimeout((function(){d.remove(),n&&n()}),100)}else r(t,n,s);return!0}}}}(),Lyte.Component.register("lyte-emoji",{_template:'<template tag-name="lyte-emoji"> <template is="if" value="{{ltPropSearch}}"><template case="true"> <div class="lyteEmojiInputElement"> <lyte-input lt-prop="{{stringify(ltPropInput)}}" lt-prop-type="{{ltPropInput.type}}" lt-prop-close-icon="{{ltPropInput.closeIcon}}" lt-prop-value="{{lbind(value)}}" oninput="{{action(\'input\',event)}}"></lyte-input> </div> </template></template> <div class="lyteEmojiWrapper"> <template is="for" items="{{ltPropEmoji}}" item="group" index="grp_index"> <div class="lyteEmojiGroup {{group.name}}"> <template is="for" items="{{group.emojis}}" item="emoji" index="index"> <span tabindex="-1" class="lyteEmoji" lt-prop-tooltip-class="lyteEmojiTooltip" lt-prop-tooltip-config="{{ltPropTooltipConfig}}" onclick="{{action(\'click\',emoji)}}" value="{{emoji.value}}" encode="{{emoji.encode}}" aria-label="{{emoji.name}}" onmouseenter="{{action(\'enter\',emoji.name,this)}}">{{unescape(emoji.encode)}}</span> </template> </div> </template><template is="if" value="{{ltPropNoMatchText}}"><template case="true"> <div class="lyteEmojiNoResult {{if(showNoResult,\'\',\'lyteEmojiHidden\')}}">{{ltPropNoMatchText}}</div> </template></template> </div> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"attr",position:[3,1]},{type:"for",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}]},{type:"attr",position:[3,2]},{type:"if",position:[3,2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}}],_observedAttributes:["ltPropEmoji","ltPropTooltipConfig","ltPropSearch","ltPropCaseSensitive","ltPropDiacritic","ltPropTrim","ltPropMethod","ltPropNoMatchText","ltPropInput","value","showNoResult"],data:function(){var t=_lyteUiUtils.getDefault("lyte-emoji");return{ltPropEmoji:Lyte.attr("array",{default:t.emoji||[{name:"People",emojis:[{name:"Grinning",value:"😀",encode:"&#x1f600"},{name:"Grin",value:"😁",encode:"&#x1f601"},{name:"Joy",value:"😂",encode:"&#x1f602"},{name:"Smiley",value:"😃",encode:"&#x1f603"},{name:"Smile",value:"😄",encode:"&#x1f604"},{name:"Sweat smile",value:"😅",encode:"&#x1f605"},{name:"Laughing",value:"😆",encode:"&#x1f606"},{name:"Wink",value:"😉",encode:"&#x1f609"},{name:"Blush",value:"😊",encode:"&#x1f60a"},{name:"Yum",value:"😋",encode:"&#x1f60b"},{name:"Sunglasses",value:"😎",encode:"&#x1f60e"},{name:"Heart eyes",value:"😍",encode:"&#x1f60d"},{name:"Kissing heart",value:"😘",encode:"&#x1f618"},{name:"Kissing",value:"😗",encode:"&#x1f617"},{name:"Kissing smiling eyes",value:"😙",encode:"&#x1f619"},{name:"Kissing closed eyes",value:"😚",encode:"&#x1f61a"},{name:"Slight smile",value:"🙂",encode:"&#x1f642"},{name:"Hug",value:"🤗",encode:"&#x1f917"},{name:"Thinking",value:"🤔",encode:"&#x1f914"},{name:"Neutral face",value:"😐",encode:"&#x1f610"},{name:"Expressionless",value:"😑",encode:"&#x1f611"},{name:"No mouth",value:"😶",encode:"&#x1f636"},{name:"Rolling eyes",value:"🙄",encode:"&#x1f644"},{name:"Smirk",value:"😏",encode:"&#x1f60f"},{name:"Persevere",value:"😣",encode:"&#x1f623"},{name:"Cry",value:"😢",encode:"&#x1f622"},{name:"Open mouth",value:"😮",encode:"&#x1f62e"},{name:"Zipper mouth",value:"🤐",encode:"&#x1f910"},{name:"Hushed",value:"😯",encode:"&#x1f62f"},{name:"Sleepy",value:"😪",encode:"&#x1f62a"},{name:"Tired face",value:"😫",encode:"&#x1f62b"},{name:"Sleeping",value:"😴",encode:"&#x1f634"},{name:"Relieved",value:"😌",encode:"&#x1f60c"},{name:"Stuck out tongue",value:"😛",encode:"&#x1f61b"},{name:"Stuck out tongue winking eye",value:"😜",encode:"&#x1f61c"},{name:"Stuck out tongue closed eyes",value:"😝",encode:"&#x1f61d"},{name:"Unamused",value:"😒",encode:"&#x1f612"},{name:"Sweat",value:"😓",encode:"&#x1f613"},{name:"Pensive",value:"😔",encode:"&#x1f614"},{name:"Confused",value:"😕",encode:"&#x1f615"},{name:"Upside down face",value:"🙃",encode:"&#x1f643"},{name:"Money mouth",value:"🤑",encode:"&#x1f911"},{name:"Astonished",value:"😲",encode:"&#x1f632"},{name:"Slight frowning",value:"🙁",encode:"&#x1f641"},{name:"Confounded",value:"😖",encode:"&#x1f616"},{name:"Disappointed",value:"😞",encode:"&#x1f61e"},{name:"Worried",value:"😟",encode:"&#x1f61f"},{name:"Triumph",value:"😤",encode:"&#x1f624"},{name:"Disappointed relieved",value:"😥",encode:"&#x1f625"},{name:"Sob",value:"😭",encode:"&#x1f62d"},{name:"Frowning with open mouth",value:"😦",encode:"&#x1f626"},{name:"Anguished",value:"😧",encode:"&#x1f627"},{name:"Fearful",value:"😨",encode:"&#x1f628"},{name:"Weary",value:"😩",encode:"&#x1f629"},{name:"Grimacing",value:"😬",encode:"&#x1f62c"},{name:"Cold sweat",value:"😰",encode:"&#x1f630"},{name:"Scream",value:"😱",encode:"&#x1f631"},{name:"Flushed",value:"😳",encode:"&#x1f633"},{name:"Dizzy face",value:"😵",encode:"&#x1f635"},{name:"Rage",value:"😡",encode:"&#x1f621"},{name:"Angry",value:"😠",encode:"&#x1f620"},{name:"Mask",value:"😷",encode:"&#x1f637"},{name:"Sick",value:"🤒",encode:"&#x1f912"},{name:"Head Bandaged",value:"🤕",encode:"&#x1f915"},{name:"Halo smiling",value:"😇",encode:"&#x1f607"},{name:"Nerd",value:"🤓",encode:"&#x1f913"},{name:"Smiling with horns",value:"😈",encode:"&#x1f608"},{name:"Imp",value:"👿",encode:"&#x1f47f"},{name:"Japanese ogre",value:"👹",encode:"&#x1f479"},{name:"Japanese goblin",value:"👺",encode:"&#x1f47a"},{name:"Skull",value:"💀",encode:"&#x1f480"},{name:"Ghost",value:"👻",encode:"&#x1f47b"},{name:"Alien",value:"👽",encode:"&#x1f47d"},{name:"Robot",value:"🤖",encode:"&#x1f916"},{name:"Hankey",value:"💩",encode:"&#x1f4a9"},{name:"Smiley cat",value:"😺",encode:"&#x1f63a"},{name:"Smile cat",value:"😸",encode:"&#x1f638"},{name:"Joy cat",value:"😹",encode:"&#x1f639"},{name:"Heart eyes cat",value:"😻",encode:"&#x1f63b"},{name:"Smirk cat",value:"😼",encode:"&#x1f63c"},{name:"Kissing cat",value:"😽",encode:"&#x1f63d"},{name:"Scream cat",value:"🙀",encode:"&#x1f640"},{name:"Crying cat face",value:"😿",encode:"&#x1f63f"},{name:"Pouting cat",value:"😾",encode:"&#x1f63e"},{name:"Baby",value:"👶",encode:"&#x1f476"},{name:"Girl",value:"👧",encode:"&#x1f467"},{name:"Boy",value:"👦",encode:"&#x1f466"},{name:"Woman",value:"👩",encode:"&#x1f469"},{name:"Man",value:"👨",encode:"&#x1f468"},{name:"Older woman",value:"👵",encode:"&#x1f475"},{name:"Older man",value:"👴",encode:"&#x1f474"},{name:"Man with gua pi mao",value:"👲",encode:"&#x1f472"},{name:"Man with turban",value:"👳",encode:"&#x1f473"},{name:"Person with blond hair",value:"👱",encode:"&#x1f471"},{name:"Person Shrugging",value:"🤷",encode:"&#x1f937"},{name:"Cop",value:"👮",encode:"&#x1f46e"},{name:"Construction worker",value:"👷",encode:"&#x1f477"},{name:"Guardsman",value:"💂",encode:"&#x1f482"},{name:"Detective",value:"🕵",encode:"&#x1f575"},{name:"Bride",value:"👰",encode:"&#x1f470"},{name:"Princess",value:"👸",encode:"&#x1f478"},{name:"Santa",value:"🎅",encode:"&#x1f385"},{name:"Angel",value:"👼",encode:"&#x1f47c"},{name:"Bow",value:"🙇",encode:"&#x1f647"},{name:"Information desk person",value:"💁",encode:"&#x1f481"},{name:"No good",value:"🙅",encode:"&#x1f645"},{name:"Ok woman",value:"🙆",encode:"&#x1f646"},{name:"Raising hand",value:"🙋",encode:"&#x1f64b"},{name:"Person with pouting face",value:"🙎",encode:"&#x1f64e"},{name:"Person frowning",value:"🙍",encode:"&#x1f64d"},{name:"Haircut",value:"💇",encode:"&#x1f487"},{name:"Massage",value:"💆",encode:"&#x1f486"},{name:"Nail care",value:"💅",encode:"&#x1f485"},{name:"Dancer",value:"💃",encode:"&#x1f483"},{name:"Dancers",value:"👯",encode:"&#x1f46f"},{name:"Levitating",value:"🕴",encode:"&#x1f574"},{name:"Walking",value:"🚶",encode:"&#x1f6b6"},{name:"Runner",value:"🏃",encode:"&#x1f3c3"},{name:"Couple",value:"👫",encode:"&#x1f46b"},{name:"Boys",value:"👬",encode:"&#x1f46c"},{name:"Girls",value:"👭",encode:"&#x1f46d"},{name:"Couple kiss",value:"💏",encode:"&#x1f48f"},{name:"Couple with heart",value:"💑",encode:"&#x1f491"},{name:"Family: Couple with son",value:"👪",encode:"&#x1f46a"},{name:"See no evil",value:"🙈",encode:"&#x1f648"},{name:"Hear no evil",value:"🙉",encode:"&#x1f649"},{name:"Speak no evil",value:"🙊",encode:"&#x1f64a"},{name:"Fire",value:"🔥",encode:"&#x1f525"},{name:"Glowing star",value:"🌟",encode:"&#x1f31f"},{name:"Droplet",value:"💧",encode:"&#x1f4a7"},{name:"Top hat",value:"🎩",encode:"&#x1f3a9"},{name:"Crown",value:"👑",encode:"&#x1f451"},{name:"Women's hat",value:"👒",encode:"&#x1f452"},{name:"Athletic shoe",value:"👟",encode:"&#x1f45f"},{name:"Man's shoe",value:"👞",encode:"&#x1f45e"},{name:"Sandal",value:"👡",encode:"&#x1f461"},{name:"High heel",value:"👠",encode:"&#x1f460"},{name:"Boot",value:"👢",encode:"&#x1f462"},{name:"Shirt",value:"👕",encode:"&#x1f455"},{name:"Necktie",value:"👔",encode:"&#x1f454"},{name:"Women's wear",value:"👚",encode:"&#x1f45a"},{name:"Dress",value:"👗",encode:"&#x1f457"},{name:"Running shirt with sash",value:"🎽",encode:"&#x1f3bd"},{name:"Jeans",value:"👖",encode:"&#x1f456"},{name:"Kimono",value:"👘",encode:"&#x1f458"},{name:"Bikini",value:"👙",encode:"&#x1f459"},{name:"Briefcase",value:"💼",encode:"&#x1f4bc"},{name:"Handbag",value:"👜",encode:"&#x1f45c"},{name:"Pouch",value:"👝",encode:"&#x1f45d"},{name:"Purse",value:"👛",encode:"&#x1f45b"},{name:"Eyeglasses",value:"👓",encode:"&#x1f453"},{name:"Ribbon",value:"🎀",encode:"&#x1f380"},{name:"Closed umbrella",value:"🌂",encode:"&#x1f302"},{name:"Gem",value:"💎",encode:"&#x1f48e"},{name:"Speech balloon",value:"💬",encode:"&#x1f4ac"},{name:"Open hands",value:"👐",encode:"&#x1f450"},{name:"Raised hands",value:"🙌",encode:"&#x1f64c"},{name:"Clap",value:"👏",encode:"&#x1f44f"},{name:"Thumbs up",value:"👍",encode:"&#x1f44d"},{name:"Thumbs down",value:"👎",encode:"&#x1f44e"},{name:"Oncoming fist",value:"👊",encode:"&#x1f44a"},{name:"Sign of horns",value:"🤘",encode:"&#x1f918"},{name:"Ok hand",value:"👌",encode:"&#x1f44c"},{name:"Point left",value:"👈",encode:"&#x1f448"},{name:"Point right",value:"👉",encode:"&#x1f449"},{name:"Point up",value:"👆",encode:"&#x1f446"},{name:"Point down",value:"👇",encode:"&#x1f447"},{name:"Middle finger",value:"🖕",encode:"&#x1f595"},{name:"Raised hand",value:"✋",encode:"&#x270b"},{name:"Splayed fingers",value:"🖐",encode:"&#x1f590"},{name:"Crossed fingers",value:"🤞",encode:"&#x1f91e"},{name:"Vulcan Salute",value:"🖖",encode:"&#x1f596"},{name:"Wave",value:"👋",encode:"&#x1f44b"},{name:"Muscle",value:"💪",encode:"&#x1f4aa"},{name:"Pray",value:"🙏",encode:"&#x1f64f"},{name:"Ring",value:"💍",encode:"&#x1f48d"},{name:"Lipstick",value:"💄",encode:"&#x1f484"},{name:"Kiss",value:"💋",encode:"&#x1f48b"},{name:"Lips",value:"👄",encode:"&#x1f444"},{name:"Tongue",value:"👅",encode:"&#x1f445"},{name:"Ear",value:"👂",encode:"&#x1f442"},{name:"Nose",value:"👃",encode:"&#x1f443"},{name:"Footprints",value:"👣",encode:"&#x1f463"},{name:"Eye",value:"👁",encode:"&#x1f441"},{name:"Eyes",value:"👀",encode:"&#x1f440"},{name:"Speaking Head",value:"🗣",encode:"&#x1f5e3"},{name:"Bust in silhouette",value:"👤",encode:"&#x1f464"},{name:"Busts in silhouette",value:"👥",encode:"&#x1f465"}]},{name:"Nature",emojis:[{name:"Dog",value:"🐶",encode:"&#x1f436"},{name:"Wolf",value:"🐺",encode:"&#x1f43a"},{name:"Hamster",value:"🐹",encode:"&#x1f439"},{name:"Rabbit",value:"🐰",encode:"&#x1f430"},{name:"Frog",value:"🐸",encode:"&#x1f438"},{name:"Tiger",value:"🐯",encode:"&#x1f42f"},{name:"Koala",value:"🐨",encode:"&#x1f428"},{name:"Bear",value:"🐻",encode:"&#x1f43b"},{name:"Pig",value:"🐷",encode:"&#x1f437"},{name:"Pig nose",value:"🐽",encode:"&#x1f43d"},{name:"Boar",value:"🐗",encode:"&#x1f417"},{name:"Monkey",value:"🐒",encode:"&#x1f412"},{name:"Horse",value:"🐴",encode:"&#x1f434"},{name:"Sheep",value:"🐑",encode:"&#x1f411"},{name:"Elephant",value:"🐘",encode:"&#x1f418"},{name:"Panda face",value:"🐼",encode:"&#x1f43c"},{name:"Penguin",value:"🐧",encode:"&#x1f427"},{name:"Bird",value:"🐦",encode:"&#x1f426"},{name:"Baby chick",value:"🐤",encode:"&#x1f424"},{name:"Hatched chick",value:"🐥",encode:"&#x1f425"},{name:"Hatching chick",value:"🐣",encode:"&#x1f423"},{name:"Chicken",value:"🐔",encode:"&#x1f414"},{name:"Snake",value:"🐍",encode:"&#x1f40d"},{name:"Turtle",value:"🐢",encode:"&#x1f422"},{name:"Bug",value:"🐛",encode:"&#x1f41b"},{name:"Bee",value:"🐝",encode:"&#x1f41d"},{name:"Ant",value:"🐜",encode:"&#x1f41c"},{name:"Beetle",value:"🐞",encode:"&#x1f41e"},{name:"Snail",value:"🐌",encode:"&#x1f40c"},{name:"Octopus",value:"🐙",encode:"&#x1f419"},{name:"Shell",value:"🐚",encode:"&#x1f41a"},{name:"Tropical fish",value:"🐠",encode:"&#x1f420"},{name:"Fish",value:"🐟",encode:"&#x1f41f"},{name:"Dolphin",value:"🐬",encode:"&#x1f42c"},{name:"Whale",value:"🐳",encode:"&#x1f433"},{name:"Racehorse",value:"🐎",encode:"&#x1f40e"},{name:"Dragon face",value:"🐲",encode:"&#x1f432"},{name:"Blowfish",value:"🐡",encode:"&#x1f421"},{name:"Camel",value:"🐫",encode:"&#x1f42b"},{name:"Poodle",value:"🐩",encode:"&#x1f429"},{name:"Feet",value:"🐾",encode:"&#x1f43e"},{name:"Bouquet",value:"💐",encode:"&#x1f490"},{name:"Cherry blossom",value:"🌸",encode:"&#x1f338"},{name:"Tulip",value:"🌷",encode:"&#x1f337"},{name:"Four leaf clover",value:"🍀",encode:"&#x1f340"},{name:"Rose",value:"🌹",encode:"&#x1f339"},{name:"Sunflower",value:"🌻",encode:"&#x1f33b"},{name:"Hibiscus",value:"🌺",encode:"&#x1f33a"},{name:"Maple leaf",value:"🍁",encode:"&#x1f341"},{name:"Leaves",value:"🍃",encode:"&#x1f343"},{name:"Fallen leaf",value:"🍂",encode:"&#x1f342"},{name:"Herb",value:"🌿",encode:"&#x1f33f"},{name:"Ear of rice",value:"🌾",encode:"&#x1f33e"},{name:"Mushroom",value:"🍄",encode:"&#x1f344"},{name:"Cactus",value:"🌵",encode:"&#x1f335"},{name:"Palm tree",value:"🌴",encode:"&#x1f334"},{name:"Chestnut",value:"🌰",encode:"&#x1f330"},{name:"Seedling",value:"🌱",encode:"&#x1f331"},{name:"Blossom",value:"🌼",encode:"&#x1f33c"},{name:"New moon",value:"🌑",encode:"&#x1f311"},{name:"First quarter moon",value:"🌓",encode:"&#x1f313"},{name:"Moon",value:"🌔",encode:"&#x1f314"},{name:"Full moon",value:"🌕",encode:"&#x1f315"},{name:"First quarter moon with face",value:"🌛",encode:"&#x1f31b"},{name:"Crescent moon",value:"🌙",encode:"&#x1f319"},{name:"Earth asia",value:"🌏",encode:"&#x1f30f"},{name:"Volcano",value:"🌋",encode:"&#x1f30b"},{name:"Milky way",value:"🌌",encode:"&#x1f30c"},{name:"Stars",value:"🌠",encode:"&#x1f320"},{name:"Partly sunny",value:"⛅",encode:"&#x26c5"},{name:"Snowman",value:"⛄",encode:"&#x26c4"},{name:"Cyclone",value:"🌀",encode:"&#x1f300"},{name:"Foggy",value:"🌁",encode:"&#x1f301"},{name:"Rainbow",value:"🌈",encode:"&#x1f308"},{name:"Ocean",value:"🌊",encode:"&#x1f30a"}]},{name:"Objects",emojis:[{name:"Bamboo",value:"🎍",encode:"&#x1f38d"},{name:"Dolls",value:"🎎",encode:"&#x1f38e"},{name:"School satchel",value:"🎒",encode:"&#x1f392"},{name:"Graduation Cap",value:"🎓",encode:"&#x1f393"},{name:"Carp Streamer",value:"🎏",encode:"&#x1f38f"},{name:"Fireworks",value:"🎆",encode:"&#x1f386"},{name:"Sparkler",value:"🎇",encode:"&#x1f387"},{name:"Wind chime",value:"🎐",encode:"&#x1f390"},{name:"Rice scene",value:"🎑",encode:"&#x1f391"},{name:"Jack o lantern",value:"🎃",encode:"&#x1f383"},{name:"Christmas tree",value:"🎄",encode:"&#x1f384"},{name:"Gift",value:"🎁",encode:"&#x1f381"},{name:"Tanabata tree",value:"🎋",encode:"&#x1f38b"},{name:"Tada",value:"🎉",encode:"&#x1f389"},{name:"Confetti ball",value:"🎊",encode:"&#x1f38a"},{name:"Balloon",value:"🎈",encode:"&#x1f388"},{name:"Crossed flags",value:"🎌",encode:"&#x1f38c"},{name:"Crystal ball",value:"🔮",encode:"&#x1f52e"},{name:"Movie camera",value:"🎥",encode:"&#x1f3a5"},{name:"Camera",value:"📷",encode:"&#x1f4f7"},{name:"Video camera",value:"📹",encode:"&#x1f4f9"},{name:"Vhs",value:"📼",encode:"&#x1f4fc"},{name:"Cd",value:"💿",encode:"&#x1f4bf"},{name:"Dvd",value:"📀",encode:"&#x1f4c0"},{name:"Minidisc",value:"💽",encode:"&#x1f4bd"},{name:"Floppy disk",value:"💾",encode:"&#x1f4be"},{name:"Computer",value:"💻",encode:"&#x1f4bb"},{name:"iPhone",value:"📱",encode:"&#x1f4f1"},{name:"Telephone receiver",value:"📞",encode:"&#x1f4de"},{name:"Pager",value:"📟",encode:"&#x1f4df"},{name:"Fax",value:"📠",encode:"&#x1f4e0"},{name:"Satellite",value:"📡",encode:"&#x1f4e1"},{name:"Tv",value:"📺",encode:"&#x1f4fa"},{name:"Radio",value:"📻",encode:"&#x1f4fb"},{name:"Loud sound",value:"🔊",encode:"&#x1f50a"},{name:"Bell",value:"🔔",encode:"&#x1f514"},{name:"Loudspeaker",value:"📢",encode:"&#x1f4e2"},{name:"Mega",value:"📣",encode:"&#x1f4e3"},{name:"Hourglass flowing sand",value:"⏳",encode:"&#x23f3"},{name:"Alarm clock",value:"⏰",encode:"&#x23f0"},{name:"Unlock",value:"🔓",encode:"&#x1f513"},{name:"Lock",value:"🔒",encode:"&#x1f512"},{name:"Lock with ink pen",value:"🔏",encode:"&#x1f50f"},{name:"Closed lock with key",value:"🔐",encode:"&#x1f510"},{name:"Key",value:"🔑",encode:"&#x1f511"},{name:"Right magnifying glass",value:"🔎",encode:"&#x1f50e"},{name:"Bulb",value:"💡",encode:"&#x1f4a1"},{name:"Flashlight",value:"🔦",encode:"&#x1f526"},{name:"Electric plug",value:"🔌",encode:"&#x1f50c"},{name:"Battery",value:"🔋",encode:"&#x1f50b"},{name:"Left magnifying glass",value:"🔍",encode:"&#x1f50d"},{name:"Bath",value:"🛀",encode:"&#x1f6c0"},{name:"Toilet",value:"🚽",encode:"&#x1f6bd"},{name:"Wrench",value:"🔧",encode:"&#x1f527"},{name:"Nut and bolt",value:"🔩",encode:"&#x1f529"},{name:"Hammer",value:"🔨",encode:"&#x1f528"},{name:"Door",value:"🚪",encode:"&#x1f6aa"},{name:"Smoking",value:"🚬",encode:"&#x1f6ac"},{name:"Bomb",value:"💣",encode:"&#x1f4a3"},{name:"Gun",value:"🔫",encode:"&#x1f52b"},{name:"Hocho",value:"🔪",encode:"&#x1f52a"},{name:"Pill",value:"💊",encode:"&#x1f48a"},{name:"Syringe",value:"💉",encode:"&#x1f489"},{name:"Moneybag",value:"💰",encode:"&#x1f4b0"},{name:"Yen",value:"💴",encode:"&#x1f4b4"},{name:"Dollar",value:"💵",encode:"&#x1f4b5"},{name:"Credit card",value:"💳",encode:"&#x1f4b3"},{name:"Money with wings",value:"💸",encode:"&#x1f4b8"},{name:"Calling",value:"📲",encode:"&#x1f4f2"},{name:"E mail",value:"📧",encode:"&#x1f4e7"},{name:"Inbox tray",value:"📥",encode:"&#x1f4e5"},{name:"Outbox tray",value:"📤",encode:"&#x1f4e4"},{name:"Envelope with arrow",value:"📩",encode:"&#x1f4e9"},{name:"Incoming envelope",value:"📨",encode:"&#x1f4e8"},{name:"Mailbox",value:"📫",encode:"&#x1f4eb"},{name:"Mailbox closed",value:"📪",encode:"&#x1f4ea"},{name:"Postbox",value:"📮",encode:"&#x1f4ee"},{name:"Package",value:"📦",encode:"&#x1f4e6"},{name:"Memo",value:"📝",encode:"&#x1f4dd"},{name:"Page facing up",value:"📄",encode:"&#x1f4c4"},{name:"Page with curl",value:"📃",encode:"&#x1f4c3"},{name:"Bookmark tabs",value:"📑",encode:"&#x1f4d1"},{name:"Bar chart",value:"📊",encode:"&#x1f4ca"},{name:"Chart with upwards trend",value:"📈",encode:"&#x1f4c8"},{name:"Chart with downwards trend",value:"📉",encode:"&#x1f4c9"},{name:"Scroll",value:"📜",encode:"&#x1f4dc"},{name:"Clipboard",value:"📋",encode:"&#x1f4cb"},{name:"Tear off Calendar",value:"📅",encode:"&#x1f4c5"},{name:"Calendar",value:"📆",encode:"&#x1f4c6"},{name:"Card index",value:"📇",encode:"&#x1f4c7"},{name:"File folder",value:"📁",encode:"&#x1f4c1"},{name:"Open file folder",value:"📂",encode:"&#x1f4c2"},{name:"Pushpin",value:"📌",encode:"&#x1f4cc"},{name:"Paperclip",value:"📎",encode:"&#x1f4ce"},{name:"Straight ruler",value:"📏",encode:"&#x1f4cf"},{name:"Triangular ruler",value:"📐",encode:"&#x1f4d0"},{name:"Closed book",value:"📕",encode:"&#x1f4d5"},{name:"Green book",value:"📗",encode:"&#x1f4d7"},{name:"Blue book",value:"📘",encode:"&#x1f4d8"},{name:"Orange book",value:"📙",encode:"&#x1f4d9"},{name:"Notebook",value:"📓",encode:"&#x1f4d3"},{name:"Notebook with decorative cover",value:"📔",encode:"&#x1f4d4"},{name:"Ledger",value:"📒",encode:"&#x1f4d2"},{name:"Books",value:"📚",encode:"&#x1f4da"},{name:"Book",value:"📖",encode:"&#x1f4d6"},{name:"Bookmark",value:"🔖",encode:"&#x1f516"},{name:"Newspaper",value:"📰",encode:"&#x1f4f0"},{name:"Artist Palette",value:"🎨",encode:"&#x1f3a8"},{name:"Clapper",value:"🎬",encode:"&#x1f3ac"},{name:"Microphone",value:"🎤",encode:"&#x1f3a4"},{name:"Headphones",value:"🎧",encode:"&#x1f3a7"},{name:"Musical score",value:"🎼",encode:"&#x1f3bc"},{name:"Musical note",value:"🎵",encode:"&#x1f3b5"},{name:"Notes",value:"🎶",encode:"&#x1f3b6"},{name:"Musical keyboard",value:"🎹",encode:"&#x1f3b9"},{name:"Violin",value:"🎻",encode:"&#x1f3bb"},{name:"Trumpet",value:"🎺",encode:"&#x1f3ba"},{name:"Saxophone",value:"🎷",encode:"&#x1f3b7"},{name:"Guitar",value:"🎸",encode:"&#x1f3b8"},{name:"Space invader",value:"👾",encode:"&#x1f47e"},{name:"Video game",value:"🎮",encode:"&#x1f3ae"},{name:"Flower playing cards",value:"🎴",encode:"&#x1f3b4"},{name:"Game die",value:"🎲",encode:"&#x1f3b2"},{name:"Dart",value:"🎯",encode:"&#x1f3af"},{name:"Football",value:"🏈",encode:"&#x1f3c8"},{name:"Basketball",value:"🏀",encode:"&#x1f3c0"},{name:"Soccer",value:"⚽",encode:"&#x26bd"},{name:"Baseball",value:"⚾",encode:"&#x26be"},{name:"Tennis",value:"🎾",encode:"&#x1f3be"},{name:"8ball",value:"🎱",encode:"&#x1f3b1"},{name:"Bowling",value:"🎳",encode:"&#x1f3b3"},{name:"Golf",value:"⛳",encode:"&#x26f3"},{name:"Checkered flag",value:"🏁",encode:"&#x1f3c1"},{name:"Trophy",value:"🏆",encode:"&#x1f3c6"},{name:"Ski",value:"🎿",encode:"&#x1f3bf"},{name:"Snowboarder",value:"🏂",encode:"&#x1f3c2"},{name:"Swimmer",value:"🏊",encode:"&#x1f3ca"},{name:"Surfer",value:"🏄",encode:"&#x1f3c4"},{name:"Fishing pole and fish",value:"🎣",encode:"&#x1f3a3"},{name:"Tea",value:"🍵",encode:"&#x1f375"},{name:"Sake",value:"🍶",encode:"&#x1f376"},{name:"Beer",value:"🍺",encode:"&#x1f37a"},{name:"Beers",value:"🍻",encode:"&#x1f37b"},{name:"Cocktail",value:"🍸",encode:"&#x1f378"},{name:"Tropical drink",value:"🍹",encode:"&#x1f379"},{name:"Wine glass",value:"🍷",encode:"&#x1f377"},{name:"Fork and knife",value:"🍴",encode:"&#x1f374"},{name:"Pizza",value:"🍕",encode:"&#x1f355"},{name:"Hamburger",value:"🍔",encode:"&#x1f354"},{name:"Fries",value:"🍟",encode:"&#x1f35f"},{name:"Poultry leg",value:"🍗",encode:"&#x1f357"},{name:"Meat on bone",value:"🍖",encode:"&#x1f356"},{name:"Spaghetti",value:"🍝",encode:"&#x1f35d"},{name:"Curry",value:"🍛",encode:"&#x1f35b"},{name:"Fried shrimp",value:"🍤",encode:"&#x1f364"},{name:"Bento",value:"🍱",encode:"&#x1f371"},{name:"Sushi",value:"🍣",encode:"&#x1f363"},{name:"Fish cake",value:"🍥",encode:"&#x1f365"},{name:"Rice ball",value:"🍙",encode:"&#x1f359"},{name:"Rice cracker",value:"🍘",encode:"&#x1f358"},{name:"Rice",value:"🍚",encode:"&#x1f35a"},{name:"Ramen",value:"🍜",encode:"&#x1f35c"},{name:"Stew",value:"🍲",encode:"&#x1f372"},{name:"Oden",value:"🍢",encode:"&#x1f362"},{name:"Dango",value:"🍡",encode:"&#x1f361"},{name:"Egg",value:"🍳",encode:"&#x1f373"},{name:"Bread",value:"🍞",encode:"&#x1f35e"},{name:"Doughnut",value:"🍩",encode:"&#x1f369"},{name:"Custard",value:"🍮",encode:"&#x1f36e"},{name:"Soft Ice cream",value:"🍦",encode:"&#x1f366"},{name:"Ice cream",value:"🍨",encode:"&#x1f368"},{name:"Shaved ice",value:"🍧",encode:"&#x1f367"},{name:"Birthday Cake",value:"🎂",encode:"&#x1f382"},{name:"Cake",value:"🍰",encode:"&#x1f370"},{name:"Cookie",value:"🍪",encode:"&#x1f36a"},{name:"Chocolate bar",value:"🍫",encode:"&#x1f36b"},{name:"Candy",value:"🍬",encode:"&#x1f36c"},{name:"Lollipop",value:"🍭",encode:"&#x1f36d"},{name:"Honey pot",value:"🍯",encode:"&#x1f36f"},{name:"Apple",value:"🍎",encode:"&#x1f34e"},{name:"Green apple",value:"🍏",encode:"&#x1f34f"},{name:"Tangerine",value:"🍊",encode:"&#x1f34a"},{name:"Cherries",value:"🍒",encode:"&#x1f352"},{name:"Grapes",value:"🍇",encode:"&#x1f347"},{name:"Watermelon",value:"🍉",encode:"&#x1f349"},{name:"Strawberry",value:"🍓",encode:"&#x1f353"},{name:"Peach",value:"🍑",encode:"&#x1f351"},{name:"Melon",value:"🍈",encode:"&#x1f348"},{name:"Banana",value:"🍌",encode:"&#x1f34c"},{name:"Pineapple",value:"🍍",encode:"&#x1f34d"},{name:"Sweet potato",value:"🍠",encode:"&#x1f360"},{name:"Eggplant",value:"🍆",encode:"&#x1f346"},{name:"Tomato",value:"🍅",encode:"&#x1f345"},{name:"Corn",value:"🌽",encode:"&#x1f33d"}]},{name:"Places",emojis:[{name:"House",value:"🏠",encode:"&#x1f3e0"},{name:"House with garden",value:"🏡",encode:"&#x1f3e1"},{name:"School",value:"🏫",encode:"&#x1f3eb"},{name:"Office",value:"🏢",encode:"&#x1f3e2"},{name:"Post office",value:"🏣",encode:"&#x1f3e3"},{name:"Hospital",value:"🏥",encode:"&#x1f3e5"},{name:"Bank",value:"🏦",encode:"&#x1f3e6"},{name:"Convenience store",value:"🏪",encode:"&#x1f3ea"},{name:"Love hotel",value:"🏩",encode:"&#x1f3e9"},{name:"Hotel",value:"🏨",encode:"&#x1f3e8"},{name:"Wedding",value:"💒",encode:"&#x1f492"},{name:"Church",value:"⛪",encode:"&#x26ea"},{name:"Department store",value:"🏬",encode:"&#x1f3ec"},{name:"City sunrise",value:"🌇",encode:"&#x1f307"},{name:"City sunset",value:"🌆",encode:"&#x1f306"},{name:"Japanese castle",value:"🏯",encode:"&#x1f3ef"},{name:"European castle",value:"🏰",encode:"&#x1f3f0"},{name:"Tent",value:"⛺",encode:"&#x26fa"},{name:"Factory",value:"🏭",encode:"&#x1f3ed"},{name:"Tokyo tower",value:"🗼",encode:"&#x1f5fc"},{name:"Japan",value:"🗾",encode:"&#x1f5fe"},{name:"Mount fuji",value:"🗻",encode:"&#x1f5fb"},{name:"Sunrise over mountains",value:"🌄",encode:"&#x1f304"},{name:"Sunrise",value:"🌅",encode:"&#x1f305"},{name:"Night with stars",value:"🌃",encode:"&#x1f303"},{name:"Statue of liberty",value:"🗽",encode:"&#x1f5fd"},{name:"Bridge at night",value:"🌉",encode:"&#x1f309"},{name:"Carousel horse",value:"🎠",encode:"&#x1f3a0"},{name:"Ferris wheel",value:"🎡",encode:"&#x1f3a1"},{name:"Fountain",value:"⛲",encode:"&#x26f2"},{name:"Roller coaster",value:"🎢",encode:"&#x1f3a2"},{name:"Ship",value:"🚢",encode:"&#x1f6a2"},{name:"Boat",value:"⛵",encode:"&#x26f5"},{name:"Speedboat",value:"🚤",encode:"&#x1f6a4"},{name:"Rocket",value:"🚀",encode:"&#x1f680"},{name:"Seat",value:"💺",encode:"&#x1f4ba"},{name:"Station",value:"🚉",encode:"&#x1f689"},{name:"High speed train",value:"🚄",encode:"&#x1f684"},{name:"Bullet train",value:"🚅",encode:"&#x1f685"},{name:"Metro",value:"🚇",encode:"&#x1f687"},{name:"Railway car",value:"🚃",encode:"&#x1f683"},{name:"Bus",value:"🚌",encode:"&#x1f68c"},{name:"Blue car",value:"🚙",encode:"&#x1f699"},{name:"Car",value:"🚗",encode:"&#x1f697"},{name:"Taxi",value:"🚕",encode:"&#x1f695"},{name:"Truck",value:"🚚",encode:"&#x1f69a"},{name:"Rotating light",value:"🚨",encode:"&#x1f6a8"},{name:"Police car",value:"🚓",encode:"&#x1f693"},{name:"Fire engine",value:"🚒",encode:"&#x1f692"},{name:"Ambulance",value:"🚑",encode:"&#x1f691"},{name:"Bike",value:"🚲",encode:"&#x1f6b2"},{name:"Barber Pole",value:"💈",encode:"&#x1f488"},{name:"Bus stop",value:"🚏",encode:"&#x1f68f"},{name:"Ticket",value:"🎫",encode:"&#x1f3ab"},{name:"Traffic light",value:"🚥",encode:"&#x1f6a5"},{name:"Construction",value:"🚧",encode:"&#x1f6a7"},{name:"Beginner",value:"🔰",encode:"&#x1f530"},{name:"Fuelpump",value:"⛽",encode:"&#x26fd"},{name:"Izakaya lantern",value:"🏮",encode:"&#x1f3ee"},{name:"Slot machine",value:"🎰",encode:"&#x1f3b0"},{name:"Moyai",value:"🗿",encode:"&#x1f5ff"},{name:"Circus tent",value:"🎪",encode:"&#x1f3aa"},{name:"Performing arts",value:"🎭",encode:"&#x1f3ad"},{name:"Round pushpin",value:"📍",encode:"&#x1f4cd"},{name:"Triangular flag on post",value:"🚩",encode:"&#x1f6a9"}]},{name:"Symbols",emojis:[{name:"Red heart",value:"❤️",encode:"&#x2764&#xfe0f"},{name:"Yellow heart",value:"💛",encode:"&#x1f49b"},{name:"Blue heart",value:"💙",encode:"&#x1f499"},{name:"Purple heart",value:"💜",encode:"&#x1f49c"},{name:"Green heart",value:"💚",encode:"&#x1f49a"},{name:"Broken heart",value:"💔",encode:"&#x1f494"},{name:"Heart exclamation",value:"❣️",encode:"&#x2763&#xfe0f"},{name:"Two hearts",value:"💕",encode:"&#x1f495"},{name:"Revolving hearts",value:"💞",encode:"&#x1f49e"},{name:"Heartbeat",value:"💓",encode:"&#x1f493"},{name:"Heartpulse",value:"💗",encode:"&#x1f497"},{name:"Sparkling heart",value:"💖",encode:"&#x1f496"},{name:"Cupid",value:"💘",encode:"&#x1f498"},{name:"Gift heart",value:"💝",encode:"&#x1f49d"},{name:"Heart decoration",value:"💟",encode:"&#x1f49f"},{name:"Love letter",value:"💌",encode:"&#x1f48c"},{name:"Dizzy",value:"💫",encode:"&#x1f4ab"},{name:"Boom",value:"💥",encode:"&#x1f4a5"},{name:"Anger",value:"💢",encode:"&#x1f4a2"},{name:"Sweat drops",value:"💦",encode:"&#x1f4a6"},{name:"Zzz",value:"💤",encode:"&#x1f4a4"},{name:"Dash",value:"💨",encode:"&#x1f4a8"},{name:"Hole",value:"🕳️",encode:"&#x1f573&#xfe0f"},{name:"Peace symbol",value:"☮️",encode:"&#x262e&#xfe0f"},{name:"Latin cross",value:"✝️",encode:"&#x271d&#xfe0f"},{name:"Crescent and star",value:"☪️",encode:"&#x262a&#xfe0f"},{name:"Om",value:"🕉️",encode:"&#x1f549&#xfe0f"},{name:"Wheel of dharma",value:"☸️",encode:"&#x2638&#xfe0f"},{name:"Star of david",value:"✡️",encode:"&#x2721&#xfe0f"},{name:"Star with middle point",value:"🔯",encode:"&#x1f52f"},{name:"Menorah",value:"🕎",encode:"&#x1f54e"},{name:"Yin yang",value:"☯️",encode:"&#x262f&#xfe0f"},{name:"Orthodox cross",value:"☦️",encode:"&#x2626&#xfe0f"},{name:"Place of worship",value:"🛐",encode:"&#x1f6d0"},{name:"Ophiuchus",value:"⛎",encode:"&#x26ce"},{name:"Aries",value:"♈",encode:"&#x2648"},{name:"Taurus",value:"♉",encode:"&#x2649"},{name:"Gemini",value:"♊",encode:"&#x264a"},{name:"Cancer",value:"♋",encode:"&#x264b"},{name:"Leo",value:"♌",encode:"&#x264c"},{name:"Virgo",value:"♍",encode:"&#x264d"},{name:"Libra",value:"♎",encode:"&#x264e"},{name:"Scorpius",value:"♏",encode:"&#x264f"},{name:"Sagittarius",value:"♐",encode:"&#x2650"},{name:"Capricorn",value:"♑",encode:"&#x2651"},{name:"Aquarius",value:"♒",encode:"&#x2652"},{name:"Pisces",value:"♓",encode:"&#x2653"},{name:"Squared id",value:"🆔",encode:"&#x1f194"},{name:"Atom",value:"⚛️",encode:"&#x269b&#xfe0f"},{name:"Japanese vacancy button",value:"🈳",encode:"&#x1f233"},{name:"Japanese discount button",value:"🈹",encode:"&#x1f239"},{name:"Radioactive",value:"☢️",encode:"&#x2622&#xfe0f"},{name:"Biohazard",value:"☣️",encode:"&#x2623&#xfe0f"},{name:"Japanese not free of charge button",value:"🈶",encode:"&#x1f236"},{name:"Japanese free of charge button",value:"🈚",encode:"&#x1f21a"},{name:"Japanese application button",value:"🈸",encode:"&#x1f238"},{name:"Japanese open for business button",value:"🈺",encode:"&#x1f23a"},{name:"Japanese monthly amount",value:"🈷️",encode:"&#x1f237&#xfe0f"},{name:"Eight pointed star",value:"✴️",encode:"&#x2734&#xfe0f"},{name:"Vs button",value:"🆚",encode:"&#x1f19a"},{name:"Japanese acceptable button",value:"🉑",encode:"&#x1f251"},{name:"White flower",value:"💮",encode:"&#x1f4ae"},{name:"Japanese bargain button",value:"🉐",encode:"&#x1f250"},{name:"Japanese secret button",value:"㊙️",encode:"&#x3299&#xfe0f"},{name:"Japanese congratulations button",value:"㊗️",encode:"&#x3297&#xfe0f"},{name:"Japanese passing grade button",value:"🈴",encode:"&#x1f234"},{name:"Japanese no vacancy button",value:"🈵",encode:"&#x1f235"},{name:"Japanese prohibited button",value:"🈲",encode:"&#x1f232"},{name:"Baby symbol",value:"🚼",encode:"&#x1f6bc"},{name:"A group blood",value:"🅰️",encode:"&#x1f170&#xfe0f"},{name:"B group blood",value:"🅱️",encode:"&#x1f171&#xfe0f"},{name:"O group blood",value:"🅾️",encode:"&#x1f17e&#xfe0f"},{name:"Cl button",value:"🆑",encode:"&#x1f191"},{name:"Sos button",value:"🆘",encode:"&#x1f198"},{name:"No entry",value:"⛔",encode:"&#x26d4"},{name:"Name badge",value:"📛",encode:"&#x1f4db"},{name:"Heavy circle",value:"⭕",encode:"&#x2b55"},{name:"Prohibited",value:"🚫",encode:"&#x1f6ab"},{name:"Muted",value:"🔇",encode:"&#x1f507"},{name:"Bell with slash",value:"🔕",encode:"&#x1f515"},{name:"No smoking",value:"🚭",encode:"&#x1f6ad"},{name:"No pedestrains",value:"🚷",encode:"&#x1f6b7"},{name:"No littering",value:"🚯",encode:"&#x1f6af"},{name:"No bicycle",value:"🚳",encode:"&#x1f6b3"},{name:"Non potable water",value:"🚱",encode:"&#x1f6b1"},{name:"No one under 18",value:"🔞",encode:"&#x1f51e"},{name:"No mobile phones",value:"📵",encode:"&#x1f4f5"},{name:"Exclamation mark",value:"❗",encode:"&#x2757"},{name:"White exclamation mark",value:"❕",encode:"&#x2755"},{name:"Question mark",value:"❓",encode:"&#x2753"},{name:"White question mark",value:"❔",encode:"&#x2754"},{name:"Hundred points",value:"💯",encode:"&#x1f4af"},{name:"Dim button",value:"🔅",encode:"&#x1f505"},{name:"Bright button",value:"🔆",encode:"&#x1f506"},{name:"Trident",value:"🔱",encode:"&#x1f531"},{name:"Fleur de lis",value:"⚜️",encode:"&#x269c&#xfe0f"},{name:"Part alternation mark",value:"〽️",encode:"&#x303d&#xfe0f"},{name:"Warning",value:"⚠️",encode:"&#x26a0&#xfe0f"},{name:"Children crossing",value:"🚸",encode:"&#x1f6b8"},{name:"Japanese beginner button",value:"🔰",encode:"&#x1f530"},{name:"Recycling",value:"♻️",encode:"&#x267b&#xfe0f"},{name:"Japanese reserved button",value:"🈯",encode:"&#x1f22f"},{name:"Chart increasing with yen",value:"💹",encode:"&#x1f4b9"},{name:"Sparkle",value:"❇️",encode:"&#x2747&#xfe0f"},{name:"Eight spoked asterisk",value:"✳️",encode:"&#x2733&#xfe0f"},{name:"White heavy check mark",value:"✅",encode:"&#x2705"},{name:"Cross mark",value:"❌",encode:"&#x274c"},{name:"Diamond with dot",value:"💠",encode:"&#x1f4a0"},{name:"Globe with meridians",value:"🌐",encode:"&#x1f310"},{name:"Circled m",value:"Ⓜ️",encode:"&#x24c2&#xfe0f"},{name:"Japanese service charge button",value:"🈂️",encode:"&#x1f202&#xfe0f"},{name:"Double curly loop",value:"➿",encode:"&#x27bf"},{name:"Passport control",value:"🛂",encode:"&#x1f6c2"},{name:"Customs",value:"🛃",encode:"&#x1f6c3"},{name:"Baggage claim",value:"🛄",encode:"&#x1f6c4"},{name:"Left luggage",value:"🛅",encode:"&#x1f6c5"},{name:"Wheel chair",value:"♿",encode:"&#x267f"},{name:"Water closet",value:"🚾",encode:"&#x1f6be"},{name:"P button",value:"🅿️",encode:"&#x1f17f&#xfe0f"},{name:"Potable water",value:"🚰",encode:"&#x1f6b0"},{name:"Men room",value:"🚹",encode:"&#x1f6b9"},{name:"Women room",value:"🚺",encode:"&#x1f6ba"},{name:"Restroom",value:"🚻",encode:"&#x1f6bb"},{name:"Litter in bin",value:"🚮",encode:"&#x1f6ae"},{name:"Antenna bars",value:"📶",encode:"&#x1f4f6"},{name:"Japanese here button",value:"🈁",encode:"&#x1f201"},{name:"Ng button",value:"🆖",encode:"&#x1f196"},{name:"Ok button",value:"🆗",encode:"&#x1f197"},{name:"Up button",value:"🆙",encode:"&#x1f199"},{name:"Cool button",value:"🆒",encode:"&#x1f192"},{name:"New button",value:"🆕",encode:"&#x1f195"},{name:"Free button",value:"🆓",encode:"&#x1f193"},{name:"Input number",value:"🔢",encode:"&#x1f522"},{name:"Pause button",value:"⏸️",encode:"&#x23f8&#xfe0f"},{name:"Pause or play button",value:"⏯️",encode:"&#x23ef&#xfe0f"},{name:"Stop button",value:"⏹️",encode:"&#x23f9&#xfe0f"},{name:"Record button",value:"⏺",encode:"&#x23fa"},{name:"Next track button",value:"⏭️",encode:"&#x23ed&#xfe0f"},{name:"Last track button",value:"⏮️",encode:"&#x23ee&#xfe0f"},{name:"Fast forward",value:"⏩",encode:"&#x23e9"},{name:"Fast reverse",value:"⏪",encode:"&#x23ea"},{name:"Shuffle tracks button",value:"🔀",encode:"&#x1f500"},{name:"Repeat button",value:"🔁",encode:"&#x1f501"},{name:"Repeat once button",value:"🔂",encode:"&#x1f502"},{name:"Reverse button",value:"◀️",encode:"&#x25c0&#xfe0f"},{name:"Fast up button",value:"⏫",encode:"&#x23eb"},{name:"Fast down button",value:"⏬",encode:"&#x23ec"},{name:"Right arrow",value:"➡️",encode:"&#x27a1&#xfe0f"},{name:"Left arrow",value:"⬅️",encode:"&#x2b05&#xfe0f"},{name:"Up arrow",value:"⬆️",encode:"&#x2b06&#xfe0f"},{name:"Down arrow",value:"⬇️",encode:"&#x2b07&#xfe0f"},{name:"Up right arrow",value:"↗️",encode:"&#x2197&#xfe0f"},{name:"Down left arrow",value:"↙️",encode:"&#x2199&#xfe0f"},{name:"Counter clockwise arrows",value:"🔄",encode:"&#x1f504"},{name:"Left arrow curving right",value:"↪️",encode:"&#x21aa&#xfe0f"},{name:"Right arrow curving left",value:"↩️",encode:"&#x21a9&#xfe0f"},{name:"Right arrow curving up",value:"⤴️",encode:"&#x2934&#xfe0f"},{name:"Right arrow curving down",value:"⤵️",encode:"&#x2935&#xfe0f"},{name:"Input latin letters",value:"🔤",encode:"&#x1f524"},{name:"Input latin lowercase",value:"🔡",encode:"&#x1f521"},{name:"Input latin uppercase",value:"🔠",encode:"&#x1f520"},{name:"Input symbols",value:"🔣",encode:"&#x1f523"},{name:"Play button",value:"▶️",encode:"&#x25b6&#xfe0f"},{name:"Eject button",value:"⏏️",encode:"&#x23cf&#xfe0f"},{name:"Down right arrow",value:"↘️",encode:"&#x2198&#xfe0f"},{name:"Up left arrow",value:"↖️",encode:"&#x2196&#xfe0f"},{name:"Clockwise vertical arrows",value:"🔃",encode:"&#x1f503"},{name:"On arrow",value:"🔛",encode:"&#x1f51b"},{name:"Top arrow",value:"🔝",encode:"&#x1f51d"},{name:"Soon arrow",value:"🔜",encode:"&#x1f51c"},{name:"Ballot box with check",value:"☑️",encode:"&#x2611&#xfe0f"},{name:"End arrow",value:"🔚",encode:"&#x1f51a"},{name:"Back arrow",value:"🔙",encode:"&#x1f519"},{name:"Wavy dash",value:"〰️",encode:"&#x3030&#xfe0f"},{name:"Curly loop",value:"➰",encode:"&#x27b0"},{name:"Heavy check mark",value:"✔️",encode:"&#x2714&#xfe0f"},{name:"Heavy dollar sign",value:"💲",encode:"&#x1f4b2"},{name:"Currency exchange",value:"💱",encode:"&#x1f4b1"},{name:"Heavy plus sign",value:"➕",encode:"&#x2795"},{name:"Heavy minus sign",value:"➖",encode:"&#x2796"},{name:"Heavy multiplication sign",value:"✖️",encode:"&#x2716&#xfe0f"},{name:"Heavy division sign",value:"➗",encode:"&#x2797"},{name:"Copyright",value:"©️",encode:"&#xa9&#xfe0f"},{name:"Registered",value:"®️",encode:"&#xae&#xfe0f"},{name:"Trade mark",value:"™️",encode:"&#x2122&#xfe0f"},{name:"Radio button",value:"🔘",encode:"&#x1f518"},{name:"White circle",value:"⚪",encode:"&#x26aa"},{name:"Black circle",value:"⚫",encode:"&#x26ab"},{name:"Red circle",value:"🔴",encode:"&#x1f534"},{name:"Blue circle",value:"🔵",encode:"&#x1f535"},{name:"Small orange diamond",value:"🔸",encode:"&#x1f538"},{name:"Small blue diamond",value:"🔹",encode:"&#x1f539"},{name:"Large orange diamond",value:"🔶",encode:"&#x1f536"},{name:"Large blue diamond",value:"🔷",encode:"&#x1f537"},{name:"Red triangle pointed up",value:"🔺",encode:"&#x1f53a"},{name:"Red triangle pointed down",value:"🔻",encode:"&#x1f53b"},{name:"Upwards button",value:"🔼",encode:"&#x1f53c"},{name:"Downwards button",value:"🔽",encode:"&#x1f53d"},{name:"Black medium small square",value:"◾",encode:"&#x25fe"},{name:"White medium small square",value:"◽",encode:"&#x25fd"},{name:"Black large square",value:"⬛",encode:"&#x2b1b"},{name:"White large square",value:"⬜",encode:"&#x2b1c"},{name:"Black medium square",value:"◼️",encode:"&#x25fc&#xfe0f"},{name:"White medium square",value:"◻️",encode:"&#x25fb&#xfe0f"},{name:"Black small square",value:"▪️",encode:"&#x25aa&#xfe0f"},{name:"White small square",value:"▫️",encode:"&#x25ab&#xfe0f"},{name:"Black square button",value:"🔳",encode:"&#x1f533"},{name:"White square button",value:"🔲",encode:"&#x1f532"},{name:"Twelve o clock",value:"🕛",encode:"&#x1f55b"},{name:"Twelve thirty",value:"🕧",encode:"&#x1f567"},{name:"One o clock",value:"🕐",encode:"&#x1f550"},{name:"One thirty",value:"🕜",encode:"&#x1f55c"},{name:"Two o clock",value:"🕑",encode:"&#x1f551"},{name:"Two thirty",value:"🕝",encode:"&#x1f55d"},{name:"Three o clock",value:"🕒",encode:"&#x1f552"},{name:"Three thirty",value:"🕞",encode:"&#x1f55e"},{name:"Four o clock",value:"🕓",encode:"&#x1f553"},{name:"Four thirty",value:"🕟",encode:"&#x1f55f"},{name:"Five o clock",value:"🕔",encode:"&#x1f554"},{name:"Five thirty",value:"🕠",encode:"&#x1f560"},{name:"Six o clock",value:"🕕",encode:"&#x1f555"},{name:"Six thirty",value:"🕡",encode:"&#x1f561"},{name:"Seven o clock",value:"🕖",encode:"&#x1f556"},{name:"Seven thirty",value:"🕢",encode:"&#x1f562"},{name:"Eight o clock",value:"🕗",encode:"&#x1f557"},{name:"Eight thirty",value:"🕣",encode:"&#x1f563"},{name:"Nine o clock",value:"🕘",encode:"&#x1f558"},{name:"Nine thirty",value:"🕤",encode:"&#x1f564"},{name:"Ten o clock",value:"🕙",encode:"&#x1f559"},{name:"Ten thirty",value:"🕥",encode:"&#x1f565"},{name:"Eleven o clock",value:"🕚",encode:"&#x1f55a"},{name:"Eleven thirty",value:"🕦",encode:"&#x1f566"}]}]}),ltPropTooltipConfig:Lyte.attr("string",{default:t.tootltipConfig||"{}"}),ltPropSearch:Lyte.attr("boolean",{default:0!=t.search}),ltPropCaseSensitive:Lyte.attr("boolean",{default:t.caseSensitive||!1}),ltPropDiacritic:Lyte.attr("boolean",{default:t.diacritic||!1}),ltPropTrim:Lyte.attr("boolean",{default:t.trim||!1}),ltPropMethod:Lyte.attr("string",{default:t.method||"indexOf"}),ltPropNoMatchText:Lyte.attr("string",{default:t.noMatchText||"No results matched your search"}),ltPropInput:Lyte.attr("object",{default:t.input}),value:Lyte.attr("string",{default:""}),showNoResult:Lyte.attr("boolean",{default:!1})}},init:function(){!this.data.ltPropInput&&this.setData("ltPropInput",{type:"search",placeholder:"Search Emoji",closeIcon:!0,appearance:"box"})},actions:{click:function(t){var e="onEmojiSelect";this.getMethods(e)&&this.executeMethod(e,t)},input:function(t){this.$node.resetValue(t.target.value)},enter:function(t,e){e.setAttribute("lt-prop-title",_lyteUiUtils.i18n(t.toLowerCase().replace(/\s/g,"-"),"emoji",t))}},value_obs:function(t){this.perfromSearch(t.newValue)}.observes("value"),didConnect:function(){this.data.ltPropSearch&&(this.$node.resetValue=function(t){this.$node.scrollTop=0,this.setData("value",t||"")}.bind(this))},perfromSearch:function(t){var e=$L(".lyteEmojiWrapper",this.$node).get(0),i="lyteEmojiHidden",a=this.data.ltPropCaseSensitive,o=this.data.ltPropDiacritic,n=this.data.ltPropMethod,r=this.data.ltPropTrim,s=this,l=0,d=e.children,c=function(t){return a||(t=t.toLowerCase()),o&&(t=_lyteUiUtils.convert_diacritics(t)),r&&(t=t.trim()),t};t=c(t),this.data.ltPropEmoji.forEach((function(e,a){var o,r=d[a],p=0,h=r.children;e.emojis.forEach((function(e,a){var o=$L(h[a]),r=c(e.name),l="remove";s.isNot(r,t,n)&&(l="add",p++),o[l+"Class"](i)})),o=p==h.length,$L(r)[(o?"add":"remove")+"Class"](i),o&&l++})),this.setData("showNoResult",d.length-1==l)},isNot:function(t,e,i){if(t[i])return-1==t[i](e);var a=t.indexOf(e);if("startsWith"==i)return 0!=a;var o=e.length;return a+o!=o}});
