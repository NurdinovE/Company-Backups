store.registerModel("posts",{user:Lyte.attr("object")},{actions:{like:{},retweet:{},deleteposts:{},deleteComments:{},composePost:{}}}),store.registerAdapter("posts",{namespace:"crm/v2/Social/brands/brand_id/network/",buildURL:function(e,t,s,o,r,a,n){return n&&n.streams?(r=r.replace("/brands","").replace("brand_id",n.network).replace("network",n.accountId),n.tweetId&&(r=r.replace("posts/","posts/"+n.tweetId+"/"))):"composePost"===a||"create"===t?r=(r=r.replace("brand_id",n.brandid).replace("network/","")).replace("/actions/composePost",""):n&&(r=r.replace("brand_id",n.brand_id).replace("network",n.network),n.cursor&&(r=r+"&cursor="+encodeURIComponent(n.cursor)),n.like?r+=n.like:n.deletePosts?r=r.replace("actions/deleteposts",n.post_id):n.deleteComments?r=r.replace("actions/deleteComments",n.post_id+"/comments/"+n.comment_id):n.postComments&&(r=r+"/"+n.post_id+"/comments")),"action"!==t||n.streams||"like"!==a&&"retweet"!==a||(r=r.replace("actions",n.post_id)),r},methodForRequest:function(e,t,s,o,r){return"like"===r||"retweet"===r?o.method:"deleteposts"===r||"deleteComments"===r?"DELETE":"composePost"===r?"POST":e}}),store.registerSerializer("posts",{payloadKey:function(){return"posts"},serialize:function(e,t,s,o){if(o.postComments||o.composePost||o.message){var r=new FormData;return r.append("message",o.message),o.networks&&r.append("networks",o.networks),o.file&&(r.append("file",o.file),r.append("fileName",o.fileName)),r}},normalizeResponse:function(e,t,s){var o=s.posts||s.users||s.comments;return s=Array.isArray(o)?{posts:o,meta:s.offset}:{posts:o.data,meta:{cursor:o.cursor}},store.pushPayload("posts",o.data),s},extractMeta:function(e){if(e.meta)return e.meta}});
