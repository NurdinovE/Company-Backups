Lyte.Component.register("crux-combo-box",{_template:'<template tag-name="crux-combo-box"> <lyte-alert lt-prop-wrapper-class="sampleAlert" lt-prop-yield="true" lt-prop="{&quot;buttons&quot; : [{&quot;type&quot;:&quot;accept&quot;,&quot;text&quot;:&quot;Delete&quot;,&quot;appearance&quot;:&quot;failure&quot;},{&quot;type&quot;:&quot;reject&quot;,&quot;text&quot;:&quot;Cancel&quot;,&quot;appearance&quot;:&quot;default&quot;}]}" lt-prop-show="{{deleteAlertShow}}" on-accept="{{method(\'clearData\')}}"> <template is="registerYield" yield-name="alert"> <lyte-alert-content> Changes made have not been saved. Do you want to proceed ? </lyte-alert-content> </template> </lyte-alert> <lyte-modal lt-prop-allow-multiple="{{cxPropAllowMultiple}}" lt-prop-transition="{{cxPropTransition}}" lt-prop-offset="{{cxPropOffset}}" lt-prop-width="{{cxPropWidth}}" lt-prop-show-close-button="false" on-before-show="{{method(\'beforComboBoxOpen\')}}" on-show="{{method(\'onComboxBoxOpen\')}}" on-before-close="{{method(\'BeforeComboBoxClose\')}}" on-close="{{method(\'onComboBoxClosing\')}}" lt-prop-wrapper-class="cxBoxModal {{if(cxPropNeedRecipient,\'cxComboAdditionalRecipientPresent\',\'\')}} {{if(expHandlers(cxPropHeaderMsg,\'!\'),\'cxComboboxWithoutHeader\',\'\')}}" lt-prop-height="{{cxPropHeight}}" lt-prop-max-height="{{cxPropMaxHeight}}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <template is="if" value="{{expHandlers(cxPropHeaderYield,\'!\')}}"><template case="true"> <span class="cxComboxBoxHeader comboxBoxHeader" data-zcqa="combo_box_header_msg">{{cxPropHeaderMsg}}</span> <template is="if" value="{{cxPropShowUserOnly}}"><template case="true"> <span class="cxComboHeaderInfo"> <span class="cxComboboxHeaderInfoIcon"></span> <span class="cxComboHeaderLimitMsg">{{cxPropMaxLimitMsg}}</span> </span> </template></template> <span data-zcqa="combo_box_close" class="comboboxCloseIcon lyteModalClose" onclick="{{action(\'cancelData\')}}"></span> </template><template case="false"> <lyte-yield yield-name="comboBoxHeaderYield"></lyte-yield> </template></template> </lyte-modal-header> <lyte-modal-content class="cxComboBoxContent {{if(cxPropShowUserOnly,\'cxComboboxUserOnlyModalContent\')}}"> <div class="cxFlex cxComboBoxContentInner combo-box-content"> <div class="cxUserSelectionPart user-selection-part"> <div class="cxFlex cxComboLeftColHeadSection"> <div class="user-selection-head cxComboboxSectionHeading crm-font-bold">{{cruxGetI18n(\'crm.label.available\')}}</div> <template is="if" value="{{cxPropShowUserOnly}}"><template case="true"> <lyte-dropdown class="cxComboBoxFilterDD mL10" data-zcqa="combo_box_type" lt-prop-yield="true" lt-prop-tabindex="1" lt-prop-selected="{{setSelectedFilterOption}}" on-option-selected="{{method(\'SelectedFilter\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box> <lyte-drop-body> <template is="if" value="{{expHandlers(cxPropDropdownYield,\'!\')}}"><template case="true"> <template is="for" items="{{cxPropFilterOptions}}" item="item" index="index"> <lyte-drop-item data-zcqa="combo_box_type_{{item[cxPropFilterSystemValue]}}" data-value="{{item[cxPropFilterSystemValue]}}">{{item[cxPropFilterUserValue]}}</lyte-drop-item> </template> </template><template case="false"> <lyte-yield yield-name="comboBoxDropdown"></lyte-yield> </template></template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template></template> </div> <div class="cxUserSelectionContent user-selection-content"> <div class="cxUserDDSearchWrapper dropdown-search-wrapper"> <template is="if" value="{{expHandlers(cxPropShowUserOnly,\'&amp;&amp;\',subFilterOption.length)}}"><template case="true"> <div class="cxUserSelectionOption user-selection-option"> <crux-dropdown id="cxComboSubFilterDD" class="cxComboBoxFilterDD" data-zcqa="combo_box_sub_type" cx-prop-selected="{{subFilterOption[0].id}}" on-option-select="{{method(\'SelectedSubFilter\',this)}}" cx-prop-options="{{subFilterOption}}" cx-prop-maxsearch="10" cx-prop-user-value="{{currentFilterValue.nameSelector}}" cx-prop-system-value="id"></crux-dropdown> </div> </template></template> <template is="if" value="{{expHandlers(cxPropShowUserOnly,\'!\')}}"><template case="true"> <div class="cxUserSelectionOption user-selection-option"> <lyte-dropdown class="cxComboBoxFilterDD" data-zcqa="combo_box_type" lt-prop-yield="true" lt-prop-tabindex="1" lt-prop-selected="{{setSelectedFilterOption}}" on-option-selected="{{method(\'SelectedFilter\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box> <lyte-drop-body> <template is="if" value="{{expHandlers(cxPropDropdownYield,\'!\')}}"><template case="true"> <template is="for" items="{{cxPropFilterOptions}}" item="item" index="index"> <lyte-drop-item data-zcqa="combo_box_type_{{item[cxPropFilterSystemValue]}}" data-value="{{item[cxPropFilterSystemValue]}}">{{item[cxPropFilterUserValue]}}</lyte-drop-item> </template> </template><template case="false"> <lyte-yield yield-name="comboBoxDropdown"></lyte-yield> </template></template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </div> </template></template> <template is="if" value="{{expHandlers(expHandlers(cxPropShowUserOnly,\'!\'),\'||\',expHandlers(cxPropShowUserOnly,\'&amp;&amp;\',expHandlers(subFilterOption.length,\'||\',expHandlers(currentFilterValue.model_name,\'==\',\'user\'))))}}"><template case="true"> <div class="cxUserSearch user-search"> <lyte-input class="cxW100Per cxComboBoxSearch" lt-prop-class="cxComboBoxSearchInput" data-zcqa="combo_box_search" lt-prop-disabled="{{isSearchDisabled}}" lt-prop-type="search" lt-prop-value="{{lbind(cxPropInputValue)}}" lt-prop-placeholder="{{cxPropInputPlaceholder}}" oninput="{{action(\'searchKeyup\',event)}}"></lyte-input> <span data-zcqa="combo_box_search_clear" style="{{if(cxPropInputValue,if(searchLoading,\'display: none\',\'display: block\'),\'display: none\')}}" class="clear-search" onclick="{{action(\'clearInputField\')}}"></span> <span class="cxComboSearchLoader search-loader" style="{{if(cxPropInputValue,if(searchLoading,\'display: block\',\'display: none\'),\'display: none\')}}"></span> </div> </template></template> </div> <div class="cxComboUserWrapper user-lists-container-wrapper"> <div class="clearFix user-lists-container" onscroll="{{action(\'tableScroll\',event)}}"> <div class="search-loader filter-switching-loader" style="{{if(filterChange,\'display:block\',\'display:none\')}};"></div> <div class="{{currentFilterValue.model_name}}-lists"> <ul class="p0 m0 cxSearch-loaderContent " style="{{if(filterChange,\'display:none\',\'\')}};"> <template is="for" items="{{displayContainerData}}" item="item" index="index"> <li data-zcqa="combo-box_list_{{item[containerDataObject.nameSelector]}}" class="cxComboUserList user-list" onclick="{{action(\'addToList\',event,index)}}"> <div class="cxComboUserDetail user-detail"> <template is="if" value="{{expHandlers(containerDataObject.imageSelector,\'!=\',undefined)}}"><template case="true"> <div class="dIB cxVam user-image mR5"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(item[containerDataObject.imageSelector],\'==\',undefined),\'||\',expHandlers(item[containerDataObject.imageSelector],\'==\',null)),\'||\',expHandlers(item[containerDataObject.imageSelector].length,\'==\',0))}}"><template case="true"> <span class="combo-box-nophoto"></span> </template><template case="false"> <img class="cxComboBoxImg" src="{{item[containerDataObject.imageSelector]}}"> </template></template> </div> </template></template> <div class="cxComboUserDescWrap {{if(ifEquals(containerDataObject.imageSelector,undefined),\'\',\'cxComboUserDesc user-desc\')}}"> <template is="if" value="{{expHandlers(containerDataObject.nameSelector,\'!=\',undefined)}}"><template case="true"> <div data-zcqa="cxComboUserNameSel" class="cxComboUserNameSelector" onmouseover="{{action(\'checkForToolTip\',this,item[containerDataObject.nameSelector],item)}}">{{item[containerDataObject.nameSelector]}}</div> </template></template> <template is="if" value="{{expHandlers(containerDataObject.descriptionSelector,\'!=\',undefined)}}"><template case="true"> <div data-zcqa="cxComboUserDescSel" class="cxComboUserDescSelector" onmouseover="{{action(\'checkForToolTip\',this,item[containerDataObject.descriptionSelector])}}">{{item[containerDataObject.descriptionSelector]}}</div> </template></template> </div> </div> <div class="user-add-option"> <template is="if" value="{{expHandlers(selectedUsersList,\'&amp;&amp;\',selectedUsersList[item.id])}}"><template case="true"> <span class="cxComboBoxAddedLabel">Added</span> </template><template case="false"> <lyte-button lt-prop-appearance="primary" lt-prop-class="cxComboBoxAddBtn"> <template is="registerYield" yield-name="text"> {{cruxGetI18n(\'crm.button.add\')}} </template> </lyte-button> </template></template> </div> </li> </template><template is="if" value="{{expHandlers(displayContainerData.length,\'==\',0)}}"><template case="true"> <li class="cxComboBoxEmptyMessage">{{currentFilterValue.cxPropEmptyDataMsg}}</li> </template></template> </ul> <div class="cxComboSearchLoader search-loader mAuto" style="{{if(scrollLoading,\'display:block\',\'display:none\')}};"> </div> </div> </div> </div> </div> </div> <div class="user-selected-part cxUserSelectionPart"> <div class="cxComboUserSelectedHeaderContentWrap"> <div class="user-selected-head cxComboboxSectionHeading">{{cruxGetI18n(\'crm.label.selected\')}}</div> <template is="if" value="{{cxPropTotalRecipientCount.needed}}"><template case="true"> <div class="cxComboboxTotalRecipientCount">{{cxPropTotalRecipientCount.count}} / {{cxPropTotalRecipientCount.total}} {{cruxGetI18n(\'crm.workflow.select.recipients\')}}</div> </template></template> </div> <div class="cxComboUserSelectedContent user-selected-content"> <div class="no-results-found {{if(ifEquals(totalSelectedItemsCount,0),\'no-user-selected-div\',\'emptySelected\')}}"> {{cxPropEmptySelectedMsg}} </div> <div class="cxComboUserSelectedListContainer selected-user-list-container"> <lyte-accordion data-zcqa="combo_box_selected_type" lt-prop-exclusive="false" lt-prop-dynamic="true" on-before-close="{{method(\'preventClose\')}}"> <template is="registerYield" yield-name="yield"> <template is="for" items="{{localOptionModels}}" item="item" index="index"><template is="if" value="{{expHandlers(item.selectedItems.length,\'!=\',0)}}"><template case="true"> <lyte-accordion-item data-zcqa="combo_box_selected_type_{{item.name}}" class="lyteAccordionActive cxComboUserSelectedListSection selected-user-list-section {{if(ifEquals(cruxArithResult(localOptionModels.length,\'-\',1),index),\'selected-user-list-last-section\',\'\')}}"> <lyte-accordion-header class="cxComboboxheader op5_op1_parent"> <div class="dIB cxVam selected-user-type-detail"> <span class="dIB cxVam user-type cxComboboxSelectedHead">{{item.name}}</span> <span class="seperator dIB cxVam">-</span> <span data-zcqa="combo_box_{{item.name}}_count" class="selected-user-count dIB cxVam "> <template is="if" value="{{expHandlers(cxPropShowUserOnly,\'&amp;&amp;\',expHandlers(item.prefix,\'==\',&quot;U&quot;))}}"><template case="true"> {{item.selectedItems[0].users.length}} </template><template case="false"> {{item.selectedItems.length}} </template></template> </span> </div> <lyte-icon class="lyteAccordionArrow op5_op1_child"></lyte-icon> </lyte-accordion-header> <lyte-accordion-body class="cxComboboxAccordionBody"> <template is="if" value="{{cxPropShowUserOnly}}"><template case="true"> <template is="for" items="{{item.selectedItems}}" item="value" index="position"> <template is="if" value="{{expHandlers(cxPropShowUserOnly,\'&amp;&amp;\',expHandlers(item.prefix,\'!=\',&quot;U&quot;))}}"><template case="true"> <div class="dIB cxVam selected-user-type-detail"> <span class="dIB cxVam user-type cxComboboxSelectedHead">{{value.name}}</span> <span class="seperator dIB cxVam">-</span> <span data-zcqa="combo_box_{{item.name}}_{{value.name}}_count" class="cxComboSelectedUserCount selected-user-count dIB cxVam">{{value.users.length}}</span> </div> </template></template> <ul class="p0 m0 selected-user-ul cxComboboxRecipientSelectedList"> <template is="for" items="{{value.users}}" item="user" index="userPosition"> <li data-zcqa="combo-box_selected_list_{{user.name}}" class="cxComboSelectedList selected-user-list"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(userModelsOption.imageSelector,\'!=\',undefined),\'&amp;&amp;\',expHandlers(userModelsOption.imageSelector,\'!=\',null)),\'&amp;&amp;\',expHandlers(userModelsOption.imageSelector.length,\'!=\',0))}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(user.image,\'==\',undefined),\'||\',expHandlers(user.image,\'==\',null)),\'||\',expHandlers(user.image.length,\'==\',0))}}"><template case="true"> <span class="combo-box-nophoto "></span> </template><template case="false"> <span class="dIB cxVam selected-user-img"><img class="cxComboBoxImg" src="{{user.image}}"></span> </template></template> </template></template> <span class="cxEllipsis selected-user-name dIB cxVam" onmouseover="{{action(\'checkForToolTip\',this,user.name)}}">{{user.name}}</span> <span data-zcqa="combo-box_selected_remove_{{user.name}}" class="close-selected-wrap cP op5_op1_parent" onclick="{{action(\'removeFromList\',event,index,position,\'\',value,userPosition,user[userModelsOption.idSelector])}}"> <span class="svgIcons close-selected-user-icon dIB cxVam op5_op1_child"></span> </span> </li> </template> </ul> </template> </template><template case="false"> <ul class="p0 m0 selected-user-ul cxComboboxRecipientSelectedList"> <template is="for" items="{{item.selectedItems}}" item="value" index="position"> <li data-zcqa="combo-box_selected_list_{{value.name}}" class="cxComboSelectedList selected-user-list"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(item.imageSelector,\'!=\',undefined),\'&amp;&amp;\',expHandlers(item.imageSelector,\'!=\',null)),\'&amp;&amp;\',expHandlers(item.imageSelector.length,\'!=\',0))}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(value.image,\'==\',undefined),\'||\',expHandlers(value.image,\'==\',null)),\'||\',expHandlers(value.image.length,\'==\',0))}}"><template case="true"> <span class="combo-box-nophoto "></span> </template><template case="false"> <span class="dIB cxVam selected-user-img"><img class="cxComboBoxImg" src="{{value.image}}"></span> </template></template> </template></template> <span class="cxEllipsis selected-user-name dIB cxVam" onmouseover="{{action(\'checkForToolTip\',this,value.name)}}">{{value.name}}</span> <span data-zcqa="combo-box_selected_remove_{{value.name}}" class="close-selected-wrap cP op5_op1_parent" onclick="{{action(\'removeFromList\',event,index,position)}}"> <span class="svgIcons close-selected-user-icon dIB cxVam op5_op1_child"></span> </span> </li> </template> </ul> </template></template> </lyte-accordion-body> </lyte-accordion-item> </template></template></template> </template> </lyte-accordion> </div> </div> </div> </div> </lyte-modal-content> <lyte-modal-footer class="{{if(cxPropFooterYield,\'\',\'right cxComboBoxFooter\')}}"> <div class="cxComboRecipientWrapper"> <template is="if" value="{{expHandlers(expHandlers(showAddRecipient,\'||\',expHandlers(cxPropSelectedTags.length,\'>\',0)),\'||\',expHandlers(cxPropShowUserOnly,\'&amp;&amp;\',cxPropNeedRecipient))}}"><template case="true"> <div class="cxComboRecipientWrap"> <div class="cxFlex cxComboboxRecipientHeadArea"> <div class="cxComboRecipient"> <span class="dIB cxVam">{{cxPropRecipient.key}}</span> <template is="if" value="{{expHandlers(cxPropRecipient.tags.length,\'>=\',1)}}"><template case="true"> <span class="cxComboRecipientSep seperator dIB cxVam">-</span> <span data-zcqa="combo_box_{{cxPropRecipient.key}}_count" class="cxComboSelUserCount selected-user-count">{{cxPropRecipient.tags.length}}</span> </template></template> </div> <template is="if" value="{{cxPropShowUserOnly}}"><template case="true"> <lyte-button class="cxComboBtnUserOnly mlAuto" data-zcqa="combo_box_add_recipient" onclick="{{action(\'showAddRecipient\',param)}}" lt-prop-class="outlineprimary"> <template is="registerYield" yield-name="text">{{cruxGetI18n("crm.button.add")}}</template> </lyte-button> </template><template case="false"><template is="if" value="{{expHandlers(showAddRecipient,\'!\')}}"><template case="true"> <lyte-button class="cxComboBtnUserOnly mlAuto" data-zcqa="combo_box_add_recipient" onclick="{{action(\'showAddRecipient\')}}" lt-prop-class="outlineprimary"> <template is="registerYield" yield-name="text">{{cruxGetI18n("crm.button.add")}}</template> </lyte-button> </template><template case="false"> <span class="cxComboRecipientPlaceholder">{{cruxGetI18n(\'crm.workflow.alert.type.otherEmails\')}}</span> </template></template></template></template> </div> <template is="if" value="{{showAddRecipient}}"><template case="true"> <template is="if" value="{{expHandlers(cxPropRecipient.tags.length,\'>=\',1)}}"><template case="true"> <crux-tag id="tagComp" cx-prop-allow-dropdown="false" cx-prop-tags="{{cruxClone(cxPropRecipient.tags)}}" on-add-tag="{{method(\'validateTag\')}}" on-before-add-tag="{{method(\'onBeforeTag\')}}" on-remove-tag="{{method(\'removeTagFromList\')}}" cx-prop-input-placeholder="{{cruxGetI18n(\'crm.inv.label.add.emails\')}}" cx-prop-comma-seperation="true" cx-prop-max-tag-length="{{cxPropTagLengthLimit}}" onkeydown="{{action(\'checkForLimit\',event)}}" on-error="{{method(&quot;showAlertMessage&quot;)}}" cx-prop-color-tags="false"></crux-tag> </template><template case="false"> <crux-tag id="tagComp" cx-prop-input-placeholder="{{cruxGetI18n(\'crm.inv.label.add.emails\')}}" cx-prop-allow-dropdown="false" on-before-add-tag="{{method(\'onBeforeTag\')}}" on-add-tag="{{method(\'validateTag\')}}" on-remove-tag="{{method(\'removeTagFromList\')}}" cx-prop-comma-seperation="true" cx-prop-max-tag-length="{{cxPropTagLengthLimit}}" onkeydown="{{action(&quot;checkForLimit&quot;,event)}}" on-error="{{method(&quot;showAlertMessage&quot;)}}" cx-prop-color-tags="false"></crux-tag> </template></template> </template><template case="false"> <template is="if" value="{{expHandlers(cxPropSelectedTags.length,\'==\',0)}}"><template case="true"> <ul class="selected-user-ul cxComboboxRecipientSelectedList cxComboboxNoRecipientUl"></ul> </template><template case="false"> <ul class="selected-user-ul cxComboboxRecipientSelectedList"> <template is="for" items="{{cxPropRecipient.tags}}" item="tag" index="position"> <li data-zcqa="combo-box_selected_list_{{value.name}}" class="cxComboSelectedList selected-user-list"> <span class="cxEllipsis selected-user-name dIB cxVam" onmouseover="{{action(\'checkForToolTip\',this,tag.name)}}">{{tag.name}}</span> <span data-zcqa="combo-box_close_icon" class="close-selected-wrap cP op5_op1_parent" onclick="{{action(\'removeFromList\',event,index,position,\'Recipient\')}}"> <span class="svgIcons close-selected-user-icon dIB cxVam op5_op1_child"></span> </span> </li> </template> </ul> </template></template> </template></template> </div> </template></template> </div> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(cxPropShowUserOnly,\'!\'),\'&amp;&amp;\',cxPropNeedRecipient),\'&amp;&amp;\',expHandlers(expHandlers(cxPropRecipient.tags,\'&amp;&amp;\',expHandlers(cxPropRecipient.tags.length,\'===\',0)),\'||\',expHandlers(cxPropRecipient.tags,\'!\'))),\'&amp;&amp;\',expHandlers(showAddRecipient,\'!\'))}}"><template case="true"> <lyte-button data-zcqa="combo_box_add_recipient" onclick="{{action(\'showAddRecipient\',param)}}" lt-prop-class="outlineprimary"> <template is="registerYield" yield-name="text">{{cruxGetI18n("crm.recipient.add.recipient")}}</template> </lyte-button> </template></template> <template is="if" value="{{expHandlers(cxPropFooterYield,\'!\')}}"><template case="true"> <lyte-button class="mlAuto" onclick="{{action(\'cancelData\')}}" data-zcqa="combo_box_cancel"> <template is="registerYield" yield-name="text">{{cruxGetI18n(\'crm.button.cancel\')}}</template> </lyte-button> <lyte-button data-zcqa="combo_box_save" lt-prop-id="cruxComboBoxSaveButton" lt-prop-disabled="true" lt-prop-appearance="primary" onclick="{{action(\'saveData\')}}"> <template is="registerYield" yield-name="text">{{cruxGetI18n(\'crm.button.save\')}}</template> </lyte-button> </template><template case="false"> <lyte-yield yield-name="comboBoxFooterYield"></lyte-yield> </template></template> </lyte-modal-footer> </template> </lyte-modal> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"text",position:[1,3,0]}]}},default:{}},{type:"attr",position:[5]}]},false:{dynamicNodes:[{type:"insertYield",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"text",position:[3,1,1,1,1,0]},{type:"attr",position:[3,1,1,1,3]},{type:"if",position:[3,1,1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}]},false:{dynamicNodes:[{type:"insertYield",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3,1,1,3,1,1]},{type:"if",position:[3,1,1,3,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"attr",position:[3,1,1,3,1,3]},{type:"if",position:[3,1,1,3,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}]},false:{dynamicNodes:[{type:"insertYield",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"attr",position:[3,1,1,3,1,5]},{type:"if",position:[3,1,1,3,1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3],attr:{style:{name:"style",helperInfo:{name:"if",args:["cxPropInputValue",{type:"helper",value:{name:"if",args:["searchLoading","'display: none'","'display: block'"]}},"'display: none'"]}}}},{type:"attr",position:[1,5],attr:{style:{name:"style",helperInfo:{name:"if",args:["cxPropInputValue",{type:"helper",value:{name:"if",args:["searchLoading","'display: block'","'display: none'"]}},"'display: none'"]}}}}]}},default:{}},{type:"attr",position:[3,1,1,3,3,1]},{type:"attr",position:[3,1,1,3,3,1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["''",{type:"helper",value:{name:"if",args:["filterChange","'display:block'","'display:none'"]}},"';'"]}}}},{type:"attr",position:[3,1,1,3,3,1,3]},{type:"attr",position:[3,1,1,3,3,1,3,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["''",{type:"helper",value:{name:"if",args:["filterChange","'display:none'","''"]}},"';'"]}}}},{type:"attr",position:[3,1,1,3,3,1,3,1,1]},{type:"for",position:[3,1,1,3,3,1,3,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,3]},{type:"attr",position:[1,1,3,1]},{type:"if",position:[1,1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[1,1,3,3]},{type:"if",position:[1,1,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},{type:"attr",position:[3,1,1,3,3,1,3,1,2]},{type:"if",position:[3,1,1,3,3,1,3,1,2],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[3,1,1,3,3,1,3,3],attr:{style:{name:"style",helperInfo:{name:"concat",args:["''",{type:"helper",value:{name:"if",args:["scrollLoading","'display:block'","'display:none'"]}},"';'"]}}}},{type:"text",position:[3,1,3,1,1,0]},{type:"attr",position:[3,1,3,1,3]},{type:"if",position:[3,1,3,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"text",position:[1,2]},{type:"text",position:[1,4]}]}},default:{}},{type:"attr",position:[3,1,3,3,1]},{type:"text",position:[3,1,3,3,1,1]},{type:"attr",position:[3,1,3,3,3,1]},{type:"registerYield",position:[3,1,3,3,3,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1,1,0]},{type:"attr",position:[1,1,1,5]},{type:"attr",position:[1,1,1,5,1]},{type:"if",position:[1,1,1,5,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,1,3]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,5]},{type:"text",position:[1,5,0]}]}},default:{}},{type:"attr",position:[3,1]},{type:"for",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[1,0]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"attr",position:[1,5]}]}]}]},false:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[1,0]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"attr",position:[1,5]}]}]}},default:{}},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]}},default:{}}]}]},{type:"componentDynamic",position:[3,1,3,3,3,1]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5]},{type:"attr",position:[5,1,1]},{type:"if",position:[5,1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,1,1,0]},{type:"attr",position:[1,1,1,3]},{type:"if",position:[1,1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[3]},{type:"text",position:[3,0]}]}},default:{}},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]}]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[5,3]},{type:"if",position:[5,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[5,5]},{type:"if",position:[5,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"insertYield",position:[1]}]}},default:{}},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[3]}],_observedAttributes:["currentlyExcludedArray","cxPropFooterYield","cxPropHeaderYield","cxPropInputPlaceholder","preventSetValues","saveClosing","initialSelected","totalList","totalListPosition","preventFutherRequest","stopScrolling","preventShowCalling","setScrolling","cxPropDropdownYield","cxPropQueryParams","isSearch","clearField","searchLoading","scrollLoading","filterChange","render","splitRecords","cxPropSelectedPerPage","cxPropSelected","localSelected","displayContainerData","localOptionModels","defaultOptionModels","localClose","totalSelectedItemsCount","perPageValue","pageNoValue","searchNonPaginationData","cxPropEmptySelectedMsg","cxPropEmptyDataMsg","cxPropMaxLimit","cxPropMaxLimitMsg","alertMessage","cxPropPrimaryKey","cxPropNetworkData","systemData","localData","cxPropExclude","cxPropRecords","cxPropPerPage","cxPropInputValue","cxPropMinLength","currentPos","pageNo","noMoreRecords","cxPropCustomRequest","cxPropFilterUserValue","cxPropFilterSystemValue","cxPropSelectedFilterOption","setSelectedFilterOption","currentFilterValue","cxPropFilterOptions","cxPropHeaderMsg","cxPropNoResultMsg","cxPropShow","cxPropIdSelector","cxPropNameSelector","cxPropImageSelector","cxPropDescriptionSelector","cxPropSearchAction","cxPropOptionModels","cxPropInputValue","selectedItems","selectedOption","cxPropDropboxFooterYield","cxPropStyle","calledWithIn","cxPropDeletedList","observerDelList","cxPropNewSelectedList","cxPropAllowMultiple","cxPropWidth","cxPropCustomPagination","cxPropNoMoreData","preventSetOfNoMoreData","cxPropDisableSearch","isSearchDisabled","cxPropRecipient","showAddRecipient","localRecipient","cxPropSelectedTags","showAlertMessage","messageType","deleteAlertShow","cxPropNeedRecipient","cxPropTagLimit","messageBoxType","cxPropMaxLimitDuration","cxPropTagLengthLimit","cxPropTotalRecipientCount","cxPropShowUserOnly","subFilterOption","userModelsOption","containerDataObject","selectedUsersList","cxPropTransition","cxPropOffset"],data:function(){return{currentlyExcludedArray:Lyte.attr("array",{default:[]}),cxPropFooterYield:Lyte.attr("boolean",{default:!1}),cxPropHeaderYield:Lyte.attr("boolean",{default:!1}),cxPropInputPlaceholder:Lyte.attr("string",{default:_cruxUtils.getI18n("crm.globalsearch.search.title")}),preventSetValues:Lyte.attr("boolean",{default:!1}),saveClosing:Lyte.attr("boolean",{default:!1}),initialSelected:Lyte.attr("array",{default:[]}),totalList:Lyte.attr("array",{default:[]}),totalListPosition:Lyte.attr("array",{default:[]}),preventFutherRequest:Lyte.attr("boolean",{default:!1}),stopScrolling:Lyte.attr("boolean",{default:!1}),preventShowCalling:Lyte.attr("boolean",{default:!1}),setScrolling:Lyte.attr("boolean",{default:!1}),cxPropDropdownYield:Lyte.attr("boolean",{default:!1}),cxPropQueryParams:Lyte.attr("object",{default:{}}),isSearch:Lyte.attr("boolean",{default:!1}),clearField:Lyte.attr("boolean",{default:!1}),searchLoading:Lyte.attr("boolean",{default:!1}),scrollLoading:Lyte.attr("boolean",{default:!1}),filterChange:Lyte.attr("boolean",{default:!1}),render:Lyte.attr("boolean",{default:!0}),splitRecords:Lyte.attr("number",{default:0}),cxPropSelectedPerPage:Lyte.attr("number",{default:100}),cxPropSelected:Lyte.attr("array",{default:[]}),localSelected:Lyte.attr("array",{default:[]}),displayContainerData:Lyte.attr("array",{default:[]}),localOptionModels:Lyte.attr("array",{default:[]}),defaultOptionModels:Lyte.attr("array"),localClose:Lyte.attr("boolean",{default:!1}),totalSelectedItemsCount:Lyte.attr("number",{default:0}),perPageValue:Lyte.attr("number"),pageNoValue:Lyte.attr("number"),searchNonPaginationData:Lyte.attr("array",{default:[]}),cxPropEmptySelectedMsg:Lyte.attr("string",{default:_cruxUtils.getI18n("crm.template.listview.search.no.results")}),cxPropEmptyDataMsg:Lyte.attr("string",{default:""}),cxPropMaxLimit:Lyte.attr("number",{default:100}),cxPropMaxLimitMsg:Lyte.attr("string",{default:""}),alertMessage:Lyte.attr("string",{default:""}),cxPropPrimaryKey:Lyte.attr("string",{default:""}),cxPropNetworkData:Lyte.attr("object",{default:{cxPropModuleName:"",cxPropCacheQuery:!0,cxPropDataCache:!1}}),systemData:Lyte.attr("array",{default:[]}),localData:Lyte.attr("array",{default:[]}),cxPropExclude:Lyte.attr("array",{default:[]}),cxPropRecords:Lyte.attr("number",{default:20}),cxPropPerPage:Lyte.attr("number",{default:200}),cxPropInputValue:Lyte.attr("string",{default:""}),cxPropMinLength:Lyte.attr("number",{default:1}),currentPos:Lyte.attr("number",{default:0}),pageNo:Lyte.attr("number",{default:1}),noMoreRecords:Lyte.attr("boolean",{default:!0}),cxPropCustomRequest:Lyte.attr("boolean",{default:!1}),cxPropFilterUserValue:Lyte.attr("string",{default:"name"}),cxPropFilterSystemValue:Lyte.attr("string",{default:"prefix"}),cxPropSelectedFilterOption:Lyte.attr("string",{default:""}),setSelectedFilterOption:Lyte.attr("string",{default:""}),currentFilterValue:Lyte.attr("object",{default:{}}),cxPropFilterOptions:Lyte.attr("array",{default:[]}),cxPropHeaderMsg:Lyte.attr("string",{default:""}),cxPropNoResultMsg:Lyte.attr("string",{default:"No Results Found"}),cxPropShow:Lyte.attr("boolean",{default:!1}),cxPropIdSelector:Lyte.attr("string"),cxPropNameSelector:Lyte.attr("string"),cxPropImageSelector:Lyte.attr("string"),cxPropDescriptionSelector:Lyte.attr("string"),cxPropSearchAction:Lyte.attr("boolean",{default:!1}),cxPropOptionModels:Lyte.attr("array"),cxPropInputValue:Lyte.attr("string",{default:""}),selectedItems:Lyte.attr("array",{default:[]}),selectedOption:Lyte.attr("string",{default:"0"}),cxPropDropboxFooterYield:Lyte.attr("boolean",{default:!1}),cxPropStyle:Lyte.attr("string"),calledWithIn:Lyte.attr("boolean",{default:!1}),cxPropDeletedList:Lyte.attr("array",{default:[]}),observerDelList:Lyte.attr("array",{default:[]}),cxPropNewSelectedList:Lyte.attr("array",{default:[]}),cxPropAllowMultiple:Lyte.attr("boolean",{default:!1}),cxPropWidth:Lyte.attr("string",{default:"1090px"}),cxPropCustomPagination:Lyte.attr("boolean",{default:!1}),cxPropNoMoreData:Lyte.attr("boolean",{default:!1}),preventSetOfNoMoreData:Lyte.attr("boolean",{default:!1}),cxPropDisableSearch:Lyte.attr("boolean",{default:!1}),isSearchDisabled:Lyte.attr("boolean"),cxPropRecipient:Lyte.attr("object",{default:{}}),showAddRecipient:Lyte.attr("boolean",{default:!1}),localRecipient:Lyte.attr("array",{default:[]}),cxPropSelectedTags:Lyte.attr("array",{default:[]}),showAlertMessage:Lyte.attr("boolean",{default:!1}),messageType:Lyte.attr("string",{default:""}),deleteAlertShow:Lyte.attr("boolean",{default:!1}),cxPropNeedRecipient:Lyte.attr("boolean",{default:!1}),cxPropTagLimit:Lyte.attr("number",{default:15}),messageBoxType:Lyte.attr("string",{default:"info"}),cxPropMaxLimitDuration:Lyte.attr("string",{default:"2000"}),cxPropTagLengthLimit:Lyte.attr("number",{default:10}),cxPropTotalRecipientCount:Lyte.attr("object",{default:{count:0,total:50,needed:!1}}),cxPropShowUserOnly:Lyte.attr("boolean",{default:!1}),subFilterOption:Lyte.attr("array",{default:[]}),userModelsOption:Lyte.attr("object",{default:{}}),containerDataObject:Lyte.attr("object",{default:{}}),selectedUsersList:Lyte.attr("object",{default:{}}),cxPropTransition:Lyte.attr("object",{default:{animation:"slideFromTop",duration:"0.5"}}),cxPropOffset:Lyte.attr("object",{default:{top:"0px",left:"center"}})}},didDestroy:function(){for(var t=this.getData("cxPropOptionModels"),e=0;e<t.length;e++)if(1==t[e].pagination){var a=this.setCriteria(t[e]);a.per_page=this.data.cxPropPerPage,a.page=1,store.clearCachedQuery(t[e].model_name,a)}else t[e].pagination||t[e].cxPropOptions||store.clearCachedQuery(t[e].model_name,this.customCacheQueryObject[t[e].prefix]);delete this.bodydrop},showToogle:function(){this.getData("preventShowCalling")?this.setData("preventShowCalling",!1):this.getData("cxPropShow")?this.$node.querySelector("lyte-modal").ltProp("show",!0):this.$node.querySelector("lyte-modal").ltProp("show",!1)}.observes("cxPropShow").on("didConnect"),setNoMoreData:function(){this.getData("preventSetOfNoMoreData")?this.setData("preventSetOfNoMoreData",!1):this.setData("noMoreRecords",!this.getData("cxPropNoMoreData"))}.observes("cxPropNoMoreData"),recipientObserve:function(){this.setData("cxPropRecipient",this.getData("cxPropRecipient")),this.setData("cxPropInitialtags",[]),this.assignDatas()}.observes("cxPropRecipient.tags.[]"),obsForSelectedData:function(){!this.preventSelObs&&this.data.cxPropShow&&this.data.cxPropShowUserOnly&&this.preSelectedHandeling("observer")}.observes("cxPropSelected.[]"),preSelectedHandeling:function(t){var e,a=[],o=!1,s=this.getData("cxPropSelected")?this.getData("cxPropSelected"):[];this.setData("totalSelectedItemsCount",0);if(this.data.cxPropShowUserOnly){for(var i=0;i<this.getData("localOptionModels").length;i++){var r,l=this.getData("localOptionModels")[i],n=s.filter((function(t){return t.prefix==l.prefix})),c=[];n.forEach(function(t){this.data.selectedUsersList[t.user.id]||(t.id=t[l.singular_name].id,t.name=t[l.singular_name].name,t.user.image=t.user[this.data.userModelsOption.imageSelector],isDataAvail=c.filter((function(e){return e.id==t[l.singular_name].id}))[0],l.prefix==this.data.userModelsOption.prefix?(isDataAvail=c.filter((function(t){return t.id==l.singular_name}))[0],r=isDataAvail||{type:l.model_name,prefix:l.prefix,id:l.singular_name,name:l.name,users:[t.user]}):r={type:l.model_name,prefix:t.prefix,id:t.id,name:t.name,users:[t.user]},isDataAvail?isDataAvail.users.push(t.user):c.push(r),Lyte.objectUtils(this.data.selectedUsersList,"add",t.user.id,t))}.bind(this)),Lyte.arrayUtils(this.getData("localOptionModels")[i].selectedItems,"concat",c),this.setData("totalSelectedItemsCount",this.getData("totalSelectedItemsCount")+n.length)}"observer"===t&&this.resetDisplayArray(this.getData("currentFilterValue"))}else for(i=0;i<this.getData("localOptionModels").length;i++){this.setData("splitRecords",0);for(var p=[],d=[],u=0;u<s.length;u++)if(s[u].prefix==this.getData("localOptionModels")[i].prefix)if(null!=this.getData("localOptionModels")[i].cxPropOptions){for(var h=0;h<this.getData("localOptionModels")[i].cxPropOptions.length;h++)if(this.getData("localOptionModels")[i].cxPropOptions[h].id==s[u].id){var m=this.getData("localOptionModels")[i];Lyte.arrayUtils(d,"push",{type:m.model_name,name:m.cxPropOptions[h][m.nameSelector],id:m.cxPropOptions[h][m.idSelector],prefix:m.prefix,image:m.cxPropOptions[h][m.imageSelector]})}}else null!=s[u].id&&null!=s[u].name&&(null!=this.getData("localOptionModels")[i].imageSelector&&null!=s[u].image||null==this.getData("localOptionModels")[i].imageSelector)?Lyte.arrayUtils(d,"push",s[u]):Lyte.arrayUtils(p,"push",s[u].id);for(Lyte.arrayUtils(this.getData("localOptionModels")[i].selectedItems,"concat",d),this.setData("totalSelectedItemsCount",this.getData("totalSelectedItemsCount")+d.length);this.getData("splitRecords")<p.length;){var x=p.slice(this.getData("splitRecords"),this.getData("splitRecords")+this.getData("cxPropSelectedPerPage"));this.setData("splitRecords",this.getData("splitRecords")+this.getData("cxPropSelectedPerPage")),a.push(x),e=i,o=!0}o&&(this.getData("totalList").push(a),this.getData("totalListPosition").push(e),a=[],o=!1)}"observer"!==t&&this.requestData.call(this)},customReqFunc:function(t,e,a){if(this.getData("currentFilterValue").inbuildCustomSubReq)return new Promise(function(t,o){store.triggerAction("user","get_assigned",e).then(function(e){t(e)}.bind(this),function(t){a&&(this.errorOnSearch&&("userLookup"!=type&&(this.setData("searchLoading",!1),this.setData("scrollLoading",!1),this.setData("systemData",[])),this.errorOnSearch()),(0,console.error)(t),this.setData("multiScroll",!1))}.bind(this))}.bind(this));if(this.data.cxPropShowUserOnly&&this.getMethods("onCustomRequest"))return o=this.executeMethod("onCustomRequest",t,e,this.getData("isSearch"),this.getData("cxPropInputValue"),this.getData("currentFilterValue"),this.data.subFilterSelected);if(this.getMethods("onCustomRequest")){if(this.getData("currentFilterValue").pagination)var o=this.executeMethod("onCustomRequest",t,e,this.getData("isSearch"),this.getData("cxPropInputValue"),this.getData("currentFilterValue"));else o=this.executeMethod("onCustomRequest",t,e,this.getData("currentFilterValue"));return o}},requestData:function(){for(var t=!0,e=0;e<this.getData("localOptionModels").length;e++)this.getData("localOptionModels")[e].prefix==this.getData("cxPropSelectedFilterOption")&&null!=this.getData("localOptionModels")[e].cxPropOptions&&(this.setData("localData",this.getData("localOptionModels")[e].cxPropOptions),0==this.getData("localOptionModels")[e].cxPropOptions.length&&(t=!1));var a,o=[],s=this.getData("totalList"),i=this.getData("totalListPosition");if(this.data.cxPropShowUserOnly&&"user"!=this.data.currentFilterValue.model_name){var r=this.data.cxPropNetworkData;o=store.findAll(r.cxPropModuleName,{},r.cxPropCacheQuery,!0,r.cxPropCustomData)}Lyte.resolvePromises(o).then(function(e){if(e&&(e[this.data.currentFilterValue.model_name]||e.length)){e=e[this.data.currentFilterValue.model_name]?e[this.data.currentFilterValue.model_name]:e,this.setData("subFilterOption",e),this.setData("subFilterSelected",e[0]),this.setData("containerDataObject",this.data.userModelsOption);var r={cxPropModuleName:this.data.userModelsOption.model_name,cxPropCacheQuery:!0,cxPropDataCache:!0,cxPropRecordId:e[0].id};this.setData("cxPropNetworkData",r)}else this.setData("containerDataObject",this.data.currentFilterValue);if(null==this.getData("currentFilterValue").cxPropOptions||0!=s.length){if(t){a=1,this.setData("preventSetValues",!0),o=[this.constructArray.call(this,"comboBox",!1)];for(var l=0;l<s.length;l++)for(var n=0;n<s[l].length;n++){var c={ids:s[l][n].join(",")},p=this.getData("localOptionModels")[i[l]].selectedQueryParams;if(Object.keys(p).length)for(var d in p)c[d]=p[d];o.push(store.findAll(this.getData("localOptionModels")[i[l]].model_name,c,!1,!1))}}else{a=0;for(l=0;l<s.length;l++){c={ids:s[l].join(",")},p=this.getData("localOptionModels")[i[l]].selectedQueryParams;if(Object.keys(p).length)for(var d in p)c[d]=p[d];o.push(store.findAll(this.getData("localOptionModels")[i[l]].model_name,c,!1,!1))}}Lyte.resolvePromises(o).then(function(t){if(this.data.cxPropShowUserOnly){this.resetDisplayArray(this.getData("currentFilterValue")),this.bodydrop.querySelector("lyte-dropdown").ltProp("disabled",!1);for(var e=[],o=(x=this.getData("localOptionModels")).length,s=0;s<o;s++){for(var i=x[s].selectedItems.length,r=[],l=0;l<i;l++)r.push(x[s].selectedItems[l]);e.push({prefix:x[s].prefix,selectedItems:r})}this.setData("observerDelList",e)}else{for(var n,c=0,p=this.getData("totalList"),d=this.getData("totalListPosition"),u=0;u<p.length;u++){n=[];for(l=0;l<p[u].length;l++)t[l+a+c][this.getData("localOptionModels")[d[u]].model_name]&&(n=n.concat(t[l+a+c][this.getData("localOptionModels")[d[u]].model_name]));c+=p[u].length;for(var h=[],m=0;m<n.length;m++)Lyte.arrayUtils(this.getData("localOptionModels")[d[u]].selectedItems,"push",{type:this.getData("localOptionModels")[d[u]].model_name,name:n[m][this.getData("localOptionModels")[d[u]].nameSelector],id:n[m][this.getData("localOptionModels")[d[u]].idSelector],prefix:this.getData("localOptionModels")[d[u]].prefix,image:n[m][this.getData("localOptionModels")[d[u]].imageSelector]}),this.getData("currentFilterValue").prefix==this.getData("localOptionModels")[d[u]].prefix&&h.push(n[m][this.getData("localOptionModels")[d[u]].idSelector]);this.setData("totalSelectedItemsCount",this.getData("totalSelectedItemsCount")+this.getData("localOptionModels")[d[u]].selectedItems.length)}this.resetDisplayArray(this.getData("currentFilterValue")),this.bodydrop.querySelector("lyte-dropdown").ltProp("disabled",!1);var x;for(e=[],o=(x=this.getData("localOptionModels")).length,s=0;s<o;s++){for(i=x[s].selectedItems.length,r=[],l=0;l<i;l++)r.push(x[s].selectedItems[l]);e.push({prefix:x[s].prefix,selectedItems:r})}this.setData("observerDelList",e)}}.bind(this))}else t?(this.constructArray.call(this,"comboBox",!1),this.bodydrop.querySelector("lyte-dropdown").ltProp("disabled",!1)):this.bodydrop.querySelector("lyte-dropdown").ltProp("disabled",!1);this.afterRequestSetOptionsProvideCase()}.bind(this))},resetDisplayArray:function(t){var e,a;this.setData("preventSetValues",!1);var o=this.getData("systemData"),s=t.selectedItems;if(this.data.cxPropShowUserOnly){t=this.data.userModelsOption;var i=[];s.forEach((function(t){t.users&&(i=i.concat(t.users))})),s=i}var r=[];for(e=0;e<o.length;e++)for(Lyte.arrayUtils(r,"push",o[e]),a=0;a<s.length;a++)o[e][t.idSelector]==s[a][t.idSelector]&&Lyte.arrayUtils(r,"pop");this.setData("displayContainerData",r),$L.fastdom.mutate((function(){0!=o.length&&$L.fastdom.measure((function(){(this.getData("noMoreRecords")||this.getData("systemData").length<this.getData("localData").length)&&this.checkEndOfSelection()}),this)}),this)},assignDatas:function(){var t=this.getData("cxPropRecipient");this.setData("cxPropSelectedTags",[]);var e=this.getData("cxPropRecipient.key")?this.getData("cxPropRecipient.key"):_cruxUtils.getI18n("crm.workflow.alert.additional.recipients");if(this.setData("cxPropRecipient.key",e),t.tags&&t.tags.length>0){for(var a=[],o=0;o<t.tags.length;o++)t.tags[o].name&&(a.push(t.tags[o].name),Lyte.arrayUtils(this.getData("cxPropSelectedTags"),"push",t.tags[o]));var s=$L(".cxComboboxRecipientSelectedList")[0];s&&(s.scrollTop=s.scrollHeight-s.clientHeight)}},init:function(){for(var t=this.getData("cxPropOptionModels"),e={},a=0;a<t.length;a++)e[t[a].prefix]="cxComboBox_"+t[a].prefix+"_filter";this.customCacheQueryObject=e,this.assignDatas()},didConnect:function(){this.setData("perPageValue",this.getData("cxPropPerPage")),this.setData("pageNoValue",this.getData("pageNo"))},comboBoxOpen:function(){this.getData("cxPropDisableSearch")&&this.setData("isSearchDisabled",!0),this.setData({selectedUsersList:{},subFilterOption:[]});for(var t=[],e={},a=[],o=this.getData("cxPropOptionModels"),s=0;s<o.length;s++)a[s]={prefix:o[s].prefix,name:o[s].name};this.setData("cxPropFilterOptions",a),""==this.getData("cxPropSelectedFilterOption")&&this.setData("cxPropSelectedFilterOption",this.getData("cxPropOptionModels")[0].prefix),this.setData("setSelectedFilterOption",this.getData("cxPropSelectedFilterOption").slice());for(s=0;s<o.length;s++){var i={};Lyte.Component.set(i,"model_name",o[s].model_name),Lyte.Component.set(i,"pagination",!!this.data.cxPropShowUserOnly||o[s].pagination),Lyte.Component.set(i,"name",o[s].name),Lyte.Component.set(i,"singular_name",o[s].singular_name?o[s].singular_name:o[s].name.toLowerCase().slice(0,-1)),Lyte.Component.set(i,"prefix",o[s].prefix),Lyte.Component.set(i,"cxPropEmptyDataMsg",o[s].cxPropEmptyDataMsg),Lyte.Component.set(i,"nameSelector",o[s].nameSelector),null==o[s].disableSearch?Lyte.Component.set(i,"disableSearch",!1):Lyte.Component.set(i,"disableSearch",o[s].disableSearch),null==o[s].customPagination?Lyte.Component.set(i,"customPagination",!1):Lyte.Component.set(i,"customPagination",o[s].customPagination),null==o[s].idSelector?(this.setData("cxPropPrimaryKey",store.getPrimaryKey(o[s].model_name)),Lyte.Component.set(i,"idSelector",this.getData("cxPropPrimaryKey"))):Lyte.Component.set(i,"idSelector",o[s].idSelector),null!=o[s].descriptionSelector&&Lyte.Component.set(i,"descriptionSelector",o[s].descriptionSelector),null!=o[s].imageSelector&&Lyte.Component.set(i,"imageSelector",o[s].imageSelector),null!=o[s].cxPropQueryParams&&Lyte.Component.set(i,"cxPropQueryParams",o[s].cxPropQueryParams),null!=o[s].cxPropExclude&&Lyte.Component.set(i,"cxPropExclude",o[s].cxPropExclude),null!=o[s].cxPropOptions&&Lyte.Component.set(i,"cxPropOptions",o[s].cxPropOptions),this.defaultCustom=!1,null!=o[s].cxPropCustomRequest?(Lyte.Component.set(i,"cxPropCustomRequest",o[s].cxPropCustomRequest),o[s].cxPropCustomRequest&&(this.defaultCustom=!0)):(Lyte.Component.set(i,"cxPropCustomRequest",!1),this.data.cxPropShowUserOnly&&"user"!=o[s].model_name&&Lyte.Component.set(i,"cxPropCustomRequest",!0)),null!=o[s].selectedQueryParams?Lyte.Component.set(i,"selectedQueryParams",o[s].selectedQueryParams):Lyte.Component.set(i,"selectedQueryParams",{}),null!=o[s].maxLimitMessage?Lyte.Component.set(i,"maxLimitMessage",o[s].maxLimitMessage):Lyte.Component.set(i,"maxLimitMessage",""),void 0!==o[s].reqCustomData&&Lyte.Component.set(i,"reqCustomData",o[s].reqCustomData),null!=o[s].isSubordinate?(Lyte.Component.set(i,"isSubordinate",o[s].isSubordinate),o[s].isSubordinate&&(Lyte.Component.set(i,"cxPropCustomRequest",!0),Lyte.Component.set(i,"inbuildCustomSubReq",!0))):Lyte.Component.set(i,"isSubordinate",!1),i.localSelected={},"user"==o[s].model_name&&this.setData("userModelsOption",i),t.push(i),o[s].prefix==this.getData("cxPropSelectedFilterOption")&&(e=i)}this.setData("localOptionModels",t),this.setData("currentFilterValue",e),this.getData("currentFilterValue").cxPropCustomRequest?this.setData("cxPropCustomRequest",!0):this.setData("cxPropCustomRequest",!1),this.getData("currentFilterValue").customPagination?this.setData("cxPropCustomPagination",!0):this.setData("cxPropCustomPagination",!1),this.getData("cxPropDisableSearch")||this.getData("currentFilterValue").disableSearch?this.setData("isSearchDisabled",!0):this.setData("isSearchDisabled",!1),null!=this.getData("currentFilterValue").cxPropExclude&&this.setData("cxPropExclude",this.getData("currentFilterValue").cxPropExclude);var r=this.getData("cxPropNetworkData");r.cxPropModuleName=this.getData("currentFilterValue").model_name,this.getData("currentFilterValue").pagination||this.getData("currentFilterValue").cxPropOptions||(r.cxPropDataCache=!0,r.cxPropCacheQuery=this.customCacheQueryObject[this.data.currentFilterValue.prefix]),this.setData("cxPropPrimaryKey",this.getData("currentFilterValue").idSelector),delete r.cxPropCustomData,this.data.currentFilterValue.reqCustomData?r.cxPropCustomData=this.data.currentFilterValue.reqCustomData:r.cxPropCustomData={cxComboBox:"prevent"},this.setData("cxPropNetworkData",r),$L(".user-lists-container").scroll({showOn:"hover"}),$L(".selected-user-list-container").scroll({showOn:"hover"}),this.setData("filterChange",!0);for(s=0;s<this.getData("localOptionModels").length;s++)null==this.getData("localOptionModels")[s].selectedItems&&Lyte.Component.set(this.getData("localOptionModels")[s],"selectedItems",[]),this.data.cxPropShowUserOnly&&null==this.getData("localOptionModels")[s].cxPropQueryParams&&null!=this.data.userModelsOption.cxPropQueryParams&&Lyte.Component.set(this.getData("localOptionModels")[s],"cxPropQueryParams",this.data.userModelsOption.cxPropQueryParams);this.bodydrop.querySelector("lyte-dropdown").ltProp("disabled",!0);var l=this.getData("cxPropSelected");this.setData("initialSelected",l.slice()),this.preSelectedHandeling(),setTimeout(function(){this.bodydrop.querySelector("lyte-accordion").component.getAllHeights()}.bind(this),500)},afterRequestSetOptionsProvideCase:function(){if(null!=this.getData("currentFilterValue").cxPropOptions){var t;t=this.getData("currentlyExcludedArray").length,this.getData("systemData").length+t==this.getData("localData").length&&this.setData("noMoreRecords",!1),this.setData("filterChange",!1),this.setData("searchNonPaginationData",this.getData("localData")),this.setValues()}},handleErrorOnRequest:function(){this.setData({systemData:[],searchLoading:!1,filterChange:!this.data.filterChange&&this.data.filterChange}),this.setValues()},errorOnRequest:function(){this.handleErrorOnRequest()},errorOnSearch:function(){this.handleErrorOnRequest()},setSubordinateQp:function(){if(this.getData("currentFilterValue").isSubordinate){var t={feature:"subordinates"};return t.related_entity_id=Crm.userDetails.USER_ID,t}},setValues:function(t){var e,a,o=this.getData("currentFilterValue"),s=this.getData("localOptionModels"),i=this.getData("systemData"),r=[];for(e=0;e<s.length&&s[e].prefix!=o.prefix;e++);if(0==this.getData("currentFilterValue").pagination){var l;this.getData("currentFilterValue");l=this.getData("currentlyExcludedArray").length,this.getData("systemData").length+l==this.getData("localData").length&&this.setData("noMoreRecords",!1)}var n=s[e].selectedItems;for(e=0;e<i.length;e++)for(Lyte.arrayUtils(r,"push",i[e]),a=0;a<n.length;a++)if(this.data.cxPropShowUserOnly)for(var c=n[a].users,p=0;p<c.length;p++)i[e][this.data.userModelsOption.idSelector]==c[p][this.data.userModelsOption.idSelector]&&Lyte.arrayUtils(r,"pop");else i[e][o.idSelector]==n[a][o.idSelector]&&Lyte.arrayUtils(r,"pop");this.setData("displayContainerData",r),$L.fastdom.mutate((function(){0!=i.length&&$L.fastdom.measure((function(){var t=this.data.systemData.length+this.data.currentlyExcludedArray.length<this.data.localData.length;(t||!t&&this.data.noMoreRecords)&&this.checkEndOfSelection()}),this)}),this)},loadMoreData:function(){if(this.getData("currentFilterValue").customPagination&&this.getMethods("afterRequest"))this.executeMethod("afterRequest",arguments[0]);if(this.setData("preventFutherRequest",!1),0==this.getData("currentFilterValue").pagination){this.getData("currentFilterValue");var t=0;t=this.getData("currentlyExcludedArray").length,this.getData("systemData").length+t==this.getData("localData").length&&this.setData("noMoreRecords",!1)}for(var e=0;e<this.getData("localOptionModels").length;e++)this.getData("localOptionModels")[e].prefix==this.getData("currentFilterValue").prefix&&this.setData("searchNonPaginationData",this.getData("localData"));this.getData("preventSetValues")?(this.setData("filterChange",!1),this.setData("searchLoading",!1),this.setData("scrollLoading",!1)):(this.setValues(),this.setData("filterChange",!1),this.setData("searchLoading",!1),this.setData("scrollLoading",!1))},setCriteria:function(t){var e,a={},o=t||this.getData("currentFilterValue"),s=o.cxPropQueryParams;for(var i in s)a[i]=s[i];var r=this.setSubordinateQp();if(r)for(var i in r)a[i]=r[i];if(!this.getData("isSearch"))return o.pagination?(0==this.getData("cxPropPerPage")&&this.setData("cxPropPerPage",this.getData("perPageValue")),0==this.getData("pageNo")&&this.setData("pageNo",this.getData("pageNoValue")),this.getMethods("setQueryParams")&&(null==(e=this.executeMethod("setQueryParams",a,o,!1))&&null==e||(a=e))):(this.getMethods("setQueryParams")&&(null==(e=this.executeMethod("setQueryParams",a,o,!1))&&null==e||(a=e)),this.setData("cxPropPerPage",0),this.setData("pageNo",0)),a;var l=o;if(1==l.pagination){var n,c=this.escapeString.call(this,this.getData("cxPropInputValue"));if(this.getMethods("setSearchCriteria")&&(n=this.executeMethod("setSearchCriteria",c,l)),l.isSubordinate)for(var i in n)a[i]=n[i];else"object"==typeof a&&null!==a?a.criteria=n:a={criteria:n};return this.getMethods("setQueryParams")&&(null==(e=this.executeMethod("setQueryParams",a,l,!0))&&null==e||(a=e)),a}},endKeyUpSearch:function(){this.getMethods("onClearSearch")&&this.executeMethod("onClearSearch")},performKeyUpSearch:function(t,e){this.getMethods("onSearch")&&this.executeMethod("onSearch",this.getData("currentFilterValue"),t,e)},filterObserver:function(t,e){this.getData("currentFilterValue").cxPropCustomRequest?this.setData("cxPropCustomRequest",!0):this.setData("cxPropCustomRequest",!1),this.getData("currentFilterValue").customPagination?this.setData("cxPropCustomPagination",!0):this.setData("cxPropCustomPagination",!1),this.getData("cxPropDisableSearch")||this.getData("currentFilterValue").disableSearch?this.setData("isSearchDisabled",!0):this.setData("isSearchDisabled",!1),this.setData("currentlyExcludedArray",[]),this.setData("scrollLoading",!1),this.setData("filterChange",!0);var a=this.getData("cxPropNetworkData");a.cxPropModuleName=t,a.cxPropCacheQuery=!0,a.cxPropRecordId="",this.getData("currentFilterValue").pagination||this.getData("currentFilterValue").cxPropOptions?a.cxPropDataCache=!1:(a.cxPropDataCache=!0,a.cxPropCacheQuery=this.customCacheQueryObject[this.data.currentFilterValue.prefix]),delete a.cxPropCustomData,this.data.currentFilterValue.reqCustomData?a.cxPropCustomData=this.data.currentFilterValue.reqCustomData:a.cxPropCustomData={cxComboBox:"prevent"},this.setData("cxPropNetworkData",a),this.setData("displayContainerData",[]);var o=this.bodydrop.querySelector(".user-lists-container");null!=o&&(this.setData("setScrolling",!0),o.scrollTop=0),this.setData("cxPropInputValue",""),this.setData("searchLoading",!1),this.setData("isSearch",!1),this.setData("systemData",[]),this.setData("localData",[]),this.setData("currentPos",0),this.setData("pageNo",1),this.setData("noMoreRecords",!0),this.setData("preventSetOfNoMoreData",!0),this.getData("cxPropNoMoreData")||this.setData("preventSetOfNoMoreData",!1),this.setData("cxPropNoMoreData",!1);var s="subFilter"!=e;if(0==this.getData("currentFilterValue").pagination)for(var i=0;i<this.getData("localOptionModels").length;i++)if(this.getData("localOptionModels")[i].prefix==this.getData("currentFilterValue").prefix&&null!=this.getData("localOptionModels")[i].cxPropOptions){this.setData("localData",this.getData("localOptionModels")[i].cxPropOptions),this.setData("filterChange",!1),0==this.getData("localOptionModels")[i].cxPropOptions.length&&(s=!1);break}if(s){var r=[];if(this.data.cxPropShowUserOnly&&"user"!=this.data.currentFilterValue.model_name){var l=this.data.cxPropNetworkData;r=store.findAll(l.cxPropModuleName,{},l.cxPropCacheQuery,!0,l.cxPropCustomData)}Lyte.resolvePromises(r).then(function(t){if(t&&(t[this.data.currentFilterValue.model_name]||t.length)){t=t[this.data.currentFilterValue.model_name]?t[this.data.currentFilterValue.model_name]:t,this.setData("subFilterOption",t),this.setData("subFilterSelected",t[0]),this.setData("containerDataObject",this.data.userModelsOption);var e={cxPropModuleName:this.data.userModelsOption.model_name,cxPropCacheQuery:!0,cxPropDataCache:!0,cxPropRecordId:t[0].id};this.setData("cxPropNetworkData",e)}else this.setData("containerDataObject",this.data.currentFilterValue);this.constructArray.call(this,"combobox",!1);for(var a=0;a<this.getData("localOptionModels").length;a++)this.getData("localOptionModels")[a].prefix==this.getData("currentFilterValue").prefix&&this.afterRequestSetOptionsProvideCaseTwo(a)}.bind(this))}},afterRequestSetOptionsProvideCaseTwo:function(t){if(null!=this.getData("localOptionModels")[t].cxPropOptions){var e;e=this.getData("currentlyExcludedArray").length,this.getData("systemData").length+e==this.getData("localData").length&&this.setData("noMoreRecords",!1),this.setData("searchNonPaginationData",this.getData("localData")),this.setValues()}},comboBoxClose:function(){this.setData("isSearchDisabled",!1),this.getData("cxPropFooterYield")||this.bodydrop.querySelector("#cruxComboBoxSaveButton").parentElement.ltProp("Disabled",!0),this.getData("showAddRecipient")&&this.setData("showAddRecipient",!1),this.setData("currentlyExcludedArray",[]),this.setData("saveClosing",!1),this.setData("totalList",[]),this.setData("totalListPosition",[]);var t=this.bodydrop.querySelector(".selected-user-list-container"),e=this.bodydrop.querySelector(".user-lists-container");null!=t&&(this.setData("setScrolling",!0),t.scrollTop=0),null!=e&&(this.setData("setScrolling",!0),e.scrollTop=0),this.setData("preventShowCalling",!1),this.setData("setScrolling",!1),this.setData("cxPropInputValue",""),this.setData("isSearch",!1),this.setData("displayContainerData",[]);for(var a=this.getData("localOptionModels"),o=0;o<a.length;o++)Lyte.arrayUtils(a[o].selectedItems,"removeAt",0,a[o].selectedItems.length);this.setData("totalSelectedItemsCount",0),this.setData("localOptionModels",a),this.setData("localOptionModels",[]),this.setData("localClose",!1);var s=this.getData("cxPropNetworkData");s.cxPropModuleName=this.getData("currentFilterValue").model_name,this.setData("cxPropNetworkData",s),this.setData("systemData",[]),this.setData("localData",[]),this.setData("currentPos",0),this.setData("pageNo",1),this.setData("noMoreRecords",!0),this.setData("preventSetOfNoMoreData",!0),this.setData("cxPropNoMoreData",!1),this.setData("cxPropNewSelectedList",[]),this.bodydrop.querySelector("lyte-dropdown").ltProp("selected",this.getData("currentFilterValue").prefix)},checkForPrevention:function(){var t;t=this.getData("localData"),this.getData("currentPos")>=t.length&&this.getData("noMoreRecords")&&this.setData("preventFutherRequest",!0)},checkEndOfSelection:function(){if(this.getData("displayContainerData").length<2){var t=this.getData("systemData").length;((t+=this.getData("currentlyExcludedArray").length)<this.getData("localData").length||t>=this.getData("localData").length&&this.getData("noMoreRecords"))&&(this.getData("preventFutherRequest")||(this.checkForPrevention(),this.constructArray.call(this,"comboBox",!1)),t!=this.getData("systemData").length&&t!=this.getData("cxPropPerPage")&&(this.getData("noMoreRecords")||t<this.getData("localData").length)&&this.setValues())}else{var e=this.getData("displayContainerData").length-2;if(this.bodydrop.querySelector(".user-lists-container").querySelector("ul").querySelectorAll("li")[e].getBoundingClientRect().bottom<this.bodydrop.querySelector(".user-lists-container").getBoundingClientRect().bottom){t=this.getData("systemData").length;((t+=this.getData("currentlyExcludedArray").length)<this.getData("localData").length||t>=this.getData("localData").length&&this.getData("noMoreRecords"))&&(this.getData("preventFutherRequest")||(this.checkForPrevention(),this.constructArray.call(this,"comboBox",!1)),t!=this.getData("systemData").length&&t!=this.getData("cxPropPerPage")&&(this.getData("noMoreRecords")||t<this.getData("localData").length)&&this.setValues())}}},methods:{showAlertMessage:function(t,e){5!==e.errorCode||$L("#cruxCustomMessage")[0]||(event.preventDefault(),this.setData("messageBoxType","info"),this.setData("cxPropMaxLimitMsg",_cruxUtils.getI18n("crm.message.limit.exceed",this.getData("cxPropTagLengthLimit"),_cruxUtils.getI18n("crm.workflow.select.recipients"))),this.cxPropMaxLimitMessageBox())},onBeforeTag:function(){return this.getData("cxPropSelectedTags").length!==this.getData("cxPropTagLimit")},SelectedFilter:function(t,e,a,o){var s=this.getData("currentFilterValue");if(e!=this.getData("currentFilterValue").prefix){for(var i=this.getData("localOptionModels"),r=0;r<i.length;r++)if(i[r].prefix==e){this.setData("currentFilterValue",i[r]);break}null!=this.getData("currentFilterValue").cxPropExclude&&this.setData("cxPropExclude",this.getData("currentFilterValue").cxPropExclude),this.setData("cxPropPrimaryKey",this.getData("currentFilterValue").idSelector),this.getMethods("onFilterChange")&&this.executeMethod("onFilterChange",s,this.getData("currentFilterValue")),this.setData("subFilterOption",[]),this.filterObserver.call(this,i[r].model_name)}},SelectedSubFilter:function(t,e,a){this.filterObserver(this.getData("currentFilterValue").model_name,"subFilter");var o={cxPropModuleName:this.data.userModelsOption.model_name,cxPropCacheQuery:!0,cxPropDataCache:!0,cxPropRecordId:a},s=this.data.subFilterOption.filter((function(t){return t.id==a}));this.setData("subFilterSelected",s),this.setData("cxPropNetworkData",o),this.constructArray.call(this,"comboBox",!1)},beforComboBoxOpen:function(){if(this.bodydrop=this.$node.querySelector("lyte-modal").component.childComp,this.getMethods("onComboBoxBeforeShow"))return this.executeMethod("onComboBoxBeforeShow",this.$node)},onComboxBoxOpen:function(){this.comboBoxOpen.call(this),this.getMethods("onComboBoxShow")&&this.executeMethod("onComboBoxShow",this.$node)},BeforeComboBoxClose:function(){var t;if(this.getMethods("onBeforeComboBoxClose")&&(t=this.executeMethod("onBeforeComboBoxClose",this.$node)),0==t)return this.getData("cxPropShow")||(this.setData("preventShowCalling",!0),this.setData("cxPropShow",!0)),this.getData("localClose")&&this.setData("localClose",!1),!1;if(!this.getData("cxPropFooterYield")&&!this.getData("saveClosing")){this.preventSelObs=!0,Lyte.arrayUtils(this.getData("cxPropSelected"),"removeAt",0,this.getData("cxPropSelected").length);for(var e=0;e<this.getData("initialSelected").length;e++)Lyte.arrayUtils(this.getData("cxPropSelected"),"push",this.getData("initialSelected")[e]);delete this.preventSelObs}for(var a=this.getData("localOptionModels"),o=0;o<a.length;o++)if(a[o].prefix==this.getData("cxPropSelectedFilterOption")){this.setData("currentFilterValue",a[o]);break}this.getData("cxPropShow")&&this.$node.cxProp("show",!1)},onComboBoxClosing:function(){this.comboBoxClose(),this.getMethods("onComboBoxClose")&&this.executeMethod("onComboBoxClose",this.$node)},validateTag:function(t){for(var e=new XRegExp(/^[\p{L}\p{M}\p{N}_]([\p{L}\p{M}\p{N}!#$%&'*+-/=?^_`{|}~.]*)@(?=.{4,256}$)(([\p{L}\p{N}\p{M}]+)(([-_]*[\p{L}\p{M}\p{N}])*)[.])+[\p{L}\p{M}]{2,22}$/.source,"i"),a=$L("crux-tag")[0].component.data.cxPropTags,o=a.length,s=this.getData("localOptionModels"),i=!0,r=0;r<s.length;r++)s[r].selectedItems.length;if(t.match(",")){tagsArray=t.split(",");for(r=0;r<tagsArray.length;r++)XRegExp.test(tagsArray[r].trim(),e)?Lyte.arrayUtils(this.getData("cxPropSelectedTags"),"push",{name:tagsArray[r]}):(a[o-1].class="cxComboBoxErrorRecipient",i=!1)}else XRegExp.test(t.trim(),e)?Lyte.arrayUtils(this.getData("cxPropSelectedTags"),"push",{name:t}):(a[o-1].class="cxComboBoxErrorRecipient",i=!1);this.bodydrop.querySelector("#cruxComboBoxSaveButton").parentElement.ltProp("Disabled",!1),$L("#tagComp").find("lyte-drop-button").scrollTop(100),this.getMethods("onAddTag")&&this.executeMethod("onAddTag",t,i)},closePopup:function(){this.setData("deleteAlertShow",!1)},preventClose:function(t,e,a){$L(".cxComboBoxErrorRecipient");if("addRecipient"===t.target.className)return e.querySelector("crux-tag")&&!e.querySelector("crux-tag")||setTimeout((function(){e.querySelector("crux-tag").querySelector("input").focus()}),100),!1},removeTagFromList:function(t){for(var e=this.getData("cxPropSelectedTags"),a=!1,o=0;o<e.length;o++){if(e[o].name===t){Lyte.arrayUtils(this.getData("cxPropSelectedTags"),"removeAt",o,1),a=!0;break}a=!1}this.bodydrop.querySelector("#cruxComboBoxSaveButton").parentElement.ltProp("Disabled",!1),this.getMethods("onRemoveTag")&&this.executeMethod("onRemoveTag",t,a)}},actions:{checkForLimit:function(t){this.getData("cxPropSelectedTags").length===this.getData("cxPropTagLimit")&&(t.preventDefault(),this.setData("messageBoxType","info"),this.setData("cxPropMaxLimitMsg",_cruxUtils.getI18n("crux.comboBox.max.limit",this.getData("cxPropTagLimit"),_cruxUtils.getI18n("crm.workflow.select.recipients"))),this.cxPropMaxLimitMessageBox())},checkForToolTip:function(t,e,a){t.scrollWidth>t.offsetWidth?t.setAttribute("lt-prop-title",e):a&&this.data.cxPropShowUserOnly&&this.data.selectedUsersList&&this.data.selectedUsersList[a.id]?t.setAttribute("lt-prop-title","user has been added already"):null!=t.getAttribute("lt-prop-title")&&t.removeAttribute("lt-prop-title")},addToList:function(t,e){if(this.preventSelObs=!0,!this.data.cxPropShowUserOnly||!this.data.selectedUsersList[this.data.displayContainerData[e].id]){var a=!1,o=this.getData("currentFilterValue"),s=this.getData("cxPropMaxLimit");if(this.data.cxPropShowUserOnly)s<=this.data.totalSelectedItemsCount+this.data.cxPropSelectedTags.length&&(a=!0,this.cxPropMaxLimitMessageBox());else for(var i=0;i<this.getData("localOptionModels").length;i++)this.getData("localOptionModels")[i].prefix==this.getData("currentFilterValue").prefix&&this.getData("localOptionModels")[i].selectedItems.length==s&&(a=!0,o.maxLimitMessage?this.setData("cxPropMaxLimitMsg",o.maxLimitMessage):this.setData("cxPropMaxLimitMsg",_cruxUtils.getI18n("crux.comboBox.max.limit",this.getData("cxPropMaxLimit"),this.getData("currentFilterValue").name)),this.cxPropMaxLimitMessageBox());if(0==a){var r=!0;if(this.getMethods("onAdd")){for(i=0;i<this.getData("localOptionModels").length&&this.getData("localOptionModels")[i].prefix!=this.getData("currentFilterValue").prefix;i++);null!=(r=this.executeMethod("onAdd",this.getData("displayContainerData")[e],this.getData("localOptionModels")[i].selectedItems,this.getData("localOptionModels"),this.$node,this.getData("currentFilterValue")))&&null!=r||(r=!0)}if(r){for(var l=this.getData("displayContainerData")[e],n=(p=this.getData("cxPropDeletedList")).length,c=0;c<n;c++)if(this.data.cxPropShowUserOnly){if(p[c].user.id==l.id){Lyte.arrayUtils(this.getData("cxPropDeletedList"),"removeAt",c,1);break}}else if(this.getData("currentFilterValue").prefix==p[c].prefix&&this.getData("displayContainerData")[e][this.getData("currentFilterValue").idSelector]==p[c][this.getData("currentFilterValue").idSelector]){Lyte.arrayUtils(this.getData("cxPropDeletedList"),"removeAt",c,1);break}for(var p,d=!1,u=(n=(p=this.getData("observerDelList")).length,0);u<n;u++)if(this.getData("currentFilterValue").prefix==p[u].prefix){for(var h=p[u].selectedItems,m=h.length,x=0;x<m;x++)if(this.getData("displayContainerData")[e][this.getData("currentFilterValue").idSelector]==h[x][this.getData("currentFilterValue").idSelector]){d=!0;break}break}this.getData("cxPropFooterYield")||this.bodydrop.querySelector("#cruxComboBoxSaveButton").parentElement.ltProp("Disabled",!1),this.setData("totalSelectedItemsCount",this.getData("totalSelectedItemsCount")+1),Lyte.arrayUtils(this.getData("displayContainerData"),"removeAt",e,1);var y=this.getData("currentFilterValue");for(i=0;i<this.getData("localOptionModels").length;i++)if(this.getData("localOptionModels")[i].prefix==y.prefix)if(this.data.cxPropShowUserOnly){var g=$("#cxComboSubFilterDD")[0]?$("#cxComboSubFilterDD")[0].cxProp("selected"):"user",D=this.getData("localOptionModels")[i].selectedItems,f=this.data.containerDataObject,P="user"!=g?store.peekRecord(y.model_name,g):{[y.nameSelector]:y.name,[y.idSelector]:y.singular_name},b=D.filter((function(t){return t.id==g}))[0];b||(b={type:y.model_name,name:P[y.nameSelector],id:P[y.idSelector],prefix:y.prefix,image:P[y.imageSelector],users:[]},Lyte.arrayUtils(D,"push",b),b=D[D.length-1]);var S={type:f.model_name,name:l[f.nameSelector],id:l[f.idSelector],prefix:f.prefix,image:l[f.imageSelector]};f.imageSelector&&l[f.imageSelector]&&(S[f.imageSelector]=l[f.imageSelector]),Lyte.arrayUtils(b.users,"push",S);this.getData("cxPropSelected"),P="user"==y.model_name?l:P;selectedData={prefix:y.prefix,[y.singular_name]:{id:P.id,name:P[y.nameSelector]},type:y.name},selectedData.user={id:l[f.idSelector],name:l[f.nameSelector]},f.imageSelector&&l[f.imageSelector]&&(selectedData.user[f.imageSelector]=l[f.imageSelector]),selectedData.id=P[y.idSelector],Lyte.objectUtils(this.data.selectedUsersList,"add",l[f.idSelector],selectedData),Lyte.arrayUtils(this.getData("cxPropSelected"),"push",selectedData)}else Lyte.arrayUtils(this.getData("localOptionModels")[i].selectedItems,"push",{type:y.model_name,name:l[y.nameSelector],id:l[y.idSelector],prefix:y.prefix,image:l[y.imageSelector]}),Lyte.arrayUtils(this.getData("cxPropSelected"),"push",{type:y.model_name,name:l[y.nameSelector],id:l[y.idSelector],prefix:y.prefix,image:l[y.imageSelector]});if(!d){var v=this.getData("cxPropSelected");Lyte.arrayUtils(this.getData("cxPropNewSelectedList"),"push",v[v.length-1])}this.checkEndOfSelection(),this.bodydrop.querySelector("lyte-accordion").component.getAllHeights();for(var L=this.bodydrop.querySelector("lyte-accordion").querySelectorAll("lyte-accordion-item"),C=!1,M=0;M<L.length;M++)if(L[M].querySelector(".user-type").textContent.toLowerCase()==this.getData("currentFilterValue").name.toLowerCase()){C=!0;break}C&&!L[M].classList.contains("lyteAccordionActive")&&$L.fastdom.measure((function(){L[M].click()}))}}delete this.preventSelObs}},removeFromList:function(t,e,a,o,s,i,r){if(this.preventSelObs=!0,"Recipient"===o){var l=this.getData("cxPropRecipient").tags,n=Lyte.arrayUtils(l,"removeAt",a,1);this.getMethods("onRemoveTag")&&this.executeMethod("onRemoveTag",n[0],!0),this.bodydrop.querySelector("#cruxComboBoxSaveButton").parentElement.ltProp("Disabled",!1),this.setData("cxPropTotalRecipientCount.count",this.getData("cxPropTotalRecipientCount.count")-1)}else{var c=!0;if(this.getMethods("onRemove")&&(null!=(c=this.data.cxPropShowUserOnly?this.executeMethod("onRemove",this.getData("localOptionModels")[e].selectedItems[a],this.getData("localOptionModels")[e].selectedItems,this.getData("localOptionModels"),this.$node,this.getData("currentFilterValue"),this.getData("localOptionModels")[e].selectedItems[a].users[i]):this.executeMethod("onRemove",this.getData("localOptionModels")[e].selectedItems[a],this.getData("localOptionModels")[e].selectedItems,this.getData("localOptionModels"),this.$node,this.getData("currentFilterValue")))&&null!=c||(c=!0)),c){if(this.data.cxPropShowUserOnly)this.data.selectedUsersList[r]&&Lyte.arrayUtils(this.getData("cxPropDeletedList"),"push",this.data.selectedUsersList[r]);else for(var p=(x=this.getData("observerDelList")).length,d=0;d<p;d++)if(this.getData("localOptionModels")[e].prefix==x[d].prefix){for(var u=x[d].selectedItems,h=u.length,m=0;m<h;m++)if(this.getData("localOptionModels")[e].selectedItems[a][this.getData("currentFilterValue").idSelector]==u[m][this.getData("currentFilterValue").idSelector]){Lyte.arrayUtils(this.getData("cxPropDeletedList"),"push",u[m]);break}break}var x,y=!this.data.cxPropShowUserOnly,g=(p=(x=this.getData("cxPropNewSelectedList")).length,this.getData("localOptionModels")),D=this.getData("currentFilterValue");for(d=0;d<p;d++){var f=g[e].prefix==x[d].prefix&&g[e].selectedItems[a][D.idSelector]==x[d][D.idSelector];if(this.data.cxPropShowUserOnly){if(this.data.cxPropShowUserOnly&&x[d].prefix==this.data.userModelsOption.prefix&&(f=g[e].selectedItems[a].users[i].id==x[d][D.idSelector]),f&&x[d].user&&x[d].user.id==r){Lyte.objectUtils(this.data.selectedUsersList,"delete",r),Lyte.arrayUtils(g[e].selectedItems[a].users,"removeAt",i,1),g[e].selectedItems[a].users.length||(y=!0),Lyte.arrayUtils(this.getData("cxPropNewSelectedList"),"removeAt",d,1);break}}else if(f){Lyte.arrayUtils(this.getData("cxPropNewSelectedList"),"removeAt",d,1);break}}this.getData("cxPropFooterYield")||this.bodydrop.querySelector("#cruxComboBoxSaveButton").parentElement.ltProp("Disabled",!1),this.setData("totalSelectedItemsCount",this.getData("totalSelectedItemsCount")-1);for(var P=0;P<this.getData("cxPropSelected").length;P++){f=g[e].selectedItems[a].id==this.getData("cxPropSelected")[P].id;if(this.data.cxPropShowUserOnly){if(this.getData("cxPropSelected")[P].prefix==this.data.userModelsOption.prefix&&g[e].selectedItems[a].prefix==this.data.userModelsOption.prefix&&(g[e].selectedItems[a].users.length?g[e].selectedItems[a].users[i]&&(f=g[e].selectedItems[a].users[i].id==this.getData("cxPropSelected")[P].user.id):Lyte.arrayUtils(this.getData("cxPropSelected"),"removeAt",P,1)),f&&this.data.selectedUsersList[r]&&(Lyte.objectUtils(this.data.selectedUsersList,"delete",r),Lyte.arrayUtils(g[e].selectedItems[a].users,"removeAt",i,1),g[e].selectedItems[a].users.length||(y=!0)),this.getData("cxPropSelected")[P]&&this.getData("cxPropSelected")[P].user&&this.getData("cxPropSelected")[P].user.id==r){Lyte.arrayUtils(this.getData("cxPropSelected"),"removeAt",P,1);break}}else if(f){Lyte.arrayUtils(this.getData("cxPropSelected"),"removeAt",P,1);break}}if(y&&Lyte.arrayUtils(g[e].selectedItems,"removeAt",a,1),this.getData("currentFilterValue").prefix==g[e].prefix){D=this.data.cxPropShowUserOnly?this.data.userModelsOption:this.getData("currentFilterValue");var b,S,v=this.getData("systemData"),L=[],C=g[e].selectedItems;for(b=0;b<v.length;b++)for(Lyte.arrayUtils(L,"push",v[b]),S=0;S<C.length;S++)this.data.cxPropShowUserOnly?C[S].users&&C[S].users&&C[S].users.filter((t=>t.id==v[b].id)).length&&Lyte.arrayUtils(L,"pop"):v[b][D.idSelector]==C[S][D.idSelector]&&Lyte.arrayUtils(L,"pop");this.setData("localOptionModels",g),this.setData("displayContainerData",L)}}this.bodydrop.querySelector("lyte-accordion").component.getAllHeights()}delete this.preventSelObs},saveData:function(){this.setData("saveClosing",!0);for(var t=!0,e=[],a=this.getData("cxPropSelectedTags"),o=0;o<this.getData("localOptionModels").length;o++)Lyte.arrayUtils(e,"concat",this.getData("localOptionModels")[o].selectedItems);if($L("crux-tag")[0])var s=$L("crux-tag")[0],i=s.component.data.cxPropTags;if(this.getMethods("onBeforeSave")&&(t=this.executeMethod("onBeforeSave",e,a,this.$node)),null==t||t){if(this.setData("localRecipient",[]),i&&i.length>0){setTimeout((function(){$L(s).find("input").focus()}),100);for(o=0;o<i.length;o++){if("cxComboBoxErrorRecipient"===i[o].class)return this.setData("messageBoxType","error"),this.setData("cxPropMaxLimitMsg",_cruxUtils.getI18n("crm.recipient.invalid.email")),void this.cxPropMaxLimitMessageBox();Lyte.arrayUtils(this.getData("localRecipient"),"push",i[o].name)}}else for(var r=0;r<a.length;r++)Lyte.arrayUtils(this.getData("localRecipient"),"push",a[r].name);if(this.$node.cxProp("show",!1),this.getMethods("onSave"))return this.executeMethod("onSave",e,a,this.getData("cxPropSelectedTags"),this.$node)}else this.setData("saveClosing",!1)},cancelData:function(){this.setData("localClose",!0),this.$node.cxProp("show",!1)},tableScroll:function(t){this.getData("setScrolling")?this.setData("setScrolling",!1):this.getData("cxPropShow")&&(clearTimeout(this._timeout1),this._timeout1=setTimeout(function(){if(!this.getData("preventFutherRequest")){var e=this.getData("systemData").length;e+=this.getData("currentlyExcludedArray").length,0==this.getData("currentFilterValue").pagination&&e!=this.getData("localData").length?this.getData("isSearch")&&e>=this.getData("localData").length?(this.setData("scrollLoading",!1),this.setData("noMoreRecords",!1)):(this.bodyScroll.call(this,"comboBox",t),e!=this.getData("systemData").length&&(this.getData("noMoreRecords")||e<this.getData("localData").length)&&this.setValues()):this.getData("currentFilterValue").pagination?(this.bodyScroll.call(this,"comboBox",t),e!=this.getData("systemData").length&&e!=this.getData("cxPropPerPage")&&(this.getData("noMoreRecords")||e<this.getData("localData").length)&&this.setValues()):0==this.getData("currentFilterValue").pagination&&e==this.getData("localData").length&&(this.setData("scrollLoading",!1),this.setData("noMoreRecords",!1))}}.bind(this),100))},searchKeyup:function(t){var e=this.bodydrop.querySelector(".user-lists-container");1==this.getData("currentFilterValue").pagination?this.keyup.call(this,"comboBox",e,t):(clearTimeout(this._timeout2),this._timeout2=setTimeout(function(){var t=[],a=this.getData("cxPropInputValue"),o=this.getData("cxPropMinLength");if(a.length>=o){null!=e&&(this.setData("setScrolling",!0),e.scrollTop=0),this.setData("multipleBack",!1),this.setData("isSearch",!0);for(var s=0;s<this.getData("searchNonPaginationData").length;s++){var i=this.getData("searchNonPaginationData")[s][this.getData("currentFilterValue").nameSelector].toLowerCase(),r=a.toLowerCase(),l=i.trim(),n=r.trim();(" "+l).indexOf(" "+n)>=0&&Lyte.arrayUtils(t,"push",this.getData("searchNonPaginationData")[s])}this.setData("localData",t),this.setData("currentlyExcludedArray",[]),this.setData("currentPos",0),0!=this.getData("localData").length?this.constructArray.call(this,"comboBox",!1):this.setData("systemData",[]);this.getData("currentFilterValue");var c=0;c=this.getData("currentlyExcludedArray").length,this.getData("systemData").length+c==this.getData("localData").length&&this.setData("noMoreRecords",!1),this.setValues(),this.setData("filterChange",!1),this.setData("searchLoading",!1),this.setData("scrollLoading",!1)}if(0==this.getData("multipleBack")||null==this.getData("multipleBack"))if(null==this.getData("multipleBack")&&a.length<this.getData("cxPropMinLength"))this.setData("multipleBack",!0);else if(0==a.length){var p=!0;if(this.setData("isSearch",!1),this.setData("noMoreRecords",!0),this.setData("currentPos",0),this.setData("localData",[]),0!=this.getData("pageNo")&&this.setData("pageNo",1),null!=this.getData("currentFilterValue").cxPropOptions&&(this.setData("localData",this.getData("currentFilterValue").cxPropOptions),0==this.getData("currentFilterValue").cxPropOptions.length&&(p=!1)),p&&this.constructArray.call(this,"comboBox",!1),null!=this.getData("currentFilterValue").cxPropOptions){this.getData("currentFilterValue"),c=0;c=this.getData("currentlyExcludedArray").length,this.getData("systemData").length+c==this.getData("localData").length&&this.setData("noMoreRecords",!1),this.setValues()}this.setData("multipleBack",!0)}}.bind(this),300))},clearInputField:function(){this.setData("clearField",!0),this.setData("cxPropInputValue",""),this.getMethods("onClearSearch")&&this.executeMethod("onClearSearch"),this.filterObserver(this.getData("currentFilterValue").model_name)},selectRecord:function(){},showAddRecipient:function(t){this.data.cxPropShowUserOnly?this.getMethods("onAddCustomRecipient")&&this.executeMethod("onAddCustomRecipient",this.component):(this.setData("showAddRecipient",!0),setTimeout((function(){var t=$L("crux-tag")[0];$L(t).find("input");t.focus()}),100))},clearData:function(){if(this.getData("showAddRecipient")){var t=$L("crux-tag")[0],e=this.getData("initialTags");if(e&&e.length>0&&t){var a=t.component.data.cxPropTags;e.length!==a.length&&this.setData("deleteAlertShow",!0)}else t.cxProp("Tags",[]),this.setData("showAddRecipient",!1)}else this.setData("cxPropRecipient.tags",[]),this.setData("showAddRecipient",!1)}}},{mixins:["crux-user-utils"]});
