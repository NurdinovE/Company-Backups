Lyte.Component.register("crm-zprojects-rl",{_template:'<template tag-name="crm-zprojects-rl"> <lyte-event-listener event-name="relatedList" on-fire="{{action(\'handleRefresh\')}}"> <span id="subvalue_ACCOUNTNAME" style="display:none;">{{accountName}}</span> <span style="display:none;" id="subvalue_ACCOUNTID" data-params="{&quot;module&quot;:&quot;{{module}}&quot;,&quot;id&quot;:&quot;{{accountID}}&quot;}" value="{{accountID}}">{{accountID}}</span> <span style="display:none;" id="subvalue_CONTACTID" data-params="{&quot;module&quot;:&quot;{{module}}&quot;,&quot;id&quot;:&quot;{{contactId}}&quot;}" value="{{contactId}}">{{contactId}}</span> <span id="subvalue_EMAIL" style="display:none">{{contactEmail}}</span> <input type="hidden" name="ID_PROJECTPERSONALITY" value="{{personalityID}}"> <input type="hidden" id="permission" value="{{permValue}}"> <input type="hidden" id="moduleNameln" value="{{module}}"> <input type="hidden" id="currentEntityId" value="{{entity_id}}"> <input type="hidden" id="contacttabname" value="{{moduleDispVal}}"> <div id="detailViewzdiv"></div> <template is="if" value="{{isCanvasView}}"><template case="true"> <table cellspacing="0" cellpadding="0" class="relCenterBg mB20 w100_per"> <tbody> <tr height="25"> <td class="nowrap"></td> <td> <lyte-dropdown id="projGrp" on-option-selected="{{method(\'projectGrpSelected\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box> <lyte-drop-body> <lyte-drop-item data-value="active">{{getI18n(\'Active\')}} {{getI18n(\'Projects\')}}</lyte-drop-item> <lyte-drop-item data-value="archived"> {{getI18n(\'crm.archive\')}} {{getI18n(\'Projects\')}} </lyte-drop-item> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </td> <td class="alignRight vaM"> <div id="ract1_{{related_list_id}}" class="enableRelLinks"> <template is="if" value="{{isRlLyteNew}}"><template case="true"> <lyte-button class="dummyForLeftPanel crm-rl-write-action" onclick="{{action(\'newProjectSelected\')}}" data-zcqa="link_CreateEditprojectbtn1" data-relid="{{related_list_id}}" lt-prop-appearance="primary" lt-prop-class="outlineprimary"><template is="registerYield" yield-name="text">{{getI18n(\'crm.project.button.newproject\')}}</template></lyte-button> <lyte-button lt-prop-appearance="primary" lt-prop-class="outlineprimary" onclick="{{action(\'associatedProjectSelected\')}}" data-zcqa="link_CreateEditprojectbtn2" data-relid="{{related_list_id}}"><template is="registerYield" yield-name="text">{{getI18n(\'crm.project.button.associateproject\')}}</template></lyte-button> </template><template case="false"> <a class="dummyForLeftPanel createlink crm-rl-write-action" onclick="{{action(\'newProjectSelected\')}}" href="javascript:void(0);" data-zcqa="link_CreateEditprojectbtn1" data-relid="{{related_list_id}}">{{getI18n(\'crm.project.button.newproject\')}}</a> <span class="tb_newsmallbtn crm-rl-write-action" href="javascript:void(0);" onclick="{{action(\'associatedProjectSelected\')}}" data-zcqa="link_CreateEditprojectbtn2" data-relid="{{related_list_id}}">{{getI18n(\'crm.project.button.associateproject\')}}</span> </template></template> </div> </td> </tr> </tbody> </table> </template></template> <lyte-alert id="projectB2CPopUp" lt-prop-show="{{showB2CPopUp}}" lt-prop-heading="Alert" lt-prop-primary-message="{{getI18n(&quot;crm.projects.b2c.noaccounterror.new&quot;,getSingularLabel(&quot;Accounts&quot;),getSingularLabel(&quot;Contacts&quot;))}}" lt-prop-wrapper-class="sampleAlert" lt-prop-top="0px" on-accept="{{method(&quot;acceptB2Cfn&quot;)}}" on-reject="{{method(&quot;cancelB2Cfn&quot;)}}" lt-prop-buttons="[{&quot;type&quot;:&quot;accept&quot;,&quot;text&quot;:&quot;{{getI18n(\'crm.yes.proceed\')}}&quot;,&quot;appearance&quot;:&quot;primary&quot;},{&quot;type&quot;:&quot;reject&quot;,&quot;text&quot;:&quot;{{getI18n(\'crm.button.cancel\')}}&quot;,&quot;appearance&quot;:&quot;default&quot;}]" lt-prop="{&quot;showCloseButton&quot;:false}"></lyte-alert> <lyte-alert id="projectDelPrompt" on-accept="{{method(callFunction)}}" lt-prop-yield="false" lt-prop-top="0px" lt-prop-buttons="[{&quot;type&quot;:&quot;reject&quot;,&quot;text&quot;:&quot;Cancel&quot;},{&quot;type&quot;:&quot;accept&quot;,&quot;text&quot;:&quot;Yes&quot;,&quot;appearance&quot;:&quot;failure&quot;}]" lt-prop="{&quot;showCloseButton&quot;:false}"></lyte-alert> <lyte-alert id="permErrorPrompt" lt-prop-button-position="center" lt-prop-yield="false" lt-prop-top="0px" lt-prop-buttons="[{&quot;type&quot;:&quot;accept&quot;,&quot;text&quot;:&quot;Yes,Got it&quot;,&quot;appearance&quot;:&quot;primary&quot;}]" lt-prop="{&quot;showCloseButton&quot;:false}"></lyte-alert> <lyte-messagebox lt-prop-type="error" lt-prop-message="{{errorMessage}}" lt-prop-show="{{showErrorMessage}}" lt-prop-duration="5000" lt-prop-transition="{&quot;animation&quot;:&quot;slideFromTop&quot;}"> </lyte-messagebox> <template is="if" value="{{expHandlers(no_permission,\'===\',&quot;S&quot;)}}"><template case="true"> <div id="{{related_list_id}}"> <table cellspacing="0" cellpadding="0" class="norec aligncenter w100_per"> <tbody><tr> <td valign="center"> <div class="pR30"> {{getI18n(\'crm.project.error.nopermission\')}} </div> </td> </tr> </tbody></table> </div> </template><template case="false"> <template is="if" value="{{expHandlers(projects_list.length,\'>\',0)}}"><template case="true"> <lyte-table class="crmNoCapitalizeTableHeader {{if(isCanvasView,\'\',if(isRlLyteNew,\'zProjDetailTable noBorderTable crmTableBottomBorder mB20\',\'zProjDetailTable crmTableBottomBorder m20\'))}}" lt-prop-yield="true" lt-prop-width="100%" lt-prop-height="100%" lt-prop-cell-height="20px" lt-prop-id="ProjectRelatedListTable" lt-prop-scroll="{&quot;vertical&quot;:false,&quot;horizontal&quot;:false}"> <template is="registerYield" yield-name="yield"> <lyte-table-structure> <lyte-thead class="tableHeadBg"> <lyte-tr> <template is="if" value="{{ifEquals(sortOrder,&quot;active&quot;)}}"><template case="true"> <lyte-th></lyte-th> </template></template> <lyte-th class="{{if(ifEquals(sortOrder,\'archived\'),\'zproject_rl_name\',\'\')}}">{{getI18n("crm.project.label.projname")}}</lyte-th> <lyte-th class="aligncenter">{{getI18n("crm.project.label.projstatus")}}</lyte-th> <lyte-th class="aligncenter">{{getI18n("crm.project.label.projcomplition")}}</lyte-th> <lyte-th class="aligncenter">{{projectRLMetaData.tab_names.milestone}}</lyte-th> <lyte-th class="aligncenter">{{projectRLMetaData.tab_names.task}}</lyte-th> <lyte-th class="aligncenter">{{projectRLMetaData.tab_names.issue}}</lyte-th> </lyte-tr> </lyte-thead> <lyte-tbody class="project_rl_body"> <template is="for" items="{{projects_list}}" item="projects" index="index"> <lyte-tr class="project_rl_row"> <template is="if" value="{{ifEquals(sortOrder,&quot;active&quot;)}}"><template case="true"> <lyte-td> <div class="w60 pR h18 flexAlignCenter"> <div id="rlEditOptions_{{projects.ProjectId}}" class="zProjEditPdfIcon pA left0 topCenter"> <template is="if" value="{{isRlLyteNew}}"><template case="true"><span id="relatedListEdit_{{related_list_id}}" class="icon-hover-effects zi2 mR5" data-zcqa="editProject" lt-prop-title="{{getI18n(\'crm.label.edit\')}}" onclick="{{action(\'editProjectSelected\',projects.ProjectId)}}"><span class="zcicncss-editFilled zcicn-cssIcons zcicncss13 zcicn_black_mask zi2"></span></span></template><template case="false"><span id="relatedListEdit_{{related_list_id}}" class="link neweditIcon dIB" data-zcqa="editProject" onclick="{{action(\'editProjectSelected\',projects.ProjectId)}}"></span></template></template> <template is="if" value="{{isCanvasView}}"><template case="true"> <template is="if" value="{{isRlLyteNew}}"><template case="true"><a id="proj_del_icon_{{projects.ProjectId}}" onclick="{{action(\'projDeletionEvent\',projects.ProjectId)}}" href="javascript:void(0);" class="icon-hover-effects zi2" data-zcqa="deleteProject" lt-prop-title="{{getI18n(\'crm.label.delete\')}}"><span class="zcicncss-deleteLine-hover zcicn-cssIcons zcicn_black_mask zi2 scale9"></span></a></template><template case="false"><a id="proj_del_icon_{{projects.ProjectId}}" onclick="{{action(\'projDeletionEvent\',projects.ProjectId)}}" href="javascript:void(0);" class="link deleteIcon dIB mL5" data-zcqa="deleteProject"></a></template></template> </template><template case="false"> <template is="if" value="{{isRlLyteNew}}"><template case="true"><span id="proj_del_icon_{{projects.ProjectId}}" onclick="{{action(\'showDelPopFn\',projects.ProjectId,module)}}" data-onclick="javascript:ZProjects.delProject(\'{{entity_id}}\',\'{{projects.ProjectId}}\',\'{{module}}\',\'{{accountName}}\',\'{{accountID}}\',\'{{contactId}}\',\'{{contactEmail}}\')" class="icon-hover-effects zi2" data-zcqa="deleteProject" lt-prop-title="{{getI18n(\'crm.label.delete\')}}"><span class="zcicncss-deleteLine-hover zcicn-cssIcons zcicn_black_mask zi2 scale9"></span></span></template><template case="false"><span id="proj_del_icon_{{projects.ProjectId}}" onclick="{{action(\'showDelPopFn\',projects.ProjectId,module)}}" data-onclick="javascript:ZProjects.delProject(\'{{entity_id}}\',\'{{projects.ProjectId}}\',\'{{module}}\',\'{{accountName}}\',\'{{accountID}}\',\'{{contactId}}\',\'{{contactEmail}}\')" class="link deleteIcon dIB vaM" data-zcqa="deleteProject"></span></template></template> </template></template> </div> </div> </lyte-td> </template></template> <template is="if" value="{{expHandlers(projects.ProjectStatus,\'===\',&quot;active&quot;)}}"><template case="true"> <lyte-td> <link-to lt-prop-route="crm.tab.projects" lt-prop-qp="{&quot;projectId&quot;:&quot;{{projects.ProjectId}}&quot;}"><a>{{projects.ProjectName}}</a></link-to> <span id="projError_{{projects.ProjectId}}" class="svgIcons ico-warning-small-red-Filled vaM mL10 cP {{if(expHandlers(projects.ProjectId,\'===\',ZProjects.errorProject),\'dIB\',\'dN\')}}" onclick="{{action(\'showUsrErrPopUp\')}}"></span> </lyte-td> </template><template case="false"> <lyte-td class="{{if(ifEquals(sortOrder,\'archived\'),\'zproject_rl_name\',\'\')}}">{{projects.ProjectName}}</lyte-td> </template></template> <lyte-td> <div id="projNameGet" class="w100 mAuto pR"> <span class="colorAppliedPicklist" style="background-color:{{projects.status_color}};color:{{getFontColor(projects.status_color)}}">{{projects.custom_status}}</span> </div> </lyte-td> <lyte-td> <div class="w100 mAuto pR"> <a onclick="{{action(\'loadProgressIframe\',projects.ProjectId,\'progress\',projects.ProjectName)}}" href="javascript:void(0);"> <div class="fL w100" id="completionPlaceHolder"> <div class="w100"> <span class="pA crm-extra-small-font-size crmBaseColor lh14 top1 leftCenter">{{projects.Project_completion}}%</span> <div style="width:{{projects.Project_completion}}px;" class="greenbar fL cP"></div> <div style="width:{{arithResult(100,projects.Project_completion,&quot;-&quot;)}}px;" class="graybar fL cP"></div> </div> </div> </a> </div> </lyte-td> <lyte-td> <div class="w170 mAuto"> <div class="alignRight fL w30 pR3 crm-extra-small-font-size lh14">{{projects.CloseMilestoneCNT}}</div> <a onclick="{{action(\'loadProjIframe\',projects.ProjectId,\'mile\',projects.ProjectName,projectRLMetaData.tab_names)}}" href="javascript:void(0);"> <div class="fL w100" id="milestonePlaceHolder"> <div class="w100"> <div style="width:{{projects.MilestoneCompletionPercentage}}px;" class="greenbar fL cP"></div> <div style="width:{{arithResult(100,projects.MilestoneCompletionPercentage,&quot;-&quot;)}}px;" class="graybar fL cP"></div> </div> </div> </a> <div class="fL w30 alignLeft pL3 crm-extra-small-font-size lh14">{{projects.OpenMilestoneCNT}}</div> </div> </lyte-td> <lyte-td> <div class="w170 mAuto"> <div class="alignRight fL w30 pR3 crm-extra-small-font-size lh14">{{projects.CloseTask}}</div> <a href="javascript:void(0);" onclick="{{action(\'loadProjIframe\',projects.ProjectId,\'task\',projects.ProjectName,projectRLMetaData.tab_names)}}"> <div class="fL w100" id="taskPlaceHolder"> <div class="w100"> <div style="width:{{projects.TaskCompletion}}px;" class="greenbar fL cP"></div> <div style="width:{{arithResult(100,projects.TaskCompletion,&quot;-&quot;)}}px;" class="graybar fL cP"></div> </div> </div> </a> <div class="fL w30 alignLeft pL3 crm-extra-small-font-size lh14">{{projects.OpenTask}}</div> </div> </lyte-td> <lyte-td> <div class="w170 mAuto"> <div class="alignRight fL w30 pL3 crm-extra-small-font-size lh14">{{projects.CloseBugCNT}}</div> <a href="javascript:void(0);" onclick="{{action(\'loadProjIframe\',projects.ProjectId,\'bug\',projects.ProjectName,projectRLMetaData.tab_names)}}"> <div class="fL w100" id="bugsPlaceHolder"> <div class="w100"> <div style="width:{{projects.BugCompletionPercentage}}px;" class="greenbar fL cP"></div> <div style="width:{{arithResult(100,projects.BugCompletionPercentage,&quot;-&quot;)}}px;" class="graybar fL cP"></div> </div> </div> </a> <div class="fL w30 alignLeft pL3 crm-extra-small-font-size lh14">{{projects.OpenBugCNT}}</div> </div> </lyte-td> </lyte-tr> </template> </lyte-tbody> </lyte-table-structure> <template is="if" value="{{expHandlers(expHandlers(pageNo,\'!=\',1),\'||\',expHandlers(expHandlers(pageNo,\'===\',1),\'&amp;&amp;\',expHandlers(projects_list.length,\'===\',10)))}}"><template case="true"> <div class="fR pT10"> <lyte-navigator id="projectRelNavigator" on-next="{{method(\'nextRlPage\')}}" on-previous="{{method(\'previousRlPage\')}}" lt-prop-yeild="false" lt-prop-value="{{arithmeticOperation(projectRLMetaData.fromindex,\'-\',1)}}" lt-prop-records="{{getSumList(projectRLMetaData.fromindex,expHandlers(1,\'-\'),projects_list.length)}}" lt-prop-perpage="10" lt-prop-more-records="{{projectRLMetaData.next_page}}" data-zcqa="navigateProjectPersonallity"></lyte-navigator> </div> </template></template> </template> </lyte-table> </template><template case="false"> <div id="{{relation_list_id}}"> <table cellspacing="0" cellpadding="0" class="norec w100_per"> <tbody><tr> <td valign="top"> <template is="if" value="{{expHandlers(permValue,\'===\',\'NO_PERMISSION_IN_PORTAL\')}}"><template case="true"> <div class="pL25">&lt;{{getI18n(\'crm.projects.permissions.user.projects.unauthorized\')}}&gt;</div> </template></template> <template is="if" value="{{expHandlers(permValue,\'===\',\'NOT_PORTAL_USER\')}}"><template case="true"> <div class="pL25">&lt;{{getI18n(\'crm.projects.permissions.user.no.portalpermission\')}}&gt;</div> </template></template> <template is="if" value="{{expHandlers(permValue,\'===\',\'6504\')}}"><template case="true"> <div class="pL25">&lt;{{getI18n(\'crm.project.error.portalchanged\')}}&gt;</div> </template></template> <template is="if" value="{{expHandlers(permValue,\'===\',\'6401\')}}"><template case="true"> <div class="pL25">&lt;{{getI18n(\'crm.project.error.portalownerchanged\')}}&gt;</div> </template></template> <template is="if" value="{{expHandlers(permValue,\'===\',\'6000\')}}"><template case="true"> <div class="pL25">{{getI18n(\'crm.project.portal.zsckeyisregenerated.normal\',brand)}}</div> </template></template> <template is="if" value="{{expHandlers(permValue,\'===\',\'6001\')}}"><template case="true"> <div class="zsckeyPatern w100_per"> <p class="crm-small-font-size lh20 crmNotFoundColor p20 crm-font-regular">{{getI18n(\'crm.project.portal.zsckeyisregenerated.admin1\',brand)}}<br>{{getI18n(\'crm.project.portal.toresumeintegration\')}}&nbsp; <a href="javascript:void(0)" onclick="{{action(\'redirectToProjUpdate\')}}" class="crmLinkColor cP">{{getI18n(\'crm.project.portal.updatezsckey\')}}</a>&nbsp;{{getI18n(\'crm.project.message.andproceed\')}}</p> </div> </template></template> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(permValue,\'!=\',\'NO_PERMISSION_IN_PORTAL\'),\'&amp;&amp;\',expHandlers(permValue,\'!=\',\'NOT_PORTAL_USER\')),\'&amp;&amp;\',expHandlers(permValue,\'!=\',\'6504\')),\'&amp;&amp;\',expHandlers(permValue,\'!=\',\'6401\')),\'&amp;&amp;\',expHandlers(permValue,\'!=\',\'6000\')),\'&amp;&amp;\',expHandlers(permValue,\'!=\',\'6001\'))}}"><template case="true"> <div class="pR30">{{getI18n(\'crm.new.label.no.records\')}}</div> </template></template> </td> </tr> </tbody></table> </div> </template></template> </template></template> </lyte-event-listener></template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"attr",position:[1,5]},{type:"text",position:[1,5,0]},{type:"text",position:[1,7,0]},{type:"attr",position:[1,9]},{type:"attr",position:[1,11]},{type:"attr",position:[1,13]},{type:"attr",position:[1,15]},{type:"attr",position:[1,17]},{type:"attr",position:[1,21]},{type:"if",position:[1,21],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1,3,1]},{type:"registerYield",position:[1,1,1,3,1,1],dynamicNodes:[{type:"text",position:[1,1,1,0]},{type:"text",position:[1,1,1,2]},{type:"componentDynamic",position:[1,1,1]},{type:"text",position:[1,1,3,1]},{type:"text",position:[1,1,3,3]},{type:"componentDynamic",position:[1,1,3]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,1,3,1]},{type:"attr",position:[1,1,1,5,1]},{type:"attr",position:[1,1,1,5,1,1]},{type:"if",position:[1,1,1,5,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,0],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,0],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"attr",position:[3]},{type:"text",position:[3,0]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,23]},{type:"componentDynamic",position:[1,23]},{type:"attr",position:[1,25]},{type:"componentDynamic",position:[1,25]},{type:"componentDynamic",position:[1,27]},{type:"attr",position:[1,29]},{type:"componentDynamic",position:[1,29]},{type:"attr",position:[1,31]},{type:"if",position:[1,31],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1,0,1,1,1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1,1]},{type:"if",position:[1,1,1,1],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,1,1,3]},{type:"text",position:[1,1,1,3,0]},{type:"componentDynamic",position:[1,1,1,3]},{type:"text",position:[1,1,1,5,0]},{type:"componentDynamic",position:[1,1,1,5]},{type:"text",position:[1,1,1,7,0]},{type:"componentDynamic",position:[1,1,1,7]},{type:"text",position:[1,1,1,9,0]},{type:"componentDynamic",position:[1,1,1,9]},{type:"text",position:[1,1,1,11,0]},{type:"componentDynamic",position:[1,1,1,11]},{type:"text",position:[1,1,1,13,0]},{type:"componentDynamic",position:[1,1,1,13]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"attr",position:[1,1,1,1]},{type:"if",position:[1,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[1,1,1,3]},{type:"if",position:[1,1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,5,1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background-color:'","projects.status_color","';color:'",{type:"helper",value:{name:"getFontColor",args:["projects.status_color"]}}]}}}},{type:"text",position:[1,5,1,1,0]},{type:"componentDynamic",position:[1,5]},{type:"attr",position:[1,7,1,1]},{type:"text",position:[1,7,1,1,1,1,1,0]},{type:"attr",position:[1,7,1,1,1,1,3],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'width:'","projects.Project_completion","'px;'"]}}}},{type:"attr",position:[1,7,1,1,1,1,5],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'width:'",{type:"helper",value:{name:"arithResult",args:[100,"projects.Project_completion","'-'"]}},"'px;'"]}}}},{type:"componentDynamic",position:[1,7]},{type:"text",position:[1,9,1,1,0]},{type:"attr",position:[1,9,1,3]},{type:"attr",position:[1,9,1,3,1,1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'width:'","projects.MilestoneCompletionPercentage","'px;'"]}}}},{type:"attr",position:[1,9,1,3,1,1,3],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'width:'",{type:"helper",value:{name:"arithResult",args:[100,"projects.MilestoneCompletionPercentage","'-'"]}},"'px;'"]}}}},{type:"text",position:[1,9,1,5,0]},{type:"componentDynamic",position:[1,9]},{type:"text",position:[1,11,1,1,0]},{type:"attr",position:[1,11,1,3]},{type:"attr",position:[1,11,1,3,1,1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'width:'","projects.TaskCompletion","'px;'"]}}}},{type:"attr",position:[1,11,1,3,1,1,3],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'width:'",{type:"helper",value:{name:"arithResult",args:[100,"projects.TaskCompletion","'-'"]}},"'px;'"]}}}},{type:"text",position:[1,11,1,5,0]},{type:"componentDynamic",position:[1,11]},{type:"text",position:[1,13,1,1,0]},{type:"attr",position:[1,13,1,3]},{type:"attr",position:[1,13,1,3,1,1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'width:'","projects.BugCompletionPercentage","'px;'"]}}}},{type:"attr",position:[1,13,1,3,1,1,3],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'width:'",{type:"helper",value:{name:"arithResult",args:[100,"projects.BugCompletionPercentage","'-'"]}},"'px;'"]}}}},{type:"text",position:[1,13,1,5,0]},{type:"componentDynamic",position:[1,13]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1,0,1,1]},{type:"if",position:[1,1,1,0,1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[1,1,1,0,1,3]},{type:"if",position:[1,1,1,0,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[1,1,1,0,1,5]},{type:"if",position:[1,1,1,0,1,5],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[1,1,1,0,1,7]},{type:"if",position:[1,1,1,0,1,7],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[1,1,1,0,1,9]},{type:"if",position:[1,1,1,0,1,9],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[1,1,1,0,1,11]},{type:"if",position:[1,1,1,0,1,11],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"text",position:[1,1,3]},{type:"attr",position:[1,1,5]},{type:"text",position:[1,1,5,0]},{type:"text",position:[1,1,7]}]}},default:{}},{type:"attr",position:[1,1,1,0,1,13]},{type:"if",position:[1,1,1,0,1,13],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}],_observedAttributes:["metaData","accountArray","contactArray","fromIndex","module","related_list_id","pageNo","sortOrder","projects_list","projectId","authMsg","showEditRLOptions","totalRecords","startIndex","entity_id","currentSelectedId","callFunction","loadingProjects","projectRLMetaData","accountName","accountID","contactId","contactEmail","personalityID","permValue","errorMessage","showErrorMessage","contactModuleName","recordName","showB2CPopUp","currentAction","moduleDispVal","no_permission","isCanvasView","isRlLyteNew"],init:function(){var t=this,e=t.getData("module");"undefined"===e&&(e=document.getElementById("module").value,t.setData("module",e)),"undefined"===t.getData("entity_id")&&t.setData("entity_id",document.getElementById("id").value);var a=moduleRecordMapping[e],o=$("#canvasPopupDiv");t.setData({isCanvasView:o.length>0}),void 0!==a&&t.setData({moduleRecord:store.peekRecord(a.id,t.getData("entity_id")),moduleDispVal:a.singular_label}),t.reInitPrimaryData()},reInitPrimaryData:function(t){var e=this,a=e.getData("module"),o=e.getData("moduleRecord");if(o)switch("Accounts"===a||t||e.setData({accountID:void 0!==o.Account_Name?o.Account_Name.id:void 0,accountName:void 0!==o.Account_Name?o.Account_Name.name.replaceAll("'","\\'"):void 0}),a){case"Accounts":e.setData({accountID:o.id,accountName:o.Account_Name.replaceAll("'","\\'")});break;case"Contacts":e.setData({contactModuleName:a,contactEmail:o.Email,contactId:o.id,recordName:o.Full_Name});break;case"Cases":e.setData({contactId:void 0!==o.Related_To?o.Related_To.id:void 0,recordName:o.Subject});break;case"Campaigns":e.setData("recordName",o.Campaign_Name);break;case"Products":e.setData("recordName",o.Product_Name);break;case"Potentials":e.setData({contactId:void 0!==o.Contact_Name?o.Contact_Name.id:void 0,recordName:o.Deal_Name});break;default:e.setData({contactId:void 0!==o.Contact_Name?o.Contact_Name.id:void 0,recordName:o.Subject})}},setPromptWarning:function(t,e){if("alert"===t){var a=document.getElementById("permErrorPrompt");a.ltProp("secondaryMessage",e),a.ltProp("show",!0)}else if("prompt"===t){var o=document.getElementById("projectDelPrompt");o.ltProp("secondaryMessage",e),o.ltProp("show",!0)}},deleteProjectRl:function(){var t=this,e=this.getData("currentSelectedId");e&&store.delete("zproject_rl",e,{moduleName:this.getData("module"),entityId:this.getData("entity_id")},{ids:e}).then((function(){var e=store.peekAll("zproject_rl").length;store.unloadAll("zproject_rl"),store.unloadAll("projmod_rl"),1!==t.getData("pageNo")&&e%10==0&&t.setData("pageNo",t.getData("pageNo")-1),t.encryptProjIdApi(),renderingUtils.showMsgBox(I18n.getMsg("crm.custom.module.delete.success",I18n.getMsg("Project")),"success"),t.setData("loadingProjects",!1),t.setData("currentSelectedId","")}),(function(){t.setData("loadingProjects",!1),t.setData("errorMessage",I18n.getMsg("crm.label.widgets.error.internal")),t.setData("showErrorMessage",!0)}))},data:function(){return{metaData:Lyte.attr("object"),accountArray:Lyte.attr("array",{default:[]}),contactArray:Lyte.attr("array",{default:[]}),fromIndex:Lyte.attr("number",{default:1}),module:Lyte.attr("string"),related_list_id:Lyte.attr("string"),pageNo:Lyte.attr("number",{default:1}),sortOrder:Lyte.attr("string",{default:"active"}),projects_list:Lyte.attr("array",{default:[]}),projectId:Lyte.attr("string"),authMsg:Lyte.attr("string"),showEditRLOptions:Lyte.attr("boolean",{default:!1}),totalRecords:Lyte.attr("number",{default:0}),startIndex:Lyte.attr("number",{default:0}),entity_id:Lyte.attr("string"),currentSelectedId:Lyte.attr("string"),callFunction:Lyte.attr("string"),loadingProjects:Lyte.attr("boolean",{default:!0}),projectRLMetaData:Lyte.attr("object"),accountName:Lyte.attr("string",{default:""}),accountID:Lyte.attr("string"),contactId:Lyte.attr("string"),contactEmail:Lyte.attr("string"),personalityID:Lyte.attr("string",{default:""}),permValue:Lyte.attr("string",{default:""}),errorMessage:Lyte.attr("string",{default:""}),showErrorMessage:Lyte.attr("boolean",{default:!1}),contactModuleName:Lyte.attr("string"),recordName:Lyte.attr("string"),showB2CPopUp:Lyte.attr("boolean",{default:!1}),currentAction:Lyte.attr("string"),moduleDispVal:Lyte.attr("string"),no_permission:Lyte.attr("string"),isCanvasView:Lyte.attr("boolean",{default:!1}),isRlLyteNew:Lyte.attr("boolean",{default:Crm.userDetails.isRelatedListLyteEnabled})}},projectRelApi:function(t){var e=this,a=e.getData("related_list_id");e.setData("loadingProjects",!0),app.store.makeRequest("findAll","zproject_rl",t,!1).then((function(t){if(e.setData("loadingProjects",!1),t.hasOwnProperty("nopermission"))e.setData("no_permission",t.nopermission);else{var o=t.$.meta;if(e.setData("projects_list",t),e.setData("permValue",o.authenticatemsg),e.setData("projectRLMetaData",o),!0===e.getData("isCanvasView")&&Crm.userDetails.isRLCountSupportedForCanvas){var r={};r[a]=parseInt(o.totalCount),Lyte.registeredMixins["crm-detailcanvas-utils"].handleCountforRL(r)}else{var i=$L("#RL_dataCount_"+o.listrelationid);if(o.totalCount){var s=0;if(i.css({cursor:"auto",padding:"2px 5px ",color:"var(--baseColor)",display:"inline-block","text-align":"center","font-size":"1. 2rem","margin-left":"8px",background:"var(--bg_DBE6FF)","border-radius":"7px","min-width":"12px","line-height":"normal",height:"auto"}),o.next_page)s=10*o.pageno,$(i).text(s+"+");else s=store.peekAll("zproject_rl").filter((function(a){if(a.ProjectStatus===e.getData("sortOrder")&&t.map((t=>t.ProjectId)).contains(a.ProjectId))return a})).length,0===t.length&&(s=0),$(i).text(s);Crm.userDetails.isRelatedListLyteEnabled?Lyte.triggerEvent("relatedListCountDetail",{id:a,count:s,fullCount:0!==s?s:"",more_records:o.next_page,page:parseInt(o.pageno)}):(0!==s?$("#newleft_"+a).find("span.numCountn").addClass("numCountVal").text(o.next_page?s+"+":s):$L("#newleft_"+a).find("span.numCountn").removeClass("numCountVal").text(" "),i.show())}}}$L("#fetch_"+a).removeClass("ref_loading peNone").addClass("ref_complete")}),(function(){e.setData("loadingProjects",!1),$L("#fetch_"+a).removeClass("ref_loading peNone").addClass("ref_complete"),e.setData("errorMessage",I18n.getMsg("crm.label.widgets.error.internal")),e.setData("showErrorMessage",!0)}))},encryptProjIdApi:function(){var t=this,e={action:"getData",pname:"PROJECTPERSONALITY",module:this.getData("module"),id:this.getData("entity_id"),rid:this.getData("related_list_id"),isSortRequest:!1,fromIndex:this.getData("fromIndex")};t.setData("loadingProjects",!0),app.store.makeRequest("findAll","projmod_rl",e,!1).then((function(e){var a=e.ProjectObj;t.setData("projectId",a.projectIdList),t.setData("authMsg",a.authMsg);var o=t.setProjRLQueryParams(t.getData("sortOrder"));t.projectRelApi(o)}),(function(){t.setData("loadingProjects",!1),t.setData("errorMessage",I18n.getMsg("crm.label.widgets.error.internal")),t.setData("showErrorMessage",!0)}))},handleProjectsOperation:function(t,e,a,o){var r=this,i=r.getData("module");"Products"!==i&&"Campaigns"!==i||o?(r.reInitPrimaryData(o),t?(r.handleProjectsQCreateEdit("Create",r.getData("entity_id"),r.getData("module"),r.getData("accountID"),r.getData("accountName"),r.getData("contactId"),r.getData("contactEmail"),r.getData("accountArray"),r.getData("contactArray"),void 0,r.getData("recordName")),r.setData("currentAction","Create")):e?r.handleProjectsQCreateEdit("Edit",r.getData("entity_id"),r.getData("module"),r.getData("accountID"),r.getData("accountName"),r.getData("contactId"),r.getData("contactEmail"),r.getData("accountArray"),r.getData("contactArray"),a,r.getData("recordName")):(r.handleProjectsQCreateEdit("Associate",r.getData("entity_id"),r.getData("module"),r.getData("accountID"),r.getData("accountName"),r.getData("contactId"),r.getData("contactEmail"),r.getData("accountArray"),r.getData("contactArray"),void 0,r.getData("recordName")),r.setData("currentAction","Associate"))):r.makeBulkCallAndDoProjectsOperation(i,t,e,a)},handleProjectsQCreateEdit:function(t,e,a,o,r,i,s,n,c,l,p){if(!o&&n&&n.length>0&&(o=n[0].value),!i&&c&&c.length>0&&(i=c[0].value),!0===validateProject(a,t,e,r,o,i,s,p)){var d={};d.module=a,d.crm_entity_id=e,d.crm_contact_id=i,"Contacts"===a&&(d.crm_contact_id=e),d.action=t,d.crm_account_id=o,n.length>0?d.accountsArr=n:c.length>0&&(d.contactsArr=c),"Edit"===t&&(d.project_id=l),ZProjects.renderNewCrudComponent(d)}},makeBulkCallAndDoProjectsOperation:function(t,e,a,o){var r=this,i=moduleRecordMapping[t];switch(r.setData({accountID:void 0,accountName:void 0,accountArray:[],contactId:void 0,contactArray:[]}),t){case"Products":var s=i.related_lists.filterBy({personality_name:"ACCOUNTSPERSONALITY"})[0];if(void 0!==s){var n={};n.relatedId=r.getData("entity_id"),n.relationId=s.id,n.page=1,n.per_page=10,store.findAll(i.id,n).then((function(i){var s=[];i.length>0?(1===i.length?r.setData({accountID:i[0].id,accountName:i[0].Account_Name}):(i.forEach((t=>{var e={};e.value=t.id,e.name=t.Account_Name,s.push(e)})),r.setData("accountArray",s)),r.handleProjectsOperation(e,a,o,!0)):r.makeContactsBulkCallAndDoProjectsOperation(t,e,a,o)}))}break;case"Campaigns":r.makeContactsBulkCallAndDoProjectsOperation(t,e,a,o)}},makeContactsBulkCallAndDoProjectsOperation:function(t,e,a,o){var r=this,i=moduleRecordMapping[t],s=i.related_lists.filterBy({personality_name:"CONTACTSPERSONALITY"})[0];if(void 0!==s){var n={};n.relatedId=r.getData("entity_id"),n.relationId=s.id,n.page=1,n.per_page=10,store.findAll(i.id,n).then((function(t){var i=[];t.length>0&&(1===t.length&&t[0].Email?r.setData("contactId",t[0].id):(t.forEach((t=>{if(t.Email){var e={},a=t.Email;if(e.value=t.id,t.Account_Name)a=a+"("+t.Account_Name.name+")";e.name=a,i.push(e)}})),r.setData("contactArray",i))),r.handleProjectsOperation(e,a,o,!0)}))}},setProjRLQueryParams:function(t){var e={projectlistrelid:this.getData("related_list_id"),module:this.getData("module"),reqid:this.getData("entity_id"),returnAnchor:"projectspersonality_"+this.getData("related_list_id"),cvid:"",portalName:"",msg:this.getData("authMsg"),pageno:this.getData("pageNo"),projId:this.getData("projectId"),event:"projectlist"};return e.sortorder=void 0!==t?t:$("crm-zprojects-rl")[0].component.data.sortOrder,e},didConnect:function(){"S"!==this.getData("no_permission")&&this.encryptProjIdApi()},actions:{showDelPopFn:function(t,e){ZProjects.showDeleteProjPopup(t,e)},showUsrErrPopUp:function(){ZProjects.showUsrErrPopUp()},handleRefresh:function(t){t.id===this.getData("related_list_id")&&this.encryptProjIdApi()},projDeletionEvent:function(t){if(this.setData("currentSelectedId",t),!(Crm&&Crm.userDetails&&Crm.userDetails.permissions)||Crm.userDetails.permissions.Crm_Implied_Delete_Projects){var e=moduleRecordMapping[this.getData("module")].singular_label,a=I18n.getMsg("crm.project.remove.warning",[I18n.getMsg(e),Crm.brandName]);this.setData("callFunction","deletePromptAcceptfn"),this.setPromptWarning("prompt",a)}else{var o=I18n.getMsg("crm.projects.permissions.user.no.crmpermission");this.setPromptWarning("alert",o,void 0)}},newProjectSelected:function(){this.handleProjectsOperation(!0,!1)},associatedProjectSelected:function(){this.handleProjectsOperation(!1,!1)},editProjectSelected:function(t){this.handleProjectsOperation(!1,!0,t)},redirectToProjUpdate:function(){ZProjects.redirectToProjUpd()},loadProgressIframe:function(t,e){ZProjects.loadProgressFrame(t,e)},loadProjIframe:function(t,e,a,o){var r;switch(ZProjects.loadIframe(t,e,a,o),e){case"mile":r="milestonediv";break;case"task":r="taskdiv";break;case"bug":r="bugsdiv"}ZProjects.showIframe(r)}},methods:{projectGrpSelected:function(t,e){this.setData("sortOrder",e),this.setData("pageNo",1);var a=this.setProjRLQueryParams(e);this.projectRelApi(a)},deletePromptAcceptfn:function(){this.deleteProjectRl()},nextRlPage:function(){this.setData("pageNo",this.getData("pageNo")+1);var t=this.setProjRLQueryParams();this.projectRelApi(t)},previousRlPage:function(){this.setData("pageNo",this.getData("pageNo")-1);var t=this.setProjRLQueryParams();this.projectRelApi(t)},acceptB2Cfn:function(){this.setData("showB2CPopUp",!1),ZProjects.handleB2C(this.getData("currentAction"),this.getData("module"),this.getData("entity_id"))},cancelB2Cfn:function(){this.setData("showB2CPopUp",!1)}}}),Lyte.Component.registerHelper("getSumList",(function(){for(var t=0,e=0,a=arguments.length;e<a;e++)t+=parseInt(arguments[e]);return t})),Lyte.Component.registerHelper("arithmeticOperation",(function(t,e,a){switch(t=parseFloat(t),a=parseFloat(a),e){case"+":return t+a;case"-":return t-a;case"*":return t*a;case"/":return t/a;case"%":return t%a}})),Lyte.Component.registerHelper("getFontColor",(function(t){return getPickListFontColor(t)})),Lyte.Component.register("crm-zprojects-rl-loading",{_template:'<template tag-name="crm-zprojects-rl-loading"> <lyte-table class="zProjectsLoadTable" lt-prop-yield="true" lt-prop-width="100%"> <template is="registerYield" yield-name="yield"> <lyte-table-structure> <lyte-thead> <lyte-tr> <lyte-th><span class="zProjectLoading"></span></lyte-th> <lyte-th><span class="zProjectLoading"></span></lyte-th> <lyte-th><span class="zProjectLoading"></span></lyte-th> <lyte-th><span class="zProjectLoading"></span></lyte-th> <lyte-th><span class="zProjectLoading"></span></lyte-th> </lyte-tr> </lyte-thead> <lyte-tbody> <lyte-tr> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> </lyte-tr> <lyte-tr> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> </lyte-tr> <lyte-tr> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> </lyte-tr> <lyte-tr> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> <lyte-td><span class="zProjectLoading"></span></lyte-td> </lyte-tr> </lyte-tbody> </lyte-table-structure> </template> </lyte-table> </template>',_dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"componentDynamic",position:[1,1,1,1]},{type:"componentDynamic",position:[1,1,1,3]},{type:"componentDynamic",position:[1,1,1,5]},{type:"componentDynamic",position:[1,1,1,7]},{type:"componentDynamic",position:[1,1,1,9]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1,3,1,1]},{type:"componentDynamic",position:[1,3,1,3]},{type:"componentDynamic",position:[1,3,1,5]},{type:"componentDynamic",position:[1,3,1,7]},{type:"componentDynamic",position:[1,3,1,9]},{type:"componentDynamic",position:[1,3,1]},{type:"componentDynamic",position:[1,3,3,1]},{type:"componentDynamic",position:[1,3,3,3]},{type:"componentDynamic",position:[1,3,3,5]},{type:"componentDynamic",position:[1,3,3,7]},{type:"componentDynamic",position:[1,3,3,9]},{type:"componentDynamic",position:[1,3,3]},{type:"componentDynamic",position:[1,3,5,1]},{type:"componentDynamic",position:[1,3,5,3]},{type:"componentDynamic",position:[1,3,5,5]},{type:"componentDynamic",position:[1,3,5,7]},{type:"componentDynamic",position:[1,3,5,9]},{type:"componentDynamic",position:[1,3,5]},{type:"componentDynamic",position:[1,3,7,1]},{type:"componentDynamic",position:[1,3,7,3]},{type:"componentDynamic",position:[1,3,7,5]},{type:"componentDynamic",position:[1,3,7,7]},{type:"componentDynamic",position:[1,3,7,9]},{type:"componentDynamic",position:[1,3,7]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}],data:function(){return{}}}),store.registerModel("projmod_rl",{listRelationId:Lyte.attr("string",{primaryKey:!0}),ProjectObj:Lyte.attr("object")}),store.registerAdapter("projmod_rl",{namespace:"crm",buildURL:function(t,e,a,o,r){return r.replace("projmod_rl","NewRelatedList.do")}}),store.registerSerializer("projmod_rl",{normalizeResponse:function(t,e,a){var o=document.getElementsByTagName("crm-zprojects-rl")[0].component,r=o.getData("related_list_id"),i=o.getData("module"),s={};return s.projmod_rl=a[i][r],s},payloadKey:function(t){return t}}),store.registerModel("zproject_rl",{OpenBugCNT:Lyte.attr("number",{default:0}),OpenMilestoneCNT:Lyte.attr("number",{default:0}),ProjectName:Lyte.attr("string"),ProjGroupName:Lyte.attr("string"),status_color:Lyte.attr("string"),custom_status:Lyte.attr("string"),ProjectId:Lyte.attr("string",{primaryKey:!0}),OpenTask:Lyte.attr("number",{default:0}),Index:Lyte.attr("number"),ProjectStatus:Lyte.attr("string",{default:"active"}),CloseBugCNT:Lyte.attr("number",{default:0}),CloseTask:Lyte.attr("number",{default:0}),BugCompletionPercentage:Lyte.attr("number",{default:0}),CloseMilestoneCNT:Lyte.attr("number",{default:0}),TaskCompletion:Lyte.attr("number",{default:0}),MilestoneCompletionPercentage:Lyte.attr("number",{default:0}),Project_completion:Lyte.attr("number",{default:0}),ProjectUsersList:Lyte.attr("array",{default:[]}),ClientUsersList:Lyte.attr("array",{default:[]})}),store.registerAdapter("zproject_rl",{namespace:"crm",buildURL:function(t,e,a,o,r,i,s){switch(e){case"deleteRecord":var n=s.moduleName,c=s.entity_id,l=o.ProjectId;r=(r=r.split(t)[0]).concat("v2/"+n+"/"+c+"/Zoho_Projects");break;case"updateRecord":n=s.moduleName,c=s.entity_id,l=o.ProjectId;r=(r=r.split(t)[0]).concat("v6/"+n+"/"+c+"/Zoho_Projects/"+l+"/users");break;case"delete":n=s.moduleName,c=s.entityId;r=r.replace("zproject_rl","v2/"+n+"/"+c+"/Zoho_Projects");break;default:r=r.replace("zproject_rl","ProjectConfig.do")}return r},methodForRequest:function(t){return"PATCH"===t?"PUT":t}}),store.registerSerializer("zproject_rl",{normalizeResponse:function(t,e,a){if("updateRecord"===e||"deleteRecord"===e)return a;if("delete"===e)return a={};var o={};return a?a.hasOwnProperty("nopermission")?(o.projectList=a,o.projectList.ProjectId="",a=o):(o.projectList=a.projectList.slice(0),delete a.projectList,o.info=a,a=o):void 0},payloadKey:function(t,e){return"delete"===e?t:"projectList"},serialize:function(t,e,a,o,r){switch(t){case"updateRecord":var i={};i.action=o.action,i.client_name=o.client_name,i.project_id=a.ProjectId,i.project_name=a.ProjectName,i.crm_account_id=o.crm_account_id;for(var s=o.projectUserMap,n=o.existingProjectUsers,c=[],l=0,p=s.length;l<p;l++){var d={},m=s[l],u=m.email;d.email=u,m.is_user_selected&&n.includes(u)||!m.is_user_selected&&!n.includes(u)||(m.is_user_selected&&!n.includes(u)&&(d.profile_id=m.project_profile_id,d.role_id=m.project_role_id),!m.is_user_selected&&n.includes(u)&&(d.zuid=m.id,d._delete="null"),c.push(d))}i.project_users=c;var y=o.existingClientUsers,g=o.clientUserMap,j=[],f=store.peekAll("project_profiles").filter((function(t){return"client"===t.type&&t.default}));for(l=0,p=g.length;l<p;l++){var _={},h=g[l];u=h.email;if(_.email=u,h.is_user_selected||!h.portal_access_enabled||y.includes(u)){if(h.is_user_selected){_.crm_contactId=h.contact_id,_.zpuser_id=h.zpuserid,_.portal_access_enabled=h.portal_access_enabled;var v=h.profile_id;_.profile_id=v||f[0].id}!h.is_user_selected&&y.includes(u)&&(_._delete="null",_.portal_access_enabled=h.portal_access_enabled,_.zpuser_id=h.zpuserid,_.crm_contactId=h.contact_id),_&&Object.keys(_).length>1&&j.push(_)}}i.client_users=j;var P=[];P.push(i),delete e[r],e.data=P;break;case"deleteRecord":e={}}return e}}),store.registerModel("zprojects_rl",{OpenBugCNT:Lyte.attr("number",{default:0}),OpenMilestoneCNT:Lyte.attr("number",{default:0}),ProjectName:Lyte.attr("string"),ProjectId:Lyte.attr("string",{primaryKey:!0}),OpenTask:Lyte.attr("number",{default:0}),Index:Lyte.attr("number"),ProjectStatus:Lyte.attr("string",{default:"active"}),CloseBugCNT:Lyte.attr("number",{default:0}),CloseTask:Lyte.attr("number",{default:0}),BugCompletionPercentage:Lyte.attr("number",{default:0}),CloseMilestoneCNT:Lyte.attr("number",{default:0}),TaskCompletion:Lyte.attr("number",{default:0}),MilestoneCompletionPercentage:Lyte.attr("number",{default:0}),ProjectUsersList:Lyte.attr("array",{default:[]}),ClientUsersList:Lyte.attr("array",{default:[]})}),store.registerAdapter("zprojects_rl",{namespace:"crm",buildURL:function(t,e,a,o,r,i,s){var n=s.moduleName,c=s.entity_id,l=o.ProjectId;switch(r=r.split(t)[0],e){case"deleteRecord":r=r.concat("v2/"+n+"/"+c+"/Zoho_Projects");break;case"updateRecord":r=r.concat("v6/"+n+"/"+c+"/Zoho_Projects/"+l+"/users")}return r},methodForRequest:function(t){return"PATCH"===t?"PUT":t}}),store.registerSerializer("zprojects_rl",{serialize:function(t,e,a,o,r){switch(t){case"updateRecord":var i={};i.action=o.action,i.client_name=o.client_name,i.project_id=a.ProjectId,i.project_name=a.ProjectName,i.crm_account_id=o.crm_account_id;for(var s=o.projectUserMap,n=o.existingProjectUsers,c=[],l=0,p=s.length;l<p;l++){var d={},m=s[l],u=m.email;d.email=u,m.is_user_selected&&n.includes(u)||!m.is_user_selected&&!n.includes(u)||(m.is_user_selected&&!n.includes(u)&&(d.profile_id=m.project_profile_id,d.role_id=m.project_role_id),!m.is_user_selected&&n.includes(u)&&(d.zuid=m.id,d._delete="null"),c.push(d))}i.project_users=c;var y=o.existingClientUsers,g=o.clientUserMap,j=[],f=store.peekAll("project_profiles").filter((function(t){return"client"===t.type&&t.default}));for(l=0,p=g.length;l<p;l++){var _={},h=g[l];u=h.email;if(_.email=u,!(h.is_user_selected&&!h.portal_access_enabled&&y.includes(u)||!h.is_user_selected&&h.portal_access_enabled&&!y.includes(u))){if(h.is_user_selected){_.crm_contactId=h.contact_id,_.zpuser_id=h.zpuserid,_.portal_access_enabled=h.portal_access_enabled;var v=h.profile_id;_.profile_id=v||f[0].id}!h.is_user_selected&&y.includes(u)&&(_._delete="null",_.portal_access_enabled=h.portal_access_enabled,_.zpuser_id=h.zpuserid,_.crm_contactId=h.contact_id),_&&Object.keys(_).length>1&&j.push(_)}}i.client_users=j;var P=[];P.push(i),delete e[r],e.data=P;break;case"deleteRecord":e={}}return e}});
