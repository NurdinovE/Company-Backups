Lyte.Mixin.register("crm-entity-utils",{recordEditSaveTrackData:{prevSaveTime:0,currentSaveTime:0,prevAjaxSaveTime:0,currentAjaxSaveTime:0,prevEditTime:0,currentEditTime:0,prevAjaxEditTime:0,currentAjaxEditTime:0},checkAndAppendOptionToPicklist:function(e,a,r){var t=r.pick_list_values;if(!e)return a;for(var i="multiselectpicklist"===r.data_type?e.split("; "):[e],s=i.length,o=0;o<s;o++){e=i[o].trim();for(var l=!1,n=a.length,d=0;d<n;d++)if(a[d].display_value===e){l=!0;break}if(!l){n=t.length;for(d=0;d<n;d++)if(t[d].display_value===e){l=!0;var c=objectUtils.cloneObject(t[d]);c.type="used",a.push(c);break}}if(!l){var m={actual_value:e,colour_code:null,display_value:e,id:"12345",maps:[],reference_value:e,sequence_number:a.length+1,type:"used"};a.push(m)}}return a},getFldViewPortProperties:function(e,a,r,t,i){var s={},o=a[e.api_name];"Events"===i&&"LOCATION"===e.column_name&&a.$meeting_details&&a.$meeting_details.tool_name&&(o=I18n.getMsg("crm.event.meeting.online.poweredby",Events.displayToolName[a.$meeting_details.tool_name]));var l,n=Lyte.Component.registeredHelpers.getEmptyFieldValueClass(t,o);if(o)switch(e.component_data_type){case"email":case"twitter":case"website":n+=" cxLink",o=a[e.api_name];break;case"boolean":n+=" zcicncss-tickselect zcicn-cssIcons",o="";break;case"text":case"autonumber":case"multiselectpicklist":case"date":"STARTDATETIME"!==e.column_name&&"ENDDATETIME"!==e.column_name||"Events"!==i||!0!==a.All_day||(o=o.substring(0,o.split(":")[0].lastIndexOf(" ")));break;case"picklist":o=a[e.api_name],e.colour_code_enabled&&e.pick_list_values.forEach((function(r){if(r.display_value!==a[e.api_name]);else{var t=r.colour_code;if(t){l=r.colour_code;var i="black";if(t&&""!==t&&0===t.indexOf("#")){var s=t.substring(1);(299*parseInt(s.substr(0,2),16)+587*parseInt(s.substr(2,2),16)+114*parseInt(s.substr(4,2),16))/1e3<175&&(i="white")}var o="background-color:"+t+";color:"+i;"#ffffff"===t&&(o+=";border: 1px solid #C9C9C9"),l=o}n+=" colorAppliedPicklist"}}));break;case"datetime":default:o=a[e.api_name];break;case"layout":case"userlookup":o=a[e.api_name].name;break;case"activity_mml":case"multi_module_lookup":case"lookup":n+=" cxLink",o=a[e.api_name].name;break;case"ownerlookup":n+=" cxViewUserValue",o=a[e.api_name].name;break;case"multiuserlookup":case"multiselectlookup":o=Lyte.Component.registeredHelpers.getTextValueForViewPort(e,a[e.api_name]);break;case"double":case"integer":case"bigint":o=e.separator?Search.formatNumber(a[e.api_name]):"EXCHANGERATE"===e.column_name?Intl.NumberFormat("en-US",{maximumFractionDigits:9}).format(a[e.api_name]):a[e.api_name];break;case"currency":o=this.currencyFldViewPortValue(e,a,r);break;case"remindat":o=Lyte.Component.registeredHelpers.getCallReminderValue(a[e.api_name]);break;case"multi_reminder":(o=a[e.api_name])&&o.length>1&&(n+=" cxLink"),o=Lyte.Component.registeredHelpers.getReminderForViewPort(a[e.api_name],a,i);break;case"imageupload":case"fileupload":case"voicenote":o="",n="dv_info_value_loader";break;case"RRULE":o=Lyte.Component.registeredHelpers.getReadableRecurringPatternForTask(a[e.api_name]);break;case"ALARM":o=Lyte.Component.registeredHelpers.getReadableReminderTextForTask.bind(this)(a[e.api_name],a)}else switch(e.component_data_type){case"imageupload":case"fileupload":o="",n="dv_info_value_loader";break;case"boolean":o=""}return s.value=o,s.styleStr=l,s.classList=n,s},currencyFldViewPortValue:function(e,a,r){var t=a.$currency_symbol+" "+a.$formatted_currency[e.api_name];return featuresAvailable.MultiCurrency&&a[r]&&Crm.userDetails.BASE_CURRENCY!==a[r]&&(t=t+" ("+Crm.userDetails.CURRENCY_DETAILS[Crm.userDetails.BASE_CURRENCY].symbol+" "+a.$home_converted_currency[e.api_name]+")"),t},populateFldApiNameMap:function(e,a){var r={};e.fields.forEach((function(e){r[e.api_name]=e.id})),a.setData("field_apiname_map",r)},getProcessedFieldValue:function(e,a,r){if(void 0===e)return e;if(96===a.ui_type)e=e.length?e.join(";"):void 0;else{if("picklist"===a.data_type&&("-None-"===e||""===e))return;if("multiselectpicklist"===a.data_type)e=e.join("; ");else if("datetime"===a.data_type)e=Lyte.Transform.datetime.deserialize(e);else if("multiuserlookup"===a.data_type){var t=store.peekRecord("field",a.id).multiuserlookup.connectedlookup_apiname,i=[];r[a.api_name]&&r[a.api_name].users.filter((function(e){i.push(e[t].id)}));var s=[],o={},l=[],n=e.length;if(n>0){for(var d=0;d<n;d++)o[t]=e[d],s.push(e[d].id),l.push(o),o={};(e={}).users=l}else e=void 0;i.length===s.length&&$u.intersection(i,s).length===i.length&&(e=r[a.api_name])}else if(33===a.ui_type&&e)e=(e=(e=(e=(e=e.replace(/[\u202c]/g,"")).replace(/[,](?!.)/,"")).replace(/\s{2,}/g," ")).replace(/\s-/g,"-")).replace(/-\s/g,"-");else if("integer"===a.data_type&&"SERVICEDURATION"===a.column_name)a.component_data_type="time-in-hrs";else if("currency"===a.data_type&&a.currency&&"normal"!==a.currency.rounding_option&&!isNaN(a.currency.precision)){var c,m=parseInt(a.currency.precision);switch(a.currency.rounding_option){case"round_up":c=currencyUtils.ROUNDINGOPTION.ROUND_UP;break;case"round_off":c=currencyUtils.ROUNDINGOPTION.ROUND_OFF;break;case"round_down":c=currencyUtils.ROUNDINGOPTION.ROUND_DOWN}e=currencyUtils.applyRounding(e,a.ui_type,m,c)}}if("string"==typeof e&&(a.crypt&&"encryption"===a.crypt.mode&&1===a.crypt.status&&("lowercase"===a.crypt.encrypt_case?e=e.toLowerCase():"uppercase"===a.crypt.encrypt_case&&(e=e.toUpperCase())),e=e.trim(),-1!==[1,11,27,127,62].indexOf(a.ui_type)&&(e=renderingUtils.removeMultiSpacestoSingleSpace(e)),"CODE"===a.column_name||"ZIPCODE"===a.column_name||"MAILINGZIP"===a.column_name||"OTHERZIP"===a.column_name)){e=e.replace(/[~`#%^&*()+={}[\]|\;"<>\\]/g,"")}return e},validateRecordForSave:function(e,a,r,t,i,s,o){switch(a.component_data_type){case"date":!0!==this.validateDateField(e,a,r,t,i)&&this.handleModuleSpecificValidations(e,a,r,t,i,s);break;case"phone":this.validatePhoneField(e,a,i);break;case"currency":case"double":this.validateDecimalField(e,a,i);break;case"bigint":case"integer":this.validateIntegerField(e,a,i);break;case"website":this.validateWebsiteField(e,a,i);break;case"twitter":this.validateTwitterField(e,a,i);break;case"email":this.validateEmailField(e,a,i);break;case"lookup":this.validateLookUpField(e,a,i,o)}return this.getErrorMsgForCode(a,i),!i.isError},getErrorMsgForCode:function(e,a){switch(a.code){case"ERR06":a.message=I18n.getMsg("crm.field.length.check",[$ESAPI.encoder().encodeForHTML(e.field_label)]);break;case"ERR04":a.message=I18n.getMsg("crm.field.valid.decimal.check2",[$ESAPI.encoder().encodeForHTML(e.field_label),a.allowedDecimal]);break;case"ERR02":a.message=I18n.getMsg("crm.field.empty.check",[$ESAPI.encoder().encodeForHTML(e.field_label)]);break;case"ERR03":a.message=I18n.getMsg("crm.field.valid.check",[$ESAPI.encoder().encodeForHTML(e.field_label)])}},validateLookUpField:function(e,a,r,t){if(!e&&t){var i=t.querySelector("#inputId"),s=i;if(0!==(i=i.value.trim()).length){var o=moduleRecordMapping[moduleApiVsNameMapping[a.lookup.module.api_name]].singular_label,l=I18n.getMsg("crm.label.lookup.norecord",$ESAPI.encoder().encodeForHTMLAttribute(o))+" ";return s&&s.closest("lyte-dropdown").close(),r.code="ERR13",r.message={message:l,isInvalidLookup:!0},r.isError=!0,!1}if(!r.isValid)return r.isError=!0,r.code="ERR02",!1}},validateTwitterField:function(e,a,r){if(e&&e.trim()){if(!havevalidLength(a,e))return r.code="ERR06",r.message=Lyte.errorCodes.ERR06,r.isError=!0,!1;if(!validationUtils.isValidTwitter(e.trim()))return r.code="ERR03",r.message=Lyte.errorCodes.ERR03,r.isError=!0,!1}return!0},validateEmailField:function(e,a,r){if(e&&e.trim()){if(!havevalidLength(a,e))return r.code="ERR06",r.message=Lyte.errorCodes.ERR06,r.isError=!0,!1;if(!validationUtils.isValidEmail(e.trim()))return r.code="ERR03",r.message=Lyte.errorCodes.ERR03,r.isError=!0,!1}return!0},validateWebsiteField:function(e,a,r){if(e&&e.trim()){if(!havevalidLength(a,e))return r.code="ERR06",r.message=Lyte.errorCodes.ERR06,r.isError=!0,!1;if(!validationUtils.isValidWebUrl(e.trim()))return r.code="ERR03",r.message=Lyte.errorCodes.ERR03,r.isError=!0,!1}return!0},validateDecimalField:function(e,a,r){if(e&&a){if(!havevalidLength(a,e,!0))return r.code="ERR06",r.message=Lyte.errorCodes.ERR06,r.isError=!0,!1;if(!validationUtils.decimalLengthCheck(e,a.decimal_place))return r.code="ERR04",r.message=Lyte.errorCodes.ERR04,r.allowedDecimal=a.decimal_place,r.fieldValue=e,r.isError=!0,!1}return!0},validateIntegerField:function(e,a,r){if(e&&a){if(!havevalidLength(a,e))return r.code="ERR06",r.message=Lyte.errorCodes.ERR06,r.isError=!0,!1;if(!validationUtils.isValidInteger(String(e))||"PROBABILITY"===a.column_name&&!(e>=0&&e<=100))return r.code="ERR03",r.message=Lyte.errorCodes.ERR03,r.fieldValue=e,r.isError=!0,!1}return!0},validatePhoneField:function(e,a,r){if(e&&a){if(!havevalidLength(a,e))return r.code="ERR06",r.message=Lyte.errorCodes.ERR06,r.isError=!0,!1;if(!Lyte.Component.registeredHelpers.isValidPhonenumber(a,e))return r.code="ERR03",r.message=Lyte.errorCodes.ERR03,r.isError=!0,!1}return!0},validateDateField:function(e,a,r){var t=e;e=(e=e&&"string"==typeof e?e.trim():e)&&"datetime"===a.component_data_type&&-1===e.indexOf("TV")&&-1!==e.indexOf("T")?e.split("T")[0]:e;var i=Utils.isValidDate("yyyy-mm-dd",e);if(e){var s=Lyte.registeredMixins["crm-date-datetime-mixin"].getDateTimeObjFromString(e);s.date&&(e=s.dateTimeStr)}if(e&&!i){var o=-1!==(e=-1===(e=e.trim()).indexOf("TV")&&"date"===a.component_data_type?e+"TV":e).indexOf("TV")?e.split("TV"):e.split(" ");if(e=o.length>=1?o[0]:"",a.mandatory&&!e)return r.code="ERR02",r.message=Lyte.errorCodes.ERR02,r.errorValue=t,r.isError=!0,!1;if(!e)return!0;var l=-1!==["dd.mm.yyyy.","yyyy. mm. dd","yyyy.mm.dd","yyyy'年'mm'月'dd'日'"].indexOf(Crm.userDetails.DATE_PATTERN.toLowerCase()),n=Utils.convertUsrtoDefaultDatePattern(e,l);return e===Lyte.registeredMixins["crm-date-datetime-mixin"].getDateTimeWithTimezone(n)||(Utils.isValidDate(Crm.userDetails.DATE_PATTERN.toUpperCase(),e)?e:(r.code="ERR03",r.message=Lyte.errorCodes.ERR03,r.errorValue=t,r.isError=!0,!1))}return a.mandatory&&!e?(r.code="ERR02",r.message=Lyte.errorCodes.ERR02,r.errorValue=t,r.isError=!0,!1):e},handleModuleSpecificValidations:function(e,a,r,t,i,s){if("Products"===t)switch(a.column_name){case"SALES_START_DATE":if(s.SALES_END_DATE){var o=store.peekRecord("field",s.SALES_END_DATE[0]);this.validateSalesStartAndEndDate(e,a,r,i,"start",o)}break;case"SALES_END_DATE":if(s.SALES_START_DATE){o=store.peekRecord("field",s.SALES_START_DATE[0]);this.validateSalesStartAndEndDate(e,a,r,i,"end",o)}break;case"SUPPORT_START_DATE":if(s.SUPPORT_EXPIRY_DATE){o=store.peekRecord("field",s.SUPPORT_EXPIRY_DATE[0]);this.validateSalesStartAndEndDate(e,a,r,i,"start",o)}break;case"SUPPORT_EXPIRY_DATE":if(s.SUPPORT_START_DATE){o=store.peekRecord("field",s.SUPPORT_START_DATE[0]);this.validateSalesStartAndEndDate(e,a,r,i,"end",o)}}},validateSalesStartAndEndDate:function(e,a,r,t,i,s){if("start"===i){var o=r[s.api_name];return!o||(!!Utils.compareDate(Utils.getDateObject(e,{}),Utils.getDateObject(o,{}))||(t.isError=!0,t.code="ERRDATE01",t.message=I18n.getMsg("crm.custom.field.less.than.equalto",['"'+a.field_label+'"','"'+s.field_label+'"']),!1))}var l=r[s.api_name];return!l||(!!Utils.compareDate(Utils.getDateObject(l,{}),Utils.getDateObject(e,{}))||(t.isError=!0,t.code="ERRDATE02",t.message=I18n.getMsg("crm.field.comparision.check",['"'+a.field_label+'"','"'+s.field_label+'"']),!1))},handleRecordEditErrorResponse:function(e,a,r,t,i){let s=JSON.parse(e.response),o=s.data?s.data[0]:s;if(o&&"error"===o.status&&"the id given seems to be invalid"===o.message)return void renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error"));let l=r.subform&&i?i:$L("#"+r.$ids.valueId)[0];this.handleAjaxEditError(o,r,l,a,t,i?s:void 0)},getMessageForInvalidData:function(e,a,r){var t=e.details;switch(e.message){case"Non Subordinate User Found":"multiuserlookup"!==r.data_type&&(a.message=I18n.getMsg("crm.record.creation.userlookup.alert.manage.subordinate.user"));break;case"invalid data":switch(r.data_type){case"double":case"currency":t&&t.maximum_decimal_place&&(a.message=I18n.getMsg("crm.field.valid.decimal.check2",[$ESAPI.encoder().encodeForHTML(r.field_label),t.maximum_decimal_place]))}}return"Reporting_To"===r.api_name&&(a.message=e.message),a},getDuplicateMessage:function(e,a,r,t){var i=e.details;a.duplicateFdetails={},a.contentId=t.$ids.value_containerId+"_errorMsg";var s=store.peekRecord("module",i.duplicate_record.module.id);if(r=s?s.module_name:r,i&&i.more_records&&"default"===moduleRecordMapping[r].generated_type){a.message=I18n.getMsg("crm.duplicate.value.not.allowed")+" "+I18n.getMsg("crm.duplicate.value.available.multiple",[moduleRecordMapping[r].singular_label.toLowerCase(),$ESAPI.encoder().encodeForHTML(t.field_label)]),a.more_records=!0;a.duplicateFdetails.isMergeAbleMod=-1!=="Leads,Contacts,Accounts,Vendors".split(",").indexOf(r)}else a.message=I18n.getMsg("crm.duplicate.value.not.allowed")+" "+I18n.getMsg("crm.duplicate.value.available",[moduleRecordMapping[r].singular_label.toLowerCase(),$ESAPI.encoder().encodeForHTML(t.field_label)]);return a.duplicateFdetails.id=i&&i.duplicate_record?i.duplicate_record.id:void 0,a.duplicateFdetails.key=i.api_name,a.duplicateFdetails.dupFieldLabel=t.field_label,a.duplicateFdetails.dupColName=t.column_name,a.duplicateFdetails.modLabel=moduleRecordMapping[r].singular_label,a.duplicateFdetails.moduleN=moduleRecordMapping[r].api_name,a.duplicateFdetails.module_name=r,a.duplicateFdetails.modPluLabel=moduleRecordMapping[r].plural_label,a.duplicateFdetails.detailsFromserver=i,a},handleAjaxEditError:function(e,a,r,t,i,s){var o={isError:!0};switch(e.code){case"DUPLICATE_DATA":if(a.subform&&s){var l,n=this.getFinalErrorObjectDetails(e,this.data.fresh_record),d=r.getData("cxPropField").field_label;l=n.details&&n.details.more_records&&"default"===self.getData("moduleData.generated_type")?I18n.getMsg("crm.duplicate.value.not.allowed")+" "+I18n.getMsg("crm.duplicate.value.available.multiple",[void 0!==moduleRecordMapping[n.details.duplicate_record.module.api_name]?$ESAPI.encoder().encodeForHTML(moduleRecordMapping[n.details.duplicate_record.module.api_name].singular_label.toLowerCase()):$ESAPI.encoder().encodeForHTML(this.getData("cxPropModuleData").singular_label.toLowerCase()),$ESAPI.encoder().encodeForHTML(d)]):I18n.getMsg("crm.duplicate.value.not.allowed")+" "+I18n.getMsg("crm.duplicate.value.available",[void 0!==moduleRecordMapping[n.details.duplicate_record.module.api_name]?$ESAPI.encoder().encodeForHTML(moduleRecordMapping[n.details.duplicate_record.module.api_name].singular_label.toLowerCase()):$ESAPI.encoder().encodeForHTML(this.getData("cxPropModuleData").singular_label.toLowerCase()),$ESAPI.encoder().encodeForHTML(d)]),r.setData("cxPropErrorYield",!0),r.closest("crux-subform").setData("errorResp",s),r.setData("cxPropErrorMessage",l)}else o=this.getDuplicateMessage(e,o,t,a),Lyte.Component.set(r.component.data,"cxPropErrorMessage",o),r.setData("isError",!0);break;case"INVALID_DATA":"You cannot send the portal invitation since the email address has the following characters"===e.message?_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropMessage:I18n.getMsg("portal_invite_email_is_not_supported")+" "+e.details.inValidChars}}):"fileupload"===a.data_type&&"Insufficient privileges"===e.message?_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropMessage:I18n.getMsg("crm.FileuploadField.CloudLogin.check")}}):(o=this.getMessageForInvalidData(e,o,a),Lyte.Component.set(r.component.data,"cxPropErrorMessage",o),r.setData("isError",!0));break;case"MAX_RECORDS_LIMIT_REACHED":case"MAX_LIMIT_REACHED":Crm.showStorageExceedPopup();break;case"NO_PERMISSION":if("You don't have permission to edit the primary invitation field of the portal user. To update this field, please contact the portal admin."===e.message)_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropMessage:I18n.getMsg("custmr.prtl.user.email.perm.denied")}});else renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error"));break;case"AUTHENTICATION_FAILURE":case"RECORD_IN_BLUEPRINT":case"CANNOT_PERFORM_ACTION":case"MAPPING_MISMATCH":renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error"));break;case"WEBINAR_SCHEDULE_INVALID":case"TP_SERVICE_UPDATE_FAILED":_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropMessage:e.message}}),commonUtils.showHideLoadingDiv();break;case"DELETED_ZOHO_CAMPAIGN_UPDATE":commonUtils.showHideLoadingDiv(),_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropMessage:I18n.getMsg("crm.zcampaign.record.deleted.campaigns.dynamic",Crm.integrationsAppName.ZOHO_CAMPAIGNS)}});break;case"UNAUTHORIZED_CAMPAIGN_USER":commonUtils.showHideLoadingDiv(),_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropMessage:I18n.getMsg("crm.campaign.non.campaign.user.error.dynamic",Crm.integrationsAppName.ZOHO_CAMPAIGNS)}});break;case"NO_PERMISSION_FOR_EMAILID":commonUtils.showHideLoadingDiv(),_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropMessage:I18n.getMsg("crm.zcampaign.emailid.permission.denied")}});break;case"NOT_ALLOWED":switch(e.message){case"Zoho Campaign can't be updated after the campaign is sent":_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropMessage:I18n.getMsg("crm.zcampaign.edit.campaign.disallowed.dynamic",Crm.integrationsAppName.ZOHO_CAMPAIGNS)}});break;case"This email address is already being used by another portal user":_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropMessage:I18n.getMsg("custmr.prtl.email.already.used")}});break;case"portal users cannot edit invited field value":renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.alert.can.not.edit.email"))}break;case"DUPLICATE_LINKING_DATA":var c=e.details.duplicate_record,m=c.id,u=445!==a.ui_type?c.Name:"",p=I18n.getMsg("crm.linking.module.duplicate.warning",[t,m,u,Crm.getCrmBasePath()]);_cruxUtils.showCustomAlert({params:{ltPropSecondaryMessage:p,ltPropButtons:[{type:"reject",text:I18n.getMsg("crm.button.ok.gotit"),appearance:"primary"}],ltPropContentAlign:"center",cxPropYield:"true"}});break;case"SELF_REFERENCE_LINKING_DATA_INPUT":_cruxUtils.showCustomAlert({params:{ltPropSecondaryMessage:I18n.getMsg("crm.linking.module.sameassociation.warning"),ltPropButtons:[{type:"reject",text:I18n.getMsg("crm.button.ok.gotit"),appearance:"primary"}],ltPropContentAlign:"center"}});break;case"SCHEDULER_RUNNING":_cruxUtils.showCustomAlert({params:{ltPropSecondaryMessage:item.data[0].message,ltPropButtons:[{type:"reject",text:I18n.getMsg("crm.button.ok.gotit"),appearance:"primary"}],ltPropContentAlign:"center",ltPropYield:"true"}});break;case"FILTER_CRITERIA_NOT_SATISFIED":let _=moduleApiVsNameMapping[a.lookup.module.api_name],E=221===a.ui_type?I18n.getMsg("crm.user.text"):moduleRecordMapping[_].singular_label;r.setData({cxPropErrorMessage:I18n.getMsg("crm.lookupfilter.entity.errormsg",E),isError:!0}),commonUtils.showHideLoadingDiv();break;case"MANDATORY_NOT_FOUND":if(e.details&&"id"===e.details.api_name&&/\b(5|4|6|7|9|10|12|13|15|133|135)\b/.test(a.ui_type)){let e=moduleApiVsNameMapping[a.lookup.module.api_name],t=moduleRecordMapping[e].singular_label,i=I18n.getMsg("crm.label.lookup.norecord",t)+" ",s=$("<a class='cP autoRecordCreateAlert'>");s.attr({id:"lookupFieldAlertDiv","data-zcqa":"createNewRecord",onclick:"crmLookupAutoComplete.openSearchCreatePopUp('"+a.id+"','createPageLookup','"+e+"')"}).text(I18n.getMsg("crm.label.create.new")+" "+t),i+=s.get(0).outerHTML,r.setData("cxPropErrorMessage",i)}else r.setData("cxPropErrorMessage",I18n.getMsg("crm.field.valid.check",a.field_label));r.setData("isError",!0);break;case"RECORD_LOCKED":renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.record.locking.permission.denied"));break;case"LIMIT_EXCEEDED":if(a.ui_type===CrmField.UITYPES.IMAGE_UPLOAD){var g="";g="storage space exceeds"===e.message?I18n.getMsg("crm.fileuploader.entityattachments.message.507"):"LIMIT_EXCEEDED"===e.code?1===e.details.limit?I18n.getMsg("crm.attachment.imageUploadField.Minlen.check"):I18n.getMsg("crm.imageupload.allowed.field.length",e.details.limit):I18n.getMsg("crm.imageupload.failure"),r.setData("cxPropErrorMessage",g)}commonUtils.showHideLoadingDiv();break;case"BLOCKED_RECORD":let v=$L("crm-detail-view")[0].component,R="#detailviewPopup_components_"+v.getData("unique_listener_id"),T={feature_name:"Compliance_Settings",code:"BLOCKED_RECORD"};Lyte.Component.render("crm-detailview-popups",{popup_data:T},R);let f=document.getElementById("addingBlockedMailPopUp");f.setAttribute("lt-prop-top","0px"),f.setMethods({onAccept:function(){v.setData("unblockEmailandUpdateRecord",!0),i()},onClose:function(){$("#addingBlockedMailPopUp").parent().remove()}}),f.setAttribute("lt-prop-show",!0)}},getCallStatus:function(e,a){var r,t=e.Outgoing_Call_Status;return void 0===a&&(a=store.peekRecord("module",moduleRecordMapping.Calls.id).fields),a.forEach((function(e){"Outgoing_Call_Status"===e.api_name&&e.pick_list_values.forEach((function(e){e.display_value===t&&(r=e.actual_value)}))})),r},trackRecordEditSaveData:function(e){var a=$L.moment().toDate().getTime();if("save"===e||"saveAndNew"===e)this.recordEditSaveTrackData.prevSaveTime=this.recordEditSaveTrackData.currentSaveTime,this.recordEditSaveTrackData.currentSaveTime=a;else if("ajaxSave"===e)this.recordEditSaveTrackData.prevAjaxSaveTime=this.recordEditSaveTrackData.currentAjaxSaveTime,this.recordEditSaveTrackData.currentAjaxSaveTime=a;else if("edit"===e){this.recordEditSaveTrackData.prevEditTime=this.recordEditSaveTrackData.currentEditTime,this.recordEditSaveTrackData.currentEditTime=a;var r=(this.recordEditSaveTrackData.currentEditTime-this.recordEditSaveTrackData.currentSaveTime)/1e3;this.addRecordClientTracking("RecordSave","RecordEdit",r),r=(this.recordEditSaveTrackData.currentEditTime-this.recordEditSaveTrackData.currentAjaxSaveTime)/1e3,this.addRecordClientTracking("RecordAjaxSave","RecordEdit",r)}else if("ajaxEdit"===e){this.recordEditSaveTrackData.prevAjaxEditTime=this.recordEditSaveTrackData.currentAjaxEditTime,this.recordEditSaveTrackData.currentAjaxEditTime=a;r=(this.recordEditSaveTrackData.currentAjaxEditTime-this.recordEditSaveTrackData.currentAjaxSaveTime)/1e3;this.addRecordClientTracking("RecordAjaxSave","RecordAjaxEdit",r),r=(this.recordEditSaveTrackData.currentAjaxEditTime-this.recordEditSaveTrackData.currentSaveTime)/1e3,this.addRecordClientTracking("RecordSave","RecordAjaxEdit",r)}},addRecordClientTracking:function(e,a,r){if(r>=0&&r<=120){var t=this.getTimeTrackKey(r);if(t){var i={};i.action=a,i.time=t,Crm.client_tracking(e,i)}}},getTimeTrackKey:function(e){var a;return 0===e?a="0Sec":e<=3?a="1-3Sec":e<=5?a="4-5Sec":e<=8?a="6-8Sec":e<=10?a="9-10Sec":e<=15?a="11-15Sec":e<=30?a="16-30Sec":e<=45?a="31-45Sec":e<=60?a="46-60Sec":e<=120&&(a="61-120Sec"),a}});
