Lyte.Component.register("crm-ziavision-myjobslistview",{_template:'<template tag-name="crm-ziavision-myjobslistview" id="crm-ziavision-myjobslistview"> <template is="if" value="{{isMyJobsPage}}"><template case="true"> <div class="visionHome boxBB pR oH"> <div class="myJobsVisionCont boxBB myJobs_vision_mainTable pR"> <div class="lyteOuterTable"> <lyte-table lt-prop-yield="true" lt-prop-scroll="{ &quot;horizontal&quot; : false , &quot;vertical&quot; : true }" id="vision_failedRecordsTable" class="lyteFixedHeaderTable"> <template is="registerYield" yield-name="yield"> <lyte-table-structure> <lyte-thead> <lyte-tr> <lyte-th>{{getI18n("crm.zia.vision.record.name")}}</lyte-th> <lyte-th> <div class="myjobs_visionHeadFilter {{if(expHandlers(selectedModule,\'==\',\'All\'),\'\',\'myjobs_visionHeadFilter_selected\')}}"> <template is="if" value="{{expHandlers(availableModules.length,\'>\',1)}}"><template case="true"> <lyte-dropdown lt-prop-freeze="false" on-show="{{method(&quot;setFocusonInput&quot;,&quot;visionLyteSearch&quot;)}}" class="vaM tableHeaderLyteDropdown" lt-prop-selected="{{selectedModule}}" data-zcqa="moduleDropdown" id="moduleDropdown" lt-prop-position="down" on-option-selected="{{method(&quot;setModule&quot;)}}" lt-prop-placeholder="{{getI18n(&quot;crm.report.none&quot;)}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="moduleDropdownList"> <lyte-drop-header> <lyte-search on-search="{{method(&quot;showNoResult&quot;,&quot;moduleDropdownList&quot;)}}" lt-prop-placeholder="{{getI18n(&quot;crm.globalsearch.search.title&quot;)}}" class="visionLyteSearch" lt-prop-query-selector="{&quot;scope&quot;:&quot;.moduleDropdownList&quot;,&quot;search&quot;:&quot;lyte-drop-item&quot;}"> </lyte-search> </lyte-drop-header> <lyte-drop-body> <template is="for" items="{{availableModules}}" item="module" index="index"> <lyte-drop-item data-zcqa="{{module.id}}" data-value="{{module.api_name}}">{{module.plural_label}}</lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template><template case="false"> {{availableModules[0].plural_label}} </template></template> </div> </lyte-th> <lyte-th>{{getI18n("CREATEDBY")}}</lyte-th> <lyte-th>{{getI18n("crm.zia.vision.on.failure")}}</lyte-th> <lyte-th>{{getI18n("crm.zia.vision.images.waiting")}}</lyte-th> </lyte-tr> </lyte-thead> <template is="if" value="{{expHandlers(records.length,\'>\',0)}}"><template case="true"> <lyte-tbody> <template is="for" items="{{records}}" item="record" index="index"> <lyte-tr> <lyte-td> <link-to class="cP" data-zcqa="visionAppEntity_{{record.id}}" lt-prop-rel="noopener noreferrer" lt-prop-target="_blank" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{getModuleNameByApiName(record.module.api_name)}}&quot;,&quot;{{record.id}}&quot;]">{{record.name}}</link-to> </lyte-td> <lyte-td> <div>{{record.module.plural_label}}</div> </lyte-td> <lyte-td> <div> <span class="dIB vaM txtEllipsis visionUsrName" lt-prop-title="{{record.created_by.name}}">{{record.created_by.name}}</span> </div> </lyte-td> <lyte-td> <template is="if" value="{{expHandlers(record.prioritized_action,\'==\',&quot;record_approval&quot;)}}"><template case="true"> <div>{{getI18n("crm.zia.vision.record.approve")}}</div> </template><template case="false"> <div>{{getI18n("crm.zia.vision.image.approve")}}</div> </template></template> </lyte-td> <lyte-td> <div class="dIB vaM crmLinkColor cP" data-zcqa="openValidationPop" onclick="{{action(\'openValidationPop\',record.id)}}">{{record.images_count}}</div> </lyte-td> </lyte-tr> </template> </lyte-tbody> </template></template> </lyte-table-structure> </template> </lyte-table> <template is="if" value="{{expHandlers(records.length,\'<\',1)}}"><template case="true"> <div class="pT20 crmLabelColor aligncenter pB20">{{getI18n(\'crm.approvalProcess.label.noRecords.awaitingYourApproval\')}}</div> </template></template> </div> </div> </div> </template></template> <lyte-modal id="previewModal" lt-prop-max-height="100%" lt-prop-width="965px" on-show="{{method(\'openPreviewPopup\',record.id,\'visionApprovalImg_preview\')}}" lt-prop-freeze="true" lt-prop="{ &quot;transition&quot; : {&quot;animation&quot; : &quot;slideFromTop&quot;, &quot;duration&quot; : &quot;0.3&quot;}, &quot;offset&quot; : {&quot;top&quot;:&quot;0px&quot;,&quot;left&quot;:&quot;center&quot;} }" lt-prop-dimmer="{&quot;color&quot;:&quot;var(--modalFreezeLayerBg)&quot;,&quot;opacity&quot;:&quot;0.55&quot;}" lt-prop-allow-multiple="true" on-after-show="{{method(&quot;addMarkers&quot;,approvals,&quot;visionApprovalImg_preview&quot;)}}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> {{getI18n("crm.recordImage.previewimage")}} </lyte-modal-header> <lyte-modal-content class="pB20"> <div class="br5 pR h450 vision_detectionPreview_wrap dF aiCenter jcCenter"> <img id="visionApprovalImg_preview" class="pA visionApprovalImg_preview" src="{{previewURL}}" alt="{{previewURL}}"> </div> </lyte-modal-content> </template> </lyte-modal> <lyte-modal data-zcqa="myJobsVisionPop" id="myJobsVisionPop" lt-prop-close-on-escape="false" on-close="{{method(\'closeValidationPopUp\')}}" lt-prop-max-height="85%" lt-prop-width="966px" lt-prop-freeze="true" lt-prop="{ &quot;transition&quot; : {&quot;animation&quot; : &quot;slideFromTop&quot;, &quot;duration&quot; : &quot;0.3&quot;}, &quot;offset&quot; : {&quot;top&quot;:&quot;0px&quot;,&quot;left&quot;:&quot;center&quot;} }" lt-prop-dimmer="{&quot;color&quot;:&quot;var(--modalFreezeLayerBg)&quot;,&quot;opacity&quot;:&quot;0.4&quot;}" lt-prop-re-render-modal="true" on-before-close="{{method(&quot;checkForAlert&quot;)}}" lt-prop-allow-multiple="true" on-after-show="{{method(&quot;addMarkers&quot;,approvals)}}" on-show="{{method(\'bindShadowUtils\')}}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <div class="mB12"> <span class="dIB vaM">{{getI18n(\'crm.zia.vision.failure.message\')}}</span> <span class="bg_white br10 dIB crm-extra-small-font-size mL5 pL6 pR6 pT2 pB2 vaM visionApprovalTab_count aligncenter">{{image_approvals.length}}</span> </div> <div class="crm-base-font-size crm-font-regular crmParagraphColor">{{displayMessage}} {{getI18n(\'crm.zia.vision.pop.msg\')}}</div> <div class="crm-base-font-size crm-font-regular mT10"> <span class="crm-font-bold crm-subheading-font-size dIB vaM"> <template is="if" value="{{isMyJobsPage}}"><template case="true"> <link-to data-zcqa="visionAppEntityModal_{{selectedRecord.id}}" lt-prop-rel="noopener noreferrer" lt-prop-target="_blank" lt-prop-route="crm.tab.module.entity.detail" lt-prop-dp="[&quot;{{getModuleNameByApiName(selectedRecord.module.api_name)}}&quot;,&quot;{{selectedRecord.id}}&quot;]"> {{selectedRecord.name}} </link-to> </template><template case="false"> {{selectedRecord.name}} </template></template> </span> <span class="br4 dIB crm-extra-medium-font-size mL5 pB1 pL7 pR7 pT1 vaM vision_rec_modName">{{recordModule.plural_label}}</span> </div> </lyte-modal-header> <lyte-modal-content> <div class="visionRecordApprovalCont {{eventStopClass}}"> <template is="for" items="{{approvals}}" item="approval" index="index"> <div class="visionApprovalItm br5 oH pR {{if(ifEquals(index,0),\'\',\'mT30\')}}"> <div class="br50 crm-extra-small-font-size pA pL15 pR15 pT5 pB5 right7 top7 visionImgApprovedTag"> {{getI18n(\'zb.accepted\')}} </div> <div class="br50 crm-extra-small-font-size pA pL15 pR15 pT5 pB5 right7 top7 visionImgRejectedTag"> {{getI18n(\'Removed\')}} </div> <div class="p20"> <div class="br5 boxBB dIF jcCenter aiCenter mT15 pR visionApprovalImgSec {{if(approval.image,\'cursorZI\',\'visionApprovalImgSec_withLoader\')}} " onclick="{{action(\'openPreview\',approval)}}"> <template is="if" value="{{expHandlers(approval.image,\'!\')}}"><template case="true"> <crm-ui-loaders id="singleImg" interaction-name="crmCircleLoader"></crm-ui-loaders> </template><template case="false"> <img id="myJobsSelectorView" class="visionApprovalImg dIB vaM myJobsPreview_{{approval.id}}" data-zcqa="img_{{approval.image_name}}" data-lytecbox-dlink="data:image/JPEG;base64,{{approval.image}}" data-lytecbox-href="data:image/JPEG;base64,{{approval.image}}" src="data:image/JPEG;base64,{{approval.image}}" alt="data:image/JPEG;base64,{{approval.image}}"> </template></template> </div> <div class="visionApprovalDetSec vaT mT15 mL15"> <div class="visionApprovalDetItm dTableRow"> <div class="alignRight boxBB dTC pB8 pL10 pR26 pT8 vaT visionApprovalLabel vision_label">{{getI18n("crm.zia.vision.validation")}}</div> <div class="alignLeft boxBB wbBreakWord dTC pB7 pL10 pT7 vaT visionApprovalDetail"> <template is="if" value="{{expHandlers(approval.vision.validation_type,\'===\',&quot;object_detection&quot;)}}"><template case="true"> {{getI18n("crm.zia.vision.create.detect.only")}} </template><template case="false"><template is="if" value="{{expHandlers(approval.vision.validation_type,\'===\',&quot;image_validation&quot;)}}"><template case="true"> {{getI18n("crm.zia.vision.create.match.only")}} </template><template case="false"> {{getI18n("crm.zia.vision.create.match.detect")}} </template></template></template></template> </div> </div> <template is="if" value="{{expHandlers(expHandlers(approval.vision.validation_type,\'===\',&quot;object_detection&quot;),\'||\',expHandlers(approval.vision.validation_type,\'===\',&quot;match_detect&quot;))}}"><template case="true"> <template is="if" value="{{expHandlers(approval.detectedLabels.length,\'>\',0)}}"><template case="true"> <div class="visionApprovalDetItm dTableRow"> <div class="alignRight boxBB dTC pB8 pL10 pR26 pT8 vaT visionApprovalLabel vision_label">{{getI18n("crm.zia.vision.object.tobe.detected")}}</div> <div class="alignLeft boxBB wbBreakWord dTC pB7 pL10 pT7 vaT visionApprovalDetail"> <template is="for" items="{{approval.detectedLabels}}" item="detectedLabel" index="index"> <template is="if" value="{{expHandlers(detectedLabel.count,\'>\',0)}}"><template case="true"> <span class="dIB vaM">{{detectedLabel.labelname}}<span class="dIB vaM">&nbsp;<span class="bg_white br10 dIB crm-extra-small-font-size mL5 pL6 pR6 pT2 pB2 vaM visionApprovalTab_count aligncenter"> {{detectedLabel.count}}</span><template is="if" value="{{expHandlers(index,\'!=\',expHandlers(approval.detectedLabels.length,\'-\',1))}}"><template case="true"><span class="crm-font-bold">, </span></template></template></span></span> </template><template case="false"> <span class="dIB vaM">{{detectedLabel.labelname}}<span class="dIB vaM"><template is="if" value="{{expHandlers(index,\'!=\',expHandlers(approval.detectedLabels.length,\'-\',1))}}"><template case="true"><span class="crm-font-bold">, </span></template></template></span></span> </template></template> </template> </div> </div> </template></template> <template is="if" value="{{expHandlers(approval.undetectedLabels.length,\'>\',0)}}"><template case="true"> <div class="visionApprovalDetItm dTableRow"> <div class="alignRight boxBB dTC pB8 pL10 pR26 pT8 vaT visionApprovalLabel vision_label">{{getI18n("crm.zia.vision.object.tobe.undetected")}}</div> <div class="alignLeft boxBB wbBreakWord dTC pB7 pL10 pT7 vaT visionApprovalDetail"> <template is="for" items="{{approval.undetectedLabels}}" item="undetectedLabel" index="index"> <template is="if" value="{{expHandlers(undetectedLabel.count,\'>\',0)}}"><template case="true"> <span class="dIB vaM">{{undetectedLabel.labelname}}<span class="dIB vaM">&nbsp;<span class="bg_white br10 dIB crm-extra-small-font-size mL5 pL6 pR6 pT2 pB2 vaM visionApprovalTab_count aligncenter"> {{undetectedLabel.count}}</span><template is="if" value="{{expHandlers(index,\'!=\',expHandlers(approval.undetectedLabels.length,\'-\',1))}}"><template case="true"><span class="crm-font-bold">, </span></template></template></span></span> </template><template case="false"> <span class="dIB vaM">{{undetectedLabel.labelname}}<span class="dIB vaM"><template is="if" value="{{expHandlers(index,\'!=\',expHandlers(approval.undetectedLabels.length,\'-\',1))}}"><template case="true"><span class="crm-font-bold">, </span></template></template></span></span> </template></template> </template> </div> </div> </template></template> </template></template><template is="if" value="{{expHandlers(expHandlers(approval.vision.validation_type,\'===\',&quot;image_validation&quot;),\'||\',expHandlers(approval.vision.validation_type,\'===\',&quot;match_detect&quot;))}}"><template case="true"> <div class="visionApprovalDetItm dTableRow"> <template is="if" value="{{expHandlers(approval.vision.desired_set,\'&amp;&amp;\',expHandlers(approval.vision.desired_set.labels.length,\'>\',0))}}"><template case="true"> <div class="alignRight boxBB dTC pB8 pL10 pR26 pT8 vaT visionApprovalLabel vision_label">{{getI18n("crm.zia.vision.label.to.be.matched")}}</div> <div class="alignLeft boxBB wbBreakWord dTC pB7 pL10 pT7 vaT visionApprovalDetail"> <template is="for" items="{{approval.vision.desired_set.labels}}" item="labelObj" index="index"> <span class="dIB vaM">{{labelObj.name}}<span class="dIB vaM"><template is="if" value="{{expHandlers(index,\'!=\',expHandlers(approval.vision.desired_set.labels.length,\'-\',1))}}"><template case="true"><span class="crm-font-bold">, </span></template></template></span></span> </template> </div> </template><template case="false"> <div class="alignRight boxBB dTC pB8 pL10 pR26 pT8 vaT visionApprovalLabel vision_label">{{getI18n("crm.zia.vision.label.to.be.notmatched")}}</div> <div class="alignLeft boxBB wbBreakWord dTC pB7 pL10 pT7 vaT visionApprovalDetail"> <template is="for" items="{{approval.vision.undesired_set.labels}}" item="labelObj" index="index"> <span class="dIB vaM">{{labelObj.name}}<span class="dIB vaM"><template is="if" value="{{expHandlers(index,\'!=\',expHandlers(approval.vision.undesired_set.labels.length,\'-\',1))}}"><template case="true"><span class="crm-font-bold">, </span></template></template></span></span> </template> </div> </template></template> </div> </template></template> <div class="visionApprovalDetItm dTableRow"> <div class="alignRight boxBB dTC pB8 pL10 pR26 pT8 vaT visionApprovalLabel vision_label">{{getI18n("crm.zia.vision.field")}}</div> <div class="alignLeft boxBB wbBreakWord dTC pB7 pL10 pT7 vaT visionApprovalDetail">{{approval.vision.vision_fields.field_label}}</div> </div> <div class="visionApprovalDetItm dTableRow"> <div class="alignRight boxBB dTC pB8 pL10 pR26 pT8 vaT visionApprovalLabel vision_label">{{getI18n("crm.label.privacy.data.source.rulename")}}</div> <div class="alignLeft boxBB wbBreakWord dTC pB7 pL10 pT7 vaT visionApprovalDetail">{{approval.vision.name}}</div> </div> <div class="visionApprovalDetItm dTableRow"> <div class="alignRight boxBB dTC pB8 pL10 pR26 pT8 vaT visionApprovalLabel vision_label">{{getI18n("crm.zia.vision.awaiting.since")}}</div> <div class="alignLeft boxBB wbBreakWord dTC pB7 pL10 pT7 vaT visionApprovalDetail">{{getDifferenceDates(approval.initiated_on)}}</div> </div> <template is="if" value="{{approval.rule_pattern}}"><template case="true"> <div class="visionApprovalDetItm dTableRow"> <div class="alignRight boxBB dTC pB8 pL10 pR26 pT8 vaT visionApprovalLabel vision_label">{{getI18n("crm.zia.vision.detect.rule.pattern")}}</div> <div class="alignLeft boxBB wbBreakWord dTC pB7 pL10 pT7 vaT visionApprovalDetail"> <template is="for" items="{{approval.rule_pattern}}" item="object" index="index"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(approval.rule_pattern[index],\'===\',&quot;and&quot;),\'||\',expHandlers(approval.rule_pattern[index],\'===\',&quot;or&quot;)),\'||\',expHandlers(approval.rule_pattern[index],\'===\',&quot;(&quot;)),\'||\',expHandlers(approval.rule_pattern[index],\'===\',&quot;)&quot;))}}"><template case="true"> <template is="if" value="{{expHandlers(object,\'===\',&quot;and&quot;)}}"><template case="true"> <span class="vaM vision_greenTxt"> {{getI18n(\'crm.label.and\')}} </span> </template><template case="false"><template is="if" value="{{expHandlers(object,\'===\',&quot;or&quot;)}}"><template case="true"> <span class="vaM vision_greenTxt"> {{getI18n(\'crm.label.or\')}} </span> </template><template case="false"> <span class="vaM"> {{object}} </span> </template></template></template></template> </template><template case="false"> <span class="vaM"> <template is="if" value="{{ifContains(object,&quot;is detected&quot;)}}"><template case="true"> <template is="if" value="{{ifContains(object,&quot;is not detected&quot;)}}"><template case="true"> <template is="if" value="{{expHandlers(lastIndexOf(object,&quot;is detected&quot;),\'>\',lastIndexOf(object,&quot;is not detected&quot;))}}"><template case="true"> {{substr(object,0,expHandlers(lastIndexOf(object,"is detected"),\'-\',1))}} {{toLowerCase(getI18n(\'crm.zia.vision.isdetected\'))}} </template><template case="false"><template is="if" value="{{expHandlers(lastIndexOf(object,&quot;is not detected&quot;),\'>\',lastIndexOf(object,&quot;is detected&quot;))}}"><template case="true"> {{substr(object,0,expHandlers(lastIndexOf(object,"is not detected"),\'-\',1))}} {{toLowerCase(getI18n(\'crm.zia.vision.isNotdetected\'))}} </template></template></template></template> </template><template case="false"> {{substr(object,0,expHandlers(lastIndexOf(object,"is detected"),\'-\',1))}} {{toLowerCase(getI18n(\'crm.zia.vision.isdetected\'))}} </template></template> </template><template case="false"><template is="if" value="{{ifContains(object,&quot;is not detected&quot;)}}"><template case="true"> <template is="if" value="{{ifContains(object,&quot;is detected&quot;)}}"><template case="true"> <template is="if" value="{{expHandlers(lastIndexOf(object,&quot;is detected&quot;),\'>\',lastIndexOf(object,&quot;is not detected&quot;))}}"><template case="true"> {{substr(object,0,expHandlers(lastIndexOf(object,"is detected"),\'-\',1))}} {{toLowerCase(getI18n(\'crm.zia.vision.isdetected\'))}} </template><template case="false"><template is="if" value="{{expHandlers(lastIndexOf(object,&quot;is not detected&quot;),\'>\',lastIndexOf(object,&quot;is detected&quot;))}}"><template case="true"> {{substr(object,0,expHandlers(lastIndexOf(object,"is not detected"),\'-\',1))}} {{toLowerCase(getI18n(\'crm.zia.vision.isNotdetected\'))}} </template></template></template></template> </template><template case="false"> {{substr(object,0,expHandlers(lastIndexOf(object,"is not detected"),\'-\',1))}} {{toLowerCase(getI18n(\'crm.zia.vision.isNotdetected\'))}} </template></template> </template></template></template></template> </span> </template></template> </template> </div> </div> </template></template> <template is="if" value="{{approval.rule_pattern_match}}"><template case="true"> <div class="visionApprovalDetItm dTableRow"> <div class="alignRight boxBB dTC pB8 pL10 pR26 pT8 vaT visionApprovalLabel vision_label">{{getI18n("crm.zia.vision.match.rule.pattern")}}</div> <div class="alignLeft boxBB wbBreakWord dTC pB7 pL10 pT7 vaT visionApprovalDetail"> <template is="for" items="{{approval.rule_pattern_match}}" item="object" index="index"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(approval.rule_pattern_match[index],\'===\',&quot;or&quot;),\'||\',expHandlers(approval.rule_pattern_match[index],\'===\',&quot;(&quot;)),\'||\',expHandlers(approval.rule_pattern_match[index],\'===\',&quot;)&quot;))}}"><template case="true"> <template is="if" value="{{expHandlers(object,\'===\',&quot;or&quot;)}}"><template case="true"> <span class="vaM vision_greenTxt"> {{getI18n(\'crm.label.or\')}} </span> </template><template case="false"> <span class="vaM"> {{object}} </span> </template></template> </template><template case="false"> <span class="vaM"> <template is="if" value="{{ifContains(object,&quot;is matched&quot;)}}"><template case="true"> <template is="if" value="{{ifContains(object,&quot;is not matched&quot;)}}"><template case="true"> <template is="if" value="{{expHandlers(lastIndexOf(object,&quot;is matched&quot;),\'>\',lastIndexOf(object,&quot;is not matched&quot;))}}"><template case="true"> {{substr(object,0,expHandlers(lastIndexOf(object,"is matched"),\'-\',1))}} {{toLowerCase(getI18n(\'crm.zia.vision.isMatched\'))}} </template><template case="false"><template is="if" value="{{expHandlers(lastIndexOf(object,&quot;is not matched&quot;),\'>\',lastIndexOf(object,&quot;is matched&quot;))}}"><template case="true"> {{substr(object,0,expHandlers(lastIndexOf(object,"is not matched"),\'-\',1))}} {{toLowerCase(getI18n(\'crm.zia.vision.isNotMatched\'))}} </template></template></template></template> </template><template case="false"> {{substr(object,0,expHandlers(lastIndexOf(object,"is matched"),\'-\',1))}} {{toLowerCase(getI18n(\'crm.zia.vision.isMatched\'))}} </template></template> </template><template case="false"><template is="if" value="{{ifContains(object,&quot;is not matched&quot;)}}"><template case="true"> <template is="if" value="{{ifContains(object,&quot;is matched&quot;)}}"><template case="true"> <template is="if" value="{{expHandlers(lastIndexOf(object,&quot;is matched&quot;),\'>\',lastIndexOf(object,&quot;is not matched&quot;))}}"><template case="true"> {{substr(object,0,expHandlers(lastIndexOf(object,"is matched"),\'-\',1))}} {{toLowerCase(getI18n(\'crm.zia.vision.isMatched\'))}} </template><template case="false"><template is="if" value="{{expHandlers(lastIndexOf(object,&quot;is not matched&quot;),\'>\',lastIndexOf(object,&quot;is matched&quot;))}}"><template case="true"> {{substr(object,0,expHandlers(lastIndexOf(object,"is not matched"),\'-\',1))}} {{toLowerCase(getI18n(\'crm.zia.vision.isNotMatched\'))}} </template></template></template></template> </template><template case="false"> {{substr(object,0,expHandlers(lastIndexOf(object,"is not matched"),\'-\',1))}} {{toLowerCase(getI18n(\'crm.zia.vision.isNotMatched\'))}} </template></template> </template></template></template></template> </span> </template></template> </template> </div> </div> </template></template> </div> </div> <div class="p20 br_top_border4 visionApprovalBtnSec pR alignRight"> <div class="cP crm-extra-medium-font-size visionViewSampleLink pA left20" data-zcqa="sampleImg_{{approval.id}}" onclick="{{action(\'showSamplesPop\',approval.vision.id)}}"> <span class="dIB vaM crmLinkColor cP ">{{getI18n(\'crm.zia.vision.training.images\')}}</span> </div> <template is="if" value="{{showReviewButtons}}"><template case="true"><template is="if" value="{{is_record_locked}}"><template case="true"> <lyte-button data-zcqa="acceptImg_{{approval.id}}" lt-prop-class="outlinegreenlightbtn" class="visionApprovalAccept_btn" lt-prop-disabled="{{is_record_locked}}" lt-prop-title="{{button_disable_tootip}}" lt-prop-appearance="success"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.invitation.status.accept\')}} </template> </lyte-button> <lyte-button data-zcqa="rejectImg_{{approval.id}}" lt-prop-class="outlineredlight redbtn" class="visionApprovalReject_btn mR0" lt-prop-disabled="{{is_record_locked}}" lt-prop-title="{{button_disable_tootip}}" lt-prop-appearance="failure"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.lar.ruleEntry.dontassociate\')}} </template> </lyte-button> </template><template case="false"> <lyte-button data-zcqa="acceptImg_{{approval.id}}" lt-prop-class="outlinegreenlightbtn" class="visionApprovalAccept_btn" onclick="{{action(\'acceptImg\',this,approval.id)}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.invitation.status.accept\')}} </template> </lyte-button> <lyte-button data-zcqa="rejectImg_{{approval.id}}" lt-prop-class="outlineredlight redbtn" class="visionApprovalReject_btn mR0" onclick="{{action(\'rejectImg\',this,approval.id)}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.lar.ruleEntry.dontassociate\')}} </template> </lyte-button> </template></template></template></template> </div> <template is="for" items="{{showHelpZia}}" item="helpZiaApproval" index="index"> <template is="if" value="{{expHandlers(helpZiaApproval.approvalId,\'===\',approval.id)}}"><template case="true"> <template is="if" value="{{expHandlers(helpZiaApproval.askVisionError,\'||\',expHandlers(helpZiaApproval.askVisionError,\'===\',false))}}"><template case="true"> <div class="p20 zv_learningSection {{if(helpZiaApproval.askVisionError,\'\',\'zv_learningSection_helpUnavail\')}}" id="zv_learningSection"> <div class="pR crm-font-bold">{{getI18n(\'crm.zia.vision.help.zia\')}} </div> <div> <template is="if" value="{{helpZiaApproval.askVisionError}}"><template case="true"> <div class="mT15 "> <div class="mT10">{{getI18n(\'crm.zia.vision.helpZia.successrate.question\')}}</div> <div class="mT10"> <lyte-radiobutton id="visionErrorChk_{{approval.id}}" lt-prop-type="primary" lt-prop-label="{{getI18n(&quot;crm.label.yes&quot;)}}" data-zcqa="visionErrorChked" lt-prop-name="visionFailAct_{{approval.id}}" lt-prop-label-class="dIB vaM" lt-prop-value="Yes"> </lyte-radiobutton> <lyte-radiobutton id="visionValidChk_{{approval.id}}" lt-prop-type="primary" lt-prop-checked="true" lt-prop-label="{{getI18n(&quot;crm.label.no&quot;)}}" data-zcqa="visionValidChked" lt-prop-name="visionFailAct_{{approval.id}}" lt-prop-label-class="dIB vaM" lt-prop-value="No"> </lyte-radiobutton> </div> </div> </template><template case="false"><template is="if" value="{{expHandlers(helpZiaApproval.askVisionError,\'===\',false)}}"><template case="true"> <div class="mT15 crmNotesSection dIB"> {{getI18n(\'crm.zia.vision.successrate.myjobs.help.zia.unavailable\')}} </div> </template></template></template></template> <template is="if" value="{{helpZiaApproval.suggest_for_learn}}"><template case="true"> <div class="mT15 "> <div class="mT10">{{getI18n(\'crm.zia.vision.helpZia.addToLearn.question\')}}</div> <div class="mT10"> <lyte-radiobutton id="addToLearning_{{approval.id}}" lt-prop-type="primary" lt-prop-label="{{getI18n(&quot;crm.label.yes&quot;)}}" data-zcqa="addToLearnChked" lt-prop-name="addToLearn_{{approval.id}}" lt-prop-label-class="dIB vaM" lt-prop-value="{{getI18n(&quot;crm.label.yes&quot;)}}"> </lyte-radiobutton> <lyte-radiobutton id="notAddToLearning_{{approval.id}}" lt-prop-type="primary" lt-prop-checked="true" lt-prop-label="{{getI18n(&quot;crm.label.no&quot;)}}" data-zcqa="notAddToLearnChked" lt-prop-name="addToLearn_{{approval.id}}" lt-prop-label-class="dIB vaM" lt-prop-value="{{getI18n(&quot;crm.label.no&quot;)}}"> </lyte-radiobutton> </div> </div> </template></template> </div> </div> </template></template> </template></template> </template> </div> </template> </div> </lyte-modal-content> <lyte-modal-footer class="borderTopNone right"> <template is="if" value="{{expHandlers(showRecActions,\'&amp;&amp;\',showReviewButtons)}}"><template case="true"> <lyte-button lt-prop-appearance="failure-default" data-zcqa="deleteRecordButton" id="deleteRecordButton" lt-prop-size="default" onclick="{{action(\'showDeleteAlertModal\')}}"> <template is="registerYield" yield-name="text"> {{getI18n("crm.zia.vision.delete.record")}} </template> </lyte-button> <lyte-button lt-prop-disabled="{{disaleApproveRec}}" class="mL7" data-zcqa="approveRecordButton" id="approveRecordButton" lt-prop-appearance="primary" onclick="{{action(\'approveRecord\')}}"> <template is="registerYield" yield-name="text">{{getI18n("crm.zia.vision.record.allow")}}</template> </lyte-button> </template><template case="false"><template is="if" value="{{expHandlers(showImgActions,\'&amp;&amp;\',showReviewButtons)}}"><template case="true"><template is="if" value="{{is_all_fields_read_only}}"><template case="true"> <lyte-button id="approvalBtn" lt-prop-appearance="primary"> <template is="registerYield" yield-name="text">{{getI18n(\'crm.zia.vision.failure.okay\')}}</template> </lyte-button> </template><template case="false"> <lyte-button id="approvalBtn" data-zcqa="popUpSaveClose" lt-prop-appearance="primary" lt-prop-disabled="{{disableSaveClose}}" onclick="{{action(&quot;approveImages&quot;)}}"> <template is="registerYield" yield-name="text">{{getI18n(\'crm.zia.vision.save.close\')}}</template> </lyte-button> </template></template> </template></template></template></template> </lyte-modal-footer> </template> </lyte-modal> <lyte-modal id="visionSamplesModal" lt-prop-freeze="true" lt-prop-prevent-focus="true" lt-prop-close-on-escape="false" lt-prop="{&quot;width&quot; : &quot;auto&quot;, &quot;transition&quot; : {&quot;animation&quot; : &quot;slideFromTop&quot;, &quot;duration&quot; : &quot;0.3&quot;}, &quot;offset&quot; : {&quot;top&quot;:&quot;0px&quot;,&quot;left&quot;:&quot;center&quot;} }" lt-prop-max-height="85%" lt-prop-allow-multiple="true"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <span class="dIB vaM ">{{getI18n(\'crm.zia.vision.image.samples\')}}</span> <div class="crm-font-regular dIB vaM mL15"> <crux-dropdown cx-prop-zcqa="visionTrainingImgDropdown" id="trainingImgDropdown" on-option-select="{{method(\'changeLabel\')}}" cx-prop-options="{{labels}}" cx-prop-user-value="name" cx-prop-system-value="id" cx-prop-selected="{{lbind(selectedLabelId)}}"></crux-dropdown> </div> </lyte-modal-header> <lyte-modal-content class="pB25"> <div class="w850"> <div class="dF aiCenter"> <template is="for" items="{{validationImages}}" item="key" index="index"> <template is="if" value="{{expHandlers(index,\'<\',3)}}"><template case="true"> <div class="visionApprovalSampleImg mB15 boxBB br5 {{if(ifEquals(index,2),\'\',\'mR15\')}}" style="background-image: url({{key.image_url}});"></div> </template></template> </template> </div> <div class="dF aiCenter"> <template is="for" items="{{validationImages}}" item="key" index="index"> <template is="if" value="{{expHandlers(expHandlers(index,\'>\',2),\'&amp;&amp;\',expHandlers(index,\'<\',6))}}"><template case="true"> <div class="visionApprovalSampleImg boxBB br5 {{if(ifEquals(index,5),\'\',\'mR15\')}}" style="background-image: url({{key.image_url}});"></div> </template></template> </template> </div> </div> </lyte-modal-content> </template> </lyte-modal> <lyte-alert on-accept="{{method(&quot;redirectToOut&quot;)}}" on-reject="{{method(&quot;abortToOut&quot;,&quot;cancelApprovalModal&quot;)}}" lt-prop-wrapper-class="vision_alert_wrapper" lt-prop-top="0" lt-prop-button-position="right" lt-prop-content-align="left" lt-prop-type="info" lt-prop-show-close-button="false" data-zcqa="cancelApprovalModal" id="cancelApprovalModal" lt-prop-heading="{{getI18n(\'crm.zia.vision.move.away\')}}" lt-prop-secondary-message="{{getI18n(\'crm.zia.vision.move.away.note\')}}" lt-prop-buttons="[{&quot;type&quot;:&quot;reject&quot;,&quot;text&quot;:&quot;{{getI18n(&quot;crm.button.stay.here&quot;)}}&quot;,&quot;appearance&quot;:&quot;default&quot;},{&quot;type&quot;:&quot;accept&quot;,&quot;text&quot;:&quot;{{getI18n(&quot;crm.zia.vision.yes.move&quot;)}}&quot;,&quot;appearance&quot;:&quot;failure&quot;}]"> </lyte-alert> <lyte-alert on-accept="{{method(&quot;deleteRecord&quot;)}}" on-reject="{{method(&quot;abortToOut&quot;,&quot;deleteApprovalModal&quot;)}}" lt-prop-wrapper-class="vision_alert_wrapper" lt-prop-top="0" lt-prop-button-position="center" lt-prop-content-align="center" lt-prop-type="info" lt-prop-show-close-button="false" data-zcqa="deleteApprovalModal" id="deleteApprovalModal" lt-prop-heading="{{getI18n(\'crm.zia.vision.delete.record.msg\',selectedRecordName)}}" lt-prop-buttons="[{&quot;type&quot;:&quot;reject&quot;,&quot;text&quot;:&quot;{{getI18n(&quot;Cancel&quot;)}}&quot;,&quot;appearance&quot;:&quot;default&quot;},{&quot;type&quot;:&quot;accept&quot;,&quot;text&quot;:&quot;{{getI18n(&quot;crm.button.move.to.trash&quot;)}}&quot;,&quot;appearance&quot;:&quot;failure&quot;}]"></lyte-alert> <lyte-messagebox data-zcqa="visionRecordApprovedBanner" id="visionRecordApprovedBanner" lt-prop-type="success" lt-prop-message="{{getI18n(&quot;crm.zia.vision.record.approved&quot;,selectedRecordName)}}" lt-prop-duration="8000" lt-prop-offset="{&quot;top&quot;:&quot;0&quot;}"></lyte-messagebox> <lyte-messagebox data-zcqa="visionRecordSavedBanner" id="visionRecordSavedBanner" lt-prop-type="success" lt-prop-message="{{visionRecordSavedBannerMsg}}" lt-prop-duration="8000" lt-prop-offset="{&quot;top&quot;:&quot;20px&quot;}"></lyte-messagebox> <lyte-messagebox data-zcqa="visionRecordDeletedBanner" id="visionRecordDeletedBanner" lt-prop-type="success" lt-prop-message="{{getI18n(&quot;crm.zia.vision.record.delete&quot;,selectedRecordName)}}" lt-prop-duration="8000" lt-prop-offset="{&quot;top&quot;:&quot;0&quot;}"></lyte-messagebox> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1,1,1,1,1],dynamicNodes:[{type:"text",position:[1,1,1,1,0]},{type:"componentDynamic",position:[1,1,1,1]},{type:"attr",position:[1,1,1,3,1]},{type:"attr",position:[1,1,1,3,1,1]},{type:"if",position:[1,1,1,3,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,1,1,3]},{type:"text",position:[1,1,1,5,0]},{type:"componentDynamic",position:[1,1,1,5]},{type:"text",position:[1,1,1,7,0]},{type:"componentDynamic",position:[1,1,1,7]},{type:"text",position:[1,1,1,9,0]},{type:"componentDynamic",position:[1,1,1,9]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"text",position:[1,1,1,0]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"text",position:[1,3,1,0]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5,1,1]},{type:"text",position:[1,5,1,1,0]},{type:"componentDynamic",position:[1,5]},{type:"attr",position:[1,7,1]},{type:"if",position:[1,7,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1,7]},{type:"attr",position:[1,9,1]},{type:"text",position:[1,9,1,0]},{type:"componentDynamic",position:[1,9]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,1,1]},{type:"attr",position:[1,1,1,3]},{type:"if",position:[1,1,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1,1]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5]},{type:"registerYield",position:[5,1],dynamicNodes:[{type:"text",position:[1,1,1,0]},{type:"text",position:[1,1,3,0]},{type:"text",position:[1,3,0]},{type:"text",position:[1,3,2]},{type:"attr",position:[1,5,1,1]},{type:"if",position:[1,5,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"text",position:[1,5,3,0]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"attr",position:[3,1,1]},{type:"for",position:[3,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1]},{type:"text",position:[1,3,1]},{type:"attr",position:[1,5,1]},{type:"attr",position:[1,5,1,1]},{type:"if",position:[1,5,1,1],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"text",position:[1,5,3,1,1,0]},{type:"attr",position:[1,5,3,1,3,1]},{type:"if",position:[1,5,3,1,3,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,5,3,3]},{type:"if",position:[1,5,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"text",position:[1,2,1,1]},{type:"attr",position:[1,2,2]},{type:"if",position:[1,2,2],cases:{true:{dynamicNodes:[]}},default:{}}]},false:{dynamicNodes:[{type:"text",position:[1,0]},{type:"attr",position:[1,2,0]},{type:"if",position:[1,2,0],cases:{true:{dynamicNodes:[]}},default:{}}]}},default:{}}]}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"text",position:[1,2,1,1]},{type:"attr",position:[1,2,2]},{type:"if",position:[1,2,2],cases:{true:{dynamicNodes:[]}},default:{}}]},false:{dynamicNodes:[{type:"text",position:[1,0]},{type:"attr",position:[1,2,0]},{type:"if",position:[1,2,0],cases:{true:{dynamicNodes:[]}},default:{}}]}},default:{}}]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,5,3,4]},{type:"if",position:[1,5,3,4],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"attr",position:[3,1]},{type:"for",position:[3,1],dynamicNodes:[{type:"text",position:[1,0]},{type:"attr",position:[1,2,0]},{type:"if",position:[1,2,0],cases:{true:{dynamicNodes:[]}},default:{}}]}]},false:{dynamicNodes:[{type:"text",position:[1,0]},{type:"attr",position:[3,1]},{type:"for",position:[3,1],dynamicNodes:[{type:"text",position:[1,0]},{type:"attr",position:[1,2,0]},{type:"if",position:[1,2,0],cases:{true:{dynamicNodes:[]}},default:{}}]}]}},default:{}}]}},default:{}},{type:"text",position:[1,5,3,6,1,0]},{type:"text",position:[1,5,3,6,3,0]},{type:"text",position:[1,5,3,8,1,0]},{type:"text",position:[1,5,3,8,3,0]},{type:"text",position:[1,5,3,10,1,0]},{type:"text",position:[1,5,3,10,3,0]},{type:"attr",position:[1,5,3,12]},{type:"if",position:[1,5,3,12],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}]}},default:{}},{type:"attr",position:[1,5,3,14]},{type:"if",position:[1,5,3,14],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}]}},default:{}},{type:"attr",position:[1,7,1]},{type:"text",position:[1,7,1,1,0]},{type:"attr",position:[1,7,3]},{type:"if",position:[1,7,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,9]},{type:"for",position:[1,9],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,0]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3,1]},{type:"componentDynamic",position:[1,3,1]},{type:"attr",position:[1,3,3]},{type:"componentDynamic",position:[1,3,3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3,3]},{type:"if",position:[1,3,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3,1]},{type:"componentDynamic",position:[1,3,1]},{type:"attr",position:[1,3,3]},{type:"componentDynamic",position:[1,3,3]}]}},default:{}}]}},default:{}}]}},default:{}}]}]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"if",position:[5,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[5]},{type:"registerYield",position:[7,1],dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3,1]},{type:"componentDynamic",position:[1,3,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1,1,1]},{type:"for",position:[3,1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background-image: url('","key.image_url","');'"]}}}}]}},default:{}}]},{type:"attr",position:[3,1,3,1]},{type:"for",position:[3,1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background-image: url('","key.image_url","');'"]}}}}]}},default:{}}]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[7]},{type:"attr",position:[9]},{type:"componentDynamic",position:[9]},{type:"attr",position:[11]},{type:"componentDynamic",position:[11]},{type:"attr",position:[13]},{type:"componentDynamic",position:[13]},{type:"attr",position:[15]},{type:"componentDynamic",position:[15]},{type:"attr",position:[17]},{type:"componentDynamic",position:[17]}],_observedAttributes:["index","page","editAllowed","moduleName","displayMessage","action","readOnly","isChangeButton","approvals","showReviewButtons","showRecActions","recordModule","isSaveAndNew","isMyJobsPage","byPassAlert","selectedAppObj","showImgActions","disableSaveClose","disaleApproveRec","disaleDeleteRec","disaleAllButns","eventStopClass","per_pageDefault","previewURL","approvalDetailsArray","showHelpZia","vision_data","vision_feedback_details","is_record_locked","button_disable_tootip","labels"],data:function(){return{index:Lyte.attr("number",{default:0}),page:Lyte.attr("number",{default:1}),editAllowed:Lyte.attr("boolean",{default:!0}),moduleName:Lyte.attr("string"),displayMessage:Lyte.attr("string"),action:Lyte.attr("string"),readOnly:Lyte.attr("boolean"),isChangeButton:Lyte.attr("boolean",{default:!1}),approvals:Lyte.attr("array",{default:[]}),showReviewButtons:Lyte.attr("boolean",{default:!0}),showRecActions:Lyte.attr("boolean",{default:!0}),recordModule:Lyte.attr("object",{default:{}}),isSaveAndNew:Lyte.attr("boolean",{default:!1}),isMyJobsPage:Lyte.attr("boolean"),byPassAlert:Lyte.attr("boolean",{default:!1}),selectedAppObj:Lyte.attr("array",{default:[]}),showImgActions:Lyte.attr("boolean",{default:!1}),disableSaveClose:Lyte.attr("boolean",{default:!0}),disaleApproveRec:Lyte.attr("boolean",{default:!0}),disaleDeleteRec:Lyte.attr("boolean",{default:!0}),disaleAllButns:Lyte.attr("boolean",{default:!1}),eventStopClass:Lyte.attr("string",{default:""}),per_pageDefault:Lyte.attr("number",{default:10}),previewURL:Lyte.attr("string",{default:""}),approvalDetailsArray:Lyte.attr("array"),showHelpZia:Lyte.attr("array",{default:[]}),vision_data:Lyte.attr("array"),vision_feedback_details:Lyte.attr("array"),is_record_locked:Lyte.attr("boolean",!1),button_disable_tootip:Lyte.attr("string",{default:""}),labels:Lyte.attr("array",{default:[]})}},didDestroy:function(){var e=this;window.removeEventListener("resize",e.debounceResizeListener,!0),e.debounceResizeListener=void 0,e._resize=void 0},didConnect:function(){var e=this;e._resize=e.resize.bind(this),e.debounceResizeListener=$L.debounce((function(){e._resize()}),50),window.addEventListener("resize",e.debounceResizeListener,!0),setTimeout((function(){e._resize()}),150)},resize:function(){var e=this,t=this.$node.querySelector("#vision_failedRecordsTable"),a=$L("#wmstoolbar");$L.fastdom.measure((function(){var o=window.innerHeight-($L("#tabLayer").height()+$L(".myJobsParent > div.dIB").height()+$L(".myJobsContainer .lyteTabHead").height());a.length&&(o-=$L("#wmstoolbar").height()),o-=131,$L.fastdom.mutate((function(){$L(t).css("max-height",o+"px")})).bind(e)})).bind(e)},actions:{openPreview:function(e){commonUtils.showHideLoadingDiv(!0);var t="data:image/JPEG;base64,"+e.image;this.setData("previewURL",t),$L("#previewModal")[0].ltProp("show",!0),commonUtils.showHideLoadingDiv(!1)},approveImages:function(){var e=this,t=this.getData("selectedAppObj"),a=t.length;if(a<1)renderingUtils.showCustomAlert(I18n.getMsg("crm.zia.vision.action.performed"));else{Crm.client_tracking("Image Validation Metrics - Approvals reviewed"),this.setData("isChangeButton",!1),commonUtils.showHideLoadingDiv(!0),this.setData("isSaveClose",!0),this.setData("visionRecordSavedBannerMsg",I18n.getMsg("crm.zia.vision.record.save",this.getData("selectedRecordName")));for(var o=0,i=0;i<a;i++)"reject"===t[i].image_status&&o++;o===a&&this.setData("visionRecordSavedBannerMsg",I18n.getMsg("crm.zia.vision.record.save.noimage",this.getData("selectedRecordName"))),e.setData("disaleAllButns",!0),e.setData("disableSaveClose",!0),e.triggerBulkReviews(e,(function(t){if(t.vision_image_approvals){var a=t.vision_image_approvals.length;if(a>0){for(var o=0;o<a;o++)if("success"===t.vision_image_approvals[o].status){var i=e.getData("selectedRecord");e.setData("selectedRecord.images_count",i.images_count-1),e.setData("deleteId",i.id)}e.getData("isMyJobsPage")?($L("#myJobsVisionPop")[0].ltProp("show",!1),e.setData("selectedAppObj",[]),0===e.getData("selectedRecord.images_count")&&e.deleteRecEntry(e),setTimeout((function(){$L("#visionRecordSavedBanner")[0].ltProp("show",!0)}),500)):Lyte.Router.getRouteInstance().refresh()}}commonUtils.showHideLoadingDiv(!1),e.setData("disaleAllButns",!1)}))}},changeAction:function(e,t){this.getData("selected_action")!==t&&(this.setData("selectedAppObj",[]),"record_approval"===t?(this.setData("approvals",this.getData("record_approvals")),this.setData("eventStopClass",""),this.setData("showRecActions",!0),this.setData("showImgActions",!1),this.setData("disaleApproveRec",!0),this.setData("disaleDeleteRec",!0),this.setData("selected_action","record_approval")):(this.setData("approvals",this.getData("image_approvals")),this.getData("record_approvals").length>0?(this.setData("eventStopClass","op5 eventNone"),this.setData("showImgActions",!1)):this.setData("showImgActions",!0),this.setData("showRecActions",!1),this.setData("selected_action","image_approval")))},showSamplesPop:function(e){this.setData("visionId",e);var t=store.peekRecord("visions",e);this.setData("labels",this.getAllLabelIdsOfVision(t)),this.setData("selectedLabelId",this.getData("labels")[0].id);var a=$L("#trainingImgDropdown");a&&a[0]&&a[0].cxProp("selected",this.getData("selectedLabelId")),this.showSampleImages(this,t)},closeSamplePopUp:function(){$L("#visionSamplesModal")[0].ltProp("show",!1)},changeImage:function(){this.setData("isChangeButton",!0),$L("#myJobsVisionPop")[0].ltProp("show",!1)},approveRecord:function(){var e=this;if(this.getData("selectedAppObj").length<1)renderingUtils.showCustomAlert(I18n.getMsg("crm.zia.vision.action.performed"));else{this.setData("isChangeButton",!1),commonUtils.showHideLoadingDiv(!0),this.setData("isSaveClose",!0),this.setData("disaleApproveRec",!0),this.setData("disaleDeleteRec",!0);this.getData("selectedAppObj");e.setData("disaleAllButns",!0),e.setData("disaleApproveRec",!0),e.setData("disaleDeleteRec",!0);e.triggerBulkReviews(e,(function(t){if(e.setData("disaleAllButns",!1),t.vision_record_approvals){var a=t.vision_record_approvals.length;if(a>0){for(var o=0;o<a;o++)"success"===t.vision_record_approvals[o].status&&(e.setData("selectedRecord.images_count",e.getData("selectedRecord.images_count")-1),e.setData("selectedRecord.prioritized_action","image_approval"),e.setData("action","image_approval"),e.setData("deleteId",e.getData("selectedRecord").id),commonUtils.showHideLoadingDiv(!1));e.getData("isMyJobsPage")?(0===e.getData("selectedRecord.images_count")?($L("#myJobsVisionPop")[0].ltProp("show",!1),e.deleteRecEntry(e)):(e.setData("record_approvals",[]),e.setData("approvals",e.getData("image_approvals")),e.setData("eventStopClass",""),e.setData("showRecActions",!1),e.setData("showImgActions",!0),e.setData("selectedAppObj",[]),e.setData("selected_action","image_approval")),setTimeout((function(){$L("#visionRecordApprovedBanner")[0].ltProp("show",!0)}),500)):("canvas"===Lyte.Router.getRouteInstance().routeName&&(Customization.dropCache=!0),Lyte.Router.getRouteInstance().refresh())}}e.setData("disaleApproveRec",!1),e.setData("disaleDeleteRec",!1)}))}},showDeleteAlertModal:function(){$L("#deleteApprovalModal")[0].ltProp("show",!0)},selectAllRecords:function(){$L(".myJobs_vision_RPItm:not(.myJobs_vision_RPItm_imgApproval) .myJobs_visionRPContCheckbox").attr("lt-prop-checked","true")},unselectAllRecords:function(){$L(".myJobs_vision_RPItm:not(.myJobs_vision_RPItm_imgApproval) .myJobs_visionRPContCheckbox").attr("lt-prop-checked","false")},acceptImg:function(e,t){var a=$L(e).closest(".visionApprovalItm"),o=this.getData("selectedAppObj");if(a.hasClass("visionApprovalItm_rejected"))for(var i=o.length,s=0;s<i;s++)if(o[s].id===t){Lyte.arrayUtils(o,"removeAt",s,1);break}var p={image_status:"approve"};p.id=t,"image_approval"===this.getData("selected_action")&&this.setData("disableSaveClose",!1),o.push(p),o.length>0&&(this.setData("disaleApproveRec",!1),this.setData("disaleDeleteRec",!1)),this.setData("selectedAppObj",o),this.checkAndShowHelpZia(t),a.addClass("visionApprovalItm_accepted").removeClass("visionApprovalItm_rejected");var l=a.find(".zv_learningSection");1===l.length&&l[0].scrollIntoView({behavior:"smooth"})},rejectImg:function(e,t){var a=this.getData("selectedAppObj"),o=$L(e).closest(".visionApprovalItm");if(o.hasClass("visionApprovalItm_accepted"))for(var i=a.length,s=0;s<i;s++)if(a[s].id===t){Lyte.arrayUtils(a,"removeAt",s,1);break}var p={};p.id=t,p.image_status="reject",p.id=t,"image_approval"===this.getData("selected_action")&&this.setData("disableSaveClose",!1),a.push(p),a.length>0&&(this.setData("disaleApproveRec",!1),this.setData("disaleDeleteRec",!1)),this.checkAndShowHelpZia(t),o.addClass("visionApprovalItm_rejected").removeClass("visionApprovalItm_accepted")},openValidationPop:function(e){var t=this;this.setData("isChangeButton",!1),this.setData("isSaveClose",!1),this.setData("showHelpZia",[]),commonUtils.showHideLoadingDiv(!0);var a=t.getData("records"),o=a.length;this.setData("eventStopClass","");for(var i=0;i<o;i++)if(a[i].id===e){t.setData("selectedRecord",a[i]),t.setData("recordModule",a[i].module),t.setData("prioritized_action",a[i].prioritized_action),t.setData("action",a[i].prioritized_action),"record_approval"===a[i].prioritized_action?(t.setData("showRecActions",!0),t.setData("showImgActions",!1)):(t.setData("showImgActions",!0),t.setData("showRecActions",!1)),t.setData("selected_action",a[i].prioritized_action);break}this.getDisplayMessage(this),t.setData("selectedRecordName",t.getData("selectedRecord").name);var s={};return s.record_id=e,s.fields="object_details",s.page="1",s.per_page=this.getData("per_pageDefault"),store.triggerAction("visions","record_approvals",{},s).then((function(e){if(commonUtils.showHideLoadingDiv(!1),e.vision_approvals&&e.vision_approvals[0])return t.approvalsCallbackAndImageFetch(s,e,!0);renderingUtils.showCustomAlert(I18n.getMsg("crm.zia.vision.message.fail.validated"),I18n.getMsg("crm.zia.vision.action.performed"),!0)}),(function(e){t.approvalsErrorHandler(e,!0)}))},closeValidationPop:function(){$L("#myJobsVisionPop")[0].ltProp("show",!1)}},methods:{bindShadowUtils:function(e){this.applyScrollShadow(e.childComp)},onDownload:function(){return!0},openPreviewPopup:function(e,t){this.addMarkers(this.getData("approvalDetailsArray"),t)},closeValidationPopUp:function(){this.setData("selectedAppObj",[]),this.setData("isChangeButton",!1),this.setData("disableSaveClose",!0),this.setData("disaleApproveRec",!0),this.setData("disaleDeleteRec",!0)},setFocusonInput:function(e){var t=$L("."+e);if(t.length){var a=t.find("input").eq(0);t[0].setValue(""),void 0!==a&&a.focus()}},showNoResult:function(e,t){if(0===t.length){if(document.querySelector(".noresultstyle"))return;var a=document.querySelector("."+e),o=document.createElement("div");o.setAttribute("class","noresultstyle aligncenter mB7 mT7 crm-font-regular crmParagraphColor"),o.textContent=I18n.getMsg("crm.zia.vision.no.record"),a.appendChild(o)}else{var i=document.querySelector(".noresultstyle");i&&i.remove()}},deleteRecord:function(){var e=this;this.setData("isChangeButton",!1),commonUtils.showHideLoadingDiv(!0);var t={page:"my_jobs_page",type:"reject_record"},a=this.getData("record_approvals");return this.setData("deleteId",a[0].record.id),t.isBulk=!0,e.setData("disaleAllButns",!0),store.triggerAction("visions","delete_record",{recordObj:e.getData("selectedRecord"),moduleObj:store.peekRecord("module",e.getData("selectedRecord").module.id)}).then((function(t){!function(t){if("success"===t.vision_record_approvals[0].status){if(e.setData("byPassAlert",!0),commonUtils.showHideLoadingDiv(!1),$L("#myJobsVisionPop")[0].ltProp("show",!1),e.getData("isMyJobsPage"))e.deleteRecEntry(e),setTimeout((function(){$L("#visionRecordDeletedBanner")[0].ltProp("show",!0)}),500);else{var a=$L("#detailNext"),o=$L("#detailPrevious");if(a.length>0)a[0].click();else if(o.length>0)o[0].click();else{var i=store.peekRecord("module",moduleRecordMapping[e.getData("moduleName")].id).custom_view.id;Lyte.Router.transitionTo({route:"crm.tab.module.custom-view.list",dynamicParams:[e.getData("moduleName"),i]})}}e.setData("disaleAllButns",!1)}}(t)}),(function(e){var t=JSON.parse(e.response);t.vision_record_approvals&&"INVALID_DATA"===t.vision_record_approvals[0].code?renderingUtils.showCustomAlert(I18n.getMsg("crm.zia.vision.message.fail.validated"),I18n.getMsg("crm.zia.vision.action.performed"),!0):t.vision_record_approvals&&"NO_PERMISSION"===t.vision_record_approvals[0].code?renderingUtils.displayPermissionDenied():renderingUtils.showCustomAlert(I18n.getMsg("crm.zia.vision.oops"))}))},checkForAlert:function(){if(this.getData("selectedAppObj").length>0&&!this.getData("isSaveClose")&&!this.getData("byPassAlert"))return $L("#cancelApprovalModal")[0].ltProp("show",!0),!1;this.setData("byPassAlert",!1),this.triggerChangeImage(this)},redirectToOut:function(){$L("#cancelApprovalModal")[0].ltProp("show",!1),this.setData("selectedAppObj",[]),$L("#myJobsVisionPop")[0].ltProp("show",!1),this.triggerChangeImage(this)},abortToOut:function(e){$L("#"+e)[0].ltProp("show",!1)},setModule:function(e,t){var a=this;commonUtils.showHideLoadingDiv(!0);var o={},i=$L("crm-myjobs")[0].component,s=i.getData();return 0!==s.totalNumberOfRecords&&t===a.getData("selectedModule")?(o.per_page=s.recordPerPage,o.page=s.page):(o.per_page=s.recordPerPage,o.page="1"),this.getmyJobsApprovals(o.page,o.per_page,(function(e){e.total_records||(e.total_records=[],e.meta=[]),a.setData("records",e.total_records),a.setData("recordInfo",e.meta),a.setData("selectedModule",t),commonUtils.showHideLoadingDiv(!1);var o=$L(".myJobsFooter");function p(e){e>0&&(o.show(),a._resize()),i.setData("page",1),i.setData("initialIndex",0),a.setData("total_count",e),i.setData("totalNumberOfRecords",e),a.setData("index",(s.page-1)*s.recordPerPage),i.setData("myjobs_footer_count_loading",!1),commonUtils.showHideLoadingDiv(!1)}if(e.meta.more_records)return a.setData("hideNavigator",""),i.setData("myjobs_footer_count_loading",!0),a.getMyJobsGroupCount(t,p,(function(){i.setData("myjobs_footer_count_loading",!1),commonUtils.showHideLoadingDiv(!1),renderingUtils.showCustomAlert(I18n.getMsg("crm.zia.vision.oops"))}));e.meta.count&&p(e.meta.count),a.setData("hideNavigator","displayNone"),e&&e.total_records.length>0?o.show():o.hide(),a._resize()}),t)},changeLabel:function(e,t){var a=this.getData("visionId"),o=store.peekRecord("visions",a);this.showSampleImages(this,o,t)}},triggerChangeImage:function(e){e.getData("isChangeButton")&&(e.getData("showReviewButtons")?showUploadPhoto(e.getData("moduleName"),e.getData("selectedRecord.id")):showUploadPhoto(e.getData("moduleName"),e.getData("selectedRecord.id"),"edit"))},deleteRecEntry:function(e){for(var t=e.getData("records"),a=t.length,o=$L("crm-myjobs")[0].component,i=0;i<a;i++)if(t[i].id===e.getData("deleteId")){Lyte.arrayUtils(t,"removeAt",i,1),e.getData("total_count")>0&&e.setData("total_count",e.getData("total_count")-1),o.setData("totalNumberOfRecords",o.getData("totalNumberOfRecords")-1),o.getData("jobs_count.image_validation")&&o.getData("jobs_count.image_validation")>0&&o.setData("jobs_count.image_validation",o.getData("jobs_count.image_validation")-1);break}var s=o.getData("page");e.setData("recordPerPage",o.getData("recordPerPage")),0===t.length&&s>1?(e.setData("page",s-1),o.setData("page",s-1),e.visionMyJobsPageChange(e)):t.length<e.getData("recordPerPage")&&e.getData("recordInfo").more_records&&e.visionMyJobsPageChange(e)}},{mixins:["crm-vision-create","crm-vision-validation","crm-image-mixin","crm-vision-match-utils","crm-vision-image-utils","modal-scroll-box-shadow"]}),Lyte.Component.registerHelper("getDifferenceDates",(function(e){var t=new Date(e.toString()),a=new Date,o=[1e3,60,60,24],i=new Date(t.toUTCString()),s=new Date(a.toUTCString()),p=s-i,l=new Date((new Date).setDate(s.getDate()-1));if(i.toDateString()==s.toDateString()||s.getTime()<=i.getTime())return I18n.getMsg("Today");if(i.toDateString()==l.toDateString())return I18n.getMsg("Yesterday");var n=[];n.push(p);for(var r=o.length,d=0;d<r;d++)n.push(parseInt(n[d]/o[d])),n[d]=n[d]%o[d];var c=n.reverse().slice(0,-1),m=t.getFullYear(),u=m%4==0&&m%100!=0||m%400==0?366:365,v=c[0]/u,y=(v-(m=Math.floor(v)))*u;c[0]=Math.floor(y);var g="";return(c=[m].concat(c))[0]>0?g=c[0]+" "+I18n.getMsg("years"):c[1]>0&&(g=c[1]>30?Math.floor(c[1]/30)+" "+I18n.getMsg("months"):c[1]+" "+I18n.getMsg("days")),g}));
