Lyte.Component.register("crux-text-component",{_template:'<template tag-name="crux-text-component"><template is="if" value="{{lyteViewPort}}"><template case="true"><dummy-port-element></dummy-port-element> <div id="cruxLoadingElem" class="cxLoadOnViewElement" tabindex="{{if(cxPropTabIndex,cxPropTabIndex,cxPropTabindex)}}" onfocus="{{action(\'focusOnViewElement\')}}"> <template is="if" value="{{cxPropField[cxPropFieldKey]}}"><template case="true"> <div class="cxLoadOnViewLabel"> {{cxPropField[cxPropFieldKey]}} <div class="cxLoadOnViewLoader"></div> </div> </template></template> <div class="cxLoadOnViewValue"> {{cxPropValue}} <div class="cxLoadOnViewLoader"></div> </div> </div> <dummy-port-element></dummy-port-element></template><template case="false"> <template is="switch" value="{{cxPropFrom}}"><template case="view"> <span class="cxElemCompViewWrap" onclick="{{action(\'viewClicked\',event)}}"> <template is="if" value="{{expHandlers(cxPropValue,\'!\')}}"><template case="true"><template is="if" value="{{cxPropEmptyValue}}"><template case="true">{{cxPropEmptyValue}}</template></template></template><template case="false"><template is="if" value="{{cxPropMaskingProperties}}"><template case="true">{{cruxMaskValue(cxPropValue,cxPropMaskingProperties)}} </template><template case="false"><template is="if" value="{{cxPropTooltip}}"><template case="true"><lyte-text lt-prop-value="{{cxPropValue}}"></lyte-text></template><template case="false"><template is="if" value="{{cxPropUnescape}}"><template case="true">{{unescape(cxPropValue)}}</template><template case="false">{{cxPropValue}}</template></template></template></template><template is="if" value="{{cxPropViewYieldSuffix}}"><template case="true"><lyte-yield yield-name="viewYieldSuffix" prop-field="{{cxPropField}}" prop-value="{{cxPropValue}}"></lyte-yield></template></template><template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}" cx-prop-id="{{cxPropId}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template></template></template></template></template> </span> </template><template case="criteria"></template><template case="filter"></template><template case="create"> <template is="if" value="{{expHandlers(expHandlers(cxPropFrom,\'===\',&quot;create&quot;),\'&amp;&amp;\',cxPropField[cxPropFieldKey])}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> <template is="if" value="{{expHandlers(cxPropMandatoryType,\'==\',\'asterisk\')}}"><template case="true"> <span class="cxMandatoryType">{{cxPropMandatoryOption[cxPropMandatoryType]}}</span> </template></template> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{expHandlers(cxPropMandatoryType,\'==\',\'required\')}}"><template case="true"> <span class="cxMandatoryType">{{cxPropMandatoryOption[cxPropMandatoryType]}}</span> </template></template> <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB cxVam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{unescape(cruxEncodeHTML(cxPropInfoTooltip))}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}} {{if(cxPropDisplayIcon,\'cxBoxWithRightIcon\',\'\')}} {{if(cxPropExpandWidthOnChange,\'cxTextCompExpandable\',\'\')}}"> <template is="if" value="{{cxPropPrefixYield}}"><template case="true"><lyte-yield yield-name="prefixYield" style="position: absolute; z-index:1; padding-top:10px; padding-left:5px;"></lyte-yield></template></template> <template is="if" value="{{cxPropAutocompleteOptions.enable}}"><template case="true"> <div class="cxLookupComponent cxBoxWithRightIcon {{cxPropWrapperClass}}"> <div class="cxBoxLeftContent"> <lyte-autocomplete id="{{cxPropId}}" lyte-hovercard="{{if(cxPropErrorOnHovercard,\'true\',\'false\')}}" lt-prop-external-search="{{cxPropAutocompleteOptions.externalSearch}}" lt-prop-content="{{records}}" lt-prop-data-tabindex="{{cxPropDataTabindex}}" lt-prop-yield="{{cxPropAutocompleteOptions.yield}}" lt-prop-dropdown-height="250px" lt-prop-dropdown-class="cxLookupDropbox cxDropbox" lt-prop-min-length="{{cxPropAutocompleteOptions.minLength}}" on-ext-search="{{method(\'onExtSearchAutoComp\')}}" on-search="{{method(\'onSearchAutoComp\')}}" on-select="{{method(\'onSelectAutoComp\')}}" on-scroll="{{method(\'onScrollAutoComp\')}}" on-before-show="{{method(\'onBeforeOpenAutoComp\')}}" on-blur="{{method(\'onBlurAutoComp\')}}" lt-prop-appearance="{{cxPropAppearance}}" lt-prop-maxlength="{{cxPropMaxlength}}" after-render="{{method(\'afterRenderAutocomplete\')}}" lt-prop-method="{{cxPropAutocompleteOptions.method}}" lt-prop-label="{{cxPropAutocompleteOptions.displayField}}" lt-prop-description="{{cxPropAutocompleteOptions.descriptionField}}" lt-prop-value="{{cxPropValue}}" lt-prop-class="{{cxPropInputClass}}" lt-prop-disabled="{{cxPropDisabled}}" onfocus="{{action(\'onFocusInput\')}}" onfocusout="{{action(\'onFocusInput\',true)}}" onkeyup="{{action(\'clearSelection\')}}" lt-prop-open-on-focus="true" lt-prop-password-icon="{{cxPropPasswordIcon}}" lt-prop-tab-index="{{if(cxPropTabIndex,cxPropTabIndex,cxPropTabindex)}}" lt-prop-dropdown="{&quot;forceCalculateWidth&quot; : true}" data-zcqa="{{cxPropZcqa}}" on-show="{{method(\'onDropdownOpen\')}}" on-hide="{{method(\'onDropdownClose\')}}"> <template is="yield" yield-name="yield"> <lyte-drop-box> <lyte-drop-body class="cxVisibleLookup" style="{{if(ifEquals(records.length,0),\'display: none\',\'\')}}"> <template is="for" items="{{records}}" item="val" index="index"> <lyte-drop-item data-value="{{val[cxPropAutocompleteOptions.idField]}}" onmouseenter="{{action(\'showHideIcon1\',true,val)}}" onmouseleave="{{action(\'showHideIcon1\',false,val)}}"> <lyte-autocomplete-label> <lyte-text class="cxLookupDropboxLabel {{cxPropAutocompleteOptions.displayFieldClass}}" lt-prop-value="{{val[cxPropAutocompleteOptions.displayField]}}"></lyte-text> <template is="if" value="{{cxPropShowHideTooltip}}"><template case="true"> <span class="cxLookupInfoIcon {{if(val.cxPropShowIcon,\'cruxLookupPopover\')}}" onmouseenter="{{action(\'infoPop\',this,val,event)}}" onmouseleave="{{action(\'infoPop\',this,val,event)}}" style="{{if(val.cxPropShowIcon,\'visibility: visible;\',\'visibility: hidden\')}}"></span> </template></template> </lyte-autocomplete-label> <template is="if" value="{{cxPropAutocompleteOptions.descriptionField}}"><template case="true"><lyte-autocomplete-description> <span class="{{cxPropAutocompleteOptions.descriptionFieldClass}}">{{val[cxPropAutocompleteOptions.descriptionField]}}</span> </lyte-autocomplete-description></template></template> </lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-autocomplete> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <div class="cxBoxSpinWrapper cxFlexCenter"> <span class="cxElementsLoaderBg" style="display: none;"></span> </div> </div> </div> </template><template case="false"> <lyte-input lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-data-tabindex="{{cxPropDataTabindex}}" lyte-hovercard="{{if(cxPropErrorOnHovercard,\'true\',\'false\')}}" lt-prop-update-delay="{{defaultUndefined}}" lt-prop-title="{{tooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-class="cxBorderBottom {{cxPropInputClass}}" class="cxW100Per {{if(ifEquals(cxPropAppearance,\'box\'),\'cxBoxInput\',\'cxFlatInput\')}}" lt-prop-direction="{{cxPropDirection}}" lt-prop-wrapper-style="{{cxPropWrapperStyle}}" lt-prop-value="{{lbind(cxPropValue)}}" lt-prop-placeholder="{{cxPropPlaceholder}}" lt-prop-maxlength="{{cxPropMaxlength}}" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-readonly="{{cxPropReadonly}}" data-zcqa="{{cxPropZcqa}}" on-value-change="{{method(\'inputValueChange\')}}" lt-prop-appearance="{{cxPropAppearance}}" lt-prop-tab-index="{{if(cxPropTabIndex,cxPropTabIndex,cxPropTabindex)}}" lt-prop-focus="{{cxPropFocus}}" lt-prop-autofocus="{{cxPropAutofocus}}" lt-prop-autocomplete="{{cxPropAutocomplete}}" lt-prop-auto-update="{{cxPropEnableLbind}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" lt-prop-tooltip-class="cxElementsTooltip {{cxPropTooltipClass}}" lt-prop-wrapper-class="{{cxPropWrapperClass}}" onfocus="{{action(\'focusCallback\',event)}}" lt-prop-type="{{cxPropType}}" lt-prop-callback-delay="{{cxPropCallbackDelay}}" on-blur="{{method(\'onBlurCallback\')}}" onkeydown="{{action(\'checkRegex\')}}" lt-prop-close-icon="{{cxPropCloseIcon}}" lt-prop-width="{{if(cxPropExpandWidthOnChange,cxPropWidth,\'\')}}" onkeyup="{{action(\'expandOnValue\')}}" on-clear="{{method(\'onCloseIconClick\')}}" lt-prop-password-icon="{{cxPropPasswordIcon}}" lt-prop-focus-at-end="{{cxPropFocusAtEnd}}" lt-prop="{{checkElementsData(this,childCompProps)}}"></lyte-input> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> </template></template> <template is="if" value="{{cxPropButtonYield}}"><template case="true"><lyte-yield class="cxElemButtonYield" yield-name="buttonYield"></lyte-yield></template></template> <template is="if" value="{{cxPropShowWarning}}"><template case="true"> <div class="cxFieldWarningMsg"><span class="cxPropWarningIconSpacing {{cxPropWarningIconClass}}"></span> <span class="cxPropWarningMsgTxt">{{unescape(cxPropWarningMessage)}}</span></div> </template><template case="false"><template is="if" value="{{isError}}"><template case="true"> <crux-error-message cx-prop-aria-error-properties="{{cxPropAriaErrorProperties}}" cx-prop-origin-elem="#{{cxPropId}}" cx-prop-error-on-hovercard="{{cxPropErrorOnHovercard}}" error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template></template></template> <template is="if" value="{{cxPropDisplayIcon}}"><template case="true"> <div class="cxBoxRightIcon cxFlexCenter {{cxPropRightIconClass}}" onclick="{{action(\'handleIconClick\')}}"> <div class="cP {{cxPropIconClass}}"></div> </div> </template></template> </div> </template></template> </template></template></template>',_dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[0]},{type:"attr",position:[2]},{type:"attr",position:[2,1]},{type:"if",position:[2,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"text",position:[2,3,1]},{type:"componentDynamic",position:[4]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"componentDynamic",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]}},default:{}},{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]}},default:{}},{type:"attr",position:[2]},{type:"if",position:[2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]},criteria:{dynamicNodes:[],additional:{next:"filter"}},filter:{dynamicNodes:[],additional:{next:"create"}},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"text",position:[1,3]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[1,7]},{type:"if",position:[1,7],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"insertYield",position:[0]}]}},default:{}},{type:"attr",position:[3,3]},{type:"if",position:[3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"registerYield",position:[1,1,1,1],dynamicNodes:[{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"if",args:[{type:"helper",value:{name:"ifEquals",args:["records.length",0]}},"'display: none'","''"]}}}},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"if",args:["val.cxPropShowIcon","'visibility: visible;'","'visibility: hidden'"]}}}}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0,1]},{type:"text",position:[0,1,0]},{type:"componentDynamic",position:[0]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]}},default:{}},{type:"attr",position:[3,5]},{type:"if",position:[3,5],cases:{true:{dynamicNodes:[{type:"insertYield",position:[0]}]}},default:{}},{type:"attr",position:[3,7]},{type:"if",position:[3,7],cases:{true:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"text",position:[1,2,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[3,9]},{type:"if",position:[3,9],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]}]}},default:{}}]}},default:{}}]}},default:{}}],_observedAttributes:["cxPropElementProps","childCompProps","cxPropErrorOnHovercard","cxPropFocus","cxPropAutofocus","lyteViewPort","cxPropValue","cxPropFrom","cxPropPlaceholder","cxPropField","cxPropMaxlength","cxPropDisabled","cxPropReadonly","cxPropWrapperStyle","cxPropClass","cxPropZcqa","cxPropIgnoreEmptyValue","cxPropAppearance","cxPropErrorMessage","cxPropDirection","cxPropFieldKey","cxPropId","cxPropName","cxPropClearErrorMessage","isError","cxPropTabIndex","cxPropTabindex","lyteUnbound","cxPropLabelClass","cxPropEmptyValue","cxPropTooltip","defaultUndefined","cxPropErrorYield","cxPropInfoTooltip","cxPropAutocomplete","cxPropEnableLbind","cxPropAria","cxPropAriaAttributes","cxPropMaskingProperties","cxPropTooltipConfig","cxPropTooltipClass","records","cxPropAutocompleteOptions","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropErrorClass","cxPropWrapperClass","cxPropInputClass","cxPropErrorSpanClass","cxPropLayout","cxPropViewInfoTooltip","cxPropShowDisabledIcon","cxPropDisabledIconClass","tooltip","cxPropType","cxPropCallbackDelay","cxPropUpdateDelay","cxPropAutofocus","cxPropCloseIcon","cxPropButtonTextInsideElement","cxPropMandatory","cxPropDisplayIcon","cxPropRightIconClass","cxPropIconClass","cxPropDataTabindex","cxPropMandatoryOption","cxPropMandatoryType","cxPropErrorIconClass","cxPropWarningMessage","cxPropShowWarning","cxPropWarningIconClass","cxPropShowHideTooltip","cxPropPreventFocusOnError","cxPropExpandWidthOnChange","cxPropWidth","cxPropMaxWords","cxPropMetaMoreRecords","cxPropUnescape","cxPropPasswordIcon","cxPropButtonYield","cxPropFocusAtEnd","cxPropFocusAtEnd","cxPropAriaErrorProperties"],data:function(){return{cxPropElementProps:Lyte.attr("object",{default:{}}),childCompProps:Lyte.attr("object",{default:{}}),cxPropErrorOnHovercard:Lyte.attr("boolean",{default:!1}),cxPropFocus:Lyte.attr("boolean",{default:!1}),cxPropAutofocus:Lyte.attr("boolean",{default:!1}),lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("string"),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropPlaceholder:Lyte.attr("string"),cxPropField:Lyte.attr("object",{default:{}}),cxPropMaxlength:Lyte.attr("number"),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropReadonly:Lyte.attr("boolean",{default:!1}),cxPropWrapperStyle:Lyte.attr("string"),cxPropClass:Lyte.attr("string",{default:""}),cxPropZcqa:Lyte.attr("string"),cxPropIgnoreEmptyValue:Lyte.attr("boolean",{default:!1}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropErrorMessage:Lyte.attr("string",{default:""}),cxPropDirection:Lyte.attr("string",{default:"vertical"}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),isError:Lyte.attr("boolean",{default:!1}),cxPropTabIndex:Lyte.attr("string"),cxPropTabindex:Lyte.attr("string"),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropLabelClass:Lyte.attr("string",{default:""}),cxPropEmptyValue:Lyte.attr("string",{default:""}),cxPropTooltip:Lyte.attr("string"),defaultUndefined:Lyte.attr("string"),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropAutocomplete:Lyte.attr("string",{default:"on"}),cxPropEnableLbind:Lyte.attr("boolean",{default:!0}),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),cxPropMaskingProperties:Lyte.attr("object"),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "followcursor", "appearance": "box"}'}),cxPropTooltipClass:Lyte.attr("string"),records:Lyte.attr("array"),cxPropAutocompleteOptions:Lyte.attr("object",{default:{},hideAttr:!0}),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropErrorClass:Lyte.attr("string"),cxPropWrapperClass:Lyte.attr("string"),cxPropInputClass:Lyte.attr("string",{default:""}),cxPropErrorSpanClass:Lyte.attr("string"),cxPropLayout:Lyte.attr("string"),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""}),tooltip:Lyte.attr("string"),cxPropType:Lyte.attr("string",{default:"text"}),cxPropCallbackDelay:Lyte.attr("number",{default:0}),cxPropUpdateDelay:Lyte.attr("number",{default:250}),cxPropAutofocus:Lyte.attr("boolean",{default:!1}),cxPropCloseIcon:Lyte.attr("boolean",{default:!1}),cxPropButtonTextInsideElement:Lyte.attr("string"),cxPropMandatory:Lyte.attr("boolean"),cxPropDisplayIcon:Lyte.attr("boolean",{default:!1}),cxPropRightIconClass:Lyte.attr("string"),cxPropIconClass:Lyte.attr("string"),cxPropDataTabindex:Lyte.attr("string"),cxPropMandatoryOption:Lyte.attr("object",{default:{red_accent_line:"",asterisk:"*",required:"("+_cruxUtils.getI18n("crm.label.required")+")"}}),cxPropMandatoryType:Lyte.attr("string",{default:"red_accent_line"}),cxPropErrorIconClass:Lyte.attr("string"),cxPropWarningMessage:Lyte.attr("string"),cxPropShowWarning:Lyte.attr("boolean",{default:!1}),cxPropWarningIconClass:Lyte.attr("string"),cxPropShowHideTooltip:Lyte.attr("boolean",{default:!1}),cxPropPreventFocusOnError:Lyte.attr("boolean",{default:!1}),cxPropExpandWidthOnChange:Lyte.attr("boolean",{default:!1}),cxPropWidth:Lyte.attr("string"),cxPropMaxWords:Lyte.attr("number",{default:50}),cxPropMetaMoreRecords:Lyte.attr("string",{default:"more_records"}),cxPropUnescape:Lyte.attr("boolean"),cxPropPasswordIcon:Lyte.attr("boolean",{default:!1}),cxPropButtonYield:Lyte.attr("boolean",{default:!1}),cxPropFocusAtEnd:Lyte.attr("boolean",{default:!1}),cxPropFocusAtEnd:Lyte.attr("boolean",{default:!1}),cxPropAriaErrorProperties:Lyte.attr("object")}},validate:function(){var e=this.getValue(),t=this.getData("cxPropField");return"create"==this.getData("cxPropFrom")?this.validateText(t,e):"filter"!=this.getData("cxPropFrom")||(e&&""!=e.trim()||this.getData("cxPropIgnoreEmptyValue"))&&!this.isEmoji(e)?"criteria"!==this.getData("cxPropFrom")||e&&""!==e.trim()||this.getData("cxPropIgnoreEmptyValue")?!(e&&e.replace(/^\s+/g,"").replace(/\s+$/g,"").indexOf("*")>-1)||(this.showAlert(_cruxUtils.getI18n("crm.alert.character.not.allowed","*")),this.$node.querySelector("input").focus(),!1):(this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),!1):(this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),this.$node.querySelector("input").focus(),!1)},getValue:function(e){if(("criteria"==this.getData("cxPropFrom")||"filter"==this.getData("cxPropFrom"))&&this.getData("cxPropValue"))return"string"==typeof this.data.cxPropValue?this.getData("cxPropValue").trim():this.getData("cxPropValue");if("create"==this.data.cxPropFrom&&this.data.cxPropAutocompleteOptions.enable&&this.$node.querySelector("lyte-autocomplete")){var t=this.$node.querySelector("lyte-autocomplete");return e?t.ltProp(e):t.ltProp("value")}return"string"==typeof this.data.cxPropValue?this.getData("cxPropValue").trim():this.getData("cxPropValue")},resetData:function(){this.$node.querySelector("lyte-input").ltProp("value","")},methods:{inputValueChange:function(e){this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),e.newValue&&e.newValue.split(",").length>this.data.cxPropMaxWords&&(this.showAlert(_cruxUtils.getI18n("crm.alert.maximum.text.values.contains",this.data.cxPropMaxWords)),this.setData("cxPropValue",e.oldValue)),this.inFocus=!0,this.getMethods("onValueChange")&&this.executeMethod("onValueChange",null==this.data.cxPropCallbackDelay?e.newValue:this.getValue()),this.inFocus=!1},hideInfoTooltip:function(){this.showHideInfoTooltip()},onExtSearchAutoComp:function(e,t,a){this.pageIndex=1,this.searchText=e.trim(),this.scrollEnd=!1,this.onscroll=!1,this.makeRequest()},onSearchAutoComp:function(e){if(this.data.cxPropAutocompleteOptions.externalSearch)return!1;0==e.length&&this.$node.querySelector("lyte-autocomplete").toggle()},onSelectAutoComp:function(e,t,a){if(this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),this.data.cxPropAutocompleteOptions.yield){for(var o=0;o<this.data.records.length;o++)if(this.data.records[o][this.data.cxPropAutocompleteOptions.idField]==e){this.setData("cxPropValue",this.data.records[o][this.data.cxPropAutocompleteOptions.displayField]),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.data.records[o]);break}}else this.setData("cxPropValue",e.name),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",e);this.$node.querySelector(".cxBoxWithRightIcon").classList.remove("cxBoxInputFocused")},onScrollAutoComp:function(e){if(!this.scrollEnd&&this.data.cxPropAutocompleteOptions.externalSearch){var t=e.target;t.scrollHeight<=Math.ceil(t.offsetHeight)+Math.ceil(t.scrollTop)&&(this.pageIndex++,this.onscroll=!0,this.makeRequest())}},onBeforeOpenAutoComp:function(){return!this.pageIndex&&this.data.cxPropAutocompleteOptions.externalSearch?(this.pageIndex=1,this.searchText=this.data.cxPropValue?this.data.cxPropValue:"",this.makeRequest()):void 0!==this.data.records&&0!==this.data.records.length&&void 0},onBlurAutoComp:function(){this.setData("cxPropValue",this.$node.querySelector("input").value),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.$node.querySelector("input").value),this.getMethods("onBlur")&&this.executeMethod("onBlur",event,element)},afterRenderAutocomplete:function(){if(this.$node.querySelector("lyte-input")){if("box"==this.getData("cxPropAppearance")&&this.$node.querySelector("lyte-input").classList.add("cxBoxInput"),!this.data.cxPropAutocompleteOptions.yield){if(this.data.cxPropAutocompleteOptions.content.length&&!this.data.cxPropAutocompleteOptions.content[0].name)for(var e=0;e<this.data.cxPropAutocompleteOptions.content.length;e++)this.data.cxPropAutocompleteOptions.content[e]={name:this.data.cxPropAutocompleteOptions.content[e]};this.setData("records",this.data.cxPropAutocompleteOptions.content)}this.data.cxPropAutocompleteOptions.method||Lyte.objectUtils(this.data.cxPropAutocompleteOptions,"add","method","contains")}},onBlurCallback:function(e,t){this.getMethods("onBlur")&&this.executeMethod("onBlur",e,t)},onCloseIconClick:function(e,t){this.getMethods("onClear")&&this.executeMethod("onClear",e,t)},onDropdownOpen:function(e,t){this.getMethods("onElementDropdownOpen")&&this.executeMethod("onElementDropdownOpen",this,e,t)},onDropdownClose:function(e,t){this.getMethods("onElementDropdownClose")&&this.executeMethod("onElementDropdownClose",this,e,t)}},actions:{viewClicked:function(e){this.getMethods("onValueClicked")&&this.executeMethod("onValueClicked",e,this)},showInfoTooltip:function(e){this.showHideInfoTooltip(e)},infoPop:function(e,t,a){var o=document.getElementById("cruxLookupPopover");"mouseenter"==a.type?(this.entered=!0,o||(o=Lyte.Component.render("crux-lookup-popup",{id:"cruxLookupPopover",fieldMapping:this.data.cxPropAutocompleteOptions.fieldMapping},"body")),o.setData({module:moduleRecordMapping[this.data.cxPropAutocompleteOptions.module],data:t,show:!0})):(this.entered=!1,o.setData("show",!1))},showHideIcon1:function(e,t){this.entered||Lyte.objectUtils(t,"add","cxPropShowIcon",e)},focusCallback:function(e){this.getMethods("onFocus")&&this.executeMethod("onFocus",e,this.$node)},checkRegex:function(){var e=new RegExp(/^[a-zA-Z0-9_]*$/);"alphanumeric"!=this.cxPropType||e.test(event.key)||event.preventDefault()},handleIconClick:function(){this.getMethods("onRightIconClick")&&this.executeMethod("onRightIconClick")},onFocusInput:function(e){e?this.$node.querySelector(".cxBoxWithRightIcon").classList.remove("cxBoxInputFocused"):this.$node.querySelector(".cxBoxWithRightIcon").classList.add("cxBoxInputFocused")},clearSelection:function(){this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),!this.$node.querySelector("input").value&&this.$node.querySelector("lyte-dropdown")&&this.$node.querySelector("lyte-dropdown").component.childComp&&this.$node.querySelector("lyte-dropdown").component.childComp.querySelector("lyte-drop-item[selected=true]")&&(this.setData("cxPropValue",""),this.$node.querySelector("lyte-dropdown").component.childComp.querySelector("lyte-drop-item[selected=true]").removeAttribute("selected"),this.$node.querySelector("lyte-dropdown").close())},expandOnValue:function(){if(this.data.cxPropExpandWidthOnChange){var e,t=this.$node.querySelector("input"),a=t.scrollWidth,o=this.$node.offsetWidth;if(46===event.keyCode||8===event.keyCode){var i=((e=document.createElement("canvas").getContext("2d")).font="1rem LatoRegular",e.measureText(t.value).width);console.log(i,a,o);var r=i+28,s=this.data.cxPropWidth.split("px")[0];r>o?r=o:r<s&&(r=s-2),t.style.width=r+"px",this.$node.querySelector("lyte-input").style.width=r+2+"px"}else a>o&&(a=o),t.style.width=a+"px",this.$node.querySelector("lyte-input").style.width=a+2+"px"}}},observeErrorMessage:function(){this.setData("isError",""!=this.getData("cxPropErrorMessage"))}.observes("cxPropErrorMessage").on("init"),observeIsError:function(){if("create"==this.getData("cxPropFrom")||"criteria"==this.data.cxPropFrom){var e=this.$node.querySelector("lyte-input");this.$node.querySelector(".cxBoxWithRightIcon")?this.data.isError?this.$node.querySelector(".cxBoxWithRightIcon").classList.add("cxErrorBoxWithRightIcon"):this.$node.querySelector(".cxBoxWithRightIcon").classList.remove("cxErrorBoxWithRightIcon"):e&&(this.getData("isError")?e.classList.add("cxErrorBox"):this.$node.querySelector("lyte-input")&&e.classList.remove("cxErrorBox"))}}.observes("isError","lyteViewPort").on("didConnect"),observeMandatory:function(){this.observeMandatoryMixin(this.data.cxPropAutocompleteOptions.enable?".cxLookupComponent":"lyte-input"),"create"===this.data.cxPropFrom&&(this.setFocusUtil(),this.setSelectUtil())}.observes("cxPropField.required","lyteViewPort","cxPropMandatory","cxPropFrom").on("didConnect"),init:function(){"create"!=this.data.cxPropFrom&&(this.data.cxPropAutocomplete="off"),this.cxPropType=void 0,"alphanumeric"==this.data.cxPropType&&(this.cxPropType=this.data.cxPropType,this.setData("cxPropType","text")),this.pageIndex=void 0,this.convertLtPropJson()},makeRequest:function(){var e=this.$node.querySelector(".cxElementsLoaderBg");return e.style.display="",this.executeMethod("fetchData",this.searchText,this.pageIndex,this.data.cxPropField).then(function(t){t&&0!=t.length||(this.scrollEnd=!0,this.onscroll||this.setData("records",[]),t=[]),this.onscroll?Lyte.arrayUtils(this.data.records,"push",t):this.setData("records",t),e.style.display="none",this.data.cxPropValue&&this.$node.querySelector("lyte-dropdown").component.childComp&&this.$node.querySelector("lyte-dropdown").component.childComp.querySelector("[data-value='"+this.data.cxPropValue+"']")&&this.$node.querySelector("lyte-dropdown").component.childComp.querySelector("[data-value='"+this.data.cxPropValue+"']").setAttribute("selected",!0),this.data.cxPropMetaMoreRecords&&t.$&&!1===t.$[this.data.cxPropMetaMoreRecords]&&(this.scrollEnd=!0);var a=this.$node.querySelector("lyte-autocomplete").querySelector("lyte-dropdown");0===this.data.records.length?a.close():(a.open(),a.resetPosition())}.bind(this),(function(){e.style.display="none"}))},ele:"lyte-input",observeClass:function(e){if("create"==this.data.cxPropFrom){var t=$L("lyte-input",this.$node);if(!t.length)return;e&&e.oldValue&&t.removeClass(e.oldValue),this.data.cxPropClass&&t.addClass(this.data.cxPropClass);var a=t.find("input")[0];if(this.data.cxPropExpandWidthOnChange&&a.scrollWidth>a.offsetWidth){var o=a.scrollWidth;o>this.$node.offsetWidth&&(o=this.$node.offsetWidth-2),a.style.width=o+"px",t[0].style.width=o+2+"px"}}}.observes("cxPropClass","lyteViewPort").on("didConnect"),observeRender:function(e){this.data.lyteViewPort||this.getMethods("onElementRendered")&&this.executeMethod("onElementRendered",this)}.observes("lyteViewPort").on("didConnect"),observeDisabled:function(){this.observeAndSetTooltip()}.observes("cxPropTooltip","cxPropDisabled").on("init"),mandatoryType:function(){this.observeMandatoryTypeMixin(this.data.cxPropAutocompleteOptions.enable?".cxLookupComponent":"lyte-input")}.observes("cxPropMandatoryType").on("didConnect"),observeAndSetAria:function(){this.data.cxPropAria&&this.observeAndSetAriaMixin()}.observes("cxPropAria").on("didConnect")},{mixins:["crux-element-validation","crux-filter-utils"]}),Lyte.Mixin.register("crux-element-validation",{isValidDate:function(e,t){if(!e)return!1;if(t=(t=(t=t||this.getData("cxPropDatePattern")).toUpperCase()).replace(/'/g,""),e=e.replace(/'/g,""),this.data.cxPropMinDate||this.data.cxPropMaxDate){var a,o,i=$L.moment(e,t).getDObj(),r=!1;if(this.data.cxPropMinDate&&(a=$L.moment(this.data.cxPropMinDate,t).getDObj(),i&&a&&i<a&&(r=!0)),this.data.cxPropMaxDate&&(o=$L.moment(this.data.cxPropMaxDate,t).getDObj(),i&&o&&i>o&&(r=!0)),r)return!1}try{return $L.moment(e,t,{i18n:!0}).validate()}catch(e){return!1}},isEmoji:function(e){return!!/([\uD800-\uDBFF][\uDC00-\uDFFF])/i.test(e)},SplitWord:function(e){e=e.split(",");for(var t,a,o=[],i=0;i<e.length;i++)-1!=(a=e[i].indexOf("\\"))&&e[i].length-2==a?(t=e[i].slice(0,e[i].length-2)+","+e[i+1],Lyte.arrayUtils(o,"push",t),i+=1):""!=e[i]&&Lyte.arrayUtils(o,"push",e[i]);return 1==o.length?o[0]:o},dateValidate:function(e){var t=this.isValidDate(e.value.trim(),this.getData("cxPropDatePattern"));if(!t){var a=this.getData("cxPropField"),o=(a.errorFieldLabel?a.errorFieldLabel:a.field_label).replace(/_____/g,")").replace(/____/g,"(").replace(/___/g,"."),i=_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(o));this.showAlert(i,e),e.setAttribute("autocomplete","off")}return t},patternValidate:function(e){!this.isValidDate(e.value,this.getData("cxPropDatePattern"))&&this.$node.querySelector("lyte-input").calendarDiv&&this.$node.querySelector("lyte-input").calendarDiv.querySelector("lyte-calendar").revertToToday()},showAlertMsg:function(e){var t=this;_cruxUtils.showCustomAlert({params:{cxPropYield:!0,cxPropHeading:e,cxPropButtonPosition:"center",cxPropButtons:[{type:"accept",text:_cruxUtils.getI18n("crm.mb.newversion.msg4"),appearance:"primary",cxPropZcqa:"button_primary"}],id:"cruxElementAlert"},close:function(){t&&t.$node.querySelector("lyte-input")?t.$node.querySelector("lyte-input").focus():t&&t.$node.querySelector("lyte-number")&&t.$node.querySelector("lyte-number").focus()}.bind(this)})},showAlert:function(e,t){if(this.getMethods("onError")){if(!this.executeMethod("onError",e,this))return!1}t&&t.focus(),this.showAlertMsg(e)},showMsgBox:function(e,t,a){if(this.getMethods("onError")){if(!this.executeMethod("onError",e,this))return!1}var o=document.getElementById("lyteMsgBox");a||(a={}),a.ltPropType=t,a.ltPropMessage=e,a.id="lyteMsgBox",o&&o.ltProp("show",!1),(o=Lyte.Component.render("lyte-messagebox",a,"body")).setMethods("onClose",(function(e){document.body.removeChild(e.$node)})),o.ltProp("show",!0)},getDateInUserDatePattern:function(e,t,a,o){var i;t=(t=t||this.getData("cxPropDatePattern")).toUpperCase(),1!=a&&(i=a);var r=$L.moment(e,i);return r.validate()||1==a?o?r.i18N(t):r.format(t):e},getTimeInUserFormat:function(e,t){var a=e.getHours(),o=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),i="";if("12"==(t=t||this.getData("cxPropTimeFormatInput"))){var r="PM";a>12?i=(a-=12)<10?"0"+a:a:0==a?(i="12",r="AM"):(i=a,a<10&&(i="0"+i),12!=a&&(r="AM")),i+=":"+o+" "+_cruxUtils.getI18n(r)}else a<10&&a.toString().length<2&&(a="0"+a),i=a+":"+o;return i},getDateObject:function(e,t,a){a=(a=a?a.toUpperCase():this.getData("cxPropDatePattern").toUpperCase()).replace(/'/g,"");var o=$L.moment(e,a,{i18n:!0}).getDObj();if(!o)return"";if(t){var i=t.match(/(\d{1,2}):(\d{1,2})/),r=(t=t.replace(_cruxUtils.getI18n("AM"),"AM").replace(_cruxUtils.getI18n("PM"),"PM")).match(/([A,P]M)/);if(t=t.split(":"),r){var s=this.convertTimeTo24HoursFormat(parseInt(i[0]),r[1]);o.setHours(s)}else o.setHours(t[0]);o.setMinutes(t[1].split(" ")[0])}return o},convertTimeTo24HoursFormat:function(e,t){return"am"==(t=t.toLowerCase())?0==e?12:12==e?0:e:"pm"==t?12==e?e:e+12:t==_cruxUtils.getI18n("AM")||_cruxUtils.getI18n("am")==t?0==e?12:12==e?0:e:t==_cruxUtils.getI18n("PM")||_cruxUtils.getI18n("pm")==t?12==e?e:e+12:void 0},isValidInteger:function(e){if(""==e)return!0;return!(isNaN(e)||-1!=e.indexOf(".")||!/^-?\d+(,(\d)+)*$/.test(e))},isValidDecimal:function(e){if(""==e)return!0;var t=/^-?(\d+)?(\.){0,1}(\d+)*$/.exec(e);return!!t&&(null!=t[1]||null!=t[3])},decimalLengthCheck:function(e,t){if(""==e)return!0;var a=/^-?(\d+)?(\.){0,1}(\d+)*$/.exec(e);if(!a)return!1;var o=a[3];return t=t||this.getData("cxPropField"),!(o&&o.length>t.decimal_place)},convertCurrencyValue:function(e,t,a,o,i,r,s,l,n,p,c,d,u){if("undefined"!=typeof Crm&&"undefined"!=typeof currencyUtils&&currencyUtils.returnValueInDefaultCurrency)return currencyUtils.returnValueInDefaultCurrency(e,t,a,r,void 0,u,n||0==n?n:this.data.cxPropDisplayCurrency,d?currencyUtils.ROUNDINGOPTION[d.toUpperCase()]:void 0);var m=["INR","BDT","MMK","PKR"];if(n=0!=n,!e&&"undefined"!=typeof Crm&&!Crm.userDetails.IS_MULTI_CURRENCY_ENABLED&&this.data&&m.indexOf(i||this.data.cxPropDefaultCurrencyIsoCode)>-1){var g=Crm.userDetails.DECIMAL_SEPARATOR.replace("_","-");return c=c||this.getData("cxPropDefaultOrgCurrency"),(n?c+" ":"")+currencyUtils.formatCurrencyValue(parseFloat(t),g,void 0,void 0,a)}var h=null!=p?parseFloat(t):this.getNumberWithCommas(parseFloat(t),",",".");a=a||0==a?a:this.getData("cxPropDefaultRoundOff");var y=parseFloat(t),f=(parseInt(y+"")+"").length;o=o||this.getData("cxPropCurrencyDetails"),i=i||this.getData("cxPropCurrencyCode");var x=t,D=Crm.userDetails.defaultRoundOff?Crm.userDetails.defaultRoundOff:2;if(void 0!==p)x=p;else{var v=(t+"").length,b=v==f?0:v-f-1;if(b>a||b<D&&b<a){var C=b>a?a:D;x=Number(parseFloat(t)).toFixed(C)}}if(o[i]&&e){a=parseInt(o[i].decimals);var S,L=parseInt(o[e].decimals);S=s?t*s:r?t/parseFloat(r)+"":t/parseFloat(o[e].er)+"";var P,_=o[e].format.split("|"),T=o[i].format.split("|");if(P="undefined"!=typeof Crm&&m.indexOf(e)>-1?currencyUtils.formatCurrencyValue(t,"en-IN",_[0],_[1],o[e].decimals):null!=p?p:this.getNumberWithCommas(parseFloat(t).toFixed(L),_[0],_[1]),h=n?o[e].symbol+" ":"",e==i||0==P)h+=P;else if(l)h="undefined"!=typeof Crm&&m.indexOf(i)>-1?h+P+" ("+o[i].symbol+" "+currencyUtils.formatCurrencyValue(l,"en-IN",T[0],T[1],o[i].decimals)+")":h+P+" ("+o[i].symbol+" "+this.getNumberWithCommas(l,T[0],T[1])+")";else if("undefined"!=typeof Crm&&m.indexOf(i)>-1)h=h+P+" ("+o[i].symbol+" "+currencyUtils.formatCurrencyValue(S,"en-IN",T[0],T[1],o[i].decimals)+")";else{var I=parseFloat(S).toPrecision((parseInt(S)+"").length+a);h=h+P+" ("+o[i].symbol+" "+this.getNumberWithCommas(parseFloat(I).toFixed(a),T[0],T[1])+")"}}else if(c){_=c&&"object"==typeof c&&c.format?c.format.split("|"):[",","."];h=n?c+" ":"",h+=this.getNumberWithCommas(x,_[0],_[1],null!=p)}else if(o&&i&&o[i]){_=o[i].format.split("|");h=n?o[i].symbol+" ":"",h+=this.getNumberWithCommas(x,_[0],_[1],null!=p)}return h},getNumberWithCommas:function(e,t,a,o){if(o)return e.toString();t=t||",",a=a||".";var i=e.toString().split(".");return i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,t),i.join(a)},isValidPhoneNo:function(e,t){var a=e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/[\u202c]/g,"")).replace(/[,](?!.)/,"")).replace(/\s{2,}/g," ")).replace(/\s-/g,"-")).replace(/-\s/g,"-")).replace(/\s[.]/g,"[.]")).replace(/\s;/g,";")).replace(/;\s/g,";")).replace(/\s,/g,",")).replace(/,\s/g,",")).replace(/\s#/g,"#")).replace(/#\s/g,"#")).replace(/\(\s/g,"(")).replace(/\s\)/g,")");t=(a=a.replace(/\)(?![\s;,\-\/])/g,") ")).length;if(""==a)return!1;for(var o=a[0],i=1;i<t;i++)"("==a[i]&&" "!=a[i-1]?o=o+" "+a[i]:o+=a[i];if(o=(o=o.replace(/^\s+/,"")).replace(/\s+$/,""),/^([\+]?)(?![\.-])((?=([\.\/-]?[ ]?[\da-zA-Z]+))\3+|([ ]?\((?![\.-])(?=[ \.-]?[\da-zA-Z]+)([ \.-]?[\da-zA-Z]+)+\)(?!\.)([ -][\da-zA-Z]+)?)+)+((([,]+)?[;]?([\*#]+)?[\da-zA-Z]+)+)?[#;]?$/.test(e=o)){var r=!0;if(this.data&&this.data.cxPropEnableCountryCode)if(e.startsWith("+"))try{r=ZlibPhoneNumber.isValidNumber(e)}catch(e){r=!1,murphy.error(e)}else{var s=e.replace(/[^0-9A-Za-z]/g,"");r=s.length<=12&&s.length>=1}return r}return!1},isValidTwitter:function(e){if(""==e)return!0;if(e.trim().length<=50&&e.trim().length>0){return/^[a-zA-Z0-9_]*$/.test(e)}return!1},isValidWebUrl:function(e){if(""==e)return!0;return new RegExp('^(http:\\/\\/www.|https:\\/\\/www.|ftp:\\/\\/www.|www.|http:\\/\\/|https:\\/\\/|ftp:\\/\\/|){1}[^\0-"-\'*-,.-/:-?[-^`{}- ]+(\\.[^\0-"$-,.-/<>@[-^`{}- ]+)+([/?].*)*$').test(e)},getNumberValueForView:function(e,t,a,o,i,r,s,l,n,p,c,d,u,m,g,h){if("currency"==t||39==o||36==o||77==o||143==o||144==o||145==o){if(i=i||this.getData("cxPropCurrencyDetails"),a&&i){for(var y in i)if(i[y].symbol==a){a=y;break}}else a=void 0;e=this.convertCurrencyValue(a,e,r,i,s,l,n,p,c,d,m,g,h)}else 40===o&&e&&e.indexOf("e")>-1?e=parseFloat(e).toFixed(9):38!=o&&34!=o&&40!=o&&"double"==t&&e%1==0&&(e=e/1+".0");return u&&"undefined"!=typeof Search&&Search.formatNumber?Search.formatNumber(e):e.toString()},validateNumberField:function(e,t,a,o,i){if(!e||""==e.trim())return this.validateMandatory(!0);var r,s=(e.match(new RegExp(/\d/g))?e.match(new RegExp(/\d/g)):"").length;return a&&s>a?(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR04,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.length.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),!1):o&&e>o?(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.custom.field.less.than.equalto",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label),o)),!1):i&&e<i?(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.custom.field.greater.than.equalto",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label),i)),!1):"integer"==t.data_type||"bigint"==t.data_type?((r=this.isValidInteger(e))||(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label)))),r):((r=this.isValidDecimal(e))?(r=this.decimalLengthCheck(e,t))||(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR03,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.decimal.check2",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label),t.decimal_place))):this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),r)},validatePhoneNumber:function(e,t){if(!t||""==t.trim())return this.validateMandatory(!0)?(this.setData("cxPropErrorMessage",""),!0):(this.data&&!this.data.cxPropPreventFocusOnError&&this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),!1);var a=this.validateLength(t);return!!a&&((a=this.isValidPhoneNo(t))?this.setData("cxPropErrorMessage",""):(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(e.field_label))),this.data&&!this.data.cxPropPreventFocusOnError&&this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus()),a)},errorCodes:{ERR01:"value_empty",ERR02:"value_invalid",ERR03:"decimal_check",ERR04:"maxlength_check",ERR05:"maxdate_check",ERR06:"mindate_check"},validateLength:function(e,t){return!((t=t||this.data.cxPropMaxlength)&&e.length>t)||(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR04,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.length.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(this.getData("cxPropField").field_label))),this.data&&!this.data.cxPropPreventFocusOnError&&this.$node&&this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),!1)},validateText:function(e,t,a,o){return this.validateMandatory(!t||""==t.trim(),void 0,e,o)?!(t&&!this.validateLength(t,a))&&(this.setData("cxPropErrorMessage",""),!0):(this.data&&!this.data.cxPropPreventFocusOnError&&!this.inFocus&&this.$node&&this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),!1)},phoneClick:function(e,t,a,o){event.preventDefault(),"undefined"!=typeof ctiApiNotifier&&ctiApiNotifier.click2Call(e,Crm.userDetails.ZGID,Crm.userDetails.USER_ID,t,"",a,o),event.stopPropagation()},stopPropagation:function(){return event.stopPropagation(),!1},toPrecision:function(e,t){var a=(e=e.toString()).split("."),o=a[0],i=o.length;a.length<2&&(a[1]="");for(var r=i,s=0;r<t;r++,s++)0==s&&(o+="."),a[1][s]?o+=a[1][s]:o+="0";return o},getDateObjectFromString:function(e,t,a,o,i){if(!e)return new Date;if(!e.getMonth){if(!t)e.indexOf(":")>-1&&(a=a||Crm.userDetails.TIME_FORMAT,(e.indexOf("AM")>1||e.indexOf("PM")>1)&&(a=a.replace("a","A")),t+=" "+a);var r=$L.moment(e.trim(),t.toUpperCase().trim(),{i18n:i}),s=r.validate(),l=r.getDObj();return l||(l=new Date),s||o?l:e}return e},getDateTimeInUserFormat:function(e,t,a,o){var i=this.getDateInUserDatePattern(e);return i+=" "+this.getTimeInUserFormat(e,t,o)},showHideInfoTooltip:function(e){var t;e?((t=$L(e)).addClass("cxCurrentHovercard"),t.next()[0].ltProp("show",!0)):(t=this.$node.querySelector(".cxCurrentHovercard"),$L(t).removeClass("cxCurrentHovercard"))},validateMandatory:function(e,t,a,o){return a=a||this.data.cxPropField,o=o||this.data.cxPropLayout,!(1==this.data.cxPropMandatory||0==this.data.cxPropMandatory?this.data.cxPropMandatory:o&&a[o]?a[o].required:a.required)||!e||(void 0!==t?t():this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR01,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.empty.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(this.getData("cxPropField").field_label))),!1)},setFocusUtil:function(){this.$node.focus=function(){var e=this.$node.querySelector("lyte-checkbox"),t=e||this.$node.querySelector("input");if(!(t=t||this.$node.querySelector("textarea"))||this.$node.querySelector("lyte-dropdown")&&"CRUX-PHONE-COMPONENT"===!this.$node.tagName){(t=this.$node.querySelector("lyte-dropdown"))&&t.open();var a=t?t.querySelector("input"):"";a&&(a.selectionStart=a.value.length),a&&a.focus()}else!e&&t&&(t.selectionStart=t.value.length),t&&t.focus()}.bind(this)},observeMandatoryMixin:function(e,t){var a=this.$node.querySelector(e);a&&"create"==this.getData("cxPropFrom")&&(t=t||"mandatoryField",(1==this.data.cxPropMandatory||0==this.data.cxPropMandatory?this.data.cxPropMandatory:this.data.cxPropLayout?this.data.cxPropField[this.data.cxPropLayout].required:this.data.cxPropField.required)?a.classList.add(t):a.classList.remove(t))},setSelectUtil:function(){this.$node.select=function(){var e=this.$node.querySelector("lyte-input");e&&e.select()}.bind(this)},observeAndSetTooltip:function(){void 0!==this.data.cxPropTooltip?this.setData("tooltip",this.data.cxPropTooltip):this.data.cxPropDisabled?this.setData("tooltip",_cruxUtils.getI18n("crm.lable.read.only")):this.setData("tooltip","")},actions:{focusOnViewElement:function(){this.setData("lyteViewPort",!1),this.$node.focus()},showHideInfoTooltip:function(e){this.showHideInfoTooltip(e)}},methods:{showHideInfoTooltip:function(){this.showHideInfoTooltip()}},observeMandatoryMixin2:function(){var e=1==this.data.cxPropMandatory||0==this.data.cxPropMandatory?this.data.cxPropMandatory:this.data.cxPropLayout?this.data.cxPropField[this.data.cxPropLayout].required:this.data.cxPropField.required;this.setData("mandatory",e)},observeError:function(e,t){"create"==this.data.cxPropFrom&&this.$node.querySelector(e)&&(this.data.isError?this.$node.querySelector(e).classList.add(t):this.$node.querySelector(e).classList.remove(t))},observeClass:function(e,t){if("create"==this.data.cxPropFrom){var a=$L(e,this.$node);if(!a.length)return;t&&t.oldValue&&a.removeClass(t.oldValue),this.data.cxPropClass&&a.addClass(this.data.cxPropClass)}},observeRender:function(){!this.data.lyteViewPort&&this.getMethods("onElementRendered")&&this.executeMethod("onElementRendered",this)},observeMandatoryTypeMixin:function(e){if(this.data.cxPropMandatoryType&&"red_accent_line"!==this.data.cxPropMandatoryType){var t=this.$node.querySelector(".cxMandatoryType");t&&(t.style.color="red"),this.$node.querySelector(".cxMandatoryOptEnabled")||$L(e,this.$node).addClass("cxMandatoryOptEnabled")}else this.$node.querySelector(".cxMandatoryOptEnabled")&&$L(e,this.$node).removeClass("cxMandatoryOptEnabled")},convertLtPropJson:function(e){var t,a={},o={};if(e=e||this.data.cxPropElementProps){for(var i in e){a=e[i]?e[i]:{};var r={};for(var s in a)r[(t=(t=s.replace("ltProp","")).replace("cxProp","")).charAt(0).toLowerCase()+t.slice(1)]=a[s];o[i]=JSON.stringify(r)}this.setData("childCompProps",o)}},observeTabindexMixin:function(){"0"===this.data.cxPropTabindex&&void 0!==this.data.cxPropTabIndex||void 0===this.data.cxPropTabindex?"0"===this.data.cxPropTabIndex&&void 0!==this.data.cxPropTabindex||void 0===this.data.cxPropTabIndex||this.setData("cxPropTabindex",this.data.cxPropTabIndex):this.setData("cxPropTabIndex",this.data.cxPropTabindex)},observeAndSetAriaMixin:function(){if("view"==this.data.cxPropFrom){var e=this.$node.firstElementChild;this.observeTabindexMixin(),e.firstElementChild&&(e=e.firstElementChild),e.tabIndex!=this.data.cxPropTabindex&&(e.tabIndex=this.data.cxPropTabindex);var t=this.data.cxPropAriaAttributes;for(let a in t)$L(e).attr(a,t[a])}}}),Lyte.Component.register("crm-global-search-input",{_template:'<template tag-name="crm-global-search-input"> <template is="if" value="{{canShowInput}}"><template case="true"> <lyte-event-listener event-name="globalSearchModuleRefresh" on-fire="{{action(\'handleRefresh\')}}"> <div class="globalSearchInputWrap dF {{if(isPrimarySearch,\'mT20 mB20 mL20 mR20 br12 br_border1\',\'\')}}"> <div class="searchInputHolder pFixed vH dIB">{{searchInputText}}</div> <template is="if" value="{{isPrimarySearch}}"><template case="true"> <div class="cgsPrimaryFilterWrap askZiaSearchAnimationCase noDropdownStyle pT15 {{if(showChatbotGlobalSearch,\'\',\'pR15\')}} pL20"> <template is="if" value="{{showChatbotGlobalSearch}}"><template case="true"> <div class="dIB askZiaSearchTitleSpan wsNowrap">Ask Zia</div> </template><template case="false"> <lyte-dropdown data-zcqa="allModulesListPrimarySearch" lt-prop-freeze="false" class="cgsSearchModulesList" lt-prop-selected="{{selectedModule.api_name}}" lt-prop-display-value="{{selectedModule.label}}" lt-prop-no-result="{{getI18n(\'crm.global.search.no.modules.found\')}}" on-option-selected="{{method(\'searchOnlyInThisModule\',this)}}" on-show="{{method(\'setDropdownPosition\')}}" on-before-hide="{{method(\'removeSearchTest\',this)}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="moduleSelectionDD"> <lyte-drop-header> <lyte-search id="searchInPrimarySearchModule" lt-prop-placeholder="{{getI18n(\'crm.api.search.modules\')}}" lt-prop-query-selector="{&quot;scope&quot; : &quot;#moduleListBody&quot;, &quot;search&quot; : &quot;lyte-drop-item&quot;}" lt-prop-close-icon="true" onfocus="{{action(\'setDropdownPosition\')}}" on-search="{{method(\'showNoResult\')}}"></lyte-search> </lyte-drop-header> <lyte-drop-body id="moduleListBody"> <lyte-drop-item data-value="AllModules" data-result-count="0"> {{getI18n(\'crm.label.AllModules\')}} </lyte-drop-item> <template is="forIn" object="{{allModulesArrayList}}" value="obj" key="key"> <lyte-drop-item data-value="{{obj.api_name}}" data-result-count="{{obj.count}}"> {{obj.plural_label}} </lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template></template> </div> </template></template> <div id="primarySearchIdWrap" class="primarySearchInputWrap oA wsNowrap mL0 {{if(expHandlers(isPrimarySearch,\'&amp;&amp;\',expHandlers(showChatbotGlobalSearch,\'!\')),\'cgsInputLeftBorder\',\'secondarySearchInputWrapElem\')}} pL15 fg1"> <div class="flexAlignCenter"> <div onclick="{{action(\'focusInToTag\')}}" class="selectedTagsWrap dF pT7 pB7"> <template is="if" value="{{expHandlers(isPrimarySearch,\'||\',expHandlers(appliedTags.length,\'>\',0))}}"><template case="true"> <template is="if" value="{{isTagsEnabled}}"><template case="true"> <template is="for" items="{{appliedTags}}" item="tagObj" index="index"> <div class="selectedTagsList pL5 mR11 pR {{tagObj.param}}" data-tag-index="{{index}}" data-tag-param="{{tagObj.param}}" data-array-index="{{tagObj.indexVal}}"> <span class="closeThisIdentifier h20 pA right0 t0 dIB cP" onclick="{{action(\'removeIdentifier\',index,tagObj)}}"> <crmutil-icon icon-name="close-9" class="pT8 pL5" icon-class="zcicn-close-9 iconWhite zcicn8"></crmutil-icon> </span> <span class="appliedTagText dIB">{{tagObj.display_label}}</span> <template is="if" value="{{expHandlers(expHandlers(expHandlers(tagObj.param,\'!==\',\'owned_by_me\'),\'&amp;&amp;\',expHandlers(tagObj.param,\'!==\',\'shared_with_me\')),\'&amp;&amp;\',\'shared_to_me\')}}"><template case="true"> {{log(tagObj.param)}} {{log("obj",tagObj)}} <template is="if" value="{{expHandlers(expHandlers(tagObj.param,\'===\',\'Modified_By\'),\'||\',expHandlers(tagObj.param,\'===\',\'Created_By\'))}}"><template case="true"> <div class="appliedTagsInput cgstagBrCur pT1 pB1 bg_white vaT wsNowrap borderNone oA dIB"> <span class="dIB vaT lh18">@</span> <crux-user-dropdown class="identifierSearchUserWrap dIB vaT noDropdownStyle mT1 createdOrModifiedForSearchInput" on-user-show="{{method(\'focusSelectedTagsMethod\',this,true)}}" on-user-hide="{{method(\'focusSelectedTagsMethod\',this,false)}}" cx-prop-selected-user="{{tagObj.value[0]}}" cx-prop-placeholder="None" cx-prop-filter-options="{{filterOptions}}" cx-prop-box-class="cgsUserDropDown" cx-prop-input-name="{{tagObj.param}}" cx-prop-type="single" on-user-selected="{{method(\'selectThisUser\',tagObj.param)}}"></crux-user-dropdown> </div> </template><template case="false"> <div class="appliedTagsInput pT1 pB1 lh18 bg_white cgstagBrCur borderNone vaT wsNowrap oA dIB" contenteditable="true" onfocus="{{action(\'focusSelectedTags\',this,true)}}" onfocusout="{{action(\'focusSelectedTags\',this,false)}}" onclick="{{action(\'triggerIdentifierFocus\',this)}}" onkeyup="{{action(\'initSearch\',this,event)}}" onpaste="{{action(\'includeOnlyText\',this,event)}}" onkeydown="{{action(\'beforeInit\',this,event)}}">{{tagObj.value}}</div> </template></template> </template></template> </div> </template> </template></template> </template><template case="false"> <template is="for" items="{{tagNameVsValue}}" item="tagObj" index="index"> <div data-zcqa="appliedTagsPrimarySearch" class="selectedTagsList pL5 mR5 " data-tag-index="{{index}}" data-tag-param="{{tagObj.param}}" data-array-index="{{tagObj.indexVal}}"> <span class="appliedTagText dIB">{{tagObj.name}}</span> <template is="if" value="{{expHandlers(expHandlers(expHandlers(tagObj.param,\'!==\',\'owned_by_me\'),\'&amp;&amp;\',expHandlers(tagObj.param,\'!==\',\'shared_with_me\')),\'&amp;&amp;\',\'shared_to_me\')}}"><template case="true"> <div class="appliedTagsInput br3 lh18 bg_white borderNone vaT wsNowrap oA dIB" contenteditable="true" onkeydown="{{action(\'focusOutFromTag\',this,event)}}" onpaste="{{action(\'includeOnlyText\',this,event)}}" onkeyup="{{action(\'applyTagValue\',event,this,tagObj)}}"> </div> </template></template> </div> </template> </template></template> </div> <div class="primarySearchContainer fg1"> <lyte-input data-zcqa="inputTextPrimarySearch" id="primarySearchInput" class="primarySearchInput pT7 pB7" lt-prop-width="100%" lt-prop-maxlength="{{if(showChatbotGlobalSearch,\'301\',\'\')}}" lt-prop-update-delay="{{undefinedData}}" lt-prop-value="{{lbind(searchInputText)}}" lt-prop-class="searchInputBox" onkeyup="{{action(\'initSearch\',this,event)}}" onkeydown="{{action(\'beforeInit\',this,event)}}" onclick="{{action(\'triggerSearchFocus\')}}" onfocusout="{{action(\'untriggerSearchFocus\')}}" onpaste="{{action(\'includeOnlyText\',this,event)}}"> </lyte-input> <template is="if" value="{{expHandlers(expHandlers(searchInputText.length,\'===\',0),\'&amp;&amp;\',expHandlers(appliedTags.length,\'===\',0))}}"><template case="true"> <div class="pA cgsPlaceHolderWrap flexAlignCenter cText" onclick="{{action(\'triggerSearchFocus\')}}"> <template is="if" value="{{expHandlers(isPrimarySearch,\'&amp;&amp;\',showAskZiaPlaceholder)}}"><template case="true"> {{unescape(getI18n(\'crm.global.search.for.specfic.search.and.zia\'))}} </template><template case="false"> {{unescape(getI18n(\'crm.global.search.for.specfic.search\'))}} </template></template> </div> </template></template> </div> </div> </div> <template is="if" value="{{isPrimarySearch}}"><template case="true"> <div class="gsLeastChar op5 pL5 pR20 fShrink0 flexAlignCenter" onclick="{{action(\'searchInputFocus\')}}">{{getI18n(\'crm.global.search.type.alteast.character\',3)}}</div> <template is="if" value="{{showChatbotGlobalSearch}}"><template case="true"> <div class="boxBB h23 mR10 mT10 w23 ziaSearchEnterKey" lt-prop-title="Press &quot;Enter&quot; to trigger search."><span class="zcicncss-enter zcicn-cssIcons zcicn_grey_mask"></span></div> </template></template> </template><template case="false"> <template is="if" value="{{expHandlers(triggerHintNeeded,\'&amp;&amp;\',expHandlers(identifierComponent.data.isTagSuggestionNeeded,\'!\'))}}"><template case="true"> <div class="op5 mL5 pR20 fShrink0 flexAlignCenter cText" onclick="{{action(\'searchInputFocus\')}}"> {{getI18n(\'crm.global.search.enter.trigger.search\')}}</div> </template><template case="false"><template is="if" value="{{threeCharacterHintNeeded}}"><template case="true"> <div class="op5 mL5 pL5 pR20 fShrink0 flexAlignCenter cText" onclick="{{action(\'searchInputFocus\')}}"> {{getI18n(\'crm.global.search.type.alteast.characters\',3)}}</div> </template></template></template></template> </template></template> </div> </lyte-event-listener></template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,1,1,0]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"text",position:[1,3,1,1]},{type:"componentDynamic",position:[1,3,1]},{type:"attr",position:[1,3,3]},{type:"forIn",position:[1,3,3],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,5]},{type:"attr",position:[1,1,5,1,1]},{type:"attr",position:[1,1,5,1,1,1]},{type:"if",position:[1,1,5,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"text",position:[1,3,0]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3]},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}}]}},default:{}}]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}]}},default:{}},{type:"attr",position:[1,1,5,1,3,1]},{type:"componentDynamic",position:[1,1,5,1,3,1]},{type:"attr",position:[1,1,5,1,3,3]},{type:"if",position:[1,1,5,1,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,7]},{type:"if",position:[1,1,7],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}]}},default:{}}],_observedAttributes:["isTagsEnabled","isPrimarySearch","isSuggestionNeeded","requestMade","moduleSuggestion","isInputEmpty","currSearchInputText","searchInputText","searchTagInputText","issearchTagInput","suggestedModuleApiName","allModulesArrayList","selectedModule","currentAppliedTags","currentAllTags","currentPendingTags","currentTagNameVsValue","appliedTags","pendingTags","allTags","identifierRemovedCount","inputWrapperWidth","inputWidth","filterOptions","tagNameVsValue","popupComponent","refineSearComp","identifierComponent","sysRefNameVsModuleDetailsMap","oldSearchValue","currentTagFocusIndex","currentTagFocusName","isTagSelected","isTagJustSelected","isUserJustSelected","isSearchOnFocus","oldTagValue","showAskZiaPlaceholder","showChatbotGlobalSearch","showSearchAcrossZoho","recentlySearchedSuggestions","searchSuggestions","allSearchSuggestions","cbIsIntervalSet","cbPrevKeyword","cbCurrKeyword","chatbotResultFetchingTimeOutId","undefinedData","isInSearchFocus","canShowInput","triggerHintNeeded"],_tagSearchRequest:"",init:function(){this.setData("sysRefNameVsModuleDetailsMap",this.getDataFromModuleRecordMapping().sysRefNameVsModuleDetailsMap),"Free"===Crm.userDetails.EDITION_NAME&&this.setData("allTags",[{display_label:I18n.getMsg("crm.global.search.record_name"),name:"#Record Name",value:"",param:"Record_Name",indexVal:"0"}]),setTimeout(function(){}.bind(this),1)},data:function(){return{isTagsEnabled:Lyte.attr("boolean",{default:!1}),isPrimarySearch:Lyte.attr("boolean",{default:!0}),isSuggestionNeeded:Lyte.attr("boolean",{default:!1}),requestMade:Lyte.attr("boolean",{default:!1}),moduleSuggestion:Lyte.attr("boolean",{default:!1}),isInputEmpty:Lyte.attr("boolean",{default:!0}),currSearchInputText:Lyte.attr("string",{default:""}),searchInputText:Lyte.attr("string",{default:""}),searchTagInputText:Lyte.attr("string",{default:""}),issearchTagInput:Lyte.attr("boolean",{default:!1}),suggestedModuleApiName:Lyte.attr("string",{default:""}),allModulesArrayList:Lyte.attr("array",{default:[]}),selectedModule:Lyte.attr("object",{default:{api_name:"AllModules",label:I18n.getMsg("crm.label.AllModules")}}),currentAppliedTags:Lyte.attr("array",{default:[]}),currentAllTags:Lyte.attr("array",{default:[]}),currentPendingTags:Lyte.attr("array",{default:[]}),currentTagNameVsValue:Lyte.attr("object",{default:{}}),appliedTags:Lyte.attr("array",{default:[]}),pendingTags:Lyte.attr("array",{default:[]}),allTags:Lyte.attr("array",{default:[{display_label:I18n.getMsg("crm.global.search.record_name"),name:"#Record Name",value:"",param:"Record_Name",indexVal:"0"},{display_label:I18n.getMsg("crm.global.search.tags"),name:"#Tags",value:"",param:"Tags",indexVal:"1"}]}),identifierRemovedCount:Lyte.attr("number",{default:0}),inputWrapperWidth:Lyte.attr("number",{default:0}),inputWidth:Lyte.attr("number",{default:0}),filterOptions:Lyte.attr("array",{default:[{id:"AllUsers",category:"All"},{id:"ActiveUsers",category:"Active"},{id:"DeactiveUsers",category:"Inactive"},{id:"NotConfirmedUsers",category:"UnConfirmed"},{id:"DeletedUsers",category:"Deleted"}]}),tagNameVsValue:Lyte.attr("object",{default:{}}),popupComponent:Lyte.attr("object",{default:{}}),refineSearComp:Lyte.attr("object",{default:{}}),identifierComponent:Lyte.attr("object",{default:{}}),sysRefNameVsModuleDetailsMap:Lyte.attr("object"),oldSearchValue:Lyte.attr("string",{default:""}),currentTagFocusIndex:Lyte.attr("number",{default:-1}),currentTagFocusName:Lyte.attr("string",{default:""}),isTagSelected:Lyte.attr("boolean",{default:!1}),isTagJustSelected:Lyte.attr("boolean",{default:!1}),isUserJustSelected:Lyte.attr("boolean",{default:!1}),isSearchOnFocus:Lyte.attr("boolean",{default:!0}),oldTagValue:Lyte.attr("string",{default:""}),showAskZiaPlaceholder:Lyte.attr("boolean",{default:Crm.userDetails.isAskZiaQuerySuggEnabled}),showChatbotGlobalSearch:Lyte.attr("boolean",{default:!1}),showSearchAcrossZoho:Lyte.attr("boolean",{default:!0}),recentlySearchedSuggestions:Lyte.attr("array",{default:[]}),searchSuggestions:Lyte.attr("array",{default:[]}),allSearchSuggestions:Lyte.attr("array",{default:[]}),cbIsIntervalSet:Lyte.attr("boolean",{default:!1}),cbPrevKeyword:Lyte.attr("string",{default:""}),cbCurrKeyword:Lyte.attr("string",{default:""}),chatbotResultFetchingTimeOutId:Lyte.attr("string",{default:""}),undefinedData:Lyte.attr("object",{default:void 0}),isInSearchFocus:Lyte.attr("boolean",{default:!0}),canShowInput:Lyte.attr("boolean",!1),triggerHintNeeded:Lyte.attr("boolean",{default:!1})}},didConnect:function(){$L(".gsLeastChar").hide()},methods:{showNoResult:function(e){0===e.length?$L(".moduleSelectionDD").find(".lyteDropdownNoResult").css("display","block"):$L(".moduleSelectionDD").find(".lyteDropdownNoResult").css("display","none")},removeSearchTest:function(){var e=document.getElementById("searchInPrimarySearchModule");e&&e.setValue(""),this.actions.triggerSearchFocus(this)},searchOnlyInThisModule:function(e,t,a){Crm.client_tracking("Global Search New UI - Module selected in popup");let o={};if(o.api_name=a,Lyte.arrayUtils(this.getData("identifierComponent").getData("primarySearchResults"),"removeObjects",this.getData("identifierComponent").getData("primarySearchResults")),"AllModules"===a)o.label=I18n.getMsg("crm.label.AllModules");else{let e=this.getData("sysRefNameVsModuleDetailsMap")[a];o.label=e.plural_label}if(this.setData("selectedModule",o),this.getData("identifierComponent").getData("isSecondaryResults")){var i,r=$L("crm-global-search-refine")[0].component;r.setData("columnListOpenedModules",[]);var s=r.getData("allModuleList");"AllModules"===a?(i=s,r.setData("filteredModules",[])):(i=s.filter((e=>e.api_name===a)),r.setData("filteredModules",i)),r.setData("moduleFilterList",i);var l=this.getData("searchInputText");if(this.getData("appliedTags").length>0||l.length>0)return void this.renderSecondaryResults()}""!==$L(".primarySearchInput")[0].ltProp("value")||this.getData("isTagsEnabled")?(this.getData("isPrimarySearch")&&this.getData("popupComponent").setData("searchStarted",!0),this.getData("identifierComponent").setData("searchStarted",!0),this.methods.makeSearchRequest(this)):(this.methods.getSearchHistoryForModule(a),this.actions.backToInit(this))},afterResultPopupChange:function(e){if(e.getData("identifierComponent").setData("isResultsEmpty",!0),e.getData("identifierComponent").setData("primarySearchResults",[]),e.getData("isPrimarySearch")&&(e.getData("popupComponent").setData("resultFetch",!0),e.getData("popupComponent").setData("searchStarted",!0)),e.getData("isPrimarySearch")){var t=e.getData("searchInputText").length>0||e.getData("appliedTags").length>0;e.getData("popupComponent").setData("showSearchHistory",!t),e.getData("popupComponent").setData("needLoading",!1),e.getData("identifierComponent").setData("showResultsTrigger",!0),e.getData("identifierComponent").getData("isTagSuggestionNeeded")&&!e.getData("identifierComponent").getData("isResultsEmpty")||e.getData("popupComponent").setData("resultFetch",!0)}},makeSearchRequest:function(e){var t,a=e.getData("requestMade"),o=e.getData("appliedTags"),i={},r={},s=e.getData("searchInputText"),l=s.length;if(s=s.replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi," "),e.setData("isResultsEmpty",!0),!a){o.length>0&&o.filter((function(e){if("owned_by_me"===e.param||"shared_with_me"===e.param)t=void 0===t?e.param:"owned_and_shared_with_me";else{var a=e.value;if(a&&""!==a){var o=e.param;"Tag"===o&&(o="Tags"),r[o]=a}}}));var n=!validationUtils.isEmpty(r),p=o.length>0,c=e.getData("sysRefNameVsModuleDetailsMap");if(e.setData("isTagsEnabled",p),l>=3&&s.length<3&&e.methods.afterResultPopupChange(e),e.getData("isPrimarySearch")&&(s&&s.trim().length>2||n)&&e.getData("popupComponent").setData("needLoading",!0),i=e.criteriaFormationForRequest(n,r),e.actions.checkTagPresentAndValues(e,s)){var d={},u=e.getData("selectedModule").api_name;d.modules=u,d.autocomplete=!0,d.per_page="AllModules"!==u?20:200,s&&s.length>0&&("AllModules"!==u?(d.searchword=e.getData("searchInputText"),d.get_from_lucene=!0):d.searchword=e.getData("searchInputText")),Object.keys(i).length>0?(Crm.client_tracking("Global Search New UI - Tags used"),d.criteria=JSON.stringify(i)):d.isRelevance=!1,t&&""!==t&&(d.filter_by=t),"AllModules"===d.modules&&delete d.modules,commonUtils.showHideLoadingDiv(!0),store.findAll("global-search",d,!1,!1).then((function(t){if(t){var a={},o=[],i=t.data;if(commonUtils.showHideLoadingDiv(!1),i){let t=i,d="";"AllModules"!==u&&(d=c[u].module_name,t=i.slice(0,20));var r=[];for(var s in t)if(t.hasOwnProperty(s)){var l=t[s],n=l.module||l.$setype;if("SalesOrders"!==l.$setype&&"Invoices"!==l.$setype&&"PurchaseOrders"!==l.$setype&&"Quotes"!==l.$setype||!l.Grand_Total?"Potentials"!==l.$setype&&"Deals"!==l.$setype||!l.Amount?"Products"===l.$setype&&l.Unit_Price?l.Unit_Price=currencyUtils.returnValueInDefaultCurrency(l.Currency,l.Unit_Price,void 0,l.Exchange_Rate):"Services"===l.$setype&&l.Price&&(l.Price=currencyUtils.returnValueInDefaultCurrency(l.Currency,l.Price,void 0,l.Exchange_Rate)):l.Amount=currencyUtils.returnValueInDefaultCurrency(l.Currency,l.Amount,void 0,l.Exchange_Rate):l.Grand_Total=currencyUtils.returnValueInDefaultCurrency(l.Currency,l.Grand_Total,void 0,l.Exchange_Rate),a[n]){if(a[n].length<10)a[n].push(l)}else{var p=[];p.push(l),a[n]=p}}if("AllModules"===u){e.getData("allModulesArrayList").forEach((function(e){let t=e.module_name;if(a.hasOwnProperty(t)){r=a[t];var i={};i[t]=r,o.push(i)}}))}else a[d]=t,o.push(a)}if(o.length>0?(e.getData("identifierComponent").setData({primarySearchResults:o,isResultsEmpty:!1}),e.getData("popupComponent").setData("searchStarted",!0)):(e.getData("identifierComponent").setData("isResultsEmpty",!0),e.getData("identifierComponent").setData("primarySearchResults",[]),e.getData("isPrimarySearch")&&(e.getData("popupComponent").setData("resultFetch",!0),e.getData("popupComponent").setData("searchStarted",!0))),e.getData("isPrimarySearch")){var d=e.getData("searchInputText").length>0||e.getData("appliedTags").length>0;e.getData("popupComponent").setData("showSearchHistory",!d),e.getData("popupComponent").setData({needLoading:!1}),e.getData("identifierComponent").setData("showResultsTrigger",!0),(void 0!==t.data&&!e.getData("identifierComponent").getData("isTagSuggestionNeeded")||e.getData("identifierComponent").getData("isResultsEmpty"))&&e.getData("popupComponent").setData("resultFetch",!0)}}setTimeout((function(){var t=$L(".primarySearchResult")[0];t.scrollHeight>t.clientHeight?e.getData("identifierComponent").setData("cgsFooterShadow",!0):e.getData("identifierComponent").setData("cgsFooterShadow",!1)}),100)}),(function(t){if(t.response)return 200!==t.status?(commonUtils.showHideLoadingDiv(!1),e.getData("identifierComponent").setData("isResultsEmpty",!0),void e.getData("identifierComponent").setData("primarySearchResults",[])):void 0}),(function(t){commonUtils.showHideLoadingDiv(!1),e.methods.afterResultPopupChange(e)}))}}},setDropdownPosition:function(){this.setDropdownPosition(this)},selectThisUser:function(e,t){var a=$L("crm-global-search-input")[0].component;a.showEnter(),a.setData("isTagJustSelected",!1),t&&-1===t.pointerId&&a.setData("isUserJustSelected",!0);for(var o,i=$L("crux-user-dropdown"),r=a.getData("appliedTags"),s=a.getData("appliedTags").findIndex((t=>t.param===e)),l=i.length,n=0;n<l;n++){var p=i[n].component;if(p.getData("cxPropInputName")===e){o=p;break}}var c=o.getData("cxPropSelectedUser").id,d=o.getData("cxPropSelectedUser").full_name;r[s].value=[{name:d,id:c}],a.setData("appliedTags",r),a.getData("isPrimarySearch")&&(a.getData("identifierComponent").setData("searchStarted",!0),a.getData("popupComponent").setData("searchStarted",!0),a.actions.checkPrimaryTagSearch(a.getData("appliedTags"),a.getData("searchInputText"))&&a.methods.makeSearchRequest(a)),$L(".selectedTagFocus").removeClass("selectedTagFocus"),a.setData("isSearchOnFocus",!0),$L(".searchInputBox").focus()},getSearchHistoryForModule:function(e){var t={};if(t.filters=String("{'comparator':'equals','field':{'api_name':'source'},'value':'search'}"),"AllModules"!==e){var a=$L("crm-global-search-input")[0].component.getData("sysRefNameVsModuleDetailsMap")[e].module_name;t.modules=a}var o=$L("crm-global-search-popup")[0].component;store.findAll("search-history",t,!1,!1).then((e=>{o.setData("search_history",e.search_history)}))},closePopup:function(){const e=$L("crm-global-search-input")[0].component;e.actions.clearAllQueries(),e.getData("identifierComponent").setData({recentlySearchedSuggestions:[],searchSuggestions:[],allSearchSuggestions:[],showChatbotGlobalSearch:!1}),e.getData("popupComponent").setData("showChatbotGlobalSearch",!1)},focusSelectedTagsMethod:function(e,t){$L("crm-global-search-input")[0].component.actions.focusSelectedTags(e,t)}},actions:{handleRefresh:function(){var e=this.getDataFromModuleRecordMapping(),t=$L("crm-global-search-input")[0].component,a=e.allModulesArrayList;t.setData("allModulesArrayList",a.filter((e=>"Notes"!==e.name)))},searchInputFocus:function(){this.setData("isSearchOnFocus",!0),$L(".primarySearchInput").focus()},focusSelectedTags:function(e,t){if(t){$L(e).closest(".selectedTagsList").addClass("selectedTagFocus");var a=$L("crm-global-search-input")[0].component;a.actions.triggerIdentifierFocus(e,a)}else $L(e).closest(".selectedTagsList").removeClass("selectedTagFocus")},includeOnlyText:function(e,t){var a=t.clipboardData.getData("text/plain");document.execCommand("insertText",!1,a),t.preventDefault()},isTagSlashInTheString:function(e){for(var t=e.length,a=0;a<t;a++)if("#"===e[a].slice(0,1))return!0;return!1},isTagsShouldBeShownValidation:function(e,t,a,o){var i=a.split(" "),r=t.getData("identifierComponent").getData("noTagResults"),s=i.length,l="#"===i[s-1].slice(0,1);return s>0&&(l=t.actions.isTagSlashInTheString(i)),!(!l||void 0!==o||!0===r||!e.component)},initSearch:function(e,t,a,o){var i=$L(".askZiaSearchAnimationCase");if("Escape"===t.code)return void i.width("auto");var r=this;a&&(r=o);var s=$L(".gsLeastChar"),l=$L(".searchInputBox");const n=r.getData("currentTagFocusIndex"),p=r.getData("isTagJustSelected");if(r.getData("isUserJustSelected"))return void r.setData("isUserJustSelected",!1);var c=$L(".readyToRemove"),d=c.length>0;if(d){if(8===t.keyCode)return;c.removeClass("readyToRemove")}const u=r.getData("isTagSelected");o=e.component;if(r.getData("isPrimarySearch")){var m=0===r.getData("searchInputText").length&&0===r.getData("appliedTags").length;r.getData("popupComponent").setData("showSearchHistory",!!m)}if(-1!==n){const a=r.getData("currentTagFocusName");if(9===t.keyCode||13===t.keyCode)if(u&&!p)r.setData("isTagSelected",!1),r.setData("currentTagFocusName",""),r.setData("currentTagFocusIndex",-1),r.actions.triggerSearchFocus(r);else{if(p)return void r.setData("isTagJustSelected",!1);this.actions.focusOutFromTag(e,t)}e.component||r.actions.applyTagValue(t,e,a)}if(r.setData("isTagJustSelected",!1),9!==t.keyCode&&40!==t.keyCode&&38!==t.keyCode){if(37===t.keyCode||39===t.keyCode)return;var g,h=(g=a?$L("crm-global-search-input")[0].component:r.$node.component).getData("isPrimarySearch");if(13===t.keyCode&&h){const e=g.getData("searchInputText").replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi," ");return this.actions.checkTagPresentAndValues(g,e)?void $L("crm-global-search-identifiers")[0].component.actions.changeSearchScreen():($L("#primaryGsearch")[0].ltProp("overlayClose",!1),this.setData("isHintOpen",!0),void _cruxUtils.showCustomAlert({params:{ltPropSecondaryMessage:I18n.getMsg("crm.global.search.type.alteast.characters",3)},close:function(){$L("#primaryGsearch")[0].ltProp("overlayClose",!0),setTimeout((()=>{$L(".searchInputBox").focus()}),200)}}))}if(g.getData("identifierComponent").data||g.setData("identifierComponent",$L("crm-global-search-identifiers")[0].component),o){N=$L(e).find(".searchInputBox").val();var y=g.getData("appliedTags");if(Crm.userDetails.isAskZiaQuerySuggEnabled&&h&&N.startsWith("/")&&0===y.length){if(s.hide(),1===N.length&&Crm.client_tracking("AskZia Query suggestion - Click",{source:"Global search"}),commonUtils.showHideLoadingDiv(!0),i.width(i.width()),g.getData("popupComponent").setData("resultFetch",!0),g.setData("showSearchAcrossZoho",!1),13===t.keyCode){var f=$L("crm-chatbot-global-search-list")[0],x=f.getData("showResult");return commonUtils.showHideLoadingDiv(!1),void(x||(f.setData({showResult:!1,highlightSelected:"",primarySearchResult:"primarySearchResultW100"}),f.component.getChatbotResultOnEnter(N.slice(1))))}return void g.getAndSetChatbotGSData(g,N)}g.setData("searchInputText",N.slice(0,250)),g.setData("issearchTagInput",!1),g.setData("currentTagFocusIndex",-1),13===t.keyCode&&"#"!==N&&(g.setData("isSearchOnFocus",!0),l.focus());var D=g.getData("showChatbotGlobalSearch"),v=g.getData("searchInputText");D&&(N.length<=0||""===v||!v.startsWith("/"))&&g.resetChatbotSuggestionData(g)}else N=e.innerText.replace(/\n/g,""),g.setData("searchTagInputText",N),g.setData("issearchTagInput",!0),13===t.keyCode&&(e.innerText=N,""!==N&&g.actions.triggerSearchFocus(g));if(h||13!==t.keyCode){if(13===t.keyCode&&!g.getData("isSuggestionNeeded"))return}else{var b=g.getData("appliedTags").length>0;g.setData("isTagsEnabled",b);var C=g.getData("searchInputText").replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi," "),S=g.actions.checkTagPresentAndValues(g,C);if(S||-1!==n||_cruxUtils.showCustomAlert({params:{ltPropSecondaryMessage:I18n.getMsg("crm.global.search.type.alteast.characters",3)},close:function(){setTimeout((()=>{$L(".searchInputBox").focus()}),200)}}),S){g.getData("identifierComponent").setData("searchStarted",!0),g.getData("isPrimarySearch")&&g.getData("popupComponent").setData("searchStarted",!0),g.setData("currentAppliedTags",Lyte.deepCopyObject(g.getData("appliedTags"))),g.setData("currentAllTags",Lyte.deepCopyObject(g.getData("allTags"))),g.setData("currentPendingTags",Lyte.deepCopyObject(g.getData("pendingTags"))),g.setData("currentTagNameVsValue",g.getData("tagNameVsValue")),g.setData("currSearchInputText",g.getData("searchInputText"));var L=$L("crm-global-search-refine")[0].component;L.setData("triggeredModules",[]),g.setData("triggerHintNeeded",!1),g.setData("threeCharacterHintNeeded",!1),$L(".secondaryWrap").css("width",g.getData("inputWrapperWidth"));var P=Lyte.Router.getRouteInstance().getQueryParams().isRelevance;return L.setData("isRelevance",P||!1),void L.methods.clearFilterAndSearch(L,g)}}g.setData("isInputEmpty",!1);var _=g.getData("requestMade");if(r.actions.isTagsShouldBeShownValidation(e,g,N,a)){if(g.getData("identifierComponent").setData("searchStarted",!0),g.getData("isPrimarySearch")&&g.getData("popupComponent").getData("search_history").length<=0&&g.getData("popupComponent").setData("searchStarted",!0),c.removeClass("readyToRemove"),g.getData("identifierComponent").setData({isTagSearch:!0}),0===g.getData("appliedTags").length){var T=$L.extend(!0,[],g.getData("allTags"));g.setData("pendingTags",T),g.getData("identifierComponent").setData("pendingTags",T)}else g.getData("identifierComponent").setData("pendingTags",g.getData("pendingTags"));var I=g.getData("pendingTags");(void 0===I||I.length>0)&&g.getData("identifierComponent").setData("isTagSuggestionNeeded",!0),g.setData("moduleSuggestion",!1),g.actions.tagResultsUICalc(g),g.actions.removableSearch(g.getData("pendingTags"),"tag",N,g,t),g.actions.checkPrimaryTagSearchShowPlaceHolder(g)&&s.hide()}else{if(g.getData("identifierComponent").setData("isTagSuggestionNeeded",!1),g.getData("identifierComponent").setData("noTagResults",!1),!g.actions.checkPrimaryTagSearch(g.getData("appliedTags"),g.getData("searchInputText")))return s.show(),g.actions.checkPrimaryTagSearchShowPlaceHolder(g)&&s.hide(),void(h?g.actions.showCompIfNoCharacter(g):g.secondaryInputLeftCalc(g,e,a,t));if(g.setData("isResultsEmpty",!1),(!g.getData("isResultsEmpty")||8===t.keyCode)&&h){d&&c.removeClass("readyToRemove");var q=-1===g.getData("currentTagFocusIndex")?g.getData("searchInputText"):g.actions.getCurrentAppliedTagName(g),M=-1===g.getData("currentTagFocusIndex")?g.getData("oldSearchValue"):g.getData("oldTagValue"),R=g.actions.checkPrimaryTagSearch(g.getData("appliedTags"),g.getData("searchInputText"));R&&s.hide(),R&&g.actions.canMakeSearchRequestBasedOnPreviousWordSearch(q,M,t)&&(clearTimeout(this._tagSearchRequest),this._tagSearchRequest=setTimeout((function(){-1===g.getData("currentTagFocusIndex")?g.setData("oldSearchValue",q):g.setData("oldTagValue",q),g.getData("identifierComponent").setData("searchStarted",!0),g.getData("popupComponent").setData("searchStarted",!0),g.methods.makeSearchRequest(g)}),500))}}h||g.secondaryInputLeftCalc(g,e,a,t);y=g.getData("appliedTags");""!==N||_||0!==y.length||(g.actions.backToInit(g),g.setData("isInputEmpty",!0))}if(40===t.keyCode||38===t.keyCode){var N=$L(e).find(".searchInputBox").val();if(g=g||$L("crm-global-search-input")[0].component,N.startsWith("/")&&Crm.userDetails.isAskZiaQuerySuggEnabled)return void g.chabotGSKeyUpDownEvents(g,t)}},showCompIfNoCharacter:function(e){e.getData("popupComponent").setData("resultFetch",!1);var t=0===e.getData("searchInputText").length&&0===e.getData("appliedTags").length;e.getData("popupComponent").setData("showSearchHistory",!!t);var a=store.adapter["global-search"];a&&a.prevXhr&&(commonUtils.showHideLoadingDiv(!1),a.prevXhr.abort()),e.getData("popupComponent").setData("searchStarted",!1),e.getData("identifierComponent").setData({primarySearchResults:[]}),e.getData("identifierComponent").setData({isResultsEmpty:!1}),e.setData("oldSearchValue",""),e.setData("oldTagValue","")},canMakeSearchRequestBasedOnPreviousWordSearch:function(e,t,a){return(0!==e.trim().length||"Space"!==a.keyCode)&&e.trim()!==t.trim()},getCurrentAppliedTagName:function(e){const t=e.getData("appliedTags");if(t.length>0){var a=t.filter((t=>t.param===e.getData("currentTagFocusName")));if(a&&a[0])return a[0].value}return""},isTagPresentInSearchInput:function(e,t){for(var a=!1,o=e.length,i=0;i<o;i++)if(e[i].name.toLowerCase().startsWith(t))return a=!0,!0;return a},showNeededHintInInputBox:function(e,t){var a=t.getData("pendingTags"),o=t.getData("appliedTags"),i=t.getData("searchInputText"),r=t.actions.isTagPresentInSearchInput(a,i),s=t.actions.checkPrimaryTagSearch(o,i,r),l=!t.actions.checkPrimaryTagSearchShowPlaceHolder(t)&&!s;t.setData("triggerHintNeeded",s),t.setData("threeCharacterHintNeeded",l)},checkPrimaryTagSearchShowPlaceHolder:function(e){var t=!0,a=e.getData("appliedTags"),o=e.getData("searchInputText"),i=e.getData("pendingTags"),r=!e.actions.isTagPresentInSearchInput(i,o);return 0!==o.length&&r&&(t=!1),Object.keys(a).forEach((function(e){"Record_Name"!==a[e].param&&"Tags"!==a[e].param||!a[e].value||0===a[e].value.length||(t=!1)})),t},checkPrimaryTagSearch:function(e,t){var a=t.replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi," "),o=$L("crm-global-search-input")[0].component;return o.actions.checkTagPresentAndValues(o,a)},checkTagPresentAndValues:function(e,t){var a=e.getData("appliedTags"),o=e.getData("searchInputText"),i=e.getData("pendingTags"),r=!e.actions.isTagPresentInSearchInput(i,o),s=!1,l=t.replace(/[A-Z a-z 0-9 . / ]*/,"");return Object.keys(a).forEach((function(e){if("Record_Name"===a[e].param||"Tags"===a[e].param){var t=a[e].value,o=t.replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi," ");if((o=(o=o.trim()).replace(/[A-Z a-z 0-9 . / ]*/,""))||t.trim().length>2&&0!==t.trim().length)return void(s=!0)}})),!!(o.trim().length>2&&0!==o.trim().length&&r||s||l)},beforeInit:function(e,t){var a=t.keyCode;if((9===a||38===a||40===a||(t.ctrlKey||t.metaKey)&&("b"===t.key||"i"===t.key||"u"===t.key))&&(t.preventDefault(),(38===a||40===a)&&$L(".tagSearchResults:visible").length<=1))return!1;var o=this.$node.component;27===a&&o.data.isPrimarySearch&&o.actions.clearAllQueries();const i=o.getData("currentTagFocusIndex");var r,s=e.component?e.ltProp("value"):e.innerText.trim().replace(/\n/g,""),l=o.getData("appliedTags"),n=$L(".tagSearchResults.inHoverState"),p=$L(".readyToTag"),c=$L(".searchInputBox"),d=c.val(),u="";switch(13!==a&&9!==a||!o.getData("identifierComponent").getData("isTagSuggestionNeeded")||(o.setData("isSuggestionNeeded",!1),setTimeout(function(){t.stopPropagation(),u=p.text();var e=p.attr("data-tag-index"),a=p.attr("data-array-index");this.$node.component.actions.selectThisTag(r,u,a,e,o,l)}.bind(this,t,p,r,u,"","",o,l),1)),a){case 8:-1!==i?(0===(d=e.textContent).length&&t.preventDefault(),o.setData("searchTagInputText",d)):(d=$L(e).find(".searchInputBox").val(),o.setData("searchInputText",d)),"#"===(d=d.trim()).slice(0,1)&&1===d.length&&o.getData("identifierComponent").setData("isTagSuggestionNeeded",!1),o.getData("identifierComponent").setData({noTagResults:!1}),0===s.length?(0!==$L(".readyToRemove").length&&c.focus(),o.removeSelectedIdentifier(),0===o.getData("appliedTags").length&&(o.getData("identifierComponent").setData("primarySearchResults",[]),o.setData("isInputEmpty",!0),o.setData("isTagsEnabled",!1),this.getData("identifierComponent").setData("showResultsTrigger",!1)),o.getData("identifierComponent").setData("isTagSuggestionNeeded",!1)):s.length<1&&l.length>0&&(o.setData("isSuggestionNeeded",!1),o.setData("isResultsEmpty",!1),o.getData("identifierComponent").setData("isResultsEmpty",!1));break;case 40:p.removeClass("readyToTag");var m=n.next();n.removeClass("inHoverState"),m.length<=0?$L("#tagSearchResults_0").addClass("readyToTag inHoverState"):m.addClass("readyToTag inHoverState");break;case 38:p.removeClass("readyToTag");var g=n.prev();if(n.removeClass("inHoverState"),g.length<=0){var h=o.getData("pendingTags").length-1;$L("#tagSearchResults_"+h).addClass("readyToTag inHoverState")}else g.addClass("readyToTag inHoverState")}13!==t.keyCode&&9!==t.keyCode||(t.preventDefault(),o.getData("identifierComponent").setData("isTagSuggestionNeeded",!1)),setTimeout(function(){16!==a&&9!==a&&8!==a?o.setData("isInputEmpty",!1):9===a&&o.getData("isPrimarySearch")&&o.getData("popupComponent").setData("searchStarted",!0)}.bind(o,a),1)},selectThisTag:function(e,t,a,o,i,r){if(void 0!==e){t=(e=$L(e)).attr("data-tag-value"),a=e.attr("data-array-index"),o=e.attr("data-tag-index");(i=$L("crm-global-search-input")[0].component).getData("identifierComponent").setData("isTagSuggestionNeeded",!1);r=i.getData("appliedTags")}if(void 0!==a){var s=i.getData("allTags"),l=i.getData("identifierComponent").getData("pendingTags"),n=s[a],p=n.param;Lyte.arrayUtils(l,"removeAt",parseInt(o)),Lyte.arrayUtils(r,"push",n),Lyte.objectUtils(i.getData("tagNameVsValue"),"add",t,"");l=i.getData("identifierComponent").getData("pendingTags");i.setData("pendingTags",l),i.setData("isTagsEnabled",!0),i.setData("isSuggestionNeeded",!1),i.setData("isSearchOnFocus",!1);var c=i.getData("searchInputText"),d=c.lastIndexOf("#");c=c.substring(0,d),i.setData("searchInputText",c),i.getData("isPrimarySearch")&&i.getData("popupComponent").setData("searchStarted",!1),$L(".primarySearchContainer").find("lyte-input")[0].ltProp("value",c);var u=$L(".selectedTagsList").last().find(".appliedTagsInput");if("Modified_By"===p||"Created_By"===p){"Modified_By"===p?$L(".Modified_By").addClass("selectedTagFocus"):$L(".Created_By").addClass("selectedTagFocus");var m="."+p,g=$L("crux-user-dropdown");g[g.length-1].cxProp("inputName",p),setTimeout(function(){$L(m).find(".lyteDummyEventContainer")[0].click()}.bind(m))}else if("owned_by_me"===p||"shared_with_me"===p){i.showEnter(),i.setData("searchTagInputText","");const e=i.getData("appliedTags");i.actions.checkPrimaryTagSearch(e,i.getData("searchInputText"))&&(i.getData("isPrimarySearch")&&(i.getData("popupComponent").setData("searchStarted",!0),i.methods.makeSearchRequest(i)),i.getData("identifierComponent").setData("searchStarted",!0)),i.setData("isSearchOnFocus",!0);var h=$L(".searchInputBox");h.blur(),h.focus()}else u.focus();const e=i.data.appliedTags.findIndex((e=>e.param===p));i.setData("currentTagFocusName",p),i.setData("currentTagFocusIndex",e),i.setData("isTagJustSelected",!0),i.setData("isTagSelected",!0)}},tagResultsUICalc:function(e){var t=0,a=$L(".tagSuggestions"),o=$L(".primarySearchContainer"),i=o.offset().left,r=o.outerWidth();if(e.getData("isPrimarySearch")){var s=$L(".primarySearchElemWrap"),l=s.position().top,n=s.offset().left,p=s.outerWidth(),c=s.outerHeight()+l;t=Crm.userDetails.RTL_ENABLED?p+n-(r+i):i-n,a.css("top",c)}else{var d=$L(".globalSearchInputWrap"),u=d.offset().left,m=d.outerWidth();t=Crm.userDetails.RTL_ENABLED?u+m-(i+r):i-u}Crm.userDetails.RTL_ENABLED?a.css("right",t):a.css("left",t)},clearAllQueries:function(e){var t=$L("crm-global-search-input")[0].component;if($L(".primarySearchInput")[0].ltProp("value",""),t.setData({tagNameVsValue:{},appliedTags:[],pendingTags:[],isInputEmpty:!0,isTagsEnabled:!1,isSuggestionNeeded:!1,requestMade:!1,oldSearchValue:""}),t.getData("identifierComponent").setData({searchStarted:!1}),t.setData("oldTagValue",""),t.setData("currentTagFocusName",""),t.setData("currentTagFocusIndex",-1),t.getData("isPrimarySearch")){e||t.setData("selectedModule",{api_name:"AllModules",label:I18n.getMsg("crm.label.AllModules")}),t.getData("popupComponent").setData("needLoading",!1);var a=0===t.getData("searchInputText").length&&0===t.getData("appliedTags").length;t.getData("popupComponent").setData("showSearchHistory",!!a),t.getData("popupComponent").setData("searchStarted",!1),t.getData("identifierComponent").setData({primarySearchResults:[]}),t.getData("identifierComponent").setData({isResultsEmpty:!1}),t.setData({showChatbotGlobalSearch:!1,searchInputText:""})}for(var o=t.getData("allTags"),i=o.length,r=0;r<i;r++)o[r].value="";t&&!t.getData("isPrimarySearch")&&this.actions.triggerSearchFocus(this),clearInterval()},untriggerSearchFocus:function(){this.setData("isSearchOnFocus",!1),this.getData("isInSearchFocus")?setTimeout(function(){this.getData("identifierComponent")&&this.getData("isInSearchFocus")&&this.getData("identifierComponent").setData("isTagSuggestionNeeded",!1),this.setData("isInSearchFocus",!0)}.bind(this),200):this.setData("isInSearchFocus",!0)},triggerSearchFocus:function(e){var t=$L(".searchInputBox");void 0===e&&(e=this),t.focus(),/^#+$/.test(t.val())||/\s#$/g.test(t.val())?(e.getData("identifierComponent").setData("isTagSuggestionNeeded",!0),e.getData("identifierComponent").setData("showSecondaryTagGlobalSearch",!0),e.actions.tagResultsUICalc(e),e.actions.removableSearch(e.getData("pendingTags"),"tag",e.getData("searchInputText"),e,void 0)):e.getData("identifierComponent").component&&e.getData("identifierComponent").setData("showSecondaryTagGlobalSearch",!1),e.getData("isSearchOnFocus")||(e.setData("isSearchOnFocus",!0),e.setData("oldTagValue",t[0].value),e.setData("oldSearchValue",t[0].value),e.setData("currentTagFocusName",""),e.setData("currentTagFocusIndex",-1))},triggerIdentifierFocus:function(e,t){$L(e).focus();var a=$L(e.parentElement),o=a.attr("data-tag-param");t||(t=this),t.setData("oldTagValue",e.textContent),t.setData("oldSearchValue",e.textContent),t.setData("currentTagFocusName",o),t.setData("currentTagFocusIndex",a.attr("data-tag-index"))},focusInToTag:function(){this.getData("identifierComponent").setData("isTagSuggestionNeeded",!1),$L(".readyToRemove").removeClass("readyToRemove")},openZohoSearchPage:function(){var e=$L("crm-global-search-input")[0].component.data.searchInputText;this.closePopup(),zgssearch.search(e)},focusOutFromTag:function(e,t){var a=e.textContent.trim().length,o=$L("crm-global-search-input")[0].component;if(o.setData("oldTagValue",""),o.setData("oldSearchValue",""),13===t.keyCode||9===t.keyCode){var i=$L(".searchInputBox");o.setData("isSearchOnFocus",!0),i.focus(),o.setData("oldTagValue",""),o.setData("oldSearchValue",""),o.getData("isPrimarySearch")&&(a>2&&o.methods.makeSearchRequest(o),o.setData("requestMade",!0),setTimeout(function(){o.setData("requestMade",!1)}.bind(this),1e3))}else 8===t.keyCode&&a<1&&this.removeSelectedIdentifier(e,t,!0);o.setData("currentTagFocusIndex",-1),o.setData("currentTagFocusName",""),this.checkTextCount(e,t)},backToInit:function(e){e.getData("identifierComponent").setData({searchStarted:!1}),e.setDataInPopupComponent(e,"searchStarted",!1),e.getData("identifierComponent").setData("isResultsEmpty",!1),e.setData({isSuggestionNeeded:!1,isInputEmpty:!0}),e.getData("isPrimarySearch")&&(e.getData("identifierComponent").setData("primarySearchResults",[]),0===e.getData("searchInputText").length&&0===e.getData("appliedTags").length&&e.getData("popupComponent").setData("showSearchHistory",!0),e.getData("popupComponent").setData("resultFetch",!1)),e.actions.triggerSearchFocus(e)},removableSearch:function(e,t,a,o,i){if("tag"===t){var r=0,s=$L(".tagSearchResults");s.hide();var l=a.toLowerCase(),n=a.split(" "),p=n.length;if(p>0)for(var c=0;c<p;c++)"#"===n[c].slice(0,1)&&(l=n[c].toLowerCase());var d=!0,u=$L("#primarySearchInput")[0],m=e.length;$L(".inHoverState").removeClass("inHoverState"),$L(".readyToTag").removeClass("readyToTag");for(c=0;c<m;c++){-1!==e[c].display_label.toLowerCase().search(l)&&(r+=1,s.eq(c).show(),d&&(s.eq(c).addClass("readyToTag inHoverState"),d=!1))}0===r?(o.getData("identifierComponent").setData({primarySearchResults:[],noTagResults:!0}),o.actions.initSearch(u,i,!0,o)):o.getData("identifierComponent").setData("noTagResults",!1)}else o.methods.makeSearchRequest(this)},applyTagValue:function(e,t,a){if(""===a)return!1;const o=$L("crm-global-search-input")[0].component;var i=t.innerText.replace(/\n/g,"");return o.getData("appliedTags").filter((function(e){e.param===a&&(e.value=i)})),Lyte.objectUtils(o.getData("tagNameVsValue"),"add",a,i),o.actions.checkTextCount(t,e),!(i.length<3)},checkTextCount:function(e,t){var a=$L(e).text().length;if(8!==t.which&&13!==t.which&91!==t.which&&65!==t.which&&a>50)return t.preventDefault(),!1},setDropdownPosition:function(){setTimeout(function(){this.setDropdownPosition(this)}.bind(this),1)},removeIdentifier:function(e,t){this.setData("isInSearchFocus",!1);var a=this.getData("allTags");this.showEnter(),l=(l=this.getData("appliedTags")).filter(((t,a)=>a!==e)),a[t.indexVal].value="";var o=this.getData("pendingTags");o=(o=[...o,a[t.indexVal]]).sort(((e,t)=>e.indexVal>t.indexVal?1:-1)),this.setData("pendingTags",o),this.getData("identifierComponent").setData("pendingTags",o),l.filter((function(e){"Created_By"!==e.param&&"Modified_By"!==e.param||!e.value[0].name||(e.value[0].full_name=e.value[0].name)})),this.setData("appliedTags",l),this.setData("oldTagValue",""),this.setData("allTags",a),this.setData("currentTagFocusName",""),this.setData("currentTagFocusIndex",-1);var i=this.getData("searchInputText"),r=$L(".gsLeastChar");if(this.getData("isPrimarySearch")){var s=0===this.getData("searchInputText").length&&0===this.getData("appliedTags").length;this.getData("popupComponent").setData("showSearchHistory",!!s),this.actions.checkPrimaryTagSearch(this.getData("appliedTags"),i)?this.methods.makeSearchRequest(this):(r.show(),this.actions.checkPrimaryTagSearchShowPlaceHolder(this)&&r.hide(),this.actions.backToInit(this))}var l=this.getData("appliedTags"),n=$L(".askZiaSearchAnimationCase");if(0===l.length&&i.startsWith("/")&&Crm.userDetails.isAskZiaQuerySuggEnabled)return r.hide(),1===i.length&&Crm.client_tracking("AskZia Query suggestion - Click",{source:"Global search"}),commonUtils.showHideLoadingDiv(!0),n.width(n.width()),this.getData("popupComponent").setData("resultFetch",!0),this.setData("showSearchAcrossZoho",!1),void this.getAndSetChatbotGSData(this,i);this.actions.triggerSearchFocus(this),this.showEnter()}},secondaryInputLeftCalc:function(e){var t=$L("crm-global-search-refine")[0].component;e.actions.showNeededHintInInputBox(t,e)},showEnter:function(){this.getData("isPrimarySearch")||(this.actions.checkPrimaryTagSearch(this.getData("appliedTags"),this.getData("searchInputText"))&&!this.getData("identifierComponent").getData("isTagSuggestionNeeded")?(this.setData("triggerHintNeeded",!0),this.setData("threeCharacterHintNeeded",!1)):(this.setData("triggerHintNeeded",!1),this.setData("threeCharacterHintNeeded",!0)),this.actions.checkPrimaryTagSearchShowPlaceHolder(this)&&this.setData("threeCharacterHintNeeded",!1))},setDropdownPosition:function(e){var t,a=(t=e.getData("isPrimarySearch")?$L(".primarySearchElemWrap"):$L(".secondarySearchInputWrap")).offset().left,o=t.offset().top+t.height();$L(".moduleSelectionDD").css({left:a,top:o})},removeSelectedIdentifier:function(e,t,a){var o=this,i=o.getData("appliedTags"),r=$L(".readyToRemove"),s=$L(".selectedTagsList"),l=o.getData("currentTagFocusIndex");if(r.length>0){var n=parseInt(r.attr("data-array-index"));const e=i.length;for(var p=0;p<e;p++){if(i[p].param===r.attr("data-tag-param")){Lyte.arrayUtils(i,"removeAt",p,1);break}}var c=o.getData("allTags");c[n].value="",o.setData("allTags",c);var d=c[n].name,u=o.getData("tagNameVsValue");if(delete u[d],o.setData("tagNameVsValue",u),0===i.length){var m=$L.extend(!0,[],c);o.setData("pendingTags",m),o.setData("isTagSearch",!1),o.getData("identifierComponent").setData({pendingTags:m,isTagsEnabled:!1})}else{var g=c[n];Lyte.arrayUtils(o.getData("pendingTags"),"insertAt",n,g);var h=o.getData("pendingTags").filter((e=>void 0!==e)).sort(((e,t)=>e.indexVal-t.indexVal));o.setData("pendingTags",h)}var y=o.getData("searchInputText");o.getData("isPrimarySearch")?y.length>0||i.length>0?o.methods.makeSearchRequest(o):o.actions.backToInit(this):o.actions.triggerSearchFocus(o),o.showEnter()}a?$L(e).closest(".selectedTagsList").addClass("readyToRemove"):$L(s.eq(l)).addClass("readyToRemove")},setDataInPopupComponent:function(e,t,a){Object.keys(e.getData("popupComponent"))>0&&e.getData("popupComponent").setData(t,a)},getAndSetChatbotGSData:function(e,t){var a=networkUtils.returnDependencyFiles(["crm-chatbot-globalsearch.js","crm-chatbot-components.js"],ResourceConstants.CRMClient),o=networkUtils.returnDependencyFiles(["crm-chatbot-globalsearch.css","crm-global-search.css"],ResourceConstants.CRMClient,ResourceConstants.LESSDEFAULT),i=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("AskZia"),networkUtils.getI18nJSUrl("Chatbot")],ResourceConstants.CRM);Lyte.injectResources(a.concat(o).concat(i),void 0,(function(){e.resetcbSearchListValues();var a,o,i,r=(t=t.trim()).length,s="";r>1?(t.startsWith("/")&&(i=t.slice(1)),s=i):s="''";for(var l=t.split(" "),n=l.length,p=l.filter((function(e){return""!==e})).length,c=n-1,d=0,u=0;u<n;u++)l[u].length<=1&&""!==l[u]?d++:d=0;var m=e.getData("identifierComponent"),g=m.getData("recentlySearchedSuggestions"),h=m.getData("allSearchSuggestions"),y=m.getData("searchSuggestions");if((1===r||c===p&&d<3||0===g.length||0===h.length)&&(a=store.findAll("dummy",null,!1,!1,{url:"/crm/v5/__internal/chatbot_suggestion?ishelp=true&keyword="+s,method:"GET",contentType:"application/json"}),o=store.findAll("recent_searched_suggestions")),void 0===a&&void 0!==e){commonUtils.showHideLoadingDiv(!1);var f=[];if(y.length>0&&r>0&&1!==r&&"/"!==t){var x=t.slice(1).split(" "),D=x.length;f=h.filter((function(e){for(var t,a=0;a<D;a++)if(-1!==e.sentence.toLowerCase().indexOf(x[a].toLowerCase())){t=e.sentence;break}return t}))}e.setChatbotSuggestionsDataToComponent(e,f,g,h,t)}else{var v={search_suggestions:a,recent_search_sgguestions:o};Lyte.resolvePromises(v).then((function(a){commonUtils.showHideLoadingDiv(!1);var o=$L(".searchInputBox").val();if(o.length>0){var i,r=a.recent_search_sgguestions,s=[];r.forEach((function(e){s.push(JSON.parse(e.suggestion))})),i=void 0!==a.search_suggestions.chatbot_suggestion.response&&void 0!==a.search_suggestions.chatbot_suggestion.response.suggestions&&a.search_suggestions.chatbot_suggestion.response.suggestions.length>0?a.search_suggestions.chatbot_suggestion.response.suggestions:o.startsWith("/")&&1===o.length?e.getDefaultSuggestions():[],e.setChatbotSuggestionsDataToComponent(e,i,s,i,t)}}),(function(){commonUtils.showHideLoadingDiv(!1);var a=e.getDefaultSuggestions();e.setChatbotSuggestionsDataToComponent(e,a,[],a,t)}))}}))},setChatbotSuggestionsDataToComponent:function(e,t,a,o,i){e.getData("popupComponent").setData("showChatbotGlobalSearch",!0),e.setData("showChatbotGlobalSearch",!0),$L(".askZiaSearchAnimationCase").width($L(".askZiaSearchTitleSpan").outerWidth());var r=e.getData("identifierComponent"),s=r.getData("primarySearchResults");Lyte.arrayUtils(s,"push",s),r.setData({searchSuggestions:t,recentlySearchedSuggestions:a,allSearchSuggestions:o,showChatbotGlobalSearch:!0,showResultsTrigger:!1,isResultsEmpty:!1});var l=e.getData("cbPrevKeyword"),n=e.getData("cbIsIntervalSet"),p=i;i.startsWith("/")&&(p=i.slice(1).toLowerCase()),l!==p&&(e.setData("cbCurrKeyword",p),n||e.getChatbotSuggestionInInterval(e)),$L("crm-global-search-popup")[0].component.methods.reCalculateHeight(),commonUtils.showHideLoadingDiv(!1)},getChatbotSuggestionInInterval:function(e){setInterval((function(){var t=e.getData("cbPrevKeyword"),a=e.getData("cbCurrKeyword"),o=e.getData("searchInputText");if(t!==a&&(""!==t||"''"!==a)&&""!==o){e.setData("cbPrevKeyword",a),e.setData("cbIsIntervalSet",!0),a=""!==a?a:"''";var i={search_suggestions:store.findAll("dummy",null,!1,!1,{url:"/crm/v5/__internal/chatbot_suggestion?keyword="+a,method:"GET",contentType:"application/json"})};Lyte.resolvePromises(i).then((function(e){var t=$L(".searchInputBox").val(),o=$L("crm-global-search-input")[0],i=o.getData("searchInputText");if(""!==i&&t.length>0){o.setData("showChatbotGlobalSearch",!0),o.getData("popupComponent").setData("showChatbotGlobalSearch",!0);var r=o.getData("identifierComponent").getData("recentlySearchedSuggestions"),s=[];s=void 0!==e.search_suggestions.chatbot_suggestion.response&&void 0!==e.search_suggestions.chatbot_suggestion.response.suggestions&&e.search_suggestions.chatbot_suggestion.response.suggestions.length>0?e.search_suggestions.chatbot_suggestion.response.suggestions:i.startsWith("/")&&0===t.length||0===r.length&&0===s.length?o.component.getDefaultSuggestions():[],o.component.setChatbotSuggestionsDataToComponent(o,s,r,s,a)}else o.resetChatbotSuggestionData(o)}),(function(){if(""!==o){var t=e.component.getDefaultSuggestions();e.component.setChatbotSuggestionsDataToComponent(inputComp,t,[],t,a)}}))}}),800)},resetChatbotSuggestionData:function(e){e.getData("identifierComponent").setData({showChatbotGlobalSearch:!1,recentlySearchedSuggestions:[],searchSuggestions:[],allSearchSuggestions:[]}),e.setData({showChatbotGlobalSearch:!1,showSearchAcrossZoho:!0}),e.getData("popupComponent").setData({resultFetch:!1,showChatbotGlobalSearch:!1}),$L(".askZiaSearchAnimationCase").width("auto"),clearInterval()},chabotGSKeyUpDownEvents:function(e,t){for(var a="",o=$L(".searchResultList"),i=o.length,r=!1,s=0;s<i;s++)o[s].classList.contains("ziaExploreSelected")&&(r=!0);if(void 0!==o[0]&&!r)return o[0].classList.add("ziaExploreSelected"),a="/"+o[0].innerText,void e.setData("searchInputText",a);if(38===t.keyCode){for(s=0;s<i;s++)if(o[s].classList.contains("ziaExploreSelected")&&s-1>=0){o[s].classList.remove("ziaExploreSelected"),o[s-1].classList.add("ziaExploreSelected"),a="/"+o[s-1].innerText,e.setData("searchInputText",a);break}var l=$L(".searchResultListParent");$L(".ziaExploreSelected").offset().top<0&&l.scrollTop(0)}if(40===t.keyCode){for(s=0;s<i;s++)if(o[s].classList.contains("ziaExploreSelected")&&s+1<i){o[s].classList.remove("ziaExploreSelected"),o[s+1].classList.add("ziaExploreSelected"),a="/"+o[s+1].innerText,e.setData("searchInputText",a);break}var n=$L(".searchResultListParent"),p=n.offset().top,c=n.outerHeight(),d=n.scrollTop(),u=$L(".ziaExploreSelected"),m=p+c,g=u.offset().top+u.outerHeight(),h=d+g-m;g>m&&n.scrollTop(h)}var y,f=$L("crm-chatbot-global-search-result")[0],x=$L("crm-chatbot-global-search-list")[0],D=a.slice(1);f&&""!==D&&(clearTimeout(e.getData("chatbotResultFetchingTimeOutId")),e.resetChatbotResults(),f.setData({noResultsFound:!1,askziaInsideLoader:"askziaInsideLoader",selectedSentence:D,showRoutineMessage:!1,showExploreIcon:!1,showChatbotResult:!1}),y=setTimeout((function(){var t=location.protocol+"//"+location.host,a={crm_data_fetcher:[{message:D,base_url:t}]};store.findAll("dummy",null,!1,!1,{url:"/crm/v2.2/crm_data_fetcher",payLoad:JSON.stringify(a),method:"POST",contentType:"application/json",headers:{"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken,"X-ZOHO-SERVICE":"crm/queryconvertor"}}).then((function(t){e.resetChatbotResults(),f||(f=$L("crm-chatbot-global-search-result")[0].component),f.setData("askziaInsideLoader","askziaInsideLoader");var a=x.getData("recentlySearchedSuggestions"),o=x.getData("allSearchSuggestions");if(0===a.filter((function(e){if(e.sentence===D)return e})).length){f.setData("searchObj",{}),a.length>=5&&Lyte.arrayUtils(a,"pop");var i=o.filter((function(e){if(e.sentence===D)return e}));0!==i.length&&(Lyte.arrayUtils(a,"unshift",i),f.setData("searchObj",i[0]),f.component.saveRecentSearch(f))}var r=t.dummy.crm_data_fetcher;if(r.details.data.isFromGS=!0,r.details&&r.details.di_data&&("search"===r.details.di_data.query_type||"help"===r.details.di_data.query_type)||r&&r.details&&r.details.data&&r.details.data.result&&0!==r.details.data.result.length&&"gsearch"===r.details.data.type||r&&r.details&&r.details.data&&r.details.data.result&&0!==r.details.data.result.length&&"module_gsearch"===r.details.data.type||r.details&&r.details.data&&("suggestions"===r.details.data.output_format||"help_content"===r.details.data.output_format))f.setData("showTryAskZia",!0),f.setData("noResultsFound",!0),f.setData("showRoutineMessage",!1);else{var s;r.details.summary&&(s=JSON.stringify(r.details.summary),f.setData("pathway",s)),f.setData({showExploreIcon:!!s,exploreSummary:s,diResponse:t.dummy,showRoutineMessage:!0,showChatbotResult:!0});var l=$("#chatbotResult");l?Lyte.registeredMixins["crm-chatbot-helper"].ziaRenderResult(f.getData("diResponse"),l):setTimeout((function(){Lyte.registeredMixins["crm-chatbot-helper"].ziaRenderResult(f.getData("diResponse"),l)}),500)}return f.setData("askziaInsideLoader",""),x&&x.setData("disableClick",!1),!0}),(function(){return f.setData({askziaInsideLoader:"",noResultsFound:!0,showTryAskZia:!1}),x&&x.setData({disableClick:!1,highlightSelected:""}),!1}))}),500),e.setData("chatbotResultFetchingTimeOutId",y))},resetChatbotResults:function(){var e,t=$L("crm-intelligence-config-result");t&&t[0]&&t[0].remove(),(e=$L("#chatBotDiv"))&&e[0]&&e[0].remove(),(e=$L("#chatbotResult"))&&e[0]&&(e[0].innerHTML="")},getDefaultSuggestions:function(){var e=store.peekAll("module"),t=e.filter((function(e){if(!0===e.visible&&!0===e.viewable&&"Deals"===e.api_name)return e})),a=e.filter((function(e){if(!0===e.visible&&!0===e.viewable&&"Accounts"===e.api_name)return e})),o=e.filter((function(e){if(!0===e.visible&&!0===e.viewable&&"Leads"===e.api_name)return e})),i=e.filter((function(e){if(!0===e.visible&&!0===e.viewable&&"Events"===e.api_name)return e})),r=e.filter((function(e){if(!0===e.visible&&!0===e.viewable&&"Calls"===e.api_name)return e})),s=e.filter((function(e){if(!0===e.visible&&!0===e.viewable&&"Tasks"===e.api_name)return e})),l=e.filter((function(e){if(!0===e.visible&&!0===e.viewable&&"Emails"===e.api_name)return e})),n=t[0]&&t[0].plural_label&&I18n.getMsg("crm.chatbot.def.sugg1",t[0].plural_label),p=a[0]&&a[0].plural_label&&I18n.getMsg("crm.chatbot.def.sugg2",a[0].plural_label),c=o[0]&&o[0].plural_label&&I18n.getMsg("crm.chatbot.def.sugg3",o[0].plural_label),d=s[0]&&s[0].plural_label&&I18n.getMsg("crm.chatbot.def.sugg4",s[0].plural_label),u=i[0]&&i[0].plural_label&&I18n.getMsg("crm.chatbot.def.sugg4",i[0].plural_label),m=r[0]&&r[0].plural_label&&I18n.getMsg("crm.chatbot.def.sugg4",r[0].plural_label),g=r[0]&&r[0].plural_label&&I18n.getMsg("crm.chatbot.def.sugg5",r[0].plural_label),h=i[0]&&i[0].plural_label&&I18n.getMsg("crm.chatbot.def.sugg6",i[0].plural_label),y=t[0]&&t[0].plural_label&&I18n.getMsg("crm.chatbot.def.sugg7",t[0].plural_label),f=l[0]&&l[0].plural_label&&I18n.getMsg("crm.chatbot.def.sugg8",l[0].plural_label),x=o[0]&&o[0].plural_label&&I18n.getMsg("crm.chatbot.def.sugg9",o[0].plural_label),D=[];n&&D.push(n),p&&D.push(p),c&&D.push(c),d&&D.push(d),u&&D.push(u),m&&D.push(m),g&&D.push(g),h&&D.push(h),y&&D.push(y),f&&D.push(f),x&&D.push(x);for(var v=[],b=D.length,C=0;C<b;C++){var S={};S.sentence=D[C],v.push(S)}var L={};L.sentence=I18n.getMsg("crm.chatbot.def.sugg10"),v.push(L);var P={};return P.sentence=I18n.getMsg("crm.chatbot.def.sugg11"),v.push(P),v},resetcbSearchListValues:function(){var e=$L("crm-chatbot-global-search-list")[0];e&&e.setData({showResult:!1,highlightSelected:"",primarySearchResult:"primarySearchResultW100"})}},{mixins:["crm-global-search-mixin","crm-ziachatbot-helper"]}),store.registerModel("global-search",{data:Lyte.attr("array"),info:Lyte.attr("object"),meta:Lyte.attr("array")}),store.registerAdapter("global-search",{namespace:"crm/v2.1",buildURL:function(e,t,a,o,i){if(a.meta_resources)i=(i=i.replace("crm/v2.1","crm/v2.1/settings")).replace(e,"search");else{if(i=(i=i.replace("/crm/v2.1","/crm/v2.2")).replace(e,"__search"),void 0!==a.criteria&&void 0!==a.refineCriteria){var r=JSON.parse(a.criteria),s=JSON.parse(a.refineCriteria);if(void 0!==r.group)void 0!==s.group?s.map(criteriaFormation,r):r.group.push(s),a.filters=r;else if(void 0!==s.group)void 0!==r.group?r.map(criteriaFormation,s):s.group.push(r),a.filters=s;else{var l=[];l.push(r),l.push(s),(r={}).group=l,r.group_operator="and",a.filters=r}}else void 0!==a.criteria?a.filters=JSON.parse(a.criteria):void 0!==a.refineCriteria&&(a.filters=JSON.parse(a.refineCriteria));delete a.criteria,delete a.refineCriteria,void 0!==a.isRelevance&&(a.relevant=a.isRelevance,delete a.isRelevance);var n=a.modules;void 0!==a.isNavig&&a.isNavig&&delete a.isNavig,n&&"AllModules"===n&&delete a.modules}return i},parseRequest:function(e,t,a,o){o.searchword&&"findAll"===e&&(this.prevKey&&this.prevKey!==o.searchword&&this.prevXhr.abort(),this.prevKey=o.searchword,this.prevXhr=a)},criteriaFormation:function(e,t){t.push(e)}}),store.registerSerializer("global-search",{payloadKey(e,t,a,o,i,r){if(!r||!1!==r.cacheData)return"data"},extractMeta:function(e){var t=e.meta,a=e.info;e.meta={},e.meta.field_details=t,e.meta.info=a,a&&(e.meta.has_more_records=a.has_more_records),delete e.info}}),Lyte.Mixin.register("crm-global-search-mixin",{getDataFromModuleRecordMapping:function(){var e={},t=[],a={},o={},i=1;const r=Object.entries(moduleRecordMapping).sort(((e,t)=>{const a=e=>e.module_name>="CustomModule5001"&&e.module_name<="CustomModule5010",o=a(e[1]),i=a(t[1]);return o&&i?(r=e[1],s=t[1],r.api_name.localeCompare(s.api_name)):(o?1:i?-1:0)||e[1].sequence_number-t[1].sequence_number;var r,s}));for(var s in r){var l=r[s][0];if(void 0!==l&&"Visits"!==l&&"Documents"!==l){var n={},p="Notes"===moduleRecordMapping[l].module_name&&moduleRecordMapping[l].viewable,c="Tasks"===moduleRecordMapping[l].module_name||"Events"===moduleRecordMapping[l].module_name||"Calls"===moduleRecordMapping[l].module_name;if(p||moduleRecordMapping.hasOwnProperty(l)&&"CustomModule5008"!==moduleRecordMapping[l].api_name&&(moduleRecordMapping[l].visible||c)&&2!=(2&moduleRecordMapping[l].visibility)&&moduleRecordMapping[l].global_search_supported&&moduleRecordMapping[l].viewable&&!o.hasOwnProperty(moduleRecordMapping[l].api_name)&&"subform"!==moduleRecordMapping[l].generated_type&&"static_subform"!==moduleRecordMapping[l].generated_type){(n={}).module_name=moduleRecordMapping[l].module_name,n.api_name=moduleRecordMapping[l].api_name,n.index=i,n.plural_label=moduleRecordMapping[l].plural_label;/^CustomModule500[1-4]$/.test(moduleRecordMapping[l].api_name)&&(n.plural_label=n.plural_label+" ("+I18n.getMsg("crm.title.zohofinance","Zoho")+")"),n.singular_label=moduleRecordMapping[l].singular_label,n.id=moduleRecordMapping[l].id,n.field_label=n.plural_label,t.push(n),a[n.plural_label]=n.api_name,o[n.api_name]=n,i++}}}return e.allModulesArrayList=t,e.displayLabelVsSysRefNameMap=a,e.sysRefNameVsModuleDetailsMap=o,e},close:function(){$L("crm-global-search-popup")[0].component.methods.closePopup()},moduleCacheFormation:function(e,t){if(void 0!==t[10]){for(var a=[],o=t.length,i=1;i<=o;i++)a.push(t[i-1]),i%10==0&&(e.push(a),a=[]);a.length>0&&e.push(a)}else e.push(t)},criteriaFormationForRequest:function(e,t){var a={},o=Object.keys(t),i=o.length;if(e&&i>0)if(i>1){var r=[];o.filter((function(e,a){var i={},s={},l=o[a];s.api_name=l,i.field=s,i.value=t[l],i.comparator="Modified_By"===s.api_name||"Created_By"===s.api_name?"equal":"starts_with",r.push(i)})),a.group=r,a.group_operator="and"}else{var s={},l=o[0];s.api_name=l,a.field=s,a.value=t[l],a.comparator="Modified_By"===s.api_name||"Created_By"===s.api_name?"equal":"starts_with"}return a},renderSecondaryResults:e=>{var t=$L("crm-global-search-input")[0].component,a={},o={};if("undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()){var i=$L("crm-global-search-history")[0];i&&i.component.setData("isSecondaryPageOpen",!0)}if(t.getData("isTagsEnabled")){var r,s=t.getData("appliedTags"),l={};s.length>0&&(Crm.client_tracking("Global Search New UI - Tags used"),s.filter((function(e){if("owned_by_me"===e.param||"shared_with_me"===e.param)void 0===r?(r=e.param,o.filter_by=r):(r="owned_and_shared_with_me",o.filter_by=r);else{var t=e.value,a=e.param;if(t&&""!==t){a=e.param;l[a]=t}}})));var n=!validationUtils.isEmpty(l);a=t.criteriaFormationForRequest(n,l),Object.keys(a).length>0&&(o.criteria=JSON.stringify(a))}if(t.validateSearchInput()){o.searchword=t.getData("searchInputText");var p=t.getData("selectedModule");p&&(o.modules=p.api_name),o.isRelevance=!1;var c=[];if(t.getData("isPrimarySearch")){if(p&&"AllModules"!==p.api_name){var d=Utils.inverseKeyValues(moduleApiMapping);p.id=moduleRecordMapping[d[p.api_name]].id,p.field_label=p.label,Lyte.arrayUtils(c,"push",p)}}else{var u=$L("crm-global-search-refine")[0].component;o.isRelevance=u.getData("isRelevance");var m=u.getData("refineCriteria");if(void 0!==m&&Object.keys(m).length>0&&(o.refineCriteria=JSON.stringify(m)),(c=u.getData("filteredModules")).length>0){o.modules="";var g=c.length-1;for(let e=0;e<=g;e++)o.modules+=e===g?c[e].api_name:c[e].api_name+","}}var h={appliedTags:t.getData("appliedTags"),pendingTags:t.getData("pendingTags"),isTagsEnabled:t.getData("isTagsEnabled"),filteredModules:c};if(o.filteredModules=c,t.getData("isTagsEnabled"))if(t.getData("appliedTags").filter((e=>"Created_By"===e.param||"Modified_By"===e.param)).length>0){h.selectedUsers=[];for(var y=$L("crux-user-dropdown"),f=y.length,x=0;x<f;x++){var D={};D.inputName=y[x].component.getData("cxPropInputName"),D.user=y[x].getData("cxPropSelectedUser"),h.selectedUsers.push(D)}}if(!t.getData("isPrimarySearch")){var v=[...(u=$L("crm-global-search-refine")[0].component).getData("resultsShownForTags")];Lyte.arrayUtils(u.getData("resultsShownForTags"),"removeObjects",v),Lyte.arrayUtils(u.getData("resultsShownForTags"),"push",t.getData("appliedTags"))}"AllModules"===o.modules&&delete o.modules,e&&(h.clearBtn=!0),!t.getData("isPrimarySearch")||"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()||$L("#primaryGsearch")[0].ltProp("show",!1),h.refresh=!0,Lyte.Router.transitionTo({route:"crm.global-search",queryParams:o}).data=h}else _cruxUtils.showCustomAlert({params:{ltPropSecondaryMessage:I18n.getMsg("crm.global.search.type.alteast.characters",3)},close:function(){setTimeout((()=>{$L(".searchInputBox").focus()}),200)}})},formatNotesContent:e=>{if(null!=e&&e.length>0){for(var t=new RegExp("crm[[aA-zZ]*#[0-9]*#[0-9]*]crm","gi"),a=e.slice(),o=e.match(t),i=o?o.length:0,r=0;r<i;r++){var s,l=o[r].indexOf("#"),n=o[r].lastIndexOf("#"),p=o[r].slice(l+1,n);if(-1!==o[r].indexOf("user")){var c=(s=store.peekRecord("user",p))?s.full_name:"";e=(e=e.replace(o[r],c?"<a href='javascript:;' class='crmLinkColor cP'>"+$ESAPI.encoder().encodeForHTML(c)+",</a>":"")).replace(o[r],c?'<span style="white-space:break-spaces;color:#333;font-weight:bold">@['+c+":"+p+"]</span>":""),a=a.replace(o[r],c?c+",":"")}else if(-1!==o[r].indexOf("role")){c=(s=store.peekRecord("role",p))?s.name:"";e=e.replace(o[r],c?"<a href='javascript:;' class='crmLinkColor cP'>"+c+",</a>":""),a=a.replace(o[r],c?c+",":"")}else if(-1!==o[r].indexOf("group")){c=(s=store.peekRecord("user_group",p))?s.name:"";e=e.replace(o[r],c?"<a href='javascript:;' class='crmLinkColor cP'>"+c+",</a>":""),a=a.replace(o[r],c?c+",":"")}}return a}return e},getSearchHistory:()=>{const e=$L("crm-global-search-popup")[0].component;commonUtils.showHideLoadingDiv(!0);var t={};t.filters=String('{"comparator":"equals","field":{"api_name":"source"},"value":"search"}'),store.findAll("search-history",t,!1,!1).then((function(t){commonUtils.showHideLoadingDiv(!1),e.setData("search_history",t.recent_items)})).catch((function(){commonUtils.showHideLoadingDiv(!1),e.setData("search_history",[])}))},syncFilterLabel:()=>{const e=$L("crm-global-search-refine")[0].component,t=e.getData("filteredModules"),a=e.getData("smartFilterFields"),o=e.getData("refineCriteria"),i=t.map((e=>e.field_label));let r=[];if(o&&Object.keys(o).length>0)if(o.group&&o.group.length>0){const e=o.group.map((e=>e.field.api_name));r=a.filter((t=>e.includes(t.api_name))),r=r.map((e=>e.field_label))}else r=[a.filter((e=>e.api_name===o.field.api_name))[0].field_label];else t.length>0&&e.setData("filterLabel",i.join(", "));i&&r&&e.setData("filterLabel",[...i,...r].join(", "))},validateSearchInput:()=>{const e=$L("crm-global-search-input")[0].component;let t=e.getData("searchInputText");t=t.replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi," ");for(var a=e.getData("appliedTags"),o=e.getData("searchInputText"),i=e.getData("pendingTags"),r=!1,s=i.length,l=0;l<s;l++)if(i[l].name.toLowerCase().startsWith(o))return r=!0,!0;var n=!r,p=!1,c=t.replace(/[A-Z a-z 0-9 . / ]*/,"");return Object.keys(a).forEach((function(e){if("Record_Name"===a[e].param||"Tags"===a[e].param){var t=a[e].value,o=t.replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi," ");if((o=(o=o.trim()).replace(/[A-Z a-z 0-9 . / ]*/,""))||t.trim().length>2&&0!==t.trim().length)return void(p=!0)}})),!!(o.trim().length>2&&0!==o.trim().length&&n||p||c)}}),Lyte.Component.register("crm-global-search-popup",{_template:'<template tag-name="crm-global-search-popup"> <lyte-modal id="primaryGsearch" lt-prop-show-close-button="false" lt-prop-offset="{&quot;top&quot;:&quot;0px&quot;,&quot;left&quot;:&quot;center&quot;}" lt-prop-overlay-close="{{lbind(gsOverlayPopup)}}" lt-prop-prevent-focus="true" lt-prop-transition="{&quot;animation&quot;:&quot;fadeIn&quot;,&quot;duration&quot;:&quot;0.3&quot;}" lt-prop-width="820px" lt-prop-allow-multiple="true" on-show="{{method(\'showPopup\')}}" on-resize="{{method(\'reCalculateHeight\')}}" on-close="{{method(\'closePopup\')}}"> <template is="registerYield" yield-name="modal"> <div class="globalSearchAskZiaPopup primarySearchElemWrap pR"> <crm-global-search-input can-show-input="true"></crm-global-search-input> </div> <crm-global-search-identifiers> </crm-global-search-identifiers> <template is="if" value="{{expHandlers(expHandlers(expHandlers(search_history,\'&amp;&amp;\',expHandlers(search_history.length,\'>\',0)),\'&amp;&amp;\',showSearchHistory),\'&amp;&amp;\',expHandlers(showChatbotGlobalSearch,\'!\'))}}"><template case="true"> <div class="searchHistorySection bg_white pR boxBB oH"> <div class="recentSearchRecordList"> <div class="pB10 pL20 pR20 recentSearchHistoryList crm-font-bold">{{getI18n("crm.globlal.search.search.history")}}</div> <ul class="m0 p0 oA maxHt400"> <template is="for" items="{{search_history}}" item="recentItem" index="index"> <li class="recentlyClickedRecordList cP p0"> <link-to lt-prop-route="crm.tab.module.entity" lt-prop-target="_blank" lt-prop-dp="[&quot;{{getModuleNameByApiName(recentItem.module.api_name)}}&quot;,&quot;{{recentItem.record.id}}&quot;]" lt-prop-rel="noopener noreferrer"> <div data-zcqa="recentItemsBox" class="flexAlignCenter pT10 pB10 pL20 pR20"> <lyte-text lt-prop-value="{{recentItem.record.name}}" class="crmBaseColor"> </lyte-text> <lyte-text lt-prop-value="{{getModuleDislayNameByModuleName(getModuleNameByApiName(recentItem.module.api_name),false)}}" class="crm-small-font-size crmLabelColor pL8 mT2 minW150"> </lyte-text> </div> </link-to> </li> </template> </ul> </div> </div> </template></template> </template> </lyte-modal> <lyte-event-listener event-name="windowResize" on-fire="{{method(\'reCalculateHeight\')}}"> </lyte-event-listener></template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,1,0]},{type:"attr",position:[1,1,3,1]},{type:"for",position:[1,1,3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1,1]},{type:"componentDynamic",position:[1,1,1,1]},{type:"attr",position:[1,1,1,3]},{type:"componentDynamic",position:[1,1,1,3]},{type:"componentDynamic",position:[1,1]}]}]}},default:{}}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"componentDynamic",position:[3]}],_observedAttributes:["searchStarted","showSearchHistory","isTagSearch","noTagResults","needLoading","resultFetch","isResultsEmpty","showChatbotGlobalSearch","search_history","primarySearchResults","uiConfigrations","forFieldVal","isModule","filterData","newCheckBox","tagCreation","allModulesArrayList","moduleSuggestion","moduleSuggestionIndex","moduleVsDisplayField","moduleVsAutoCompleteFields","currentSearchModule","searchText","displayLabelVsSysRefNameMap","sysRefNameVsModuleDetailsMap","gsOverlayPopup"],init:function(){Crm.client_tracking("Global Search New UI - Popup"),setTimeout(function(){var e=this.getDataFromModuleRecordMapping(),t=$L("crm-global-search-input")[0].component,a=e.allModulesArrayList,o=e.displayLabelVsSysRefNameMap,i=e.sysRefNameVsModuleDetailsMap;t.setData("allModulesArrayList",t.getData("isPrimarySearch")?a.filter((e=>"Notes"!==e.api_name)):a),this.setData("displayLabelVsSysRefNameMap",o),this.setData("sysRefNameVsModuleDetailsMap",i),this.methods.reCalculateHeight(this),this.setData("search_history",this.getSearchHistory())}.bind(this),200)},data:function(){return{searchStarted:Lyte.attr("boolean",{default:!1}),showSearchHistory:Lyte.attr("boolean",{default:!0}),isTagSearch:Lyte.attr("boolean",{default:!1}),noTagResults:Lyte.attr("boolean"),needLoading:Lyte.attr("boolean",{default:!1}),resultFetch:Lyte.attr("boolean",{default:!1}),isResultsEmpty:Lyte.attr("boolean",{default:!1}),showChatbotGlobalSearch:Lyte.attr("boolean",{default:!1}),search_history:Lyte.attr("array",{default:[]}),primarySearchResults:Lyte.attr("array",{default:[]}),uiConfigrations:Lyte.attr("object",{default:{}}),forFieldVal:Lyte.attr("array",{default:[]}),isModule:Lyte.attr("boolean",{default:!1}),filterData:Lyte.attr("array",{default:[]}),newCheckBox:Lyte.attr("array",{default:[]}),tagCreation:Lyte.attr("array",{default:[]}),allModulesArrayList:Lyte.attr("array",{default:[]}),moduleSuggestion:Lyte.attr("string",{default:""}),moduleSuggestionIndex:Lyte.attr("string",{default:""}),moduleVsDisplayField:Lyte.attr("object",{default:{Leads:"Full_Name",Tasks:"Subject",Events:"Subject",Calls:"Subject",Accounts:"Account_Name",Contacts:"Full_Name",Deals:"Deal_Name",Potentials:"Deal_Name",Campaigns:"Campaign_Name",Cases:"Subject",Solutions:"Solution_Title",Products:"Product_Name",Vendors:"Vendor_Name",PriceBooks:"Price_Book_Name",Quotes:"Subject",SalesOrders:"Subject",PurchaseOrders:"Subject",Invoices:"Subject",Visits:"Visited_Page",CustomModule:"Name"}}),moduleVsAutoCompleteFields:Lyte.attr("object",{default:{Leads:["id","Full_Name","Email","Phone"],Contacts:["id","Full_Name","Email","Phone"],Deals:["id","Deal_Name","Stage","Amount"],Accounts:["id","Account_Name","Website"],Calls:["id","Subject","Call_Start_Time"],Tasks:["id","Subject","Due_Date","Status"],Events:["id","Event_Title","Owner.name","Start_DateTime","End_DateTime"],Products:["id","Product_Name","Product_Code","Unit_Price"],Quotes:["id","Subject","Quote_Number","Quote_Stage","Grand_Total"],SalesOrders:["id","Subject","SO_Number","Grand_Total"],Invoices:["id","Subject","Invoice_Number","Status","Grand_Total"],PurchaseOrders:["id","Subject","PO_Number","Status","Grand_Total"],PriceBooks:["id","Price_Book_Name","Pricing_Model"],Cases:["id","Subject","Case_Number","Status"],Solutions:["id","Solution_Title","Solution_Number","Status"],Notes:["id","Note_Title","Note_Content","$setype"],Attachments:["id","File_Name","$semodule"],Reports:["id"],Email:["id"],Campaigns:["id"],Vendors:["id"],Documents:["id"],Desk:["id"],"Custom module":["id","Name","Email"],"Junction module":["id"]}}),currentSearchModule:Lyte.attr("string",{default:"All"}),searchText:Lyte.attr("string"),displayLabelVsSysRefNameMap:Lyte.attr("object"),sysRefNameVsModuleDetailsMap:Lyte.attr("object"),gsOverlayPopup:Lyte.attr("boolean",{default:!0})}},methods:{showPopup:function(){var e=$L("crm-global-search-input")[0];e.setData("popupComponent",this),this.methods.reCalculateHeight(this),e.component.actions.triggerSearchFocus(e.component)},reCalculateHeight:function(){var e=$L("crm-global-search-identifiers")[0],t=window.innerHeight/100*75,a=$L(".primarySearchElemWrap"),o=t-(a.offset().top+a.height());e.component.setData("searchResultHeight",o)},closePopup:function(){$L(".gsLeastChar").hide(),$L(".askZiaSearchAnimationCase").width("auto");var e=$L("crm-global-search-input")[0].component;$L("#primaryGsearch")[0].ltProp("show",!1);$L("crm-global-search-popup")[0].component.setData({resultFetch:!1,search_history:[]}),e.methods.closePopup()}}},{mixins:["crm-global-search-mixin"]}),Lyte.Component.register("crm-global-search-history",{_template:'<template tag-name="crm-global-search-history"> <crm-global-search-input can-show-input="false"> </crm-global-search-input> <template is="if" value="{{expHandlers(isSecondaryPageOpen,\'!\')}}"><template case="true"><crm-global-search-identifiers> </crm-global-search-identifiers></template></template> <template is="if" value="{{expHandlers(expHandlers(canShow,\'&amp;&amp;\',expHandlers(search_history.length,\'>\',0)),\'&amp;&amp;\',expHandlers(isSecondaryPageOpen,\'!\'))}}"><template case="true"> <div class="searchHistorySection bg_white pR boxBB oH"> <div class="recentSearchRecordList"> <div class="pB10 pL20 pR20 recentSearchHistoryList crm-font-bold">{{getI18n("crm.globlal.search.search.history")}}</div> <ul class="m0 p0 oA maxHt400"> <template is="for" items="{{search_history}}" item="recentItem" index="index"> <li class="recentlyClickedRecordList cP p0"> <link-to lt-prop-route="crm.tab.module.entity" lt-prop-target="_blank" lt-prop-dp="[&quot;{{getModuleNameByApiName(recentItem.module.api_name)}}&quot;,&quot;{{recentItem.record.id}}&quot;]" lt-prop-rel="noopener noreferrer"> <div data-zcqa="recentItemsBox" class="flexAlignCenter pT10 pB10 pL20 pR20"> <lyte-text lt-prop-value="{{recentItem.record.name}}" class="crmBaseColor"> </lyte-text> <lyte-text lt-prop-value="{{getModuleDislayNameByModuleName(getModuleNameByApiName(recentItem.module.api_name),false)}}" class="crm-small-font-size crmLabelColor pL8 mT2 minW150"> </lyte-text> </div> </link-to> </li> </template> </ul> </div> </div> </template></template> </template>',_dynamicNodes:[{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[0]}]}},default:{}},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,1,0]},{type:"attr",position:[1,1,3,1]},{type:"for",position:[1,1,3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1,1]},{type:"componentDynamic",position:[1,1,1,1]},{type:"attr",position:[1,1,1,3]},{type:"componentDynamic",position:[1,1,1,3]},{type:"componentDynamic",position:[1,1]}]}]}},default:{}}],_observedAttributes:["search_history","canShow","isSecondaryPageOpen"],data:function(){return{search_history:Lyte.attr("array",{default:[]}),canShow:Lyte.attr("boolean",{default:!0}),isSecondaryPageOpen:Lyte.attr("boolean",{default:!1})}}}),Lyte.Component.register("crm-global-search-identifiers",{_template:'<template tag-name="crm-global-search-identifiers"> <div class="searchResultsWrap bg_white"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(searchStarted,\'||\',expHandlers(primarySearchResults.length,\'>\',0)),\'||\',showChatbotGlobalSearch),\'||\',showSecondaryTagGlobalSearch)}}"><template case="true"> <template is="if" value="{{isTagSuggestionNeeded}}"><template case="true"> <div class="tagSuggestions bg_white pA mL10"> <ul class="m0 pT5 pL0"> <template is="for" items="{{pendingTags}}" item="tags" index="tagIndex"> <li class="tagSearchResults cP crmBaseColor" id="tagSearchResults_{{tagIndex}}" data-tag-index="{{tagIndex}}" data-array-index="{{tags.indexVal}}" data-tag-value="{{tags.name}}" onclick="{{action(\'appendThisIdentifier\',this)}}" onmouseover="{{action(\'addHoverState\',this)}}">{{tags.display_label}}</li> </template> </ul> </div> </template></template><template is="if" value="{{expHandlers(expHandlers(isSecondaryResults,\'!\'),\'||\',showChatbotGlobalSearch)}}"><template case="true"> <div class="primarySearchResult oA" style="max-height: {{searchResultHeight}}px" onscroll="{{action(\'checkForScroll\')}}"> <template is="if" value="{{showChatbotGlobalSearch}}"><template case="true"> <crm-chatbot-global-search-list recently-searched-suggestions="{{recentlySearchedSuggestions}}" search-suggestions="{{searchSuggestions}}" search-result-height="{{searchResultHeight}}" all-search-suggestions="{{allSearchSuggestions}}"></crm-chatbot-global-search-list> </template><template case="false"> <ul class="p0 m0"> <template is="for" items="{{primarySearchResults}}" item="moduleWiseResult" index="index"> <li data-zcqa="primarySearchRecords" class="moduleSearchList p0 m0"><template is="forIn" object="{{moduleWiseResult}}" value="moduleRecordsArray" key="moduleName"> <div class="resultModuleHead flexAlignCenter pT10 pL20 pR20 pB6 bg_white t0 zi1"> <div class="dIF aiCenter jcCenter searchResultsIconWraps w35 h35 br50per boxBB aligncenter {{concat(\'crmModuleIconFor\',iconsModuleName(moduleName,true))}}"> <crmutil-icon icon-name="{{iconsModuleName(moduleName,true)}}" icon-class="{{concat(\'crmBaseIcon zcicn-\',iconsModuleName(moduleName,true))}}"></crmutil-icon> </div> <div class="pL12 crm-font-bold">{{getModuleDislayNameByModuleName(moduleName,false)}}</div> </div> <ul class="moduleSearchListWrap p0 m0"> <template is="forIn" object="{{moduleRecordsArray}}" value="recordDetails" key="index1"> <template is="switch" value="{{expHandlers(recordDetails.$setype,\'||\',moduleName)}}"><template case="Leads"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"> <link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor cP dB" lt-prop-route="crm.tab.module.entity" onclick="{{action(\'closePopup\')}}" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Full_Name}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 flexAlignCenter crmLabelColor"> <template is="if" value="{{expHandlers(recordDetails.Email,\'&amp;&amp;\',expHandlers(recordDetails.Email,\'!==\',null))}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Email}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Phone,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Phone,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Phone}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Email,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> <div class="quickActions dF mL15"> <div data-zcqa="leadsEmailBtn" class="quickActionForMail flexAlignCenter jcCenter cP br50per mR10 pR" onclick="{{action(\'entSendMail\',expHandlers(recordDetails.$setype,\'||\',moduleName),recordDetails.id)}}"> <crmutil-icon icon-name="mail-envolope" icon-class="zcicn-mail-envolope zcicn_blue gsMailIcon" class="mT2"></crmutil-icon> </div> <div data-zcqa="leadsPhnBtn" id="phoneIconFromSearch_{{recordDetails.id}}" class="quickActionForCall cP br50per pR flexAlignCenter jcCenter" onclick="{{action(\'getPhoneIcon\',this,recordDetails,moduleName)}}" onmouseover="{{action(\'setPhoneMenuId\',this,recordDetails)}}"> <span class="zcicncss-calls zcicn-cssIcons zcicn_blue_mask gsCallIcon"></span> </div> </div></li> </template><template case="Contacts"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" lt-prop-route="crm.tab.module.entity" onclick="{{action(\'closePopup\')}}" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Full_Name}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 flexAlignCenter crmLabelColor"> <template is="if" value="{{expHandlers(recordDetails.Email,\'&amp;&amp;\',expHandlers(recordDetails.Email,\'!==\',null))}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Email}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Phone,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Phone,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Phone}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Email,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> <div class="quickActions dF mL15"> <div data-zcqa="contactsEmailBtn" class="quickActionForMail cP br50per mR10 pR flexAlignCenter jcCenter" onclick="{{action(\'entSendMail\',expHandlers(recordDetails.$setype,\'||\',moduleName),recordDetails.id)}}"> <crmutil-icon icon-name="mail-envolope" icon-class="zcicn-mail-envolope zcicn_blue gsMailIcon" class="mT2"></crmutil-icon> </div> <div data-zcqa="contactsPhnBtn" id="phoneIconFromSearch_{{recordDetails.id}}" class="quickActionForCall cP br50per pR flexAlignCenter jcCenter" onclick="{{action(\'getPhoneIcon\',this,recordDetails,moduleName)}}" onmouseover="{{action(\'setPhoneMenuId\',this,recordDetails)}}"> <span class="zcicncss-calls zcicn-cssIcons zcicn_blue_mask gsCallIcon"></span> </div> </div></li> </template><template case="Deals"></template><template case="Potentials"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor cP dB" lt-prop-route="crm.tab.module.entity" onclick="{{action(\'closePopup\')}}" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Deal_Name}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="crmLabelColor pT2 flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Stage,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Stage}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Amount,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Amount,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Amount}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Stage,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> <div class="quickActions dF mL15"> <div data-zcqa="dealsEmailBtn" class="quickActionForMail flexAlignCenter jcCenter cP br50per mR10 pR" onclick="{{action(\'entSendMail\',expHandlers(recordDetails.$setype,\'||\',moduleName),recordDetails.id)}}"> <crmutil-icon icon-name="mail-envolope" icon-class="zcicn-mail-envolope zcicn_blue gsMailIcon" class="mT2"></crmutil-icon> </div> <div data-zcqa="dealsPhnBtn" id="phoneIconFromSearch_{{recordDetails.id}}" class="quickActionForCall cP br50per pR flexAlignCenter jcCenter" onclick="{{action(\'getPhoneIcon\',this,recordDetails,moduleName)}}" onmouseover="{{action(\'setPhoneMenuId\',this,recordDetails)}}"> <span class="zcicncss-calls zcicn-cssIcons zcicn_blue_mask gsCallIcon"></span> </div> </div> </li> </template><template case="Accounts"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor cP dB" lt-prop-route="crm.tab.module.entity" onclick="{{action(\'closePopup\')}}" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Account_Name}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="crmLabelColor pT2"> <template is="if" value="{{expHandlers(recordDetails.Website,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Website}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Phone,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Phone}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR"> </lyte-text> </template></template> </div> </link-to> <div class="quickActions dF mL15"> <div data-zcqa="accsEmailBtn" class="quickActionForMail flexAlignCenter jcCenter cP br50per mR10 pR" onclick="{{action(\'entSendMail\',expHandlers(recordDetails.$setype,\'||\',moduleName),recordDetails.id)}}"> <crmutil-icon icon-name="mail-envolope" icon-class="zcicn-mail-envolope zcicn_blue gsMailIcon" class="mT2"></crmutil-icon> </div> <div data-zcqa="accsPhnBtn" id="phoneIconFromSearch_{{recordDetails.id}}" class="quickActionForCall cP br50per pR flexAlignCenter jcCenter" onclick="{{action(\'getPhoneIcon\',this,recordDetails,moduleName)}}" onmouseover="{{action(\'setPhoneMenuId\',this,recordDetails)}}"> <span class="zcicncss-calls zcicn-cssIcons zcicn_blue_mask gsCallIcon"></span> </div> </div> </li> </template><template case="Tasks"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class=" crmBaseColor dB cP" lt-prop-route="crm.tab.module.entity" onclick="{{action(\'closePopup\')}}" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Subject}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="crmLabelColor pT2 flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Due_Date,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{getDateInUserPatternFromTimeStamp(recordDetails.Due_Date,undefined,true)}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Status,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Status,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Status}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Due_Date,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="Products"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" lt-prop-route="crm.tab.module.entity" onclick="{{action(\'closePopup\')}}" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Product_Name}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Product_Code,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Product_Code}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Unit_Price,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Unit_Price,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Unit_Price}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Product_Code,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="Quotes"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" lt-prop-route="crm.tab.module.entity" onclick="{{action(\'closePopup\')}}" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Subject}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Quote_Number,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Quote_Number}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Quote_Stage,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Quote_Stage,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Quote_Stage}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Quote_Number,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="SalesOrders"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" lt-prop-route="crm.tab.module.entity" onclick="{{action(\'closePopup\')}}" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Subject}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.SO_Number,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.SO_Number}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.SO_Number,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Grand_Total,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Grand_Total}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Grand_Total,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="Invoices"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" lt-prop-route="crm.tab.module.entity" onclick="{{action(\'closePopup\')}}" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Subject}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Status,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Status}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Grand_Total,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Grand_Total,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Grand_Total}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Status,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="PurchaseOrders"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" lt-prop-route="crm.tab.module.entity" onclick="{{action(\'closePopup\')}}" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Subject}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Status,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Status}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Grand_Total,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Grand_Total,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Grand_Total}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Status,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="PriceBooks"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" onclick="{{action(\'closePopup\')}}" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Price_Book_Name}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor"> <template is="if" value="{{recordDetails.Pricing_Model}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Pricing_Model}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="Cases"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class=" crmBaseColor dB cP" onclick="{{action(\'closePopup\')}}" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Subject}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Status,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Status}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Case_Number,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Case_Number,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Case_Number}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Status,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="Solutions"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" onclick="{{action(\'closePopup\')}}" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Solution_Title}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Status,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Status}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Solution_Number,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Solution_Number,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Solution_Number}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Status,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="Notes"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class=" crmBaseColor dB cP" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Note_Title}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Note_Content,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Note_Content}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.$se_module,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.$se_module,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.$se_module}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Note_Content,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to></li> </template><template case="Vendors"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class=" crmBaseColor dB cP" onclick="{{action(\'closePopup\')}}" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Vendor_Name}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Email,\'&amp;&amp;\',expHandlers(recordDetails.Email,\'!==\',null))}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Email}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Phone,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Phone,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Phone}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Email,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> <div class="quickActions dF mL15"> <div data-zcqa="vendorsEmailBtn" class="quickActionForMail flexAlignCenter jcCenter cP br50per mR10 pR" onclick="{{action(\'entSendMail\',expHandlers(recordDetails.$setype,\'||\',moduleName),recordDetails.id)}}"> <crmutil-icon icon-name="mail-envolope" icon-class="zcicn-mail-envolope zcicn_blue gsMailIcon" class="mT2"></crmutil-icon> </div> <div data-zcqa="vendorsPhnBtn" id="phoneIconFromSearch_{{recordDetails.id}}" class="quickActionForCall cP br50per pR flexAlignCenter jcCenter" onclick="{{action(\'getPhoneIcon\',this,recordDetails,moduleName)}}" onmouseover="{{action(\'setPhoneMenuId\',this,recordDetails)}}"> <span class="zcicncss-calls zcicn-cssIcons zcicn_blue_mask gsCallIcon"></span> </div> </div> </li> </template><template case="Campaigns"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class=" crmBaseColor dB cP" onclick="{{action(\'closePopup\')}}" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Campaign_Name}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Start_Date,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{getDateInUserPatternFromTimeStamp(recordDetails.Start_Date,undefined,true)}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.End_Date,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.End_Date,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{getDateInUserPatternFromTimeStamp(recordDetails.End_Date,undefined,true)}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Start_Date,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="Services"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" onclick="{{action(\'closePopup\')}}" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Service_Name}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Duration,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{convertMinutesToHoursAndMinutes(recordDetails.Duration)}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Price,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Price,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Price}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Duration,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="Appointments"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" onclick="{{action(\'closePopup\')}}" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Appointment_Name}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Appointment_Start_Time,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{getDateTimeInUserPatternFromTimeStamp(recordDetails.Appointment_Start_Time)}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Price,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.Price,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Price}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Appointment_Start_Time,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="Events"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" onclick="{{action(\'closePopup\')}}" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Event_Title}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor"> <template is="if" value="{{expHandlers(expHandlers(recordDetails.Owner,\'!==\',null),\'&amp;&amp;\',recordDetails.Owner)}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Owner}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(recordDetails.EVENTSTARTDATETIME,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{getDateTimeInUserPatternFromTimeStamp(recordDetails.EVENTSTARTDATETIME)}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="Calls"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" onclick="{{action(\'closePopup\')}}" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Subject}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="pT2 crmLabelColor"> <template is="if" value="{{expHandlers(recordDetails.Call_Start_Time,\'!==\',null)}}"><template case="true"> <lyte-text lt-prop-value="{{getDateTimeInUserPatternFromTimeStamp(recordDetails.Call_Start_Time)}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB"> </lyte-text> </template></template> </div> </link-to> </li> </template><template case="Attachments"> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.File_Name}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="crmLabelColor pT2"> <lyte-text lt-prop-value="{{recordDetails.$se_module}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB"> </lyte-text> </div> </link-to></li> </template><template default=""> <li class="searchResultList flexAlignCenter m0 pT6 pB5 pL20 pR20"><link-to class="cgsResultLink fg1" lt-prop-class="crmBaseColor dB cP" onclick="{{action(\'closePopup\')}}" lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;{{moduleName}}&quot;,&quot;{{recordDetails.id}}&quot;]" lt-prop-qp="{&quot;pfrom&quot; : &quot;gsearch&quot;}"> <lyte-text lt-prop-value="{{recordDetails.Name}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }"> </lyte-text> <div class="crmLabelColor pT2 flexAlignCenter"> <template is="if" value="{{expHandlers(recordDetails.Email,\'&amp;&amp;\',expHandlers(recordDetails.Email,\'!==\',null))}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Email}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(expHandlers(recordDetails.Phone,\'!==\',undefined),\'&amp;&amp;\',expHandlers(recordDetails.Phone,\'!==\',null)),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> <template is="if" value="{{expHandlers(expHandlers(recordDetails.Phone,\'!==\',undefined),\'&amp;&amp;\',expHandlers(recordDetails.Phone,\'!==\',null))}}"><template case="true"> <lyte-text lt-prop-value="{{recordDetails.Phone}}" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottom&quot; }" class="searchResultSecDetails pR dIB {{if(expHandlers(recordDetails.Email,\'!==\',null),\'maxW50per\',\'\')}}"> </lyte-text> </template></template> </div> </link-to> <template is="if" value="{{expHandlers(expHandlers(expHandlers(recordDetails.$setype,\'<\',&quot;CustomModule5001&quot;),\'||\',expHandlers(recordDetails.$setype,\'>\',&quot;CustomModule5015&quot;)),\'&amp;&amp;\',expHandlers(recordDetails.$setype,\'!==\',&quot;Zoho Expense&quot;))}}"><template case="true"> <div class="quickActions dF mL15"> <div data-zcqa="customEmailBtn" class="quickActionForMail flexAlignCenter jcCenter cP br50per mR10 pR" onclick="{{action(\'entSendMail\',expHandlers(recordDetails.$setype,\'||\',moduleName),recordDetails.id)}}"> <crmutil-icon icon-name="mail-envolope" icon-class="zcicn-mail-envolope zcicn_blue gsMailIcon" class="mT2"></crmutil-icon> </div> <div data-zcqa="customPhnBtn" id="phoneIconFromSearch_{{recordDetails.id}}" class="quickActionForCall flexAlignCenter jcCenter cP br50per pR" onclick="{{action(\'getPhoneIcon\',this,recordDetails,moduleName)}}" onmouseover="{{action(\'setPhoneMenuId\',this,recordDetails)}}"> <span class="zcicncss-calls zcicn-cssIcons zcicn_blue_mask gsCallIcon"></span> </div> </div> </template></template> </li> </template></template></template> </ul> </template> </li> </template> <template is="if" value="{{expHandlers(searchStarted,\'&amp;&amp;\',isResultsEmpty)}}"><template case="true"> <li class="noResultsFoundGlobalSearch p0 m0 flexAlignCenter fdColumn"> <div class="noResultsFoundIllustration"></div> <div class="pT10 crmNotFoundColor">{{getI18n(\'crm.global.search.no.results.found\')}}</div> </li> </template></template> </ul> </template></template> </div> <template is="if" value="{{expHandlers(expHandlers(expHandlers(showResultsTrigger,\'&amp;&amp;\',expHandlers(primarySearchResults.length,\'>\',0)),\'&amp;&amp;\',expHandlers(showChatbotGlobalSearch,\'!\')),\'||\',isResultsEmpty)}}"><template case="true"> <div data-zcqa="advanceBtnSearch" class="cgsViewAdvSearch pR pT10 pB11 {{if(cgsFooterShadow,\'cgsBxSh\',\'\')}}"> <span class="crmLinkColor cP accessibility-route-elem" onclick="{{action(\'changeSearchScreen\')}}">{{getI18n(\'crm.global.search.view.advanced.search\')}}</span> </div> </template></template> </template></template> </template></template> <lyte-menu data-zcqa="phnNoClickBtn" id="phoneIconForSearch" lt-prop-wrapper-class="cgsPhoneMenu" on-before-open="{{method(\'beforeOpenMenu\')}}" on-open="{{method(\'gsOpenMenu\')}}" on-close="{{method(\'closeBefore\')}}" on-menu-click="{{method(\'clickMenu\')}}" lt-prop-content="[]" lt-prop-user-value="label" lt-prop-description="description" lt-prop-freeze="true" lt-prop-event="click" lt-prop-query="#phoneIconFromSearch" lt-prop-width="300px" lt-prop-height="auto" lt-prop-aria-attributes="{&quot;role&quot;:&quot;menu&quot;}" lt-prop-query-class="activeGsPhoneIconSearch"></lyte-menu> </div> </template>',_dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}]}},default:{}},{type:"attr",position:[2]},{type:"if",position:[2],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'max-height: '","searchResultHeight","'px'"]}}}},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1,0]},{type:"forIn",position:[1,0],dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"text",position:[1,3,0]},{type:"attr",position:[3,1]},{type:"forIn",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{Leads:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,1,3,1]},{type:"if",position:[1,1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,1,3,3]},{type:"if",position:[1,1,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"componentDynamic",position:[1,3,1,1]},{type:"attr",position:[1,3,3]}]},Contacts:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]},{type:"attr",position:[1,2,1]},{type:"componentDynamic",position:[1,2,1,1]},{type:"attr",position:[1,2,3]}]},Deals:{dynamicNodes:[],additional:{next:"Potentials"}},Potentials:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]},{type:"attr",position:[1,2,1]},{type:"componentDynamic",position:[1,2,1,1]},{type:"attr",position:[1,2,3]}]},Accounts:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]},{type:"attr",position:[1,2,1]},{type:"componentDynamic",position:[1,2,1,1]},{type:"attr",position:[1,2,3]}]},Tasks:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},Products:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},Quotes:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},SalesOrders:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},Invoices:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},PurchaseOrders:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},PriceBooks:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},Cases:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},Solutions:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},Notes:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},Vendors:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]},{type:"attr",position:[1,2,1]},{type:"componentDynamic",position:[1,2,1,1]},{type:"attr",position:[1,2,3]}]},Campaigns:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},Services:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},Appointments:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},Events:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},Calls:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]}]},Attachments:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"componentDynamic",position:[1,0,3,1]},{type:"componentDynamic",position:[1,0]}]}},default:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"attr",position:[1,0,1]},{type:"componentDynamic",position:[1,0,1]},{type:"attr",position:[1,0,3,1]},{type:"if",position:[1,0,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,0,3,3]},{type:"if",position:[1,0,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,0]},{type:"attr",position:[1,2]},{type:"if",position:[1,2],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,3]}]}},default:{}}]}}]}]}]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,3,0]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}],_observedAttributes:["primarySearchResults","pendingTags","noTagResults","isSecondaryResults","isTagSearch","isTagSuggestionNeeded","showResultsTrigger","cgsFooterShadow","searchStarted","isResultsEmpty","searchResultHeight","recordId","uiConfigrations","alert","sysRefNameVsModuleDetailsMap","showSecondaryTagGlobalSearch","showChatbotGlobalSearch","recentlySearchedSuggestions","searchSuggestions","allSearchSuggestions","fieldModuleMapping","phoneModuleName","phoneFullName","menuContent","canShowMenu","crmPlusValue","fieldApiNameLabelMapping","isSecondaryPageOpen"],data:function(){return{primarySearchResults:Lyte.attr("array",{default:[]}),pendingTags:Lyte.attr("array",{default:[]}),noTagResults:Lyte.attr("boolean"),isSecondaryResults:Lyte.attr("boolean",{default:!1}),isTagSearch:Lyte.attr("boolean",{default:!1}),isTagSuggestionNeeded:Lyte.attr("boolean",{default:!1}),showResultsTrigger:Lyte.attr("boolean",{default:!1}),cgsFooterShadow:Lyte.attr("boolean",{default:!1}),searchStarted:Lyte.attr("boolean",{default:!1}),isResultsEmpty:Lyte.attr("boolean",{default:!1}),searchResultHeight:Lyte.attr("number",{default:0}),recordId:Lyte.attr("string",{default:""}),uiConfigrations:Lyte.attr("object",{default:{}}),alert:Lyte.attr("object",{default:{enabled:!1,type:"info"}}),sysRefNameVsModuleDetailsMap:Lyte.attr("object",{default:{}}),showSecondaryTagGlobalSearch:Lyte.attr("boolean",{default:!1}),showChatbotGlobalSearch:Lyte.attr("boolean",{default:!1}),recentlySearchedSuggestions:Lyte.attr("array",{default:[]}),searchSuggestions:Lyte.attr("array",{default:[]}),allSearchSuggestions:Lyte.attr("array",{default:[]}),fieldModuleMapping:Lyte.attr("object",{default:{}}),phoneModuleName:Lyte.attr("string",{default:""}),phoneFullName:Lyte.attr("string",{default:""}),menuContent:Lyte.attr("array",{default:[]}),canShowMenu:Lyte.attr("boolean",{default:!1}),crmPlusValue:Lyte.attr("string",{default:""}),fieldApiNameLabelMapping:Lyte.attr("object",{default:[]}),isSecondaryPageOpen:Lyte.attr("boolean",{default:!1})}},init:function(){networkUtils.loadFeatureScripts(["zohocrm_phonebridge_notifier.js"]),setTimeout(function(){var e=$L("crm-global-search-input")[0].component;this.setData("pendingTags",e.getData("pendingTags")),e.setData("identifierComponent",this),this.setData("sysRefNameVsModuleDetailsMap",e.getData("sysRefNameVsModuleDetailsMap")),$L(".searchInputBox").focus()}.bind(this),500)},actions:{checkForScroll:function(){var e=$L(".primarySearchResult");Math.ceil(e[0].offsetHeight+e.scrollTop())>=e[0].scrollHeight?this.setData("cgsFooterShadow",!1):this.setData("cgsFooterShadow",!0)},closePopup:function(){var e=$L("#primaryGsearch")[0];e&&e.ltProp("show",!1)},changeSearchScreen:function(){var e,t=!1,a=$L("crm-global-search-input")[0].component,o=$L("crm-global-search-identifiers")[0];"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()?(e=o.component.getData("crmPlusValue"),a.setData("searchInputText",e),CrmPlusImpl.search.hideAutoSuggestView(),CrmPlusLib.onClickOnFreezeLayer()):(e=a.getData("searchInputText"),t=a.getData("appliedTags").length>0);var i=e.replace(/[`~!@#$%^&*()_|+\-=?;:'",<>\{\}\[\]\\\/]/gi," ");(i=(i=i.trim()).replace(/[A-Z a-z 0-9 . / ]*/,""))||e.trim().length>2||t?o.component.renderSecondaryResults(e):(_cruxUtils.showCustomAlert({params:{ltPropSecondaryMessage:"Please enter more than 3 character to search"}}),"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()&&CRMPlusCommonUi.search.onClose())},addHoverState:function(e){$L(".inHoverState").removeClass("inHoverState"),$L(e).addClass("inHoverState")},appendThisIdentifier:function(e){var t=$L("crm-global-search-input")[0].component;t.actions.selectThisTag(e),t.setData("isTagJustSelected",!1)},entSendMail:function(e,t){"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()||$L("#primaryGsearch")[0].ltProp("overlayClose",!1),EntSendMail(e,t,"listview",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,(function(){"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()?(CrmPlusImpl.search.hideAutoSuggestView(),CrmPlusLib.onClickOnFreezeLayer()):($L("crm-global-search-popup")[0].component.methods.closePopup(),$L("#primaryGsearch")[0].ltProp("overlayClose",!0))}))},setPhoneMenuId:function(e,t){$L("#phoneIconForSearch")[0].component.data.ltPropQuery="#phoneIconFromSearch".concat("_").concat(t.id)},getPhoneIcon:function(e,t,a){var o=$L("crm-global-search-identifiers")[0].component;"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()||$L("#primaryGsearch")[0].ltProp("overlayClose",!1),o.setData("phoneModuleName",a),o.setData("recordId",t.id),o.setData("phoneFullName",t.fullname)}},methods:{beforeOpenMenu:function(e){var t=$L("crm-global-search-identifiers")[0].component;if(t.getData("canShowMenu"))return t.setData("canShowMenu",!1),!0;var a=t.getData("fieldModuleMapping").moduleName,o=t.getData("phoneModuleName"),i=t.getData("recordId");if(!a&&i){var r={module:moduleApiMapping[o],type:"all",filters:'{"comparator": "equal","field": {"api_name": "ui_type"},"value": 33}'},s=store.findAll("field",r,!0,!0,{apiVersion:"2.2"});Lyte.resolvePromises(s).then((function(a){if(void 0===a)return"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()||$L("#primaryGsearch")[0].ltProp("overlayClose",!1),void _cruxUtils.showCustomAlert({params:{ltPropWrapperClass:"cgsPhoneAlertWrapper",ltPropPrimaryMessage:I18n.getMsg("crm.no.phone.available")},close:function(){"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()||$L("#primaryGsearch")[0].ltProp("overlayClose",!0)}});for(var i,r=a.length,s=[],l=0;l<r;l++)i=i?i+","+a[l].api_name:a[l].api_name,s[a[l].api_name]=a[l].display_label;i=i?i+",Data_Processing_Basis_Details":"Data_Processing_Basis_Details",t.data.fieldApiNameLabelMapping=s;var n=t.getData("fieldModuleMapping");n[o]=i,t.setData("fieldModuleMapping",n),store.model[moduleRecordMapping[o].id]||store.registerModel(moduleRecordMapping[o].id,{},{extends:"entity"});var p=store.findRecord(moduleRecordMapping[o].id,t.getData("recordId"),{approved:"both",converted:"both",fields:i});Lyte.resolvePromises(p).then((function(t){for(var a=$L("crm-global-search-identifiers")[0].component,i=a.getData("fieldModuleMapping")[o],r=a.getData("fieldApiNameLabelMapping"),s=i.split(","),l=s.length,n=[],p=0;p<l;p++){if("Data_Processing_Basis_Details"===s[p]){var c=t[0][s[p]];if(c){if(!c.Contact_Through_Phone)return _cruxUtils.showCustomAlert({params:{cxPropAllowMultiple:!0,ltPropPrimaryMessage:I18n.getMsg("crm.global.search.no.consent.phone.found")},close:function(){"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()||$L("#primaryGsearch")[0].ltProp("overlayClose",!0)}}),!1;continue}}var d={label:r[s[p]],description:t[0][s[p]]};t[0][s[p]]&&n.push(d)}n.length>0?(e.ltProp("content",n),a.setData("canShowMenu",!0),e.ltProp("show",!0)):("undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()||$L("#primaryGsearch")[0].ltProp("overlayClose",!1),_cruxUtils.showCustomAlert({params:{ltPropWrapperClass:"cgsPhoneAlertWrapper",ltPropPrimaryMessage:I18n.getMsg("crm.no.phone.available")},close:function(){"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()||$L("#primaryGsearch")[0].ltProp("overlayClose",!0)}}))}))}))}return!1},gsOpenMenu:function(){$L(".activeGsPhoneIconSearch").closest(".searchResultList").addClass("activeSearchResultList")},closeBefore:function(){"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()||$L("#primaryGsearch")[0].ltProp("overlayClose",!0),$L(".activeSearchResultList").removeClass("activeSearchResultList");var e=$L("lyte-menu#phoneIconForSearch")[0];e.setData("ltPropShow",!1),e.setData("ltPropContent",[])},clickMenu:function(e){var t=$L("crm-global-search-identifiers")[0].component,a=t.data;Crm.userDetails.TELEPHONY_ENABLED?(sE(),ctiApiNotifier.click2Call(e.description,Crm.userDetails.ZGID,Crm.userDetails.USER_ID,a.recordId,"",a.phoneModuleName,""),t.close()):Crm.userDetails.ZPBENABLED&&window.ZPB&&ZPB.clickToDial.isEnabled()?crmCallsNew.initiateCallViaZPB(e.description,a.recordId,a.phoneModuleName,"",""):Utils.windowLocationHref("tel:"+e.description),"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()?(CrmPlusImpl.search.hideAutoSuggestView(),CrmPlusLib.onClickOnFreezeLayer()):$L("crm-global-search-popup")[0].component.methods.closePopup()}}},{mixins:["crm-global-search-mixin"]}),Lyte.Component.register("crm-global-search-refine",{_template:'<template tag-name="crm-global-search-refine"> <div class="cgsRfContainer {{if(isNextGenUIEnabled,\'cgsRfContainerNxtGen\',\'\')}} {{if(iscrmPlus,\'gsInCrmPlus\',\'\')}}"> <div class="cgsRfSearchCont flexAlignCenter spaceBetween pT8 pB8 pL20 pR15"> <div class="flexAlignCenter w70_per"> <div class="crm-medium-large-font-size crmWhiteColor">{{getI18n(\'Search\')}}</div> <div class="secondarySearchInputWrap br5 mL30 bg_white pR fg1 zi1"> <crm-global-search-input can-show-input="true" is-tags-enabled="{{isTagsEnabled}}" applied-tags="{{appliedTags}}" tag-name-vs-value="{{tagNameVsValue}}" selected-module="{{selectedModule}}" is-primary-search="{{isPrimarySearch}}"></crm-global-search-input> <crm-global-search-identifiers class="w0 dB" is-secondary-results="{{isSecondaryResults}}"></crm-global-search-identifiers> </div> </div> <div data-zcqa="closeSecSearch" class="w30 h30 br50per cP secondarySearchClear flexAlignCenter jcCenter" onclick="{{action(\'closeSecondarySearch\')}}"> <span class="zcicncss-lg-close zcicn-cssIcons {{if(isNextGenUIEnabled,\'\',\'zcicn_white_mask\')}}"></span> </div> </div> <div class="cgsRfSecCont pT6 pL15 boxBB"> <div class="dF pR15 cgsRfFilterDetailsWrap"> <div data-zcqa="filterToggleIcon" class="flexAlignCenter jcCenter w40 h30 br6 br_border1 bg_white cP pR fShrink0 cgsRffilterIcon {{if(refineFilterOpened,\'cgsRffilterActive\',\'\')}}" onclick="{{action(\'gsToggleFilter\')}}"> <span class="zcicncss-filter zcicn-cssIcons"></span> <template is="if" value="{{expHandlers(expHandlers(refineFilterOpened,\'!\'),\'&amp;&amp;\',isFilterApplied)}}"><template case="true"> <span class=" w14 h14 br50per boxBB br_white cgsRfFilterNotify pA top_5 right_5"></span> </template></template> </div> <template is="if" value="{{isFilterApplied}}"><template case="true"> <div class="mL16 mT2"> <span class="mR5">{{getI18n(\'crm.component.filter.filterby\')}}</span> <span class="crm-font-bold mR10 lh24 wbBreakWord" data-zcqa="filterLabel">{{filterLabel}}</span> <template is="if" value="{{expHandlers(isFilterDirty,\'!\')}}"><template case="true"> <lyte-button data-zcqa="refineFilterClearBtn" class="mR0" lt-prop-appearance="primary" lt-prop-class="outlineprimary" lt-prop-size="small" onclick="{{action(\'clearCommonFilter\',this)}}"> <template is="registerYield" yield-name="text">{{getI18n(\'crm.report.clear.filter\')}}</template> </lyte-button> </template></template> </div> </template></template> <div class="csgRfSortDdWrap flexAlignCenter jcFlextEnd fg1 fShrink0 mT3 mL5"> <span class="mR7">{{getI18n("crm.global.search.sort.by")}}</span> <crux-dropdown data-zcqa="sortDropdown" class="crmSmallDropdown" cx-prop-type="single" cx-prop-user-value="value" cx-prop-system-value="name" cx-prop-selected="{{selectedSort}}" cx-prop-options="{{sortOptions}}" on-option-select="{{method(\'handleOnSortSelect\')}}"></crux-dropdown> </div> </div> <div class="dF mT5" style="height:{{cgsSecContainerHeight}}"> <div class="bg_white br12 pT15 pR br_border3 cgsRfFliterContainer dF flexDC spaceBetween fShrink0 mB20 {{if(refineFilterOpened,\'w300 mR20 op10\',\'w0 oH wsNowrap cgsRfFilterInTransition op0\')}} {{if(refineFilterTransitionEnded,\'\',\'oH cgsRfFilterClosed\')}}"> <div class="cgsRfFilterSection w300 {{if(refineFilterOpened,\'oA\',\'oH\')}}"> <div class="pL20 pR20 crm-font-bold">{{getI18n(\'crm.global.search.modules\')}}</div> <div class="cgsRfModuleFilterWrap pT10 pB10 pL15 pR15 pR"> <crux-column-list data-zcqa="secModList" class="moduleFilterList" cx-prop-max-height="{{cgsModuleListHeight}}" cx-prop-trim-search="false" cx-prop-drag-zcqa-prefix="secModListMenu_" cxpropsearchzcqa="secModListSearch" cx-prop-id="refineModuleFilter" cx-prop-fields="{{moduleFilterList}}" cx-prop-selected-fields="{{filteredModules}}" cx-prop-disable-sortable="true" cx-prop-search-empty-message="{{getI18n(\'crm.global.search.no.modules.found\')}}" on-check-box-checked="{{method(\'filterThisModule\')}}" on-check-box-un-checked="{{method(\'filterThisModule\')}}" cx-prop-prevent-reordering="true"> </crux-column-list> </div> <div class="cgsRfFieldFilterWrap pT15 pB7 pR"> <span class="crm-font-bold pB10 pL20 pR20 dIB">{{getI18n(\'crm.filter.header.secton.fields\')}}</span> <crux-smart-filter data-zcqa="refineFilterComp" id="refineFilter" cx-prop-fields="{{smartFilterFields}}" cx-prop-is-module-fields="false" cx-prop-search-label="{{getI18n(\'crm.global.search.refine.filter\')}}" set-conditions="{{method(\'setConditions\')}}" cx-prop-criteria="{{selectedSmartFilterCriteria}}" on-value-change="{{method(\'valueChange\')}}" on-field-change="{{method(\'fieldChange\')}}" cx-prop-enable-accordion="false"> </crux-smart-filter> </div> </div> <template is="if" value="{{isFilterDirty}}"><template case="true"> <div class="pT15 pB15 pL20 pR20 cgsRfFilterBtnWrap flexAlignCenter"> <lyte-button data-zcqa="refineFilterApplyBtn" id="applyBtn" lt-prop-disabled="true" lt-prop-appearance="primary" lt-prop-type="submit" onclick="{{action(\'applyCommonFilter\',this)}}"> <template is="registerYield" yield-name="text">{{getI18n(\'crm.button.apply.filter\')}}</template> </lyte-button> <lyte-button data-zcqa="refineFilterClearBtn" id="clearBtn" lt-prop-disabled="true" lt-prop-type="submit" onclick="{{action(\'clearCommonFilter\',this)}}"> <template is="registerYield" yield-name="text">{{getI18n(\'crm.title.clear.name\')}}</template> </lyte-button> </div> </template></template> </div> <div class="cgsRfRightWrap"> <template is="if" value="{{expHandlers(appliedModules.length,\'>\',0)}}"><template case="true"> <div class="selectedModulesAsTag pT10 pL30 pR30"> <span class="dIB vaT mT3">Applied Filters:</span> <ul class="appliedFilterList dIB m0"> <template is="for" items="{{appliedModules}}" item="item" index="index"> <li class="cP selectedModulesList pT3 pB3 pL6 pR6 mL2 mR2 mB5 br3 dIB pR" data-index="{{index}}" onclick="{{action(\'removeSelectedFltrTag\',this)}}"> {{item.field_label}}</li> </template> </ul> <span class="clearAllTagsFromList crmLinkColor cp vaM mL10 mT_2 dIB" onclick="{{action(\'clearAllSelModules\')}}">Clear All</span> </div> </template></template> <div class="s_moduleSearchList h100_per pR15 {{if(or(expHandlers(meta.field_details,\'!\'),expHandlers(meta.field_details.length,\'===\',0)),\'dF flexDC\',\'oA\')}}" onscroll="{{action(\'scrollNextRecord\',this)}}"> <template is="if" value="{{expHandlers(expHandlers(meta,\'&amp;&amp;\',meta.info),\'&amp;&amp;\',expHandlers(meta.field_details,\'!==\',undefined))}}"><template case="true"> <template is="for" items="{{meta.field_details}}" item="moduleVsFieldsMap" index="index"> <template is="if" value="{{moduleVsFieldsMap.show}}"><template case="true"> <div class="br12 bg_white br_border3 mB20 oH"> <div class="flexAlignCenter pT8 pB8 pL20 pR10"> <div class="crm-font-bold crm-subheading-font-size fg1 flexAlignCenter"> {{getPluralLabelByModuleMap(moduleVsFieldsMap,sysRefNameVsModuleDetailsMap)}}<span class="dIB mL3 crm-small-font-size cgsRfRecordCnt br10 pL5 pR5">{{getRecordsCountForSearch(meta.info[moduleVsFieldsMap.module.api_name])}}</span> </div> <lyte-navigator data-zcqa="navRecord" on-next="{{method(\'navigControl\',moduleVsFieldsMap.module.api_name,true)}}" on-previous="{{method(\'navigControl\',moduleVsFieldsMap.module.api_name,false)}}" id="navigator_{{moduleVsFieldsMap.module.api_name}}" lt-prop-id="navigator_{{moduleVsFieldsMap.module.api_name}}" lt-prop-yield="true" lt-prop-value="{{getValue(getValue(meta.info,moduleVsFieldsMap.module.api_name),\'startIndex\',flag)}}" lt-prop-records="{{getRecordsCountForSearch(meta.info[moduleVsFieldsMap.module.api_name])}}" lt-prop-perpage="10"> <template is="registerYield" yield-name="navigatorYield"> <div class="dF aiCenter"> <div data-zcqa="navStartEndRecord" class="lyteNavigator navigatorNumber"> {{startRecord}} - {{endRecord}} </div> <div data-zcqa="navPrevRecord" class="lyteNavigator lyteIconSingleBack lyteSingleBack"> </div> <div data-zcqa="navAfterRecord" class="lyteNavigator lyteIconSingleFront lyteSingleFront"> </div> </div> </template> </lyte-navigator> </div> <div class="pR"> <div data-zcqa="showColumnModule" id="columnListIcon_{{moduleVsFieldsMap.module.api_name}}" class="pA w40 h35 zi1 right0 top1 bg_white flexAlignCenter jcCenter cP cgsRfManageColumnIc" onclick="{{action(\'showColumnList\',this)}}" data-params="{&quot;module&quot;:&quot;{{moduleVsFieldsMap.module.api_name}}&quot;}"> <crmutil-icon icon-name="column-arrange" icon-class="zcicn-column-arrange"></crmutil-icon> </div> <crux-table-component cx-prop-zcqa-with-id="quickActionsOptionsRow_" data-zcqa="recDataTable" cx-prop-enable-field-sort="false" cx-prop-header="{{moduleVsFieldsMap.fields}}" cx-prop-module="{{sysRefNameVsModuleDetailsMap[moduleVsFieldsMap.module.api_name].module_name}}" cx-prop-yield-for-suffix="true" cx-prop-yield-for-prefix="true" cx-prop-prefix-yields="{{prefixYieldData}}" cx-prop-suffix-yields="{{suffixYieldData}}" cx-prop-column-cell-class="cgsRfTableCell" cx-prop-table-class="noBorderTable crmTableTopBorder csgRfResultTable" on-body-row-click="{{action(\'navigateDetailview\')}}" cx-prop-content="{{getValuesForModule(moduleVsFieldsMap,sysRefNameVsModuleDetailsMap,values,flag)}}" cx-prop-field-type-mapping="{{fieldMapping}}" id="tableComponent_{{getModuleNameByApiName(moduleVsFieldsMap.module.api_name)}}" cx-prop-id="tableComponent_{{getModuleNameByApiName(moduleVsFieldsMap.module.api_name)}}" data-params="{{moduleVsFieldsMap.module.api_name}}" cx-prop-is-color-code-enabled="true" on-mouse-over="{{action(\'showIcons\')}}"> <template is="registerYield" yield-name="header-suffix-1"> </template> <template is="registerYield" yield-name="header-prefix-1"> </template> <template is="if" value="{{expHandlers(checkPermission(\'Crm_Implied_Edit\',getModuleNameByApiName(moduleVsFieldsMap.module.api_name)),\'||\',expHandlers(checkPermission(\'Crm_Implied_Delete\',getModuleNameByApiName(moduleVsFieldsMap.module.api_name)),\'&amp;&amp;\',expHandlers(moduleVsFieldsMap.module.api_name,\'!==\',&quot;Notes&quot;)))}}"><template case="true"> <template is="registerYield" yield-name="body-prefix-1"> <div data-zcqa="quickActionsGSearch" id="quickActionsOptions_{{recordObj.id}}" class="icon-hover-effects cgsTableMoreIcon vH refineUtilICon"> <crmutil-icon data-zcqa="quickActionsGSearchUtilIcon" icon-name="more-hr-md" icon-class="zcicn-more-hr-md" class="zi2"></crmutil-icon> </div> </template> </template></template> <template is="yield" yield-name="body-lookup"> <template is="if" value="{{expHandlers(moduleVsFieldsMap.module.api_name,\'===\',&quot;Notes&quot;)}}"><template case="true"> <template is="if" value="{{expHandlers(fieldObj.data_type,\'===\',&quot;lookup&quot;)}}"><template case="true"> <crux-lookup-component data-zcqa="recDataNotes" cx-prop-value="{{recordObj[fieldObj.api_name].name}}" onclick="{{action(\'showNotesDiv\',recordObj.id)}}" cx-prop-dynamic-params="[]" cx-prop-zcqa="{{recordObj[fieldObj.api_name]}}" cx-prop-id="Note_{{{{fieldObj.id}}}}" class="cP"></crux-lookup-component> </template><template case="false"> <crux-lookup-component data-zcqa="recDataNotes" cx-prop-value="{{recordObj[fieldObj.api_name]}}" onclick="{{action(\'showNotesDiv\',recordObj.id)}}" cx-prop-dynamic-params="[]" cx-prop-zcqa="{{recordObj[fieldObj.api_name]}}" cx-prop-id="Note_{{{{fieldObj.id}}}}" class="cP"></crux-lookup-component> </template></template> </template><template case="false"><template is="if" value="{{expHandlers(fieldObj.data_type,\'===\',&quot;lookup&quot;)}}"><template case="true"><template is="if" value="{{expHandlers(expHandlers(fieldObj.column_name,\'===\',&quot;SEID&quot;),\'&amp;&amp;\',expHandlers(fieldObj.ui_type,\'===\',4))}}"><template case="true"> <crux-lookup-component data-zcqa="recDataLookupWhatId" cx-prop-value="{{recordObj[fieldObj.api_name].name}}" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params="[&quot;{{if(ifEquals(getModuleNameByApiName(recordObj.$se_module),&quot;Deals&quot;),&quot;Potentials&quot;,getModuleNameByApiName(recordObj.$se_module))}}&quot;, &quot;{{recordObj[fieldObj.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-query-params="{&quot;pfrom&quot;:&quot;gsearch&quot;}" cx-prop-zcqa="{{recordObj[fieldObj.api_name]}}" cx-prop-id="{{module}}_{{fieldObj.id}}"></crux-lookup-component> </template><template case="false"> <crux-lookup-component data-zcqa="recDataLookup" cx-prop-query-params="{&quot;pfrom&quot;:&quot;gsearch&quot;}" cx-prop-value="{{recordObj[fieldObj.api_name].name}}" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params="[&quot;{{if(fieldObj.lookup.module,getModuleNameByApiName(fieldObj.lookup.module.api_name),recordObj[fieldObj.api_name].module)}}&quot;, &quot;{{recordObj[fieldObj.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name]}}" cx-prop-id="{{module}}_{{fieldObj.id}}"></crux-lookup-component> </template></template></template><template case="false"><template is="if" value="{{expHandlers(fieldObj.data_type,\'===\',&quot;multi_module_lookup&quot;)}}"><template case="true"> <crux-lookup-component data-zcqa="recDataMultiLookup" cx-prop-value="{{recordObj[fieldObj.api_name]}}" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params="[&quot;{{getModuleNameByApiName(recordObj[fieldObj.api_name].module.api_name)}}&quot;, &quot;{{recordObj[fieldObj.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-query-params="{{if(ifEquals(module,\'Activities\'),concat(\'{&quot;sub_module&quot;:&quot;\',recordObj.Activity_Type,\'&quot;,&quot;pfrom&quot;:&quot;gsearch&quot;}\'), \'{&quot;pfrom&quot;:&quot;gsearch&quot;}\')}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name]}}" cx-prop-id="{{getNameByModuleMap(moduleVsFieldsMap,sysRefNameVsModuleDetailsMap)}}_{{fieldObj.id}}"></crux-lookup-component> </template><template case="false"> <crux-lookup-component cx-prop-transition-data="{{if(ifEquals(moduleVsFieldsMap.module.api_name,\'Tasks\'),concat(\'{&quot;id&quot;:&quot;\',recordObj.id,\'&quot;,&quot;recordNum&quot;:&quot;1&quot; ,&quot;module&quot;:&quot;Tasks&quot; ,&quot;pfrom&quot;:&quot;gsearch&quot; ,&quot;lookback&quot;:&quot;true&quot; ,&quot;fromActSubModuleListView&quot;:&quot;true&quot;}\'),\'\')}}" data-zcqa="recDataNonLookup" cx-prop-value="{{recordObj[fieldObj.api_name]}}" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params="[&quot;{{if(fieldObj.lookup.module,sysRefNameVsModuleDetailsMap[fieldObj.lookup.module.api_name].module_name,getNameByModuleMap(moduleVsFieldsMap,sysRefNameVsModuleDetailsMap))}}&quot;, &quot;{{recordObj.id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-query-params="{{if(ifEquals(module,\'Activities\'),concat(\'{&quot;sub_module&quot;:&quot;\',recordObj.Activity_Type,\'&quot;,&quot;pfrom&quot;:&quot;gsearch&quot;}\'), \'{&quot;pfrom&quot;:&quot;gsearch&quot;}\')}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name]}}" cx-prop-id="{{getNameByModuleMap(moduleVsFieldsMap,sysRefNameVsModuleDetailsMap)}}_{{fieldObj.id}}"></crux-lookup-component> </template></template></template></template></template></template> </template> </crux-table-component> </div> </div> </template></template></template></template></template> <template is="if" value="{{expHandlers(expHandlers(meta.field_details,\'!\'),\'||\',expHandlers(meta.field_details.length,\'===\',0))}}"><template case="true"> <div data-zcqa="noResultDiv" class=" flexAlignCenter jcCenter flexDC bg_white br12 mB20 br_border3 fg1"> <div class="dIB noResultsFoundIllustration"></div> <div class="pT10 crmNotFoundColor crm-subheading-font-size"> {{getI18n(\'crm.global.search.no.results.found\')}}</div> </div> </template></template> <div data-zcqa="zohoSearchBtn" class="cgsRfZiaWrap br12 dF jcCenter p10 mB20"> <div class="dIF aiCenter" onclick="{{action(\'openZohoSearchPages\')}}"> <span class="zcicncss-zia-search zcicn-cssIcons zcicncss16 zcicn_blue_mask cP"></span> <span class="crmLinkColor cP pL8 crm-font-semibold">{{getI18n(\'crm.title.gsearch.search.across.mini\',"Zoho")}}</span> </div> </div> </div> </div> </div> </div> </div> <lyte-modal id="popover_refinemodules" lt-prop-wrapper-class="cxColumnListOnPopup cxColumnListOnPopupWithHeader" lt-prop-offset="{&quot;top&quot;:&quot;0&quot;}" lt-prop-show-close-button="false" lt-prop-set-content-height="true" on-before-show="{{method(&quot;manageModalHeight&quot;)}}" on-resize="{{method(&quot;manageModalHeight&quot;)}}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header>{{getI18n(\'crm.global.search.manage.columns\',currentpopovermodulePlural)}} </lyte-modal-header> <lyte-modal-content> <crux-column-list cxpropsearchzcqa="manageClmnSearch" cx-prop-drag-zcqa-prefix="manageClmnMenu_" data-zcqa="manageClmn" cx-prop-id="columnList_refineModules" id="columnList_refinemodules" class="columnList_refinemodules" data-column-id="popover_refinemodules" cx-prop-fields="{{allFields}}" cx-prop-selected-fields="{{selectedFields}}" cx-prop-mandatory="isMandatory" on-before-checked="{{method(\'beforeSelection\')}}" on-search="{{method(\'cgsRefinePopSrch\')}}" cx-prop-disable-sort-for-unselected-fields="true"></crux-column-list> </lyte-modal-content> <lyte-modal-footer> <template is="if" value="{{showPopoverfooter}}"><template case="true"> <lyte-button data-zcqa="closeClnBtn" onclick="{{action(\'closeColumnList\')}}"> <template is="registerYield" yield-name="text"> {{getI18n("crm.button.cancel")}} </template> </lyte-button> <lyte-button data-zcqa="saveClnBtn" lt-prop-appearance="primary" onclick="{{action(\'saveColumnList\',currentpopovermodule)}}"> <template is="registerYield" yield-name="text"> {{getI18n("crm.button.save")}} </template> </lyte-button> </template></template> </lyte-modal-footer> </template> </lyte-modal> <lyte-menu data-zcqa="quickActionGlobalSearch" id="quickActionsMenuOptions_{{entityId}}" lt-prop-yield="true" lt-prop-event="click" lt-prop-query="#quickActionsOptions_{{entityId}}" lt-prop-freeze="true" lt-prop-position="down" on-before-open="{{method(\'cgsRefineMenuOpen\')}}" on-close="{{method(\'cgsRefineMenuClose\')}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body id="quickActionsOptionsList" data-zcqa="quickActionsOptionsList" class="cgsRfMenuBody moduleForEdit"> <template is="if" value="{{checkPermission(\'Crm_Implied_Edit\',moduleForEdit)}}"><template case="true"> <lyte-menu-item data-zcqa="quickActionGlobalSearchEdit" data-value="Edit" id="qAOptions_{{entityId}}_Edit" class="csgRfMenuEditOpt"> <crm-view-edit-icon from_globalsearchview="true" record="{{recordObjForEdit}}" module="{{moduleForEdit}}" from_listview="true" class="w100_per"> </crm-view-edit-icon> </lyte-menu-item> </template></template> <template is="if" value="{{expHandlers(expHandlers(moduleForEdit,\'!==\',&quot;Notes&quot;),\'&amp;&amp;\',checkPermission(\'Crm_Implied_Delete\',moduleForEdit))}}"><template case="true"> <lyte-menu-item data-zcqa="quickActionGlobalSearchDelete" data-value="Delete" id="qAOptions_{{entityId}}_Delete" onclick="{{action(\'updateDelete\')}}"> {{getI18n("crm.button.delete")}} </lyte-menu-item> </template></template> </lyte-menu-body> </template> </lyte-menu> <lyte-event-listener event-name="windowResize" on-fire="{{action(\'windowResize\')}}"> </lyte-event-listener></template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1,1,0]},{type:"attr",position:[1,1,1,3,1]},{type:"componentDynamic",position:[1,1,1,3,1]},{type:"attr",position:[1,1,1,3,3]},{type:"componentDynamic",position:[1,1,1,3,3]},{type:"attr",position:[1,1,3]},{type:"attr",position:[1,1,3,1]},{type:"attr",position:[1,3,1,1]},{type:"attr",position:[1,3,1,1,3]},{type:"if",position:[1,3,1,1,3],cases:{true:{dynamicNodes:[]}},default:{}},{type:"attr",position:[1,3,1,3]},{type:"if",position:[1,3,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"text",position:[1,3,0]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"text",position:[1,3,1,5,1,0]},{type:"attr",position:[1,3,1,5,3]},{type:"componentDynamic",position:[1,3,1,5,3]},{type:"attr",position:[1,3,3],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'height:'","cgsSecContainerHeight"]}}}},{type:"attr",position:[1,3,3,1]},{type:"attr",position:[1,3,3,1,1]},{type:"text",position:[1,3,3,1,1,1,0]},{type:"attr",position:[1,3,3,1,1,3,1]},{type:"componentDynamic",position:[1,3,3,1,1,3,1]},{type:"text",position:[1,3,3,1,1,5,1,0]},{type:"attr",position:[1,3,3,1,1,5,3]},{type:"componentDynamic",position:[1,3,3,1,1,5,3]},{type:"attr",position:[1,3,3,1,3]},{type:"if",position:[1,3,3,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"registerYield",position:[1,3,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1,3]}]}},default:{}},{type:"attr",position:[1,3,3,3,1]},{type:"if",position:[1,3,3,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]}]},{type:"attr",position:[1,5]}]}},default:{}},{type:"attr",position:[1,3,3,3,3]},{type:"attr",position:[1,3,3,3,3,1]},{type:"if",position:[1,3,3,3,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,1,1]},{type:"text",position:[1,1,1,3,0]},{type:"attr",position:[1,1,3]},{type:"registerYield",position:[1,1,3,1],dynamicNodes:[{type:"text",position:[1,1,1]},{type:"text",position:[1,1,3]}]},{type:"componentDynamic",position:[1,1,3]},{type:"attr",position:[1,3,1]},{type:"componentDynamic",position:[1,3,1,1]},{type:"attr",position:[1,3,3]},{type:"registerYield",position:[1,3,3,1],dynamicNodes:[]},{type:"registerYield",position:[1,3,3,3],dynamicNodes:[]},{type:"attr",position:[1,3,3,5]},{type:"if",position:[1,3,3,5],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,1]}]}]}},default:{}},{type:"registerYield",position:[1,3,3,7],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]},{type:"componentDynamic",position:[1,3,3]}]}},default:{}}]}]}},default:{}},{type:"attr",position:[1,3,3,3,3,3]},{type:"if",position:[1,3,3,3,3,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,3,1]}]}},default:{}},{type:"attr",position:[1,3,3,3,3,5,1]},{type:"text",position:[1,3,3,3,3,5,1,3,0]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"componentDynamic",position:[3,1]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"if",position:[5,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5]},{type:"registerYield",position:[5,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[5]},{type:"attr",position:[7]},{type:"componentDynamic",position:[7]}],_observedAttributes:["isSecondaryResults","selectedTag","allFields","selectedFields","columnListOpenedModules","fieldMapping","smartFilterFields","moduleResultsInfo","moduleRecordMapping","moduleFilterList","filteredModules","allModuleList","isPrimarySearch","entityId","recordObjForEdit","moduleForEdit","isSpecialModuleForEdit","values","flag","isRelevance","isTagsEnabled","appliedTags","pendingTags","tagNameVsValue","moduleMetaToBeRendered","prefixYieldData","suffixYieldData","moduleResultsToBeRendered","refineCriteria","cxPropCriteriaCondition","resultsShownForTags","isResultToBeRenderedEmpty","searchStarted","appointmentHiddenFields","tasksHiddenFields","servicesHiddenFields","refineModuleDisable","refineFilterDisable","valueChangeDisable","selectedSmartFilterCriteria","triggeredModules","currentTotalCount","isScrollResultToFetch","taskTransitionData","triggerHintNeeded","threeCharacterHintNeeded","isFilterButtonEnable","currentInputText","modulesCount","recordsCount","showPopoverfooter","currentpopovermodule","currentpopovermodulePlural","retryMech","isNextGenUIEnabled","iscrmPlus","refineFilterOpened","refineFilterTransitionEnded","cgsModuleListHeight","cgsSecContainerHeight","tableTooltipConfig","isFilterApplied","isFilterDirty","filterLabel","sortOptions","selectedSort"],init:function(){Crm.client_tracking("Global Search New UI - Advanced");var e=this.getDataFromModuleRecordMapping(),t=e.allModulesArrayList,a=e.sysRefNameVsModuleDetailsMap,o=[],i=Lyte.Router.getRouteInstance().transition.data;[{api_name:"Created_Date",field_label:"crm.label.CreatedDate"},{api_name:"Modified_Date",field_label:"crm.label.ModifiedDate"},{api_name:"Created_By",field_label:"crm.label.CreatedBy"},{api_name:"Modified_By",field_label:"crm.label.ModifiedBy"},{api_name:"Owned",field_label:"crm.label.Owned"}].filter((function(e){var t={};t.api_name=e.api_name,t.field_label=I18n.getMsg(e.field_label),t.visible=!0,t.available_in_user_layout=!0,t.filterable=!0,"Created_Date"===e.api_name||"Modified_Date"===e.api_name?t.data_type="datetime":"Created_By"!==e.api_name&&"Modified_By"!==e.api_name&&"Owned"!==e.api_name||(t.data_type="ownerlookup"),o.push(t)})),this.setData("smartFilterFields",o);var r=Lyte.Router.getRouteInstance().getQueryParams(),s=r.isRelevance;this.setData({isRelevance:void 0!==s&&s,selectedSort:void 0===s?"modifiedTime":"true"===s?"relevance":"modifiedTime"});var l=[{system:"Age in Days",display:I18n.getMsg("crm.globalSearch.condition.in.last")},{system:"equal",display:I18n.getMsg("On")},{system:"less_than",display:I18n.getMsg("crm.label.before")},{system:"greater_than",display:I18n.getMsg("crm.label.after")},{system:"between",display:I18n.getMsg("crm.uppercase.between")},{system:"${TODAY}",display:I18n.getMsg("crm.label.today")},{system:"${YESTERDAY}",display:I18n.getMsg("crm.label.yesterday")},{system:"${THISWEEK}",display:I18n.getMsg("crm.label.this.week")},{system:"${THISMONTH}",display:I18n.getMsg("crm.label.this.month")},{system:"${THISYEAR}",display:I18n.getMsg("crm.label.this.year")},{system:"${LASTWEEK}",display:I18n.getMsg("crm.label.last.week")},{system:"${LASTMONTH}",display:I18n.getMsg("crm.label.last.month")}];this.setData("cxPropCriteriaCondition",{date:l});var n=[];t.filter((function(e){var t={};t.id=e.id,t.api_name=e.api_name,t.field_label=e.plural_label,n.push(t)})),this.setData("displayField",crmConstants.moduleDisplayField),this.setData("moduleRecordMapping",moduleRecordMapping),this.setData("allModulesArrayList",t),this.setData("sysRefNameVsModuleDetailsMap",a);let p=Lyte.Router.getRouteInstance().currentModel.selectedModule;if(0===i.filteredModules.length){if(p&&"AllModules"!==p){let e=a[Lyte.Router.getRouteInstance().currentModel.selectedModule],t={};t.id=e.id,t.api_name=e.api_name,t.field_label=e.plural_label,$L("#clearBtn")[0].ltProp("disabled",!1),Lyte.arrayUtils(this.getData("filteredModules"),"push",t)}var c=r.modules;if(i.isReload&&void 0!==c&&"AllModules"!==c){for(var d=c.split(","),u=d.length,m=this.getData("filteredModules"),g=0;g<u;g++){let e=a[d[g]];if(void 0===e)continue;let t={};t.id=e.id,t.api_name=e.api_name,t.field_label=e.plural_label,Lyte.arrayUtils(m,"push",t)}this.setData({isFilterApplied:!0,isFilterDirty:!1})}}else this.setData({filteredModules:i.filteredModules,isFilterApplied:!0,isFilterDirty:!1});i.refineCriteria&&this.setData({refineCriteria:JSON.parse(i.refineCriteria),isFilterApplied:!0,isFilterDirty:!1}),this.setData("originalModuleList",n),this.setData("allModuleList",n),this.getData("filteredModules").length>0?this.setData("moduleFilterList",this.methods.mergeFilterToAllModules(this.getData("filteredModules"),n)):this.setData("moduleFilterList",n),setTimeout(function(){var e=$L("crm-global-search-input")[0].component,a=Lyte.Router.getRouteInstance().getQueryParams();e.setData("isTagsEnabled",i.isTagsEnabled);var o=[{display_label:"#Record Name",name:"#Record Name",value:"",param:"Record_Name",indexVal:"0"},{display_label:"#Tags",name:"#Tags",value:"",param:"Tags",indexVal:"1"}],r=e.getData("appliedTags");if(void 0!==a.criteria){var s=this.actions.transformObjects(JSON.parse(a.criteria));i.appliedTags=s;for(var l=s.length,p=0;p<l;p++){var c=s[p];Lyte.arrayUtils(o,"removeAt",o.findIndex((e=>e.name===c.name))),Lyte.arrayUtils(r,"push",c),Lyte.objectUtils(e.getData("tagNameVsValue"),"add",c.name,c.value)}e.setData("isTagsEnabled",!0),i.pendingTags=o}if(i.isReload&&void 0!==a.refineCriteria){var d=JSON.parse(a.refineCriteria);$L("#refineFilter")[0].component.setCriteria({filters:d}),this.setData({isFilterApplied:!0,isFilterDirty:!1})}else e.setData("appliedTags",i.appliedTags);e.setData("currentAppliedTags",Lyte.deepCopyObject(i.appliedTags)),e.setData("currSearchInputText",this.getData("searchword")),this.setData("resultsShownForTags",[...i.appliedTags]),e.setData("pendingTags",i.pendingTags),e.setData("currentAllTags",Lyte.deepCopyObject(e.getData("allTags"))),e.setData("currentPendingTags",e.getData("pendingTags")),e.setData("isPrimarySearch",!1),e.setData({isPrimarySearch:!1,allModulesArrayList:t,isInputEmpty:!1,searchInputText:this.getData("searchword")}),void 0!==i.selectedUsers&&i.selectedUsers.forEach(((e,t)=>{var a=$L("crux-user-dropdown")[t].component;a.setData("cxPropSelectedUser",e.user),a.setData("cxPropSelected",e.user.id),a.setData("cxPropInputName",e.inputName)})),this.executeMethod("setSmartFilterCriteria",i.appliedTags),this.getData("isFilterDirty")&&$L("#applyBtn")[0].ltProp("disabled",!0),this.getData("filteredModules").length>0&&this.getData("isFilterDirty")&&$L("#clearBtn")[0].ltProp("disabled",!1);var u=void 0!==this.getData("triggeredModules")?this.getData("triggeredModules").length:0;this.setData("triggeredModules",n.slice(u,u+4));var m=0,g=this.data.meta.field_details,h=this.data.meta.info?this.data.meta.info.total_count:0;if(h>0)if(h>500){var y=this.data.meta.info;for(var f of g){m+=y[f.module.api_name].total_records_count}this.setData("currentTotalCount",m),this.data.meta.info.total_count===m?(this.setData("currentTotalCount",0),this.setData("isScrollResultToFetch",!1)):(this.setData("isScrollResultToFetch",!0),this.executeMethod("scrollingNextRecord",Lyte.Router.getRouteInstance().getQueryParams()))}else g.length>=2&&this.setData("isScrollResultToFetch",!0);this.syncFilterLabel()}.bind(this),200);$L("crm-left-menu").css("display","none")},didConnect:function(){"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()&&Crm.userDetails.isNewGlobalSearch&&(CrmPlusImpl.trigger("handleUnifiedSearchFilterVisibility",[!1]),$(".cgsRfSearchCont").css("display","none"),this.setData("iscrmPlus",!0)),setTimeout(function(){this.secondaryContHeightCalc(),this.refineSearchScrollCalc();var e=$L("crm-global-search-input")[0];e.setData("identifierComponent",$L("crm-global-search-identifiers")[0].component),e.component.actions.triggerSearchFocus(e.component)}.bind(this),200)},data:function(){return{isSecondaryResults:Lyte.attr("boolean",{default:!0}),selectedTag:Lyte.attr("boolean",{default:!1}),allFields:Lyte.attr("array",{default:[]}),selectedFields:Lyte.attr("array",{default:[]}),columnListOpenedModules:Lyte.attr("array",{default:[]}),fieldMapping:Lyte.attr("object",{default:{...crmConstants.defaultUiTypeToCruxMapping,999:"text"}}),smartFilterFields:Lyte.attr("array",{default:[]}),moduleResultsInfo:Lyte.attr("object",{default:[]}),moduleRecordMapping:Lyte.attr("object",{default:[]}),moduleFilterList:Lyte.attr("array",{default:[]}),filteredModules:Lyte.attr("array",{default:[]}),allModuleList:Lyte.attr("array",{default:[]}),isPrimarySearch:Lyte.attr("boolean",{default:!1}),entityId:Lyte.attr("string"),recordObjForEdit:Lyte.attr("object",{default:[]}),moduleForEdit:Lyte.attr("string",{default:[]}),isSpecialModuleForEdit:Lyte.attr("boolean",{default:!1}),values:Lyte.attr("object",{default:[]}),flag:Lyte.attr("boolean",{default:!1}),isRelevance:Lyte.attr("boolean",{default:!1}),isTagsEnabled:Lyte.attr("boolean",{default:!1}),appliedTags:Lyte.attr("array",{default:[]}),pendingTags:Lyte.attr("array",{default:[]}),tagNameVsValue:Lyte.attr("object",{default:{}}),moduleMetaToBeRendered:Lyte.attr("object",{default:{}}),prefixYieldData:Lyte.attr("array",{default:[{class:"cgsRfTmoreIconCell",fixed:"enable"}]}),suffixYieldData:Lyte.attr("array",{default:[{class:"cgsRfTLastTableCell"}]}),moduleResultsToBeRendered:Lyte.attr("object",{default:{}}),refineCriteria:Lyte.attr("object",{default:{}}),cxPropCriteriaCondition:Lyte.attr("object",{default:{}}),resultsShownForTags:Lyte.attr("array",{default:[]}),isResultToBeRenderedEmpty:Lyte.attr("boolean",{default:!1}),searchStarted:Lyte.attr("boolean",{default:!1}),appointmentHiddenFields:Lyte.attr("array",{default:["RESCHEDULEDFROM","REMINDER","ENDTIME","JOBSHEETSECTION","ISJOBSHEETCREATED"]}),tasksHiddenFields:Lyte.attr("array",{default:["REMINDAT","SENDNOTIFICATION"]}),servicesHiddenFields:Lyte.attr("array",{default:["AVAILABLE_DATES","AVAILABLE_DAYS","UNAVAILABLE_TILL","STARTING_DATE","CLOSING_DATE","APPOINTMENTFOR","SEID","APPOINTMENTLOCATION","APPOINTMENTID","APPOINTMENTADDRESS","APPOINTMENTDATEANDTIME","RESCHEDULEDFROM","SERVICEID","RESCHEDULEDTO","RESCHEDULEDREASON","RESCHEDULEDNOTE","CANCELLATIONREASON","CANCELLATIONNOTE","SERVICEAVAILABILITY","AVAILABLE_CUSTOM_TIMING","UNAVAILABLE_FROM"]}),refineModuleDisable:Lyte.attr("boolean",{default:!1}),refineFilterDisable:Lyte.attr("boolean",{default:!1}),valueChangeDisable:Lyte.attr("boolean",{default:!1}),selectedSmartFilterCriteria:Lyte.attr("object",{default:{}}),triggeredModules:Lyte.attr("array",{default:[]}),currentTotalCount:Lyte.attr("number",{default:0}),isScrollResultToFetch:Lyte.attr("boolean",{default:!1}),taskTransitionData:Lyte.attr("object",{default:{module:"Tasks",pfrom:"gsearch",lookback:!0,fromActSubModuleListView:"true"}}),triggerHintNeeded:Lyte.attr("boolean",{default:!1}),threeCharacterHintNeeded:Lyte.attr("boolean",{default:!1}),isFilterButtonEnable:Lyte.attr("boolean",{default:!1}),currentInputText:Lyte.attr("string",{default:""}),modulesCount:Lyte.attr("number",{default:"0"}),recordsCount:Lyte.attr("number",{default:"0"}),showPopoverfooter:Lyte.attr("boolean",{default:!0}),currentpopovermodule:Lyte.attr("string",{default:""}),currentpopovermodulePlural:Lyte.attr("string",{default:""}),retryMech:Lyte.attr("boolean",{default:!1}),isNextGenUIEnabled:Lyte.attr("boolean",{default:featuresAvailable.NEXTGENUI_ENABLED}),iscrmPlus:Lyte.attr("boolean",{default:!1}),refineFilterOpened:Lyte.attr("boolean",{default:!1}),refineFilterTransitionEnded:Lyte.attr("boolean",{default:!1}),cgsModuleListHeight:Lyte.attr("string"),cgsSecContainerHeight:Lyte.attr("string"),tableTooltipConfig:Lyte.attr("object",{default:{config:{position:"bottom"}}}),isFilterApplied:Lyte.attr("boolean",{default:!1}),isFilterDirty:Lyte.attr("boolean",{default:!1}),filterLabel:Lyte.attr("string"),sortOptions:Lyte.attr("array",{default:[{name:"modifiedTime",value:I18n.getMsg("crm.global.search.modified.time")},{name:"relevance",value:I18n.getMsg("crm.global.search.relevance")}]}),selectedSort:Lyte.attr("string",{default:"modifiedTime"})}},didDestroy:function(){for(var e=this.data.meta.field_details?this.data.meta.field_details.length:0,t=0;t<e;t++)store.unloadAll(this.data.meta.field_details[t].module.id+"_global");$L("crm-left-menu").css("display","")},clrFilterDetails:function(){this.secondaryContHeightCalc()}.observes("isFilterApplied","filterLabel"),ApplyFilterBtnToggle:function(){this.refineSearchScrollCalc()}.observes("isFilterDirty"),refineSearchScrollCalc:function(){var e=$L(".cgsRfFliterContainer"),t=$L(".cgsRfFilterBtnWrap"),a=e.height()-(t[0]?t.outerHeight(!0):0)-$L(".cgsRfFieldFilterWrap").outerHeight(!0)-($L(".cxColListContainer_refineModuleFilter").offset().top-e.offset().top);a<180&&(a=180),this.setData("cgsModuleListHeight",`${a}px`)},secondaryContHeightCalc:function(){var e=$L(".cgsRfSecCont").height()-($L(".cgsRfFilterDetailsWrap").outerHeight(!0)+5);this.setData("cgsSecContainerHeight",`${e}px`)},applySort:function(e){var t=$L("crm-global-search-refine")[0].component,a=t.getData("isRelevance");"relevance"===e&&!1===a?t.setData("isRelevance",!0):"modifiedTime"===e&&!0===a&&t.setData("isRelevance",!1),a=void 0!==(a=Lyte.Router.getRouteInstance().getQueryParams().isRelevance)&&Boolean(a),t.renderSecondaryResults()},actions:{gsToggleFilter:function(){var e=$L(".cgsRfFliterContainer");e.addClass("cgsRfFliterInTrans"),this.getData("refineFilterTransitionEnded")?this.setData("refineFilterOpened",!1):(this.setData("refineFilterOpened",!0),Crm.client_tracking("Global Search New UI - Filter panel opened")),e.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){e.removeClass("cgsRfFliterInTrans"),this.getData("refineFilterOpened")?this.setData("refineFilterTransitionEnded",!0):this.setData("refineFilterTransitionEnded",!1)}.bind(this))},updateDelete:function(){var e=$L("crm-global-search-refine")[0].component.data,t={ids:e.entityId,from:"quickAction"};t.old_owner_id=e.recordObjForEdit.Owner?e.recordObjForEdit.Owner.id:"",customViewObject.selectedIds=[e.entityId],Lyte.injectResources([networkUtils.returnDependencyFiles(["crm-mass-action-mixin.js"],ResourceConstants.CRMClient)[0]],void 0,(function(){Lyte.registeredMixins["crm-mass-action-mixin"].massAction("mass_delete",e.moduleForEdit,t,void 0,void 0,"change_owner")}))},transformObjects:function(e){return(Array.isArray(e)?e:e.group?e.group:[e]).map(((e,t)=>({display_label:"#"+e.field.api_name.replace("_"," "),name:"#"+e.field.api_name.replace("_"," "),value:e.value,param:e.field.api_name,indexVal:t.toString()})))},showIcons:function(e){$L("crm-global-search-refine")[0].component.setData("entityId",e)},navigateDetailview:function(e,t){var a=this.getData("sysRefNameVsModuleDetailsMap")[e.$setype].module_name;if("CRMUTIL-ICON"===t.target.tagName||"use"===t.target.tagName||"svg"===t.target.tagName||t.target.classList.contains("refineUtilICon")||"CRM-VIEW-EDIT-ICON"===t.target.tagName||t.target.classList.contains("iconlock_ap")||t.target.classList.contains("rlc_lockIcon")||t.target.classList.contains("showMoreAddedEvents")||t.target.classList.contains("tdUnderline")){var o=$L("crm-global-search-refine")[0].component;return o.setData("entityId",e.id),o.setData("recordObjForEdit",e),o.setData("moduleForEdit",a),void("Tasks"!==a&&"Calls"!==a&&"Events"!==a&&"Notes"!==a||o.setData("isSpecialModuleForEdit",!0))}if("Notes"===a)this.actions.showNotesDiv(e.id);else{var i={route:"crm.tab.module.entity",dynamicParams:[a,e.id],queryParams:{pfrom:"gsearch"}};if("Tasks"===a){var r=this.data.taskTransitionData;r.id=e.id,r.recordNum=1,Lyte.Router.transitionTo(i).data=r}else Lyte.Router.transitionTo(i)}},windowResize:function(){this.refineSearchScrollCalc(),this.secondaryContHeightCalc()},closeSecondarySearch:function(){if("undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()){var e=$L("crm-global-search-history")[0];e&&e.component.setData("isSecondaryPageOpen",!0)}crmNavig.removeFeaturCacheObj("globalSearch"),crmHistory.backOneLevel()},scrollNextRecord:function(e){var t=$L("crm-global-search-refine")[0].component;if(void 0===e.scrollHeight&&(e=$L(".s_moduleSearchList")[0]),e.scrollHeight-100<e.scrollTop+e.offsetHeight)if(t.getData("retryMech"))t.executeMethod("getRecords",Lyte.Router.getRouteInstance().getQueryParams());else if(t.getData("isScrollResultToFetch")){var a=void 0!==t.data.meta?t.data.meta.info.total_count:0,o=t.getData("modulesCount"),i=t.data.meta.field_details?t.data.meta.field_details.length:0;if(a<=500){for(var r=0,s=0,l=o;l<i;l++)r<20&&s<4&&(r+=t.data.meta.info[t.data.meta.field_details[l].module.api_name].count,s++,Lyte.objectUtils(t.data.meta.field_details[l],"add","show","true"));var n=s+o;t.setData("modulesCount",n),n===i&&t.setData("isScrollResultToFetch",!1)}if(a>500&&t.getData("currentTotalCount")!==a){for(l=o;l<i;l++)Lyte.objectUtils(t.data.meta.field_details[l],"add","show","true");t.executeMethod("getRecords",Lyte.Router.getRouteInstance().getQueryParams())}}},removeSelectedFltrTag:function(e){var t=$L(e).attr("data-index"),a=$L(".cgsRfModuleFilterWrap").find("lyte-menu-item")[t];this.setData("selectedTag",!0),$L(a).find("lyte-checkbox").trigger("click"),Lyte.arrayUtils(this.getData("filteredModules"),"removeAt",t),setTimeout(function(){this.setData("selectedTag",!1)}.bind(this),200)},showColumnList:function(e){var t=JSON.parse($L(e).attr("data-params")).module,a=this.data.sysRefNameVsModuleDetailsMap[t].module_name,o=this,i=$L("#popover_refinemodules");i[0].component.setData("ltPropOriginElem","#columnListIcon_"+t);var r=this;commonUtils.showHideLoadingDiv(!0);var s={recordAPI:store.findRecord("module",moduleRecordMapping[a].id)};Lyte.resolvePromises(s).then((function(e){commonUtils.showHideLoadingDiv(!1);var a=e.recordAPI[0].fields,s=e.recordAPI,l=[],n=s[0].module_name,p=s[0].display_field.id,c=!1,d=[];for(var u in a){var m=a[u];("Notes"!==n||"lookup"!==m.data_type&&"RELATEDID"!==m.column_name)&&(250===m.ui_type||116===m.ui_type&&m.formula.dynamic||0===m.show_type&&"FULLNAME"!==m.column_name&&"PROCESSINGBASIS"!==m.column_name&&"SE_STATUS"!==m.column_name||"S_MODIFIEDTIME"===m.column_name&&17===m.show_type||!m.visible||!m.available_in_user_layout||("Cases"===n||"Solutions"===n)&&"ADDCOMMENT"===m.column_name||"TAGMODULEREFID"===m.column_name&&c||"Tasks"===n&&r.data.tasksHiddenFields.indexOf(m.column_name)>-1||"Appointments"===n&&r.data.appointmentHiddenFields.indexOf(m.column_name)>-1||"Services"===n&&r.data.servicesHiddenFields.indexOf(m.column_name)>-1||n.startsWith("Orchestration")&&"SMOWNERID"===m.column_name||n.startsWith("PathFinder")&&("SMOWNERID"===m.column_name||"PATH"===m.column_name||"TRIGGERID"===m.column_name||"ORCHESTRATIONID"===m.column_name)||"DealHistory"===n&&"LASTACTIVITYTIME"===m.column_name||Crm.isInventoryModule(n)&&("DISCOUNT_TYPE"===m.column_name||"DISCOUNT_PERCENTAGE"===m.column_name)||("Full_Name"!==m.api_name||"Contacts"!==n&&"Leads"!==n||(m.field_label=I18n.getMsg("custommodule.crmfield.fl.name",s[0].singular_label)),m.id===p?m.isMandatory=!0:m.isMandatory=!1,"TAGMODULEREFID"===m.column_name&&(c=!0),l.push(m.id),d.push(m)))}var g=s[0].search_layout_fields,h=[];for(searchLayoutField in g)h.push(g[searchLayoutField].id);for(var y=[],f=g.length,x=0;x<f;x++)if(l.includes(h[x])){var D={};D.id=g[x].id,D.api_name=g[x].api_name,D.field_label=g[x].field_label,y.push(D)}o.setData("allFields",d),o.setData("selectedFields",y);var v=o.data.columnListOpenedModules;v.push(t),o.setData("columnListOpenedModules",v),o.setData("currentpopovermodule",t),o.setData("currentpopovermodulePlural",s[0].plural_label),i[0].ltProp("show",!0)}))},saveColumnList:function(e){var t=$L("#columnList_refinemodules")[0],a=t.component.getSelectedFields(),o=this.data.sysRefNameVsModuleDetailsMap[e].module_name,i=store.peekRecord("module",moduleRecordMapping[o].id),r=$L("crm-global-search-input")[0].component,s=r.getData("searchInputText"),l=$L("#popover_refinemodules");crmNavig.removeFeatureModuleCacheObj("globalSearch",o),t.querySelector("lyte-search").setValue("");var n,p=r.getData("requestMade"),c=r.getData("appliedTags"),d={},u={};if(!p){c.length>0&&c.filter((function(e){if("shared_with_me"===e.param||"owned_by_me"===e.param)n=void 0===n?e.param:"owned_and_shared_with_me";else{var t=e.value;t&&""!==t&&(u[e.param]=t)}}));var m=c.length>0;r.setData("isTagsEnabled",m);var g=r.getData("isTagsEnabled");d=r.criteriaFormationForRequest(g,u)}i.$.set("search_layout_fields",a.mapByKey("id")),commonUtils.showHideLoadingDiv(!0),i.$.save().then((function(t){if(commonUtils.showHideLoadingDiv(!1),t){if(t.module){var i={},r=$L("crm-global-search-refine")[0].component;r.methods.settingValuesForParams(s,g,d,i,n);var p=r.data;Object.keys(p.refineCriteria).length>0&&(i.refineCriteria=JSON.stringify(p.refineCriteria)),i.per_page=10,i.isRelevance=void 0===p.isRelevance||p.isRelevance,i.modules=e,crmNavig.removeFeatureModuleCacheObj("globalSearch",o),commonUtils.showHideLoadingDiv(!0),store.findAll("global-search",i,!1,!1).then((function(t){commonUtils.showHideLoadingDiv(!1);var i=moduleRecordMapping[o],s=r.getData("meta").info[e];Lyte.objectUtils(s,"add","page",1),Lyte.objectUtils(s,"add","startIndex",0),$("#navigator_"+e)[0].component.setData("ltPropValue",0);var l=r.getData("displayField");if(t.data)for(var n of t.data)n.hasOwnProperty("Territories")&&null!==n.Territories&&(n.Territories=n.Territories.map((e=>e.Name)).join(", ")),n.cxPropClass="cgsRfTableRow";a.filter((function(e){delete e.yieldName,"currency"!==e.data_type&&116!==e.ui_type&&117!==e.ui_type||(e.cxPropClass="alignRight",delete e.decimal_place),("Appointments"===i.module_name&&"Appointment_For"===e.api_name||"Connected_To__s"===e.api_name||"Notes"===i.module_name&&("Note_Content"===e.api_name||"Note_Title"===e.api_name)||"lookup"===e.data_type||(i.module_name.indexOf("CustomModule")>-1||i.module_name.indexOf("LinkingModule")>-1)&&"Name"===e.api_name||l[o]&&l[o].indexOf(e.api_name)>-1)&&(e.yieldName="lookup")}));var p=$("#tableComponent_"+o);if(p[0].cxProp("header",a),Lyte.Component.set(t.meta.info,o,t.meta.info),crmNavig.NAVIGCACHEOBJ.globalSearch={data:{[o]:[t.data]},dropCount:{[o]:0}},void 0!==t.meta.field_details){store.modelFor(t.meta.field_details[0].module.api_name+"_global")||store.registerModel(t.meta.field_details[0].module.api_name+"_global",{});for(var c=t.meta.field_details[0].fields.length,d=0;d<c;d++)store.addField(t.meta.field_details[0].module.api_name+"_global",t.meta.field_details[0].fields[d].api_name,Lyte.attr(Lyte.registeredMixins["crm-module-mixin"].getfieldattributeType(t.meta.field_details[0].fields[d])));t.data=store.pushPayload(t.meta.field_details[0].module.api_name+"_global",t.data)}p[0].cxProp("content",t.data)})),l[0].ltProp("show",!1)}}else l[0].ltProp("show",!1)}),(function(){commonUtils.showHideLoadingDiv(!1),_cruxUtils.showCustomAlert({params:{ltPropSecondaryMessage:"Limit Exceeded"}})}))},closeColumnList:function(){$L(".cxColListContainer_columnList_refineModules .divTopBorder")[0].scrollTop=0,$L("#popover_refinemodules")[0].ltProp("show",!1);var e=$L("#columnList_refinemodules")[0];e.component.clearSelectedFields(),e.querySelector("lyte-search").setValue("")},openModuleFilterList:function(e){this.openModuleFilterList(e)},selectThisModule:function(e){this.selectThisModule(e)},clearAllSelModules:function(){$L(".moduleFilterList").component.clearSelectedFields(),this.setData("filteredModules",[])},applyCommonFilter:function(){this.setData("columnListOpenedModules",[]),this.setData("searchStarted",!0);var e=$L("crm-global-search-refine")[0].component,t=$L("#refineFilter")[0].component,a=t.getFilterCriteria(),o=$L("crux-column-list",e.$node)[0].component,i=o.getSelectedFields();o.clearSelectedFields();var r=objectUtils.deepClone(e.getData("originalModuleList"),[],[],!0);if(e.setData("moduleFilterList",e.methods.mergeFilterToAllModules(i,r)),e.setData("filteredModules",i),a&&a.isValdationFailure)return;if(!a||a.noFieldSelected||a.isValdationFailure)e.setData("refineCriteria",{});else{var s=JSON.stringify(a.queryParams.filters);e.setData("refineCriteria",s)}crmNavig.removeFeaturCacheObj("globalSearch"),t.resetFields(),t.setCriteria(a.queryParams);var l=$L("crm-global-search-input")[0].component,n=l.getData("searchInputText");this.executeMethod("setCurrentTagsData"),e.setData("triggeredModules",[]);const p=i.length>0||!a.noFieldSelected;i.length>0&&!a.noFieldSelected?Crm.client_tracking("Global Search New UI - Module and Fields filter applied"):a.noFieldSelected?i.length>0&&Crm.client_tracking("Global Search New UI - Module filter applied"):Crm.client_tracking("Global Search New UI - Fields filter applied"),this.renderSecondaryResults(),l.setData("searchInputText",n);i=e.getData("filteredModules");Lyte.arrayUtils(i,"push",{}),Lyte.arrayUtils(i,"pop"),this.setData("searchStarted",!1),e.methods.resetDisableFilter(e),e.setData({isFilterDirty:!1,isFilterApplied:p}),e.syncFilterLabel(),e.methods.buttonOrClearChange(e,!1)},showNotesDiv:function(e){Notes.showNotesDiv("/crm/viewnote.do?type=gsearch&notesid="+e,"ViewNote")},clearCommonFilter:function(){this.setData("columnListOpenedModules",[]),this.setData("searchStarted",!0);var e=$L("crm-global-search-refine")[0].component;e.setData("refineCriteria",{}),$L("crux-smart-filter")[0].component.resetFields(),e.setData("filteredModules",[]),e.setData("moduleFilterList",e.getData("originalModuleList")),$L("#relevanceButton").click(),e.setData("triggeredModules",[]);var t=$L(".moduleFilterList")[0];t&&t.setSearchValue("");var a=$L("crm-global-search-input")[0].component,o=a.getData("searchInputText");this.executeMethod("setCurrentTagsData"),this.getData("isFilterDirty")&&($L("#clearBtn")[0].ltProp("disabled",!0),$L("#applyBtn")[0].ltProp("disabled",!0)),this.renderSecondaryResults(!0),e.setData({isFilterDirty:!1,isFilterApplied:!1}),e.syncFilterLabel(),a.setData("searchInputText",o),e.methods.resetDisableFilter(e)},openZohoSearchPages:function(){var e=$L("crm-global-search-input")[0].component.data.searchInputText;this.actions.closeSecondarySearch(),zgssearch.search(e)}},methods:{cgsRefinePopSrch:function(e){var t=$L("crm-global-search-refine")[0].component;0===e.length?t.setData("showPopoverfooter",!1):t.setData("showPopoverfooter",!0)},cgsRefineMenuOpen:function(e,t,a){$L(a).closest(".cgsRfTableRow").addClass("cgsActiveMenuEle")},cgsRefineMenuClose:function(){$L(".cgsActiveMenuEle").removeClass("cgsActiveMenuEle")},manageModalHeight:function(){var e=$L("#popover_refinemodules"),t=window.innerHeight;e[0].ltProp("maxHeight",t-38)},beforeSelection:function(){if($L(".columnList_refinemodules")[0].component.getSelectedFields().length>=10)return _cruxUtils.removeCustomMessage(),_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropMessage:I18n.getMsg("crm.alert.max.cvcols.reached",10)}}),!1},scrollingNextRecord:function(e){this.actions.scrollNextRecord(e)},resetDisableFilter:function(e){e.setData("refineModuleDisable",!1),e.setData("refineFilterDisable",!1),e.setData("valueChangeDisable",!1)},setSmartFilterCriteria:function(e){const t=[];var a={},o=$L("crm-global-search-refine")[0].component;let i=0;for(const a of e)"Modified_By"!==a.param&&"Created_By"!==a.param&&"owned_by_me"!==a.param||(i++,t.push(o.methods.getFieldObject(a)));1===i&&(a=t[0]);var r={filters:a};i>1&&(r={filters:{group_operator:"AND",group:t}}),Object.keys(r.filters).length>0&&o.setData("selectedSmartFilterCriteria",r)},setCurrentTagsData:function(){var e=$L("crm-global-search-input")[0].component,t=Lyte.deepCopyObject(e.getData("currentAppliedTags"));for(var a of t)"Created_By"!==a.param&&"Modified_By"!==a.param||(a.value[0].full_name=a.value[0].name);e.setData("appliedTags",t),e.setData("searchInputText",e.getData("currSearchInputText")),e.setData("allTags",Lyte.deepCopyObject(e.getData("currentAllTags"))),e.setData("pendingTags",Lyte.deepCopyObject(e.getData("currentPendingTags"))),e.setData("tagNameVsValue",Lyte.deepCopyObject(e.getData("currentTagNameVsValue"))),e.setData("currentTagFocusIndex",-1),e.setData("currentTagFocusName",""),e.setData("searchTagInputText","")},getRecords:function(e){commonUtils.showHideLoadingDiv(!0);const t=$L("crm-global-search-refine")[0].component;t.setData("isScrollResultToFetch",!1);var a=t.getData("filteredModules");const o=void 0!==a&&a.length>0?a:t.getData("allModuleList");if(t.getData("retryMech")&&0===t.getData("triggeredModules").length){var i=o.findIndex((e=>e.api_name===this.data.meta.info.records_count.slice(-1)[0].module.api_name));t.setData("triggeredModules",o.slice(0,i+1))}var r=e.searchword,s={};const l=t.getData("triggeredModules");0===l.length&&l.push(...o.slice(0,4));var n=0===l.length?4:l.length,p=o.length,c=4;if(n+4>p&&(c=p-n)<=0)commonUtils.showHideLoadingDiv(!1);else{var d=[];(void 0!==this.data.meta.info.records_count?this.data.meta.info.records_count:[]).filter((function(e){d.push(e.module.api_name)})),s.modules="";for(let e=0;e<c;e++){var u=o[e+n];if(!u)return void commonUtils.showHideLoadingDiv(!1);var m=u.api_name;if(d.includes(m)){if(c===p)break;c++}else s.modules+=m+","}l.push(...o.slice(n,n+c)),e.criteria&&(s.criteria=e.criteria),r&&(s.searchword=r),s.isRelevance=e.isRelevance,e.refineCriteria&&(s.refineCriteria=e.refineCriteria),s.per_page=10,s.apply_fields="search_layout_fields",store.findAll("global-search",s,!1,!1).then((e=>{var a={Leads:["Full_Name","Last_Name"],Activities:["Subject"],Tasks:["Subject"],Events:["Subject"],Calls:["Subject"],Accounts:["Account_Name"],Contacts:["Full_Name","Last_Name"],Deals:["Deal_Name"],Potentials:["Deal_Name"],Campaigns:["Campaign_Name"],Cases:["Subject"],Solutions:["Solution_Title"],Products:["Product_Name"],Vendors:["Vendor_Name"],PriceBooks:["Price_Book_Name"],Quotes:["Subject"],SalesOrders:["Subject"],PurchaseOrders:["Subject"],Invoices:["Subject"],Visits:["Visited_Page"],Notes:["Note_Title","Note_Content"],CustomModule:["Name"]};const o=s.modules.split(",");if(void 0!==e.meta.field_details){var i=new Array;for(var r of e.meta.field_details)i.push(r.module.api_name);var l=new Map;if(e.data)for(var n of e.data)n.hasOwnProperty("Territories")&&null!==n.Territories&&(n.Territories=n.Territories.map((e=>e.Name)).join(", ")),n.cxPropClass="cgsRfTableRow";var p=e.meta.field_details,c={};void 0!==p&&p.filter((function(e){var t=e.module.api_name;c[t]=e.fields}));var u=e.meta.info,m=this.data.meta.info;if(void 0!==u.records_count){var g=0,h=this.getData("currentTotalCount");for(var y of u.records_count)d.includes(y.module.api_name)?e.meta.field_details.splice(g,1):(y.page=1,y.per_page=10,y.startIndex=0,h+=y.total_records_count,l.set(y.module.api_name,y),m[y.module.api_name]=y,m.records_count.push(y),g++);this.data.meta.info=m,this.setData("currentTotalCount",h)}var f=0,x=this.getData("values"),D=0,v=0,b=t.data.sysRefNameVsModuleDetailsMap;for(var C of o)if(i.includes(C)){var S=m[C].count;if(!d.includes(C)){var L=e.data.slice(f,f+S),P=[];this.moduleCacheFormation(P,L);for(var _=moduleRecordMapping[b[C].module_name],T=c[C],I=T.length,q=0;q<I;q++){var M=T[q];delete M.yieldName,"currency"!==M.data_type&&116!==M.ui_type&&117!==M.ui_type||(M.cxPropClass="alignRight",delete M.decimal_place),("Appointments"===_&&"Appointment_For"===M.api_name||"Connected_To__s"===M.api_name||"Notes"===_.module_name&&("Note_Content"===M.api_name||"Note_Title"===M.api_name)||"lookup"===M.data_type||(_.module_name.indexOf("CustomModule")>-1||_.module_name.indexOf("LinkingModule")>-1)&&"Name"===M.api_name||a[C]&&a[C].indexOf(M.api_name)>-1)&&(M.yieldName="lookup")}crmNavig.NAVIGCACHEOBJ.globalSearch.data[_.module_name]=P.slice(0,20),x[_.module_name]=P[0],f+=S}}if(this.setData("values",x),void 0!==e.meta.field_details){var R=e.meta.field_details.length;for(q=0;q<R;q++){e.meta.field_details[q].show=!0,store.modelFor(e.meta.field_details[q].module.api_name+"_global")||store.registerModel(e.meta.field_details[q].module.api_name+"_global",{});for(var N=e.meta.field_details[q].fields.length,F=0;F<N;F++)store.addField(e.meta.field_details[q].module.api_name+"_global",e.meta.field_details[q].fields[F].api_name,Lyte.attr(Lyte.registeredMixins["crm-module-mixin"].getfieldattributeType(e.meta.field_details[q].fields[F])));if(void 0!==x[e.meta.field_details[q].module.api_name])x[e.meta.field_details[q].module.api_name]=store.pushPayload(e.meta.field_details[q].module.api_name+"_global",x[e.meta.field_details[q].module.api_name]);else{var w=void 0!==b[e.meta.field_details[q].module.api_name]?b[e.meta.field_details[q].module.api_name].module_name:void 0;void 0!==w&&(x[w]=store.pushPayload(e.meta.field_details[q].module.api_name+"_global",x[w]))}}}var A=this.getData("meta").field_details;D=A.length,Lyte.arrayUtils(A,"push",e.meta.field_details),v=A.length}if(this.data.meta.info.total_count===this.getData("currentTotalCount")&&!t.getData("retryMech"))return this.setData("isScrollResultToFetch",!1),this.setData("currentTotalCount",0),void commonUtils.showHideLoadingDiv(!1);var E=$L(".s_moduleSearchList")[0];E.scrollHeight===E.offsetHeight||void 0===e.meta.field_details||v%4!=0&&Math.ceil(D/4)===Math.ceil(v/4)?this.executeMethod("getRecords",Lyte.Router.getRouteInstance().getQueryParams()):(t.setData("isScrollResultToFetch",!0),commonUtils.showHideLoadingDiv(!1))}))}},getFieldObject:function(e){return"owned_by_me"===e.param?{comparator:"equal",field:{api_name:"Owned",id:"269840000000002623"},value:{name:Crm.userDetails.DISPLAY_NAME,id:Crm.userDetails.USER_ID}}:{comparator:"equal",field:{api_name:e.param,id:"269840000000002623"},value:e.value}},settingValuesForParams:function(e,t,a,o,i){(e&&e.length>0||t)&&(e&&e.length>0&&(o.searchword=e),Object.keys(a).length>0&&(o.criteria=JSON.stringify(a)),i&&""!==i&&(o.filter_by=i))},navigControl:function(e,t){var a=$L("crm-global-search-refine")[0].component,o=a.data.sysRefNameVsModuleDetailsMap[e].module_name,i=a.data.meta.info[e];t?(i.startIndex=i.startIndex+10,i.more_records=i.total_records_count>10*i.page,i.page=i.page+1):(i.startIndex=i.startIndex-10,i.page=i.page-1,i.more_records=!0);var r=crmNavig.NAVIGCACHEOBJ.globalSearch.data;const s=i.page-crmNavig.NAVIGCACHEOBJ.globalSearch.dropCount[o]-1;if(r&&r[o]&&s>=0&&s<20&&r[o][s]){a.executeMethod("storeAddFieldAndPayload",a,e,o,a.data);var l=store.pushPayload(e+"_global",r[o][s]);Lyte.Component.set(a.data.values,o,l),Lyte.Component.set(a.data.meta.info,e,i),a.setData("flag",!a.data.flag)}else a.methods.fetchRecords(a,e,t?"next":"previous")},clearFilterAndSearch:function(e,t){e.setData("columnListOpenedModules",[]),e.setData("searchStarted",!0);var a=$L("crux-smart-filter")[0].component;a.resetFields(),e.setData("refineCriteria",{}),this.setSmartFilterCriteria(t.getData("appliedTags")),a.getFilterCriteria().queryParams&&e.setData("refineCriteria",JSON.stringify(a.getFilterCriteria().queryParams.filters));var o=$L("crm-global-search-refine")[0].component,i=o.getData("filteredModules");if(o.setData("filteredModules",[]),o.setData("filteredModules",i),o.getData("isRelevance")?o.setData("selectedSort","relevance"):(o.setData("selectedSort","modifiedTime"),o.setData("isRelevance",!1)),e.renderSecondaryResults(),o.getData("isFilterDirty")){var r=$L("#applyBtn")[0];r.ltProp("disabled")||(e.methods.resetDisableFilter(e),r.ltProp("disabled",!0))}$L(".searchInputBox").focus(),e.setData("searchStarted",!1)},storeAddFieldAndPayload:function(e,t,a,o){var i=e.data.meta.field_details;if(void 0!==i)for(var r=i.length,s=0;s<r;s++)if(t===i[s].module.api_name){store.modelFor(i[s].module.api_name+"_global")||store.registerModel(i[s].module.api_name+"_global",{});for(var l=i[s].fields.length,n=0;n<l;n++)store.addField(i[s].module.api_name+"_global",i[s].fields[n].api_name,Lyte.attr(Lyte.registeredMixins["crm-module-mixin"].getfieldattributeType(i[s].fields[n])));e.data.values[a]=store.pushPayload(i[s].module.api_name+"_global",o)}},deleteRecordsReloadView:function(e,t,a){var o=moduleRecordMapping[a].api_name,i=e.data.meta.info[o].page;if(1===crmNavig.NAVIGCACHEOBJ.globalSearch.data[a][i-1].length&&1!==i){e.methods.navigControl(o,!1);var r=$L.extend(!0,{},e.data.meta.info[o]);return r.total_records_count-=1,void Lyte.objectUtils(e.data.meta.info,"add",o,r)}var s,l,n=1===i?11:10,p={},c=$L("crm-global-search-input")[0].component,d=c.getData("appliedTags"),u={};d.length>0&&d.filter((function(e){if("owned_by_me"===e.param||"shared_with_me"===e.param)l=void 0===l?e.param:"owned_and_shared_with_me";else{var t=e.value;if(t&&""!==t){var a=e.param;u[a]=t}}}));var m=d.length>0;c.setData("isTagsEnabled",m);var g=c.getData("isTagsEnabled");s=c.criteriaFormationForRequest(g,u);var h=c.getData("searchInputText");return this.settingValuesForParams(h,g,s,p,l),Object.keys(e.data.refineCriteria).length>0&&(p.refineCriteria=JSON.stringify(e.refineCriteria)),p.per_page=n,p.page=i,p.isRelevance=t.getQueryParams().isRelevance,p.modules=o,p.isNavig=!0,commonUtils.showHideLoadingDiv(!0),store.findAll("global-search",p,!1,!1).then((function(t){if(void 0!==t.data&&0!==t.data.length){$L("crm-global-search-refine")[0].component.methods.storeAddFieldAndPayload(e,o,a,t.data),Lyte.Component.set(e.data.values,a,t.data.slice(0,10));var r=$L.extend(!0,{},e.data.meta.info[o]),s=t.meta.info.records_count[0];r.count=s.count,r.more_records=s.more_records,r.page=s.page,r.per_page=s.per_page,r.total_records_count-=1,Lyte.objectUtils(e.data.meta.info,"add",o,r);var l=t.data.length;if(t.data)for(var n of t.data)n.hasOwnProperty("Territories")&&null!==n.Territories&&(n.Territories=n.Territories.map((e=>e.Name)).join(", ")),n.cxPropClass="cgsRfTableRow";if(l>0){var p=t.data.slice(0,10);crmNavig.NAVIGCACHEOBJ.globalSearch.data[a][i-1]=p,crmNavig.NAVIGCACHEOBJ.globalSearch.data[a].splice(i)}if(void 0!==t.meta.field_details){store.modelFor(t.meta.field_details[0].module.api_name+"_global")||store.registerModel(t.meta.field_details[0].module.api_name+"_global",{});for(var c=t.meta.field_details[0].fields.length,d=0;d<c;d++)store.addField(t.meta.field_details[0].module.api_name+"_global",t.meta.field_details[0].fields[d].api_name,Lyte.attr(Lyte.registeredMixins["crm-module-mixin"].getfieldattributeType(t.meta.field_details[0].fields[d])));t.data=store.pushPayload(t.meta.field_details[0].module.api_name+"_global",t.data)}e.setData("flag",!e.data.flag),commonUtils.showHideLoadingDiv(!1)}else for(var u=e.data.meta.field_details,m=u.length,g=0;g<m;g++)if(u[g].module.api_name===o){Lyte.arrayUtils(e.data.meta.field_details,"removeAt",g,1),commonUtils.showHideLoadingDiv(!1);break}})).catch((()=>{var e=this.data.meta.info[o];e.startIndex="next"===dir?e.startIndex-10:e.startIndex+10}))},fetchRecords:function(e,t,a){var o,i=e.data.sysRefNameVsModuleDetailsMap[t].module_name,r=e.data.meta.info[t];if(o=r.hasOwnProperty(t)?r[t].more_records:r.more_records){var s,l=r.page,n={},p=$L("crm-global-search-input")[0].component,c=p.getData("requestMade"),d=p.getData("appliedTags"),u={},m={};if(!c){d.length>0&&d.filter((function(e){if("owned_by_me"===e.param||"shared_with_me"===e.param)s=void 0===s?e.param:"owned_and_shared_with_me";else{var t=e.value;if(t&&""!==t){var a=e.param;m[a]=t}}}));var g=d.length>0;p.setData("isTagsEnabled",g);var h=p.getData("isTagsEnabled");u=p.criteriaFormationForRequest(h,m);var y=p.getData("searchInputText");this.settingValuesForParams(y,h,u,n,s)}var f=$L("crm-global-search-refine")[0].component.data;return Object.keys(f.refineCriteria).length>0&&(n.refineCriteria=JSON.stringify(f.refineCriteria)),n.per_page=10,n.page=l,n.isRelevance=Lyte.Router.getRouteInstance().getQueryParams().isRelevance,"AllModules"!==t&&(n.modules=t),n.isNavig=!0,commonUtils.showHideLoadingDiv(!0),store.findAll("global-search",n,!1,!1).then((function(o){$L("crm-global-search-refine")[0].component.methods.storeAddFieldAndPayload(e,t,i,o.data),Lyte.Component.set(e.data.values,i,o.data);var r=e.data.meta.info[t],s=o.meta.info.records_count[0];r.count=s.count,r.more_records=s.more_records,r.page=s.page,r.per_page=s.per_page,Lyte.Component.set(e.data.meta.info,t,r);var n=o.data.length;if(o.data)for(var p of o.data)p.hasOwnProperty("Territories")&&null!==p.Territories&&(p.Territories=p.Territories.map((e=>e.Name)).join(", ")),p.cxPropClass="cgsRfTableRow";var c=0;if("next"!==a)for(var d=0;d<n;d+=10){var u=o.data.slice(d,d+10);crmNavig.NAVIGCACHEOBJ.globalSearch.data[i]=[u].concat(crmNavig.NAVIGCACHEOBJ.globalSearch.data[i]),c++}else for(d=0;d<n;d+=10){u=o.data.slice(d,d+10);crmNavig.NAVIGCACHEOBJ.globalSearch.data[i][l-crmNavig.NAVIGCACHEOBJ.globalSearch.dropCount[i]-1+c]=u,c++}if(void 0!==o.meta.field_details){store.modelFor(o.meta.field_details[0].module.api_name+"_global")||store.registerModel(o.meta.field_details[0].module.api_name+"_global",{});for(var m=o.meta.field_details[0].fields.length,g=0;g<m;g++)store.addField(o.meta.field_details[0].module.api_name+"_global",o.meta.field_details[0].fields[g].api_name,Lyte.attr(Lyte.registeredMixins["crm-module-mixin"].getfieldattributeType(o.meta.field_details[0].fields[g])));o.data=store.pushPayload(o.meta.field_details[0].module.api_name+"_global",o.data)}if(e.setData("flag",!e.data.flag),commonUtils.showHideLoadingDiv(!1),crmNavig.NAVIGCACHEOBJ.globalSearch.data[i].length>20){const e=crmNavig.NAVIGCACHEOBJ.globalSearch.data[i];"next"===a?(e.splice(0,1),crmNavig.NAVIGCACHEOBJ.globalSearch.data[i]=e,crmNavig.NAVIGCACHEOBJ.globalSearch.dropCount[i]+=1):(e.splice(20,1),crmNavig.NAVIGCACHEOBJ.globalSearch.data[i]=[...e],crmNavig.NAVIGCACHEOBJ.globalSearch.dropCount[i]-=1)}})).catch((()=>{let o=this.data;o||(o=e.data);var i=o.meta.info[t];i.startIndex="next"===a?i.startIndex-10:i.startIndex+10,commonUtils.showHideLoadingDiv(!1)}))}return o},handleOnSortSelect:function(e,t){"modifiedTime"===t&&!this.getData("isRelevance")||"relevance"===t&&this.getData("isRelevance")?e.preventDefault():("relevance"===t&&Crm.client_tracking("Global Search New UI - Relevance sorting applied"),this.applySort(t))},closePopOver:function(){this.actions.closeColumnList()},filterThisModule:function(e){const t=$L("crm-global-search-refine")[0].component;var a=t.getData("refineFilterDisable")||t.getData("valueChangeDisable"),o=Lyte.Router.getRouteInstance().getQueryParams().modules,i=o&&"AllModules"!==o?o.split(","):"",r=i.length,s=!1;if(e.length!==r)s=!0;else for(var l of e)if(!i.includes(l.api_name)){s=!0;break}const n=$L("#refineFilter")[0].component,p=Object.keys(t.getData("refineCriteria")).length===n.getSelectedFields().length&&0===n.getSelectedFields().length,c=t.getData("filteredModules").length===e.length&&0===e.length;p&&c?t.setData("isFilterDirty",!1):t.setData("isFilterDirty",!0),t.setData("refineModuleDisable",s),t.methods.buttonOrClearChange(t,a||s)},buttonOrClearChange:function(e,t){if(e.getData("isFilterDirty")){$L("#applyBtn")[0].ltProp("disabled",!t);var a=$L("#clearBtn")[0];a.ltProp("disabled")&&a.ltProp("disabled",!(0!==$L(".moduleFilterList")[0].component.getSelectedFields().length||0!==$L("#refineFilter")[0].component.getSelectedFields().length||!e.getData("isRelevance")))}},mergeFilterToAllModules:function(e,t){var a=[...e];return t.forEach((e=>{a.some((t=>t.id===e.id))||a.push(e)})),a},setConditions:function(e){return"date"===e.type?this.getData("cxPropCriteriaCondition").date:e.condition},fieldChange:function(e){var t=$L("crm-global-search-refine")[0].component,a=t.getData("refineModuleDisable")||t.getData("valueChangeDisable"),o=t.getData("refineCriteria"),i=!1;if((o=void 0===o.field&&void 0===o.group?[]:void 0===o.group?[o]:o.group).length!==e.length)i=!0;else{var r=[];for(var s of o)r.push(s.field.api_name);for(var l of e)if(!r.includes(l.api_name)){i=!0;break}}t.setData("refineFilterDisable",i);const n=$L(".moduleFilterList")[0].component,p=Object.keys(t.getData("refineCriteria")).length===e.length&&0===e.length,c=t.getData("filteredModules").length===n.getSelectedFields().length&&0===n.getSelectedFields().length;p&&c?t.setData("isFilterDirty",!1):t.setData("isFilterDirty",!0),t.methods.buttonOrClearChange(t,a||i),t.refineSearchScrollCalc()},valueChange:function(){var e=$L("crm-global-search-refine")[0].component;e.setData({valueChangeDisable:!0,isFilterDirty:!0}),e.methods.buttonOrClearChange(e,!0)}}},{mixins:["crm-mass-action-mixin","crm-global-search-mixin"]});
