var speedBenchmarkStart = +new Date();function ReplaceWith(e){var t=this.parentNode,r=arguments.length,o=+(t&&"object"==typeof e);if(t){for(;r-- >o;)t&&"object"!=typeof arguments[r]&&(arguments[r]=document.createTextNode(arguments[r])),t||!arguments[r].parentNode?t.insertBefore(this.previousSibling,arguments[r]):arguments[r].parentNode.removeChild(arguments[r]);o&&t.replaceChild(this,e)}}window.DOMPurifyCopy=window.DOMPurify?window.DOMPurify:void 0,function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ZWAF=t()}(this,(function(){function e(e,t,r,o,i,n,a){if(o||!(t in e))return Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),1}catch(e){return}}()?(i=!0===i,n=!0===n,a=!0===a,Object.defineProperty(e,t,{value:r,writable:i,configurable:n,enumerable:a})):(e[t]=r,e)}function t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var r=(function(e,r,o){r&&t(e.prototype,r)}(o,[{key:"debug",value:function(){var e;if(window&&window.console&&this.level!==this.LEVELS.NONE&&this.level===this.LEVELS.DEBUG){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(e=window.console).debug.apply(e,r.concat([performance.now()]))}}},{key:"info",value:function(){var e;if(window&&window.console&&this.level!==this.LEVELS.NONE&&!(this.level>this.LEVELS.INFO)){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(e=window.console).log.apply(e,r.concat([performance.now()]))}}},{key:"warn",value:function(){var e;if(window&&window.console&&this.level!==this.LEVELS.NONE&&!(this.level>this.LEVELS.WARN)){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(e=window.console).warn.apply(e,r.concat([performance.now()]))}}},{key:"error",value:function(){var e;if(window&&window.console&&this.level!==this.LEVELS.NONE&&!(this.level>this.LEVELS.ERROR)){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(e=window.console).error.apply(e,r.concat([performance.now()]))}}}]),o);function o(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.LEVELS={NONE:-1,DEBUG:0,INFO:1,WARN:2,ERROR:3},e===this.LEVELS.NONE||e===this.LEVELS.DEBUG||e===this.LEVELS.INFO||e===this.LEVELS.WARN||e===this.LEVELS.ERROR?this.level=e:this.level=this.LEVELS.ERROR}var i=window&&window.ZWAF?window.ZWAF:{version:"7.0.0"},n=new r;i.defineProperty||(i.defineProperty=e),i.logger||(i.logger=n),i["7_0_0"]||(i["7_0_0"]={version:"7.0.0",defineProperty:e,logger:n});var a=!1;r={log:function(){if(window&&window.console&&window.console.log&&window.navigator&&window.navigator.userAgent&&!a){var e=window.navigator.userAgent.match(/opera|chrome|safari|firefox|msie|trident(?=\/)/i);if(a=!0,e&&e[0].search(/trident|msie/i)<0)return window.console.log("%cSTOP!","color:red;font-size:xx-large;font-weight:bold;"),void window.console.log("%cThis is a browser feature intended for developers. Do not enter or paste code which you don't understand. It may allow attackers to steal your information or impersonate you.\nSee https://en.wikipedia.org/wiki/Self-XSS for more details","font-size:large;");window.console.log("STOP!\nThis is a browser feature intended for developers. Do not enter or paste code which you don't understand. It may allow attackers to steal your information or impersonate you.\nSee https://en.wikipedia.org/wiki/Self-XSS for more details")}}};function s(e,t){if(e instanceof Object)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function l(e,t){var r;(r=Array.prototype.splice).call.apply(r,[e,e.length,0].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(t)))}function d(e,t){if(!e||e.constructor===Object)return e;for(var r={},o=0;o<e.length;o++){var i=e[o];r[i[t]]=i}return r}function c(e){if(e&&e.constructor===String)return e.toLowerCase();if(e.constructor===Array)for(var t=0;t<e.length;t++)e[t]=c(e[t]);return e}function p(e,t,r,o){if(Array.isArray(e))for(var i=0,n=e.length;i<n;i++)u(e,t,i,r);else for(var a in e)o&&-1!==o.indexOf(a)||u(e,t,a,r);return t}function u(e,t,r,o){var i;o?(i=e[r],Array.isArray(i)?(t[r]||(t[r]=[]),p(i,t[r],o)):i instanceof Object?(t[r]||(t[r]={}),p(i,t[r],o)):t[r]=i):t[r]=e[r]}function f(e,t,r){var o=2<arguments.length&&void 0!==r?r:{};o=Object.assign({path:"/",SameSite:"lax","max-age":864e7},o);if(encodeURIComponent){var i,n=encodeURIComponent(e)+"="+encodeURIComponent(t);for(i in o){n+="; "+i;var a=o[i];!0!==a&&(n+="="+a)}document.cookie=n}}function h(e,t){f(e,"",{path:1<arguments.length&&void 0!==t?t:"/","max-age":-1})}"7.0.0"!==i.version||i.Console||i.defineProperty(i,"Console",r,!0,!1,!1,!0),i["7_0_0"].Console||i.defineProperty(i["7_0_0"],"Console",r,!0,!1,!1,!0),["_zcsr_tmp","com_chat_owner","com_avcliq_owner","wms.agent"].some((function(e){return!!function(e){e+="=";var t=document.cookie,r=void 0;return t.split("; ").forEach((function(t){if(void 0===r){var o=void 0;try{decodeURIComponent&&(o=decodeURIComponent(t))}catch(e){o=t,ZWAF&&ZWAF.logger&&ZWAF.logger.warn&&ZWAF.logger.warn("Error while trying to decode Cookie value!")}0===o.indexOf(e)&&(r=o.substring(e.length))}})),r}(e)}))&&i&&i["7_0_0"]&&i["7_0_0"].Console&&i["7_0_0"].Console.log();var m="_zwaf_ua";n={init:function(){h(m);var e=!!window.ulaa,t=navigator&&navigator.brave&&"function"==typeof navigator.brave.isBrave;e?f(m,"Ulaa"):t?f(m,"Brave"):window&&window.addEventListener("load",(function(){window.setTimeout((function(){window.getComputedStyle(window.document.documentElement).getPropertyValue("--arc-palette-background")&&f(m,"Arc")}),1e3)}))},disable:function(){h(m)}};"7.0.0"!==i.version||i.UAIdentification||i.defineProperty(i,"UAIdentification",n,!0,!1,!1,!0),i["7_0_0"].UAIdentification||i.defineProperty(i["7_0_0"],"UAIdentification",n,!0,!1,!1,!0),i&&i["7_0_0"]&&i["7_0_0"].UAIdentification&&i["7_0_0"].UAIdentification.init();var y,_=Object.hasOwnProperty,v=Object.setPrototypeOf,g=Object.isFrozen,b=Object.getPrototypeOf,A=Object.getOwnPropertyDescriptor,$=Object.freeze,L=(r=Object.seal,Object.create),E=(n="undefined"!=typeof Reflect&&Reflect,(E=n.apply)||function(e,t,r){return e.apply(t,r)}),R=($=$||function(e){return e},r=r||function(e){return e},(R=n.construct)||function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(t))))}),w=M(Array.prototype.forEach),N=M(Array.prototype.pop),P=M(Array.prototype.push),C=M(String.prototype.toLowerCase),O=M(String.prototype.toString),T=M(String.prototype.match),S=M(String.prototype.replace),k=M(String.prototype.indexOf),x=M(String.prototype.trim),D=M(RegExp.prototype.test),j=(y=TypeError,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return R(y,t)});function I(e){return"number"==typeof e&&isNaN(e)}function M(e){return function(t){for(var r=arguments.length,o=Array(1<r?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return E(e,t,o)}}function B(e,t,r){r=r||C,v&&v(e,null);for(var o=t.length;o--;){var i,n=t[o];"string"!=typeof n||(i=r(n))!==n&&(g(t)||(t[o]=i),n=i),e[n]=!0}return e}function F(e){var t=L(null),r=void 0;for(r in e)!0===E(_,e,[r])&&(t[r]=e[r]);return t}function K(e,t){for(;null!==e;){var r=A(e,t);if(r){if(r.get)return M(r.get);if("function"==typeof r.value)return M(r.value)}e=b(e)}return function(e){return null}}var H=$(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),V=$(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),z=$(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),q=$(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),U=$(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),W=$(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),G=$(["#text"]),Y=$(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),J=$(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Q=$(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),X=$(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Z=r(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ee=r(/<%[\w\W]*|[\w\W]*%>/gm),te=r(/\${[\w\W]*}/gm),re=r(/^data-[\-\w.\u00B7-\uFFFF]/),oe=r(/^aria-[\-\w]+$/),ie=r(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ne=r(/^(?:\w+script|data):/i),ae=r(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),se=r(/^html$/i),le=r(/^[a-z][.\w]*(-[.\w]+)+$/i),de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function ce(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var pe=function(){return"undefined"==typeof window?null:window},ue=function(e,t){if("object"!==(void 0===e?"undefined":de(e))||"function"!=typeof e.createPolicy)return null;var r=null,o="data-tt-policy-suffix";r="dompurify"+((r=t.currentScript&&t.currentScript.hasAttribute(o)?t.currentScript.getAttribute(o):r)?"#"+r:"");try{return e.createPolicy(r,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return null}},fe=(n=function e(t){function r(t){return e(t)}var o=0<arguments.length&&void 0!==t?t:pe();if(r.version="2.5.4",r.removed=[],!o||!o.document||9!==o.document.nodeType)return r.isSupported=!1,r;var i=o.document,n=o.document,a=o.DocumentFragment,s=o.HTMLTemplateElement,l=o.Node,d=o.Element,c=o.NodeFilter,p=void 0===(t=o.NamedNodeMap)?o.NamedNodeMap||o.MozNamedAttrMap:t,u=o.HTMLFormElement,f=o.DOMParser,h=o.trustedTypes,m=K(t=d.prototype,"cloneNode"),y=K(t,"nextSibling"),_=K(t,"childNodes"),v=K(t,"parentNode");"function"!=typeof s||(fe=n.createElement("template")).content&&fe.content.ownerDocument&&(n=fe.content.ownerDocument);var g=ue(h,i),b=g?g.createHTML(""):"",A=(fe=n).implementation,L=fe.createNodeIterator,E=fe.createDocumentFragment,R=fe.getElementsByTagName,M=i.importNode,fe={};try{fe=F(n).documentMode?n.documentMode:{}}catch(t){}var he={};function me(e){return e instanceof RegExp||e instanceof Function}function ye(e){ft&&ft===e||(e=F(e=e&&"object"===(void 0===e?"undefined":de(e))?e:{}),ct=-1===pt.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,ut="application/xhtml+xml"===ct?O:C,Ne="ALLOWED_TAGS"in e?B({},e.ALLOWED_TAGS,ut):Pe,Oe="ALLOWED_ATTR"in e?B({},e.ALLOWED_ATTR,ut):Te,lt="ALLOWED_NAMESPACES"in e?B({},e.ALLOWED_NAMESPACES,O):dt,tt="ADD_URI_SAFE_ATTR"in e?B(F(rt),e.ADD_URI_SAFE_ATTR,ut):rt,Ze="ADD_DATA_URI_TAGS"in e?B(F(et),e.ADD_DATA_URI_TAGS,ut):et,Qe="FORBID_CONTENTS"in e?B({},e.FORBID_CONTENTS,ut):Xe,ke="FORBID_TAGS"in e?B({},e.FORBID_TAGS,ut):{},xe="FORBID_ATTR"in e?B({},e.FORBID_ATTR,ut):{},_e="USE_PROFILES"in e&&e.USE_PROFILES,De=!1!==e.ALLOW_ARIA_ATTR,je=!1!==e.ALLOW_DATA_ATTR,Ie=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Me=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Be=e.SAFE_FOR_TEMPLATES||!1,Fe=!1!==e.SAFE_FOR_XML,Ke=e.WHOLE_DOCUMENT||!1,ze=e.RETURN_DOM||!1,qe=e.RETURN_DOM_FRAGMENT||!1,Ue=e.RETURN_TRUSTED_TYPE||!1,Ce=!1!==e.DONT_TRIM,Ve=e.FORCE_BODY||!1,We=!1!==e.SANITIZE_DOM,Ge=e.SANITIZE_NAMED_PROPS||!1,Ye=!1!==e.KEEP_CONTENT,Je=e.IN_PLACE||!1,we=e.ALLOWED_URI_REGEXP||we,at=e.NAMESPACE||nt,Se=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&me(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Se.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&me(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Se.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Se.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Be&&(je=!1),qe&&(ze=!0),_e&&(Ne=B({},[].concat(ce(G))),Oe=[],!0===_e.html&&(B(Ne,H),B(Oe,Y)),!0===_e.svg&&(B(Ne,V),B(Oe,J),B(Oe,X)),!0===_e.svgFilters&&(B(Ne,z),B(Oe,J),B(Oe,X)),!0===_e.mathMl&&(B(Ne,U),B(Oe,Q),B(Oe,X))),e.ADD_TAGS&&B(Ne=Ne===Pe?F(Ne):Ne,e.ADD_TAGS,ut),e.ADD_ATTR&&B(Oe=Oe===Te?F(Oe):Oe,e.ADD_ATTR,ut),e.ADD_URI_SAFE_ATTR&&B(tt,e.ADD_URI_SAFE_ATTR,ut),e.FORBID_CONTENTS&&B(Qe=Qe===Xe?F(Qe):Qe,e.FORBID_CONTENTS,ut),Ye&&(Ne["#text"]=!0),Ke&&B(Ne,["html","head","body"]),Ne.table&&(B(Ne,["tbody"]),delete ke.tbody),$&&$(e),ft=e)}r.isSupported="function"==typeof v&&A&&void 0!==A.createHTMLDocument&&9!==fe;var _e,ve=Z,ge=ee,be=te,Ae=re,$e=oe,Le=ne,Ee=ae,Re=le,we=ie,Ne=null,Pe=B({},[].concat(ce(H),ce(V),ce(z),ce(U),ce(G))),Ce=!0,Oe=null,Te=B({},[].concat(ce(Y),ce(J),ce(Q),ce(X))),Se=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ke=null,xe=null,De=!0,je=!0,Ie=!1,Me=!0,Be=!1,Fe=!0,Ke=!1,He=!1,Ve=!1,ze=!1,qe=!1,Ue=!1,We=!0,Ge=!1,Ye=!0,Je=!1,Qe=null,Xe=B({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ze=null,et=B({},["audio","video","img","source","image","track"]),tt=null,rt=B({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ot="http://www.w3.org/1998/Math/MathML",it="http://www.w3.org/2000/svg",nt="http://www.w3.org/1999/xhtml",at=nt,st=!1,lt=null,dt=B({},[ot,it,nt],O),ct=void 0,pt=["application/xhtml+xml","text/html"],ut=void 0,ft=null,ht=n.createElement("form"),mt=B({},["mi","mo","mn","ms","mtext"]),yt=B({},["foreignobject","annotation-xml"]),_t=B({},["title","style","font","a","script"]),vt=B({},V);B(vt,z),B(vt,q);var gt=B({},U);function bt(e){P(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=b}catch(t){e.remove()}}}function At(e,t){try{P(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){P(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Oe[e])if(ze||qe)try{bt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}}function $t(e){var t=void 0,r=void 0;Ve?e="<remove></remove>"+e:r=(o=T(e,/^[\r\n\t ]+/))&&o[0],"application/xhtml+xml"===ct&&at===nt&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var o=g?g.createHTML(e):e;if(at===nt)try{t=(new f).parseFromString(o,ct)}catch(e){}if(!t||!t.documentElement){t=A.createDocument(at,"template",null);try{t.documentElement.innerHTML=st?b:o}catch(e){}}return o=t.body||t.documentElement,e&&r&&o.insertBefore(n.createTextNode(r),o.childNodes[0]||null),at===nt?R.call(t,Ke?"html":"body")[0]:Ke?t.documentElement:o}function Lt(e){return L.call(e.ownerDocument||e,e,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null,!1)}function Et(e){return e instanceof u&&(void 0!==e.__depth&&"number"!=typeof e.__depth||void 0!==e.__removalCount&&"number"!=typeof e.__removalCount||"string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof p)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)}function Rt(e){return"object"===(void 0===l?"undefined":de(l))?e instanceof l:e&&"object"===(void 0===e?"undefined":de(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName}function wt(e,t,o){he[e]&&w(he[e],(function(e){e.call(r,t,o,ft)}))}function Nt(e){var t;if(wt("beforeSanitizeElements",e,null),Et(e))return bt(e),1;if(D(/[\u0080-\uFFFF]/,e.nodeName))return bt(e),1;var o=ut(e.nodeName);if(wt("uponSanitizeElement",e,{tagName:o,allowedTags:Ne}),e.hasChildNodes()&&!Rt(e.firstElementChild)&&(!Rt(e.content)||!Rt(e.content.firstElementChild))&&D(/<[/\w]/g,e.innerHTML)&&D(/<[/\w]/g,e.textContent))return bt(e),1;if("select"===o&&D(/<template/i,e.innerHTML))return bt(e),1;if(7===e.nodeType)return bt(e),1;if(Fe&&8===e.nodeType&&D(/<[/\w]/g,e.data))return bt(e),1;if(Ne[o]&&!ke[o])return e instanceof d&&!function(e){var t=v(e);t&&t.tagName||(t={namespaceURI:at,tagName:"template"});var r=C(e.tagName),o=C(t.tagName);return lt[e.namespaceURI]&&(e.namespaceURI===it?t.namespaceURI===nt?"svg"===r:t.namespaceURI===ot?"svg"===r&&("annotation-xml"===o||mt[o]):Boolean(vt[r]):e.namespaceURI===ot?t.namespaceURI===nt?"math"===r:t.namespaceURI===it?"math"===r&&yt[o]:Boolean(gt[r]):e.namespaceURI===nt?(t.namespaceURI!==it||yt[o])&&(t.namespaceURI!==ot||mt[o])&&!gt[r]&&(_t[r]||!vt[r]):"application/xhtml+xml"===ct&&lt[e.namespaceURI])}(e)||("noscript"===o||"noembed"===o||"noframes"===o)&&D(/<\/no(script|embed|frames)/i,e.innerHTML)?(bt(e),1):(Be&&3===e.nodeType&&(t=e.textContent,t=S(t,ve," "),t=S(t,ge," "),t=S(t,be," "),e.textContent!==t&&(P(r.removed,{element:e.cloneNode()}),e.textContent=t)),wt("afterSanitizeElements",e,null),0);if(!ke[o]&&Tt(o)){if(Se.tagNameCheck instanceof RegExp&&D(Se.tagNameCheck,o))return;if(Se.tagNameCheck instanceof Function&&Se.tagNameCheck(o))return}if(Ye&&!Qe[o]){var i=v(e)||e.parentNode,n=_(e)||e.childNodes;if(n&&i)for(var a=n.length-1;0<=a;--a){var s=m(n[a],!0);s.__removalCount=(e.__removalCount||0)+1,i.insertBefore(s,y(e))}}return bt(e),1}function Pt(e,t,r){if(We&&("id"===t||"name"===t)&&(r in n||r in ht||"__depth"===r||"__removalCount"===r))return!1;if((!je||xe[t]||!D(Ae,t))&&(!De||!D($e,t)))if(!Oe[t]||xe[t]){if(!(Tt(e)&&(Se.tagNameCheck instanceof RegExp&&D(Se.tagNameCheck,e)||Se.tagNameCheck instanceof Function&&Se.tagNameCheck(e))&&(Se.attributeNameCheck instanceof RegExp&&D(Se.attributeNameCheck,t)||Se.attributeNameCheck instanceof Function&&Se.attributeNameCheck(t))||"is"===t&&Se.allowCustomizedBuiltInElements&&(Se.tagNameCheck instanceof RegExp&&D(Se.tagNameCheck,r)||Se.tagNameCheck instanceof Function&&Se.tagNameCheck(r))))return!1}else if(!tt[t]&&!D(we,S(r,Ee,""))&&("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==k(r,"data:")||!Ze[e])&&(!Ie||D(Le,S(r,Ee,"")))&&r)return!1;return!0}function Ct(e){var t,o=void 0,i=void 0,n=void 0;wt("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Oe,nodeName:e.nodeName.toLowerCase()};for(n=a.length;n--;){var l=(o=a[n]).name,d=o.namespaceURI;i="value"===l?o.value:x(o.value);if(Ce&&(i=o.value),t=ut(l),s.attrName=t,s.attrValue=i,s.keepAttr=!0,s.keepElement=!0,s.forceKeepAttr=void 0,wt("uponSanitizeAttribute",e,s),!s.keepElement)return 1;if(i=s.attrValue,!s.forceKeepAttr&&(At(l,e),s.keepAttr))if(Me||!D(/\/>/i,i))if(Fe&&D(/((--!?|])>)|<\/(style|title)/i,i))At(l,e);else{Be&&(i=S(i,ve," "),i=S(i,ge," "),i=S(i,be," "));var c=e.nodeName.toLowerCase();if(Pt(c,t,i)){if(!Ge||"id"!==t&&"name"!==t||(At(l,e),i="user-content-"+i),g&&"object"===(void 0===h?"undefined":de(h))&&"function"==typeof h.getAttributeType&&!d)switch(h.getAttributeType(c,t)){case"TrustedHTML":i=g.createHTML(i);break;case"TrustedScriptURL":i=g.createScriptURL(i)}try{d?e.setAttributeNS(d,l,i):e.setAttribute(l,i),Et(e)?bt(e):N(r.removed)}catch(e){}}}else At(l,e)}return wt("afterSanitizeAttributes",e,null),0}}function Ot(e){var t,r=void 0,o=Lt(e);for(wt("beforeSanitizeShadowDOM",e,null);r=o.nextNode();)wt("uponSanitizeShadowNode",r,null),Nt(r)||(t=v(r),1===r.nodeType&&(t&&t.__depth?r.__depth=(r.__removalCount||0)+t.__depth+1:r.__depth=1),(255<=r.__depth||I(r.__depth))&&bt(r),r.content instanceof a&&(r.content.__depth=r.__depth,Ot(r.content)),Ct(r)&&bt(r));wt("afterSanitizeShadowDOM",e,null)}B(gt,W);var Tt=function(e){return"annotation-xml"!==e&&T(e,Re)};return r.sanitize=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=void 0,s=void 0,d=void 0,c=void 0;if("string"!=typeof(e=(st=!e)?"\x3c!--\x3e":e)&&!Rt(e)){if("function"!=typeof e.toString)throw j("toString is not a function");if("string"!=typeof(e=e.toString()))throw j("dirty is not a string, aborting")}if(!r.isSupported){if("object"===de(o.toStaticHTML)||"function"==typeof o.toStaticHTML){if("string"==typeof e)return o.toStaticHTML(e);if(Rt(e))return o.toStaticHTML(e.outerHTML)}return e}if(He||ye(t),r.removed=[],Je="string"!=typeof e&&Je){if(e.nodeName&&(t=ut(e.nodeName),!Ne[t]||ke[t]))throw j("root node is forbidden and cannot be sanitized in-place")}else if(e instanceof l)1===(t=(n=$t("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===t.nodeName||"HTML"===t.nodeName?n=t:n.appendChild(t);else{if(!ze&&!Be&&!Ke&&-1===e.indexOf("<"))return g&&Ue?g.createHTML(e):e;if(!(n=$t(e)))return ze?null:Ue?b:""}n&&Ve&&bt(n.firstChild);for(var p,u=Lt(Je?e:n);s=u.nextNode();)3===s.nodeType&&s===d||Nt(s)||(p=v(s),1===s.nodeType&&(p&&p.__depth?s.__depth=(s.__removalCount||0)+p.__depth+1:s.__depth=1),(255<=s.__depth||I(s.__depth))&&bt(s),s.content instanceof a&&(s.content.__depth=s.__depth,Ot(s.content)),Ct(s)?bt(s):d=s);if(d=null,Je)return e;if(ze){if(qe)for(c=E.call(n.ownerDocument);n.firstChild;)c.appendChild(n.firstChild);else c=n;return Oe.shadowroot||Oe.shadowrootmod?M.call(i,c,!0):c}return e=Ke?n.outerHTML:n.innerHTML,Ke&&Ne["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&D(se,n.ownerDocument.doctype.name)&&(e="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+e),Be&&(e=S(e,ve," "),e=S(e,ge," "),e=S(e,be," ")),g&&Ue?g.createHTML(e):e},r.setConfig=function(e){ye(e),He=!0},r.clearConfig=function(){ft=null,He=!1},r.isValidAttribute=function(e,t,r){return ft||ye({}),Pt(e=C(e),t=C(t),r)},r.addHook=function(e,t){"function"==typeof t&&(he[e]=he[e]||[],P(he[e],t))},r.removeHook=function(e){if(he[e])return N(he[e])},r.removeHooks=function(e){he[e]&&(he[e]=[])},r.removeAllHooks=function(){he={}},r}(),(Object.seal||function(e){return e})(/\$\{[A-Z._]+?\}/i));function he(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var me=Object.freeze;return(r={FORCE_BODY:!0,ALLOWED_URI_REGEXP:!1,REUSE_CONFIG:!1,REMOVE_ONEVENTS:!0,EXTENDS:["GLOBAL_TAGS","GLOBAL_ATTR","FORBID_TAGS","FORBID_ATTR","TAG_RULES","GLOBAL_ATTR_RULES","GLOBAL_APPEND_ATTR","ADD_DATA_URI_TAGS","ADD_URI_SAFE_ATTR"],ALLOWED_STYLE:"NONE",STYLE_RULES:{FORBID_PROPS:[],FORBID_CSSRULES:[],UNSAFE_PROP_RULES:{}}}).GLOBAL_TAGS="a|abbr|acronym|address|area|article|aside|audio|b|bdi|bdo|big|blink|blockquote|body|br|button|canvas|caption|center|cite|code|col|colgroup|content|data|datalist|dd|decorator|del|details|dfn|dir|div|dl|dt|element|em|fieldset|figcaption|figure|font|footer|form|h1|h2|h3|h4|h5|h6|head|header|hgroup|hr|html|i|img|input|ins|kbd|label|legend|li|main|map|mark|marquee|menu|menuitem|meter|nav|nobr|ol|optgroup|option|output|p|pre|progress|q|rp|rt|ruby|s|samp|section|select|shadow|small|source|spacer|span|strike|strong|sub|summary|sup|table|tbody|td|template|textarea|tfoot|th|thead|time|title|tr|track|tt|u|ul|var|video|wbr|#text".split("|"),r.GLOBAL_ATTR="accept|action|align|alt|autocomplete|background|bgcolor|border|cellpadding|cellspacing|checked|cite|class|clear|color|cols|colspan|coords|datetime|default|dir|disabled|download|enctype|face|for|headers|height|hidden|high|href|hreflang|id|ismap|label|lang|list|loop|low|max|maxlength|media|method|min|multiple|name|noshade|novalidate|nowrap|open|optimum|pattern|placeholder|poster|preload|pubdate|radiogroup|readonly|rel|required|rev|reversed|role|rows|rowspan|spellcheck|scope|selected|shape|size|span|srclang|start|src|step|summary|tabindex|title|target|type|usemap|valign|value|width|xmlns|sandbox".split("|"),r.FORBID_TAGS=[],r.FORBID_ATTR=[],r.GLOBAL_ATTR_RULES={},r.GLOBAL_APPEND_ATTR={},r.ADD_DATA_URI_TAGS=[],r.ADD_URI_SAFE_ATTR=[],r.TAG_RULES={a:{APPEND_ATTR:{rel:{ATTR_NAME:"rel",APPEND_ATTR_VALUE:"noopener noreferrer",SIBLING_CONDITIONS:[{ATTR_NAME:"target",CONDITIONS:[{IS_MANDATORY:"true",CONTAINS:"_blank"}]}]}}}},r.TAG_SPECIFIC_ATTRS={},n=function e(t,r){var o="GLOBAL_TAGS",i="GLOBAL_ATTR",n="GLOBAL_ATTRIBUTES",a="FORBID_TAGS",u="FORBID_ATTR",f="TAG_RULES",h="STYLE_RULES",m="GLOBAL_ATTR_RULES",y="GLOBAL_APPEND_ATTR",_="ADD_DATA_URI_TAGS",v="ADD_URI_SAFE_ATTR",g="REMOVE_ONEVENTS",b=["ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","SAFE_FOR_TEMPLATES","WHOLE_DOCUMENT","RETURN_DOM","RETURN_DOM_FRAGMENT","IN_PLACE","DONT_TRIM","FORCE_BODY","SANITIZE_DOM","KEEP_CONTENT","ALLOWED_URI_REGEXP"],A=[];l(A,b),l(A,["EXTENDS",g,"ALLOWED_STYLE"]);var $={iframe:{ATTR_RULES:{sandbox:{FALLBACK_VALUE:"allow-popups allow-forms allow-scripts allow-same-origin",CONDITIONS:[{NOT_CONTAINS:["allow-top-navigation","allow-popups-to-escape-sandbox"]}]}},APPEND_ATTR:{sandbox:{APPEND_ATTR_VALUE:"allow-popups allow-forms allow-scripts allow-same-origin"}}},embed:{ATTR_RULES:{type:{CONDITIONS:[{EQUAL:"application/pdf",FALLBACK_VALUE:"application/pdf"}]}},APPEND_ATTR:{type:{APPEND_ATTR_VALUE:"application/pdf"},typemustmatch:{APPEND_ATTR_VALUE:"true"}}},object:{ATTR_RULES:{type:{CONDITIONS:[{EQUAL:"application/pdf",FALLBACK_VALUE:"application/pdf"}]}},APPEND_ATTR:{type:{APPEND_ATTR_VALUE:"application/pdf"},typemustmatch:{APPEND_ATTR_VALUE:"true"}}}},L=void 0,E=void 0,R=void 0,w=t.GLOBAL_TAGS,N=t.GLOBAL_ATTR,P=t.FORBID_TAGS,C=t.FORBID_ATTR,O=t.TAG_RULES,T=t.STYLE_RULES,S=t.GLOBAL_ATTR_RULES,k=t.GLOBAL_APPEND_ATTR,x=t.TAG_SPECIFIC_ATTRS,D=T.FORBID_PROPS,j=T.FORBID_CSSRULES,I=T.UNSAFE_PROP_RULES,M=D&&0!==D.length||j&&0!==j.length;function B(e,t,r){if(e.constructor===String){if(t.CASE_SENSITIVE||(e=e.toLowerCase()),t.DONT_TRIM||(e=e.trim()),t.MAX_LENGTH&&e.length>t.MAX_LENGTH)return!1;if(t.MIN_LENGTH&&e.length<t.MIN_LENGTH)return!1;if(t.REGEX&&t.REGEX.constructor===RegExp&&-1===e.search(t.REGEX))return!1;if(t.REGEX&&t.REGEX.constructor===String&&(new RegExp(t.REGEX),-1===e.search(t.REGEX)))return!1;if(t.REGEX&&t.REGEX.constructor===Array)for(var o=0;o<t.REGEX.length;o++)if(-1===e.search(t.REGEX[o]))return!1;if(t.VALIDATOR&&t.VALIDATOR.HANDLER&&!t.VALIDATOR.HANDLER(e,t.VALIDATOR.CONFIG,r))return!1;if(void 0!==t.STARTS_WITH&&0!==e.indexOf(t.STARTS_WITH))return!1;if(void 0!==t.ENDS_WITH&&e.lastIndexOf(t.ENDS_WITH)!==e.length-t.ENDS_WITH.length)return!1;if(t.CONTAINS&&t.CONTAINS.constructor===String&&-1===e.indexOf(t.CONTAINS))return!1;if(t.CONTAINS&&t.CONTAINS.constructor===Array)for(var i=0;i<t.CONTAINS.length;i++)if(-1===e.indexOf(t.CONTAINS[i]))return!1;if(t.NOT_CONTAINS&&t.NOT_CONTAINS.constructor===String&&-1<e.indexOf(t.NOT_CONTAINS))return!1;if(t.NOT_CONTAINS&&t.NOT_CONTAINS.constructor===Array)for(var n=0;n<t.NOT_CONTAINS.length;n++)if(-1<e.indexOf(t.NOT_CONTAINS[n]))return!1;if(void 0!==t.EQUAL&&e!=t.EQUAL)return!1;if(void 0!==t.NOT_EQUAL&&e==t.NOT_EQUAL)return!1}if(t.LIST&&-1===t.LIST.indexOf(e))return!1;if("INTEGER"===t.TYPE||"FLOAT"===t.TYPE){r=void 0;try{r="INTEGER"===t.TYPE?window.parseInt(e,10):window.parseFloat(e)}catch(e){return!1}if(window.isNaN(r))return!1;if(void 0!==t.GREATER_THAN&&r<=t.GREATER_THAN)return!1;if(void 0!==t.GREATER_THAN_OR_EQUAL&&r<t.GREATER_THAN_OR_EQUAL)return!1;if(void 0!==t.LESSER_THAN&&r>=t.LESSER_THAN)return!1;if(void 0!==t.LESSER_THAN_OR_EQUAL&&r>t.LESSER_THAN_OR_EQUAL)return!1;if(void 0!==t.EQUAL&&r!==t.EQUAL)return!1;if(void 0!==t.NOT_EQUAL&&r===t.NOT_EQUAL)return!1}return!0}function F(e,t,r){var o=!0;if(!t||!t.CONDITIONS||0===t.CONDITIONS.length)return{isValid:o,rule:t};r=t.ATTR_NAME||r;for(var i,n,a,s,l=0;l<t.CONDITIONS.length;l++){var d=t.CONDITIONS[l];if(i=e,n=r,void 0,s=!1!==(a=d).IS_MANDATORY,o=n&&!i.hasAttribute(n.toLowerCase())?a.IS_FORBIDDEN||!s:!a.IS_FORBIDDEN&&B(i=null==(i=i.getAttribute(n.toLowerCase()))?"":i,a,n),o=d.NEGATION?!o:o){if(d.NEXT)return F(e,d.NEXT,r);break}}return{isValid:o,rule:t}}function K(e){s(e,(function(t,r){if(r&&r.constructor===String&&(0<D.length&&-1<D.indexOf(t)&&(e[t]="",L=!0),I[t]))for(var o=I[t],i=0;i<o.CONDITIONS.length;i++)if(B(r,o.CONDITIONS[i],t))return e[t]=void 0===o.FALLBACK_VALUE?"":o.FALLBACK_VALUE,L=!0,0}))}function H(e){if(e&&(e.CONDITIONS&&0<e.CONDITIONS.length&&(e.CONDITIONS=function(e){if(!e)return e;for(var t=0;t<e.length;t++)e[t]=function(e){if(!e||e&&e.CASE_SENSITIVE)return e;for(var t=["STARTS_WITH","ENDS_WITH","CONTAINS","EQUAL","NOT_EQUAL","LIST"],r=0;r<t.length;r++){var o=t[r];e[o]&&(e[o]=c(e[o]))}return e.NEXT&&H(e.NEXT),e}(e[t]);return e}(e.CONDITIONS)),e.SIBLING_CONDITIONS&&0<e.SIBLING_CONDITIONS.length))for(var t=0;t<e.SIBLING_CONDITIONS.length;t++)H(e.SIBLING_CONDITIONS[t])}function V(g){return e(g=function(e){if(!e||e.constructor!==Object)return p(t,e={},!0),e;e[f]||(e[f]={}),e[m]||(e[m]={}),e[y]||(e[y]={}),e[_]||(e[_]=[]),e[v]||(e[v]=[]),e[o]||(e[o]=[]),e[i]||(e[i]=[]),e[n]||(e[n]=[]),e[a]||(e[a]=[]),e[u]||(e[u]=[]),e[h]||(e[h]={}),e[h].FORBID_CSSRULES||(e[h].FORBID_CSSRULES=[]),e[h].FORBID_PROPS||(e[h].FORBID_PROPS=[]),e[h].UNSAFE_PROP_RULES||(e[h].UNSAFE_PROP_RULES={}),e.TAG_SPECIFIC_ATTRS={};for(var r=0;r<A.length;r++){var g=A[r];void 0===e[g]&&(e[g]=t[g])}e[f]=d(e[f],"NAME"),e[m]=d(e[m],"ATTR_NAME"),e[y]=d(e[y],"APPEND_ATTR_NAME");var b=e,$=b.TAG_RULES,L=b.TAG_SPECIFIC_ATTRS,E=b.STYLE_RULES,R=b.GLOBAL_ATTR,w=b.GLOBAL_ATTRIBUTES,P=b.GLOBAL_ATTR_RULES,C=b.GLOBAL_APPEND_ATTR,T=b.EXTENDS,S=E.FORBID_CSSRULES,k=E.FORBID_PROPS,M=E.UNSAFE_PROP_RULES;s(C,(function(e,t){H(t)})),s(P,(function(e,t){H(t)}));for(var B=function(r){var n,d,c=T[r];switch(c){case i:var g=[];l(g,N),s(x,(function(e){-1<(e=g.indexOf(e))&&g.splice(e,1)})),l(R,w),l(R,g);break;case o:case a:case u:case _:case v:l(e[c],t[c]);break;case f:n=$,(d=O)&&d.constructor===Object&&s(d,(function(e,t){e in n?(void 0===n[e].APPEND_ATTR&&(n[e].APPEND_ATTR=t.APPEND_ATTR),void 0===n[e].ATTR_RULES&&(n[e].ATTR_RULES=t.ATTR_RULES)):n[e]=t}));break;case y:case m:s(t[c],(function(r){e[c][r]||(e[c][r]={},p(t[c][r],e[c][r],!0))}));break;case h:k.push.apply(k,he(D)),S.push.apply(S,he(j)),s(I,(function(e){M[e]||(M[e]={},p(I[e],M[e],!0))}))}},F=0;F<T.length;F++)B(F);return s(P,(function(e){-1===R.indexOf(e)&&(R.push(e),L[e]&&L[e].constructor===Array||(L[e]=[]),-1===L[e].indexOf("*")&&L[e].push("*"))})),s($,(function(e,t){e=c(e),t.APPEND_ATTR||(t.APPEND_ATTR={}),t.APPEND_ATTR=d(t.APPEND_ATTR,"APPEND_ATTR_NAME"),s(t.APPEND_ATTR,(function(e,t){H(t)})),t.ATTR_RULES||(t.ATTR_RULES={}),t.ATTR_RULES=d(t.ATTR_RULES,"ATTR_NAME"),s(t.ATTR_RULES,(function(t,r){H(r),t=c(t),(-1===R.indexOf(t)||L[t]&&0<L[t].length)&&(-1===R.indexOf(t)&&R.push(t),L[t]&&L[t].constructor===Array||(L[t]=[]),-1===L[t].indexOf(e)&&L[t].push(e))}))})),delete e.USE_PROFILES,e}(g),r(window))}return M||s(I,(function(){M=!0})),V.sanitize=function(e,o){return o=function(e){if(!e||e.constructor!==Object)return t;var r={};return s(t,(function(t,o){t in e&&-1!==b.indexOf(t)&&(!0===e[t]||!1===e[t]||e[t]&&e[t].constructor===RegExp)?r[t]=e[t]:r[t]=o})),r.SAFE_FOR_TEMPLATES&&(r.ALLOW_DATA_ATTR=!1),r.RETURN_DOM_FRAGMENT&&(r.RETURN_DOM=!0),r.KEEP_CONTENT&&r.GLOBAL_TAGS.push("#text"),r.ADD_TAGS&&delete r.ADD_TAGS,r.ADD_ATTR&&delete r.ADD_ATTR,r}(o),e=r.sanitize(e,o),(o=V.removed).splice.apply(o,[0,V.removed.length].concat(he(r.removed))),e},l(P,["script"]),l(C,[]),T=t.ALLOWED_STYLE,r.removeAllHooks(),L=!1,-1===P.indexOf("style")&&P.push("style"),-1===C.indexOf("style")&&C.push("style"),"INLINE"!==T&&"ALL"!==T||(C.splice(C.indexOf("style"),1),-1===N.indexOf("style")&&N.push("style"),M&&r.addHook("uponSanitizeAttribute",(function(e,t){var r,o;"style"===t.attrName&&(e.ownerDocument.baseURI||((o=(r=window.document).createElement("base")).href=r.baseURI,e.ownerDocument.head.appendChild(o)),L=!1,K(e.style),0!==(o=e.style.cssText).length?t.attrValue=L?o:e.getAttribute("style"):t.keepAttr=!1)}))),"INTERNAL"!==T&&"ALL"!==T||(P.splice(P.indexOf("style"),1),-1===w.indexOf("style")&&w.push("style"),M&&r.addHook("uponSanitizeElement",(function(e,t){var r;"style"===t.tagName&&null!==e.sheet&&(r=e.sheet.cssRules,L=!1,function e(t,r){for(var o=t.length-1;0<=o;o--){var i=t[o];0<j.length&&-1<j.indexOf(i.type)?(r.deleteRule(o),L=!0):1===i.type&&i.selectorText||8===i.type&&i.keyText?i.style&&K(i.style):4!==i.type&&7!==i.type&&12!==i.type||!i.cssRules||e(i.cssRules,i)}}(r,e.sheet),L&&(function(e,t){for(var r=t.length-1;0<=r;r--)1!==t[r].type&&3!==t[r].type&&4!==t[r].type&&7!==t[r].type&&12!==t[r].type||e.push(t[r].cssText)}(t=[],r),e.textContent=t.join("\n")))}))),(S||O)&&(E={},s($,(function(e,t){E[e]={},s(t.ATTR_RULES,(function(t,r){return E[e][t]=r}))})),s(E,(function(e,t){s(S,(function(t,r){return E[e][t]=r}))})),s(O,(function(e,t){E[e]||(E[e]={}),s(t.ATTR_RULES,(function(t,r){return E[e][t]=r}))})),r.addHook("uponSanitizeAttribute",(function(e,t){var r,o,i=E[t.nodeName]&&E[t.nodeName][t.attrName]||S&&S[t.attrName];i&&(o=(r=F(e,i,t.attrName)).isValid,(i=r.rule)&&i.FORCE_KEEP_ATTR&&(t.forceKeepAttr=!0),o||(r=e,o=t,"REMOVE_ELEMENT"!==(e=i).ACTION?void 0!==e.FALLBACK_VALUE?(t=e.FALLBACK_VALUE,(i=fe.exec(e.FALLBACK_VALUE))&&(r=r.getAttribute(e.ATTR_NAME),"${ZWAF.URL_COMPONENT}"===i[0]&&(r=window.encodeURIComponent(r)),t=e.FALLBACK_VALUE.replace(i[0],r)),ne.test(t.replace(ae,""))?o.keepAttr=!1:o.attrValue=t):o.keepAttr=!1:o.keepElement=!1))}))),(k||O)&&(R={},s($,(function(e,t){R[e]={},s(t.APPEND_ATTR,(function(t,r){return R[e][t]=r}))})),s(R,(function(e,t){s(S,(function(t,r){return R[e][t]=r}))})),s(O,(function(e,t){R[e]||(R[e]={}),s(t.APPEND_ATTR,(function(t,r){return R[e][t]=r}))})),r.addHook("afterSanitizeAttributes",(function(e){var t,r=e.nodeName.toLowerCase(),o={};s(k,(function(e,t){return o[e]=t})),s(R[r],(function(e,t){return o[e]=t})),t=e,s(o,(function(e,r){if(!t.hasAttribute(e.toLowerCase()))if(r.SIBLING_CONDITIONS&&0!=r.SIBLING_CONDITIONS.length)for(var o=0;o<r.SIBLING_CONDITIONS.length;o++){var i=(n=F(t,r.SIBLING_CONDITIONS[o])).isValid,n=n.rule;if(i)return n=(void 0!==n.APPEND_ATTR_VALUE?n:r).APPEND_ATTR_VALUE,t.setAttribute(e,n),0}else t.setAttribute(e,r.APPEND_ATTR_VALUE)}))}))),t[g]&&r.addHook("uponSanitizeAttribute",(function(e,t){0===t.attrName.indexOf("on")&&(t.keepAttr=!1)})),x&&r.addHook("uponSanitizeAttribute",(function(e,t){x[t.attrName]&&-1===x[t.attrName].indexOf(t.nodeName)&&-1===x[t.attrName].indexOf("*")&&(t.keepAttr=!1)})),t.ALLOWED_TAGS=w,t.ALLOWED_ATTR=N,t.GLOBAL_ATTRIBUTES=N,t&&!t.REUSE_CONFIG&&me&&me(t),V.isSupported=r.isSupported,V.version=r.version,V.removed=[],V}(r,n),me&&me(n),delete window.DOMPurify,"7.0.0"!==i.version||i.HTMLPurifier||i.defineProperty(i,"HTMLPurifier",n,!0,!1,!1,!0),i["7_0_0"].HTMLPurifier||i.defineProperty(i["7_0_0"],"HTMLPurifier",n,!0,!1,!1,!0),i})),window.DOMPurifyCopy&&(window.DOMPurify=window.DOMPurifyCopy,window.DOMPurifyCopy=void 0),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ZWAF=t()}(this,(function(){function e(e,t,r,o,i,n,a){if(o||!(t in e))return Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),1}catch(e){return}}()?(i=!0===i,n=!0===n,a=!0===a,Object.defineProperty(e,t,{value:r,writable:i,configurable:n,enumerable:a})):(e[t]=r,e)}var t,r,o=(o=String.prototype.codePointAt)||function(e){if(null===this)throw new TypeError(" ");var t=String(this),r=t.length,o=e?Number(e):0;if(!((o=window.isNan(o)?0:o)<0||r<=o)){var i=t.charCodeAt(o);e=void 0;return 55296<=i&&i<=56319&&o+1<r&&56320<=(e=t.charCodeAt(o+1))&&e<=57343?1024*(i-55296)+e-56320+65536:i}},i=String.fromCodePoint;function n(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}i||(t=String.fromCharCode,r=Math.floor,i=function(){for(var e=[],o=arguments.length,i=Array(o),n=0;n<o;n++)i[n]=arguments[n];var a=i.length,s=-1;if(!a)return"";for(var l="";++s<a;){var d=Number(i[s]);if(!isFinite(d)||d<0||1114111<d||r(d)!==d)throw new RangeError("Invalid code point: "+d);d<=65535?e.push(d):(d-=65536,e.push(55296+(d>>10),d%1024+56320)),(s+1===a||16384<e.length)&&(l+=t.apply(void 0,e),e.length=0)}return l});var a=(function(e,t,r){t&&n(e.prototype,t)}(s,[{key:"debug",value:function(){var e;if(window&&window.console&&this.level!==this.LEVELS.NONE&&this.level===this.LEVELS.DEBUG){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(e=window.console).debug.apply(e,r.concat([performance.now()]))}}},{key:"info",value:function(){var e;if(window&&window.console&&this.level!==this.LEVELS.NONE&&!(this.level>this.LEVELS.INFO)){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(e=window.console).log.apply(e,r.concat([performance.now()]))}}},{key:"warn",value:function(){var e;if(window&&window.console&&this.level!==this.LEVELS.NONE&&!(this.level>this.LEVELS.WARN)){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(e=window.console).warn.apply(e,r.concat([performance.now()]))}}},{key:"error",value:function(){var e;if(window&&window.console&&this.level!==this.LEVELS.NONE&&!(this.level>this.LEVELS.ERROR)){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];(e=window.console).error.apply(e,r.concat([performance.now()]))}}}]),s);function s(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.LEVELS={NONE:-1,DEBUG:0,INFO:1,WARN:2,ERROR:3},e===this.LEVELS.NONE||e===this.LEVELS.DEBUG||e===this.LEVELS.INFO||e===this.LEVELS.WARN||e===this.LEVELS.ERROR?this.level=e:this.level=this.LEVELS.ERROR}var l=window&&window.ZWAF?window.ZWAF:{version:"7.0.0"},d=new a;l.defineProperty||(l.defineProperty=e),l.logger||(l.logger=d),l["7_0_0"]||(l["7_0_0"]={version:"7.0.0",defineProperty:e,logger:d});var c=!1;a={log:function(){if(window&&window.console&&window.console.log&&window.navigator&&window.navigator.userAgent&&!c){var e=window.navigator.userAgent.match(/opera|chrome|safari|firefox|msie|trident(?=\/)/i);if(c=!0,e&&e[0].search(/trident|msie/i)<0)return window.console.log("%cSTOP!","color:red;font-size:xx-large;font-weight:bold;"),void window.console.log("%cThis is a browser feature intended for developers. Do not enter or paste code which you don't understand. It may allow attackers to steal your information or impersonate you.\nSee https://en.wikipedia.org/wiki/Self-XSS for more details","font-size:large;");window.console.log("STOP!\nThis is a browser feature intended for developers. Do not enter or paste code which you don't understand. It may allow attackers to steal your information or impersonate you.\nSee https://en.wikipedia.org/wiki/Self-XSS for more details")}}};function p(e,t,r){var o=2<arguments.length&&void 0!==r?r:{};o=Object.assign({path:"/",SameSite:"lax","max-age":864e7},o);if(encodeURIComponent){var i,n=encodeURIComponent(e)+"="+encodeURIComponent(t);for(i in o){n+="; "+i;var a=o[i];!0!==a&&(n+="="+a)}document.cookie=n}}function u(e,t){p(e,"",{path:1<arguments.length&&void 0!==t?t:"/","max-age":-1})}d=Array.prototype.indexOf||function(e){if(null==this)throw new TypeError(" ");var t={},r=t.length>>>0;if(0==r)return-1;var o=0;if(0<(arguments.length<=1?0:arguments.length-1)&&(o=Number(arguments.length<=2?void 0:arguments[2]),isNaN(o)?o=0:0!==o&&o!==1/0&&o!==-1/0&&(o=(0<o||-1)*Math.floor(Math.abs(o)))),r<=o)return-1;for(var i=0<=o?o:Math.max(r-Math.abs(o),0);i<r;i++)if(i in t&&t.charAt(i)===e)return i;return-1},"7.0.0"!==l.version||l.Console||l.defineProperty(l,"Console",a,!0,!1,!1,!0),l["7_0_0"].Console||l.defineProperty(l["7_0_0"],"Console",a,!0,!1,!1,!0),["_zcsr_tmp","com_chat_owner","com_avcliq_owner","wms.agent"].some((function(e){return!!function(e){e+="=";var t=document.cookie,r=void 0;return t.split("; ").forEach((function(t){if(void 0===r){var o=void 0;try{decodeURIComponent&&(o=decodeURIComponent(t))}catch(e){o=t,ZWAF&&ZWAF.logger&&ZWAF.logger.warn&&ZWAF.logger.warn("Error while trying to decode Cookie value!")}0===o.indexOf(e)&&(r=o.substring(e.length))}})),r}(e)}))&&l&&l["7_0_0"]&&l["7_0_0"].Console&&l["7_0_0"].Console.log(),a={arrayIndexOf:d},Object.freeze&&Object.freeze(a),"7.0.0"!==l.version||l.util||l.defineProperty(l,"util",a,!0,!1,!1,!0),l["7_0_0"].util||l.defineProperty(l["7_0_0"],"util",a,!0,!1,!1,!0);var f="_zwaf_ua";d={init:function(){u(f);var e=!!window.ulaa,t=navigator&&navigator.brave&&"function"==typeof navigator.brave.isBrave;e?p(f,"Ulaa"):t?p(f,"Brave"):window&&window.addEventListener("load",(function(){window.setTimeout((function(){window.getComputedStyle(window.document.documentElement).getPropertyValue("--arc-palette-background")&&p(f,"Arc")}),1e3)}))},disable:function(){u(f)}};function h(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].charCodeAt(0));return t}"7.0.0"!==l.version||l.UAIdentification||l.defineProperty(l,"UAIdentification",d,!0,!1,!1,!0),l["7_0_0"].UAIdentification||l.defineProperty(l["7_0_0"],"UAIdentification",d,!0,!1,!1,!0),l&&l["7_0_0"]&&l["7_0_0"].UAIdentification&&l["7_0_0"].UAIdentification.init(),d={};for(var m=a.arrayIndexOf,y={HTML:h([",",".","-","_"," "]),HTMLATTR:h([",",".","-","_"]),CSS:h([]),JAVASCRIPT:h([",",".","_"])},_={},v=(v="34=&quot|38=&amp|60=&lt|62=&gt|160=&nbsp|161=&iexcl|162=&cent|163=&pound|164=&curren|165=&yen|166=&brvbar|167=&sect|168=&uml|169=&copy|170=&ordf|171=&laquo|172=&not|173=&shy|174=&reg|175=&macr|176=&deg|177=&plusmn|178=&sup2|179=&sup3|180=&acute|181=&micro|182=&para|183=&middot|184=&cedil|185=&sup1|186=&ordm|187=&raquo|188=&frac14|189=&frac12|190=&frac34|191=&iquest|192=&Agrave|193=&Aacute|194=&Acirc|195=&Atilde|196=&Auml|197=&Aring|198=&AElig|199=&Ccedil|200=&Egrave|201=&Eacute|202=&Ecirc|203=&Euml|204=&Igrave|205=&Iacute|206=&Icirc|207=&Iuml|208=&ETH|209=&Ntilde|210=&Ograve|211=&Oacute|212=&Ocirc|213=&Otilde|214=&Ouml|215=&times|216=&Oslash|217=&Ugrave|218=&Uacute|219=&Ucirc|220=&Uuml|221=&Yacute|222=&THORN|223=&szlig|224=&agrave|225=&aacute|226=&acirc|227=&atilde|228=&auml|229=&aring|230=&aelig|231=&ccedil|232=&egrave|233=&eacute|234=&ecirc|235=&euml|236=&igrave|237=&iacute|238=&icirc|239=&iuml|240=&eth|241=&ntilde|242=&ograve|243=&oacute|244=&ocirc|245=&otilde|246=&ouml|247=&divide|248=&oslash|249=&ugrave|250=&uacute|251=&ucirc|252=&uuml|253=&yacute|254=&thorn|255=&yuml|338=&OElig|339=&oelig|352=&Scaron|353=&scaron|376=&Yuml|402=&fnof|710=&circ|732=&tilde|913=&Alpha|914=&Beta|915=&Gamma|916=&Delta|917=&Epsilon|918=&Zeta|919=&Eta|920=&Theta|921=&Iota|922=&Kappa|923=&Lambda|924=&Mu|925=&Nu|926=&Xi|927=&Omicron|928=&Pi|929=&Rho|931=&Sigma|932=&Tau|933=&Upsilon|934=&Phi|935=&Chi|936=&Psi|937=&Omega|945=&alpha|946=&beta|947=&gamma|948=&delta|949=&epsilon|950=&zeta|951=&eta|952=&theta|953=&iota|954=&kappa|955=&lambda|956=&mu|957=&nu|958=&xi|959=&omicron|960=&pi|961=&rho|962=&sigmaf|963=&sigma|964=&tau|965=&upsilon|966=&phi|967=&chi|968=&psi|969=&omega|977=&thetasym|978=&upsih|982=&piv|8194=&ensp|8195=&emsp|8201=&thinsp|8204=&zwnj|8205=&zwj|8206=&lrm|8207=&rlm|8211=&ndash|8212=&mdash|8216=&lsquo|8217=&rsquo|8218=&sbquo|8220=&ldquo|8221=&rdquo|8222=&bdquo|8224=&dagger|8225=&Dagger|8226=&bull|8230=&hellip|8240=&permil|8242=&prime|8243=&Prime|8249=&lsaquo|8250=&rsaquo|8254=&oline|8260=&frasl|8364=&euro|8465=&image|8472=&weierp|8476=&real|8482=&trade|8501=&alefsym|8592=&larr|8593=&uarr|8594=&rarr|8595=&darr|8596=&harr|8629=&crarr|8656=&lArr|8657=&uArr|8658=&rArr|8659=&dArr|8660=&hArr|8704=&forall|8706=&part|8707=&exist|8709=&empty|8711=&nabla|8712=&isin|8713=&notin|8715=&ni|8719=&prod|8721=&sum|8722=&minus|8727=&lowast|8730=&radic|8733=&prop|8734=&infin|8736=&ang|8743=&and|8744=&or|8745=&cap|8746=&cup|8747=&int|8756=&there4|8764=&sim|8773=&cong|8776=&asymp|8800=&ne|8801=&equiv|8804=&le|8805=&ge|8834=&sub|8835=&sup|8836=&nsub|8838=&sube|8839=&supe|8853=&oplus|8855=&otimes|8869=&perp|8901=&sdot|8968=&lceil|8969=&rceil|8970=&lfloor|8971=&rfloor|10216=&lang|10217=&rang|9674=&loz|9824=&spades|9827=&clubs|9829=&hearts|9830=&diams").split("|"),g=0;g<v.length;g++){var b=v[g].split("=");_[b[0]]=b[1]}for(var A=[],$=0;$<255;$++)A[$]=48<=$&&$<=57||65<=$&&$<=90||97<=$&&$<=122?null:$.toString(16);function L(e){return e<256?A[e]:e.toString(16)}function E(e,t){return-1!==m.call(e,t)||null===(e=L(t))?i(t):t<=31&&9!=t&&10!=t&&13!=t||127<=t&&t<=159||32===t?"&#x20;":void 0!==(t=_[t])?t+";":"&#x"+e+";"}function R(e,t){return-1!==m.call(e,t)||null===L(t)?String.fromCharCode(t):(e=t.toString(16),t<256?"\\x"+"00".substr(e.length)+e.toUpperCase():"\\u"+"0000".substr(e.length)+e.toUpperCase())}function w(e,t){return-1!==m.call(e,t)||null===(e=L(t))?i(t):"\\"+e+" "}function N(e,t,r,i){if(null==t||"string"!=typeof t)return t;for(var n,a="",s=0;s<t.length;s++)i?(a+=r(e,n=o.call(t,s),i),65535<n&&s++):a+=r(e,t.charCodeAt(s));return a}return d.encodeForHTML=function(e){return N(y.HTML,e,E,!0)},d.encodeForHTMLAttribute=function(e){return N(y.HTMLATTR,e,E,!0)},d.encodeForJavaScript=function(e){return N(y.JAVASCRIPT,e,R,!1)},d.encodeForCSS=function(e){return N(y.CSS,e,w,!0)},Object.freeze&&Object.freeze(d),"7.0.0"!==l.version||l.Encoder||l.defineProperty(l,"Encoder",d,!0,!1,!1,!0),l["7_0_0"].Encoder||l.defineProperty(l["7_0_0"],"Encoder",d,!0,!1,!1,!0),l})),window.ZSEC=window.ZWAF,[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(e){e.hasOwnProperty("after")||Object.defineProperty(e,"after",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach((function(e){var r=e instanceof Node;t.appendChild(r?e:document.createTextNode(String(e)))})),this.parentNode.insertBefore(t,this.nextSibling)}})})),Element.prototype.replaceWith||(Element.prototype.replaceWith=ReplaceWith),CharacterData.prototype.replaceWith||(CharacterData.prototype.replaceWith=ReplaceWith),DocumentType.prototype.replaceWith||(DocumentType.prototype.replaceWith=ReplaceWith),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e});let _Lyte={version:"3.5.3",$:{consoleTime:[]},registeredMixins:{},registeredServices:{},requiredServices:{},toBeInjectedServices:{},_registeredComponents:{},_keywords:{component:["init","didConnect","didDestroy","constructor","onError","actions","methods","data"],adapter:["namespace","actionNamespace","host","withCredentials","buildURL","methodForRequest","headersForRequest","reloadRecord","reloadRecord","reloadAll","processRequest","parseResponse","parseRequest","super"],serializer:["normalize","normalizeResponse","serialize","serializeKey","deserializeKey","extractMeta","payloadKey","serializeRecord","normalizeRecord","super"],route:["getDependencies","getResources","beforeModel","model","afterModel","redirect","renderTemplate","afterRender","beforeExit","didDestroy","queryParams","title","routeName","component","parent","currentModel","forceFetch","setTitle","setQueryParams","getQueryParams","setDynamicParam","getDynamicParam","removeFromCache","refresh","transitionTo","replaceWith","actions"],is:function(e,t){var r=["component","adapter","serializer","route"];t&&(r=[t]);for(var o=r.length,i=0;i<o;i++){var n=this[r[i]];if(n)if(-1!=n.indexOf(e))return!0}return!1}},Mixin:{},Service:{},debug:!1,performance:!1,toBeRegistered:[],browser:{},registeredCustomComponent:{},Globals:{}};window.isLyteWidgetParent?(_widgetLyte=_Lyte,_Lyte.isWidgetBuild=!0,window.__lyteConfig.isWidgetBuild=!0):Lyte=_Lyte,function(e){var t=e.$.userAgent=window.userAgent=navigator.userAgent;if(t.match(/rv:11/)&&(e.browser.ie=!0,window.action=function(){}),t.match("Edge")){var r=createElement("div");r.innerHTML="<template><div>c</div></template>",r.querySelector("template").childNodes.length?e.browser.ie=!0:e.browser.edge=!0,r.remove()}e.Globals.set=function(t,r){e.Component.set(e.__gl,t,r)},e.Globals.get=function(t){return e.Component._get(e.__gl,t)},Object.defineProperty(e.Service,"__Lyte__",{value:e}),Object.defineProperty(e.Mixin,"__Lyte__",{value:e}),Object.defineProperty(e.$,"__Lyte__",{value:e}),e.Mixin.__Lyte__.requiredMixins={},e.oldProxy="undefined"!=typeof $Lt&&$Lt.oldProxy?$Lt.oldProxy:void 0,e.$.assetsDiv=document.createElement("div"),e.$.assetsDiv.setAttribute("id","lyteAssetsDiv"),e.assetsDivContainer=document.head,e.$.widgetWrapper=document.createElement("shadow-wrapper"),e.$.widgetWrapper.attachShadow({mode:"open"}),e.$.widgetWrapper.setAttribute("id","widgetWrapperDiv"),e.domContentLoaded=function(e){"complete"===document.readyState||"interactive"===document.readyState?e():window.addEventListener("DOMContentLoaded",(function(){e()}))},e.createApplication=function(t,r){r.init&&r.init.apply(e)},e.registerErrorCodes=function(t){Object.assign(e.errorCodes,t)},e.establishObserverBindings=function(t,r,o,i){var n=this,a=i&&r?i._fldGrps.JsonPathWatch:n.constructor._deepWatchProperties;r&&(n=r);for(var s=0;s<t.length;s++){for(var l=t[s].properties,d={},c=!1,p={},u=0;u<l.length;u++){var f,h=!1;if("string"==typeof l[u]){if(-1!=l[u].search(/^\$\./g)){var m,y=l[u].match(/[^\$.][^\.]*/g)[0];-1!=y.search(/\[[0-9*]\]/g)&&(y=y.split(/\[[0-9*]\]/g)[0]),null==a[y]&&(a[y]=[]),null==p[y]&&(p[y]=[]);var _="^\\$\\."+y+"\\.?";_=new RegExp(_),m=l[u].replace(_,"$."),a[y].includes(m)||a[y].push(m),p[y].includes(m)||p[y].push(m),y+=".*",d.hasOwnProperty(y)?c=!0:(f=e.getProperty.call(this,y,r,o),d[y]=!0,c=!1)}else if(-1!==l[u].indexOf(".[]"))h=!0,f=e.getProperty.call(this,l[u].substring(0,l[u].indexOf(".[]")),r,o);else{if(-1!==l[u].indexOf(".*")){var v=l[u].split(".")[0];if(!!!(!r&&this.component.__data[v]&&this.component.__data[v].watch||r&&i&&i.fieldList&&i.fieldList[v]&&i.fieldList[v].watch))continue}f=e.getProperty.call(this,l[u],r,o)}c||(f._observers||Object.defineProperty(f,"_observers",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),f._observers.add({callee:n,observer:t[s],isArrayObserver:h}))}else e.warn("ERR27",JSON.stringify(l[u]),t[s].fnName,this.tagName)}t[s].Jpath=p,d={}}},e.getProperty=function(e,t,r){let o=e.match(/([^[\].]+|\[\])/g),i=this;t?(i=r,r[o[0]]||(r[o[0]]={}),i=r[o[0]]):(i._properties[o[0]]||(i._properties[o[0]]={}),i=i._properties[o[0]]),Object.defineProperty(i,"_path",{enumerable:!1,value:o[0]});for(let e=1;e<o.length;e++)(o[e].startsWith("'")||o[e].startsWith('"'))&&(o[e]=o[e].substring(1,o[e].length-1)),i[o[e]]||(i[o[e]]={},Object.defineProperty(i[o[e]],"_path",{enumerable:!1,value:i._path+"."+o[e]})),i=i[o[e]];return i},e.getErrorMessage=function(t){var r=Array.from(arguments).slice(1);return e.errorCodes[t]?e.errorCodes[t].replace(/{(\d+)}/g,(function(e,t){return r[t]})):t},e.error=function(){var t=arguments[0],r=t.stack;t=r?t:Error(e.getErrorMessage.apply(e,arguments)),e.onerror&&e.onerror.call(this,t,arguments[1]),e.triggerEvent("error",t,arguments[1]);var o=t.stack&&-1==t.stack.indexOf(t.message);r&&!o&&(t=JSON.parse(JSON.stringify(t,Object.getOwnPropertyNames(t)))),arguments[1]?console.error(t.stack?o?t:t.stack:t.message,arguments[1]):console.error(t.stack?o?t:t.stack:t.message)},e.warn=function(){var t=arguments[0];t=t.stack?JSON.parse(JSON.stringify(t,Object.getOwnPropertyNames(t))):Error(e.getErrorMessage.apply(e,arguments)),console.warn(t.stack?-1!=t.stack.indexOf(t.message)?t.stack.replace("Error: ",""):t:t.message)};var o={},i=Function.prototype;function n(e){return e.match(/\.[a-zA-Z]+(?=\?|$)/)}function n(e){return e.match(/\.[a-zA-Z]+(?=\?|$)/)}i.on||(i.on=function(){return e.warn("'.on()' method with the argument '"+arguments[0]+"' cannot be executed outside component scope."),{type:"callBack",value:"observer"===this.type?this.value:this,properties:arguments,observes:"observer"===this.type?this:void 0}}),i.observes||(i.observes=function(){return e.warn("'.observes()' method with the arguments '"+arguments[0]+"' cannot be executed outside component scope."),{type:"observer",value:this,properties:arguments,on:e._onObj,lyteOn:e._onObj}}),i.computed||(i.computed=function(){return e.warn("'.computed()' method with the arguments '"+arguments[0]+"' cannot be executed outside component scope."),{type:"computed",value:this,properties:arguments}}),e._onObj=function(){return{type:"callBack",value:"observer"===this.type?this.value:this,properties:arguments,observes:"observer"===this.type?this:void 0}},e._observesObj=function(){return{type:"observer",value:this,properties:arguments,on:e._onObj,lyteOn:e._onObj}},e._computedObj=function(){return{type:"computed",value:this,properties:arguments}},e._preRegister=function(){e._actualFnProtoOn=Function.prototype.on,e._actualFnProtoObserves=Function.prototype.observes,e._actualFnProtoComputed=Function.prototype.computed;let t=Function.prototype;t.on=t.lyteOn=e._onObj,t.observes=t.lyteObserves=e._observesObj,t.computed=t.lyteComputed=e._computedObj},e._postRegister=function(){let t=Function.prototype;t.on=e._actualFnProtoOn,t.observes=e._actualFnProtoObserves,t.computed=e._actualFnProtoComputed},Object.defineProperty(e.Mixin,"register",{get:function(){return e._preRegister(),e.registerMixinWrapper},enumerable:!0}),e.registerMixinWrapper=function(){try{e.registerMixin.apply(e,arguments),e._postRegister()}catch(t){e._postRegister()}},e.registerMixin=function(t,r){var i;if(e.registeredMixins[t]=r,i=o[t])for(var n in i)e.$.requiredMixins[n](r,i[n],n)},e.Mixin.get=function(t){return e.registeredMixins[t]},e.Service.register=function(t,r){if(e.registeredServices.hasOwnProperty(t))e.warn("Service -"+t+" is already registered");else{if(!e._keywords.is(t)){var o=r;e.registeredServices[t]=o;var i=e.requiredServices[t];return i&&i.size&&i.forEach((function(i){var n=o;i.isGlobal&&(n=e.__gS[i.key]=e.__gS[i.key]||new r(i.data)),i.cB(n,i.key,i.name,t)})),o}e.warn("Service name-"+t+" should not be a keyword used in Lyte")}},e.Service.getInjected=function(t){if(e.__gS.hasOwnProperty(t))return e.__gS[t]},e.$.requiredServices=function(t,r,o,i,n,a,s){var l=e.requiredServices[r],d=l||(e.requiredServices[r]=new Map),c=e.$.genMapId(d);return d.set(c,{key:t,cB:o,type:i,name:n,serviceName:r,isGlobal:a,data:s}),r+"-"+c},e.$.lazyRegisterService=function(e,t){var r=t.scope,o=t.name,i=r[t.type][o];i&&(i[t.key]=e)},e.$.injectServices={},Object.defineProperty(e,"__gS",{value:{}}),e.injectServices=function(t){var r={};Array.isArray(t)||(t=[t]),t.forEach((function(t){if(t&&"object"==typeof t){var o=t.as,i=t.service,n=t.data;e._keywords.is(o)?e.warn("Service cannot be used in any keywords of Lyte."):e.toBeInjectedServices.hasOwnProperty(o)?e.warn("A service has already been injected in the key named, ",o):(e.toBeInjectedServices[o]=i,r[o]={service:i,data:n},e.registeredServices[i]&&(e.__gS[o]=new e.registeredServices[i](n)))}else"string"==typeof t?e.toBeInjectedServices.hasOwnProperty(t)?e.warn("A service has already been injected in the key named, ",t):(e.toBeInjectedServices[t]=t,r[t]={service:t},e.registeredServices[t]&&(e.__gS[t]=new e.registeredServices[t])):e.warn("Invalid data passed to injectServices",t)}));var o=e.$.injectServices;for(var i in o)for(var n in r)o[i](n,r[n].service,i,e.__gS[n],void 0,r[n].data)},e.$.genMapId=function(e){for(var t=Math.floor(1e10*Math.random()+1);e.get(t);)t=Math.floor(1e10*Math.random()+1);return t.toString()},e.$.toRemoveFromRequiredServices=function(t){var r=t.split("-"),o=r[r.length-1],i=o.length,n=t.substr(0,t.length-(i+1)),a=e.requiredServices[n];a&&a.delete(o)},e.toBeUsedServices=function(t){var r={},o=t.services;return o&&o.forEach((function(o){if("string"==typeof o)r[o]=o;else if(o&&"object"==typeof o){var i=o.as,n=o.service;e._keywords.is(i,t.type)?e.warn("Service cannot be used in any keywords of Lyte."):r[i]=n}})),r},e.extendService=function(t){var r,o=e.toBeUsedServices(t);for(var i in o)if(r=o[i],t.isGlobal&&e.__gS.hasOwnProperty(i)||!t.isGlobal&&e.registeredServices.hasOwnProperty(r)){var n=t.ins;t.isGlobal?e.__gS[i]:new e.registeredServices[r];Array.isArray(n)||(n=[t.ins]),n.forEach((function(o){o[i]=t.isGlobal?e.__gS[i]:new e.registeredServices[r]}))}else e.$.requiredServices(i,r,t.callback,t.type,t.name,t.isGlobal,t.data)},e.$.requiredMixins=function(e,t,r){var i=o[e]?o[e]:o[e]={};i[r]?i[r].push(t):i[r]=[t]},e.Mixin.exists=function(t){return!!e.registeredMixins[t]},e.log=function(t,r,o){e.debug&&(o?console.log("%c"+t,"color:"+o):console.log(t))},e.time=function(t){var r;e.performance&&(-1!=(r=e.$.consoleTime.indexOf(t))?(e.$.consoleTime.splice(r,1),console.timeEnd(t)):(e.$.consoleTime.push(t),console.time(t)))},e.isRecord=function(e){return!!(e&&e.$&&e.$.hasOwnProperty("isModified"))},e.isComponent=function(e){return!!(e&&e.$node&&e.__data)},e.$.reqFiles={},e.injectResources=function(t,r,o,i){var a=[],s=[];return r=r||function(){},o=o||function(){},new Promise((function(e,r){d(t,function(){i&&i.defer?(i.defer({injectJS:l,files:t,errorFiles:s}),e()):l(t,(function(){o(a,s),s.length?r(a,s):e(a,s)}))}.bind(this))}));function l(t,r,o){var i;function d(){0==++i&&r(a,s)}o=o||[],t?(Array.isArray(t)||(t=[t]),t.length||r(a,s),i=-t.length,t.forEach((function(t){if("string"==typeof t){var r=n(t);!r||".js"!=r&&".css"!=r||-1!=o.indexOf(t)?d():(o.push(t),function(t,r){var o=e.injectResources.respObj[t];if(e.injectResources.availableTags[t]&&"preload"!=e.injectResources.availableTags[t].tag.getAttribute("rel")){var i=e.injectResources.availableTags[t];"error"==i.type?s.push(i.event):a.push(i.event),r()}else{var l,d=n(t);".js"==d?((l=document.createElement("script")).setAttribute("type","text/javascript"),l.setAttribute("src",t)):".css"==d&&((l=document.createElement("link")).setAttribute("type","text/css"),l.setAttribute("rel","stylesheet"),l.setAttribute("href",t)),o.getAttributeNames().forEach((function(e){-1==["href","as","rel"].indexOf(e)&&l.setAttribute(e,o.getAttribute(e))})),delete e.injectResources.respObj[t],l.onerror=l.onload=function(o){"error"==o.type?s.push(o):a.push(o),e.injectResources.availableTags[t].tag.remove(),e.injectResources.availableTags[t]={tag:l,event:o,type:"error"==o.type?"error":"load"},r(),l.onerror=l.onload=void 0},e.$.assetsDiv.appendChild(l)}}(t,(function(){d()})))}else Array.isArray(t)?l(t,(function(){d()})):(i--,l(t.parent,(function(){l(t.child,(function(){d()})),d()})))}))):r(a,s)}function d(t,o){var i;function a(){0==++i&&o()}function s(t,r,o){delete e.$.reqFiles[t],o||(e.injectResources.availableTags[t]&&(e.injectResources.availableTags[t].tag.remove(),delete e.injectResources.respObj[t]),e.injectResources.availableTags[t]={tag:this,event:r,type:r.type})}t?(Array.isArray(t)||(t=[t]),t.length||o(),i=-t.length,t.forEach((function(t){"string"==typeof t?function(t,o,i){e.$.reqFiles[t]?e.$.reqFiles[t].push(i):(e.$.reqFiles[t]=[i],o&&"error"!=o.event.type?(-1!=e.removeFromCache.arr.indexOf(t)&&e.removeFromCache.arr.splice(e.removeFromCache.arr.indexOf(t),1),s.call(o.tag,t,o.event,!0),i()):function(t,o){var i,a=r.internal||{},s=n(t);if(a.file=t,null==s)return void e.error("Type of file is not specified in injectResources.");(i=document.createElement("link")).setAttribute("href",t),a.tag=i,".css"==s?i.setAttribute("as","style"):i.setAttribute("as","script");i.setAttribute("rel","preload"),i.onerror=i.onload=function(e){o.call(this,e),this.onerror=this.onload=void 0},e.triggerEvent("onBeforeInject",a),e.$.assetsDiv.appendChild(i)}(t,(function(o){e.injectResources.respObj[t]=this,e.$.reqFiles[t].forEach((function(e){e()})),s.call(this,t,o),r.call(this,o)})))}(t,e.injectResources.availableTags[t],(function(){a()})):Array.isArray(t)?new Promise((function(e){d(t,e)})).then((function(){a()})):(i--,new Promise((function(e){d(t.parent,e)})).then((function(){a()})),new Promise((function(e){d(t.child,e)})).then((function(){a()})))}))):o()}},e.injectResources.availableTags=[],e.injectResources.respObj=[],e.$.replaceOldInjectResource=function(){e.injectResources=function(t,r,o){var i=[],a=[];return r=r||function(){},o=o||function(){},new Promise((function(e){s(t,e)})).then((function(){o(i,a)}));function s(t,o){if(t){Array.isArray(t)||(t=[t]),t.length||o();var l=-t.length;t.forEach((function(t){"string"==typeof t?function(t,o,s){e.$.reqFiles[t]?e.$.reqFiles[t].push(s):(e.$.reqFiles[t]=[s],o&&"error"!=o.event.type?(-1!=e.removeFromCache.arr.indexOf(t)&&e.removeFromCache.arr.splice(e.removeFromCache.arr.indexOf(t),1),c.call(o.tag,o.event,!0),s()):function(t,o){var s={".js":"script",".css":"link"},l=n(t);if(tag=document.createElement(s[l]),!l)return void e.error("Type of file is not specified in injectResources.");".css"==l?(tag.setAttribute("href",t),tag.setAttribute("type","text/css"),tag.setAttribute("rel","stylesheet")):tag.setAttribute("src",t);tag.onerror=tag.onload=function(e){"error"==e.type?a.push(e):i.push(e),o&&o.call(this,e)};var d=r.internal||{};d.file=t,d.tag=tag,e.triggerEvent("onBeforeInject",d),e.$.assetsDiv.appendChild(tag)}(t,(function(o){e.$.reqFiles[t].forEach((function(e){e()})),c.call(this,o),r.call(this,o)})))}(t,e.injectResources.availableTags[t],(function(){d()})):Array.isArray(t)?new Promise((function(e){s(t,e)})).then((function(){d()})):new Promise((function(e){s(t.parent,e)})).then((function(){new Promise((function(e){s(t.child,e)})).then((function(){d()}))}))}))}else o();function d(){0==++l&&o()}function c(t,r){var o=this.getAttribute("src")||this.getAttribute("href");delete e.$.reqFiles[o],r||(e.injectResources.availableTags[o]&&e.injectResources.availableTags[o].tag.remove(),this.onerror=this.onload=void 0,e.injectResources.availableTags[o]={tag:this,event:{type:t.type}})}}},e.injectResources.availableTags=[],e.injectResources.respObj=[]},e.removeFromCache=function(t){e.removeFromCache.assign(t),e.removeFromCache.arr.length&&(e.removeFromCache.arr.forEach((function(t){e.injectResources.availableTags[t]&&(e.injectResources.availableTags[t].tag.remove(),delete e.injectResources.availableTags[t],delete e.injectResources.respObj[t])})),e.removeFromCache.arr=[])},e.removeFromCache.arr=[],e.removeFromCache.assign=function(t){t="*"==t?Object.keys(e.injectResources.availableTags):Array.isArray(t)?t:[t],e.removeFromCache.arr=e.removeFromCache.arr.concat(t)},e.$.prefetchSupport=!1;try{if(!e.browser.ie){var a=document.createElement("link");e.$.prefetchSupport=a.relList.supports("prefetch")&&a.relList.supports("preload")}}catch(e){}function s(){e.assetsDivContainer.appendChild(e.$.assetsDiv)}e.$.prefetchSupport||(console.log("Prefetch is not supported. Falling back to old implementation"),e.$.replaceOldInjectResource()),e.checkProperty=function(t,r,o,i,n,a,s,l,d){var c="extends";switch(t){case"type":if(e.Transform.hasOwnProperty(i)&&null!=r){var p=e.Transform[i],u=!0;if(Array.isArray(r)){if("array"!=e.Transform[i][c])return{code:"ERR03",message:e.errorCodes.ERR03,expected:i};p.hasOwnProperty("items")&&(u=e.checkProperty("items",r,o,p.items))}else if("object"==typeof r&&"object"==e.Transform[i][c]&&p.hasOwnProperty("properties"))u=e.checkProperty("properties",r,o,p.properties);else if(e.Transform[i][c]!=typeof r)return{code:"ERR03",message:e.errorCodes.ERR03,expected:i};if(!0!==u)return u}else if(null!=r)if(Array.isArray(r)){if("array"!=i)return{code:"ERR03",message:e.errorCodes.ERR03,expected:i}}else if(i!=typeof r)return{code:"ERR03",message:e.errorCodes.ERR03,expected:i};break;case"mandatory":let n=i;if("object"==typeof i&&d&&1==i.skipValidationOnInit&&(n=!1),n&&(null==r||null==r||""===r))return{code:"ERR02",message:e.errorCodes.ERR02};break;case"maximum":if("number"==typeof r&&r>i)return{code:"ERR04",message:e.errorCodes.ERR04,expected:i};break;case"minimum":if("number"==typeof r&&r<i)return{code:"ERR05",message:e.errorCodes.ERR05,expected:i};break;case"maxLength":case"maxItems":if(r&&r.length>i)return{code:"ERR06",message:e.errorCodes.ERR06,expected:i};break;case"minLength":case"minItems":if(r&&r.length<i)return{code:"ERR07",message:e.errorCodes.ERR07,expected:i};break;case"pattern":if("string"==typeof r&&!new RegExp(i).test(r))return{code:"ERR08",message:e.errorCodes.ERR08,expected:i};break;case"uniqueItems":if(Array.isArray(r)&&i)for(var f=[],h=0;h<r.length;h++){var m=r[h];if(-1!=f.indexOf(m))return{code:"ERR09",message:e.errorCodes.ERR09};f.push(m)}break;case"constant":if(Array.isArray(r)){var y=r.length==i.length&&r.every((function(e,t){return e===i[t]}));if(!y)return{code:"ERR10",message:e.errorCodes.ERR10,expected:i}}else if("object"==typeof r){if(!(y=store.adapter.$.compareObjects(r,i)))return{code:"ERR10",message:e.errorCodes.ERR10,expected:i}}else if(r&&r!=i)return{code:"ERR10",message:e.errorCodes.ERR10,expected:i};break;case"items":if(Array.isArray(r))for(h=0;h<r.length;h++){i.any&&Array.isArray(i)||(i=[i]);for(var _=i.length,v=(u=!0,0);v<_;v++){p=i[v];for(var t in p){if(!0!==(y=e.checkProperty(t,r[h],h,p[t],p))){!0===u&&(y.path=y.path?h+"."+y.path:y.path,u=y);break}}}if(!0!==u)return u}break;case"properties":if("object"==typeof r&&!Array.isArray(r))for(var o in r)if(i.hasOwnProperty(o)){var g=i[o];g.any&&Array.isArray(g)||(g=[g]);for(_=g.length,u=!0,h=0;h<_;h++){p=g[h];for(var t in p){if(1!=(y=e.checkProperty(t,r[o],o,p[t],p))){!0===u&&(y.path=y.path?o+"."+y.path:o.toString(),u=y);break}}}if(!0!==u)return u}break;case"validation":if(1!=(y=e.customValidator[i].apply(a,[o,r,l])))return y;break;case"instanceof":if(!("object"!=typeof r||Array.isArray(r)||r instanceof i))return{code:"ERR30",message:e.errorCodes.ERR30,property:o,instanceof:i}}return!0},e.checkNestedProp=function(t,r,o,i,n,a,s,l,d){var c;if(e.Transform[o.type]&&((o=e.Transform[o.type]).type=o.extends),0!=r.length){if("array"==o.type)o.items&&!isNaN(r[0])&&"object"==typeof o.items&&(r=r.slice(1),e.checkNestedProp(t,r,o.items,i,n,a,s,l,d));else if("object"==o.type&&o.properties&&o.properties.hasOwnProperty(r[0])){var p=r[0];r=r.slice(1),e.checkNestedProp(t,r,o.properties[p],i,n,a,s,l,d)}}else if(o&&(o.properties||o.items)&&!l.hasOwnProperty("warn")){var u={__data:{}};o.properties?u.__data[a]=o.properties[a]:o.items&&i.index?u.__data[i.index]=o:u.__data[a]=o.items;var f=e.validate(n,a,s,u),h=i.attr?i.attr:i.key,m=i.path.split("."),y=null==i.index&&a?i.path+(""!=i.path?".":"")+a:null!=i.index?i.path+(""!=i.path?".":"")+i.index:i.path;if(f&&"object"==(void 0===f?"undefined":typeof f)&&f.code){f.value=s,f.path=""!=i.path?i.path:a,i.isRec&&d&&null==i.key&&""!=i.path&&(h=i.path.split(".")[0],m.shift(),m=1==m.length&&m[0]==a?[]:m),i.Error&&i.Error[h]?i.Error[h].code&&i.Error[h].nested?i.Error[h].nested:i.Error[h].nested={}:i.Error[h]={nested:{}},i.Error[h].code="ERR34",i.Error[h].message=e.errorCodes.ERR34,c=i.Error[h].nested,i._cmpErr[h]||(i._cmpErr[h]={}),i._cmpErr[h].code="ERR34",i._cmpErr[h].message=e.errorCodes.ERR34;var _=i._cmpErr[h].path?i._cmpErr[h].path:[];""!=i.path&&m.forEach((function(e){c=c&&!c[e]?c[e]={}:c[e]})),null!=i.index?c[i.index]=f:c[a]=f,_.includes(y)||_.push(y),i._cmpErr[h].path=_}else{i.isRec&&d&&null==i.key&&(h=i.path.split(".")[0],m.shift(),m=1==m.length&&m[0]==a?[a]:m),c=i.Error[h]&&i.Error[h].nested?i.Error[h].nested:void 0;var v=i._cmpErr[h]||void 0;if(v&&v.path&&v.path.includes(y)){var g=v.path.indexOf(y);v.path.splice(g,1)}if(c){i.index;var b=!0;y.split(".").forEach((function(e){c[e]&&c[e].code?(delete c[e],b=!(!c||0!=Object.keys(c).length)):c=c[e]})),1==b&&i.Error[h]&&i._cmpErr[h]&&(delete i.Error[h],delete i._cmpErr[h])}}(l.value&&l.value.hasOwnProperty("code")&&f.code||!l.value)&&(l.value=f)}i.index&&delete i.index},e.types=["string","object","number","boolean","array"],e.attr=function(t,r){var o={};if(o.type=t,null==r&&(r={}),-1==e.types.indexOf(t)&&!e.Transform.hasOwnProperty(t))throw new Error("Not a valid field type - "+t);return Object.assign(o,r),o},window.prop=e.attr,e.defineRelation=function(e,t,r){var o={type:"relation",relType:t,relatedTo:e};return r&&(o.opts=r),o},e.belongsTo=function(e,t){return this.defineRelation(e,"belongsTo",t)},e.hasMany=function(e,t){return this.defineRelation(e,"hasMany",t)},e.Transform={},e.customValidator={},e.registerDataType=function(t,r){var o="extends";this.Transform.hasOwnProperty(t)?e.warn("Custom Field Type - "+t+" -  already exists."):null!=r[o]&&-1!=e.types.indexOf(r[o])?this.Transform[t]=r:e.error("Not a valid field type - "+r[o])},e.registerValidator=function(t,r){this.customValidator.hasOwnProperty(t)?e.warn("Custom Validator with name - "+t+" - already exists"):this.customValidator[t]=r},e.patterns={email:/^([A-Za-z0-9._%\-'+/]+@[A-Za-z0-9.-]+\.[a-zA-Z]{2,22})$/,url:/(^(ht|f)tp(s?):\/\/[0-9a-zA-Z][-.\w]*(:[0-9])*(\/?)([a-zA-Z0-9\-.?,:'/\\+=&amp;%$#_[\]@!()*;~]*)?$)/,ampm:/^(AM|PM|am|pm)$/,hour:/^(0?[0-9]|1[0-9]|2[0-4])$/,minute:/^(0?[0-9]|[1-5][0-9]|60)$/,boolean:/^(true|false|TRUE|FALSE)$/,alphaNumeric:/([a-zA-Z0-9])+/,alphabetsOnly:/([a-zA-Z])+/,numeric:/([0-9])+/,phoneNo:/^[0-9a-zA-Z+.()\-;\s]+$/},e.validate=function(t,r,o,i,n){var a=i.__data[r],s=!1,l=a?a.type:void 0,d=a;if(d){d.any&&Array.isArray(d)||(d=[d]);for(var c=d.length,p=!0,u=0;u<c;u++){var f=d[u];for(var h in f)!0!==(s=e.checkProperty(h,o,r,f[h],f,t,l,void 0,n))&&!0===p&&(p=s)}if(!0!==p)return p}return!1},e.registerPattern=function(e,t){this.patterns[e]=t},e.errorCodes={ERR01:"Primary key cannot be modified",ERR02:"Mandatory field cannot be empty",ERR03:"Type of value does not match the specified data type",ERR04:"Value is greater than the maximum value allowed",ERR05:"Value is less than the minimum value allowed",ERR06:"Length of string/array is greater than the maximum limit allowed",ERR07:"Length of string/array is less than the minimum limit allowed",ERR08:"String does not match the specified pattern",ERR09:"Values in array are not unique",ERR10:"Value is not equal to the specified constant",ERR11:"Model of related field is not defined",ERR12:"Model of backward relation is not defined",ERR13:"Record not found",ERR14:"Model does not match the related field model",ERR15:"Error in creating a record as a relation",ERR16:"Record with primary key already exists",ERR17:"Value cannot be changed because record has been deleted",ERR18:"Action not defined",ERR19:"Model not defined",ERR20:"Key not specified",ERR21:"'belongsTo' relationship expects a single object/id",ERR22:"Type not specified for polymorphic relation",ERR23:"Primary Key value not present",ERR24:"Error while relating record",ERR25:"Backward relation not present",ERR26:"Primary key value cannot be undefined or null",ERR27:"Observer can observe only string data type value, '{0}' value cannot be observed in the function named '{1}' in the component '{2}'",ERR28:"Unloaded record cannot be saved",ERR29:"Property not defined in the object",ERR30:"Error in variables declaration for Query",ERR31:"Query not registered for the Model",ERR32:"Property not defined in the object",ERR33:"Property's value is not an instanceof the mentioned class",ERR34:"Type definition for nested properties / items does not match with the value",ERR35:"A datatype mismatch has occurred for custom DataType '{0}'"},e.registeredGlobalEvents=e.__lyteRegisteredEvents={},e.__lyteRegisteredEventsGlobal={},e.triggerEvent=function(e){var t,r,o;"object"==typeof e&&e.global?(r=e.args,t=Array.prototype.slice.call(r,1),eventName=r[0],o="__lyteRegisteredEventsGlobal"):(t=Array.prototype.slice.call(arguments,1),eventName=arguments[0],o="__lyteRegisteredEvents");var i=!1,n=this[o][eventName];if(n)for(var a=0;a<n.listeners.length;a++){var s=n.listeners[a];if(s){var l=s.apply(this,t);if(!1===l){i=!0;break}}}else n=this[o][eventName]={listeners:[]};var d=new CustomEvent(eventName,{detail:t});i||document.dispatchEvent(d)},e.triggerGlobalEvent=function(){return e.triggerEvent({global:!0,args:Array.from(arguments)})},e.addEventListener=function(t,r,o){if("function"==typeof r){var i=o&&o.global?"__lyteRegisteredEventsGlobal":"__lyteRegisteredEvents",n=this[i][t];return n||(n=this[i][t]={listeners:[]}),t+"-"+(n.listeners.push(r)-1)}e.error("Second parameter to Lyte.Component.addGlobalEventListener() must be a function")},e.removeEventListener=function(t,r){let o;if(t&&-1!=(o=t.lastIndexOf("-"))){var i=t.split("-");if(r){i=t.split("-");if(!(n=this[r&&r.global?"__lyteRegisteredEventsGlobal":"__lyteRegisteredEvents"][i[0]])||!n.listeners[i[1]])return void e.error("No such listener registered");n.listeners[i[1]]=null}else{var n,a=t.substring(0,o),s=t.substring(o+1);if(!(n=this.__lyteRegisteredEvents[a])||!n.listeners[s])return void e.error("No such listener registered");n.listeners[s]=null}}else e.error("listener unique id not specified / invalid")},e.extendEventListeners=function(t){t&&"object"==typeof t&&!t.hasOwnProperty("__lyteRegisteredEvents")&&Object.defineProperties(t,{__lyteRegisteredEvents:{value:{}},addEventListener:{value:e.addEventListener},removeEventListener:{value:e.removeEventListener},triggerEvent:{value:e.triggerEvent}})},e.deepCopyObject=function(t){for(var r,o,i,n,a,s,l=[{source:t,target:Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t))}],d=[t],c=l[0].target,p=[c];r=l.shift();){for(o=Object.keys(r.source),i=0;i<o.length;i++)(n=Object.getOwnPropertyDescriptor(r.source,o[i]))&&(n.value&&"object"==typeof n.value?(a=n.value,n.value=Array.isArray(a)?[]:a instanceof Set?new Set:Object.create(Object.getPrototypeOf(a)),-1==(s=d.indexOf(a))?(d.push(a),p.push(n.value),Object.defineProperty(r.target,o[i],n),l.push({source:a,target:n.value})):(n.value=p[s],Object.defineProperty(r.target,o[i],n))):Object.defineProperty(r.target,o[i],n));e.isRecord(r.source)&&(Object.defineProperty(r.target,"$",{value:{}}),r.target.$.isNew=r.source.$.isNew,r.target.$.isModified=r.source.$.isModified,r.target.$.isDeleted=r.source.$.isDeleted,r.target.$.pK=r.source.$.pK,r.target.$._attributes=r.source.$._attributes,r.target.$.isCloned=!0,r.target.$.model={_name:r.source.$.model._name},r.source.$.hasOwnProperty("deepNest")&&(r.target.$.deepNest=r.source.$.deepNest),r.source.$.hasOwnProperty("partialType")&&(r.target.$.partialType=r.source.$.partialType)),Array.isArray(r.source)&&r.source.partial&&Object.defineProperty(r.target,"partial",{value:r.source.partial})}return c},e.nestScpId=1,e.nestScp={},e.__nestRef__={},e.__nestScp__=new Map,e.establishObjectBinding=function(t,r,o,i,n,a){var s,l,d,c=t.__component__&&t.__component__.component.__data?t.__component__.component.__data[r]:void 0;if(o){if(t&&!t.$&&t._scp)Array.from(t._scp.keys()).forEach((function(t){var r=e.nestScp[t];s=store.modelFor(r.model)}));else s=t.$.model;var p=!1;if(l=s&&s.fieldList&&s.fieldList.hasOwnProperty(r)?s.fieldList[r]:{}){var u=e.Transform[l.type];u&&(u.hasOwnProperty("properties")||u.hasOwnProperty("items"))&&(p=!0)}if(!(l&&"relation"!==l.type&&l.watch||p)){if(t._scp)Array.from(t._scp.keys()).forEach((function(o){var i=t._scp.get(o).paths,n=e.nestScp[o]||void 0;for(var s in a=n&&n.watch?n.watch:a,i){var l=s?s.split("."):[];l.push(r),e.bindObj(t,r,o,l,new Map,void 0,c,a,!0)}}));return}c=l}i&&t._scp&&t._scp.size&&Array.from(t._scp.keys()).forEach((function(o){var i=t._scp.get(o).paths,n=e.nestScp[o]||void 0;for(var s in a=n&&n.watch?n.watch:a,i){var l=s?s.split("."):[];l.push(r),e.bindObj(t,r,o,l,new Map,void 0,c,a,!0)}}));var f=!1;if(c&&e.Transform[c.type]){var h=e.Transform[c.type];(h.hasOwnProperty("properties")||h.hasOwnProperty("items"))&&(c=e.Transform[c.type],f=!0)}if((!o||l.watch||l.properties||l.items||a||f)&&t[r]){var m;t&&t.__component__?(t.__component__.__scpObj||Object.defineProperty(t.__component__,"__scpObj",{value:{}}),t.__component__,m=t.__component__.__scpObj):e.isRecord(t)&&(t.$.__scpObj||Object.defineProperty(t.$,"__scpObj",{value:{}}),t,m=t.$.__scpObj);var y=m;if(m){var _=!1,v=!1;if(o)if(t[r]&&!e.__nestScp__.has(t[r]))d={model:s._name,attr:r,pK:t.$.pK,Error:{}},_=!0;else{var g=e.__nestScp__.get(t[r]),b=e.__nestRef__[g]=e.__nestRef__[g]||new Map,A=e.$.genMapId(b);b.set(A,!0),e.setRecBindMap(e.nestScp[g],{model:s._name,attr:r,pK:t.$.pK,Error:{}}),y[r]=g+"_"+A}else if(t[r]&&!e.__nestScp__.has(t[r])){var $=[];(E={}).key=r,E.dtype=t.__component__.component.__data[r],E._cmpErr=t.errors,E.Error={},$.push(E),d={data:t[r],PropsInfo:$},E.dtype.watch&&(d.watch=!0),v=!0}else{g=e.__nestScp__.get(t[r]);var L=e.nestScp[g];if(L){L.PropsInfo||(L.PropsInfo=[]);var E,R=L.PropsInfo;(E={}).key=r,E.Error={},E._cmpErr=t.errors,E.dtype=t.__component__.component.__data[r],E.dtype.watch&&(L.watch=!0),R.push(E)}b=e.__nestRef__[g]=e.__nestRef__[g]||new Map,A=e.$.genMapId(b);b.set(A,!0),y[r]=g+"_"+A}if(d){var w=e.nestScpId++;b=e.__nestRef__[w]=e.__nestRef__[w]||new Map,A=e.$.genMapId(b);b.set(A,!0),e.__nestScp__.set(t[r],w),_&&(e.nestScp[w]={},e.setRecBindMap(e.nestScp[w],d),e.nestScp[w].Error=d.Error),v&&(e.nestScp[w]=d),e.nestScp[w]._data=t[r],y[r]=y[r]||w+"_"+A;e.bindObj(t,r,w,[],new Map,void 0,c,a)}}}},e.removeNestScp2Bind=function(e,t){if((e=e.model).has(t.model)){var r=e.get(t.model);if(r.has(t.pK)){var o=r.get(t.pK);o.has(t.attr)&&o.delete(t.attr),o.size||r.delete(t.pK)}r.size||e.delete(t.model)}},e.setRecBindMap=function(e,t){var r=e.model=e.model||new Map,o=t.model,i=t.pK,n=t.attr;o&&!r.has(o)&&r.set(o,new Map),r=r.get(o),i&&!r.has(i)&&r.set(i,new Map),r=r.get(i),n&&!r.has(n)&&r.set(n,!0)},e.bindObj=function(t,r,o,i,n,a,s,l,d){n=n||new Map;var c=null!=r?t[r]:t,p=!1;if(d||i.length||e.__nestScp__.get(t)!==o||delete e.nestScp[o].cyclic,i.length>1&&c&&e.nestScp[o]&&e.nestScp[o].hasOwnProperty("data")&&e.nestScp[o].data===c){if(n.get(c))p=!0;else try{JSON.stringify(c)}catch(e){p=!0}e.checkAndAddBind(c,o,i,p)&&e.estObjScp(c,o,i,p)}else{var u,f;if(s&&(s.hasOwnProperty("items")||s.hasOwnProperty("properties")?(u=s.items||s.properties,f=!0):null==l&&1==s.watch&&(l=s.watch)),u=l?void 0:u,Array.isArray(c)){if(n.get(c)?p=!0:(n.set(c,!0),c.forEach((function(t,r){i.push(r),(l||s&&s.hasOwnProperty("items")&&"object"==typeof s.items)&&e.bindObj(c,r,o,i,n,void 0,u,l),i.pop()}))),e.checkAndAddBind(c,o,i,p))Array.isArray(l)&&(h=e.checkEstablishingSCP(c,i,l)),(h||"boolean"==typeof l&&l||f)&&e.estObjScp(c,o,i,p)}else if(c&&"object"==typeof c){var h;p=!1;if(n.get(c))p=!0;else for(var m in n.set(c,!0),c)i.push(m),(l||u&&u.hasOwnProperty(m))&&e.bindObj(c,m,o,i,n,void 0,u?u[m]:void 0,l),i.pop();if(e.checkAndAddBind(c,o,i,p))Array.isArray(l)&&(h=e.checkEstablishingSCP(c,i,l)),(h||"boolean"==typeof l&&l||f)&&e.estObjScp(c,o,i,p)}}},e.checkAndAddBind=function(t,r,o,i){if(!t._scp||!t._scp.size)return!0;if(t._scp.size&&(t._scp.has(r)&&t._scp.get(r).paths.hasOwnProperty(o.join("."))))return i&&(e.nestScp[r].cyclic=!0),!1;return!0},e.estObjScp=function(t,r,o,i){t._scp||Object.defineProperty(t,"_scp",{value:new Map,enumerable:!1,configurable:!0});var n=t._scp;n.has(r)||n.set(r,{});var a=n.get(r);o=o?o.join("."):o;(a.paths=a.paths||{})[o]=!0;var s=e.nestScp[r];s.cyclic||1!=i||(s.cyclic=!0)},e.cmpObjs=function(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var o in t){if(!r.hasOwnProperty(o))return!1;if(0==e.cmpData(t[o],r[o]))return!1}return!0},e.cmpData=function(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;if(t===r)return!0;for(var o=t.length,i=0;i<o;i++)if(0==e.cmpData(t[i],r[i]))return!1}else{if(t&&r&&"object"==typeof t&&"object"==typeof r)return t===r||e.cmpObjs(t,r);if(t!==r)return!1}return!0},e.nestScpRmPath=function(e,t){if(e&&e.paths)for(var r in e=e.paths)r.startsWith(t+".")&&delete e[r]},e.nestScpRemove=function(t,r,o){var i=t._scp;if(i&&i.size){if(o){e.nestScpRmPath(i.get(r),o);var n=i.get(r),a=n?n.paths:void 0;a&&!Object.keys(a).length&&i.delete(r)}else i.delete(r);i.size||delete t._scp}},e.rmNestScp=function(t,r,o,i,n){if(Array.isArray(t))o.get(t)||(o.set(t,!0),t.forEach((function(t,i){e.rmNestScp(t,r,o,void 0,n)}))),e.nestScpRemove(t,r,n);else if(t&&"object"==typeof t){if(!o.get(t))for(var a in o.set(t,!0),t)e.rmNestScp(t[a],r,o,void 0,n);e.nestScpRemove(t,r,n)}},e.removeNestScp=function(t,r,o,i,n,a,s,l){a=a||new Map,r=Number.parseInt(r);var d=e.nestScp[r],c=e.__nestRef__[r];l&&d.model&&e.removeNestScp2Bind(d,l),n?(c&&c.has(o)&&c.delete(o),(!c||c&&!c.size)&&(delete e.__nestRef__[r],e.__nestScp__.has(t)&&e.__nestScp__.delete(t),e.rmNestScp(t,r,a,!0,i),s||delete e.nestScp[r])):e.rmNestScp(t,r,a,!0,i)},e.resolvePromises=function(t){if("string"==typeof t||t instanceof Promise)return t;if(Array.isArray(t))return function(t){var r=[],o=!1;if(t.every((function(e,t){return!(e instanceof Promise||e&&!Array.isArray(e)&&"object"==typeof e&&"function"==typeof e.then)||(o=!0,!1)})),!o)return Promise.resolve(t);return new Promise((function(o,i){Promise.all(t).then((function(e){t.forEach((function(t,o){r[o]=e[o]})),o(r)}),(function(t){i(t),e.error("Error on resolve promises",t)}))}))}(t);if("object"==typeof t)return function(t){var r=[],o=[],i=Object.keys(t);if(i.forEach((function(e){var i=t[e];(i instanceof Promise||i&&!Array.isArray(i)&&"object"==typeof i&&"function"==typeof i.then)&&(r.push(e),o.push(i))})),o.length){var n={};return new Promise((function(a,s){Promise.all(o).then((function(e){i.forEach((function(o){-1!=r.indexOf(o)?n[o]=e[r.indexOf(o)]:n[o]=t[o]})),a(n)}),(function(t){s(t),e.error("Error on resolve promises",t)}))}))}return Promise.resolve(t)}(t)},"complete"===document.readyState||"interactive"===document.readyState?s():document.addEventListener("DOMContentLoaded",(function(e){s()}),!0);var l=XMLHttpRequest.prototype.send;function d(t,r,o,i){var n=e.__nodeXHRMap=e.__nodeXHRMap||new Map,a=n.get(r);a||n.set(r,new Map),a=n.get(r);var s=r.lyteState=r.lyteState||[],l=i||o;-1==s.indexOf(l)&&s.push(l),r.setAttribute("lyte-state","");var d=a.get(t);if(d||(a.set(t,[]),d=a.get(t)),i)return d.push({state:i}),{target:r,event:t};d.push({isXHR:!0,xhr:o});var p=function(e){4==o.readyState&&(c(o,t,r),o.removeEventListener("readystatechange",p))};o.addEventListener("readystatechange",p)}function c(t,r,o){var i=e.__nodeXHRMap,n=i.get(o);if(n){var a=n.get(r);if(a&&a){var s=a,l=-1;if(s.every((function(e,r){return!(e&&e.isXHR&&e.xhr==t||"string"==typeof t&&e.state==t)||(l=r,!1)})),-1!=l){s.splice(l,1);var d=o.lyteState.indexOf(t);if(o.lyteState.splice(d,1),!s.length){n.delete(r);var c=o&&Array.isArray(o.lyteState)?o.lyteState.indexOf(t):-1;-1!=c&&o.lyteState.splice(c,1),o&&o.lyteState&&0==o.lyteState.length&&(o.lyteState=null,o.removeAttribute("lyte-state"))}n.size||i.delete(o)}}}}XMLHttpRequest.prototype.send=function(){var t,r=window.event,o=r?r.target:void 0;if(e.getConfig("stateHandling"))if(r)t=r.type,/^(click|dblclick)$/.test(t)&&o&&o.getAttribute&&"false"!=o.getAttribute("lyte-state-handling")&&d(t,o,this);else{var i=e&&e.Router?e.Router.getRouteInstance():void 0;if(i){var n=i.transition?i.transition.ev:void 0;if(n&&n.target&&n.target.getAttribute&&"false"!=n.target.getAttribute("lyte-state-handling")){var a=e.__transXHRMap=e.__transXHRMap||new Map;a.set(i.transition,{currentAction:n,XHR:this}),d(n.type,n.target,this)}}}l.apply(this,arguments)},e.addEventListener("transitionStart",(function(e){var t=e.nextTrans;t&&e.prevTrans&&(window.event&&/^(click|dblclick)$/.test(window.event.type)?(t.ev=window.event,e.prevTrans.ev&&delete e.prevTrans.ev):409!=e.prevTrans.state&&308!=e.prevTrans.state||!e.prevTrans.ev||(t.ev=e.prevTrans.ev,delete e.prevTrans.ev))})),e.addEventListener("afterRouteTransition",(function(t){if(t&&t.trans){var r=e.__transXHRMap,o=!1;if(409==t.trans.state||308==t.trans.state){var i=window.event,n=t.trans.ev;if(!i||i&&n&&i!=n&&i.target==n.target&&i.type==n.type?t.trans.nested=!0:o=!0,r){var a=r.get(t.trans);a&&(c(a.XHR,a.currentAction.type,a.currentAction.target),r.delete(t.trans))}}else 200==t.trans.state&&(r&&r.delete(t.trans),o=!0);o&&t.trans.ev&&delete t.trans.ev}})),e.addEventListener("beforeRouteTransition",(function(e){e&&e.prevTrans&&e.prevTrans.nested&&(e.trans.ev=e.prevTrans.ev,delete e.prevTrans.ev,e.trans.fromPrevTrans=!0)})),e.setState=function(t){t||console.error("Please provide a state name");var r=window.event;if(/^(click|dblclick)$/.test(r.type)){var o=r.target;if(1==e.getConfig("stateHandling")&&o&&o.getAttribute&&"false"!=o.getAttribute("lyte-state-handling"))if(!o.getAttribute("lyte-state")){var i=e.__stateMap=e.__stateMap||new Map;if(i.get(t))console.error("There is already a open state by the name",t);else{var n=d(r.type,o,void 0,t);i.set(t,n)}}}},e.removeState=function(t){t||console.error("Please provide a state name");var r=e.__stateMap;if(r){var o=r.get(t);o&&(r.delete(t),c(t,o.event,o.target))}},e.setConfig=function(t,r,o){"mutable"==t&&(1==r?e.__gl=e.mut(e.__gl__):0==r&&(e.__gl=e.__gl__));var i=e.__config=e.__config||{};o?Object.defineProperty(i,t,{value:r}):i[t]=r},e.getConfig=function(t){var r=e.__config;if(r)return r[t]},e.establishWatchScope=function(t,r){var o,i=this;for(var n in t){var a=n,s=t[n];if(i.component&&i.component.__data&&i.component.__data[a]){o=i.getData(a),s=!!i.component.__data[a].watch||s,"object"==typeof o&&e.establishObjectBinding(i.component.data,n,!1,void 0,void 0,s);var l=i.component.__data;e.nestScp[e.__nestScp__.get(o)]&&(l[n].watch=s)}else if(r){var d=r.fieldList;d[n]&&null==d[n].watch&&(d[n].watch=s,r._fldGrps.watch[n]=d[n])}}},e.checkEstablishingSCP=function(t,r,o){if(Array.isArray(o)){var i;if(i=r.join("."),e.checkWatchPath(i,o,!0)&&"object"!=typeof t)return!0;for(var n=Object.keys(t),a=0;a<n.length;a++){var s=n[a],l=""==i?s:i+"."+s;if(e.checkWatchPath(l,o,!0))return!0}}},e.checkWatchPath=function(t,r,o){if("boolean"==typeof r&&!0===r)return!0;if(Array.isArray(r))for(var i=0;i<r.length;i++){var n=r[i],a=-1!=(n=(n=(n=n.replace(/ /g,"")).replace(/\$\.\./g,"..")).replace(/\$\./g,"")).search(/\.\./g)||-1!=n.search(/\[|\\]|\{|\}/g)||n.includes("*");if(t==n)return!0;if(a){if(o&&-1!=n.search(/\.\./)&&"..*"==(n=n.replace(/\.\.\S+/g,"..*")))return!0;if(n=(n=(n=0==(n=0==n.search(/\[/)?n.replace("[",""):n).search(/\.\.\[/)?n.replace("..[",".."):n).replace(/\.*\[/g,".")).replace(/\]/g,""),e.checkWeirdPath(n,t))return!0}}},e.checkWeirdPath=function(e,t){if(t==e)return!0;if(e.includes("..")||e.includes("*")){var r=e;r=(r=(r=(r=(r=r.replace(/\*/g,"$$")).replace(/\.\./g,"::")).replace(/\./g,"\\.")).replace(/\:\:/g,"\\.?.*\\.?")).replace(/\$/g,".*");var o=e.split("."),i=o.length;return""==o[i-2]&&"*"!=o[i-1]&&(r+="$"),!!new RegExp(r).test(t)}};e.ignoreMut=function(e){!0,e(),!1};var p=new WeakMap;e.mut=function(t){if(t&&t.__ltPrx__)return t;if(t&&p.has(t))return p.get(t);if(!t||t&&"Object"!==t.constructor.name&&"Record"!==t.constructor.name&&!Array.isArray(t)&&!t.__ltPrx__)return t;let r=new Proxy(t,{set:function(t,r,o){return Array.isArray(t)?t[r]=o:e.Component.set(t,r,o),!0},get:function(t,r){if("__ltPrx__"===r)return!0;if("__target__"===r)return t;var o=t[r];if(o&&o.__ltPrx__)return o;if(o&&p.has(o))return p.get(o);var i=Object.getOwnPropertyDescriptor(t,r);if(o&&("Object"===o.constructor.name||Array.isArray(o)||o&&o.$&&o.$.hasOwnProperty("isModified"))&&!o.__ltPrx__&&i&&i.configurable){let t=e.mut(o);return p.set(o,t),t}return o}});return p.set(t,r),r},e.immut=function(t,r){var o;r=r||new WeakMap;return t&&Array.isArray(t)?o=Array.from(t):t&&"object"==typeof t&&(o=Object.assign({},t)),r.get(t,o),new Proxy(t,{get:function(t,o){var i;return(i=r.get(t)[o])&&"object"==typeof i&&!r.has(i)?e.immut(i,r):i},set:function(t,o,i){var n=r.get(obj);return e.Component.set(n,o,i),!0}})},Object.defineProperty(e,"__gl__",{value:{}}),e.__gl=e.__gl__}(_Lyte),function(e){Lyte.Router=new function(t){var r,o,i,n,a,s,l,d,c,p,u,f="function",h="route",m="pending",y="completed",_="aborted",v="parseRouteMapping",g="constructRunLoop",b="RouteTransition",A="getDependencies",$="getResources",L="beforeModel",E="model",R="afterModel",w="redirect",N="renderTemplate",P="afterRender",C="beforeExit",O="didDestroy",T="willTransition",S="didTransition",k="onError",x="beforeLoad",D="onBeforeLoad",j="beforeRouteTransition",I="afterRouteTransition",M="resources",B="dependencies",F="lt-prop",K="lt-prop-start-from",H="lt-prop-route",V="lt-prop-fragment",z="lt-prop-dp",q="lt-prop-qp",U="lt-prop-td",W="lt-prop-trans",G="lt-prop-refresh-route",Y="link-to",J="LINK-TO",Q="stateChange",X=N+" hook should return either component or HTML. Rendering of HTML directly into the DOM within the "+N+" hook is deprecated.",Z="Error while parsing ltProp in link-to",ee="MediumOrchid",te=Lyte.time,re=Lyte.log,oe=JSON.parse,ie=this,ne=document,ae=ne.location,se={routeHash:{},urlCache:{},stickyRoutes:{},allLinks:{},activeLinkTags:[]},le=!0,de=!1,ce=Ae()?Ae().index:0,pe=!1,ue=function(){},fe={},he={getResources:M,getDependencies:B};function me(e,t,r,o,i){t&&("object"!=typeof t||Array.isArray(t)?ot.call(this,{stopTrans:!0,err:Error(vt(203)).stack,instance:r,hook:o,index:i}):e.setData(t))}function ye(e,t){var r;if(t){if(!(r=t.outlet?t.outlet.querySelector(e):void 0))return ye(e,t.parent)}else(r=ne.querySelector(e))||gt(428,e);return r}function _e(e){for(var t,r=0;t=e[r];r++){for(var o,i=t.parentNode,n=ne.createElement("script"),a=0;o=t.attributes[a];a++)n.setAttribute(o.name,o.value);n.innerHTML=t.innerHTML,i.appendChild(n),i.removeChild(t)}}function ve(e,t){var r=(t=t||i).routes[e];return{queryParams:r.__ltp.queryParams,dynamicParam:r.__ltp.dynamicParam}}function ge(e){return!e.aborted&&!e.paused}function be(t){var r=t.replace?"replaceState":"pushState",o=se.history?mt(De(t.url,!0)):"#"+(se.slashAfterHash?mt(t.url):"/"==t.url[0]&&t.url.length>1?t.url.substring(1,t.url.length):t.url);t.title=t.title||ne.title;var i=[t.state,t.title];o&&i.push(o),e.history[r].apply(history,i)}function Ae(){return history.state&&history.state.meta}function $e(){return history.state&&history.state.data}function Le(e){return ie.history||function(){function e(){return this}function t(e,t,r,o){o||Ae().index++,be({state:{meta:Ae(),data:e},title:t,url:r})}ie.history=new e,Object.defineProperty(e.prototype,"state",{get:function(){return $e()},set:function(e){return de?de=!1:Lyte.warn("setting on data will not be pushed to history. If needed, use `LR.history.replaceState`."),e}}),e.prototype.replaceState=function(){t.apply(Array.from(arguments).push(!0))},e.prototype.pushState=function(){t.apply(Array.from(arguments))}}(),ie.history.index=e.state.meta.index,ie.history.fromHistory=!!e.fromHistory&&(n?n.stateObj.meta.index<i.stateObj.meta.index?"forward":"back":"reload"),de=!0,ie.history.state=$e()||{},ie.history.initial=le,ie.history}function Ee(){!se.deferInit&&ie.init&&ie.init()}function Re(e){var t;Ae()&&(t=Ae().url)||(t=se.history?ke():xe((e&&e.newURL||ae.hash).replace(/.*#/,"")));return t}function we(e,t){if(2==e.button||e.defaultPrevented)return;var r=t||e.currentTarget;if("A"===r.children[0].tagName&&(1==e.ctrlKey||1==e.metaKey||2==e.which||r.children[0].hasAttribute("target")&&"_self"!==r.children[0].getAttribute("target")))return;e.preventDefault(),r.matched||r.getMatchedObject();var o=Object.assign({},r.matched);o.route=Array.isArray(o.route)?o.route.join("."):o.route;var i,n=r.ltProp.replace||r.hasAttribute("lt-prop-replace"),a=ie[n&&"false"!=n?"replaceWith":"transitionTo"](r.matched),s={};if(i=r.getAttribute(W))try{s=oe(i)}catch(e){gt(498,W,t.outerHTML)}let l=r.getAttribute(U);if(l=l||s.data){if("string"==typeof l)try{l=oe(l)}catch(e){gt(498,U,t.outerHTML)}s.data=l}for(var d in s)a[d]=s[d]}function Ne(e,t){if(e.length)for(var r,o=0;r=e[o];o++)if(r!=t[o])return!1;return!0}function Pe(e){return{route:e.route.join("."),fragment:e.fragment,dynamicParams:e.dynamicParams.filter(Oe),queryParams:e.queryParams}}function Ce(e){return e.split(".").filter((function(e){return""!=e}))}function Oe(e){return null!=e}function Te(e){te(v);var t=se.routes?se.routes:se.routes={},r={},o=[],i=[];return d={route:function(e,n,a){if("object"==typeof n){if(n.path){if(ft(n.path,"?")){var s=n.path.split("?");n.defQP=pt(s[1]),n.path=s[0]||"/"}}else n.path=mt(e);n.queryParams&&(n.defQP=n.queryParams)}else typeof n==f&&(a=n),n={path:mt(e)};if(r=Ve(o,se.routeHash)[n.path]={__lp:{}},"/"==n.path)o.push("/");else{var l=n.path;(kt(l)||xt(l))&&yt(l).every((function(e,t,o){if(kt(e)||xt(e)){var i;if(kt(e))i=e.replace(":","");else{i=e.replace("*",""),n.wildcard=r.__lp.wildcard=!0,n.sufix=r.__lp.sufix=[];for(var a,s=t+1;a=o[s];s++)r.__lp.sufix.push(a)}return n.dkey=r.__lp.dkey=i,n.dIndex=r.__lp.dIndex=t,!1}return!0})),o.push(l)}var d=Ve(i,t)||t;i.push(e),r.__lp.route=Array.from(i),d[e]?Object.assign(d[e].__lp,n):d[e]={__lp:n},a&&a.call(this,{}),i.pop(),o.pop()}},e.call(d,{}),te(v),t}function Se(e){if(!ie.init){var t,o=e.matched;e.currRoute=t=o.route.join("."),o.refreshRoute&&n.info.route,r={replace:o.replace||!(!o.refreshRoute||!ie.checkIfSameRoute(Pe(e.matched),Pe(n.matched)))||o.replace,title:i?i.title:ne.title,fromHistory:!1};var s=function(e){var t=je(e.matched);t&&(e.path=r.url=t,Me(t,Ht(e)));return t}(e);return s&&a?(re("Transitioning to "+t+" "+s,h),a._trans):(re("Transition failed"),{})}gt(405)}function ke(){if(se.history){var e=xe(ae.pathname+ae.search+(ae.hash||""));return mt(e=De(e))}return mt(xe(ae.hash.replace("#","")))}function xe(e){return e||(e="/"),e}function De(e,t){var r;if((r=se.baseURL)&&e){if(r=mt(r),0==e.indexOf(r)&&!t)return e.replace(r,"");if(t&&0!=e.indexOf(r))return r+e}return e}function je(e){if(e&&e.route){var t;Array.isArray(e.route)?t=e.route.join("."):e.route=Ce(t=e.route),e.queryParams=e.queryParams||{},e.dynamicParams=e.dynamicParams||[],e.refreshModel=!1;for(var r,o,n=!!i,a=e.dynamicParams.length!=e.route.length,s=0,l=this.tagName==J,d=se.routes,c=r="",p={},u=0,f=e.route.length;u<f;u++){if(o=e.route[u],n&&i.matched.route[u]!=o&&(n=!1),!(d=Ve(o,d))&&!d.__lp&&d.__lp.path)return gt(422,e.route,u),!1;var h=d.__lp.def;h||l||gt(422,e.route,u);var m,y=d.__lp.path;if(h&&h.__lp){if(h.queryParams){m=d.__lp.defQP;var _=h.__lp.qpdef;for(var v in _)e.queryParams.hasOwnProperty(v)||(n&&_[v].sticky?e.queryParams[v]=i.routes[u].__ltp.queryParams[v]:m&&m.hasOwnProperty(v)&&(p[v]=e.queryParams[v]=m[v])),"pathProcessor"!=je.caller.name&&_[v].cipher&&se.cipher.encryptor&&(e.queryParams[v]=se.cipher.encryptor(e.queryParams[v])),l||e.refreshModel||!_[v].refreshModel||(e.refreshModel=!0)}}else if(m=d.__lp.defQP)for(var v in m)e.queryParams&&!e.queryParams.hasOwnProperty(v)&&(e.queryParams[v]=m[v]);if(d.__lp.dkey){var g=yt(y),b=yt(y),A=a?s:u;if(!e.dynamicParams||!e.dynamicParams[A])return gt(499,o,l?this:void 0),!1;g[d.__lp.dIndex]=encodeURI(e.dynamicParams[A]),b[d.__lp.dIndex]=mt("<<dp>>"),c+=mt(b.join("/")),r+=mt(g.join("/")),s++}else c+=mt(y),r+=mt(y)}return se.stickyRoutes[t]||(se.urlCache[t]={url:_t(c),defQP:p}),Ie(r,e)}}function Ie(e,t){if(e="/"==e[e.length-1]&&1!=e.length?e.slice(0,-1):e,t.queryParams){var r=!0;for(var o in t.queryParams)null!=t.queryParams[o]&&(r?(e+="?",r=!1):e+="&",e+=o+"="+encodeURIComponent(t.queryParams[o]))}return se.history&&t.fragment&&(e=e+"#"+t.fragment),_t(e)}function Me(e,t,o){te(b),e&&se.baseURL&&-1==ne.location.pathname.indexOf(se.baseURL)?gt(400):(t=t||(!le&&Ae()&&Ae().matched&&Ae().url==ke()?It(Ae().matched):bt(e)))&&t.matched.route.length&&(clearTimeout(u),t.prevTrans=t.prevTrans||Lyte.Router.__lp.prevTrans,t.path=t.path||e,t.transComp=t.transComp||Be(t.prevTrans,t.matched,t.R),function(e){(a=new qe(e)).url=e.path,a.runLoop={},a._trans=function(e){var t=new St(e);return e.state=t.state=201,t}(a),Lyte.extendEventListeners(a._trans),a.routes=function(e){for(var t,r,o=e.matched,i=[],n=e.prevTrans,s=!0,l=0;r=o.route[l];l++){if(!(t=ie.__lp.getDefinition(a.matched._routes[l])))return!1;n&&s&&n.matched&&n.matched.route[l]==r?i.push(new Bt(i,t,l,e,n.routes[l])):(i[l]=new Bt(i,t,l,e),s=!1)}return n=void 0,i}(e),l?((r=l).url=e.path,a._trans.data=$e()||{},r.replace=!0,l=void 0):a._trans.data&&ie.history.replaceState(a._trans.data)}(p=t),Lyte.triggerEvent("transitionStart",{prevTrans:n&&n._trans,nextTrans:a._trans}),u=setTimeout((function(){p=void 0,i&&102==i.state&&a&&ie.checkIfSameRoute(a.info,i.info)&&!i.aborted&&JSON.stringify(i._data)==JSON.stringify(a._trans.data)?1==i.iPause&&i.resume():(i&&102==i.state&&i.abort({state:409}),(i=a)._data=i._trans.data?Lyte.deepCopyObject(i._trans.data):void 0,t.previous=!0,i.transComp=t.transComp,i.runLoop=He(c=t),i._trans.data&&(r.data=i._trans.data),r.state=i.stateObj=function(e){return{meta:{matched:e.matched,url:e.url,index:e.fromHistory?Ae()?Ae().index:ce:e.replace&&Ae()?Ae().index:ce+=1},data:e.data}}({replace:r.replace,data:r.data,url:i.url,matched:i.matched,fromHistory:r.fromHistory}),Le(r),i.run())}),0))}function Be(e,t,r){var o,i,n=!0,a=!0,s=[],l=[],d=[],c=t.route.join("."),p="";if(e){for(var u,f=e.matched,h=t.refreshRoute&&c==e.info.route?t.refreshRoute:t.startFrom,m=0,y=t.route.length;m<y;m++)p=p+(p?".":"")+(u=t.route[m]),!a||u!=f.route[m]||h&&p==h?(a=!1,null==o&&e.routes[m]&&e.routes[m].__ltp.rendered&&e.routes[m].outlet&&(o=m),d.push(u)):(i=r?r[m]:ie.__lp.getDefinition(u.slice(0,m)),n&&Fe(i,m,f,t)?(l.push(u),e.routes[m].__ltp.rendered?s.push(u):d.push(u)):(n=!1,d.push(u)));if(f.route.length>t.route.length){var _=t.route.length;null==o&&e.routes[_].__ltp.rendered&&(o=_)}}else d=d.concat(t.route);return{rendered:s,unRendered:d,common:l,templateToRemove:o}}function Fe(e,t,r,o){var i=!0,n=Ve(e.__lp.objPath,se.routes);return!e.queryParams&&!n.__lp.dkey||(!n.__lp.dkey||r.dynamicParams[t]==o.dynamicParams[t])&&(e.queryParams&&o.refreshModel&&e.queryParams.every((function(t){return!i||!e.__lp.qpdef[t].refreshModel||!o.queryParams&&!r.queryParams||o.queryParams[t]==r.queryParams[t]||(i=!1)})),i)}fe.getDependencies=fe.getResources=function(e,t){var r=this.routes[t],o=e==A?"loadDependencies":"loadResources",i=this.R[t][e];if(r.__lp[he[e]+"Loaded"]=!0,i&&ge(this)){var n=et.call(this,i,this.routes[t],e,t,ve(t));if(n&&n instanceof Promise)return n;r.__lp[he[e]]=n,r.__lp[he[e]+"Loaded"]=!n||!(n.length||"object"==typeof n),n&&(e==A&&console.warn("Requesting files in getDependencies will stall execution of route till download completes. Please validate files before requesting."),r.__lp[o]=function(){r.__lp[o]=m},We.call(this,{reqType:he[e],r:r,index:t}))}return Ze()},fe[L]=fe[E]=fe[R]=function(e,t){var r=this.routes[t],o=this.R[t][e],i=[this.R[t][e],r,ve(t)];if(e==R&&i.splice(2,0,r.currentModel),o){function n(t){r.$[e]=t,e==E&&(r.currentModel=t),delete o.then}o.then={success:n,failure:n}}return Ze.apply(this,i)},fe[w]=function(e,t){var r=this.routes[t],o=[this.R[t][e],r,ve(t)];return o.splice(2,0,r.currentModel),Ze.apply(this,o)},fe.onError=function(e,t,r,o,n){at.call(i,i.prom),i._trans.triggerEvent(k,{error:r,hook:e});for(var a=this.routes[t];t>=0&&!this.aborted&&this.paused;t--){var s=this.routes[t];if(re("onError of "+s.routeName,h,ee),0==tt.call(this,k,t,[r,this._trans,ve(t),e]))break}rt(r,e,a.routeName,o,n)},fe.willTransition=function(e,t){return 0==tt.call(n,e,t,[i._trans])&&ct(i.runLoop.previous,e),Ze()},fe[j]=function(){if(ge(this)){var e;(e=n&&n._trans)&&(delete e.abort,delete e.pause);var t={prevTrans:e,trans:i._trans,history:ie.history};ie[j](t.prevTrans,t.trans,t.history),i._trans.triggerEvent(j,t),Lyte.triggerEvent(j,t)}return Ze()},fe.afterRouteTransition=function(e){ie.afterRouteTransition(e),i._trans.triggerEvent(I,{trans:e}),Lyte.triggerEvent(I,{trans:e})},fe.beforeLoad=function(e,t){var r,o=this.routes[t],i=et.call(this,this.R[t][e],this.routes[t],e,t,ve(t));if(i&&i.outlet&&(r=ye(i.outlet,o.parent)))if(r.childNodes[0]&&Ye({outlet:r,route:o},!1),i.component){var n=ne.createElement(i.component);me.call(this,n,i.data,routeInstance,e,t),r.innerHTML="",r.appendChild(routeInstance.component=n)}else if(renderTemplate.html){routeInstance.component=void 0,r.innerHTML=renderTemplate.html;var a=r.getElementsByTagName("script");a.length&&_e(Array.from(a))}return Ze()},fe[D]=function(){return new Promise((function(e,t){for(var r=i.matched.route.length,o=1;o<=r&&ge(i);o++){var n=r-o;if(i.R[n].actions&&i.R[n].actions.onBeforeLoad&&console.log(D+" action is depricated. Use beforeLoad callback"),0==tt.call(i,D,n,[ve(n)])||o==r){e();break}}}))},fe[P]=fe.didTransition=function(e,t){return new Promise(function(r,o){var n=setTimeout(function(){if(e==P){var n=this.routes[t];n.__ltp.rendered=!0,Ze.call(this,this.R[t][e],n,n.currentModel,ve(t),n.component).then((function(e){i.routes[t+1]||i._trans.triggerEvent(P),r(e)}),(function(e){o(e)}))}else fe.removeTemplate.call(this),0==tt.call(this,e,t,[ve(t),i._trans])&&(ct(i.runLoop.current,e),t=0),r(),0==t&&ht({state:200})}.bind(this,e,t),0);this.fns.push(n)}.bind(this))},fe.beforeExit=function(e,t){var r=n.routes[t],o=n.R[t][e];return Ze.call(this,o,r,r.currentModel,ve(t,n))},fe[N]=function(e,t){var r=this.routes[t],o=this.R[t];if(o[e]){fe.removeTemplate.call(this);var i=et.call(this,o[e],r,e,t,r.currentModel,ve(t));if(ge(this))if(i&&(r.outletName=i.outlet)){var n,a=r.currentModel;if(r.outlet=n=ye(i.outlet,r.parent)){var s={outlet:i.outlet,route:r};if(i.component)if(r.component&&!i.reRender&&r.component.tagName.toLocaleLowerCase()==i.component&&r.outlet==n&&n.contains(r.component))me.call(this,r.component,a,r,e,t);else{Ye(s,!1);var l=ne.createElement(i.component);l._route=r.__lp.objPath,me.call(this,l,a,r,e,t),n.innerHTML="",n.appendChild(r.component=l)}else if(i.html){r.component=void 0,Ye(s,!1),n.innerHTML=i.html;var d=n.getElementsByTagName("script");d.length&&_e(Array.from(d))}}}else Lyte.warn(X)}else ge(this)&&this.runLoop.templateToRemove&&this.R.length==t+1&&fe.removeTemplate.call(this);return Ze()},fe.removeTemplate=function(){var e=this.runLoop.templateToRemove;this.cleared||(n&&e&&function(e){for(var t,r=0,o=e.length;r<o;r++)for(var n,a=(t=e[r]).routes.length-1;a>=t.index;a--)(n=t.routes[a]).outlet&&(Ye({outlet:n.outletName,route:n},!0),n.outlet.innerHTML="",i.routes[a]&&i.routes[a].__lp.objPath==n.__lp.objPath||Je.call(this,n,a,t))}(e),this.cleared=!0,s!=this&&(s=this),delete this.runLoop.templateToRemove,Lyte.removeFromCache())},this.configureDefaults=function(e){e=e||{},se.history="html5"==e.history,se.baseURL=e.baseURL,se.slashAfterHash=null==e.slashAfterHash||e.slashAfterHash,se.deferInit=e.deferInit||!1,se.preserveUrlOnBrowserNavigation=e.preserveUrlOnBrowserNavigation,se.linkActiveClass=e.hasOwnProperty("linkActiveClass")?e.linkActiveClass:"",se.cipher=e.cipher,se.queryParamOptions={sticky:!e.queryParamOptions||!e.queryParamOptions.hasOwnProperty("sticky")||e.queryParamOptions.sticky},Lyte.$.prefetchSupport&&0!=e.execRouteRequirementsOnDemand?se.execRouteRequirementsOnDemand=!0:(Lyte.$.replaceOldInjectResource&&Lyte.$.replaceOldInjectResource(),se.execRouteRequirementsOnDemand=!1),this.__lp.config=se},this.__lp={version:"3.2.7",pendingReg:[],getDefinition:function(e,t){return"*"==e?se.routes:(t=Ve(e,t=t||se.routes))&&t.__lp&&t.__lp.def||void 0}},this.configureRoutes=function(e){this.__lp.config||this.configureDefaults(),Te.call(this,e);for(var t=0,r=this.__lp.pendingReg.length;t<r;t++)Ot.apply({},this.__lp.pendingReg[t]);this.__lp.pendingReg=[],Lyte.domContentLoaded(Ee),this.__lp.routesConfigured=!0},this.init=function(t){return delete this.init,this.popstate=function(e){var t,r;if(se.preserveUrlOnBrowserNavigation){if(pe)return void(pe=!1);Ae()&&n&&n.stateObj.meta.index!=Ae().index&&(pe=!0,r=Re(e),t=n.stateObj.meta.index-Ae().index,history.go(t))}r=r||Re(e),l={fromHistory:!0,url:r,goValue:t},e&&history.state&&(l.data=history.state),i&&!i.aborted&&(console.log("aborting from dispatch"),i.abort({state:308,iAbort:!0})),Me(r)},e.addEventListener("popstate",this.popstate),se.history?this.popstate():Me((l={fromHistory:!0,url:ke()}).url),function(){class e extends HTMLElement{static get observedAttributes(){return[H,z,V,q,F,"lt-prop-class","lt-prop-data-tabindex","lt-prop-data-tabindex","lt-prop-tabindex","lt-prop-aria-label","lt-prop-aria-attributes","lt-prop-id","lt-prop-rel","lt-prop-title","lt-prop-style","lt-prop-target"]}attributeChangedCallback(e,t,r){if(this.matched&&this.hasAttribute("lyte-rendered")){let o=this.getElementsByTagName("A")[0];o&&(e===F?(this.handleLtProp(),this.hasAttribute("lt-prop-custom")||this.setCustomAttributes(o,!0),this.constructHref(o)):/^(lt-prop-route|lt-prop-fragment|lt-prop-dp|lt-prop-qp)$/.test(e)?(this.getMatchedObject(),this.constructHref(o,e,t,r)):this.hasAttribute("lt-prop-custom")||o.setAttribute(e.substring(8),r))}}connectedCallback(){if(this.ltProp=this.ltProp||{},this.handleLtProp(),this.hasAttribute("lyte-rendered"))this.getElementsByTagName("A")[0]&&!this.matched&&this.getMatchedObject();else{var e;if(this.hasAttribute("lt-prop-custom")||this.ltProp.custom)(e=this.getElementsByTagName("A")[0])&&(this.getMatchedObject(),this.constructHref(e));else{for(e=ne.createElement("a");this.childNodes[0];)e.appendChild(this.childNodes[0]);this.setCustomAttributes(e),this.getMatchedObject(),this.constructHref(e),this.appendChild(e)}Lyte.Component?this._linkToEventId=Lyte.Component.addLyteEventListener(this,"click",(function(e){we(e,this)}),this):this.addEventListener("click",we),this.setAttribute("lyte-rendered","")}}modifyLinkToTagsInRoute(e){var t=Array.isArray(this.matched.route)?this.matched.route.join("."):this.matched.route,r=se.allLinks[t];if(e){if(r){let e=r.indexOf(this);-1!=e&&r.splice(e,1)}}else r?r.push(this):se.allLinks[t]=[this];if(se.stickyRoutes[t]){let t,r=se.routes;if(e){if(!this.matched)return;t=e}else t=this.matched.route;if(!t)return;t=Array.isArray(t)?t:Ce(t);for(var o,i=0,n=t.length;i<n;i++){if(o=t[i],r=Ve(o,r),!r||!r.__lp)return gt(422,t,i),!1;var a=r.__lp.def.__lp;if(e){let e=a.stickyLinks.indexOf(this);-1!==e&&a.stickyLinks.splice(e,1)}else a.qpdef&&a.stickyLinks.push(this)}}}disconnectedCallback(){let e=this.modifyLinkToTagsInRoute.bind(this);Lyte.Component.shouldIgnoreDisconnect()||(this.matched&&this.matched.route&&e(this.matched.route),this._linkToEventId&&Lyte.Component.removeLyteEventListener(this,this._linkToEventId))}handleLtProp(){var e=this.getAttribute(F);if(e)try{this.ltProp=oe(e)}catch(e){Lyte.warn(Z)}}setCustomAttributes(e,t){for(let t in this.ltProp)/^(id|class|style|target)$/.test(t)&&e.setAttribute(t,this.ltProp[t]);if(!t)for(let t,r,o=0;t=this.attributes[o];o++)(r=t.nodeName)!==F&&/^(lt-prop-id|lt-prop-rel|lt-prop-class|lt-prop-style|lt-prop-target|lt-prop-tabindex|lt-prop-aria-label|lt-prop-aria-attributes)$/.test(r)&&e.setAttribute(r.substring(8),t.nodeValue)}constructHref(e,t,r){var o,i=this.modifyLinkToTagsInRoute.bind(this);(o=ie.getURL.call(this,this.matched))&&(e.setAttribute("href",o),t===H?(i(r),i()):i())}}e.prototype.getMatchedObject=function(){var e=this.matched||{},t=this.getAttribute.bind(this),r=t(z)||this.ltProp.dp||[],o=t(q)||this.ltProp.qp||{};if(!(r instanceof Array))try{r=oe(r)}catch(e){return void gt(498,"dynamicParams",this.outerHTML)}if(!(o instanceof Object))try{if(o=oe(o),Array.isArray(o))return void gt(498,"queryParams",this.outerHTML)}catch(e){return void gt(498,"queryParams",this.outerHTML)}return e.route=t(H)||this.ltProp.route,e.fragment=t(V)||this.ltProp.fragment,e.dynamicParams=r||[],e.queryParams=o||{},e.refreshRoute=null!=t(G)?t(G):this.ltProp["refresh-route"],e.refreshRoute=""==e.refreshRoute||"true"==e.refreshRoute?e.route:e.refreshRoute,e.startFrom=t(K)||this.ltProp["start-from"],this.matched=e},customElements.define(Y,e)}(),this},this.beforeScroll=this[j]=this.afterRouteTransition=ue,this.checkIfSameRoute=function(e,t){return!(e.route!=t.route||e.fragment!=t.fragment||e.dynamicParams.length!==t.dynamicParams.length||!Dt(e.queryParams,t.queryParams))&&Ne(e.dynamicParams,t.dynamicParams)},this.addRoutes=function(e,t){var r=setInterval((function(){if(Lyte.Router.__lp.routesConfigured){clearInterval(r),Lyte.warn("addRoutes function will be deprecated from next version");var o=Ve(t?t.split("."):[],se.routes);if(!o)return void console.error(t+" is not specified in router map.");Object.assign(o,Te.call(d,e))}}),0)},this.replaceWith=function(){var e=It.call(this,jt.apply(this,arguments));if(e)return e.matched.replace=!0,Se(e)},this.transitionTo=function(){var e;if(e=It.call(this,jt.apply(this,arguments)))return Se(e)},this.getURL=function(e){if(e){e.route?e.queryParams||(e.queryParams={}):e=jt.apply(this,arguments);var t,r,o,i=this.tagName==J,n=se.urlCache,a=se.queryParamOptions.sticky;if(!a&&(o=n[Array.isArray(e.route)?e.route.join("."):e.route])){if(t=o.url,r=e.dynamicParams&&e.dynamicParams.length)for(var s=0;s<r;s++)t=t.replace("<<dp>>",e.dynamicParams[s]);else-1!=t.indexOf("<<dp>>")&&gt(499,e.route,i?this:void 0);for(var l in o.defQP)!e.queryParams[l]&&o.defQP[l]&&(e.queryParams[l]=o.defQP[l]);t=Ie(t,e)}else t=i?je.apply(this,arguments):je.call(this,e);if(t)return t=se.history?De(t,!0):"#"+t}},this.getRoute=function(e){var t=bt(De(e),!0);return t&&(t.dynamicParams=t.dynamicParams.filter(Oe),t.route=t.route.join(".")),t};var Ke=[L,E,R,w,N,P];function He(e){te(g);var t=e.transComp,r=[],o={},l=[],d=[],c=[],p=[],u=[];if(e.previous){var h=[{hook:j}];if(n){for(var y=n.matched.route.length-1;n.matched.route[y];y--){var _=i.matched._routes[y];_&&_.join(".")==n.matched._routes[y].join(".")||c.push({hook:C,index:y}),p.push({hook:T,index:y})}return te(g),{previous:p.concat(h).concat(c),current:c}}return te(g),{previous:h}}return t.rendered&&t.rendered.length&&t.rendered.forEach((function(e,t){i.routes[t].__ltp.rendered=!0,r.push({hook:w,index:t}),u.push({hook:S,index:i.matched.route.length-t-1})})),t.unRendered&&t.unRendered.length&&t.unRendered.forEach((function(e,n){var s=t.rendered.length+n;(!t.redirected||t.redirected&&t.redirected.index!=s)&&(l.push({hook:x,index:s}),d=d.concat([{hook:A,index:s},{hook:$,index:s}]));var c=i.routes[s];(typeof c.forceFetch==f?et.call(this,c.forceFetch,c,"forceFetch",s,ve(s)):c.forceFetch)?(o[s]=[{hook:L,index:s},{hook:E,index:s},{hook:R,index:s}],a.routes[s].__ltp.fetchStatus=m,[w,N,P].forEach((function(e){r.push({hook:e,index:s}),e==N&&t.unRendered[n+1]&&r.push({hook:x,index:s+1})}))):Ke.forEach((function(e){t.redirected&&t.redirected.index==s&&e!=w?(-1==[L,E,R].indexOf(e)&&r.push({hook:e,index:s}),e==N&&t.unRendered[n+1]&&r.push({hook:x,index:s+1})):(r.push({hook:e,index:s}),e==N&&t.unRendered[n+1]&&r.push({hook:x,index:s+1}))})),u.push({hook:S,index:i.matched.route.length-s-1})})),(r={previous:[],current:[{hook:D}].concat(l).concat(d.concat(r).concat(u)),forceFetch:o}).templateToRemove=n&&n.runLoop.templateToRemove?n.runLoop.templateToRemove:[],null!=t.templateToRemove&&r.templateToRemove.push({index:t.templateToRemove,routes:s.routes}),te(g),r}function Ve(e,t){if(t)return e?(Array.isArray(e)||"string"!=typeof e||(e=Ce(e)),e.every((function(e){return t&&t[e]?(t=t[e],!0):t=!1})),t):t}var ze=0;function qe(e){this.transId=ze+=1,this.matched=e.matched,this.target=e.matched.target,this.fns=[],this.pending={dependencies:new Set,resources:new Set,forceFetch:new Set},this.info={route:e.matched.target,queryParams:e.matched.queryParams,dynamicParams:e.matched.dynamicParams.filter(Oe)},e.matched.fragment&&(this.info.fragment=e.matched.fragment),this.R=e.R,this.running=this.aborted=this.paused=!1,this.abort=function(e){r&&r.goValue&&(pe=!1),this.abort=ue,function(e){e.runningProm&&e.runningProm.reject(_),e.fRunningProm&&e.fRunningProm.reject(_)}(this),this.aborted=!0,e||(e={state:308}),this.running&&re("Transition aborted.",h),e.iAbort||delete this.runLoop.templateToRemove,ht(e)}.bind(this),this.pause=function(e){return re("Transition paused.",h),e&&e.iPause?this.iPause=!0:(this.iPause=!1,this.state=this._trans.state=307,this._trans.triggerEvent(Q,this.state)),this.paused=i.prom||!0,this.resume=this._trans.resume=function(e){if((e=e||this).prom==e.eProm){if(delete e._trans.resume,delete e.resume,re("Transition resumed.",h),e.paused){var t,r=e.prom;if(1!=e.paused&&(t=e.paused.state),e.runLoop[t])if("forceFetch"==t){var o=e.runLoop.forceFetch[r.index];o[0]&&r.hook==o[0].hook&&o.splice(0,1)}else e.runLoop[t][0]&&e.runLoop[t][0].hook==e.paused.hook&&e.runLoop[t][0].index==e.paused.index&&ct(e.runLoop[t],e.paused.hook,e.paused.index);e.iPause=e.paused=!1,e.state=e._trans.state=102,this._trans.triggerEvent(Q,e.state),this.forceFetchRunning?e.runLoop.forceFetch[r.index][0]?e.run(e.runLoop.forceFetch[r.index][0]):(e.routes[r.index].__ltp.fetchStatus=y,null!=e.pending.waitingForFF&&e.pending.waitingForFF==r.index&&(delete e.pending.waitingForFF,e.run())):(t&&"forceFetch"==t&&!e.runLoop.forceFetch[r.index][0]&&(e.routes[r.index].__ltp.fetchStatus=y),e.run())}}else e.pendingResume||(e.pendingResume=e.resume,delete e._trans.resume,delete e.resume)}.bind(this),this._trans}.bind(this)}function Ue(){Lyte.debug&&console.log.apply(this,Array.from(arguments))}function We(e){var t=function(){};t.internal={};var r=e.r,o=e.reqType,n=e.index,s=r.__lp,l=t.internal.hook=i.prom.hook;t.internal.route=s.objPath,Ue(o+" before inject",this.transId,s.objPath),Lyte.injectResources(s[o],t,function(e,t){if(!se.execRouteRequirementsOnDemand&&(!i.aborted||s.objPath==this.routes[n].__lp.objPath&&i.transComp.redirected&&n<=i.transComp.common.length-1||p&&p.transComp.redirected&&n<=p.transComp.common.length-1)){i.aborted&&(i=ie.__lp.trans.aborted?a:!ie.__lp.trans.aborted,s=i.routes[n].__lp);var d=l==A?"loadDependencies":"loadResources",c=l==A?"errorDependencies":"errorResources";i.pending[o].has(n)?((s=i.routes[n].__lp)[o+"Loaded"]=!0,delete s[d],i.pending[o].delete(n),t.length?(Ue(o+" inject completed","failure",i.transId),i.paused||i.pause({iPause:!0}),fe.onError.call(i,l,n,r.__lp[c]=t,424)):(Ue(o+" inject completed","success",i.transId,s.objPath),i.pending.forceFetch.has(n)?(i.pending.forceFetch.delete(n),st.call(i,i.runLoop.forceFetch,i.fRunningProm.resolve,i.runLoop.forceFetch[n][0])):dt.call(i,i.runLoop,"current",i.runningProm.resolve))):i.routes[n].__lp[d]=function(){if(t.length)return Ue(o+" inject completed","failure",i.transId,this.objPath),i.routes[n].__lp[o+"Loaded"]=!0,delete i.routes[n].__lp[d],i.paused||i.pause({iPause:!0}),fe.onError.call(i,l,n,r.__lp[c]=t,424),!1;i.routes[n].__lp[o+"Loaded"]=!0,delete i.routes[n].__lp[d]}}}.bind(i),{defer:function(e){var t=e.injectJS,a=e.files,d=l==A?"loadDependencies":"loadResources",c=l==A?"errorDependencies":"errorResources",p=function(e){i.routes[n].__lp[o+"Loaded"]=!0,e.length?(Ue(o+" inject completed","failure",i.transId,s.objPath),i.paused||i.pause({iPause:!0}),fe.onError.call(i,l,n,r.__lp[c]=e,424)):(Ue(o+" inject completed","success",i.transId,s.objPath),i.pending[o].has(n)&&(i.pending[o].delete(n),i.pending.forceFetch.has(n)?(i.pending.forceFetch.delete(n),st.call(i,i.runLoop.forceFetch,i.fRunningProm.resolve,i.runLoop.forceFetch[n][0])):dt.call(i,i.runLoop,"current",i.runningProm.resolve)))};"pending"==s[d]?(!i.aborted||i.transComp.redirected&&n<=i.transComp.common.length-1)&&t(a,(function(e,t){Ue(o+" after inject",i.transId,this.objPath),delete i.routes[n].__lp[d],p(t)})):s[d]=function(){t(a,(function(e,t){Ue(o+" after inject",i.transId,this.objPath),delete i.routes[n].__lp[d],p(t)}))}}.bind(i)})}var Ge=function(e,t){var r=1==e.__lp[t+"Loaded"],o=t==B?"loadDependencies":"loadResources";return!e.__lp[o]||"function"!=typeof e.__lp[o]||r?r:0!=e.__lp[o]()&&1==e.__lp[t+"Loaded"]};function Ye(e,t){Lyte.triggerEvent("beforeTemplateDestroy",e)}function Je(e,t,r){re("didDestroy of "+e.routeName,h,ee),et.call(this,e.didDestroy,e,O,t,e.currentModel,ve(t,r))}var Qe=[A,$,L,E,R];function Xe(e){return ft(Qe,e)}function Ze(e,t){if(e){var r,o=arguments,n=i,a=i.prom,s=a.hook,l=a.index,d=Xe(s),c=this;return new Promise((function(p,u){try{var f=e.apply(t,Array.from(o).slice(2));d&&f&&(f=Lyte.resolvePromises(f)),r=Promise.resolve(f)}catch(e){return void ot.call(c,{hook:s,index:l,stopTrans:d,err:e,instance:t,promise:{resolve:p,reject:u}})}r.then((function(r){"previous"!=a.state&&i._trans!=t.transition?u("old transition's promise rejected"):(p(r),e.then&&e.then.success.apply(this,arguments))}),(function(r){n.prom=a,u(r),e.then&&e.then.failure.apply(this,arguments),ot.call(c,{hook:s,index:l,stopTrans:d,err:r,instance:t,PR:!0})}))}))}return Promise.resolve()}function et(e,t,r,o){if(e){var i=Xe(r);try{return e.apply(t,Array.from(arguments).slice(4))}catch(e){return void ot.call(this,{hook:r,index:o,stopTrans:i,err:e,instance:t})}}}function tt(e,t,r){var o,i=this.routes[t];if(i.actions&&(o=i.actions[e]))try{if(0==o.apply(i,r))return!1}catch(t){return rt(t,e,i.routeName),!1}}function rt(e,t,r,o,i){if("string"==typeof e||"object"==typeof e&&e.stack&&!e.$){e.stack||(e=Error(e)),e.$=!0;var n=vt(o||420,t,r);e.stack=e.stack.replace(e.message,e.message=e.message+"\n\t"+n),gt(e)}else gt(o,t,r,e,i&&i.PR)}function ot(e){var t=e.instance,r=e.stopTrans,o=e.err,n=e.hook,a=e.index;r?(i.pause(),fe.onError.call(this,n,a,o,420,e)):(rt(o,n,t.routeName),e.promise&&e.promise.resolve())}function it(e,t,r,o,i){o=o||ue,i=i||function(e){e!=_&&gt(e)},new Promise(function(o,i){"nestedForcedPromises"==t?(this.fRunningProm={resolve:o,reject:i},e.call(this,this.runLoop.forceFetch,o)):(this.runningProm={resolve:o,reject:i},e.call(this,this.runLoop,r,o))}.bind(this)).then(o,i)}function nt(){it.call(this,dt,"nestedPromises","previous",function(){if(c&&!i.running&&!i.aborted){if(i.state=i._trans.state=102,i._trans.triggerEvent(Q,i.state),r)if(se.preserveUrlOnBrowserNavigation){r.fromHistory&&r.goValue&&(pe=!0,history.go(-r.goValue)),r.state.data=i._trans.data||r.state.data,o=Lyte.deepCopyObject(r),i.stateObj=r.state;var e=setInterval((function(){o?pe||(clearInterval(e),be(o),o=void 0):clearInterval(e)}),0)}else r.state.data=i._trans.data||r.state.data,be(r),i.stateObj=r.state;ie.__lp.trans=i,c.previous=!1,i.runLoop=He(c),function(e,t){se.linkActiveClass&&se.activeLinkTags.forEach((function(e){e.classList.remove(se.linkActiveClass)}));se.activeLinkTags=[];var r,o,n=e.matched;try{function a(e){e.getAttribute("lt-prop-route")==n.target&&-1==activeLinkTags.indexOf(e)&&activeLinkTags.push(e)}function s(e){o.__ltp.queryParams[e]=r.__lp.qpdef[e].cipher&&se.cipher.decryptor?se.cipher.decryptor(n.queryParams[e]):n.queryParams[e]}for(var l=0,d=i.R.length;l<d;l++)r=i.R[l],o=i.routes[l],r.queryParams&&r.queryParams.forEach(s),o.__ltp.dynamicParam=n.dynamicParams[l],l+1==d&&r.__lp.linkTags.forEach(a);Et(t)}catch(e){gt(e)}}(c,i.info),c=r=void 0,i.running=!0}it.call(this,dt,"nestedPromises","current")}.bind(this))}function at(e){if(i.eProm=e,this.pendingResume){var t=this.pendingResume;delete this.pendingResume,t()}}function st(e,t,r){if(ge(this)&&e){if(!r){for(var o in e){var n=e[o][0];n&&(n.running||st.call(this,e,t,n))}return}this.R[r.index];var a=this.routes[r.index];if(r.state="forceFetch",i.prom=r,r.hook==L&&!Ge(a,B))return this.pending.dependencies.add(r.index),void this.pending.forceFetch.add(r.index);lt(r),e[r.index][0].running=!0,e[r.index].splice(0,1),fe[r.hook].call(this,r.hook,r.index).then(function(o){at.call(i,i.prom),r.hook==R?(a.__ltp.fetchStatus=y,null!=this.pending.waitingForFF&&this.pending.waitingForFF==r.index&&(delete this.pending.waitingForFF,dt.call(this,this.runLoop,"current",this.runningProm.resolve))):r.hook==E?e[r.index][0]&&e[r.index][0].hook==R&&st.call(this,e,t,e[r.index][0]):e[r.index][0]&&e[r.index][0].hook==E&&st.call(this,e,t,e[r.index][0])}.bind(this),(function(){}))}else this.forceFetchRunning=!1}function lt(e){if(Lyte.debug){var t=e.hook,r=e.index;if(-1!=[j,D].indexOf(e.hook))return void re(t,h,ee);var o="previous"==e.state?n.R[r]:i.R[r];re(t+" of route "+o.routeName,h,ee)}}function dt(e,t,r){if(ge(this)){var o=e[t];if(o&&o.length){var n,a=o[0],s=this.R[a.index],l=this.routes[a.index];if(a.hook==L&&(n=Ge(l,B)),a.hook==L&&!n)return void this.pending.dependencies.add(a.index);if(a.hook==N&&!Ge(l,M))return void this.pending.resources.add(a.index);if(a.hook==w&&s.forceFetch&&l.__ltp.fetchStatus==m)return this.forceFetchRunning||(this.forceFetchRunning=!0,it.call(this,st,"nestedForcedPromises")),void(this.pending.waitingForFF=a.index);a.state=t,i.prom=a,lt(a),te(a.hook+a.index),fe[a.hook].call(this,a.hook,a.index).then(function(o){at.call(i,i.prom),te(a.hook+a.index),this.runningProm.resolve==r&&(ct(e[t],a.hook,a.index),dt.call(this,e,t,r))}.bind(this))}else r&&r()}else this.paused&&this.runningProm&&this.runningProm.reject(_)}function ct(e,t,r){for(var o,i=0;o=e[i];i++)if(o.hook==t)if(null!=r){if(r==o.index){e.splice(i,1);break}}else e.splice(i,1),i--}function pt(e){if(e){for(var t,r={},o=ft(e,"?")?e.split("?")[1]:e,i=0,n=(o=ft(o,"&")?o.split(/&/g):[o]).length;i<n;i++)r[(t=o[i].split("="))[0]]=t[1]?decodeURIComponent(t[1]):t[1];return r}}function ut(e,t){for(var r=0,o=e.length;r<o;r++)t.shift()}function ft(e,t){return-1!=e.indexOf(t)}function ht(e){if(i.running){i==a&&(a=void 0),o&&(clearInterval(undefined),be(o),o=void 0),Et(i.info);for(var t=0,r=i.fns.length;t<r;t++)clearTimeout(i.fns[t]);if(i.pendingResume=void 0,i.running=!1,i.state=i._trans.state=e.state,i._trans.triggerEvent(Q,i.state),le||200==i.state){var l;if(ie.__lp.prevTrans=n=i,te(b),re("Transition completed.",h),se.history&&i.info.fragment)(l=ne.getElementById(i._trans.info.fragment))&&l.scrollIntoView&&0!=ie.beforeScroll(i._trans)&&l.scrollIntoView();fe.afterRouteTransition(i._trans)}else e.iAbort||s==i?(ie.__lp.prevTrans=n=i,i.state&&201!=i.state&&fe.afterRouteTransition(i._trans)):(i.state&&201!=i.state&&fe.afterRouteTransition(i._trans),ie.__lp.trans=i=n);le&&(le=!1)}else n&&(ie.__lp.trans=i=n)}function mt(e){return"/"==e[0]?e:"/"+e}function yt(e){return e.match(/[^/?]+/g)||[]}function _t(e){return e=(e=e.replace(/\/\//g,"/")).replace(/\/\?/g,"?")}function vt(){var e,t=arguments;switch(t[0]){case 400:e=t[1]?"url '"+t[1]+"' is not defined in router.":"Base path of url is not specified.";break;case 405:e="Method not allowed before router initialization.";break;case 422:e="There is no route definition for the route "+t[1].splice(0,t[2]+1).join(".")+".";break;case 424:e="File not loaded in "+t[1]+" of route "+t[2]+".\n"+t[3][0].target.outerHTML;break;case 498:e="Invalid argument "+t[1]+(t[2]?" provided in "+t[2]:".");break;case 499:e=t[1]?"Dynamic params for the route "+t[1]+" is not provided"+(t[2]&&t[2].outerHTML?" in "+t[2].outerHTML:"."):"Transition tried without arguments.";break;case 420:e=(t[3]?"Promise rejected":"Error")+" in "+t[1]+" of route "+t[2]+".";break;case 428:e="There is no outlet named "+t[1]+".";break;case 203:e="Data provided for component is not valid."}return"LR "+t[0]+": "+e}function gt(){Lyte.error(arguments[0].stack?arguments[0]:vt.apply(this,arguments),arguments[3])}function bt(e,t){if(e){var r,o=[];if(se.history){var i=e.split("#");(r=i[1])&&(e=i[0])}var n=e.split("?");if("/"==(e=decodeURI(n[0]))){if(!Ve(["/"],se.routeHash))return void gt(400,e);o.push([e])}else{var a,s=n[1],l=yt(e),d=0,c=[0],p=[];p.dynamicParams=[],function e(t){for(var r in t)if(!a){var i,n=t[r];if("__lp"!=r){var s=yt(r);if(s&&!1!==(i=At(s,l,d,n,p)))if(c.push(i),d=c[c.length-1],l.length==d){var u=Array.from(p.concat(r));if(n["/"]&&(u=u.concat("/")),o.push(u),!n.__lp.wildcard&&!n.__lp.dkey)return void(/[:*]/.test(u.join(""))||(a=u));c.pop(),d=c[c.length-1]}else{var f=Object.keys(n);if(p.push(r),l[d])if(n.__lp.wildcard&&!n.__lp.sufix.length&&1==f.length){var h=Array.from(p);n["/"]&&(h=h.concat("/")),o.push(h)}else f.length>1&&e(n);p.pop(),c.pop(),d=c[c.length-1]}}}}(se.routeHash)}if(a)return Lt(t,a,e,s,r);if(1==o.length)return Lt(t,o[0],e,s,r);if(o.length){return Lt(t,function e(t,r,o){o=o||0;var i,n=n||function(e){for(var t=[],r=0,o=0,i=e.length;o<i;o++){r=(n=e[o]).length>r?n.length:r}var n;for(o=0;n=e[o];o++)for(var a=0;a<r;a++)t[a]=t[a]||[],t[a][o]=n[a];return t}(t),a=Math.max(...n[o]);for(;i=$t(n[o],a,r,t);){o+=1;for(var s=[],l=[],d=0,c=i.length;d<c;d++)s.push(r[d]),l.push(t[d]);var p=[],u=[];for(d=0,c=l.length;d<c;d++)null!=l[d][o]&&(p.push(s[d]),u.push(l[d]));return p.length?1==p.length?p[0]:e(u,p,o):s[0]}return r[n[o].indexOf(a)]}(function(e){for(var t=[],r=0,o=e.length;r<o;r++){var i=Array.from(e[r]),n=0,a=[];"/"==i[0]&&i.shift(),"/"==i[i.length-1]&&i.pop();var s=-1;i.every((function(e,t){var r=!0;return yt(e).every((function(e,o){return s++,e==l[s]?(n++,i.length==t+1&&a.push(n),!0):-1!=e.indexOf(":")?(a.push(n),n=0,!0):(-1!=e.indexOf("*")&&(r=!1),a.push(n),!1)})),r})),t.push(a)}return t}(o),o),e,s,r)}gt(400,e)}else gt(400,"")}function At(e,t,r,o,i){var n;if(!o.__lp.wildcard&&!o.__lp.dkey&&((n=Ve(i,se.routeHash).__lp)&&n.wildcard&&!(r+=t.slice(r).indexOf(e[0]))))return!1;for(var a,s=0;a=e[s];s++,r++)if(a!=t[r]&&!kt(a))if(xt(a))o.__lp.sufix.length&&(r=t.indexOf(o.__lp.sufix[0])-1);else{if("/"!=e[r])return!1;r--}return r}function $t(e,t,r,o){for(var i=[],n=0,a=e.length;n<a;n++)e[n]==t&&i.push(n);return 1!=i.length&&i}function Lt(t,r,o,i,n){var a,s,l,d={route:Ve(r,se.routeHash).__lp.route,queryParams:i?pt(i):{}};if(se.history&&(d.fragment=n),d.dynamicParams=function(e,t){for(var r,o,i=se.routes,n=[],a=yt(e.split("?")[0]),s=0,l=t.route.length;s<l;s++){var d=(i=Ve([t.route[s]],i)).__lp;if(d.wildcard)if(d.sufix.length){var c=a.slice(0,a.indexOf(d.sufix[0]));o=decodeURI(c.join("/")),ut(c.concat(d.sufix),a)}else o=decodeURI(a.join("/"));else d.dkey?(r=a[d.dIndex],ut(yt(d.path),a),o=decodeURI(r)):(ut(yt(d.path),a),o=void 0);n.push(o)}return n}(o,d),t)return d;d.dpProcessed=!0;var c=It(d);return 0!=c&&(s=Lyte.deepCopyObject(c.matched),l=Lyte.deepCopyObject(c.matched),c.matched.hasOwnProperty("refreshModel")||je(c.matched),a=je(l),Dt(l.queryParams,s.queryParams)||(be({replace:!0,state:e.history.state,url:a,fromHistory:!0}),c.path=a)),c}function Et(e){se.linkActiveClass&&se.allLinks[e.route]&&se.allLinks[e.route].forEach((function(t){var r=t.getAttribute(z);if(Ne(e.dynamicParams,r?JSON.parse(r):[])){t.classList.add(se.linkActiveClass),se.activeLinkTags.push(t);var o=t.getElementsByTagName("A")[0];o&&o.setAttribute("href",ie.getURL(t.getMatchedObject()))}}))}function Rt(e,t,r,o){e&&e.mixins&&(Array.isArray(e.mixins)||(e.mixins=[e.mixins]),e.mixins.forEach((function(e){if(Lyte.registeredMixins[e])if(e=Lyte.registeredMixins[e],o){var s=ie.getRouteInstance(r,n),l=ie.getRouteInstance(r,i),d=a&&ie.getRouteInstance(r,a);s||l?function(e,t,r,o,i){for(var n in e)"actions"==n?(t.actions||(o.actions=r.actions=t.actions={}),r.actions=o.actions=Object.assign(t.actions,e.actions),i&&(i.actions=r.actions)):(r[n]=o[n]=t[n]=e[n],i&&(i[n]=r[n]))}(e,t,s=s||{},l=l||{},d):Ct(e,t)}else Ct(e,t);else o||Lyte.$.requiredMixins(e,r,"router")})))}function wt(e,t,r,o,i,n){if(e&&e.services){var a=[],s=[];e.services.forEach((function(e){"string"==typeof e?a.push(e):e&&"object"==typeof e&&(i||!e.scope||e.scope&&"static"==e.scope?a.push(e):s.push(e))}))}(a&&a.length&&function(e,t,r,o,i,n){var a=Nt(r,t);Lyte.extendService({services:e||[],type:"route",ins:o||a,isGlobal:i,data:n,callback:function(e,o,n,a){var s={};s.as=o,s.service=a,Lyte.extendService({services:[s],type:"route",isGlobal:i,ins:r?Nt(r,t):Pt()})}})}(a,t,r,o,i,n),s&&s.length)&&Nt(r,t).forEach((function(e){e&&e.__lp&&(e.__lp.toBeUsed=s)}))}function Nt(e,t){var r,o=[t];return[n,a,i].forEach((function(t){t&&(r=ie.getRouteInstance(e,t))&&o.push(r)})),o}function Pt(e,t){var r=!e;for(var o in t=t||[],e=e||se.routes)"__lp"==o?e.__lp.def&&t.push(e.__lp.def):Pt(e[o],t);if(r)return n&&n!=i&&(t=t.concat(n.routes)),i&&(t=t.concat(i.routes)),t}function Ct(e,t){for(var r in e)"actions"==r?t.actions=Object.assign(t.actions||{},e.actions):t[r]="queryParams"==r?Lyte.deepCopyObject(e[r]):e[r]}function Ot(e,t,r){if(Rt(r,t,e),t.__lp={options:r,objPath:e.replace(/\//g,"."),stickyLinks:[],linkTags:[]},wt(r,t,e),Lyte.toBeInjectedServices){var o=Lyte.toBeInjectedServices,i=[];for(var n in o)i.push({as:n,service:o[n]});wt({services:i},t,e,void 0,!0)}var a=se.queryParamOptions.sticky;t.queryParams&&(t.__lp.qpdef={},t.queryParams.forEach((function(r,o){if("string"==typeof r)t.__lp.qpdef[r]={sticky:a,refreshModel:!0},null==se.stickyRoutes[e]&&a&&(se.stickyRoutes[e]=a);else if("object"==typeof r){for(var i in r)t.__lp.qpdef[i]={cipher:r[i].cipher,sticky:r[i].hasOwnProperty("sticky")?r[i].sticky:a,refreshModel:!r[i].hasOwnProperty("refreshModel")||r[i].refreshModel},!se.stickyRoutes[e]&&t.__lp.qpdef[i].sticky&&(se.stickyRoutes[e]=!0);t.queryParams[o]=i}}))),e=Ce(e),t.routeName=e[e.length-1],function(e,t){for(var r,o=se.routes,i=e.length,n=i-1,a=0;a<i;a++){if(r=e[a],n===a){var s=o[r];s&&s.__lp?s.__lp.def=t:s?s.__lp={def:t}:o[r]={__lp:{def:t}}}else o[r]||(o[r]={});o=o[r]}}(e,t)}qe.prototype.run=function(e){e?st.call(this,this.runLoop.forceFetch,this.fRunningProm.resolve,e):(nt.call(this),ne.title=this.title=this.routes[this.routes.length-1].title||ne.title)},Lyte.$.requiredMixins.router=function(e,t){t.forEach((function(t){var r=ie.__lp.getDefinition(t);e&&r&&Rt(r.__lp.options,r,t,!0)}))},Lyte.$.injectServices.router=function(e,t,r,o,i,n){var a={};a.as=e,a.service=t,wt({services:[a]},void 0,void 0,Pt(),!0,n)},this.registerRoute=function(){se.routes?Ot.apply({},arguments):this.__lp.pendingReg.push(arguments)};var Tt=["runLoop","running","paused","R","routes",_,"prom","run",m,"matched","fns"];function St(e){for(var t in e)-1==Tt.indexOf(t)&&("info"==t?this.info=Lyte.deepCopyObject(e[t]):this[t]=e[t])}function kt(e){return ft(e,":")}function xt(e){return ft(e,"*")}function Dt(e,t){var r=Object.keys(e),o=Object.keys(t);if(r.length!=o.length)return!1;for(var i in e)if(e[i]!=t[i])return!1;return!0}function jt(e){var t;return"object"==typeof e?t=e:(t={queryParams:{},dynamicParams:[]},Array.from(arguments).forEach((function(e,r){Array.isArray(e)?gt(498,JSON.stringify(e)):0==r?t.route=e:e&&"object"==typeof e?t.queryParams=Lyte.deepCopyObject(e):t.dynamicParams.push(e)}))),t}function It(e){if(e.route){var t,r=se.routes,o=[],i=function(e,i){if(!(r=Ve(e,r)))throw Error(vt(400,n.target));if(!(t=r.__lp.def))throw Error(vt(422,n.route,i));o.push(t)};if(e._routes)n=e;else{var n={route:Array.isArray(e.route)?e.route:Ce(e.route),queryParams:e.queryParams||{},dynamicParams:[],fragment:e.fragment,target:"",refreshRoute:e.refreshRoute,startFrom:e.startFrom,_routes:[]};if(e.dynamicParams)if(e.dpProcessed)n.dynamicParams=Array.from(e.dynamicParams);else var a=Array.from(e.dynamicParams)}try{n.route.forEach(e._routes?i:function(e,t){n.target=n.target?n.target+"."+e:e,n._routes.push(Ce(n.target)),i(e,t),a&&n.dynamicParams.push(r.__lp.dkey?a.shift():void 0)}),a&&a.length&&Lyte.error("Extra dynamic params found. Provide exact numbers dynamic params required for the transition "+JSON.stringify(a))}catch(e){return gt(e),!1}return{matched:n,R:o}}this.tagName==J?gt(498,H,this.outerHTML):gt(499)}this.getRouteInstance=function(e,t){var r;if(ie&&!ie.init&&(r=t||ie.__lp&&ie.__lp.trans||i)&&r.routes){var o=r.routes.length;if(e){if("*"==e)return r.routes;var n=e.split(".").length-1,a=r.routes[n];return a&&a.__lp.objPath==e?a:void 0}return r.routes[o-1]}};var Mt=[A,$,L,E,R,w,N,P,C],Bt=function(e,t,o,n,s){var l=this,d=s||t;for(var c in d)!s&&ft(Mt,c)||("__lp"==c?this.__lp=Lyte.deepCopyObject(d.__lp):this[c]=d[c]);if(n.transComp&&!n.transComp.rendered[o]&&n.transComp.redirected&&n.transComp.redirected.index<o&&(delete this.__lp.loadDependencies,delete this.__lp.loadResources,this.$={},delete this.currentModel),this.__ltp={queryParams:{}},this.__lp&&this.__lp.toBeUsed&&this.__lp.toBeUsed.length){l=this;Lyte.extendService({services:this.__lp.toBeUsed||[],type:"route",ins:this,callback:function(e,t,r,o){var i={};i.key=t,i.service=o,Lyte.extendService({services:[i],type:"route",ins:l})}})}function p(e){var t=je(e),o={matched:e,R:i.R};return r={data:i.data,url:t,fromHistory:!1},Me(t,Ht(o)),a._trans}this.transition=a._trans,this.parent=e[o-1],s||(this.$={},this.init&&this.init(),this.throwEvent=void 0!==Lyte.Component&&Lyte.Component.throwEvent),this.replaceWith=ie.replaceWith,this.transitionTo=ie.transitionTo,this.removeFromCache=function(e){Lyte.removeFromCache.assign(e)},this.refresh=function(e){var t=Ce(this.__lp.objPath).length-1,o=Array.from(i.matched.route),n={matched:i.matched,R:i.R,transComp:{unRendered:o.splice(t),rendered:o}};if(i.abort({state:308,iAbort:!0}),r={replace:!0,data:i.data,fromHistory:!1,url:i.url},Me(i.url,n),e&&e.refreshTemplate)for(var s,l=t;s=a.routes[l];l++)delete s.component;return a._trans},this.setTitle=function(e){ne.title=this.title=e},this.getQueryParams=function(){return this.__ltp.queryParams||{}},this.getDynamicParam=function(){return this.__ltp.dynamicParam},Object.defineProperty(l,"$lg",{value:Lyte.__gl}),this.getRouteInstance=function(e){return ie.getRouteInstance(e)},this.setDynamicParam=function(e){if(e&&this.__ltp.dynamicParam&&this.__ltp.dynamicParam!=e){var t=Array.from(i.matched.dynamicParams);return t.splice(this.__lp.objPath.split(".").length-1,1,e),p(Ft(i.matched,{dynamicParams:t}))}return i._trans},this.setQueryParams=function(e,t,r){var o,n={};"object"==typeof e?(n=e,r=t):n[e]=t,"object"==typeof r&&(o=r.refresh),o=r;var a=Ft(i.matched,{queryParams:Object.assign({},i.matched.queryParams,n)});return Dt(i.matched.queryParams,a.queryParams)?i._trans:(a.refreshModel=null==a.refreshModel?o:a.refreshModel,p(a))}};function Ft(e,t){var r=Object.assign({},e);return r.route=t.route||Array.from(e.route),r.dynamicParams=t.dynamicParams||Array.from(e.dynamicParams),r.queryParams=t.queryParams||Object.assign(e.queryParams),r}var Kt=[A,$,L,E,R,w,N,P];function Ht(e){if(i)if(i.running){var t=e.matched;if(102==i.state&&i.prom&&i.prom.hook==w){var r=Be(i,t,e.R),o=Kt.indexOf(i.prom.hook)<=5?i.prom.index:i.prom.index+1,n=Be(s,t,e.R);r.common.length<n.common.length?(r.rendered.length<n.rendered.length&&(e.prevTrans=s,i.runLoop.templateToRemove.length&&i.runLoop.templateToRemove.pop()),r=n,i.prom.index<=n.common.length-1&&(r.redirected=i.prom)):r.common.length-1>=o&&i.prom.index<=r.common.length-1&&(e.prevTrans=i,r.redirected=i.prom)}var a={route:t.target,queryParams:t.queryParams,dynamicParams:t.dynamicParams.filter(Oe)};ie.checkIfSameRoute(i.info,a)&&!i.aborted?i.pause({iPause:!0}):i.abort({state:409,iAbort:!0}),e.transComp=r}else i&&!i.aborted&&i.abort({state:409,iAbort:!0});return e}return this}}(window),function(e){e._wrapperComponents=[];var t=e.isLyteWidgetParent?e._widgetLyte:e.Lyte,r=t;e.__lyteConfig||(e.__lyteConfig={_definedBeforeBridging:[],_alreadyDefinedBeforeBridging:[],v3:!0,_pendingV3Components:{},_firstRegisteredComp:{}});let o=e.__lyteConfig;if(o.customElementsDefine||(o.customElementsDefine=customElements.constructor.prototype.define,Object.defineProperty(customElements.constructor.prototype,"define",{value:function(e,t,r,i){customElements.get(e)?o._alreadyDefinedBeforeBridging.push({name:e,compClass:t,options:r,_lyteOptions:i,scope:this}):(o._definedBeforeBridging.push({name:e,compClass:t,options:r,_lyteOptions:i,scope:this}),o.customElementsDefine.apply(this,arguments))},enumerable:!1})),o.instanciateBridge||(o.instanciateBridge=function(){if(o.isWidgetBuild||o._LyteCustomElement&&o._customElementPrototype&&o._LyteYield){o.instanctiatedBridge=!0;o.versionBridge={component:{}};class t{static define(r,i,n,a){var s,l;if(!o.isWidgetBuild)if(a)if("lyte-yield"==r)a&&a.widget||(s=o._LyteYield);else if(a&&a.v4raw){let e=o._LyteCustomElement;s=class extends e{constructor(){super()}}}else if(a&&a.v3raw){let e=o._LyteCustomElement;s=class extends e{constructor(){super()}}}else if(a&&(a.v3||a.v4)){let e=o._customElementPrototype;s=class extends e{constructor(){super()}}}else a&&(a.widget||a.widgetRaw)&&console.log("Dummy");else l=!0;var d=arguments;if(!l&&a){a.v3?(P.V3.pendingComp.firstRegister(r,"v3"),t.allList.v3[r]=i,o.isWidgetBuild||(s._observedAttributes=i._observedAttributes,d=[r,s])):a.widget?(P.V3.pendingComp.firstRegister(r,"widget"),t.allList.widget[r]=i):a.widgetRaw?(t.allList.widgetRaw[r]=i,P.V3.pendingComp.firstRegister(r,"widgetRaw")):a.v3raw?(t.allList.v3raw[r]=i,P.V3.pendingComp.firstRegister(r,"v3raw")):a.v4raw?(t.allList.v4raw[r]=i,P.V3.pendingComp.firstRegister(r,"v4raw")):a.v4&&(t.allList.v4[r]=i,P.V3.pendingComp.firstRegister(r,"v4")),customElements.get(r)||t.definedHere[r]||(e.__lyteConfig.customElementsDefine.apply(this,d),t.definedHere[r]=i)}else e.__lyteConfig.customElementsDefine.apply(this,d)}static register(){[o._alreadyDefinedBeforeBridging,o._definedBeforeBridging].forEach((function(e){e&&e.length&&e.forEach((function(e){e._lyteOptions&&(e._lyteOptions.v3raw?(t.allList.v3raw[e.name]=e.compClass,P.V3.pendingComp.firstRegister(e.name,"v3raw")):e._lyteOptions&&e._lyteOptions.v4raw?(t.allList.v4raw[e.name]=e.compClass,P.V3.pendingComp.firstRegister(e.name,"v4raw")):e._lyteOptions&&e._lyteOptions.v3?(t.allList.v3[e.name]=e.compClass,P.V3.pendingComp.firstRegister(e.name,"v3")):e._lyteOptions&&e._lyteOptions.v4?(t.allList.v4[e.name]=e.compClass,P.V3.pendingComp.firstRegister(e.name,"v4")):e._lyteOptions&&e._lyteOptions.widget?(t.allList.widget[e.name]=e.compClass,P.V3.pendingComp.firstRegister(e.name,"widget")):e._lyteOptions&&e._lyteOptions.widgetRaw&&(t.allList.widgetRaw[e.name]=e.compClass,P.V3.pendingComp.firstRegister(e.name,"widgetRaw")))}))})),o.versionBridge||o.customElementsDefine||(o.customElementsDefine=customElements.constructor.prototype.define),Object.defineProperty(customElements.constructor.prototype,"define",{value:function(e,r,o,i){t.define.apply(this,[e,r,o,i])},enumerable:!1})}}o.versionBridge.component.V3Registry=t,t.allList={v3:{},v4:{},other:{},v3raw:{},v4raw:{},widget:{},widgetRaw:{}},t.definedHere={},t.register()}}),t.Security={_ourSanitizerInstance_:{},_userSanitizerInstance_:{},_eM:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},_eR:/[&<>"'`=]/g,_eF:function(e){return this._eM[e]},escape:function(e){return"string"!=typeof e&&(e=""+e),e.replace(this._eR,this._eF.bind(this))}},!e.isLyteWidget){var n={GLOBAL_TAGS:[],GLOBAL_ATTRIBUTES:[],FORBID_TAGS:[],FORBID_ATTR:[],REUSE_CONFIG:!0};t.Security._ourSanitizerInstance_=ZWAF["7_0_0"].HTMLPurifier(n),t.Security._ourSanitizerInstance_._GLOBAL_TAGS=n.GLOBAL_TAGS,t.Security._ourSanitizerInstance_._GLOBAL_ATTRIBUTES=n.GLOBAL_ATTRIBUTES,n.GLOBAL_ATTRIBUTES.push("is","yield-name","lt-prop-route","lt-prop-dp","lt-prop-fragment","lt-prop-qp","lt-prop","lt-prop-class","lt-prop-id","lt-prop-rel","lt-prop-title","lt-prop-style","lt-prop-target","lt-prop-td","lt-prop-custom","lt-prop-target","lt-prop-id","lt-prop-class","lt-prop-style","lt-prop-rel","lt-prop-title"),n.GLOBAL_TAGS.push("link-to"),t.Security._ourSanitizerInstance_._FORBID_TAGS=n.FORBID_TAGS,t.Security._ourSanitizerInstance_._FORBID_ATTR=n.FORBID_ATTR,t.Security.createSanitizer=function(e){e&&e.__target__&&(e=e.__target__),e.GLOBAL_ATTRIBUTES||(e.GLOBAL_ATTRIBUTES=[]),e.FORBID_TAGS||(e.FORBID_TAGS=[]),e.FORBID_ATTR||(e.FORBID_ATTR=[]),e.GLOBAL_TAGS||(e.GLOBAL_TAGS=[]),e.REUSE_CONFIG=!0,e.GLOBAL_ATTRIBUTES.push("is","yield-name","lt-prop-route","lt-prop-dp","lt-prop-fragment","lt-prop-qp","lt-prop","lt-prop-class","lt-prop-id","lt-prop-rel","lt-prop-title","lt-prop-style","lt-prop-target","lt-prop-td","lt-prop-custom","lt-prop-target","lt-prop-id","lt-prop-class","lt-prop-style","lt-prop-rel","lt-prop-title"),e.GLOBAL_TAGS.push("link-to");for(var o=Array.from(e.GLOBAL_TAGS),i=[],n=0;n<o.length;n++)if(P._registeredComponents[o[n]]?i=P._registeredComponents[o[n]].observedAttributes:r.registeredCustomComponent[o[n]]&&(i=r.registeredCustomComponent[o[n]].observedAttributes),i)for(var a=0;a<i.length;a++)-1==e.GLOBAL_ATTRIBUTES.indexOf(i[a])&&e.GLOBAL_ATTRIBUTES.push(i[a]);return t.Security._userSanitizerInstance_=ZWAF["7_0_0"].HTMLPurifier(e),t.Security._userSanitizerInstance_._GLOBAL_TAGS=e.GLOBAL_TAGS,t.Security._userSanitizerInstance_._GLOBAL_ATTRIBUTES=e.GLOBAL_ATTRIBUTES,t.Security._userSanitizerInstance_._FORBID_TAGS=e.FORBID_TAGS,t.Security._userSanitizerInstance_._FORBID_ATTR=e.FORBID_ATTR,t.Security._userSanitizerInstance_}}var a=["focus","focusin","focusout","resize","scroll","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","change","select","submit","keydown","keypress","keyup","contextmenu"];function s(e,t){e[t]||defProp(e,t,{value:new Set,enumerable:!1,writable:!0,configurable:!0})}function l(e,t){let r=e._bindings;r||(s(e,"_bindings"),r=e._bindings),r.add(t)}function d(e,t){e[t]||defProp(e,t,{value:[],enumerable:!1,writable:!0,configurable:!0})}function c(){return document.createDocumentFragment()}function p(e){return document.createElement(e)}function u(e,t,r){e.insertBefore(t,r)}function f(e,t,r){e[t].delete(r),e[t].size||delete e[t]}e.defProp=function(){Object.defineProperty.apply(Object,arguments)},t.registerErrorCodes({LC001:"Error while parsing custom prop handler attribute {0}. Check if the value provided is a valid JSON",LC002:"{0} Component is not compiled. Please compile using Lyte CLI",LC003:"Helper named {0} is not defined",LC004:"Action named {0} doesn't exists",LC005:"Lyte.objectUtils doesn't support {0} function",LC006:"Lyte.arrayUtils doesn't support {0} function",LC007:"Component name not specified in Lyte.Component.render",LC008:"Specified outlet {0} doesn't exists - Lyte.Component.render",LC009:"Method named {0} doesn't exists in {1} component",LC010:"Parent Node / reference Node not provided for insertBefore method",LC011:"Error in promise provided in initialize function of data '{0}' of {1} component"});let h=navigator.userAgent;if(h.match(/rv:11/)&&(t._ie=!0,e.action=function(){}),h.match("Edge")){var m=p("div");m.innerHTML="<template><div>c</div></template>",m.querySelector("template").childNodes.length?t._ie=!0:t._ed=!0,m.remove()}class y extends HTMLElement{constructor(){super(),this.attributes.t||(P.frSpecial=!0)}}if(t._ie||t._ed){var _=c();_.appendChild(document.createTextNode("  dummy ")),_.childNodes[0].replaceWith(document.createTextNode("changed")),"changed"!==_.childNodes[0].textContent&&(t._rwpf=!0),t._ms=!0}t.Component={},r.Compile={};var v=t.Component;function g(){}t.arrayUtils=function(){return P.aF.apply(P,arguments)},t.objectUtils=function(){return P.oF.apply(P,arguments)},Object.defineProperty(v,"register",{get:function(){return r._preRegister(),P.registerComponentWrapper},enumerable:!0}),v.getComponentClass=function(e){return P._registeredComponents[e]},v.registerHelper=function(){P.registerHelper.apply(P,arguments)},v.set=function(){P.set.apply(P,arguments)},v.registeredHelpers={},v.registeredComponents={},v.customPropHandlersList={},v.registerCustomPropHandler=function(e){P.String.dasherize(e);if(e=P.String.toCamelCase(e),-1===P.customPropHandlers.indexOf(e)){P.customPropHandlers.push(e);let t=R.prototype[e]=function(){let t=arguments.length,r=arguments[0],o=arguments[2],i=N.getCmpData(this.component.data);if(!r){let t={};for(let r in i)if(r.startsWith(e)){let o=r.substring(e.length);o=P.String.lowerCaseFirstLetter(o),t[o]=i[r]}return t}if("string"==typeof r){if(!(t>1)){return i[e+P.String.upperCaseFirstLetter(r)]}this.set(e+P.String.upperCaseFirstLetter(r),arguments[1],o)}else if("object"==typeof r)for(let t in r){let o=e+P.String.upperCaseFirstLetter(t);this.set(o,r[t],arguments[1])}};v.customPropHandlersList[e]=t,P.customPropRegex=new RegExp("^("+P.customPropHandlers.join("|")+")")}},v.unregisterComponent=function(e,r){if(r=r||{},v.registeredComponents[e]){var o=P._registeredComponents[e];if(o.activeInstances>0)t.warn("There are active instances of the component "+e+" and hence cannot be unregistered");else if(o.component.activeInstances>0)t.warn("There are active instances of the component "+e+" and hence cannot be unregistered");else{o._properties=o.component._properties={},o._mixins=o._actions=o._template=o._dynamicNodes=null,o._callBacks=o.component._callBacks={},o._observers=o.component._observers=[],o._data=o.component_data=void 0,o._methods=o.component._methods={},o.prototype.get=g,o.prototype.set=g,Object.defineProperty(o.prototype,"setData",{configurable:!0,writable:!0,value:function(e,t){if(this._initProperties=this._initProperties||{},"string"==typeof e)this._initProperties[e]=t;else if("object"==typeof e)for(let t in e)this._initProperties[t]=e[t]}}),Object.defineProperty(o.prototype,"setMethods",{configurable:!0,writable:!0,value:function(e,t){if(this._initMethods=this._initMethods||{},"string"==typeof e)this._initMethods[e]=t;else if("object"==typeof e)for(let t in e)this._initMethods[t]=e[t]}}),delete v.registeredComponents[e];var i=document.querySelector("template[tag-name="+e+"]");i&&i.remove();var n=o._helperTemplate;n&&n.remove(),o.component._depthTemp&&o.component._depthTemp.remove()}}else t.warn("Component "+e+" not yet registered")},t.createCustomElement=function(i,n){var a=n.constructor;delete n.constructor;var s=n.connectedCallback;delete n.connectedCallback;var l=n.attributeChangedCallback;delete n.attributeChangedCallback;var d=n.disconnectedCallback;delete n.disconnectedCallback,this.defProperty=function(e,t,r){var o={};r.get&&(o.get=r.get),r.set&&(o.set=r.set),Object.defineProperty(e,t,o,!0)};class c extends HTMLElement{constructor(){super(),e.ignoreParent?this.__lyteIgnore=!0:this.decideConstructor()}decideConstructor(){if(o&&(o.v4||o.isWidgetBuild)){let t=o.versionBridge.component.V3Registry,r=t.allList.v4raw[this.localName],i=t.allList.v3raw[this.localName],n=t.allList.widgetRaw[this.localName];if(r){if(!i||this._callee&&this._callee.__v4||this.hasAttribute("lyte-v4")||this.hasAttribute("lyte-registry")||o.lyteV4||o.fromV4Render){let e=r,t=this;c._V4InsApi.forEach((function(r){t[r]=e.prototype[r]}))}}else if(n)if(this._callee&&this._callee.__widget||this.hasAttribute("lyte-widget")||e.__lyteConfig.isWidgetComponent||o.lyteWidget||o.fromWidgetRender){let e=n,t=this;"widgetRaw"!=o._firstRegisteredComp[this.localName]&&c._V3InsApi.forEach((function(r){t[r]=e.prototype[r]}))}else{if(!i)return P.V3.pendingComp.add(this),void(this.__v3lyteIgnore=!0);{let e=i;"v3raw"!=o._firstRegisteredComp[this.localName]&&c._V3InsApi.forEach((function(t){self[t]=e.prototype[t]}))}}}this.actualConstructor()}actualConstructor(){this.isNewComp(i)?this.executeCallbacks(a,arguments):this.__lyteIgnore=!0}connectedCallback(){this._connectedCallback()}_connectedCallback(){this.__lyteIgnore||this.hasAttribute("lyte-rendered-ce")||(this.executeCallbacks(s,arguments),this.setAttribute("lyte-rendered-ce",""),this._connectedCalled=!0)}attributeChangedCallback(e,t,r){this._attributeChangedCallback(e,t,r)}_attributeChangedCallback(){this.__lyteIgnore&&!this.__v3lyteIgnore||this.executeCallbacks(l,arguments)}disconnectedCallback(){this._disconnectedCallback()}_disconnectedCallback(){this.__v3lyteIgnore?P.V3.pendingComp.remove(this):v.shouldIgnoreDisconnect()||this.__lyteIgnore||this.executeCallbacks(d,arguments)}executeCallbacks(e,t){e&&e.apply(this,Array.from(t))}isNewComp(e){return!this.hasAttribute("lyte-rendered-ce")}}c._V4InsApi=["_connectedCallback","_attributeChangedCallback","_disconnectedCallback","actualConstructor","executeLyteCallbacks","isClonedNode","_isClonedAttribute","isClonedAttribute"],c._V3InsApi=["_connectedCallback","_attributeChangedCallback","_disconnectedCallback","actualConstructor","executeCallbacks","isNewComp"];var p=n.static;if(n._static=p,p){for(var u in p)"object"==typeof p[u]?this.defProperty(c,u,p[u]):Object.defineProperty(c,u,{value:p[u]});delete n.static}for(var u in c._definition=n,n)"object"==typeof n[u]?this.defProperty(c.prototype,u,n[u]):Object.defineProperty(c.prototype,u,{writable:!0,value:n[u]});n.static=p,n.constructor=a,n.connectedCallback=s,n.attributeChangedCallback=l,n.disconnectedCallback=d,"complete"===document.readyState||"interactive"===document.readyState?customElements.define(i,c,void 0,t.isWidgetBuild?{widgetRaw:!0}:{v3raw:!0}):N.toBeRegistered.push({name:i,def:c,_lyteOptions:t.isWidgetBuild?{widgetRaw:!0}:{v3raw:!0}}),r.registeredCustomComponent[i]=c};var b="undefined"!=typeof HTMLElement?HTMLElement:Element;function A(){t._ie||document.body.appendChild(P.lyteComponentsDiv),document.body.appendChild(P.hDiv);let o=a;for(let e=0;e<o.length;e++){var i=o[e];document.body.addEventListener(i,L,!0)}let n=P.toBeRegistered;if(n.length){for(let e=0;e<n.length;e++)customElements.define(n[e].name,n[e].def,void 0,n[e]._lyteOptions);P.toBeRegistered=[]}if(/iPad|iPhone|iPod/.test(h)&&!e.MSStream){var s=p("style");s.innerHTML="* { cursor : pointer}",document.head.appendChild(s)}if(r.isWidgetBuild){let t=r.$.widgetWrapper;document.body.appendChild(t),e.docEventListenerHandler&&e.docEventListenerHandler.attachShadow(t.shadowRoot),N.shadow.shadowList.push(t.shadowRoot),t.shadowRoot._shadowChild=[],t.shadowRoot._lyteShadow=!0,t.shadowRoot._compList=[],t.shadowRoot._duplicateStyle=[],t.shadowRoot._linkRef=[],t.instantiated=!0,N.shadow.attachEvents(t.shadowRoot)}}t.appendTemplateDiv=function(){document.body.appendChild(P.tDiv),document.body.appendChild(P.h1Div)},document._addShadowForGlobalRegistry=function(e){for(let r=0;r<a.length;r++){var t=a[r];e.addEventListener(t,L,!0)}for(var r=0;r<windowEventListeners.length;r++)e.addEventListener.apply(e,windowEventListeners[r]);e.addEventListener("change",$)};var $=function(e){var t=e.target||e.srcElement;if(!t._attributeDetails)return;var r="value";"checkbox"!==t.type&&"radio"!==t.type||(r="checked");let o=[];var i=t._attributeDetails[r];let n=P.directive.save.getAttr(t._specialAttributeDetails);if(!i||!i.isLbind&&!n)return;var a=t;if(!t._callee){for(;a&&!P.isCustomElement(a)&&"LYTE-YIELD"!==a.tagName;){if("BODY"===a.tagName){a=null;break}a=a.parentNode}a&&"LYTE-YIELD"===a.tagName?t._callee=a._registerYield._callee:t._callee=a}let s=t._callee;if(n)P.directive.save.triggerAllListeners(s,n.hookName,t,!0);else{if(t&&P.adCx(t,o),i){let e=P.getNew(s.component.data,i.dynamicValue);if(!e.context)return;let o=+e.lastKey;if(Array.isArray(e.context)&&"number"==typeof o){let i=o<e.context.length;e.context[o]===t[r]&&i||P.aF(e.context,i?"replaceAt":"insertAt",o,t[r])}else P.set(e.context,e.lastKey,t[r])}t&&P.rmCx(t,o)}};document.addEventListener("change",$);var L=function(r){var o,i=r.target,n=r.type;if(/^(click|dblclick)$/.test(n)&&i.getAttribute&&null!=i.getAttribute("lyte-state"))return void r.preventDefault();!r.currentTarget||r.currentTarget===document.body||r.currentTarget instanceof DocumentFragment||(i=r.currentTarget),e.event||(o=!0,e.event=r);let a=!1;for(;i&&i.getAttribute&&(!i.getAttribute(n)||i.hasAttribute("disabled")&&"blur"!=n)&&"BODY"!=i.tagName&&(!P.hasLyteEvents(i,n)||(a=P.handleLyteEvents(i,r),!a));)i=i.parentNode;if(!a&&i){var s=i;if(!(i._callee&&i._callee.component&&i._callee.component.constructor._v4||i.component&&i.component.constructor&&i.component.constructor._v4)){if(!i._callee){for(;s&&!P.isCustomElementV3(s)&&"LYTE-YIELD"!==s.tagName;){if("BODY"===s.tagName){s=null;break}s=s.parentNode}s&&"LYTE-YIELD"===s.tagName?i._callee=s._registerYield._callee:i._callee=s===i?void 0:s}if(i._evBoundEvents&&i._evBoundEvents[n]){let e=i._evBoundEvents[n],o=t.deepCopyObject(e);P.skipArgProcessing(o,r,i),P.throwAction.call(i,i,n,o,void 0,void 0,i,r,void 0,!0)}else if(i.getAttribute&&i.getAttribute(n)&&i._boundEvents&&i._boundEvents[n]){i.getAttribute(n).split(" => ")[1];let e=i._boundEvents[n],o=t.deepCopyObject(e);P.skipArgProcessing(o,r,i),P.throwAction.call(i._callee,i._callee,n,o,void 0,void 0,i,r)}if("LABEL"===i.tagName){var l=i.querySelector("input");if(l&&l.getAttribute(n)){l.getAttribute(n).split(" => ")[1];let e=i._boundEvents[n],o=t.deepCopyObject(e);P.skipArgProcessing(o,r,i),P.throwAction.call(i._callee,i._callee,n,o,void 0,void 0,l,r)}}o&&(e.event=void 0),r._handledResolve&&r._handledResolve()}}else r._handledResolve&&r._handledResolve()};class E extends HTMLElement{constructor(){super(),this.decideConstructor()}decideConstructor(){if(o&&(o.v4||e.__lyteConfig.isWidgetBuild)){let t=o.versionBridge.component.V3Registry,r=t.allList.v4[this.localName],i=t.allList.v3[this.localName],n=t.allList.widget[this.localName];if(r){if(!i||this._callee&&this._callee.__v4||this.hasAttribute("lyte-v4")||this.hasAttribute("lyte-registry")||o.lyteV4||o.fromV4Render){let e=r,t=this;E._V4InsApi.forEach((function(r){t[r]=e.prototype[r]}))}}else if(n)if(this._callee&&this._callee.__widget||this.hasAttribute("lyte-widget")||e.__lyteConfig.isWidgetComponent||o.lyteWidget||o.fromWidgetRender){let e=n,t=this;"widget"!=o._firstRegisteredComp[this.localName]&&E._V3InsApi.forEach((function(r){t[r]=e.prototype[r]}))}else{if(!i)return P.V3.pendingComp.add(this),void(this.__v3lyteIgnore=!0);{let e=i;"v3"!=o._firstRegisteredComp[this.localName]&&E._V3InsApi.forEach((function(t){self[t]=e.prototype[t]}))}}}}connectedCallback(){this._connectedCallback()}_connectedCallback(){var e;(this._callee=this._callee||P.getCallee(this.parentNode,this),!this._registerYield&&this._callee)&&(this._callee._fR&&this._callee._fR._yieldCallee?this._registerYield={_callee:this._callee._fR._yieldCallee.component.$node}:this._callee._yields&&(e=this.attributes["yield-name"])&&(e=e.nodeValue)&&this._callee._yields[e]&&(this._registerYield={_callee:this._callee._yields[e]._callee}))}disconnectedCallback(){this._disconnectedCallback()}_disconnectedCallback(){if(this.__v3lyteIgnore)return void P.V3.pendingComp.remove(this);if(v.shouldIgnoreDisconnect()||this._deleted)return;if(this._deleted=!0,!this._properties)return;var e=[];let t=N.getCmpData(this.component.data);P.adCx(this,e),P.removeSelectedBindingDeep(this._properties,t,!0);let r=this._registerYield;if(r){var o=[],i="delete";P.adCx(r,o);for(let e in this._dynamicProperty)if(this._dynamicProperty[e].isActualNode)this._dynamicProperty[e].isActualNode._helperNodes[i](this);else{let t=r._callee.getProperty(e)._helperNodes;t&&t[i](this)}this._dynamicProperty={};for(let e=0;e<this._helpers.length;e++)r._callee.removeHelpers(this._helpers[e]);this._helpers=[],P.rmCx(r,o),P.rmCx(this,e)}else P.rmCx(this,e)}getProperty(e){var t=e.match(/([^[\].]+|\[\])/g);let r=this;r._properties[t[0]]||(r._properties[t[0]]={}),r=r._properties[t[0]],defProp(r,"_path",{enumerable:!1,value:t[0]});for(let e=1;e<t.length;e++)(t[e].startsWith("'")||t[e].startsWith('"'))&&(t[e]=t[e].substring(1,t[e].length-1)),r[t[e]]||(r[t[e]]={},defProp(r[t[e]],"_path",{enumerable:!1,value:r._path+"."+t[e]})),r=r[t[e]];return r}}E._V4InsApi=["_connectedCallback","getProperty","_disconnectedCallback"],E._V3InsApi=["_connectedCallback","getProperty","_disconnectedCallback"],customElements.define("lyte-yield",E,void 0,t.isWidgetBuild?{widget:!0}:{v3:!0});class R extends b{constructor(){super(),e.isLyteWidget&&e.parentWrapperComps&&-1!=e.parentWrapperComps.indexOf(this.tagName)&&!this.children.length&&(this.__lyteIgnore=!0),e.ignoreParent?this.__lyteIgnore=!0:this.decideConstructor()}decideConstructor(){if(e.__lyteConfig&&(e.__lyteConfig.v4||e.__lyteConfig.isWidgetBuild)){let t=this,r=o.versionBridge.component.V3Registry,i=r.allList.v4[this.localName],n=r.allList.v3[this.localName],a=r.allList.widget[this.localName];if(i){if(!n||this._callee&&this._callee.__v4||this.hasAttribute("lyte-v4")||this.hasAttribute("lyte-registry")||o.lyteV4||o.fromV4Render){let e=i;R._V4InsApi.forEach((function(r){t[r]=e.prototype[r]})),this.setData=e.componentClass.prototype.setData,this.setMethods=e.componentClass.prototype.setMethods}else if(n){let e=n;t.component=t.constructor.component=e.component}}else if(a)if(this._callee&&this._callee.__widget||o.__widget||this.hasAttribute("lyte-widget")||e.__lyteConfig.isWidgetComponent||o.lyteWidget||o.fromWidgetRender){let e=a;"widget"!=o._firstRegisteredComp[this.localName]&&R._V3InsApi.forEach((function(r){t[r]=e.prototype[r]})),t.component=e.component,t.__widget=!0}else{if(!n)return P.V3.pendingComp.add(this),void(this.__v3lyteIgnore=!0);{let e=n;"v3"!=o._firstRegisteredComp[this.localName]&&R._V3InsApi.forEach((function(r){t[r]=e.prototype[r]})),t.component=e.component}}else if(this.hasAttribute("lyte-widget")||e.__lyteConfig.isWidgetComponent||o.lyteWidget||o.fromWidgetRender)return P.V3.pendingComp.add(this),void(this.__v3lyteIgnore=!0)}this.actualConstructor()}actualConstructor(){if(this.hasAttribute("lyte-rendered")||this._ccCalled)return void(this.__lyteIgnore=!0);if(!v.registeredComponents[this.localName]){this.__lyteIgnore=!0;var o=P._registeredComponents[this.localName];return o._pendingComponents=o._pendingComponents||[],void o._pendingComponents.push(this)}this.__v3=!0;var i;v.currentWidget?v.currentWidget:this._callee&&this._callee.__lyteWidget;let n;this.constr=this.constructor,(c=this.constructor.__widgetName)&&(i=widgetMap,e.ss=widgetMap,c=i.get(c)),this.constr.activeInstances++,this.constructor.component.activeInstances++;let a=this.attributes._lyteprop;a=a?a.nodeValue:void 0;let s,l=(n=a)?P.fRP[n]:void 0,d=this.component=l?l.component:this.component?new this.component:new this.constructor.component;d.__isComponent__=!0,this._properties={},this.registeredProp=P.directive.registeredProp[this.localName],d._config=this.constructor._config;var c;d.actions;if(!l){var p={};s=d.data={};let e=this.component.constructor._data?this.component.constructor._data.apply(d):{};defProp(p,"__component__",{value:this,configurable:!0,writable:!0,enumerable:!1}),p.errors={},s=d.data=p,P.__data.length&&P.__data.forEach((function(t){e=Object.assign(e,t)})),d.__data=e,this._hideAttr={};var u=this;for(let o in e){var f,h=e[o];if(s[o]=h.default,h.initialize&&"function"==typeof h.initialize){var m=h.initialize.apply(u.component);m?s[o]=m:t.error("LC011",o,u.tagName)}if(r.Transform[h.type]){var y=r.Transform[h.type];/^(object|array)$/.test(y.extends)&&(y.hasOwnProperty("properties")||y.hasOwnProperty("items"))&&(f=!0)}(/^(object|array)$/.test(h.type)&&h.watch||f)&&r.establishObjectBinding(s,o,!1,void 0,void 0,!!h.watch||void 0),h.hasOwnProperty("hideAttr")&&(this._hideAttr[o]=h.hideAttr)}if(this.$data=s,d.$data=s,this.constructor._serviceToBeUsed)for(var _ in this.constructor._serviceToBeUsed){var g=this.constructor._serviceToBeUsed[_];if(r.registeredServices.hasOwnProperty(g))this.component[_]=new r.registeredServices[g];else{this.__toRemoveLazy=this.__toRemoveLazy||{};u=this;var b=r.$.requiredServices(_,g,(function(e,t,o,i){u.component[t]=new e,u.__toRemoveLazy[i].forEach((function(e){r.$.toRemoveFromRequiredServices(e)})),delete u.__toRemoveLazy[i]}));this.__toRemoveLazy[g]=this.__toRemoveLazy[g]||[],this.__toRemoveLazy[g].push(b)}}this.initializeMethod(this,this.component.constructor._methods)}if(d.$node)for(var A in d.$node)"localName"!=A&&(this[A]=d.$node[A]);d.$node=this;for(let e in v.customPropHandlersList)this[e]=v.customPropHandlersList[e];this.component&&this.component.constructor._template&&this.component.constructor._template.widget&&(this.__lyteWidget=this.component.constructor._template.widget,(c=widgetMap.get(this.__lyteWidget))&&c.components.set(this,!0));let $;if(d._config&&($=1==d._config.clientLifeCycleHooks||"object"==typeof d._config.clientLifeCycleHooks&&d._config.clientLifeCycleHooks.includes("constructor")),l)this._fR=l,delete P.fRP[n];else for(var A in this._actions=this._actions?this._actions:{},this._callee=this._callee||this.getCallee(this.parentNode),this._callee&&this.constructor.__widgetName&&this._callee.constructor.__widgetName!=this.constructor.__widgetName&&c.additionalComps.add(this.parentElement),!$&&this.hasAttribute("server-rendered"),s){if(!((e.isLyteWidget||e.__lyteEnablePromise)&&s[A]instanceof Promise))P.handleValidation(s,A,s[A],d,!0)&&(s[A]=void 0)}}getMethods(e){return this.component.getMethods(e)}hasAction(e){return this.component.hasAction(e)}setActions(e,t){return this.component.setActions(e,t)}setMethods(e,t){return this.component.setMethods(e,t)}getCallee(e){return P.getCallee(e,this)}afterConnected(t,o){this.constructor;let i=this.component.constructor;if((!0===this.constructor._mutable||r.getConfig("mutable"))&&(this.component.data=r.mut(this.component.data)),this.getAttribute("_lyteprop"))return"";let n=i._observedAttributes;for(let e=0;e<n.length;e++){let t=n[e],r=this.getProperty(t);defProp(r,"__fromComponent",{value:!0,enumerable:!1})}this.getProperty("errors");var a=r.__gl,s=this.component,l=s.data;if(l.$lg=a,this._initProperties){let e=this._initProperties;for(let t in e){let o,i=s.__data[t];if(o=!i||i.type===P.getDataType(e[t])||void 0===e[t]&&"boolean"!==i.type?e[t]:P.typeCast(e[t],s.__data[t].type),!P.handleValidation(l,t,o,s,!0)){var d;if(l[t]=o,i&&r.Transform[i.type]){var c=r.Transform[i.type];/^(object|array)$/.test(c.extends)&&(c.hasOwnProperty("properties")||c.hasOwnProperty("items"))&&(d=!0)}(i&&/^(object|array)$/.test(i.type)&&i.watch||d)&&r.establishObjectBinding(l,t,void 0,void 0,void 0,!!i.watch||void 0)}}this._initProperties=void 0}if(this._initMethods){let e=this._initMethods;for(let t in e)s.$node._methods[t]=e[t];this._initMethods=void 0}let p;if(s._config&&null!=s._config.clientLifeCycleHooks&&(p=1==s._config.clientLifeCycleHooks||"object"==typeof s._config.clientLifeCycleHooks&&s._config.clientLifeCycleHooks.includes("init")),o&&this.cmpBind(t),e.isLyteWidget){let e=this.component.data.errors;Object.keys(e).length&&(l._error=!0)}!p&&this.hasAttribute("server-rendered")||(this.callback("init"),this.onCallBack("init")),this.registerYields(),l.lyteUnbound&&(P.unbound=!0);let u="";return l.lyteFastRender?(u=this.renderFast(i._dynamicNodes,i._sta,s),requestAnimationFrame((function(){requestAnimationFrame((function(){P.callCC()}))}))):u=this.renderNodes(i._template,i._dynamicNodes,void 0,void 0,void 0,void 0,i._tC),u}initializeMethod(e,t){let r;e.component?r=e.component:(r=e,e=r.$node),r.methods={},e._methods=r.methods;for(let e in t)r.methods[e]=t[e]}renderComponent(e,t){var o=e.componentName,i=e.staticAttrs,n=N._registeredComponents[o];if(!n)return"";var a=N._registeredComponents[o].component,s=new n.component;t.component=s,!0===this.constructor._mutable||r.getConfig("mutable")?s.data=r.mut({}):s.data={};let l=N.getCmpData(s.data),d=a._data?a._data.apply(s):{};for(let e in d)l[e]=d[e].default;l.errors={},s.__data=d;var c=N._registeredComponents[o].component._observedAttributes;for(var p in t.data=t.data||{},i)-1!==c.indexOf(p)&&(t.data[p]=i[p]);let u=t.data;if(u)for(let e in u){let t;t=!s.__data[e]||s.__data[e].type===P.getDataType(u[e])||void 0===u[e]&&"boolean"!==s.__data[e].type?u[e]:P.typeCast(u[e],s.__data[e].type),P.handleValidation(l,e,t,s)||(l[e]=t)}{let e;if(s.$node={querySelector:g,localName:o},this.initializeMethod(s,a._methods),s.init&&s.init.apply(s),a._callBacks&&(e=a._callBacks.init))for(let t=0;t<e.length;t++)e[t].value.apply(s);return t.unbound=!0,delete s.$node.querySelector,this.renderFast(N._registeredComponents[o].component._dynamicNodes,N._registeredComponents[o].component._sta,s,t)}}renderFast(e,o,i,n){var a,s;i&&(s=this.component,this.component=i);var l=N.getCmpData(this.component.data),d="",c=o,p=o.cc;for(var u=0;u<p.length;u++)if(null!=p[u]){var f=p[u],h=e[f];if(h.dynamicValue){let e=P.getDD(l,h.newDynamicValue);e=null==e||null==e?"":e,d+=r.Security.escape(e)}else if(h.helperInfo){P.ffr=!0;let e=this.processHelper({name:h.helperInfo.name,args:this.processArgs(this,h,[],void 0,void 0,!0)},void 0);P.ffr=!1,e=null==e||null==e?"":e,d+="unescape"===h.helperInfo.name?e:r.Security.escape(e)}else if(h.type)switch(h.type){case"for":{let t=e[f-1].attr.items;var m;t.dynamicValue?m=P.getDD(l,t.newDynamicValue):t.helperInfo&&(m=this.processHelper({name:t.helperInfo.name,args:this.processArgs(this,t,[],void 0,void 0,!0)},void 0));var y=h._args.item||"item",_=h._args.index||"index";let r="";if(m&&m.length){for(var g=l[y],b=l[_],A=0;A<m.length;A++){let e=m[A];l[y]=e,l[_]=A,r+=this.renderFast(h.dynamicNodes,h._sta,void 0,n)}l[y]=g,l[_]=b}d+=r}break;case"forIn":{let t=e[f-1].attr.object;var $;t.dynamicValue?$=P.getDD(l,t.newDynamicValue):t.helperInfo&&($=this.processHelper({name:t.helperInfo.name,args:this.processArgs(this,t,[],void 0,void 0,!0)},void 0));var L=h._args.value||"value",E=h._args.key||"key";let r,o="";if($&&(r=Object.keys($))){for(var R=l[L],w=l[E],C=0;C<r.length;C++){let e=r[C];l[L]=$[e],l[E]=e,o+=this.renderFast(h.dynamicNodes,h._sta,void 0,n)}l[y]=R,l[_]=w}d+=o}break;case"if":case"switch":{let t=e[f-1].attr.value;var O,T;if(t.dynamicValue?O=P.getDD(l,t.newDynamicValue):t.helperInfo&&(O=this.processHelper({name:t.helperInfo.name,args:this.processArgs(this,t,[],void 0,void 0,!0)},void 0)),O)T="if"===h.type?"true":O.toString();else if("if"===h.type)T="false";else switch(O){case void 0:T="undefined";break;case null:T="null";break;case!1:T="false";break;case"":T='""'}let r=h.cases[T];if(r)for(;r&&(d+=this.renderFast(r.dynamicNodes,r._sta,void 0,n),r.additional);)r=r.additional.next?h.cases[r.additional.next]:h.default;else(r=h.default)&&r._sta&&(d+=this.renderFast(r.dynamicNodes,r._sta,void 0,n))}break;case"attr":{let r,o,i,s=e.length;for(let t=f+1;t<s;t++){let o=e[t];if("registerYield"!==o.type&&"componentDynamic"!==o.type&&"insertYield"!==o.type&&"component"!==o.type)break;if(("componentDynamic"===e[t].type||"insertYield"===e[t].type||"component"===e[t].type)&&e[t].position.toString()==e[f].position.toString()){if("componentDynamic"!=e[t].type){r=e[t];break}if(v.registeredComponents[e[t].componentName]){r=e[t];break}}}r&&(i="component"!==r.type,a=P.fRC++,o=P.fRP[a]={data:{}}),r&&"component"===r.type||(d=d.substring(0,d.length-11));let p=h.attr,m={};for(let e in p)if(p[e].dynamicValue){let t=p[e].newDynamicValue?P.getDD(l,p[e].newDynamicValue):this.get(p[e].dynamicValue);o?(o.data[p[e].camelCase]=t,"string"==typeof t&&i&&(t=this.formatValue(e,t),d=d+t+" ")):(t=this.formatValue(e,t),d=d+t+" ")}else if(p[e].helperInfo)if("action"===p[e].helperInfo.name){let r,o=p[e].helperInfo.args[0];o.startsWith('"')||o.startsWith("'")?r=o.substring(1,o.length-1):(t.warn("Deprecation warning. Action name "+o+" must be in quotes"),r=o);let i=this.processArgs(this,p[e],[],"__lyteEvent__","__lyteNode__");m[p[e].globalEvent||-1!==p[e].name.indexOf("-")?p[e].name:p[e].name.substr(2)]={name:r,args:p[e].helperInfo.args,actArgs:i,globalEvent:!!p[e].globalEvent,skipArgProcessing:!0}}else if("method"===p[e].helperInfo.name){n?n.methods:this.component.methods;if(o){let t=o.methods=o.methods||{},r=n?n.component:this.component,i=this.processArgs(this,p[e],[],"__lyteEvent__","__lyteNode__");t[p[e].camelCase]=function(){this.$node;let e=i.slice(1),t=i[0],o=Array.from(arguments),n=e.concat(o);return r.$node._methods[t].apply(r,n)}}}else{let t=this.processHelper({name:p[e].helperInfo.name,args:this.processArgs(this,p[e],[],void 0,void 0,!0)},void 0);o?(o.data[p[e].camelCase]=t,"string"==typeof t&&i&&(t=this.formatValue(e,t),d=d+t+" ")):(t=this.formatValue(e,t),d=d+t+" ")}if(Object.keys(m).length){let e=P.fRC++;d=d+"lyteaction="+e+" ",P.fRP[e]=m,m.componentName=this.component.$node.localName||"undefined"}o&&"component"!==r.type&&"insertYield"!==r.type&&(d=d+"_lyteprop="+a+" "),h.attrHandling||(c[u+1]=c[u+1].substr(1),h.attrHandling=!0)}break;case"insertYield":{let e,t=void 0!==a?P.fRP[a]:void 0;t&&delete P.fRP[a],a=void 0;let r,o=h.yieldName||t.data.yieldName;if(t&&delete t.data.yieldName,n&&n.yields)e=n.yields[o],r=n._yieldCallee;else{if(e=this._yields[o],!e)break;r=e._callee}if(e){let o,i;r instanceof HTMLElement?o=r:(o=this,i=this.component,this.component=r.component);let n={},a=[];var S=N.getCmpData(o.component.data);if(e._cx&&P.adCx(e,a),t)for(var k in t.data)n[k]=S[k],S[k]=t.data[k];var x=o.component;s&&s.$node==r&&(x=s),d+=o.renderFast(e.dynamicNodes||e._dynamicNodes,e._sta,x,r);for(let e in n)S[e]=n[e];e._cx&&P.rmCx(e,a),i&&(o.component=i)}}break;case"component":if(void 0!==a){let e=P.fRP[a],r=e.data.componentName;r&&(v.registeredComponents[r]?(d=d+"<"+r+(t.isWidgetBuild?" lyte-widget ":"")+" _lyteprop="+a+">",a=void 0,d=(d+=this.renderComponent({componentName:r},e,l))+"</"+r+">"):d+="component not registered")}break;case"componentDynamic":{let e=void 0!==a?P.fRP[a]:{};a=void 0,d+=this.renderComponent(h,e,l)}break;case"registerYield":{let e;void 0!==a?e=P.fRP[a]:(a=P.fRC++,e=P.fRP[a]={}),e.yields=e.yields||{},e.yields[h._args["yield-name"]]=h,e._yieldCallee||(e._yieldCallee=n||{component:this.component})}}else d+=c[u]}else d+=c[u];return i&&(this.component=s),d}formatValue(e,t){let o,i=typeof t;""===t&&(i="undefined");let n="src"==e||"href"==e;switch(i){case"boolean":return t?e:"";case"object":return o=void 0!==Record&&t instanceof Record?JSON.stringify(t.$.toJSON()):JSON.stringify(t),e+'="'+(n?o:r.Security.escape(o))+'"';case"undefined":return e;default:return e+'="'+(n?t:r.Security.escape(t))+'"'}}renderNodes(o,i,n,a,s,l,d,c){let f;a=a||{};let h=this.constr,m=!1;t._ms||!o?(m=!0,f=P.getContentForIE(d,h)):o.hasAttribute("depth")?(m=!0,f=P.getContentForIE(o,h)):f=o.content.cloneNode(!0,"lyte");let y,_=[],v=[],g=(N.getCmpData(this.component.data),new Map);for(let o=0;o<i.length;o++){let l=i[o],d=l.type,u=l.position,h=f;if(h=D(h,u),l.trans&&(h._hooksPresent=!0),i._cache||this.registeredProp&&this.registeredProp.length||(i._cache={}),"componentDynamic"===d)t.isWidgetBuild&&h.setAttribute("lyte-widget",""),a.node?h._cx=a:n&&(h._cx=n._cx);else if("text"===d)this.bindNode(h,void 0,n,a,i[o],v,s,void 0,i._cache,d,void 0,g);else if("attr"===d){if(h._attributeDetails=l.attr,"LYTE-YIELD"===h.nodeName){h._callee=this,h.component={},h.component.data={},defProp(h.component.data,"__component__",{value:h,configurable:!0,writable:!0,enumerable:!1}),h._properties={};for(let e=0;e<h.attributes.length;e++){let t=h.attributes[e];"is"!==t.nodeName&&"yield-name"!==t.nodeName&&(h._properties[P.String.toCamelCase(t.nodeName)]={})}}let e=[],t=[];for(let r in l.attr){let c=l.attr[r];c._depthTemp=l._depthTemp;let p,u=r;if(c&&(c.dynamicValue||c.helperInfo)){let t,r;if(a.node?h._cx=a:n&&(h._cx=n._cx),c.helperInfo&&"action"===c.helperInfo.name){h._boundEvents=h._boundEvents||{},t=c.helperInfo.args[0],r=t.startsWith('"')||t.startsWith("'")?t.substring(1,t.length-1):t;let e,o=c.globalEvent||-1!==u.indexOf("-")?u:u.substr(2);h._boundEvents[o]={name:r,args:c.helperInfo.args},e="A1_"+Math.floor(1e3*Math.random())}c.globalEvent||(h.hasAttribute(u)||h.setAttribute(u,"{{dummy}}"),p=this.bindNode(h.attributes.getNamedItem(u),e,n,a,c,void 0,s,void 0,i._cache,d,o),p!==h.attributes.getNamedItem(u)&&(h._removedAttributes=h._removedAttributes||{},h._removedAttributes[u]=p))}c.hookNode&&t.push({attr:c,node:p})}let r=this;t.forEach((function(e){let t,o=e.attr,s=e.node;if(o&&o.stringValue&&(t=!0),o.hookNode&&(P.directive.infoA(r,l,h,n,o,c,a),"prop"==o.hookName||"data"==o.hookName)){a.node?h._cx=a:n&&(h._cx=n._cx);let e=h;P.directive.save.addData(h,o),"data"==o.hookName&&(e=h.$data),P.directive.save.addNode(r,o,h,e,s,t,n,a,i)}})),l.attr&&Object.keys(l.attr).length&&(h._callee=this);for(let t=0;t<e.length;t++)h.removeAttribute(e[t])}else if(/^(for|forIn|component)$/.test(d)){let r;switch((e.isLyteWidget||e.__lyteEnablePromise)&&(h._cases=l.cases),a.node?h._cx=a:n&&(h._cx=n._cx),h._dynamicNodes=l.dynamicNodes,t._ms&&(h._tC=l.templateContent),l.actualTemplate&&(h._tC=l.actualTemplate),d){case"for":h._ht=l._ht,r=this.updateForHelper(h,{type:"default"},a.node?a:void 0,s,l._sta);break;case"forIn":h._ht=l._ht,r=this.updateForInHelper(h,{type:"default"},a.node?a:void 0,s);break;case"component":r=this.updateDynamicComponent(h,!1,a.node?a:void 0,s,o,n)}r&&_.push(r)}else if(/^(if|switch)$/.test(d)){let e;h._cases=l.cases,h._default=l.default,h._ht=l._ht,a.node?h._cx=a:n&&(h._cx=n._cx),l.actualTemplate&&(h._tC=l.actualTemplate,h._origTemplate||(t._ie?h._origTemplate=p("template"):h._origTemplate=l._depthTemp.cloneNode(!0),h.hasAttribute("value")&&h._origTemplate.setAttribute("value",h.getAttribute("value"))));let o=this.updateSwitchHelper(d,h,a.node?a:void 0,void 0,s,c,e,g);if(o){if(_.push(o),o.toAppendMain.querySelector("template[is=break]")){h._isStopped="break",f=r.Compile.getTrimmedContent(f,l.position,void 0),y=l.position;break}if(o.toAppendMain.querySelector("template[is=continue]")){h._isStopped="continue",f=r.Compile.getTrimmedContent(f,l.position,void 0);break}}}else if("registerYield"===d)a.node?h._cx=a:n&&(h._cx=n._cx),h._dynamicNodes=l.dynamicNodes,h._sta=l._sta,h._ht=l._ht,t._ms&&(h._tC=l.templateContent),h._callee=this;else if("insertYield"===d){a.node?h._cx=a:n&&(h._cx=n._cx),h.component=h.component||{data:{}},h._properties=h._properties||{},h.component=h.component||{data:{}},h._properties=h._properties||{};let e=N.getCmpData(h.component.data);for(let t=0;t<h.attributes.length;t++){let r=h.attributes[t],o=r.name,i=r.value;"yield-name"!==o&&(h._properties&&!h._properties[o]&&(h._properties[o]={}),h._attributeDetails&&!h._attributeDetails[o]&&(e[o]=i))}this.updateYield(h,!1,a.node?a:void 0)}}i._cache=void 0;for(let e=0;e<v.length;e++){let r=v[e].dynamicPositions,o=r.initialNode,i=r.dynamicNodeValue,n=i.childNodes.length;n||(i.appendChild(document.createTextNode("")),n=1);let a=i.childNodes[0];if(t._rwpf&&"#document-fragment"===o.parentNode.nodeName){for(;i.childNodes.length;)u(o.parentNode,i.childNodes[0],o);o.remove()}else o.replaceWith.apply(o,i.childNodes);v[e].dynamicPositions={startingNode:a,length:n}}return g.size&&g.forEach((function(e,t){e.pN.insertBefore(t,e.cN),e.cN.nextSibling?e.pN.insertBefore(document.createElement("textend"),e.cN.nextSibling):e.pN.appendChild(document.createElement("textend"))})),y&&((l=l||{}).stop=!0),n?a.type?(n._helpers[a.itemIndex]=_,m&&(f=h.createDocFragment1(f)),f):(n._helpers=n._helpers||[],n._helpers.push.apply(n._helpers,_),m&&(f=h.createDocFragment1(f)),f):(this.executeBlockHelpers(_),m&&(f=h.createDocFragment1(f)),f)}executeBlockHelpers(e,t){for(let t=0;t<e.length;t++){var r=e[t].lastNode,o=r.parentNode;r._placeHolder&&(o=(r=r._placeHolder).parentNode),u(o,e[t].toAppendMain,r),e[t]=e[t].lastNode}}updateBlockHelpers(e,t){for(let r=0;r<e.length;r++)switch(e[r].getAttribute("is")){case"for":this.updateForHelper(e[r],{type:"default"},t);break;case"if":this.updateSwitchHelper("if",e[r],t);break;case"forIn":this.updateForInHelper(e[r],{type:"default"},t);break;case"switch":this.updateSwitchHelper("switch",e[r],t);break;case"component":this.updateDynamicComponent(e[r],!1,t);break;case"insertYield":break;case"yield":case"registerYield":t&&(e[r]._cx=t);break;default:"LYTE-YIELD"===e[r].tagName&&this.updateYield(e[r],!1,t)}}static get observedAttributes(){return this._observedAttributesDasherized}static dasherizeObservedAttributes(){let e=[];for(let t=0;t<this._observedAttributes.length;t++)e[t]=P.String.dasherize(this._observedAttributes[t]);P.__dataNames.forEach((function(t){e.push(P.String.dasherize(t))})),P.customPropHandlers.forEach((function(t,r){e.push(P.String.dasherize(t))})),this._observedAttributesDasherized=e}attributeChangedCallback(e,t,r){this._attributeChangedCallback(e,t,r)}_attributeChangedCallback(e,r,o){if(this.__lyteIgnore||this.__v3lyteIgnore)return;this.constructor;let i=this.component.constructor;if(i._observedMethodAttributes&&i._observedMethodAttributes[e])return;let n=P.String.toCamelCase(e),a=P.customPropHandlers.indexOf(n);if(-1!==a){let r=P.customPropHandlers[a],i=o;if(i)try{i=JSON.parse(i);for(let e in i){let t=r+P.String.upperCaseFirstLetter(e);this.set(t,i[e])}}catch(r){t.error("LC001",e)}return}if(r===o)return;var s=this.attributes.getNamedItem(e);if(s){if(s.__lyteIgnore)return void(this.attributes.getNamedItem(e).__lyteIgnore=!1)}else if(this["__"+e])return void(this["__"+e]=!1);let l=this.component,d=l.__data[n];if(d&&d.type){let r=d.type;if("string"!==r){let i={attr:e,tagName:this.tagName};if(o=P.typeCast(o,r,i),i.isError)return void t.warn("data type of the value provided for attribute "+e+" of "+this.tagName+" is not valid")}}let c=l.data;c[n]!==o?this.set(n,null===o?void 0:o):P.clearError(c,n)}removeHelpersSpecificIndex(e,t){if(e._helpers[t])for(let r=0;r<e._helpers[t].length;r++)this.removeHelpers(e._helpers[t][r]);if(e._forContent[t]){for(let r=0;r<e._forContent[t].length;r++)e._forContent[t][r].remove();var r=this;Object.keys(e._items[t]._dynamicProperty).forEach((function(t){if(e._dynProps[t]--,!e._dynProps[t]){let o=r.getProperty(t);o._helperNodes&&o._helperNodes.delete(e)}})),e._items[t]={_dynamicProperty:{},itemProperty:{},indexProperty:{}}}e._specialNodes&&e._specialNodes.length&&(P.directive.save.removeAllNode(this,e._specialNodes[t]),e._specialNodes[t]=[])}removeHelpers(t,r,o){if(!o){t.remove(),delete("component"===t.getAttribute("is")?this.__dc:this.__h)[t.__lyteId]}var i="delete";var n=[];if(P.adCx(t,n),t._forContent){if("for"===t.getAttribute("is")){if(t._helpers)for(let e=0;e<t._helpers.length;e++){for(let r=0;r<t._helpers[e].length;r++)this.removeHelpers(t._helpers[e][r]);t._helpers[e]=[]}for(let e=0;e<t._forContent.length;e++)for(let r=0;r<t._forContent[e].length;r++)t._forContent[e][r].remove();t._specialNodes&&t._specialNodes.length&&(P.directive.save.removeAllNode(this,t._specialNodes),t._specialNodes=[]);let e=t.getAttribute("item");if(t._items.length){let r=t._items[0].itemProperty;for(let e=0;e<t._items.length;e++){let r=t._items[e]._dynamicProperty;for(let e in r){let r=this.getProperty(e);r._helperNodes&&r._helperNodes[i](t)}}if(r)for(let r=0;r<t._items.length;r++)this.removeBindings({[e]:t._items[r].itemProperty},{[e]:t._attributes.items[r]})}if(!r&&t._actualBinding){t._attributes.items&&t._attributes.items._bindings&&t._actualBinding._createdBinding&&t._attributes.items._bindings[i](t._actualBinding),t._actualBinding._forHelpers&&t._actualBinding._forHelpers[i](t);var a=t._removedAttributes.items._multipleProperty;t._removedAttributes&&t._removedAttributes.items&&!t._removedAttributes.items.helperValue&&a&&a[0].actProp._forHelpers&&a[0].actProp._forHelpers[i](t)}t._items=[]}else{if(t._helpers){let e=Object.keys(t._helpers);for(let r=0;r<e.length;r++){for(let o=0;o<t._helpers[e[r]].length;o++)this.removeHelpers(t._helpers[e[r]][o]);t._helpers[e[r]]=[]}}for(var s in t._forContent)for(let e=0;e<t._forContent[s].length;e++)t._forContent[s][e].remove();let e=t._items,o=t.getAttribute("key");for(let r in e){let n=e[r],a=n.itemProperty,s=n._dynamicProperty;for(let e in s){let r=this.getProperty(e);r._helperNodes&&r._helperNodes[i](t)}a&&this.removeBindings({[o]:t._items[r].itemProperty},{[o]:t._attributes.object[r]})}if(!r){t._actualBinding&&(t._attributes.object&&t._attributes.object._bindings&&t._actualBinding._createdBinding&&t._attributes.object._bindings[i](t._actualBinding),t._actualBinding._forHelpers&&t._actualBinding._forHelpers[i](t));a=t._removedAttributes.object._multipleProperty;t._removedAttributes.object&&!t._removedAttributes.object.helperValue&&a&&a[0].actProp._forHelpers&&a[0].actProp._forHelpers[i](t),t._propBindingObject&&t._attributes.object&&t._attributes.object._bindings&&t._attributes.object._bindings[i](t._propBindingObject)}t._items={},t._specialNodes&&t._specialNodes.length&&(P.directive.save.removeAllNode(this,t._specialNodes),t._specialNodes=[])}if((e.isLyteWidget||e.__lyteEnablePromise)&&t._promiseContent)for(let e=0;e<t._promiseContent.length;e++)t._promiseContent[e].remove()}else if(t._caseContent||t._yieldContent){if(t._helpers){for(let e=0;e<t._helpers.length;e++)this.removeHelpers(t._helpers[e]);t._helpers=[]}if(t._caseContent){for(let e=0;e<t._caseContent.length;e++)t._caseContent[e].remove();for(let e in t._dynamicProperty)if(t._dynamicProperty[e].isActualNode)t._dynamicProperty[e].isActualNode._helperNodes[i](t);else{let r=this.getProperty(e)._helperNodes;r&&r[i](t)}t._dynamicProperty={}}else{for(let e=0;e<t._yieldContent.length;e++)t._yieldContent[e].remove();t._dynamicProperty={}}var l=P.pendingViewPortElements;if(t._inPve&&l.length){let e=l.indexOf(P.getFakeTemplate(t));-1!=e&&l.splice(e,1)}t._specialNodes&&t._specialNodes.length&&(P.directive.save.removeAllNode(this,t._specialNodes),t._specialNodes=[])}else if(t._renderedComponent)for(let e in t._renderedComponent){let r=t._renderedComponent[e];r&&(r.constructor.prototype._disconnectedCallback.call(r),r.remove(),t._renderedComponent[e]=null)}P.rmCx(t,n)}updateYield(e,r,o){e._specialNodes||(e._specialNodes=[]);let i=this.constructor;this.component.constructor;e._callee||(e._callee=this);let n=e._callee._yields[e.getAttribute("yield-name")];if(!n)return;e._registerYield=n;let a=n._callee||e._callee._callee;if(!a){if(t._ms){var s=p("div");s.innerHTML=n.outerHTML,t._ie&&(s.firstChild.innerHTML=n.innerHTML);var l=s.childNodes[0];i.splitTextNodes(l),l=i.createDocFragment1(l),e.appendChild(l)}else e.appendChild(n.content.cloneNode(!0,"lyte"));return void(e._helpers=[])}n._callee||(n._callee=a),e._dynamicProperty=e._dynamicProperty||{};let d={},c=[];P.adCx(n,c);var u=N.getCmpData(a.component.data);Object.keys(e._properties).forEach((function(t){d[t]={},d[t].value=u[t],d[t].property=a._properties[t],a._properties[t]=e._properties[t];let r=N.getCmpData(e.component.data);u[t]=r[t]})),t._ms||!n._ht||n._htA||(n._htA=!0,n.content.append(n._ht.content.cloneNode(!0)));let f=e._callee,h=a.renderNodes(n,n._dynamicNodes||[],e,{node:e},!0,void 0,n._tC,f);if(!e.component.data.lyteUnbound){let t=N.getCmpData(e.component.data);P.establishBindings(e._properties,t)}a.executeBlockHelpers(e._helpers),Object.keys(e._properties).forEach((function(e){u[e]=d[e].value,a._properties[e]=d[e].property})),P.rmCx(n,c),e.appendChild(h)}updateDynamicComponent(e,t,r,i,n,a){let s;e._specialNodes||(e._specialNodes=[]),e._callee=this;let l=e.hasAttribute("lyte-keep-alive");if(!e._renderedComponent){e._renderedComponent={};let t=P.createLyteId(this);this.__dc[t]=e,e.__lyteId=t}e._cx=r||e._cx,e._dynamicProperty=e._dynamicProperty||{};let d=e.getAttribute("component-name")||(e._attributes?e._attributes["component-name"]:void 0);if(!d)return;let c,f=!1;if(t){if(l&&v.setIgnoreDisconnect(!0),e._renderedComponent[e._currentComponent]){let t=e._renderedComponent[e._currentComponent];l?P.hDiv.content.appendChild(t):t.remove()}if(v.setIgnoreDisconnect(!1),l||(e._dynamicProperty={}),e._renderedComponent[d]&&l)c=e._renderedComponent[d];else{let e=!1;this.__widget&&(o.__widget=!0),c=p(d),e&&(o.__widget=!1),f=!0}}else{let e=!1;this.__widget&&(o.__widget=!0),c=p(d),e&&(o.__widget=!1),f=!0}if(!l&&e._currentComponent&&(e._renderedComponent[e._currentComponent]=null),f){for(let t=0;t<e.attributes.length;t++)"is"!==e.attributes[t].name&&"component-name"!==e.attributes[t].name&&"lyte-keep-alive"!==e.attributes[t].name&&c.setAttribute(e.attributes[t].name,e.attributes[t].value);if(e._attributes)for(var h in e._attributes)"component-name"!==h&&c.setData(P.String.toCamelCase(h),e._attributes[h]);let t=this.renderNodes(e,e._dynamicNodes,e,void 0,i,void 0,e._tC);c.appendChild(t)}return f&&(c._toRegEvnts=e._toRegEvnts),t?(v.setIgnoreDisconnect(!0),u(e.parentNode,c,e),v.setIgnoreDisconnect(!1)):s={toAppendMain:c,lastNode:e},e._renderedComponent[d]=c,e._currentComponent=d,c._callee=this,c._actions=e._actions,c.setMethods(e._initMethods),c._attributeDetails=e._attributeDetails,c._boundEvents=e._boundEvents,c._cx=e._cx,s}beforeUpdateFor(e,t,r,o){let i=t._items[o].propProperty;i[r]||(i[r]={}),e._properties[r]||(e._properties[r]={}),t._properties={[r]:r};let n=i[r];i[r]=e._properties[r],e._properties[r]=n}afterUpdateFor(e,t,r,o){let i=o.itemIndex,n=t._items[i].propProperty,a=n[r];n[r]=this.getProperty(r),e._properties[r]=a}updateForHelper(r,o,i,n,a,s){let l=r.hasAttribute("has-child");if(r._specialNodes||(r._specialNodes=[]),r._propNodes||(r._propNodes={}),"TEMPLATE"!==r.tagName){if(Object.keys(r).forEach((function(e){"innerHTML"!==e&&"innerText"!==e&&(r._origTemplate[e]=r[e])})),t._ie){var d=p("div");d.innerHTML=r._tC,r._origTemplate.innerHTML=d.children[0].innerHTML,this.constr.splitTextNodes(r._origTemplate),r.hasAttribute("depth")&&r._origTemplate.setAttribute("depth",r.getAttribute("depth"))}let o=r._origTemplate._placeHolder=document.createTextNode("");r._origTemplate.setAttribute("item",r.getAttribute("item")),r._origTemplate.setAttribute("index",r.getAttribute("index")),(e.isLyteWidget||e.__lyteEnablePromise)&&r.hasAttribute("has-child")&&r._origTemplate.setAttribute("has-child",r.getAttribute("has-child")),r.hasAttribute("unbound")&&r._origTemplate.setAttribute("unbound","true"),P.replaceWithPf(r,r._origTemplate._placeHolder),(r=P.replaceWithOrigTemplate(r)).setAttribute("is","for"),P.apdNode(r,this),o._helper=r}else if(!r._placeHolder){var f;f=document.createTextNode(""),P.replaceWithPf(r,f),r._placeHolder=f,f._helper=r,P.apdNode(r,this)}r._sta=r._sta||a;let h=this;if(r._callee=this,r._attributes=r._attributes||{},!("update"!==o.type||r._currentItems!==r._attributes.items||o&&o.force))return{};r._cx=i||r._cx;let m=r.getAttribute("index");m||(r.setAttribute("index","index"),m="index");let y=r.getAttribute("item");y||(r.setAttribute("item","item"),y="item"),r.hasAttribute("dir-obj")&&(r._dirObj=JSON.parse(r.getAttribute("dir-obj")));let _=N.getCmpData(h.component.data),v=_[y],g=_[m],b=h._properties[y],A=h._properties[m];h._properties[y]=h._properties[m]={};let $,L,E=r._attributes.items,R=(r.content,r._dynamicNodes),w=r;r._items||(r._items=[]),r._dynProps=r._dynProps||{};let C=o.firstIndex,O=o.secondIndex,T=o.thirdIndex;var S=C+O,k=!0,x=0;if(o)switch(o.type){case"remove":$=C,x=C;for(let e=C,t=O;t>0;t--,e++)this.removeHelpersSpecificIndex(r,e);for(let e=C+O;e<r._items.length;e++)r._items[e]._cx.itemIndex=r._items[e]._cx.itemIndex-O;r._items.splice(C,O),r._helpers.splice(C,O),r._forContent.splice(C,O),r._specialNodes&&r._specialNodes.splice(C,O);break;case"insert":{L=C,$=O,x=C+O,r._forContent[C]&&(w=r._forContent[C][0]);let e=[],t=[],o=[];for(let r=O,i=C;r>0;r--,i++)e.push([]),t.push({}),o.push([]);r._helpers.splice.apply(r._helpers,[C,0].concat(e)),r._items.splice.apply(r._items,[C,0].concat(t));for(let e=C+O;e<r._items.length;e++)r._items[e]._cx.itemIndex=r._items[e]._cx.itemIndex+O;r._forContent.splice.apply(r._forContent,[C,0].concat(o)),r._specialNodes&&r._specialNodes.splice.apply(r._specialNodes,[C,0].concat(o))}break;case"replace":{L=C,$=O,x=C+O,this.removeHelpersSpecificIndex(r,C);c();r._forContent[C+1]&&(w=r._forContent[C+1][0]);let e=[],t=[],i=[];for(let r=O,o=C;r>0;r--,o++)e.push([]),i.push([]),t.push({});r._helpers.splice.apply(r._helpers,[C,1].concat(e)),r._items.splice.apply(r._items,[C,1].concat(t));for(let e=C+O;e<r._items.length;e++)r._items[e]._cx.itemIndex=r._items[e]._cx.itemIndex+O-1;r._forContent.splice.apply(r._forContent,[C,1].concat(i)),r._specialNodes&&r._specialNodes.splice.apply(r._specialNodes,[C,1].concat(i)),1==o.secondIndex&&(k=!1);break}case"splice":{L=C,$=O,x=C+O;for(let e=T,t=0;e>0;e--,t++)this.removeHelpersSpecificIndex(r,C+t);c();r._forContent[C+T]&&(w=r._forContent[C+T][0]);let e=[],t=[],i=[];for(let r=O,o=C;r>0;r--,o++)e.push([]),i.push([]),t.push({});r._helpers.splice.apply(r._helpers,[C,T].concat(e)),r._items.splice.apply(r._items,[C,T].concat(t));for(let e=C+O;e<r._items.length;e++)r._items[e]._cx.itemIndex=r._items[e]._cx.itemIndex+O-T;r._forContent.splice.apply(r._forContent,[C,T].concat(i)),r._specialNodes&&r._specialNodes.splice.apply(r._specialNodes,[C,T].concat(i)),o.secondIndex==o.thirdIndex&&(k=!1);break}case"update":r.getAttribute("item");for(let e=0;e<r._items.length;e++)this.removeHelpersSpecificIndex(r,e);r._items=[];case"default":r._forContent=[],r._specialNodes=[],r._propNodes={},r._helpers=[],L=0,$=E?E.length:0,x=E?E.length:0;break;default:t.error("Error in updateForHelper")}let D;w||(w=r),w!=r&&r._helpers.length>0&&(o.type,1)&&(w=P.findLastNodeL(w,S,r));var j=!1,I=P.unbound;let M;(r.hasAttribute("unbound")||r._attributes&&r._attributes.unbound&&"false"!==r._attributes.unbound)&&(j=!0,P.unbound=!0),!r._fRender&&("lyteFastRender"==r.getAttribute("unbound")||r._attributes&&"lyteFastRender"==r._attributes.unbound)&&(r._fRender=!0),r._currentItems=E,(!t._ms&&$-L>0||(e.isLyteWidget||e.__lyteEnablePromise)&&E instanceof Promise)&&r._ht&&!r._htA&&(r.content.append(r._ht.content.cloneNode(!0)),r._htA=!0);let B=r;if("remove"!==o.type){var F="",K=[],H=c();if(l&&(e.isLyteWidget||e.__lyteEnablePromise)){let e,t=!0;switch(E instanceof Promise?E.__lyte.status:"resolved"){case"init":M="__lyteAwait__";break;case"resolved":M="true",t=!1;break;case"rejected":M="__lyteFail__"}r._promiseContent&&r._promiseContent.length&&this.removeHelpers(r,void 0,!0),B=r.content.querySelector("[case="+M+"]"),e=r._cases[M],B._ht=e._ht,B._ht&&!B._htA&&(B.content.append(B._ht.content.cloneNode(!0)),B._htA=!0),R=e.dynamicNodes,t&&this.renderPromiseNodes(B,R,r,{},n,void 0,r._tC,s,H)}for(let e=L,t=$;t>0;e++,t--){r._helpers[e]=[],r._specialNodes[e]=[],r._items[e]={_dynamicProperty:{},itemProperty:{},indexProperty:{},propProperty:{},propNodes:{}},_[y]=E[e],_[m]=e;var V={};V[y]={},V[y]._data=E[e],V[y]._dyn=[y],V[m]={},V[m]._data=e,V[m]._dyn=[m],h._properties[y]={},h._properties[m]={};let t={itemValue:y,itemIndex:e,type:"for",node:r,indexValue:m};r._items[e]._cx=t;let o,i={};if(r._fRender){F+=this.renderFast(R,r._sta,this.component)}else R._cache=V,o=this.renderNodes(B.hasAttribute("depth")&&B._depthTemp?B._depthTemp:B,R,r,t,n,i,r._tC,s);let a=Object.keys(r._items[e]._dynamicProperty);for(let e=0;e<a.length;e++){let t=a[e];r._dynProps[t]?r._dynProps[t]++:r._dynProps[t]=1}if(r._items[e].itemProperty=this.getProperty(y),r._items[e].indexProperty=this.getProperty(m),P.unbound||P.establishBindings({[y]:r._items[e].itemProperty},{[y]:r._attributes.items[e]}),r._fRender?K.push(r._forContent[e]=[]):r._forContent[e]=Array.from(o.childNodes),this.executeBlockHelpers(r._helpers[e],r),r._fRender||H.appendChild(o),i.stop)break;let l=Object.keys(r._items[e].propProperty);if(l.length){let e=this;l.forEach((function(o){e.afterUpdateFor(e,r,o,t)}))}}if(r._fRender){var z,q=document.createElement("template");if(q.innerHTML=F,H.appendChild(q.content),P.processAction(H),t._ie){z=[];for(var U=H.childNodes,W=0;W<U.length;W++)1==U[W].nodeType&&z.push(U[W])}else z=H.children;for(W=0;W<K.length;W++)K[W].push(z[W]);requestAnimationFrame((function(){requestAnimationFrame((function(){P.callCC()}))}))}P.unbound=I,"default"===o.type?D={toAppendMain:H,lastNode:w}:w._placeHolder?u(w._placeHolder.parentNode,H,w._placeHolder):u(w.parentNode,H,w),!j&&r._removedAttributes&&r._removedAttributes.items&&!r._removedAttributes.items.helperValue&&r._removedAttributes.items._multipleProperty&&P.establishBindings({items:r._removedAttributes.items._multipleProperty[0].actProp},{items:E})}if(P.unbound=I,k)for(let e=x;e<r._items.length;e++)r._items[e].indexProperty&&P.affectChanges(r._items[e].indexProperty);_[y]=v,_[m]=g,h._properties[y]=b,h._properties[m]=A;for(let e in r._propNodes){this.setData(e,r._propNodes[e]);let t=r._cx;if(t)for(;t;)if("for"==t.type||"forIn"==t.type){let o=t.node._propNodes[e];t.node._propNodes[e]||(o=t.node._propNodes[e]=[]),o[t.itemIndex]=r._propNodes[e],t.node._childProp?-1==t.node._childProp.indexOf[e]&&t.node._childProp.push(e):t.node._childProp=[e],this.beforeUpdateFor(this,t.node,e,t.itemIndex),t=null}else t=t.node._cx;else console.log("Dummy")}return r._currentItems=E,D}renderPromiseNodes(e,t,r,o,i,n,a,s,l){let d=this.renderNodes(e,t,void 0,{},i,void 0,a,s);r._promiseContent=[];let c=[d];for(let e=0;e<c.length;e++)11==c[e].nodeType?r._promiseContent=r._promiseContent.concat(Array.from(c[e].childNodes)):r._promiseContent.push(c[e]),l.append(c[e])}updateForInHelper(r,o,i,n,a){let s=r.hasAttribute("has-child");if(r._specialNodes||(r._specialNodes=[]),r._propNodes||(r._propNodes={}),"TEMPLATE"!==r.tagName){if(Object.keys(r).forEach((function(e){"innerHTML"!==e&&"innerText"!==e&&(r._origTemplate[e]=r[e])})),t._ie){var d=p("div");d.innerHTML=r._tC,r._origTemplate.innerHTML=d.children[0].innerHTML,this.constr.splitTextNodes(r._origTemplate),r.hasAttribute("depth")&&r._origTemplate.setAttribute("depth",r.getAttribute("depth"))}let o=r._origTemplate._placeHolder=document.createTextNode("");r._origTemplate.setAttribute("key",r.getAttribute("key")),r._origTemplate.setAttribute("value",r.getAttribute("value")),r.hasAttribute("unbound")&&r._origTemplate.setAttribute("unbound","true"),(e.isLyteWidget||e.__lyteEnablePromise)&&r.hasAttribute("has-child")&&r._origTemplate.setAttribute("has-child",r.getAttribute("has-child")),P.replaceWithPf(r,r._origTemplate._placeHolder),(r=P.replaceWithOrigTemplate(r)).setAttribute("is","forIn"),P.apdNode(r,this),o._helper=r}else if(!r._placeHolder){var f;f=document.createTextNode(""),P.replaceWithPf(r,f),r._placeHolder=f,P.apdNode(r,this),f._helper=r}let h=this;if(r._callee=this,r._attributes=r._attributes||{},!("update"!==o.type||r._currentObject!==r._attributes.object||o&&o.force))return{};i=i||r._cx,r._cx=i;let m=r.getAttribute("key");m||(m="key",r.setAttribute("key","key"));let y=r.getAttribute("value");y||(y="value",r.setAttribute("value","value"));let _=N.getCmpData(h.component.data),v=_[m],g=_[y],b=h._properties[m],A=h._properties[y];h._properties[m]=h._properties[y]={};let $,L=r._attributes.object,E=(r.content,r._dynamicNodes),R=r,w=[];if(r._items||(r._items={}),r._dynProps=r._dynProps||{},o)switch(o.type){case"delete":this.removeHelpersSpecificIndex(r,o.property);var C=r._keysArray.indexOf(o.property);C>-1&&r._keysArray.splice(C,1),r._helpers&&delete r._helpers[o.property],delete r._propBindingObject[o.property];break;case"add":w=[o.property],r._keysArray.push(o.property);break;case"update":r._keysArray.forEach((function(e,t,o){this.removeHelpersSpecificIndex(r,e)}),this),r._keysArray=w=L?Object.keys(L):[],r._helpers={},r._items={},r._propBindingObject={};break;case"default":r._forContent={},r._specialNodes={},r._helpers={},r._keysArray=w=L?Object.keys(L):[];break;default:t.error("Error in updateForHelper")}if(!L){let e=c();"default"!==o.type?u(R.parentNode,e,R):$={toAppendMain:e,lastNode:R}}let O,T=!1,S=P.unbound;(r.hasAttribute("unbound")||r._attributes&&r._attributes.unbound)&&(T=!0,P.unbound=!0),r._currentObject=L,!t._ms&&(w.length||(e.isLyteWidget||e.__lyteEnablePromise)&&L instanceof Promise)&&r._ht&&!r._htA&&(r.content.append(r._ht.content.cloneNode(!0)),r._htA=!0);let k=r;if(L&&"remove"!==o.type){var x=c();if(r._propBindingObject=r._propBindingObject||{},s&&(e.isLyteWidget||e.__lyteEnablePromise)){let e,t=!0;switch(L instanceof Promise?L.__lyte.status:"resolved"){case"init":O="__lyteAwait__";break;case"resolved":O="true",t=!1;break;case"rejected":O="__lyteFail__"}r._promiseContent&&r._promiseContent.length&&this.removeHelpers(r,void 0,!0),k=r.content.querySelector("[case="+O+"]"),e=r._cases[O],k._ht=e._ht,k._ht&&!k._htA&&(k.content.append(k._ht.content.cloneNode(!0)),k._htA=!0),E=e.dynamicNodes,t&&this.renderPromiseNodes(k,E,r,{},n,void 0,r._tC,a,x)}w.forEach((function(e,t,o){r._helpers[e]=[],r._specialNodes[e]=[],r._items[e]={_dynamicProperty:{},itemProperty:{},propProperty:{},propNodes:{}},_[m]=e,_[y]=L[e],h._properties[m]={},h._properties[y]={};var i={};i[m]={},i[m]._data=e,i[m]._dyn=[m],i[y]={},i[y]._data=L[e],i[y]._dyn=[y];let s={itemIndex:e,itemValue:y,keyValue:m,type:"forIn",node:r};r._items[e]._cx=s,E._cache=i;let l=this.renderNodes(k.hasAttribute("depth")&&k._depthTemp?k._depthTemp:k,E,r,s,n,void 0,r._tC,a);Object.keys(r._items[e]._dynamicProperty).forEach((function(e){r._dynProps[e]?r._dynProps[e]++:r._dynProps[e]=1})),r._items[e].itemProperty=this.getProperty(y),r._propBindingObject[e]=r._items[e].itemProperty,r._forContent[e]=Array.from(l.childNodes),this.executeBlockHelpers(r._helpers[e],r);let d=Object.keys(r._items[e].propProperty);if(d.length){let e=this;d.forEach((function(t){e.afterUpdateFor(e,r,t,s)}))}x.appendChild(l)}),this),P.unbound||(l(r._attributes.object,r._propBindingObject),P.establishBindings(r._propBindingObject,r._attributes.object)),P.unbound=S,"default"!==o.type?R._placeHolder?u(R._placeHolder.parentNode,x,R._placeHolder):u(R.parentNode,x,R):$={toAppendMain:x,lastNode:R}}P.unbound=S,_[m]=v,_[y]=g,h._properties[m]=b,h._properties[y]=A;for(let e in r._propNodes){this.setData(e,r._propNodes[e]);let t=r._cx;if(t)for(;t;)if("for"==t.type||"forIn"==t.type){let o=t.node._propNodes[e];t.node._propNodes[e]||(o=t.node._propNodes[e]=[]),o[t.itemIndex]=r._propNodes[e],t.node._childProp?-1==t.node._childProp.indexOf[e]&&t.node._childProp.push(e):t.node._childProp=[e],this.beforeUpdateFor(this,t.node,e,t.itemIndex),t=null}else t=t.node._cx;else P.affectChanges(this.getProperty(e))}return r._currentObject=L,$}updateSwitchHelper(e,r,o,i,n,a,s,l){if(r._specialNodes||(r._specialNodes=[]),t._ms||!r._ht||r._htA||(r.content.append(r._ht.content.cloneNode(!0)),r._htA=!0),"TEMPLATE"!==r.tagName){if(Object.keys(r).forEach((function(e){"innerHTML"!==e&&"innerText"!==e&&(r._origTemplate[e]=r[e])})),t._ie){var d=p("div");d.innerHTML=r._tC,r._origTemplate.innerHTML=d.children[0].innerHTML,this.constr.splitTextNodes(r._origTemplate),r.hasAttribute("depth")&&r._origTemplate.setAttribute("depth",r.getAttribute("depth"))}let o=r._origTemplate._placeHolder=document.createTextNode("");P.replaceWithPf(r,r._origTemplate._placeHolder),(r=P.replaceWithOrigTemplate(r)).setAttribute("is",e),P.apdNode(r,this),o._helper=r}else if(!r._placeHolder){var f;f=document.createTextNode(""),P.replaceWithPf(r,f),r._placeHolder=f,f._helper=r,P.apdNode(r,this)}let h,m,y=!1,_=r;if(r._callee||(r._callee=this,y=!0),o=o||r._cx,r._cx=o,r._dynamicProperty=r._dynamicProperty?r._dynamicProperty:{},""===r.getAttribute("value")||r.getAttribute("value")?m=r.getAttribute("value"):r._attributes&&(m=r._attributes.value),m){switch(m instanceof Promise?m.__lyte.status:"resolved"){case"init":h="__lyteAwait__";break;case"rejected":h="__lyteFail__";break;case"resolved":h="if"===e?"true":m.toString()}}else if("if"===e)h="false";else switch(m){case void 0:h="undefined";break;case null:h="null";break;case!1:h="false";break;case"":h='""';break;case 0:h="0"}if(h===r._currentCase)return;r._currentCase=h;var v=r._depthTemp||r;let g,b=r._cases[h];if(!b&&(b=r._default,g=t._ms?b.templateContent:v.content.querySelector("[default]"),t._ms||!b._ht||g._htA||(g._htA=!0,g.content.append(b._ht.content.cloneNode(!0))),r._isDefault=!0,!g)){r._caseContent&&r._caseContent.length&&this.removeHelpers(r,void 0,!0),r._caseContent=[];let e=document.createTextNode("");if(r._caseContent.push(e),r._currentCaseName=h,r._helpers=r._helpers||[],i)return void(_._placeHolder?u(_._placeHolder.parentNode,e,_._placeHolder):u(_.parentNode,e,r));{let t=c();return t.append(e),{lastNode:_,toAppendMain:t}}}r._caseContent&&r._caseContent.length&&this.removeHelpers(r,void 0,!0);let A,$=b,L=h;A=g||(t._ms?{}:v.content.querySelector("[case='"+P.cssEscape(L)+"']"));let E=[];for(;$;){t._ms||!$._ht||A._htA||(A._htA=!0,A.content.append($._ht.content.cloneNode(!0)));let e=$.dynamicNodes,o=this.renderNodes(A,e,r,void 0,n,void 0,$.templateContent,a);if(E.push(o),!$.additional)break;$.additional.next?(A=t._ms?{}:r.content.querySelector("[case='"+P.cssEscape($.additional.next)+"']"),$=r._cases[$.additional.next]):(A=t._ms?{}:r.content.querySelector("[default]"),$=r._default)}r._caseContent=[];let R=c();for(let e=0;e<E.length;e++)11==E[e].nodeType?r._caseContent=r._caseContent.concat(Array.from(E[e].childNodes)):r._caseContent.push(E[e]),R.append(E[e]);if(this.executeBlockHelpers(r._helpers,r),i){let e;return R.querySelector("template[is=break]")?e="break":R.querySelector("template[is=continue]")&&(e="continue"),r._placeHolder?u(r._placeHolder.parentNode,R,r._placeHolder):u(r.parentNode,R,r),e}return{toAppendMain:R,lastNode:r}}dummy(e,t){this.constr._properties[boundValue].observer}callObservers(e,t){let r=this.constr._properties[e],o=r?r.observer:void 0;if(o)for(let e=0;e<o.length;e++)-1!==t.indexOf(".")&&o[e].path!==t||this["_"+o[e].functionName].apply(this)}static updateValue(e,t,r){let o=t.split("."),n=e;for(let e=0;e<o.length-1;e++)n=n[o[e]];n[o[i]]=r}static createDocFragment1(e){if(e.content)return e.content;let t=e.childNodes,r=c(),o=t.length;for(let e=0;e<o;e++)r.appendChild(t[0]);return r}static _registerComponent(r,o,i){i&&(e.widgetComps=e.widgetComps||{},(e.widgetComps[i]=e.widgetComps[i]||[]).push(r));this.__widgetName=i;let n=P.lyteComponentsDiv,a=t.$.assetsDiv,s=this.component._template;var l;if(this.component._template&&"string"==typeof this.component._template){this.component._template.replace(/\\'/g,"'");let e=p("div");var d;if(e.innerHTML=this.component._template,i)var c=document.createElement("template");for(;e.firstChild;)"STYLE"===e.firstChild.nodeName?(a.querySelector("style[from-component='"+r+"']")&&a.querySelector("style[from-component='"+r+"']").remove(),e.firstChild.setAttribute("from-component",r),c&&c.content.appendChild(e.firstChild.cloneNode(!0)),a.appendChild(e.firstChild)):("TEMPLATE"==e.firstChild.tagName&&(d=e.firstChild),n.appendChild(e.firstChild))}else document.querySelector("template[tag-name='"+r+"']")&&(d=document.querySelector("template[tag-name='"+r+"']"),n.appendChild(d));if(this.component._template=d,i&&(this.component._template.setAttribute("widget",i),this.component._template._widgetStyles=c),this.component._template.class=this,this.component._template.widget=i,this._helperTemplate=document.createElement("template"),this._helperTemplate.setAttribute("_lyteht",r),P.h1Div.content.appendChild(this._helperTemplate),this.component._template){if(P.needDummyComponentsDiv)if(t._ie){let e=t.Compile.getTemplateFromString(s);P.dummyLyteComponentsDiv.appendChild(e)}else l=this.component._template.cloneNode(!0);this.component._template&&!this.component._template.content&&console.log("Dummy");var u,f=-1!==this.component._observedAttributes.indexOf("lyteUnbound"),h=t._ie?this.component._template:this.component._template.content;if(f&&(t._ie?((u=document.createElement("div")).innerHTML=this._template.outerHTML,u=u.childNodes[0]):u=this.component._template.cloneNode(!0)),this.splitTextNodes(h),f&&this.splitTextNodes(u),!this.component._dynamicNodes)if(t.Compile.getDynamicNodes){var m=t.Compile.getDynamicNodes(r,void 0,t._ie?h:void 0);if(m.errors)return console.error("Error in the component",m.componentName,m.errors),!1;this.component._dynamicNodes=m.dynamicNodes}else t.error("LC002",r);if(this.component._dynamicNodes){x(h,this.component._dynamicNodes,r,this,u?t._ie?u:u.content:void 0),t._ed?this._tC=this.component._template.outerHTML:t._ie&&(this._tC=h.outerHTML),this.component._templateAttributes=this.component._templateAttributes||{type:"attr",attr:{},position:[]};var y=[this.component._templateAttributes];if(x(this.component._template,y,r,this),this.component._templateAttributes=y[0],this.component._templateAttributes&&this.component._templateAttributes.attr){var _=this.component._template.attributes;try{for(let e=0;e<_.length;e++){let t=_[e].name;this.component._templateAttributes.attr[t]||"tag-name"===t||"use-strict"===t||(this.component._templateAttributes.attr[t]={name:t,staticValue:_[e].value},this.component._template.removeAttribute(t),l&&l.removeAttribute(t),e--)}}catch(e){t.error("Error with templateAttributes. ")}}}l&&P.dummyLyteComponentsDiv.appendChild(l),this.component._sta=u?P.processStatic(u):void 0}}static splitTextNodes(e){if(e&&e.childNodes&&e.childNodes.length)for(let t=e.childNodes.length-1;t>=0;t--)this.splitTextNodes(e.childNodes[t]);if("TEMPLATE"!==e.tagName||t._ie||this.splitTextNodes(e.content),e.nodeType===e.TEXT_NODE){let r=e.nodeValue;if(r){let o=r.match(/{{[^}]*?(?:(?:('|")[^\1]*?\1)[^}]*?)*}}/g);if(!o)return;let i=[];for(let e=0;e<o.length;e++){let t=r.indexOf(o[e]),n=t+o[e].length;t&&i.push(document.createTextNode(r.substring(0,t))),i.push(document.createTextNode(r.substring(t,n))),r=r.substring(n)}if((r.trim()||!e.nextSibling||3!==e.nextSibling.nodeType||e.nextSibling.nodeValue.trim())&&i.push(document.createTextNode(r)),t._rwpf&&"#document-fragment"===e.parentNode.nodeName){for(let t=0;t<i.length;t++)u(e.parentNode,i[t],e);e.remove()}else e.replaceWith.apply(e,i)}}}bindNode(o,i,n,a,c,u,f,h,m,y,_,v){let g,b,A=a.itemValue,$=a.itemIndex,L=a.type,E=a.indexValue,R=c.dynamicValue,w=c.directiveValue,C=c.helperInfo,O=o.ownerElement,T=[],S=N.getCmpData(this.component.data);2===o.nodeType&&(o={nodeName:o.nodeName,ownerElement:o.ownerElement,nodeType:2,nodeValue:o.nodeValue,_attributeDetails:o._attributeDetails,_isDirectiveNode:c._isDirectiveNode},b=P.directive.isDirectiveNode(c));C&&C.name;o._callee=this;let k=!1;if(!w&&C&&Object.keys(C).length){k=!0;o.nodeName;g=o.helperValue=C;let e=[];if("action"===C.name){let t=C.args[0];C.args[0]=t.startsWith("'")?t.replace(/'/g,""):t,t=C.args.slice(0,1)[0];let r=C.args.slice(1,C.args.length),i=!1,n=o.nodeName;return-1!=n.indexOf("-")&&(i=!0),e=[O,n,i,{name:t,args:r}],void this.processHelper({name:C.name,args:e},o)}if(e="method"===C.name?C.args:this.processArgs(this,{helperInfo:C},T,void 0,o,void 0,m),g=this.processHelper({name:C.name,args:e},o),"unescape"===C.name){o={dynamicPositions:{initialNode:o,dynamicNodeValue:g},_callee:o._callee,helperValue:o.helperValue},g=void 0,u.push(o)}}else{C={},w&&(R=w),o.syntaxValue=R;let e=[];g=P.get(S,R,e,m,this),T.push(e)}if(2==o.nodeType){let e=o.ownerElement.tagName;if("INPUT"==e||"TEXTAREA"==e||"DIV"==e&&o.ownerElement.hasAttribute("contenteditable")){o.ownerElement._rA=o.ownerElement._rA||[];o.ownerElement._rA.push(o)}O._origTemplate?o.ownerElement=O._origTemplate:(O.hasAttribute("lyte-for")||O.hasAttribute("lyte-if")||O.hasAttribute("lyte-switch")||O.hasAttribute("lyte-forin"))&&"TEMPLATE"!==O.tagName&&(t._ie?(o.ownerElement=p("template"),o.ownerElement.setAttribute("is",c._depthTemp)):o.ownerElement=c._depthTemp.cloneNode(!0),O._origTemplate=o.ownerElement)}let x,D=!1;if("unbound"!==C.name&&!P.unbound){let e;n&&(e=L?n._items[$]._dynamicProperty:n._dynamicProperty);for(let t=0;t<T.length;t++){let r=T[t];for(let t=0;t<r.length;t++){let i=this.getProperty(r[t]);if(n){let l,c=r[t].search(/\W/);l=-1!==c?r[t].substring(0,c):r[t];let p=!0;n&&n._dirObj&&L&&l&&(n._dirObj.prop&&-1!=n._dirObj.prop.indexOf(l)||n._dirObj.data&&-1!=n._dirObj.data.indexOf(l))&&(p=!1,D=!0),!p||l===A||l===E||a.node&&a.node._properties&&a.node._properties[l]?(o._cx=a,d(i,"_dynamicNodes"),i._dynamicNodes.push(o),l!==E&&(x=i)):(s(i,"_helperNodes"),i._helperNodes.add(n),e[r[t]]?e[r[t]].push(o):(e[r[t]]=[]).push(o))}else d(i,"_dynamicNodes"),i._dynamicNodes.push(o);if(O&&(O.hasAttribute("lyte-for")||O.hasAttribute("lyte-if")||O.hasAttribute("lyte-switch")||O.hasAttribute("lyte-forin"))||O&&"TEMPLATE"===O.tagName&&/^(for|forIn)$/.test(O.getAttribute("is"))&&!k){let e=O.getAttribute("is");("for"===e&&"items"===o.nodeName||"forIn"===e&&"object"===o.nodeName)&&(i._forHelpers||s(i,"_forHelpers"),o.ownerElement._actualBinding=i,i._forHelpers.add(o.ownerElement))}(f||D)&&P.establishSelectedBinding(i,S,this)}r.length>1&&(o._multipleProperty=o._multipleProperty||[],o._multipleProperty.push({dynamicProp:x?void 0:e,actProp:this.getProperty(r[0]),helperNode:n,dynamicValues:r,index:t}))}}if(g=g,b)w||P.directive.setNodeArgs(o,g,this);else if(2===o.nodeType){let t=o._parentNode?o._parentNode:o.ownerElement;if(t.tagName){t.getAttribute("is")}let n=P.isCustomElementV3(t,!0);n&&!b&&(t.set?t.set(P.String.toCamelCase(o.nodeName),g):(t._initProperties=t._initProperties||{},t._initProperties[P.String.toCamelCase(o.nodeName)]=g));let a=g;
//!== "string"
if(n&&"string"!=typeof g&&!h)t._attributes=t._attributes||{},t._attributes[o.nodeName]=g,"TEMPLATE"===t.nodeName&&k&&("for"===t.getAttribute("is")&&"items"===o.nodeName||"forIn"===t.getAttribute("is")&&"object"===o.nodeName&&!P.unbound)&&(o.ownerElement._actualBinding={_forHelpers:(new Set).add(t),_createdBinding:!0},g&&l(g,o.ownerElement._actualBinding)),i.push(o.nodeName);else if(b&&e.isLyteWidget&&-1!=o.tagName.indexOf("-")&&(o.$data||(o.$data={}),o.$data[P.String.toCamelCase(o.nodeName)]=g),"boolean"==typeof g)t._attributes=o.ownerElement._attributes||{},t._attributes[o.nodeName]=g,g?t.setAttribute(o.nodeName,""):i.push(o.nodeName);else{var j;if(g&&"object"==typeof g)if(void 0!==Record&&g instanceof Record)j=JSON.stringify(g.$.toJSON());else try{j=JSON.stringify(g)}catch(e){r.error("Data passed for property '"+o.nodeName+"' of '"+o.ownerElement.nodeName.toLocaleLowerCase()+"' cannot be serialized. The component '"+o.ownerElement.nodeName.toLocaleLowerCase()+"' might not be registered before its use.")}else j=null==g||null==g?"":g;if(g=j,P.isControlHelper(o.ownerElement))t._attributes=o.ownerElement._attributes||{},t._attributes[o.nodeName]=g,i.push(o.nodeName);else{let e=void 0===g?"":g;o.ownerElement.setAttribute(o.nodeName,e)}}if("LYTE-YIELD"===t.tagName){N.getCmpData(t.component.data)[P.String.toCamelCase(o.nodeName)]=a}/^(INPUT|TEXTAREA|SELECT)$/.test(t.nodeName)&&("value"===o.nodeName?t.value=void 0===g?"":g:"checked"===o.nodeName&&(t.checked=g)),g||-1===P.booleanAttrList.indexOf(o.nodeName)||i.push(o.nodeName)}else o.nodeValue=void 0===g?"":g;return o}debounce(e,t){var r;return function(){var o=this,i=arguments;function n(){e.apply(o,i),r=null}r&&clearTimeout(r),r=setTimeout(n,t||100)}}getProperty(e){var t=e.match(/([^[\].]+|\[\])/g);let r=this;r._properties[t[0]]||(r._properties[t[0]]={}),r=r._properties[t[0]],defProp(r,"_path",{enumerable:!1,value:t[0]});for(let e=1;e<t.length;e++)(t[e].startsWith("'")||t[e].startsWith('"'))&&(t[e]=t[e].substring(1,t[e].length-1)),r[t[e]]||(r[t[e]]={},defProp(r[t[e]],"_path",{enumerable:!1,value:r._path+"."+t[e]})),r=r[t[e]];return r}updateNode(t,o,i){let n=this.component;var a="delete";let c,p,u,f,h,m=[];if(2==t.nodeType&&(p=P.directive.isDirectiveNode(t)),t._multipleProperty)for(var y=0;y<t._multipleProperty.length;y++)if(t._multipleProperty[y]&&t._multipleProperty[y].dynamicValues.lastIndexOf(o)>0){let e;if(m[y]=!1,c=t._multipleProperty[y],c.dynamicProp){if(m[y]=c,e=c.dynamicProp[c.actProp._path],e){let r=e.indexOf(t);e.splice(r,1)}let r=c.helperNode;if(0===e.length)if("if"===r.getAttribute("is"))c.actProp._helperNodes[a](r),delete c.dynamicProp[c.actProp._path];else if(delete c.dynamicProp[c.actProp._path],r._items){let e=!0;for(let t=0;t<r._items.length;t++)if(r._items[t]._dynamicProperty&&r._items[t]._dynamicProperty[c.actProp._path]){e=!1;break}e&&c.actProp._helperNodes[a](r)}}if(!m[y]&&(m[y]="dynamicNodes",e=c.actProp._dynamicNodes,e)){let r=e.indexOf(t);e.splice(r,1),e.length||delete c.actProp._dynamicNodes}}if(!t.syntaxValue&&!t.helperValue)return;if(t._cx||2===t.nodeType&&t.ownerElement._cx){u=t._cx||t.ownerElement._cx;var _=[];P.changeContext(u.node,_,u)}else if("LYTE-YIELD"===t.tagName&&t._callee._cx){f=!0,u=t._callee._cx;_=[];P.changeContext(u.node,_,u,!0)}let v=[];var g=!1;if(t.helperValue){g=!0,h=t.helperValue;let e=h;if(h=this.processHelper({name:e.name,args:this.processArgs(this,{helperInfo:e},v,void 0,t)},t),"unescape"===e.name){let e=t.dynamicPositions,r=e.startingNode,o=e.length;for(;o>1;){let e=r.nextSibling;r.remove(),r=e,o--}let i=h.childNodes.length;i||(h.appendChild(document.createTextNode("")),i=1);let n=h.childNodes[0];r.replaceWith.apply(r,h.childNodes);let a={startingNode:n,length:i};t.dynamicPositions=a,h=void 0}}else{let e,r=t.syntaxValue;-1===r.indexOf(".")&&-1===r.indexOf("[")||(e=r,r=r.substring(0,r.indexOf(".")));let o=N.getCmpData(n.data),i=e?P.get(o,e,v,void 0,n.$node):o[r];h=i}if(v[0]instanceof Array||(v=[v]),m)for(y=0;y<m.length;y++)if(m[y]){let e=t._multipleProperty[y],r=t._multipleProperty[y].index,o=this.getProperty(v[r][0]),i=this.getProperty(v[r][0].substring(0,v[r][0].indexOf(".")));var b=this.getData(v[r][0].substring(0,v[r][0].indexOf(".")));if("dynamicNodes"===m[y])d(o,"_dynamicNodes"),o._dynamicNodes.push(t);else{s(o,"_helperNodes"),o._helperNodes.add(e.helperNode);let r=e.dynamicProp;r[o._path]?r[o._path].push(t):(r[o._path]=[]).push(t)}if(t.ownerElement&&(t.ownerElement.hasAttribute("lyte-for")||t.ownerElement.hasAttribute("lyte-if")||t.ownerElement.hasAttribute("lyte-switch")||t.ownerElement.hasAttribute("lyte-forin"))||t.ownerElement&&"TEMPLATE"===t.ownerElement.tagName&&/^(for|forIn)$/.test(t.ownerElement.getAttribute("is"))&&!g){var A=t.ownerElement.getAttribute("is");("for"===A&&"items"===t.nodeName||"forIn"===A&&"object"===t.nodeName)&&(e.actProp._forHelpers.has(t.ownerElement)&&e.actProp._forHelpers.delete(t.ownerElement),o._forHelpers||s(o,"_forHelpers"),t.ownerElement._actualBinding=o,o._forHelpers.add(t.ownerElement))}null!=b&&P.establishBindings(i,b),t._multipleProperty[y].actProp=o,t._multipleProperty[y].dynamicValues=v[r]}if(p)P.directive.setNodeArgs(t,h,this),t.ownerElement.hasAttribute("comp-in-parent")&&r.Component.set(t.ownerElement.$data,P.String.toCamelCase(t.nodeName),h),t._saveNode&&P.directive.save.updateNode(this,t,h);else if(2===t.nodeType){let o=[],n=t._parentNode?t._parentNode:t.ownerElement;if("TEMPLATE"===n.tagName&&"component"===n.getAttribute("is")&&"component-name"!==t.nodeName){if(n.hasAttribute("lyte-keep-alive"))for(var $ in n._renderedComponent)o.push(n._renderedComponent[$]);else{var L=n._currentComponent;L&&n._renderedComponent[L]&&o.push(n._renderedComponent[L])}}o.push(n);for(let n=0;n<o.length;n++){let a=o[n];if(a.set)a.set(P.String.toCamelCase(t.nodeName),h,void 0,!0);else{a._initProperties=a._initProperties||{};let r=P.String.toCamelCase(t.nodeName);e.isLyteWidget&&"TEMPLATE"!=a.tagName?DataBindingLayer.updateInitProperties(a,r,h):a._initProperties[r]=h}let s=a&&"LYTE-YIELD"===a.tagName?N.getCmpData(a.component.data):void 0;
//!== "string"
if("LYTE-YIELD"===a.tagName&&s&&t.nodeName&&s[t.nodeName]!==h&&P.set(s,P.String.toCamelCase(t.nodeName),h,void 0,void 0,a),a._attributes=a._attributes||{},P.isCustomElementV3(a,!0)&&"string"!=typeof h){if("TEMPLATE"===t.ownerElement.nodeName){if(t.helperValue){if("for"===t.ownerElement.getAttribute("is")&&"items"===t.nodeName||"forIn"===t.ownerElement.getAttribute("is")&&"object"===t.nodeName){let e=t.ownerElement._attributes[t.nodeName],r=h;P.removeSelectedBindingDeep(t.ownerElement._actualBinding,e),r&&(l(r,t.ownerElement._actualBinding),P.establishBindings(t.ownerElement._actualBinding,r)),"object"===t.nodeName&&P.removeSelectedBindingDeep(t.ownerElement._propBindingObject,e)}}else if("for"===t.ownerElement.getAttribute("is")&&"items"===t.nodeName||"forIn"===t.ownerElement.getAttribute("is")&&"object"===t.nodeName){let e=t.ownerElement._attributes[t.nodeName];"object"===t.nodeName&&P.removeSelectedBindingDeep(t.ownerElement._propBindingObject,e)}a["__"+t.nodeName]=!0,a.removeAttribute(t.nodeName)}}else if("boolean"==typeof h)a._attributes=a._attributes||{},a._attributes[t.nodeName]=h,h?a.setAttribute(t.nodeName,""):a.removeAttribute(t.nodeName);else{var E;if(h&&"object"==typeof h)if(void 0!==Record&&h instanceof Record)E=JSON.stringify(h.$.toJSON());else try{E=JSON.stringify(h)}catch(e){r.error("Data passed for property '"+t.nodeName+"' of '"+t.ownerElement.nodeName.toLocaleLowerCase()+"' cannot be serialized. The component '"+t.ownerElement.nodeName.toLocaleLowerCase()+"' might not be registered before its use.")}else E=null==h||null==h?"":h;h=E;let e=void 0===h?"":h,o=t.ownerElement;o.hasAttribute(t.nodeName)?"INPUT"==o.tagName&&"value"==t.nodeName&&o.validity.badInput||o.setAttribute(t.nodeName,e):t.nodeValue=e}if(a._attributes[t.nodeName]=h,/^(INPUT|TEXTAREA|SELECT)$/.test(a.nodeName))if("value"===t.nodeName){let e=void 0===h?"":h;a.value!==e&&(a.value=e)}else"checked"===t.nodeName&&(a.checked=h);h||-1===P.booleanAttrList.indexOf(t.nodeName)||a.removeAttribute(t.nodeName);let d,c,p=a._isStopped;switch(a.getAttribute("is")){case"for":i?i.type="update":i={type:"update"},this.updateForHelper(a,i);break;case"if":d=this.updateSwitchHelper("if",a,void 0,!0,!0);break;case"forIn":i?i.type="update":i={type:"update"},this.updateForInHelper(a,i);break;case"switch":this.updateSwitchHelper("switch",a,void 0,!0,!0);break;case"component":"component-name"===t.nodeName&&this.updateDynamicComponent(a,"update")}p&&p!==d?c=d?"break"===d?"MS":"SM":"break"===p?"SM":"SS":"break"===d?c="MS":"continue"===d&&(c="SS"),c&&this.handleBreak(a._cx,c)}}else t.nodeValue=void 0===h?"":h;if(t.ownerElement&&t.ownerElement._hooksPresent){let e=P.directive.save.getAttr(t.ownerElement._specialAttributeDetails);e&&P.directive.save.triggerAllListeners(this,e,t.ownerElement)}u&&P.removeContext(u.node,_,u,f)}handleBreak(e,t){if(e){let r=e.node,o=e.itemIndex,i=(r.getAttribute("item"),e.node._forContent),n="M"===t[0]?i.length:o+1;for(let e=o;e<n;e++){let t=i[e];for(let e=0;e<t.length;e++)t[e].remove(),(t[e]._forContent||t[e]._caseContent)&&this.removeHelpers(t[e]);i[e]=[],P.removeSelectedBindingDeep(r._items[e].itemProperty,r._attributes.items[e]),r._helpers[e]=[],r._items[e]={_dynamicProperty:{},itemProperty:{},indexProperty:{}}}let a=r._attributes.items.length;"M"===t[1]?this.updateForHelper(r,{firstIndex:o,secondIndex:a-o,type:"replace"},void 0,{}):this.updateForHelper(r,{firstIndex:o,secondIndex:1,type:"replace"},void 0,{})}}createCustomEvent(e,t,r){const o=new CustomEvent(e);t._actions[e]=o,t._actions[e].processAction=r}isEmptyString(e){return!("string"==typeof e)||""===e}processArgs(e,t,r,o,i,n,a){let s=t.newHelperInfo&&n?t.newHelperInfo.args:t.helperInfo.args;r=r||[];let l=N.getCmpData(e.component.data);s=Array.isArray(s)?Array.from(s):s;let d=e.__lyteWidget;for(let t=0;t<s.length;t++)if(s[t]&&s[t].type)this.internalHelpers(e,s,t,r,o,i,n,a);else if(this.isEmptyString(s[t]))n&&s[t]instanceof Array&&(s[t]=P.getDD(l,s[t]));else if(s[t].startsWith("'")&&s[t].endsWith("'"))s[t]=s[t].substr(1,s[t].length-2);else{s[t]=s[t].trim();let n=[];if("event"===s[t]&&o)s[t]=d&&widgetMap.has(d)?widgetMap.get(d).getClone(o):o;else if("this"===s[t]&&i){let e=2===i.nodeType?i.ownerElement:i;s[t]=d&&widgetMap.has(d)?widgetMap.get(d).getClone(e):e}else s[t]=P.get(e.component.data,s[t],n,a);r.push(n)}return s}internalHelpers(e,t,r,o,i,n,a,s){let l=t[r].value,d=this.processHelper({name:l.name,args:this.processArgs(e,{helperInfo:l},o,i,n,a,s)});t[r]=d}processHelper(r,o){let i,n=[],a=r.name,s=v.registeredHelpers[a];if(e.isLyteWidget&&-1==P.defaultHelpers.indexOf(a)&&(i=this.component.constructor,i._widget&&(s=i._helpers[a]||s,!s)))t.error("LC003",r.name);else{if(s){switch(r.name){case"method":n.push(this,o);break;case"lbind":n.push(this,o.ownerElement);break;case"lyteViewPort":if(!o||!o.ownerElement)return!1;n.push(o.ownerElement),r.args.length||n.push(!1)}return s.apply(this,n.concat(r.args))}t.error("LC003",r.name)}}getActionProperty(e){let t=this._properties;return t?t[e].value:void 0}hasInternalBindings(e){return e.match(/[(]{1}[^)]+[)]{1}/)}getArgValues(e,t){let r=[];for(let o=0;o<e.length;o++)r.push(t[e[o]].value);return r}createEventListeners(e,t,r){if(e._callee||e===this||(e._callee=this),-1==a.indexOf(t)){let o=t.substr(2);e.getAttribute(o);v.registeredComponents[e.localName]&&!e.component||"TEMPLATE"===e.tagName&&"component"===e.getAttribute("is")?(e._toRegEvnts=e._toRegEvnts||{},e._toRegEvnts[t.substr(2)]={listener:L,attrVal:this.tagName.toLowerCase()+" => "+r.name}):(e.setAttribute(o,this.tagName.toLowerCase()+" => "+r.name),e.addEventListener(t.substr(2),L)),e.hasAttribute(t)&&(e[t]=void 0),e.removeAttribute(t)}}registerParentYield(e){let r,o=this._callee._yields[e];o&&(t._ie?(r=document.createElement("div"),r.innerHTML=o.outerHTML,r=r.childNodes[0],this.constructor.splitTextNodes(r)):r=o.cloneNode(!0),Object.keys(o).forEach((function(e){r[e]=o[e]})),this._yields[e]=r)}registerYields(){this._yields={};let e=this.querySelectorAll("template[is=registerYield],template[is=yield]"),t=[];for(let r=0;r<e.length;r++){for(;e[r].hasChildNodes();)e[r].content.appendChild(e[r].childNodes[0]);e[r].hasAttribute("from-parent")&&this._callee?this._callee._yields?this.registerParentYield(e[r].getAttribute("yield-name")):t.push(e[r]):this._yields[e[r].getAttribute("yield-name")]=e[r]}if(t.length&&this._callee){var r=this;this.lazyYield=function(){if(r._callee){for(let e=0;e<t.length;e++){let o=t[e];r.registerParentYield(o.getAttribute("yield-name"))}r._callee.removeEventListener("onReady",r.lazyYield),delete r.lazyYield}},this._callee.addEventListener("onReady",this.lazyYield)}}connectedCallback(){this._connectedCalled||this.__lyteIgnore||this.__v3lyteIgnore||(this._connectedCalled=!0,this._connectedCallback())}_connectedCallback(){if(this.hasAttribute("lyte-rendered")||!v.registeredComponents[this.localName]||this._ccCalled)return;let e=this._fR;if(e||(this._callee=this._callee||this.getCallee(this.parentNode)),this.__h={},this.__counter=0,this.__dc={},e){let t=e.methods;t&&this.setMethods(t),P.ccDelay.push(this),this._ccCalled=!0}else this.actualConnectedCallback();let t=N.getCmpData(this.component.data);(this._initProperties&&this._initProperties.hasOwnProperty("lyteViewPort")?this._initProperties.lyteViewPort:t.lyteViewPort)&&(P.isViewPortPending||(requestAnimationFrame((function(){requestAnimationFrame((function(){P.executePendingViewPort()}))})),P.isViewPortPending=!0),P.pendingViewPortElements.push(this))}cmpBind(e){let t=N.getCmpData(this.component.data);P.unbound||e||(r.establishObserverBindings.call(this,this.component.constructor._observers),r.establishWatchScope.call(this,this.constructor._deepWatchProperties),l(t,this._properties),P.establishBindings(this._properties,t))}actualConnectedCallback(){this._transitionHelperNodes=[],this._specialNodes=[];let e=this.component.data,o=this._fR;o&&(this._callee=this._callee||this.getCallee(this.parentNode));let i=this.component.constructor._templateAttributes;if(i&&i.attr)for(let t in i.attr){let r=i.attr[t];if(!this.hasAttribute(r.name)&&!e.hasOwnProperty(r.name)||r.globalEvent){if(r.helperInfo&&"action"===r.helperInfo.name){this._evBoundEvents=this._evBoundEvents||{};let e,t=r.helperInfo.args[0];e=t.startsWith('"')||t.startsWith("'")?t.substring(1,t.length-1):t;let o=r.globalEvent||-1!==r.name.indexOf("-")?r.name:r.name.substr(2);this._evBoundEvents[o]={name:e,args:r.helperInfo.args,from:"component"};let i=this.getAttribute(r.name),n=this.component.constructor._template.getAttribute(r.name);this.setAttribute(r.name,n+(i?" ; "+i:""))}r.globalEvent||(r.from="component",r.staticValue?this.setAttribute(i.attr[t].name,r.staticValue):(this.setAttribute(i.attr[t].name,"{{dummy}}"),this.bindNode(this.attributes.getNamedItem(i.attr[t].name),[],void 0,{},i.attr[t],void 0,void 0,!0)))}}for(let e in this._toRegEvnts)this.addEventListener(e,this._toRegEvnts[e].listener),this.hasAttribute(e)?this.setAttribute(e,this.getAttribute(e)+" ; "+this._toRegEvnts[e].attrVal):this.setAttribute(e,this._toRegEvnts[e].attrVal);this._toRegEvnts={};let n=P.unbound,a=this.getAttribute("ssrbindservernode");a&&!this.component.data.lyteUnbound&&(this.bindServerData(),this.removeAttribute("ssrbindservernode"));let s=this.afterConnected(o,a);if(!a&&this.cmpBind(o),P.unbound=n,"string"==typeof s){if(s)if(P.frSpecial){let e=document.createElement("template");e.innerHTML=s,this.innerHTML="",this.appendChild(e.content)}else this.innerHTML=s;P.processAction(this)}else{if(this.component.data.lyteViewPort)if(this._vpc=!0,t._ie){for(var d=0;d<s.childNodes.length;d++)if(s.childNodes[d].tagName){this._dummyViewPortF=s.childNodes[d];break}for(d=s.childNodes.length-1;d>=0;d--)if(s.childNodes[d].tagName){this._dummyViewPortL=s.childNodes[d];break}}else this._dummyViewPortF=s.children[0],this._dummyViewPortL=s.children[s.children.length-1];this.appendChild(s)}let c,p=this.component.__data,u=this.attributes;this.__lyteIgnore=!0;for(let e=u.length-1;e>-1;e--){let t=N.String.toCamelCase(u[e].nodeName);p[t]&&p[t].hideAttr&&this.removeAttribute(u[e].nodeName)}for(let e in this._hideAttr){let t=P.String.dasherize(e);0==this._hideAttr[e]&&this.getAttribute(t)!=this.component.data[e]&&this.setAttribute(t,this.component.data[e])}if(this.__lyteIgnore=!1,this._callee&&this._callee.serverCall&&(this.serverCall=!0),this.serverCall&&!this.hasAttribute("server-rendered")){this.setAttribute("server-rendered","");var f=N.sendtoclient.call(this,this,!0,this.component.__data);this.setAttribute("component-data",JSON.stringify(f))}if(this.hasAttribute("server-rendered")||this.setAttribute("lyte-rendered",""),o||r._ignoreOnReady||this.dispatchEvent(new CustomEvent("onReady")),this._triggerOnInit){let e=this._triggerOnInit,t=this;e.forEach((function(e){r.Component.set(e.scope.$data,e.value,"data"==e.name?t.$data:t,{force:!0})})),this._triggerOnInit=void 0}if(this.__updateProp)if(this._cx){let e=this._cx.node;if("for"==this._cx.type||"forIn"==this._cx.type){let t=this._cx.itemIndex;if(this.__updateProp.data){let o=this;this.__updateProp.data.forEach((function(i){e._propNodes[i]&&(l(o.$data,e._items[t].propProperty[i]),r.Component.set(e._propNodes[i],t,o.$data,{force:!0}),P.affectChanges(e._items[t].propProperty[i]),P.establishBindings(e._items[t].propProperty[i],e._propNodes[i][t]))}))}else if(this.__updateProp.prop){let o=this;this.__updateProp.prop.forEach((function(i){e._propNodes[i]&&r.Component.set(e._propNodes[i][t],"$data",o.$data,{force:!0})}))}}}else if(this.__updateProp.data){let e=this;this.__updateProp.data.forEach((function(t){r.Component.set(e._callee.component.data,t,e.$data,{force:!0})}))}else if(this.__updateProp.prop){let e=this;this.__updateProp.prop.forEach((function(t){r.Component.set(e._callee.component.data,t,e,{force:!0})}))}this.component._config&&null!=this.component._config.clientLifeCycleHooks&&(c=1==this.component._config.clientLifeCycleHooks||"object"==typeof this.component._config.clientLifeCycleHooks&&this.component._config.clientLifeCycleHooks.includes("didConnect"));let h=this.component._ssr?this.component._ssr.overrides:void 0;if((!this.hasAttribute("server-rendered")||this.serverCall||c)&&(h&&h.didConnect&&this.serverCall?h.didConnect.apply(this):this.callback("didConnect"),this.onCallBack("didConnect")),t.isWidgetBuild&&this.hasAttribute("comp-in-parent")){let e=this;setTimeout((function(){DataBindingLayer.sendDataUpdateToFrame(e,e.component.data)}),0)}null==this.serverCall&&this.callback("didRender"),o&&this.removeAttribute("_lyteprop")}onCallBack(e){let r=this.component.constructor._callBacks[e];if(r)for(let e=0;e<r.length;e++)try{r[e].value.call(this.component)}catch(e){t.error(e)}}callback(e){var r,o=this.component[e];if(o){arguments.length>1&&(r=Array.from(arguments)).splice(0,1);try{var i=this.component;this.__lyteWidget&&widgetMap.has(this.__lyteWidget)&&(i=widgetMap.get(this.__lyteWidget).getClone(i)),o.apply(i,r||[])}catch(e){t.error(e)}}}establishObserverBindings(){let e=this.component.constructor._observers;for(let t=0;t<e.length;t++){let r=e[t].properties;for(let o=0;o<r.length;o++){let i,n=!1;-1!==r[o].indexOf(".[]")?(n=!0,i=this.getProperty(r[o].substring(0,r[o].indexOf(".[]")))):i=this.getProperty(r[o]),s(i,"_observers"),i._observers.add({callee:this,observer:e[t],isArrayObserver:n})}}}removeBindings(e,t){for(let r in e){let o=t[r];o&&o._bindings&&o._bindings.delete(e[r]),"object"==typeof e[r]&&o&&this.removeBindings(e[r],o)}}actualDisconnected(){try{var e=this;if(!e.component)return;for(i in e._cx=null,e._callee=null,e.component.$node=null,e.component.__data=null,e.component.data.__target__?e.component.data.__target__.__component__=null:e.component.data.__component__=null,e.component.data=null,e.component=null,e.__dc=e.__dc||{},e.__h=e.__h||{},e.__dc){var t=e.__dc[i];if(t.hasAttribute("lyte-keep-alive"))for(var r=Object.keys(t._renderedComponent),o=0;o<r.length;o++){let e=r[o];if(e!==t._currentComponent){let r=t._renderedComponent[e];r.constructor.prototype._disconnectedCallback.call(r),r.remove()}}}for(i in e.__h)e.__h[i].remove();e.__h={},e.__dc={};let n=e._yields;for(var i in n)n[i]._callee=null;e=null}catch(e){console.error(e)}}disconnectedCallback(){this._disconnectedCallback()}_disconnectedCallback(){if(this.__v3lyteIgnore)return void P.V3.pendingComp.remove(this);if(v.shouldIgnoreDisconnect()||!this.component||this.__lyteIgnore)return;var e=this.constructor.__widgetName;e&&(e=widgetMap.get(e)).additionalComps.delete(this.parentElement);var t=P.pendingViewPortElements;if(this.component.data.lyteViewPort){var o=t.indexOf(this);-1!=o&&t.splice(o,1)}if(v.viewPortSettings.handlePendingItems&&this._vpc&&(P.executeVpe=!0),t.length)for(let e=0;e<t.length;e++){let r=P.getActViewPortTemplate(t[e]);r&&"TEMPLATE"==r.tagName&&"if"==r.getAttribute("is")&&r._callee==this&&(t.splice(e,1),e--)}if(this.__elmCnt&&delete DataBindingLayer.parentMap[this.__elmCnt],this.__elmCntW&&delete DataBindingLayer.childMap[this.__elmCntW],this._destroyed=!0,this.__toRemoveLazy){for(var i in this.__toRemoveLazy){this.__toRemoveLazy[i].forEach((function(e){r.$.toRemoveFromRequiredServices(e)}))}delete this.__toRemoveLazy}this.component._bindings=null;var n=this.__scpObj;let a=N.getCmpData(this.component.data);if(n)for(var s in n){var l=a[s],d=n[s].split("_");l&&r.removeNestScp(a[s],d[0],d[1],void 0,this)}this._fR||P.removeSelectedBindingDeep(this._properties,a,!0);var c=this.__h;for(s in c)c[s]._actualBinding&&this.removeHelpers(c[s]);c={};for(let e in this._properties)this._properties[e]={};(this._specialNodes=null,this.callback("didDestroy"),this.onCallBack("didDestroy"),this.__lyteWidget)&&widgetMap.get(this.__lyteWidget).removeComponent(this);P.dcc||(P.dcc=[],requestAnimationFrame((function(){requestAnimationFrame((function(){try{P.executeVpe&&(v.viewPortSettings.executePendingViewPortElements(),P.executeVpe=!1);for(var e,t=0;e=P.dcc[t];t++)e.actualDisconnected()}catch(e){console.error(e)}P.dcc=void 0}))}))),P.dcc.push(this),this.lazyYield&&this.removeEventListener("onReady",this.registerParentYield),this.constr.activeInstances--,this.component.constructor.activeInstances--}}R._V4InsApi=["getData","getDirectiveObj","getShadowObj","getFastObj","cmpBind","component","actualConstructor","_connectedCallback","actualConnectedCallback","getMethods","hasAction","setActions","setMethods","getCallee","afterConnected","bindServerData","bindServerNode","getServerTemplates","bindServerFor","bindServerIf","getRandomId","getssrType","renderComponent","renderFast","formatValue","renderNodes","executeBlockHelpers","updateBlockHelpers","_attributeChangedCallback","removeHelpersSpecificIndex","removeHelpers","updateYield","updateDynamicComponent","updateForHelper","updateForInHelper","rmCaseBindings","getCaseTemplate","getCaseIndexScope","getSwitchScope","updateSwitchHelper","callObservers","bindNode","debounce","getProperty","updateNode","handleBreak","createCustomEvent","isEmptyString","processArgs","internalHelpers","internalArray","processHelper","getActionProperty","hasInternalBindings","getArgValues","createEventListeners","registerParentYield","getYieldName","registerYields","onCallBack","callback","establishObserverBindings","removeBindings","actualDisconnected","_disconnectedCallback","throwAction","get","set"],R._V3InsApi=["getData","cmpBind","component","actualConstructor","_connectedCallback","actualConnectedCallback","getMethods","hasAction","setActions","setMethods","getCallee","afterConnected","renderComponent","renderFast","formatValue","renderNodes","executeBlockHelpers","updateBlockHelpers","_attributeChangedCallback","removeHelpersSpecificIndex","removeHelpers","updateYield","updateDynamicComponent","updateForHelper","updateForInHelper","updateSwitchHelper","callObservers","bindNode","debounce","getProperty","updateNode","handleBreak","createCustomEvent","isEmptyString","processArgs","internalHelpers","processHelper","getActionProperty","hasInternalBindings","getArgValues","createEventListeners","registerParentYield","registerYields","onCallBack","callback","establishObserverBindings","removeBindings","actualDisconnected","_disconnectedCallback","throwAction","get","set","initializeMethod"],R._V4StaticApi=["_observers","_callBacks","_properties","activeInstances","_depthTemp","_bindsIds","_ssr","_config","_mixins","_serviceToBeUsed","_actions","_template","_dynamicNodes","_templateAttributes","_observedAttributes","_observedMethodAttributes","_data","_methods","_pendingComponents","splitTextNodes","_registerComponent","createDocFragment1","updateValue","seperateStyle","getFastRenderSupported","setTemplateAttributes"],R.version={v3:{component:void 0}};let w=String.prototype._replace?String.prototype._replace:String.prototype.replace,N={defaultHelpers:["unbound","action","lbind","method","stringifyHTML","unescape","escape","debugger","log","ifEquals","if","negate","ifNotEquals","concat","encAttr","expHandlers","lyteViewPort"],baseCompClass:class{constructor(){this.$||(this.$={}),Object.assign(this.$,this.$functions),this.$.validate=function(){var e=this._ins,t=e.data;for(var r in t)N.handleValidation(t,r,t[r],e)},this.$._ins=this,this._setWidget&&this._setWidget()}},fRP:{},fRC:0,customPropRegex:"",customPropHandlers:[],_registeredComponents:{},_reRegisteredComponents:[],toBeRegistered:[],getCmpData:function(e){return e&&e.__target__?e.__target__:e},getCmpData:function(e){return e&&e.__target__?e.__target__:e},updateCustomCrmComponent:function(e,t){for(let i in e)if(e[i]&&"observer"===e[i].type)e[i].fnName=i,t.component._observers.push(e[i]);else if(e[i]&&"callBack"===e[i].type){for(var r=e[i].properties,o=0;o<r.length;o++)t.component._callBacks[r[o]]||(t.component._callBacks[r[o]]=[]),e[i].fnName=i,t.component._callBacks[r[o]].push(e[i]);e[i].observes&&(e[i].observes.fnName=i,t.component._observers.push(e[i].observes))}else t.component.prototype[i]=e[i];return e},dataFromMixin:function(e,t,r,o){var i=e.length;for(let n=0;n<i;n++)for(let i in e[n])"actions"===i?Object.assign(t,e[n][i]):"methods"===i?Object.assign(r,e[n][i]):o[i]=e[n][i];return{actionsFromMixin:t,methodsFromMixin:r,newDefinition:o}},throwEvent:function(e){let t=this.$node?this.$node:this;const r=t._actions?t._actions[e]:void 0;let o=[];if(arguments.length>1)for(let e=1;e<arguments.length;e++)o.push(arguments[e]);P.throwAction.call(t,t._callee,e,void 0,!0,o,t),this.$node&&t.dispatchEvent(r||new CustomEvent(e,{detail:o}))},throwAction:function(e,r,o,i,n,a,s,l,d){let c;if(this._route&&i)c=(e=t.Router.getRouteInstance(this._route)).actions||(e.actions={});else if(this.routeName){let r=this.parent;r&&(c=r.component?(e=r.component).component?e.component.constructor._actions:(e=t.Router.getRouteInstance(e._route)).actions||(e.actions={}):(e=r).actions||(e.actions={}))}else if(e){if(!e.component)return;c=e.component.constructor._actions}if(!e)return void(l||t.warn("Nothing handled the action "+r+"."));if(t.isWidgetBuild){if(!this.__widget)return}else if(this.__widget)return;let p=n||[];if(o=o||(this._actions&&this._actions[r]?this._actions[r].processAction:void 0)){var u=[];let n;if(a&&P.adCx(a,u),n=o.skipArgProcessing?o.args:this.processArgs(e,{helperInfo:o},void 0,s,a),p.splice.apply(p,[0,0].concat(n)),a&&P.rmCx(a,u),c[o.name])if(i){let e=this._callee.component;this.__lyteWidget&&widgetMap.has(this.__lyteWidget)&&(e=widgetMap.get(this.__lyteWidget).getClone(this._callee.component)),c[o.name].apply(this._callee.component,p),l=!0}else{let i=a.parentNode,n=this.component;this.__lyteWidget&&widgetMap.has(this.__lyteWidget)&&(n=widgetMap.get(this.__lyteWidget).getClone(this.component));let u=c[o.name].apply(n,p);if(s.currentTarget instanceof DocumentFragment||s.currentTarget==document.body||d||(u=!1),l=!0,!1!==u&&!s.cancelBubble)if(o.from&&a.getAttribute(s.type)&&a._boundEvents&&a._boundEvents[s.type]){a._callee.component.constructor._actions;let e=a._boundEvents[s.type],r=t.deepCopyObject(e);P.skipArgProcessing(r,s,a),P.throwAction.call(a._callee,a._callee,s.type,r,void 0,void 0,a,s,l)}else{if(P.hasLyteEvents(a,r)){u=!P.handleLyteEvents(a,s)}if(!1===u)return;if(P.isCustomElement(a)&&(e=i),i){let e;for(;i&&i.getAttribute&&(!i.getAttribute(r)||i.hasAttribute("disabled"))&&"BODY"!=i.tagName&&(!P.hasLyteEvents(i,r)||(e=P.handleLyteEvents(i,s),!e));)i=i.parentNode;if(e||!i||"BODY"===i.tagName)return;if(i._callee||(i._callee=i.getCallee?i.getCallee(i):P.getCallee(i)),i&&s.type===r&&!s.cancelBubble)if(i._evBoundEvents&&i._evBoundEvents[r]){let e=i._evBoundEvents[r],o=t.deepCopyObject(e);P.skipArgProcessing(o,s,i),P.throwAction.call(i,i,r,o,void 0,void 0,i,s,l)}else if(i&&i._boundEvents&&i._boundEvents[r]){let e=i._boundEvents[r],o=t.deepCopyObject(e);P.skipArgProcessing(o,s,i),P.throwAction.call(i._callee,i._callee,r,o,void 0,void 0,i,s,l)}}}}else t.error("LC004",o.name)}else if(i&&c){var f=c[r]||c[P.String.toCamelCase(r)]||c[P.String.dasherize(r)];if(f){var h=P.isCustomElement(e)?e.component:e;let t=h;this.__lyteWidget&&widgetMap.has(this.__lyteWidget)&&(t=widgetMap.get(this.__lyteWidget).getClone(h)),l=!0,!1!==f.apply(t,p)&&P.throwAction.call(e,e._callee,r,o,i,n,void 0,void 0,l)}else P.throwAction.call(e,e._callee,r,o,i,n,void 0,void 0,l)}},isControlHelper:function(e){return"TEMPLATE"===e.tagName&&e.getAttribute("is")&&"component"!==e.getAttribute("is")||e.hasAttribute("lyte-for")||e.hasAttribute("lyte-if")||e.hasAttribute("lyte-switch")||e.hasAttribute("lyte-forin")},isCustomElement:function(e,t){return e.hasAttribute&&(("TEMPLATE"===e.tagName||e.attributes["lyte-for"]||e.attributes["lyte-if"]||e.attributes["lyte-switch"]||e.attributes["lyte-forin"])&&t||e.nodeName&&-1!==e.nodeName.indexOf("-")&&(e.localName.startsWith("lyte-")||e.localName.startsWith("crux-")||v.registeredComponents[e.localName]||"LYTE-YIELD"===e.tagName||e.hasAttribute("lyte-v4")||e.hasAttribute("lyte-widget")||e.hasAttribute("lyte-registry")||(e._attributes?e._attributes["lyte-registry"]:void 0)))},isCustomElementV3:function(e,t){return e.hasAttribute&&(("TEMPLATE"===e.tagName||e.attributes["lyte-for"]||e.attributes["lyte-if"]||e.attributes["lyte-switch"]||e.attributes["lyte-forin"])&&t||e.nodeName&&-1!==e.nodeName.indexOf("-")&&(v.registeredComponents[e.localName]||"LYTE-YIELD"===e.tagName))},componentSet:function(t,r,o,i,n){i||this.get(t)!==r?((e.isLyteWidget||e.__lyteEnablePromise)&&r instanceof Promise&&!r.__lyte&&(P.listenPromise(this.data,t,r),o||(o={}),o.skipTypeCast=!0,o.skipValidation=!0),P.set(this.data,t,r,o,void 0,n)):P.clearError(this.data,t)},componentGet:function(e){return e?P.get(this.data,e):this.data},nodeGet:function(e){return e?this.component.get(e):this.component.data},nodeSet:function(e,t,r,o){this.component.set(e,t,r,void 0,o)},registerComponentWrapper:function(){try{let e=P.registerComponent.apply(P,arguments);return t._postRegister(),e}catch(e){t._postRegister()}},registerComponent:function(o,i,n,a,s){var l;if(s){l=s,i.data=l.prototype.data,i.actions=l.actions?l.actions():{},i.methods=l.methods?l.methods():{},i._helpers=l.helpers?l.helpers():{};var d=l.observers?l.observers():{};for(var c in d)i[c]=d[c]}if(-1==P._reRegisteredComponents.indexOf(o)&&v.registeredComponents[o]&&(!a||a&&v.registeredWidgetComponents&&v.registeredWidgetComponents[a]&&v.registeredWidgetComponents[a][o]))return void t.warn("Component "+o+" already registered");let p,u;!a&&P._registeredComponents[o]||a&&v.registeredWidgetComponents&&v.registeredWidgetComponents[a]&&v.registeredWidgetComponents[a][o]?(p=P._registeredComponents[o],u=!0):(p=class extends R{},p._properties={},p.activeInstances=0,p.prototype.throwAction=this.throwAction,p.compName=o,P.directive.registeredProp[o]=[]),Object.defineProperty(p.prototype,"setData",{configurable:!0,writable:!0,value:function(e,t,r){return this.component.setData(e,t,r)}}),Object.defineProperty(p.prototype,"getData",{configurable:!0,writable:!0,value:function(e){return this.component.getData(e)}}),Object.defineProperty(p.prototype,"setMethods",{configurable:!0,writable:!0,value:function(e,t){return this.component.setMethods(e,t)}}),p.prototype.get=this.nodeGet,p.prototype.set=this.nodeSet,p._bindsIds=[];let f=(n=n||{}).alias,h=a?widgetScopeMap.get(a):void 0;h&&h.Lyte;var m={};let y={};for(var c in n)"services"==c&&(y[c]={},n.services.forEach((function(e){if("string"==typeof e)y[c][e]=e;else if(e&&"object"==typeof e){var t=e.as,o=e.service;if(r._keywords.is(t,"component"))r.warn("Service cannot be used in any keywords of Lyte.");else if(e.scope&&"static"!=e.scope){if("instance"==e.scope){t=e.as,o=e.service;m[c]=m[c]||{},m[c][t]=o}}else y[c][t]=o}}))),"mixins"==c&&(y[c]=[],n.mixins.forEach((function(e){t.Mixin.exists(e)?y[c].push(t.registeredMixins[e]):t.$.requiredMixins(e,o,"component")}))),"ssr"==c&&(p._ssr=n[c],n[c].config&&(p._config=n[c].config));if(!l){let e=N.baseCompClass;l=class extends e{}}let _=l.prototype.$functions={};_.validate=function(){var e=this._ins,t=e.data;for(var r in t)P.handleValidation(t,r,t[r],e)},_.getError=function(e){return P.getErrorStructure(this._ins,e)},_.addEventListener=function(t,r,o,i){-1!=t.indexOf("-")&&console.error("Event Name can't be hypenated");let n=this._ins.__wName,a=e.LyteWidgetClass._widgetInstances[n],s=n+"-"+a.eventCounter+++"-"+t;return o&&o.origin?"string"!=typeof o.origin&&o.origin.forEach((function(e,t){"_self"==e&&(o.origin[t]=n)})):o={origin:[n]},e.LyteWidgetClass.addEventListener(t,r,o,n||this._ins.__wName,s),s},_.removeEventListener=function(t){let r=this._ins.__wName;e.LyteWidgetClass.removeEventListener(t,r)},_.triggerEvent=function(t,r,o,i){let n=this._ins.__wName;o&&o.target?"string"!=typeof o.target&&o.target.forEach((function(e,t){"_self"==e&&(o.target[t]=n)})):o={target:[n]},e.LyteWidgetClass.triggerEvent(t,r,o,n||this._ins.__wName)},l.prototype._setWidget=function(){a&&Object.defineProperty(this,"__wName",{enumerable:!1,configurable:!1,writable:!1,value:a})},l._v3=!0,l._widget=a,p.component=l,l._helpers=i._helpers||{},delete i.helpers;let g=l.prototype;g.$lg=r.__gl,g.set=this.componentSet,g.get=this.componentGet,e.requireValidateInComponent&&(g.validate=function(){var e=this.data;for(var t in e)P.handleValidation(e,t,e[t],this)}),g.throwEvent=this.throwEvent,g.executeMethod=P.executeMethod,g.getData=P.componentGetData,g.setData=P.componentSetData,g.getMethods=P.componentGetMethods,g.setMethods=P.componentSetMethods,g.hasAction=P.componentHasAction,g.setActions=P.componentsetActions,p._mixins=n.mixins,p._serviceToBeUsed=m?m.services:void 0;var b={},A=r.toBeInjectedServices;if(A)for(var $ in A)r.$.injectServices.component($,A[$],void 0,r.__gS[$],p);for(var L in y)if("mixins"==L){var E={},w={};P.dataFromMixin(y.mixins,b,E,w),i=Object.assign(w,i),b=Object.assign(b,{})}else if("services"==L){var C=y[L];for(var O in C)r.registeredServices.hasOwnProperty(C[O])?i[O]=new r.registeredServices[C[O]]:r.$.requiredServices(O,C[O],(function(e,t){P._registeredComponents[o].component.prototype[t]=new e}))}p._actions=Object.assign({},b,i.actions),p._dynamicNodes=i._dynamicNodes,p._templateAttributes=i._templateAttributes,p._callBacks={},p._observers=[],l._callBacks={},l._observers=[],l._properties={},l.activeInstances=0,l._depthTemp=document.createElement("template"),l._mixins=n.mixins,l._actions=p._actions,l._template=i._template,l._dynamicNodes=i._dynamicNodes,l._templateAttributes=i._templateAttributes,delete i._template,delete i._dynamicNodes,delete i._templateAttributes;let T,S=i.data?i.data:void 0,k=Object.assign({},E,i.methods);p._observedAttributes=i._observedAttributes||[],p.dasherizeObservedAttributes(),p._observedMethodAttributes=i._observedMethodAttributes||{},l._observedAttributes=i._observedAttributes||[],l._observedMethodAttributes=i._observedMethodAttributes||{},p._deepWatchProperties=i._deepWatchProperties||{},delete i._observedAttributes,delete i._observedMethodAttributes,delete i.data,delete i.methods,i=P.updateCustomCrmComponent(i,p),p._data=S,p._methods=k,l._data=S,l._methods=k,p._registerComponent(o,p,a),v.registeredComponents[o]=!0,f&&(v.registeredComponents[f]=!0),t.isWidgetBuild&&(e._wrapperComponents.push(o.toUpperCase()),f&&e._wrapperComponents.push(f.toUpperCase())),P._registeredComponents[o]||("complete"===document.readyState||"interactive"===document.readyState||e.preLoadLyteComponents?(customElements.define(o,p,void 0,t.isWidgetBuild?{widget:!0}:{v3:!0}),f&&(T=class extends p{},customElements.define(f,T,void 0,t.isWidgetBuild?{widget:!0}:{v3:!0}))):(P.toBeRegistered.push({name:o,def:p,_lyteOptions:t.isWidgetBuild?{widget:!0}:{v3:!0}}),f&&(T=class extends p{},P.toBeRegistered.push({name:f,def:T,_lyteOptions:t.isWidgetBuild?{widget:!0}:{v3:!0}}))),P._registeredComponents[o]=p,f&&(P._registeredComponents[f]=T));let x=p.component._depthTemp;if(!P._ie&&x&&x.content.childNodes.length?(x.setAttribute("data-id","depthTemp_"+o),P.lyteComponentsDiv.appendChild(x)):delete p.component._depthTemp,a){var D=v.registeredWidgetComponents=v.registeredWidgetComponents||{};(D[a]=D[a]||{})[o]=p}let j=P.V3.pendingComp.find(o);if(j&&j.length&&P.V3.pendingComp.execute(I),u){var I=p._pendingComponents||[];I.forEach((function(e){delete e.__lyteIgnore,e.actualConstructor(),Array.from(e.attributes).forEach((function(t){-1!=e.constructor.observedAttributes.indexOf(t.name)&&e.attributeChangedCallback(t.name,null,t.value)})),e.connectedCallback()})),p._pendingComponents=[]}return p},registerHelper:function(e,t){v.registeredHelpers[e]=t},registerMixin:function(e,r){t.Mixin.register.call(t,e,r)},typeCast:function(e,t,r){if(null===e)return e;try{switch(t){case"string":return"object"==typeof e?JSON.stringify(e):e.toString();case"number":{if(""==e)return;let t=+e;if(isNaN(t))throw"TypeCast exception";return t}case"array":case"object":return JSON.parse(e);case"boolean":return!(!e&&""!==e||"false"===e);default:return e}}catch(t){return r&&(r.isError=!0),e}},sendtoclient:function(e,t,r){var o=t?e.component.data:e,i={},n=r;for(var a in o)if(t){var s=e.component.__data[a];if("bindIds"==a&&(i[a]={value:o[a]}),s&&/^(object|array)$/.test(s.type)&&e._attributeDetails&&e._attributeDetails.hasOwnProperty(N.String.dasherize(a)))i[a]={fP:!0};else if(o[a]instanceof Date)i[a]={value:o[a],type:"Date"};else if(n[a])i[a]={value:o[a],type:n[a].type};else{var l=typeof o[a];null==o[a]&&(l=void 0),i[a]={value:o[a],type:l}}}else"Date"==o[a].type?i[a]=new Date(o[a].value):o[a].fP||(i[a]=o[a].value);return i},getDataType:function(e){var t=typeof e;return"object"===t&&Array.isArray(e)?"array":t},handleValidation:function(e,r,o,i,n){let a=t.validate(e,r,o,i,n),s=N.getCmpData(i.data);return a?(P.set(s.errors,r,a),i.$node.callback&&i.$node.callback("onError",r,a)):P.clearError(e,r),a},clearError:function(e,r){e.errors&&e.errors[r]&&t.objectUtils(e.errors,"delete",r)},createLyteId:function(e){return e.__counter++,"__lyteId"+e.__counter},apdNode:function(e,t){P.tDiv.content.appendChild(e);let r=this.createLyteId(t);t.__h[r]=e,e.__lyteId=r},update:function(t,o,i,n,a,s,d,c,p,u){let f,h,m=t.__component__,y=!0,_=!1;if(!s){if(s=t[o],m&&"LYTE-YIELD"!==m.tagName){if(h=m.component.__data[o],(!n||(e.isLyteWidget||e.__lyteEnablePromise)&&"object"==typeof n&&1!=n.skipValidation)&&h&&(f=h.type)&&(y=!h.hideAttr,f===P.getDataType(i)||void 0===i&&"boolean"!==f||(i=P.typeCast(i,f))),!(i!==s||n&&n.force))return void P.clearError(t,o);if(!n||"object"==typeof n&&1!=n.skipValidation){if(P.handleValidation(t,o,i,m.component))return}}t.hasOwnProperty(o)||Array.isArray(t)?(e.isLyteWidget?DataBindingLayer.valueSet(t,o,i):r.isWidgetBuild&&t.__component__&&t.__component__.hasAttribute("comp-in-parent")&&DataBindingLayer.sendDataUpdateToFrame(t.__component__,{[o]:i}),t[o]=i):P.oF(t,"add",o,i,!0)}let v=!!m,g=P.String.dasherize(o),b=!1;var A,$,L;t._scp&&(r.cmpData(s,i)||(b=!0),s&&(Array.isArray(s)||"object"==typeof s)&&Array.from(t._scp.keys()).forEach((function(e){var t=r.nestScp[e],o=t.cyclic;r.removeNestScp(s,e),o&&r.bindObj(t._data,void 0,e,[],new Map,void 0,void 0,!0)})));if((r.isRecord(t)&&t.$.__scpObj||t.hasOwnProperty("__component__")&&t.__component__.__scpObj)&&(r.isRecord(t)?(A=t.$.__scpObj,$=t):(A=t.__component__.__scpObj,$=t.__component__),A.hasOwnProperty(o))){var E=A[o].split("_");r.removeNestScp(s,E[0],E[1],void 0,$,void 0,r.isRecord(i)||Array.isArray(i)&&i.model&&i.add?i:void 0),delete A[o]}if(h&&r.Transform[h.type]){var R=r.Transform[h.type];/^(object|array)$/.test(R.extends)&&(R.hasOwnProperty("properties")||R.hasOwnProperty("items"))&&(L=!0)}if((a&&r.isRecord(t)||t&&t.hasOwnProperty("_scp")&&t._scp.size||h&&/^(object|array)$/.test(h.type)&&1==h.watch||L)&&r.establishObjectBinding(t,o,a,!0,u,h&&h.watch?h.watch:void 0),m&&c&&("string"==typeof i&&m.getAttribute(g)!==i||m.hasAttribute(g))&&(!P.customPropRegex.exec(o)||m.hasAttribute(g))&&y)if(i&&"object"==typeof i){let e;try{e=JSON.stringify(i);let t=m.attributes.getNamedItem(g);t.__lyteIgnore=!0,m.setAttribute(g,e),t.__lyteIgnore=!1}catch(e){}}else{let e=P.typeCast(i,"string");if(m.getAttribute(g)!==e){let t=m.attributes.getNamedItem(g);t&&(t.__lyteIgnore=!0),e=e||"",m.setAttribute(g,e),t&&(t.__lyteIgnore=!1)}}if(i&&"string"!=typeof i&&"boolean"!=typeof i&&"number"!=typeof i){if(s&&"object"==typeof s&&s._bindings){i._bindings||defProp(i,"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0});let r=m?N.getCmpData(m.component.data):void 0;if(m&&r===t&&-1===o.indexOf(".")&&!e.isLyteWidget){let e=m.getProperty(o);if(this.removeSelectedBindingDeep(e,s),l(i,e),this.establishBindings(e,i),e._forHelpers){let t=e._forHelpers.toArrayLyte();for(var w=0;w<t.length;w++){let e=t[w];e._propBindingObject&&this.removeSelectedBindingDeep(e._propBindingObject,s)}}this.affectChanges(e,void 0,s,d,t[o],void 0,n)}else if(t._bindings){let e=t._bindings.toArrayLyte();for(let r=0;r<e.length;r++){let a=e[r][o];if(a){if(this.removeSelectedBindingDeep(a,s),l(i,a),this.establishBindings(a,i),a._forHelpers){let e=a._forHelpers.toArrayLyte();for(let t=0;t<e.length;t++){let r=e[t];r._propBindingObject&&this.removeSelectedBindingDeep(r._propBindingObject,s)}}this.affectChanges(a,void 0,s,d,t[o],void 0,n)}}}}else if(t._bindings){let e=t._bindings.toArrayLyte();for(let r=0;r<e.length;r++){let a=e[r];a[o]&&(l(i,a[o]),this.establishBindings(a[o],i),this.affectChanges(a[o],void 0,s,d,t[o],void 0,n))}}h=h||(m&&"LYTE-YIELD"!==m.tagName?m.component.__data[o]:void 0),(a&&r.isRecord(t)||t&&t.hasOwnProperty("_scp")&&t._scp.size||h&&/^(object|array)$/.test(h.type)&&(h.watch||h.hasOwnProperty("items")||h.hasOwnProperty("properties")))&&(_=!0)}else{if(s&&"object"==typeof s&&s._bindings&&t._bindings){let e=t._bindings.toArrayLyte();for(let t=0;t<e.length;t++){let r=e[t];if(r[o]&&(this.removeSelectedBindingDeep(r[o],s),r[o]._forHelpers)){let e=r[o]._forHelpers.toArrayLyte();for(let t=0;t<e.length;t++){let r=e[t];r._propBindingObject&&this.removeSelectedBindingDeep(r._propBindingObject,s)}}}}if(t._bindings){let e=t._bindings.toArrayLyte();for(let r=0;r<e.length;r++){let i=e[r];i[o]&&this.affectChanges(i[o],void 0,s,d,t[o],void 0,n)}}}b&&t._scp&&this.callDeepObservers(t,{type:"deepChange",oldValue:s,newValue:i},o);let C=P.String.dasherize(o);if(m&&m.__widgetP&&DataBindingLayer.sendLbindUpdate(m,C,i),v&&!p&&m._attributeDetails&&m._callee){let e,t=P.String.dasherize(o),r=m._attributeDetails[t];if(r&&r.isLbind&&(e=r.dynamicValue),e){let t;m._cx&&(t=[],P.changeContext(m._cx.node,t,m._cx));let r=N.getCmpData(m._callee.component.data),o=P.getNew(r,e);if(!o.context)return;let a=!1;if(o.context===r?m._callee._properties[o.lastKey]&&m._callee._properties[o.lastKey].__fromComponent&&(a=!0):a=!0,a){let e=+o.lastKey;if(Array.isArray(o.context)&&"number"==typeof e){let t=e<o.context.length;o.context[e]===i&&t||P.aF(o.context,t?"replaceAt":"insertAt",e,i)}else P.set(o.context,o.lastKey,i,n)}t&&P.removeContext(m._cx.node,t,m._cx)}}},getContentForIE:function(e,o,i,n){if("string"==typeof e){i=!0;var a=p("div");a.innerHTML=e,e=a.childNodes[0],o.splitTextNodes(e)}if(e.getAttribute&&e.getAttribute("depth")){r._ms&&n&&(n._content=a);var s=parseInt(e.getAttribute("depth"));e=t._ie?e:i?e.content:e.content.cloneNode(!0);for(var l=0;l<s;l++)e=e.childNodes[0]}return e},replaceWithPf:function(e,r){t._rwpf?(u(e.parentNode,r,e),e.remove()):e.replaceWith(r)},getCallee:function(e,t){for(;e&&!P.isCustomElementV3(e)&&"LYTE-YIELD"!==e.tagName;){if("BODY"===e.tagName){e=null;break}e=e.parentNode}return e&&"LYTE-YIELD"===e.tagName?e._registerYield?e._registerYield._callee:void 0:t===e?void 0:e},set:function(e,o,i,n,a,s){let l=-1;var d,c,p={};r.isRecord(e)&&a&&(d=e),"object"==typeof o&&o||(l=(o+="").lastIndexOf("."));let u=o;if(-1!==l){let t=o.substring(0,l);o=o.substring(l+1),e=P.get(e,t),c=!0}e&&e.__ltPrx__&&(e=e.__target__);let f=e[o]&&e[o].__target__?e[o].__target__:e[o],h=i&&i.__target__?i.__target__:i;if(!("string"!=typeof o||f!==h||n&&n.force))return void(e.__component__?P.clearError(e,o):t.isRecord(e)&&!e.$.isCloned&&(store.$.clrRecErr(e.$,o),e.$.emit&&e.$.emit("set",[e,o]),e.$.model&&e.$.model.emit&&e.$.model.emit("set",[e.$.model._name,e,o]),store.emit&&store.emit("set",[e.$.model._name,e,o])));if(e._setterScope)var m=e._setterScope;var y=[];if(e._scp&&e._scp.size&&(Array.from(e._scp.keys()).forEach((function(t){var o=e._scp.get(t);obj=o.paths;var i,n,a,s=r.nestScp[t],l={},d=Object.keys(obj);if(d.length>1?a="*":1==d.length&&(a=d[0]),l.path=a,l.id=t,d.length>1&&(l.paths=d),l.attr=undefined,l.data=s.data,l.PropsInfo=s.PropsInfo||void 0,s.model){var c=s.model;l.Error=s.Error;for(var p=Array.from(s.model.keys()),u=0;u<p.length;u++){var f=p[u],h=c.get(f);if(h)for(var m=Array.from(h.keys()),_=m.length,v=0;v<_;v++){var g=m[v],b=h.get(g),A=Array.from(b.keys()),$=A.length;for(k=0;k<$;k++){var L=A[k],E=Object.assign({},l),R=store.peekRecord(f,g);R&&((n=(i=R.$.model).fieldList[L])&&(n.properties||n.items||1==n.watch||r.Transform[n.type])&&(E.data=r.deepCopyObject(R[L]),E.rec=R,E.isRec=!0,E.attr=L,E.dtype=i.fieldList[L],E._cmpErr=R.$.error,E.key=L),y.push(E))}}}}else y.push(l)})),y.forEach((function(t){if(!n||"object"==typeof n&&1!=n.skipValidation){var s=t.id,l=t.path.split("."),d=t.dtype;t.isRec&&(a&&((l=u.split(".")).splice(-1),l.shift()),l=1==l.length&&l[0]==o?[]:l,p.Prop=d,r.checkNestedProp(s,l,d,t,e,o,i,p,a)),t.PropsInfo&&t.PropsInfo.forEach((function(n){n.path=t.path,n.attr=t.attr,d=n.dtype,p.Prop=d,r.checkNestedProp(s,l,d,n,e,o,i,p,a)}))}})),p.value&&p.value.code))return void t.error("ERR35",p.Prop.type);u=u===o?u:void 0;var _={};if("object"==typeof o)if(!t.isRecord(e)||a||e.$.isCloned)for(let t in o)P.set(e,t,o[t],i,a,s);else{for(let t in o){let r=o[t],i=e.$.model.fieldList[t];i=i?i.type:void 0,!i||void 0===r&&"boolean"!==i||i===P.getDataType(r)||(o[t]=P.typeCast(r,i))}let t=store.$.setData(e.$,o,void 0,n,void 0,void 0,_);if(t.$.isError)return t}else if(t.isRecord(e)&&(!a||a&&c)&&!e.$.isCloned){e[o];let t=e.$.model.fieldList[o];t=t?t.type:void 0,!t||void 0===i&&"boolean"!==t||t===P.getDataType(i)||(i=P.typeCast(i,t));let r=store.$.setData(e.$,o,i,n,void 0,void 0,_);if(r.$.isError)return r}else P.update(e,o,i,n,a,void 0,m,u,s,d);y&&y.length&&y.forEach((function(e){e.isRec&&store.$.deepValueChange(e.rec,e.attr,e.rec[e.attr],e)}))},adCx:function(e,t){let r="LYTE-YIELD"===e.tagName;!e._cx||r&&"LYTE-YIELD"===e._cx.node.tagName?r&&e._callee._cx&&P.changeContext(e._callee._cx.node,t,e._callee._cx,!0):P.changeContext(e._cx.node,t,e._cx,r)},rmCx:function(e,t,r){let o="LYTE-YIELD"===e.tagName;!e._cx||o&&"LYTE-YIELD"===e._cx.node.tagName?o&&e._callee._cx&&P.removeContext(e._callee._cx.node,t,e._callee._cx,!0,r):P.removeContext(e._cx.node,t,e._cx,o,r)},changeContext:function(e,t,r,o){if(!r)return;let i,n,a="LYTE-YIELD"===e.tagName;if(!e._cx||a&&"LYTE-YIELD"===e._cx.node.tagName?("LYTE-YIELD"===e.tagName||o)&&e._callee&&e._callee._cx&&P.changeContext(e._callee._cx.node,t,e._callee._cx):P.changeContext(e._cx.node,t,e._cx,"LYTE-YIELD"===e.tagName||o),a){let r=e._registerYield._callee;r&&r._cx&&P.changeContext(r._cx.node,t,r._cx)}if(r.type){if("for"===r.type){if(i=e.getAttribute("index"),n=e.getAttribute("item"),0===e._items.length)return}else if(i=e.getAttribute("key"),n=e.getAttribute("value"),0===Object.keys(e._items).length)return;let o=e._callee,a=N.getCmpData(o.component.data),s=a[n],l=a[i],d=o._properties[n],c=o._properties[i],p={};e._childProp&&e._childProp.length?e._childProp.forEach((function(t){p[t]={data:o.component.data[t],prop:o._properties[t]};let i=r.itemIndex;o.component.data[t]=r.node._propNodes[t][i],o._properties[t]=e._items[i].propProperty[t],r.__prop=!0})):e._currentProp&&e._currentProp.length&&e._currentProp.forEach((function(t){p[t]={data:o.component.data[t],prop:o._properties[t]};let i=r.itemIndex;o.component.data[t]=r.node._propNodes[t][i],o._properties[t]=e._items[i].propProperty[t],r.__prop=!0}));let u="for"===r.type?e._currentItems:e._currentObject;a[n]=u[r.itemIndex],a[i]=r.itemIndex,o._properties[n]=e._items[r.itemIndex].itemProperty,o._properties[i]=e._items[r.itemIndex].indexProperty;let f={initialItemValue:s,initialIndexValue:l,initialItemProp:d,initialIndexProp:c,initialPropDetails:p};t.push(f)}else{let o={},i=e._registerYield._callee,n=N.getCmpData(i.component.data);Object.keys(r.node._properties).forEach((function(e){o[e]={},o[e].value=n[e],o[e].property=i._properties[e],i._properties[e]=r.node._properties[e];let t=N.getCmpData(r.node.component.data);n[e]=t[e]})),t.push(o)}},removeContext:function(e,t,r,o,i){if(!r)return;let n,a,s="LYTE-YIELD"===e.tagName;if(i||(!e._cx||s&&"LYTE-YIELD"===e._cx.node.tagName?("LYTE-YIELD"===e.tagName||o)&&e._callee&&e._callee._cx&&P.removeContext(e._callee._cx.node,t,e._callee._cx):P.removeContext(e._cx.node,t,e._cx,"LYTE-YIELD"===e.tagName||o)),s){let r=e._registerYield._callee;r&&r._cx&&P.removeContext(r._cx.node,t,r._cx)}if(r.type){if("for"===r.type){if(n=e.getAttribute("index"),a=e.getAttribute("item"),0===e._items.length)return}else if(n=e.getAttribute("key"),a=e.getAttribute("value"),0===Object.keys(e._items).length)return;let o,i=e._callee,s=(e._attributes.items,N.getCmpData(i.component.data));o=r.__prop?t.pop():t.shift(),s[a]=o.initialItemValue;let l=o.initialPropDetails;if(l)for(let e in l){let t=l[e];s[e]=t.data,i._properties[e]=t.prop}s[a]=o.initialItemValue,s[n]=o.initialIndexValue,i._properties[a]=o.initialItemProp,i._properties[n]=o.initialIndexProp}else{let o=e._registerYield._callee,i=t.shift(),n=N.getCmpData(o.component.data);Object.keys(r.node._properties).forEach((function(e){n[e]=i[e].value,o._properties[e]=i[e].property}))}},sortCommands:function(e,t){var r={};e&&e.__target__&&(e=e.__target__);let o=e.slice();r.origianlArray=e;var i=[];for(let e=0;e<t.length;e++){let r=t[e];t[e]&&t[e].__target__&&(r=t[e].__target__);var n=o.indexOf(r);-1===n?(i.push({type:"Add",element:r,toIndex:e}),o.splice(e,0,r)):n!==e&&(i.push({type:"Move",element:r,fromIndex:n,toIndex:e}),o.splice(n,1),o.splice(e,0,r))}for(let e=o.length-1;e>=t.length;e--)i.push({type:"Remove",element:o[e]}),o.splice(e,1);return r.commands=i,r.changedArray=t,r},oF:function(){let e=arguments[0];e&&e.__target__&&(e=e.__target__);let r=arguments[1],o=arguments[2],i=arguments[3];i&&i.__target__&&(i=i.__target__);let n=arguments[4],a=arguments[5];if("add"===r&&!n)return void P.set(e,o,i,void 0,a);let s={};if(s.type=r,s.property=o,!/^(add|delete)$/.test(r))return void t.error("LC005",r);let l=e._bindings;if("delete"===r?P.set(e,o,void 0,void 0,a):e[o]=i,l){let e=l.toArrayLyte();for(let t=0;t<e.length;t++){let o=e[t]._forHelpers;if(o){let e=o.toArrayLyte();for(let t=0;t<e.length;t++){let o=e[t];if("forIn"!=o.getAttribute("is"))continue;o.getAttribute("key");let i=[];"add"===r&&P.adCx(o,i),o._callee.updateForInHelper(o,s),"add"===r&&P.rmCx(o,i)}}}}"delete"===r&&delete e[o]},aF:function(){let e=arguments[0];e&&e.__target__&&(e=e.__target__);let o,i=e.length,n=!0,a=arguments[1],l=arguments[3],d={};if(l&&l.__target__&&(l=l.__target__),/^(replaceAt|removeAt|shift)$/.test(a)&&!e.length)return void t.warn(a+" operation cannot be performed on empty array");if("sort"==a){var c=arguments[0],p=arguments[2],u=arguments[3]||[],f=c.slice();if(u.forEach((function(e){f.push(e)})),"function"==typeof arguments[2])f.sort(p);else{var h=arguments[2],m=h.sortBy,y=h.sortOrder;function _(e,t){return(e=m?e[m]:e)>(t=m?t[m]:t)?y?1:-1:e<t?y?-1:1:0}f.sort(_)}o=this.sortCommands(c,f).commands}let v,g=arguments[2],b=[];if(e._scp&&/^(replaceAt|splice|removeAt|remove|insertAt)$/.test(a)&&(e._scp.forEach((function(e,t){var o,i={},n=r.nestScp[t],a=e.paths,s=Object.keys(a);if(s.length>1?o="*":1==s.length&&(o=s[0]),i.path=o,i.id=t,s.length>1&&(i.paths=s),i.attr=undefined,i.data=n.data,i.reInit=r.isRecord(n.data)||Array.isArray(n.data)&&n.data.model&&n.data.add,i.PropsInfo=n.PropsInfo||void 0,i.index=g,n.model){var l=n.model;i.Error=n.Error;for(var d=Array.from(n.model.keys()),c=0;c<d.length;c++){var p=d[c],u=l.get(p);if(u)for(var f=Array.from(u.keys()),h=f.length,m=0;m<h;m++){var y=f[m],_=u.get(y),v=Array.from(_.keys()),A=v.length;for(k=0;k<A;k++){var $=v[k],L=Object.assign({},i),E=store.peekRecord(p,y);E&&(model=E.$.model,field=model.fieldList[$],field&&(field.properties||field.items||1==field.watch||r.Transform[field.type])&&(L.data=r.deepCopyObject(E[$]),L.rec=E,L.isRec=!0,L.attr=$,L.dtype=model.fieldList[$],L._cmpErr=E.$.error,L.key=$),b.push(L))}}}}else i.reInit=r.isRecord(n.data)||Array.isArray(n.data)&&n.data.model&&n.data.add,b.push(i)})),b.forEach((function(t){var o=t.id,i=""==t.path?[]:t.path.split("."),n=t.dtype||void 0;t.isRec&&(d.Prop=n,r.checkNestedProp(o,i,n,t,e,t.index,l,d)),t.PropsInfo&&t.PropsInfo.forEach((function(a){a.path=t.path,n=a.dtype,a.index=t.index,d.Prop=n,r.checkNestedProp(o,i,n,a,e,t.index,l,d)}))})),d.value&&d.value.code))t.error("ERR35",d.Prop.type);else switch(a){case"replaceAt":{let r=parseInt(arguments[2]);if(r>e.length)return t.warn("index provided for replaceAt is greater than array length"),[];let o=arguments[3];Array.isArray(o)||(o=[o]);let a=e.splice.apply(e,[r,1].concat(o)),l={firstIndex:r,secondIndex:o.length,type:"replace"};if(1==l.secondIndex&&(n=!1),e._bindings){let t=e._bindings.toArrayLyte();for(let o=0;o<t.length;o++){let i=t[o];if(i._forHelpers){let e=i._forHelpers.toArrayLyte();for(let t=0;t<e.length;t++){let o=e[t];if("for"!=o.getAttribute("is"))continue;let i=r+a.length,n=o.getAttribute("item");for(let e=r,t=0;e<i;e++,t++)P.removeSelectedBindingDeep({[n]:o._items[e].itemProperty},{[n]:a[t]});let s=[];P.adCx(o,s),o._callee.updateForHelper(o,l),P.rmCx(o,s)}}for(let t in i){let r=parseInt(t),o=1==l.secondIndex?r==l.firstIndex:r>=l.firstIndex;if(!isNaN(r)&&o){let o,n=r-l.firstIndex;if(o=n<1?a[n]:e[l.firstIndex-1+l.secondIndex+n],this.removeSelectedBindingDeep(i[t],o),i[t]._forHelpers){let e=i[t]._forHelpers.toArrayLyte();for(var A=0;A<e.length;A++){let t=e[A];t._propBindingObject&&this.removeSelectedBindingDeep(t._propBindingObject,o)}}if(e[r]&&"object"==typeof e[r]&&(s(e[r],"_bindings"),this.establishBindings({dummy:i[t]},{dummy:e[r]})),this.affectChanges(i[t],void 0,o,void 0,e[r]),1==l.secondIndex)break}}}}return v={type:"array",insertedItems:o,removedItems:a,index:r},P.bindWatchObj(b,e,o,a,r),P.callArrayObservers(e,v,n,i),a[0]}case"splice":{let r=parseInt(arguments[2]);if(r>e.length)return t.warn("index provided is greater than array length"),[];let o=arguments.length>3?arguments[3]:e.length-r,a=arguments.length>4?arguments[4]:[];Array.isArray(a)||(a=[a]);let l=e.splice.apply(e,[r,o].concat(a)),d={firstIndex:r,secondIndex:a.length,thirdIndex:o,type:"splice"};if(d.secondIndex==d.thirdIndex&&(n=!1),e._bindings){let t=e._bindings.toArrayLyte();for(let o=0;o<t.length;o++){let i=t[o];if(i._forHelpers){let e=i._forHelpers.toArrayLyte();for(let t=0;t<e.length;t++){let o=e[t];if("for"!=o.getAttribute("is"))continue;let i=r+l.length,n=o.getAttribute("item");for(let e=r,t=0;e<i;e++,t++)P.removeSelectedBindingDeep({[n]:o._items[e].itemProperty},{[n]:l[t]});let a=[];P.adCx(o,a),o._callee.updateForHelper(o,d),P.rmCx(o,a)}}for(let t in i){let r=parseInt(t);var $=d.secondIndex==d.thirdIndex?t>=d.firstIndex&&t<d.firstIndex+d.secondIndex:r>=d.firstIndex;if(!isNaN(r)&&$){let o,n=r-d.firstIndex;if(o=n<d.thirdIndex?l[n]:e[d.firstIndex-d.thirdIndex+d.secondIndex+n],this.removeSelectedBindingDeep(i[t],o),i[t]._forHelpers){let e=i[t]._forHelpers.toArrayLyte();for(A=0;A<e.length;A++){let t=e[A];t._propBindingObject&&this.removeSelectedBindingDeep(t._propBindingObject,o)}}e[r]&&"object"==typeof e[r]&&(s(e[r],"_bindings"),this.establishBindings({dummy:i[t]},{dummy:e[r]})),this.affectChanges(i[t],void 0,o,void 0,e[r])}}}}return v={type:"array",index:r,insertedItems:a,removedItems:l},P.bindWatchObj(b,e,a,l,r),P.callArrayObservers(e,v,n,i),l}case"push":{let t=arguments[2];Array.isArray(t)||(t=[t]),P.aF(e,"insertAt",e.length,t)}break;case"pop":return P.aF(e,"remove",e.length-1)[0];case"shift":case"shiftObject":return P.aF(e,"remove",0)[0];case"removeAt":case"remove":{let r=parseInt(arguments[2]);if(r>e.length)return t.warn("index provided for removeAt is greater than array length"),[];let o=arguments[3]?parseInt(arguments[3]):1,a={firstIndex:r,secondIndex:o,type:"remove"},l=e.splice(r,o);if(e._bindings){let t=e._bindings.toArrayLyte();for(let o=0;o<t.length;o++){let i=t[o];if(i._forHelpers){let e=i._forHelpers.toArrayLyte();for(let t=0;t<e.length;t++){let o=e[t];if("for"!=o.getAttribute("is"))continue;let i=r+l.length,n=o.getAttribute("item");for(let e=r,t=0;e<i;e++,t++)P.removeSelectedBindingDeep({[n]:o._items[e].itemProperty},{[n]:l[t]});let s=[];P.adCx(o,s),o._callee.updateForHelper(o,a),P.rmCx(o,s)}}for(let t in i){let r=parseInt(t);if(!isNaN(r)&&r>=a.firstIndex){let o,n=r-a.firstIndex;if(o=n<a.secondIndex?l[n]:e[a.firstIndex-a.secondIndex+n],this.removeSelectedBindingDeep(i[t],o),i[t]._forHelpers){let e=i[t]._forHelpers.toArrayLyte();for(A=0;A<e.length;A++){let t=e[A];t._propBindingObject&&this.removeSelectedBindingDeep(t._propBindingObject,o)}}e[r]&&"object"==typeof e[r]&&(s(e[r],"_bindings"),this.establishBindings({dummy:i[t]},{dummy:e[r]})),this.affectChanges(i[t],void 0,o,void 0,e[r])}}}}return v={type:"array",removedItems:l,index:r},P.bindWatchObj(b,e,void 0,l,r),P.callArrayObservers(e,v,n,i),l}case"removeObject":g=[g];case"removeObjects":Array.isArray(g)||(g=[g]),g==e&&(g=Array.from(g));for(var L=0;L<g.length;L++){var E=g[L];E&&E.__target__&&(E=E.__target__);let t=e.indexOf(E);-1!==t&&P.aF(e,"removeAt",t)}break;case"unshift":case"unshiftObject":case"unshiftObjects":{let t=arguments[2];Array.isArray(t)||(t=[t]),P.aF(e,"insertAt",0,t)}break;case"insertAt":{let t=parseInt(arguments[2]),r=arguments[3],o=r.length;Array.isArray(r)||(r=[r]);for(let o=t;o>e.length;o--)r.unshift(void 0),t--;let a={firstIndex:t,secondIndex:r.length,type:"insert"};if(e.splice.apply(e,[t,0].concat(r)),e._bindings){let t=e._bindings.toArrayLyte();for(let r=0;r<t.length;r++){let o=t[r];if(o._forHelpers){let e=o._forHelpers.toArrayLyte();for(let t=0;t<e.length;t++){let r=e[t];if("for"!=r.getAttribute("is"))continue;let o=[];P.adCx(r,o),r._callee.updateForHelper(r,a),P.rmCx(r,o)}}for(let t in o){let r=parseInt(t);if(!isNaN(r)&&r>=a.firstIndex){if(this.removeSelectedBindingDeep(o[t],e[r+a.secondIndex]),o[t]._forHelpers){let e=o[t]._forHelpers.toArrayLyte();for(A=0;A<e.length;A++){let t=e[A];t._propBindingObject&&this.removeSelectedBindingDeep(t._propBindingObject,oldObject)}}e[r]&&"object"==typeof e[r]&&(s(e[r],"_bindings"),this.establishBindings({dummy:o[t]},{dummy:e[r]})),this.affectChanges(o[t],void 0,e[r+a.secondIndex],void 0,e[r])}}}}let l=parseInt(arguments[2]);v={type:"array",insertedItems:Array.isArray(arguments[3])?arguments[0].slice(l,l+o):[arguments[3]],index:l},P.bindWatchObj(b,e,r,void 0,l),P.callArrayObservers(e,v,n,i)}break;case"concat":P.aF(e,"insertAt",e.length,arguments[2]);break;case"sort":{let t=[];if(o.forEach((function(r){switch(r.type){case"Remove":{let o=e.splice(r.toIndex,1);t.push({firstIndex:r.toIndex,secondIndex:1,type:"remove",removedItem:o[0]})}break;case"Move":{let o=e.splice(r.fromIndex,1);e.splice(r.toIndex,0,r.element),t.push({firstIndex:r.fromIndex,secondIndex:1,type:"remove",removedItem:o[0]}),t.push({firstIndex:r.toIndex,secondIndex:1,type:"insert"})}break;case"Add":e.splice(r.toIndex,0,r.element),t.push({firstIndex:r.toIndex,secondIndex:1,type:"insert"})}})),e._bindings){let r=e._bindings.toArrayLyte();for(let e=0;e<r.length;e++){let o=r[e];if(o._forHelpers){let e=o._forHelpers.toArrayLyte();for(let r=0;r<e.length;r++){let o=e[r];if("for"!=o.getAttribute("is"))continue;let i=[];P.adCx(o,i);for(let e=0;e<t.length;e++){let r=t[e],i=o.getAttribute("item");"remove"==r.type&&this.removeSelectedBindingDeep({[i]:o._items[r.firstIndex].itemProperty},{[i]:r.removedItem}),o._callee.updateForHelper(o,r)}P.rmCx(o,i)}}}}if(Array.isArray(arguments[3])&&arguments[3].length){v={type:"array",insertedItems:arguments[3]};var R=[];arguments[3].forEach((function(t){R.push(e.indexOf(t))})),v.indices=R,P.callArrayObservers(e,v,n,i)}}break;default:return void t.error("LC006",a)}},callDeepObservers:function(e,t,o,i){var n=this;Array.from(e._scp.keys()).forEach((function(a){var s,l=e._scp.get(a).paths,d=Object.keys(l);1==d.length?s=d[0]:d.length>1&&(s=d);var c,p=r.nestScp[a];if(p.model)for(var u=p.model,f=Array.from(p.model.keys()),h=0;h<f.length;h++){var m=f[h],y=u.get(m);if(y)for(var _=Array.from(y.keys()),v=_.length,g=0;g<v;g++){var b=_[g],A=y.get(b),$=Array.from(A.keys()),L=$.length;for(k=0;k<L;k++){var E=$[k],R=store.peekRecord(m,b);n.deepObsBind(R,!0,E,t,d,s,e,o,i)}}}else c=p.data,n.deepObsBind(c,!1,undefined,t,d,s,e,o,i)}))},deepObsBind:function(t,o,i,n,a,s,l,d,c){var p,u,f=n.type;if(t._bindings)for(var h=Object.assign({},n),m=t._bindings.toArrayLyte(),y=0;y<m.length;y++){u=s;var _=m[y],v=void 0;if(p=m[y]._path,o?_.hasOwnProperty(i)&&_[i].hasOwnProperty("*")&&(v=_[i]["*"],p=_[i]._path):_.hasOwnProperty("*")&&(v=_["*"]),v){var g=v._observers?v._observers.toArrayLyte():[];if(d)if(a.length>1){for(var b=a.length,A=[],$=0;$<b;$++)A.push(a[$]?a[$]+"."+d:d);u=A}else 1==a.length&&(u=s?s.concat("."+d):d);for(var L=0;L<g.length;L++){var E=g[L];h.path=u,h.type="deepChange",h.data=t;var R=v._path.split(".");R.pop(),h.item=R.join(".");var w=null!=h.index?(""!=u?u+".":u)+h.index:u;if(E.callee&&E.callee.component){var N=!0,P=E.callee.component.__data[h.item],C=P?P.watch:void 0;if(P&&"boolean"!=typeof C){var O=g[L].observer.Jpath[p];N=r.checkWatchPath(w,O)}N&&E.observer.value.call(E.callee.component,h)}else{var T=l._setterScope?l._setterScope:e;if(Array.isArray(T))for(var S=T.length,k=0;k<S;k++){var x=T[k];N=!0;if(h.data&&h.hasOwnProperty("item")){O=h.data.$.model._fldGrps.watch[h.item].watch;Array.isArray(O)&&(O=g[L].observer.Jpath[p],N=r.checkWatchPath(w,O))}N&&E.observer.value.call(x,h)}else{N=!0;if(h.data&&h.hasOwnProperty("item")){O=h.data.$.model._fldGrps.watch[h.item].watch;Array.isArray(O)&&(O=g[L].observer.Jpath[p],N=r.checkWatchPath(w,O))}N&&E.observer.value.call(T,h)}}}}!c&&"array"==f&&_.length&&this.affectChanges(_.length,void 0,initialArrLength,void 0,array.length,c)}},callArrayObservers:function(t,r,o,i){if(t._scp&&t._scp.size&&this.callDeepObservers(t,Object.assign({},r),void 0,!0),t._bindings){let d=t._bindings.toArrayLyte();for(let c=0;c<d.length;c++){let p=d[c],u=d[c]._path;if(p._observers){let o=p._observers.toArrayLyte();for(let i=0;i<o.length;i++){let d=o[i];if(d.isArrayObserver)if(r&&(r.item=u),d.callee&&d.callee.component)d.observer.value.call(d.callee.component,r);else{var n=t._setterScope?t._setterScope:e;if(Array.isArray(n))for(var a=n.length,s=0;s<a;s++){var l=n[s];d.observer.value.call(l,r)}else d.observer.value.call(n,r)}}}p.length&&this.affectChanges(p.length,void 0,i,void 0,t.length,o)}}},bindWatchObj:function(e,t,o,i,n){e&&e.length&&e.forEach((function(e){if(e.isRec&&store.$.deepValueChange(e.rec,e.attr,t,e),i&&i.forEach((function(t){r.removeNestScp(t,e.id,void 0,void 0,void 0,void 0,e.reInit?e.data:void 0)})),o&&o.forEach((function(t,o){if(t&&(Array.isArray(t)||"object"==typeof t)){var i=e.path.split(",");i.push(n+o),r.bindObj(t,void 0,e.id,i&&i.length?i:[],void 0,void 0,void 0,!0)}})),void 0!==n){var a=r.nestScp[e.id];if(a&&a.cyclic)r.removeNestScp(a._data,e.id),r.bindObj(a._data,void 0,e.id,[],void 0,void 0,void 0,!0);else{var s=o?o.length:0,l=n+s,d=t.slice(l);d.forEach((function(t){r.removeNestScp(t,e.id)})),d.forEach((function(t,o){if(t&&(Array.isArray(t)||"object"==typeof t)){var i=e.path.split(",");i.push(l+o),r.bindObj(t,void 0,e.id,i&&i.length?i:[],void 0,void 0,void 0,!0)}}))}}}))},establishUpdateBindings:function(e,t,r){let o=e.toArrayLyte();for(let e=0;e<o.length;e++){let i=o[e];i[t]&&(l(r,i[t]),this.establishBindings(i[t],r))}},establishSelectedBinding:function(e,t,r){if(!e)return;let o=e._path.split("."),i=r.getProperty(o[0]),n=t[o[0]];for(let e=0;e<o.length&&(n&&"object"==typeof n);e++)l(n,i),i=i[o[e+1]],n=n[o[e+1]]},establishBindings:function(e,t){if(e._helperNodes){let r=e._path,o=e._helperNodes.toArrayLyte();for(let e=0;e<o.length;e++){let i=o[e]._dynamicProperty?o[e]._dynamicProperty[r]:void 0;if(i)for(let e=0;e<i.length;e++){let r=i[e].ownerElement;if(r&&"TEMPLATE"===r.tagName&&"for"===r.getAttribute("is")&&r._items){r.getAttribute("item");for(let e=0;e<r._items.length;e++){let o=t[e],i=r.getAttribute("item");o&&"object"==typeof r._items[e]&&this.establishBindings(r._items[e].itemProperty,{[i]:o})}}}}}for(let r in e){let o=t[r];o&&"string"!=typeof o&&"number"!=typeof o&&"boolean"!=typeof o?(l(o,e[r]),"object"==typeof e[r]&&this.establishBindings(e[r],o)):l(t,e)}},removeSelectedBindingDeep:function(e,t,r){if(t||r){t&&t._bindings&&f(t,"_bindings",e);for(let o in e){let i;t&&(i=t[o]),i&&i._bindings&&f(i,"_bindings",e[o]),"object"==typeof e[o]&&this.removeSelectedBindingDeep(e[o],i,r)}if(r){let t=e._dynamicNodes,r=e._helperNodes;t&&t.length&&e._dynamicNodes.splice(0,t.length),r&&r.size&&r.clear()}if(e&&e._forHelpers){let o=e._forHelpers.toArrayLyte();for(let e=0;e<o.length;e++){let i=o[e];if("for"===i.getAttribute("is")){i.getAttribute("item");let e=i._attributes.items,t=i._items;for(let o=0;o<t.length;o++)this.removeSelectedBindingDeep(t[o].itemProperty,e[o],r)}else i._propBindingObject&&t&&t._bindings&&(f(t,"_bindings",i._propBindingObject),this.removeSelectedBindingDeep(i._propBindingObject,t,r))}}}},removeAllBindings:function(e,t){for(let r in e)t[r]&&t[r]._bindings&&f(t[r],"_bindings",e[r]),t[r]&&"string"!=typeof t[r]&&P.removeAllBindings(e[r],t[r])},affectChanges:function(t,r,o,i,n,a,s){if(t._dynamicNodes)for(let e=0;e<t._dynamicNodes.length;e++)t._dynamicNodes[e]._callee.updateNode(t._dynamicNodes[e],t._path,s);let l=t._path;if(t._helperNodes){let e=[],r=t._helperNodes.toArrayLyte();for(let o=0;o<r.length;o++)if(t._helperNodes.has(r[o]))if("for"===r[o].getAttribute("is")&&r[o]._items){let t=[];P.adCx(r[o],t);let i=r[o].getAttribute("index"),n=r[o].getAttribute("item"),a=r[o]._callee,d=N.getCmpData(a.component.data),c=d[n],p=d[i],u=a._properties[n],f=a._properties[i],h=r[o]._attributes.items;for(let t=0;t<r[o]._items.length;t++)if(d[n]=h[t],d[i]=t,a._properties[n]=r[o]._items[t].itemProperty,r[o]._items[t]._dynamicProperty[l]){e=r[o]._items[t]._dynamicProperty[l];for(let t=0;t<e.length;t++)e[t]._callee.updateNode(e[t],l,s)}d[n]=c,d[i]=p,a._properties[n]=u,a._properties[i]=f,P.rmCx(r[o],t)}else if("forIn"===r[o].getAttribute("is")&&r[o]._items){let t=[];P.adCx(r[o],t);let i=r[o].getAttribute("key"),n=r[o].getAttribute("value"),a=r[o]._callee,d=N.getCmpData(a.component.data),c=d[n],p=d[i],u=a._properties[n],f=a._properties[i],h=r[o]._attributes.object;for(let t in r[o]._items)if(d[n]=h[t],d[i]=t,a._properties[n]=r[o]._items[t].itemProperty,r[o]._items[t]._dynamicProperty[l]){e=r[o]._items[t]._dynamicProperty[l];for(let t=0;t<e.length;t++)e[t]._callee.updateNode(e[t],l,s)}d[n]=c,d[i]=p,a._properties[n]=u,a._properties[i]=f,P.rmCx(r[o],t)}else{e=r[o]._dynamicProperty[t._path]||[];let i=[];if(e.length){P.adCx(r[o],i);for(let r=0;r<e.length;r++)e[r]._callee.updateNode(e[r],t._path,s);P.rmCx(r[o],i)}}}if(t._observers){let r=t._observers.toArrayLyte();if(0!=a&&(null!=o||null!=n))for(let a=0;a<r.length;a++){let s=r[a],l={type:"change",oldValue:o,newValue:n,item:t._path};if(s.callee&&s.callee.component)s.observer.value.call(s.callee.component,l);else{var d=i||e;if(Array.isArray(d))for(var c=d.length,p=0;p<c;p++){var u=d[p];s.observer.value.call(u,l)}else s.observer.value.call(d,l)}}}if(Array.isArray(t))for(var f=0;f<t.length;f++)for(let e in t[f])this.affectChanges(t[f][e],!0,o?o[f]?o[f][e]:o[f]:o,i,n?n[f]?n[f][e]:n[f]:n);else for(let e in t){var h=o?o[e]:o,m=n?n[e]:n;"*"==e&&t[e].hasOwnProperty("_observers")&&(h=o,m=n),this.affectChanges(t[e],!0,h,i,m)}},skipArgProcessing:function(e,t,r){if(e.skipArgProcessing){let n=e.args=e.actArgs;n.shift();var o=n.indexOf("__lyteEvent__"),i=n.indexOf("__lyteNode__");-1!==o&&(n[o]=t),-1!==i&&(n[i]=r)}else e.args.shift()},getDV:function(e){for(var t,r,o=[],i=o,n=[],a="",s=[],l=[],d=[],c=0;c<e.length;c++)if("."!==e[c])if("["!==e[c]){if(('"'===e[c]||"'"===e[c])&&e[c++]===t){for(;"s"===e[c]&&"]"!=e[c];)c++;s.pop(),r=!0}"]"!==e[c]?a=a.concat(e[c]):(l.pop(),a.length&&(!0===r||isNaN(parseInt(a))?i.push(a):d.length&&(i=d.pop(),n.length&&Array.isArray(i[i.length-1])&&!i[i.length-1].length&&i.pop(),i.push(a),!l.length&&n.length&&n.shift())),!l.length&&n.length?(o.push(n.shift()),i=o):d.length&&!n.length&&(i=d.pop()),a="",r="")}else{for(l.push(c),a.length&&i.push(a);"s"===e[c+1];)c++;'"'===e[c+1]||"'"===e[c+1]?(s.push(e[c+1]),t=e[c+1],c++):n.length?(i.push([]),d.push(i),i=i[i.length-1]):(n.push([]),d.push(i),i=n[n.length-1]),a=""}else a.length&&i.push(a),a="";return a.length&&o.push(a),(s.length||l.length)&&console.log("check the syntax",s,l),o},ccDelay:[],callCC:function(){this.ccDelay.forEach((function(e){e.component&&e.actualConnectedCallback()})),this.ccDelay=[]},getDD:function(e,t){var r=e;return t.forEach((function(t,o){if(Array.isArray(t)){if(null==e)return;var i=P.getDD(r,t);if(null==i)return;e=e[i]}else{if(null==e)return;e=e[t]}})),e},processStatic:function(e){let t=e.innerHTML.split("__**"),r=[];for(var o=0;o<t.length;o++)t[o].startsWith("--Lyte")?r.push(parseInt(t[o].substring(6))):r.push(void 0);return t.cc=r,t},findLastNodeL:function(e,t,r){var o,i=0;switch(null!=t&&(i=t),r.getAttribute("is")){case"for":r._helpers[i]&&(o=r._helpers[i][0]),e||r._forContent[0]&&(e=r._forContent[0][0]);break;case"forIn":r._helpers[r._keysArray[0]]&&(o=r._helpers[r._keysArray[0]][0]),e||r._forContent[r._keysArray[0]]&&(e=r._forContent[r._keysArray[0]][0]);break;case"if":case"switch":o=r._helpers[i],e||(e=r._caseContent[0]);break;case"component":return e=e._renderedComponent[e._currentComponent]||e}return e||(e=r._placeHolder),o&&e==o._placeHolder&&(e=this.findLastNodeL(void 0,void 0,o)),e},processAction:function(e){Array.from(e.querySelectorAll("[lyteaction]")).forEach((function(e){let r=e.attributes.lyteaction.value;e._boundEvents=P.fRP[r],delete P.fRP[r];var o=e._boundEvents._cx;let i=e._boundEvents;delete i._cx;let n=i.componentName;for(var a in delete i.componentName,e._boundEvents)if(-1!==a.indexOf("-")){e._actions=e._actions||{},e._actions[a]=new CustomEvent(a),e._actions[a].processAction=e._boundEvents[a],e._boundEvents[a].actArgs.shift();let t=e._boundEvents[a].actArgs.indexOf("__lyteNode__");-1!==t&&(e._boundEvents[a].actArgs[t]=e),e._boundEvents[a].args=e._boundEvents[a].actArgs,delete e._boundEvents[a]}else{let r=t.deepCopyObject(e._boundEvents[a].args),o=r.splice(0,1)[0];o=o.startsWith("'")?o.replace(/'/g,""):o;let i=j(o,r);e.setAttribute(a.startsWith("on")?a.substr(2):a,n+" => "+i),e._boundEvents[a].globalEvent||e.addEventListener(a,L)}e._boundEvents._cx=o,e.removeAttribute("lyteaction")}))},getCtxVal:function(t,r,o){if(null!=t){if(e.isLyteWidget||e.__lyteEnablePromise){let e=t[r];t&&"object"==typeof t&&!Array.isArray(t)&&t.localName&&t.tagName&&P.isCustomElement(t)||e&&e.__lyteDirective?console.log("Dummy"):t&&t[r]instanceof Promise&&!t[r].__lyte&&P.listenPromise(t,r,t[r])}return t[r]}},listenPromise:function(e,t,o){o.then((function(i){o.__lyteUserResolved=!0,o.__lyte.status="resolved",r.Component.set(e,t,i)}),(function(){o.__lyteUserRejected=!0,o.__lyte.status="rejected",r.Component.set(e,t,e[t],{force:!0,skipTypeCast:!0,skipValidation:!0})})),defProp(o,"__lyte",{value:{status:"init"}})},get:function(e,t,r,o,i){if(r||(r=[]),o&&o.hasOwnProperty(t))return nodeValue=o[t]._data,o[t]._dyn&&o[t]._dyn.forEach((function(e){r.push(e)})),nodeValue;try{let n=t.match(/([^[\]]+|\[\])/g),a=e;r.push(n[0]);let s=n[0].split(".");for(let t=0;t<s.length;t++)e=P.getCtxVal(e,s[t],i);for(let t=1;t<n.length;t++){let o=n[t];if(o.startsWith(".")){let t=o.substring(1).split(".");for(let r=0;r<t.length;r++)e=P.getCtxVal(e,t[r],i);r[0]=r[0]+o}else if(o.startsWith("'")||o.startsWith('"')||!isNaN(o))isNaN(o)?(r[0]=r[0]+"."+o.substring(1,o.length-1),e=P.getCtxVal(e,o.substring(1,o.length-1),i)):(r[0]=r[0]+"."+o,e=P.getCtxVal(e,o,i));else{r.length;let t=P.get(a,o,r);r[0]=r[0]+"."+t,e=P.getCtxVal(e,t,i)}}return o&&(o[t]={},o[t]._data=e,o[t]._dyn=r),e}catch(e){return}},getNew:function(e,t){try{let i=t.match(/([^[\]]+|\[\])/g),n=e,a=i[0].split(".");if(i.length<2){if(a.length<2)return{context:n,lastKey:a[0]};for(var r=0;r<a.length-1;r++)e=e[a[r]];return{context:e,lastKey:a[r]}}for(let t=0;t<a.length;t++)e=e[a[t]];for(var o=1;o<i.length-1;o++){let t=i[o];if(t.startsWith(".")){let r=t.substring(1).split(".");for(let t=0;t<r.length;t++)e=e[r[t]]}else if(t.startsWith("'")||t.startsWith('"')||!isNaN(t))e=e[t.substring(1,t.length-1)];else{e=e[this.get(n,t)]}}let s=i[o];if(s.startsWith(".")){let t=s.substring(1).split("."),r=0;for(;r<t.length-1;r++)e=e[t[r]];s=t[r]}else s=s.startsWith("'")||s.startsWith('"')||!isNaN(s)?s.substring(1,s.length-1):this.get(n,s);return{context:e,lastKey:s}}catch(e){return}},componentGetData:function(e){return e?this.get(e):this.data},componentSetData:function(e,t,r){if("string"==typeof e)this.set(e,t,r);else if("object"==typeof e)for(let r in e)this.set(r,e[r],t)},componentGetMethods:function(e){let t=this.$node;if(t)return e&&t._methods?t._methods[e]:t._methods},componentHasAction:function(e){let t=this.$node;if(t)return!(!e||!t._actions[e])},componentsetActions:function(e,t){let r=this.$node._actions;if("string"==typeof e)r[e]=t;else if("object"==typeof e)for(let t in e)r[t]=e[t]},componentSetMethods:function(e,t){let r=this.$node;if(r)if("string"==typeof e)r._methods[e]=t;else if("object"==typeof e)for(let t in e)r._methods[t]=e[t]},render:function(e,r,i,n){var a;if(P.fromV3Render=!0,o&&t.isWidgetBuild&&(o.fromWidgetRender=!0),!e)return t.error("LC007"),P.fromV3Render=!1,void(o&&t.isWidgetBuild&&(o.fromWidgetRender=!1));if("string"==typeof e)a=p(e);else{if(!e.compName)return t.error("LC007"),P.fromV3Render=!1,void(o&&t.isWidgetBuild&&(o.fromWidgetRender=!1));a=p(e.compName)}if(r&&a.setData(r),n&&n.methods&&a.setMethods(n.methods),n&&n.attributes&&n.attributes.forEach((function(e){"object"==typeof e?a.setAttribute(e.name,e.value):a.setAttribute(e,"")})),i){let e;e="string"==typeof i?document.querySelector(i):i,e?(n&&n.dataType&&(a.component.__data=n.dataType),e.appendChild(a),a._callee=a.getCallee?a.getCallee(e):void 0):t.error("LC008",i)}return P.fromV3Render=!1,o&&t.isWidgetBuild&&(o.fromWidgetRender=!1),a},String:{cache_c:{},cache_d:{},upperCaseFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},lowerCaseFirstLetter:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},toCamelCase:function(e){return this.cache_c[e]||(this.cache_c[e]=w.call(e,/(-\w)/g,(function(e){return e[1].toUpperCase()}))),this.cache_c[e]},dasherize:function(e){return this.cache_d[e]||(this.cache_d[e]=w.call(e,/([a-z])([A-Z])/g,"$1-$2").toLowerCase()),this.cache_d[e]}},appendChild:function(e,t){v.setIgnoreDisconnect(!0),e.appendChild(t),v.setIgnoreDisconnect(!1)},replaceWith:function(){var e=Array.from(arguments),t=e.shift();v.setIgnoreDisconnect(!0);for(var r,o=t.parentNode,i=0;r=e[i];i++)o.insertBefore(r,t);t.remove(),v.setIgnoreDisconnect(!1)},insertBefore:function(e,r,o){if(v.setIgnoreDisconnect(!0),!o){if(!e)return t.error("LC010"),void v.setIgnoreDisconnect(!1);o=e.parentNode}u(o,r,e||null),v.setIgnoreDisconnect(!1)},insertAfter:function(){var e=Array.from(arguments),t=e.shift();v.setIgnoreDisconnect(!0),t.after.apply(t,e),v.setIgnoreDisconnect(!1)},executeMethod:function(){let e=this.$node;if(e){let o=Array.prototype.slice.call(arguments,1);var r=P.String.toCamelCase(arguments[0]);return e._methods[r]?e._methods[r].apply(this,o):void t.error("LC009",r,this.$node.tagName)}},getProperData:function(e){var r=e.dataType,o=e.attr,i=e.newValue,n=e.tagName;switch(r){case"boolean":i=!(!i||"false"===i);break;case"object":try{(i=JSON.parse(i))instanceof Object||t.warn("data type of the value provided for attribute "+o+" of "+n+" is not valid")}catch(e){return void t.warn("attribute "+o+" is not a valid JSON string.")}break;case"array":try{(i=JSON.parse(i))instanceof Array||t.warn("data type of the value provided for attribute "+o+" of "+n+" is not valid")}catch(e){return void t.warn("attribute "+o+" is not a valid JSON string.")}break;case"number":{let e=+i;if(i!==e+"")return void t.warn("data type of the value provided for attribute "+o+" of "+n+" is not valid");i=e}}return e.newValue=i,!0},cssEscape:function(e){return e?e.replace(/['"]/g,"\\$&"):e},shadow:{shadowList:[],toAddEvents:[],attachEvents:function(e){for(var t=N.globalDOMEvents,r=0;r<t.length;r++){var o=t[r];e.addEventListener(o,N.globalEventHandler,!0)}var i=this.toAddEvents,n=i.length;for(let t=0;t<n;t++)e.addEventListener(i[t].eventName,i[t].listener,i[t].options);e.addEventListener("change",N.changeEventHandler)},createLessDiv:function(e,t){var r=document.createElement("div");r.setAttribute("id","lessDiv"),e.appendChild(r),t._lessDiv=r,t._lessDiv._impNames=[]},insertInLessDiv:function(e,t){var r=this;e&&e._lessDiv._impNames&&e._lessDiv._impNames.forEach((function(e){t._impNames.$push(e);var o=document.createElement("style");o.setAttribute("placeHolder",r.importStyle[e].src),o.setAttribute("id",e),t.appendChild(o)}))},updateLessDiv:function(e,t){var r=this;e._impNames.forEach((function(o){t.forEach((function(t){if(r.importStyle[o]&&"resolved"==r.importStyle[o].status&&r.importStyle[o].response[t]){var i=document.createElement("style");i.setAttribute("lyte-id-imported","shadow-style-"+t),i.setAttribute("impSrc",o),i.innerHTML=r.importStyle[o].response[t];var n=e.querySelector("[id="+o+"]");N.insertBeforeNative(e,i,n)}}))}))},getHostElement:function(e){if(e){let t=e.host;if(t&&t.tagName)return t}},appendChild:function(e,t,o){let i;i=o&&o instanceof Object&&o.referenceNode?o.referenceNode:void 0;let n=!1;o&&o.native||(v.setIgnoreDisconnect(!0),n=!0);var a=i?i.getRootNode():t?t.getRootNode():void 0,s=t;let l=this.getHostElement(a);if(a&&l&&(s=this.looping(s)),r.isWidgetBuild&a&&l&&e&&l!=(e.lastElementChild?this.getHostElement(e.lastElementChild.getRootNode()):this.getHostElement(e.getRootNode()))){var d={type:"appendChild",shadowParent:l,outlet:e,element:t,nonShadowParent:s};this.addElements(d)}else e.appendChild(t);n&&v.setIgnoreDisconnect(!1)},looping:function(e){for(;e;){if(e.component&&"LYTE-YIELD"!=e.tagName)return e;e=e.parentNode}},addElements:function(e,t){var o=e.element,i=r.$.widgetWrapper;Array.isArray(o)?o.forEach((function(e,t){i.shadowRoot.appendChild(e)})):i.shadowRoot.append(o)},prependStyle(e,t){var r=e.querySelectorAll("[lyte-id^='shadow-']"),o=r[r.length-1];o?P.insertBeforeNative(e,t,o.nextSibling):P.insertBeforeNative(e,t,e.childNodes[0])}},V3:{pendingComp:{remove:function(t){let r,o=e.__lyteConfig._pendingV3Components;if(o[t.localName]){let e=o[t.localName].indexOf(t);-1!=e&&(o[t.localName].splice(e,1),r=!0)}return r},add:function(t){let r=e.__lyteConfig._pendingV3Components;r[t.localName]?-1==r[t.localName].indexOf(t)&&r[t.localName].push(t):r[t.localName]=[t]},find:function(t){return e.__lyteConfig._pendingV3Components[t]},execute:function(e){e.forEach((function(e){delete e.__v3lyteIgnore,e.decideConstructor(),Array.from(e.attributes).forEach((function(t){-1!=e.constructor.observedAttributes.indexOf(t.name)&&e._attributeChangedCallback(t.name,null,t.value)})),e._connectedCallback()})),e.splice(0,e.length)},firstRegister:function(t,r){let o=e.__lyteConfig._firstRegisteredComp;o[t]||(o[t]=r)}}},directive:{save:{triggerMap:{input:["value","checked","disabled"],select:["value","selectedIndex"],textarea:["value"],div:["id"],span:["id"]},addNode:function(e,t,o,i,n,a,s,l,d){let c=P.directive.getExactTransitionArg(t,o)||o.id;if(c){let r=e.getProperty(c);e.setData(c,i),o.__updateProp||(o.__updateProp={}),o.__updateProp[t.hookName]||(o.__updateProp[t.hookName]=[]),-1==o.__updateProp[t.hookName].indexOf(c)&&o.__updateProp[t.hookName].push(c),n&&(n._saveNode=c),t._saveNode=c,"prop"==t.hookName&&this.addData(i,t);let d=o._cx,p=!!d&&d.node;if(a&&p&&(o._helperNode=p,l)){let t=d.type,o=d.itemIndex;switch(t){case"forIn":case"for":r&&s._dirObj&&(s._dirObj.prop&&-1!=s._dirObj.prop.indexOf(c)&&(s._items[o].propProperty[c]=r,P.establishBindings({[c]:e.getProperty(c)},e.component.data),e._properties[c]=null),s._dirObj.data&&-1!=s._dirObj.data.indexOf(c)&&(s._items[o].propProperty[c]=r,P.establishBindings({[c]:e.getProperty(c)},e.component.data),e._properties[c]=null)),e.beforeUpdateFor(e,p,c,o),p._currentProp||(p._currentProp=[]),-1==p._currentProp.indexOf(c)&&p._currentProp.push(c),p._propNodes[c]||(p._propNodes[c]=[]),p._propNodes[c][o]=i}}}else r.error("No value provided for save directive")},addData:function(e,t){if(!e.$data){let o=this.triggerMap[e.localName];if(o)e.$data={},o.forEach((function(t){e.$data[t]=e[t]}));else if(r.Component.registeredComponents[e.localName]){let r=t.hookName,o=P.directive.getExactTransitionArg(t,e)||e.id;e.$data={__lyteDirective:{name:r,value:o,node:e}}}else{e.$data={};for(let t in e.attribute){let r=P.String.toCamelCase(t.nodeName);e.$data[r]||(e.$data[r]=t.nodeValue)}}}},updateNode:function(e,t,r){let o,i=t._saveNode;o="@data"==t.nodeName?t.ownerElement.$data:t.ownerElement,e.getData(i)==o&&e.setData(i,null),t._saveNode=r,e.setData(r,o),t.ownerElement._specialAttributeDetails.forEach((function(e){("prop"==e.hookName||"data"==e.hookName)&&(e._saveNode=r)}))},removeNode:function(e,t){t._specialAttributeDetails&&t._specialAttributeDetails.forEach((function(r){if("prop"==r.hookName||"data"==r.hookName){let o=P.directive.getActualTransitionArg(r,t);e.component.data[o]=null}}))},removeAllNode:function(e,t){t&&t.forEach((function(t){Array.isArray(t)?t.forEach((function(t){P.directive.save.removeNode(e,t)})):P.directive.save.removeNode(e,t)}))},getAttr:function(e){let t=!1;return e&&e.forEach((function(e){("prop"==e.hookName||"data"==e.hookName)&&(t=e)})),t},triggerListeners:function(e,t,r){let o=e._properties;t&&(t.stringValue?o[t.stringValue]&&o[t.stringValue].$data[r]&&P.affectChanges(o[t.stringValue].$data[r]):t.dynamicValue&&o[t._saveNode]&&o[t._saveNode].$data[r]&&P.affectChanges(o[t._saveNode].$data[r]))},triggerAllListeners:function(e,t,r,o){let i=r.localName,n=P.directive.save.triggerMap[i];if(n&&(n.forEach((function(e){P.directive.save.triggerData(e,r)})),o)){let t=r.hasAttribute("lyte-directive-prop")?r.getAttribute("lyte-directive-prop"):r.getAttribute("lyte-directive-data"),o=[];if(P.adCx(r,o),o.length){P.affectChanges(e.getProperty(t));for(let i=o.length-1;i>=0;i--)P.rmCx(r,[o[i]],!0),P.affectChanges(e.getProperty(t))}}},triggerData:function(e,t){r.Component.set(t.$data,e,t[e])}},registeredProp:{},compileNode:function(e,t,r,o,i,n){e._special=!0;let a={};if(a.name=e.attributes[i].name,t[a.name]&&t[a.name].dynamicValue)a.dynamicValue=t[a.name].dynamicValue;else if(t[a.name]&&t[a.name].helperInfo)a.helperInfo=t[a.name].helperInfo;else{a.stringValue=e.attributes[i].nodeValue;let t=e.attributes[i].nodeName;r.push(t),o.push({name:"lyte-directive-"+t.slice(1,t.length),value:a.stringValue}),-1==this.registeredProp[n].indexOf(a.stringValue)&&this.registeredProp[n].push(a.stringValue)}t[a.name]=a,a.hookNode=!0;let s=e.attributes[i].name.slice(1,e.attributes[i].name.length);return a.hookName=s,{add:!0,specialAttr:!0,attrToPush:a}},isDirectiveNode:function(e){return!!(e.hookNode||e.nodeName&&e.nodeName.startsWith("@")||e._isDirectiveNode)},getActualTransitionArg:function(e,t){if(e.hasOwnProperty("dynamicValue")||e.hasOwnProperty("helperInfo")){if(t.hasOwnProperty("_transitionArgs")&&t._transitionArgs.hasOwnProperty(e.hookName))return t._transitionArgs[e.hookName]}else if(e.hasOwnProperty("stringValue")&&e.hasOwnProperty("stringValue"))return""===e.stringValue||("true"===e.stringValue||"false"!==e.stringValue&&e.stringValue)},getExactTransitionArg:function(e,t){if(e.hasOwnProperty("dynamicValue")||e.hasOwnProperty("helperInfo")){if(t.hasOwnProperty("_transitionArgs")&&t._transitionArgs.hasOwnProperty(e.hookName))return t._transitionArgs[e.hookName]}else if(e.hasOwnProperty("stringValue")&&e.hasOwnProperty("stringValue"))return""===e.stringValue&&t.id&&(e.stringValue=t.id),e.stringValue},getTransitionArg:function(e,t,r){let o;e.component&&e.component.constructor._options&&this.setAttrFromRender(e);var i=this;return e._specialAttributeDetails&&e._specialAttributeDetails.forEach((function(n){t!=n.hookName||(o=r?n:i.getActualTransitionArg(n,e))})),o},setNodeArgs:function(e,t,r){let o=e.nodeName;e.ownerElement.removeAttribute(o),e.ownerElement._transitionArgs||(e.ownerElement._transitionArgs={});let i=o;o.startsWith("@")&&(i=o.slice(1,o.length)),e.ownerElement._transitionArgs[i]=t,e.ownerElement.setAttribute("lyte-directive-"+i,"prop"==i||"data"==i?t:"")},infoA:function(e,t,r,o,i,n,a){this.setSpecialNodes(e,o,r,t,a),r._specialAttributeDetails&&r._specialAttributeDetails.length?r._specialAttributeDetails.push(i):r._specialAttributeDetails=[i]},setSpecialNodes:function(e,t,r,o,i){t&&(t._hooksPresent||t._defaultSetSpecialNode||r.hasAttribute("lyte-directive-prop")||r.hasAttribute("lyte-directive-data"))?t._specialNodes&&("for"==t.getAttribute("is")||"forIn"==t.getAttribute("is")?t._specialNodes[i.itemIndex].push(r):(t&&/if|switch/g.test(t.getAttribute("is"))||t&&"LYTE-YIELD"==t.tagName)&&t._specialNodes.push(r)):r&&r._hooksPresent&&e._specialNodes?(e._specialNodes.push(r),e._hooksPresent=!0,e.hc=!0):r&&r._defaultSetSpecialNode&&e._specialNodes&&(e._specialNodes.push(r),e._defaultSetSpecialNode=!0)}}};t.Component.appendChild=function(){return N.shadow.appendChild.apply(N.shadow,Array.from(arguments))},N.appendChild=t.Component.appendChild,N.globalEventHandler=L,N.globalDOMEvents=a,N.changeEventHandler=$,e.isLyteWidget&&(e.Component=N.baseCompClass,e.Component.registerHelper=function(){return P.registerHelper.apply(P,arguments)}),t.typeCast=N.typeCast,t.getDataType=N.getDataType,t.Component._get=N.get,v.chromeBugFix=function(){var e=h.match(/Chrom(e|ium)\/([0-9]+)\./);(e=e?parseInt(e[2],10):0)>62&&(this.chI=[],document.addEventListener("focus",(function(e){var t=e.target;"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&"DIV"!==t.tagName||-1==r.Component.chI.indexOf(t)&&r.Component.chI.push(t)}),!0),this.chromeBugFix=function(){var e=r.Component.chI,t=e.length,o=["_callee","_attributeDetails","_attributes","_removedAttributes","_yields","_rA","_cx"],i=[],n=[];document.querySelectorAll("[lyte-keep-alive]").forEach((function(e,t){for(var r in e._renderedComponent)n.push.apply(n,Array.from(e._renderedComponent[r].querySelectorAll("input")))}));for(var a,s=t-1;a=e[s];s--)document.compareDocumentPosition(a)%2&&-1==n.indexOf(a)&&(e.splice(s,1),a.remove(),i.push(a),a._rA=a._rA||[],a._rA.forEach((function(e){e.ownerElement=void 0})),o.forEach((function(e){a[e]=void 0})),Array.from(a.attributes).forEach((function(e){a.removeAttribute(e.nodeName)})))},r.addEventListener("afterRouteTransition",(function(){r.Component.chromeBugFix()})),r.addEventListener("beforeRouteTransition",(function(){r.Component.viewPortSettings.resetLazy()})),r.Router||setInterval((function(){N.String.cache_c={},N.String.cache_d={}}),3e5))},N.__data=[],N.__dataNames=[],v.defineData=function(e){P.__data.push(e),Object.keys(e).forEach((function*(e){P.__dataNames.push(e)}))},t.__lc=N;let P=N;o.instanciateBridge();function C(e,t){for(var r=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=0;o<e.childNodes.length;o++)r.appendChild(e.childNodes[o].cloneNode(!0));var i=document.createElement("template");i.setAttribute("is",t);for(o=0;o<r.childNodes.length;o++)i.content.appendChild(r.childNodes[o]),o--;return i}function O(e,t){var r=document.createElement("template");return r.setAttribute("is",t),r.innerHTML=e.innerHTML,r}function T(e,t){t.splitTextNodes(e),t.component._depthTemp.content.appendChild(e)}function S(e,t,r,o){var i=!0;"TEMPLATE"==e.tagName&&(t._ht=e.innerHTML,i=!1),t._ht&&(i&&(e.innerHTML=t._ht,o.splitTextNodes(e)),r&&r.innerHTML!==t._ht&&(r.innerHTML=t._ht,o.splitTextNodes(r)))}function x(o,i,n,a,s){for(let v=0;v<i.length;v++){let g,b=i[v],A=b.type,$=b.position,L=D(o,$);switch(s&&(g=D(s,$)),A){case"text":{let e,t=r.Compile.getMustache(L.nodeValue);t&&(e=r.Compile.getHelper(t));let o=t;e?(b.helperInfo=e,g&&(b.newHelperInfo=r.Compile.getHelper(t,!0),P.replaceWithPf(g,document.createTextNode("__**--Lyte"+v+"__**")))):o&&(b.dynamicValue=o,b.newDynamicValue=P.getDV(o),g&&P.replaceWithPf(g,document.createTextNode("__**--Lyte"+v+"__**")))}break;case"insertYield":if(g){g.appendChild(document.createTextNode("__**--Lyte"+v+"__**"));let e=g.attributes["yield-name"];b.yieldName=e?e.nodeValue:void 0}break;case"componentDynamic":if(t.isWidgetBuild&&L.setAttribute("lyte-widget",""),g){t.isWidgetBuild&&g.setAttribute("lyte-widget",""),g.appendChild(document.createTextNode("__**--Lyte"+v+"__**")),b.componentName=g.localName;var l=Array.from(g.attributes);b.staticAttrs={};for(var d=0;d<l.length;d++)b.staticAttrs[P.String.toCamelCase(l[d].nodeName)]=l[d].nodeValue;delete b.staticAttrs._lyteprop}break;case"attr":{let e=!1,o=[],i=[],a=L,s=b.attr=b.attr||{};for(let l=0;l<a.attributes.length;l++){if(-1!==a.attributes[l].nodeValue.indexOf("{{")){let d,c=a.attributes[l].nodeValue,p=r.Compile.getMustache(c);if(p?d=r.Compile.getHelper(p):/{{.*}}/.test(c)&&!/\\{{.*}}/.test(c)&&(d=r.Compile.splitMixedText(c)),d&&("action"===d.name||"method"===d.name)&&/^(onfocus|onfocusin|onfocusout|onresize|onscroll|onclick|ondblclick|onmousedown|onmouseup|onmousemove|onmouseover|onmouseout|onchange|onselect|onsubmit|onkeydown|onkeypress|onkeyup|oncontextmenu|__focus|__focusin|__focusout|__resize|__scroll|__click|__dblclick|__mousedown|__mouseup|__mousemove|__mouseover|__mouseout|__change|__select|__submit|__keydown|__keypress|__keyup|__contextmenu)$/.test(a.attributes[l].name)){s[a.attributes[l].name.substr(2)]={name:a.attributes[l].name.substr(2),camelCase:P.String.toCamelCase(a.attributes[l].name.substr(2)),helperInfo:d,newHelperInfo:r.Compile.getHelper(p,!0),globalEvent:!0};let e=t.deepCopyObject(d.args),i=e.splice(0,1)[0];i=i.startsWith("'")?i.replace(/'/g,""):i;let c=j(i,e);a.setAttribute(a.attributes[l].name.substr(2),n+" => "+c),g&&g.setAttribute(a.attributes[l].name.substr(2),n+" => "+c),o.push(a.attributes[l].name)}else if(d||p){let t={};a.attributes[l].name.startsWith("lbind:")?(o.push(a.attributes[l].name),i.push({name:a.attributes[l].name.substring(6),value:a.attributes[l].nodeValue}),t.isLbind=!0,t.name=a.attributes[l].name.substring(6),t.camelCase=P.String.toCamelCase(t.name)):(t.name=a.attributes[l].name,t.camelCase=P.String.toCamelCase(t.name)),d?"lbind"===d.name?(t.dynamicValue=d.args[0],t.newDynamicValue=P.getDV(d.args[0]),t.isLbind=!0):(t.helperInfo=d,t.newHelperInfo=r.Compile.getHelper(p,!0)):(t.dynamicValue=p,t.newDynamicValue=P.getDV(p)),e=!0,s[t.name]=t}}if(a.attributes[l].name.startsWith("@")){let t=P.directive.compileNode(a,s,o,i,l,n);e=t.add,attrToPush=t.attrToPush}}if(o.length)for(let e=0;e<o.length;e++)a.removeAttribute(o[e]),g&&g.removeAttribute(o[e]);if(g){for(let e in s)g.removeAttribute(e);g.setAttribute("_lyteAttr","__**--Lyte"+v+"__**","")}if(i.length)for(let e=0;e<i.length;e++)a.setAttribute(i[e].name,i[e].value)}break;case"for":case"forIn":case"registerYield":S(L,b,g,a);case"component":{var c=t._ie?L:L.content;let r,o;g||"registerYield"!=A&&!L.hasAttribute("unbound")||(t._ms?(g=document.createElement("div"),g.innerHTML=b.actualTemplate?b.actualTemplate:L.outerHTML,g=g.childNodes[0],a.splitTextNodes(g)):g=L.cloneNode(!0));var p=g?t._ie?g:g.content:void 0;if(b.actualTemplate&&(c=P.getContentForIE(b.actualTemplate,a,void 0,t._ms?b:void 0),g&&(p=P.getContentForIE(b.actualTemplate,a))),(e.isLyteWidget||e.__lyteEnablePromise)&&L.hasAttribute("has-child")){var u=L.content||L;for(let e in b.cases){let t;S(_=P.getContentForIE(c.querySelector("[case='"+P.cssEscape(e)+"']"),void 0,!0),b.cases[e],t,a),x("TEMPLATE"===_.tagName?_.content:_,b.cases[e].dynamicNodes,n,a,t),b.cases[e]._ht&&(b.cases[e]._ht=_.cloneNode(!0),a._helperTemplate.content.append(b.cases[e]._ht),_.innerHTML="")}}else x(c,b.dynamicNodes,n,a,p);if(p){let e=b.actualTemplate?p:g;b._sta=P.processStatic(e)}t._ms&&(b.actualTemplate?(b.templateContent=c.outerHTML,b._content&&(b.actualTemplate=b._content.innerHTML,delete b._content)):b.templateContent=L.outerHTML,L.innerHTML=""),b.actualTemplate&&(r=A,t._ie||(r=b.svg?C(c,A):O(c,A),T(r,a)),o=i[v-1]&&i[v-1].position.toString()===i[v].position.toString()?i[v-1]:i[v],o._depthTemp=r),g&&(b._args={},"registerYield"===A?P.replaceWithPf(g,document.createTextNode("__**--Lyte"+v+"__**")):"component"===A?P.replaceWithPf(g,document.createTextNode((g.hasAttribute("_lyteattr")?g.getAttribute("_lyteattr"):"")+"__**--Lyte"+v+"__**")):P.replaceWithPf(g,document.createTextNode("__**--Lyte"+v+"__**")),Array.from(g.attributes).forEach((function(e){b._args[e.nodeName]=e.nodeValue}))),b._ht&&(b._ht=L.cloneNode(!0),a._helperTemplate.content.append(b._ht),L.innerHTML="")}break;case"if":case"switch":{S(L,b,g,a);let e;p=g?t._ie?g:g.content:void 0;if(b.actualTemplate&&(L=P.getContentForIE(b.actualTemplate,a,void 0),g)){let e=P.getContentForIE(b.actualTemplate,a);p=t._ie?e:e.content}var f="default";if(t._ms){var h,m={},y=t._ed?L.content.childNodes:L.childNodes;for(d=0;d<y.length;d++)"TEMPLATE"===y[d].tagName&&(y[d].getAttribute("case")?m[y[d].getAttribute("case")]=y[d]:y[d].hasAttribute("default")&&(h=y[d]));for(let e in b.cases){let t;_=P.getContentForIE(m[e],void 0,!0),p&&(t=P.getContentForIE(p.querySelector("[case='"+N.cssEscape(e)+"']"))),S(_,b.cases[e],t,a),x(_,b.cases[e].dynamicNodes,n,a,t?P.getContentForIE(t):void 0),m[e].remove(),p&&(b.cases[e]._sta=P.processStatic(t)),b.cases[e].templateContent=m[e].outerHTML}if(b[f].dynamicNodes){let e;_=P.getContentForIE(h,void 0,!0),p&&(e=p.querySelector("[default]")),S(_,b[f],e,a),x(_,b[f].dynamicNodes,n,a,e?P.getContentForIE(e):void 0),h.remove(),b[f].templateContent=h.outerHTML,p&&(b[f]._sta=P.processStatic(e))}}else{u=L.content||L;for(let e in b.cases){let t;p&&(t=P.getContentForIE(p.querySelector("[case='"+N.cssEscape(e)+"']"))),S(_=P.getContentForIE(u.querySelector("[case='"+P.cssEscape(e)+"']"),void 0,!0),b.cases[e],t,a),x("TEMPLATE"===_.tagName?_.content:_,b.cases[e].dynamicNodes,n,a,t),p&&(b.cases[e]._sta=P.processStatic(t)),b.cases[e]._ht&&(b.cases[e]._ht=_.cloneNode(!0),a._helperTemplate.content.append(b.cases[e]._ht),_.innerHTML="")}if(b[f].dynamicNodes){let e;var _;p&&(e=P.getContentForIE(p.querySelector("[default]"))),S(_=P.getContentForIE(u.querySelector("[default]"),void 0,!0),b[f],e,a),x("TEMPLATE"===_.tagName?_.content:_,b[f].dynamicNodes,n,a,e),p&&(b[f]._sta=P.processStatic(e)),b[f]._ht&&(b[f]._ht=_.cloneNode(!0),a._helperTemplate.content.append(b[f]._ht),_.innerHTML="")}}b.actualTemplate&&(e=A,t._ie||(e=b.svg?C(L.content,A):O(L,A),T(e,a)),i[v-1]&&i[v-1].position.toString()===i[v].position.toString()?i[v-1]._depthTemp=e:i[v]._depthTemp=e),g&&P.replaceWithPf(g,document.createTextNode("__**--Lyte"+v+"__**")),b._ht&&(b._ht=L.cloneNode(!0),a._helperTemplate.content.append(b._ht),L.innerHTML="")}}}}function D(e,r){let o=e;for(var i=0;i<r.length;i++)o="TEMPLATE"!=o.tagName||t._ie?o.childNodes[r[i]]:o.content.childNodes[r[i]];return o}function j(e,t){let r;for(let e=0;e<t.length;e++)t[e]&&"object"==typeof t[e]&&(t[e]=j(t[e].value.name,t[e].value.args));return r=e?e+"("+t.toString()+")":t.toString(),r}customElements.define("lyte-safari-test-component",y,void 0,t.isWidgetBuild?{widget:!0}:{v3:!0}),document.createElement("div").innerHTML="<lyte-safari-test-component t></lyte-safari-test-component>",v.render=P.render,v.insertBefore=P.insertBefore,v.insertAfter=P.insertAfter,v.replaceWith=P.replaceWith,v.appendChild=P.appendChild,P.tDiv=p("template"),P.tDiv.setAttribute("id","dummy-templates-div"),P.hDiv=p("template"),P.hDiv.setAttribute("id","keep-alive-div"),P.h1Div=p("template"),P.h1Div.setAttribute("id","lyte-helper-div"),r.Compile.componentsDiv=P.lyteComponentsDiv=p("div"),P.lyteComponentsDiv.setAttribute("id","lyte-components-div"),Set.prototype.toArrayLyte=function(){return"Set"===this.constructor.name?Array.from(this):Array.from(this._values)},"complete"===document.readyState||"interactive"===document.readyState?A():document.addEventListener("DOMContentLoaded",(function(e){A()}),!0),P.doCompile=x,P.registerHelper("unbound",(function(e){return e})),P.registerHelper("action",(function(e,t,r,o){r?(e._actions=e._actions?e._actions:{},e._actions[t]||(this.createCustomEvent(t,e,o),e.removeAttribute(t))):this.createEventListeners(e,t,o)})),P.registerHelper("lbind",(function(e){return this.getData(e)})),P.registerHelper("method",(function(e,r,o){e=arguments[0],r=arguments[1],o=arguments[2];var i=arguments[0].component,n=r?r.ownerElement:null,a=arguments[1].nodeName;r=null;var s=Array.prototype.slice.call(arguments,2),l=function(){let e=this.$node,r=[];P.adCx(e,r);let n=this.$node._callee.processArgs(this.$node._callee,{helperInfo:{args:s}},[],void 0,this.$node),a=n.splice(0,1)[0];P.rmCx(e,r);let l=Array.from(arguments),d=n.concat(l);if(i.$node._methods[a])return i.$node._methods[a].apply(i,d);t.error("LC009",o,i.$node.tagName)};if(!n)return l;n.set?n._methods[P.String.toCamelCase(a)]=l:n.setMethods(P.String.toCamelCase(a),l)})),P.registerHelper("stringifyHTML",(function(){return r.Component.registeredHelpers.unescape.apply(this,arguments).innerHTML})),P.registerHelper("unescapeAttr",(function(){return r.Component.registeredHelpers.unescape.apply(this,arguments).innerHTML})),P.registerHelper("unescape",(function(t,o,i){if(P.ffr)return t;if(e.isLyteWidget&&(r.Security.ignoreSanitizer=!0),r.Security.ignoreSanitizer){let e=document.createElement("div");return e.innerHTML=t,e}if(o&&Object.keys(o)&&Object.keys(o).length>0){if(Object(o.GLOBAL_TAGS).length>0)-1!=(s=o.GLOBAL_TAGS.indexOf("link-to"))&&o.GLOBAL_TAGS.splice(s,1);if(o&&o.GLOBAL_ATTRIBUTES&&Object.keys(o.GLOBAL_ATTRIBUTES).length>0)for(var n=["is","yield-name","lt-prop-route","lt-prop-dp","lt-prop-fragment","lt-prop-qp","lt-prop","lt-prop-class","lt-prop-id","lt-prop-rel","lt-prop-title","lt-prop-style","lt-prop-target","lt-prop-td","lt-prop-custom","lt-prop-target","lt-prop-id","lt-prop-class","lt-prop-style","lt-prop-rel","lt-prop-title"],a=0;a<n.length;a++){var s;-1!=(s=o.GLOBAL_ATTRIBUTES.indexOf(n[a]))&&o.GLOBAL_ATTRIBUTES.splice(s,1)}}if(o&&o.GLOBAL_TAGS){null==o.GLOBAL_ATTRIBUTES&&(o.GLOBAL_ATTRIBUTES=[]);for(var l=Array.from(o.GLOBAL_TAGS),d=[],c=0;c<l.length;c++){N._registeredComponents[l[c]]?d=N._registeredComponents[l[c]].observedAttributes:r.registeredCustomComponent[l[c]]&&(d=r.registeredCustomComponent[l[c]].observedAttributes?r.registeredCustomComponent[l[c]].observedAttributes:[]);for(a=0;a<d.length;a++)-1==o.GLOBAL_ATTRIBUTES.indexOf(d[a])&&o.GLOBAL_ATTRIBUTES.push(d[a])}}var p=document.createElement("div");if(i&&Object.keys(i).length)if(o&&Object.keys(o).length){r.Security.addGlobalObject(i,o);var u=i.sanitize(t);r.Security.removeGlobalObject(i,o)}else u=i.sanitize(t);else if(o&&Object.keys(o).length){r.Security.addGlobalObject(r.Security._ourSanitizerInstance_,o);u=r.Security._ourSanitizerInstance_.sanitize(t);r.Security.removeGlobalObject(r.Security._ourSanitizerInstance_,o)}else{u=e.isLyteWidget?t:r.Security._ourSanitizerInstance_.sanitize(t)}return p.innerHTML=u,p})),e.isLyteWidget||P.registerHelper("escape",(function(e,t){return"url"==t?ZWAF["7_0_0"].Encoder.encodeForHTMLAttribute(e):"js"==t?ZWAF["7_0_0"].Encoder.encodeForJavaScript(e):"css"==t?ZWAF["7_0_0"].Encoder.encodeForCSS(e):e})),P.registerHelper("debugger",(function(){})),P.registerHelper("log",(function(){console.log.apply(e,Array.from(arguments))})),P.registerHelper("ifEquals",(function(e,t){return e===t})),P.registerHelper("if",(function(e,t,r){return e?t:r})),P.registerHelper("negate",(function(e){return!e})),P.registerHelper("ifNotEquals",(function(e,t){return e!==t})),P.registerHelper("concat",(function(){for(var e="",t=arguments.length,r=0;r<t;r++)null!=arguments[r]&&(e+=arguments[r]);return e})),P.registerHelper("toString",(function(e){return null==e?"":"object"==typeof e?JSON.stringify(e):e})),defProp(HTMLElement.prototype,"setData",{writable:!0,configurable:!0,enumerable:!1,value:function(e,t){if(this._initProperties=this._initProperties||{},"string"==typeof e)this._initProperties[e]=t;else if("object"==typeof e)for(let t in e)this._initProperties[t]=e[t]}}),defProp(HTMLElement.prototype,"setMethods",{configurable:!0,writable:!0,enumerable:!1,value:function(e,t){if(this._initMethods=this._initMethods||{},"string"==typeof e)this._initMethods[e]=t;else if("object"==typeof e)for(let t in e)this._initMethods[t]=e[t]}}),e.isLyteWidget||P.registerHelper("encAttr",(function(e){return ZWAF["7_0_0"].Encoder.encodeForHTMLAttribute(encodeURIComponent(e))})),P.registerHelper("expHandlers",(function(e,t,r,o){var i=arguments.length;if("++"==t){if("postfix"==r)return e++;if("prefix"==r)return++e}else if("--"==t){if("postfix"==r)return e--;if("prefix"==r)return--e}else{if("=="==t)return e==r;if("==="==t)return e===r;if("!="==t)return e!=r;if("!=="==t)return e!==r;if("&&"==t)return e&&r;if("||"==t)return e||r;if("+"==t)return i>2?e+r:e;if("-"==t)return i>2?e-r:-e;if("*"==t)return e*r;if("/"==t)return e/r;if("%"==t)return e%r;if("<"==t)return e<r;if(">"==t)return e>r;if("<="==t)return e<=r;if(">="==t)return e>=r;if("|"==t)return e|r;if("&"==t)return e&r;if("!"==t)return!e;if("="==t)return e=r;if("+="==t)return e+r;if("-="==t)return e-r;if("*="==t)return e*r;if("/="==t)return e/r;if("?:"==t)return e?r:o}})),v.register("lyte-event-listener",{_template:'<template tag-name="lyte-event-listener"></template>',_dynamicNodes:[],_observedAttributes:["eventName"],init:function(){let e=this,r=t.addEventListener(this.get("eventName"),(function(){let t=Array.prototype.slice.call(arguments);t.splice(0,0,"on-fire"),e.throwEvent.apply(e,t)}));this.regId=r},data:function(){return{eventName:t.attr("string")}},didDestroy:function(){t.removeEventListener(this.regId)}}),v.registerCustomPropHandler("ltProp"),v.shouldIgnoreDisconnect=function(){return P.ignoreDisconnect||o.ignoreDisconnect},v.setIgnoreDisconnect=function(e){P.ignoreDisconnect=o.ignoreDisconnect=e},v.addLyteEventListener=function(e,t,r,o){return e._lyteEvents=e._lyteEvents||{},e._lyteEvents[t]=e._lyteEvents[t]||[],t+"-"+e._lyteEvents[t].push({func:r,fromEventListener:!0,context:o})},v.removeLyteEventListener=function(e,r){if(r){var o=r.split("-"),i=(o[0],parseInt(o[1]));e._lyteEvents&&e._lyteEvents[o[0]]&&!isNaN(i)?e._lyteEvents[o[0]][o[1]-1]={}:t.error("Invalid listenerId / listener is not available")}else t.error("No listenerId provided")},v.throwEvent=P.throwEvent,P.hasLyteEvents=function(e,t){return!(!e._lyteEvents||!e._lyteEvents[t])},P.handleLyteEvents=function(t,r){for(var o,i=t._lyteEvents[r.type],n=0;n<i.length;n++)if(i[n].func&&(!1===i[n].func.call(i[n].context?i[n].context:e,r)||r.cancelBubble)){o=!0;break}return o&&r.stopPropagation(),o},e.LyteComponent||Object.defineProperty(e,"LyteComponent",{get:function(){return t.warn("Usage of LyteComponent is deprecated. Use Lyte.Component instead"),N}}),v.chromeBugFix(),P.booleanAttrList=["async","autocomplete","autofocus","autoplay","border","challenge","checked1","compact","contenteditable","controls","default","defer","disabled","formNoValidate","frameborder","hidden","indeterminate","ismap","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","readonly","required","reversed","scoped","scrolling","seamless","selected","sortable","spellcheck","translate"],r.$.requiredMixins.component=function(e,t){var r=[],o={},i={},n={};r.push(e),t.forEach((e=>{var t=e,a=N._registeredComponents[t];r.length&&N.dataFromMixin(r,o,i,n),a._actions=Object.assign(a._actions,o),a.component._actions=Object.assign(a._actions,o);var s=Object.assign(a._methods,i);delete n.methods,N.updateCustomCrmComponent(n,a),a._methods=s,a.component._methods=s,N._registeredComponents[t]=a}))},r.$.injectServices.component=function(e,t,o,i,n,a){if(n){var s={};s[n.compName]=n}var l=n?s:P._registeredComponents;l&&Object.keys(l).forEach((function(o){var n=l[o];i&&r.__gS[e]?n.component.prototype[e]=i:r.$.requiredServices(e,t,(function(e,t){n.component.prototype[t]=e}),void 0,void 0,!0,a)}))},r.Security.addGlobalObject=function(e,t){for(var r in t)Array.isArray(t[r])&&t[r].forEach((function(t){-1==e["_"+r].indexOf(t)&&e["_"+r].push(t)}))},r.Security.removeGlobalObject=function(e,t){for(var r in t)Array.isArray(t[r])&&t[r].forEach((function(t){var o=e["_"+r].indexOf(t);-1!=o&&e["_"+r].splice(o,1)}))},r.Compile.getTrimmedContent=function(e,t,r){let o=e;if(r){t=[];let e=r.parentNode;for(;t.unshift(this.getArrayIndex(e.childNodes,r)),e=e.parentNode,r=r.parentNode,e;);}for(let r=0;r<t.length;r++){for(let o=e.childNodes.length-1;o>t[r];o--)e.childNodes[o].remove();e=e.childNodes[t[r]]}return o},r.Compile.getArrayIndex=function(e,t){for(let r=0;r<e.length;r++)if(e[r]===t)return r},r.Compile.splitMixedText=function(e){for(var t,r,o=[],i=0,n={name:"concat",args:[]},a=[],s=0;s<e.length;s++){var l=s;if(r&&"'"===e[s])"'"===t&&"\\"!==e[s-1]?(a.pop(),t=void 0):a.length||(t=e[s],a.push(t));else if(r&&'"'===e[s])'"'===t&&"\\"!==e[s-1]?(a.pop(),t=void 0):a.length||(t=e[s],a.push(t));else if((!r||a.length)&&r||"\\"===e[s-1]||"{"!==e[s]||"{"!==e[++s]){if((r&&!a.length||!r)&&"}"===e[s]&&"}"===e[++s]&&o.length){o.pop(i),r=!1;var d=e.substr(i,l-i),c=this.getHelper(d);c?(d=c,n.args.push({type:"helper",value:d})):n.args.push(d),i=s+1}}else o.push("{{"),n.args.push("'"+e.substr(i,l-i)+"'"),i=s+1,r=!0}return i<e.length&&n.args.push("'"+e.substr(i,e.length-i)+"'"),n},r.Compile.getHelper=function(e,t){let r=/\((?:[^)]*|(?:(?:"(?:[^"\\]|\\.)*?")|(?:'([^'\\]|\\.)*?')|[\w\s!@#$%^&*)([\]+=.,_-]*?)*?)\)$/.exec(e);if(r)return this.getHelperInfo(e,r,t)},r.Compile.getHelperInfo=function(e,t,r){let o={};if(o.name=e.substr(0,t.index).replace(/\s/g,""),t=t?t[0].trim():t,"lyteViewPort"==o.name&&"()"==t)return o.args=[],o;let i=this.getHelperArgs(t.substr(1,t.length-2),r);return!1!==i&&(o.args=i,o)},r.Compile.getHelperArgs=function(e,t){let r,o=[],i=[],n=0;for(let a=0;a<e.length;a++)if(o.length||","!==e.charAt(a))"("===e.charAt(a)?"'"!=o[o.length-1]&&'"'!=o[o.length-1]&&(o.push(e.charAt(a)),r=e.charAt(a)):")"===e.charAt(a)?"("===o[o.length-1]&&o.pop():"'"===e.charAt(a)&&"\\"!==e.charAt(a-1)?"'"===o[o.length-1]?o.pop():'"'!==o[o.length-1]&&(o.push(e.charAt(a)),r=e.charAt(a)):'"'===e.charAt(a)&&"\\"!==e.charAt(a-1)&&('"'===o[o.length-1]?o.pop():"'"!==o[o.length-1]&&(o.push(e.charAt(a)),r=e.charAt(a)));else{let r=e.substr(n,a-n);r=r.trim(),r&&r.startsWith('"')&&r.endsWith('"')&&(r=r.slice(1,-1),r="'"+r+"'"),r=this.getHelperArgValue(r,t),i.push(r),n=a+1}if(o.length)return!1;var a=e.substr(n,e.length-n);(a=a.trim())&&a.startsWith('"')&&a.endsWith('"')&&(a="'"+(a=a.slice(1,-1))+"'");try{a=this.getHelperArgValue(a,t)}catch(e){return!1}if(i.push(a),t){var s=[];i.forEach((function(e){"string"==typeof e&&"'"!==e[0]&&"event"!==e&&"this"!==e?s.push(P.getDV(e)):s.push(e)})),i=s}return i},r.Compile.getHelperArgValue=function(e,t){switch(e){case"undefined":case"":return;case"true":return!0;case"false":return!1;case"null":return null;default:return e&&e.startsWith("'")&&e.endsWith("'")?e=(e=e.replace(/\\\'/g,"'")).replace(/\\\"/g,'"'):/\([\w\s,')(]*/.test(e)?{type:"helper",value:this.getHelper(e,t)}:isNaN(e)?e:parseInt(e)}},r.Compile.getMustache=function(e){if(e=e&&"string"==typeof e?e.trim():e,/^{{(?=[\s]*[\w-_\(\$)]+)/.test(e)){let t=e.match(/{{[a-zA-Z0-9_.[\]()]*(?![\\])}}/g);if(t&&t.length>1)return;if(!this.syntaxCheck(e)||!/{{[^}]*?(?:(?:('|")[^\1]*?\1)[^}]*?)*}}$/.test(e))return;let r=e.match(/[\w!@#$%^&*)(+=.,_-]+[\s]*[(]{0,1}(?:"([^"]|\\")*?"|'([^']|\\')*?'|[\w\s!@#$%^&*)([\]+=.,_-]*?)*?[)]{0,1}[\s]*(?=}})/g);if(r&&r.length>1)return;return r=r?r[0].trim():r,r}},r.Compile.syntaxCheck=function(e){for(var t,r=[],o=0;o<e.length;o++)"'"===e[o]?"'"===t&&"\\"!==e[o-1]?(r.pop(),t=void 0):r.length||(t=e[o],r.push(t)):'"'===e[o]&&('"'===t&&"\\"!==e[o-1]?(r.pop(),t=void 0):r.length||(t=e[o],r.push(t)));return!r.length},N.replaceWithOrigTemplate=function(e){return e._origTemplate._fakeTemp=e,e._origTemplate},N.pendingViewPortElements=[],N.isInViewPort=function(t,r){if(r)return!0;var o=t.getBoundingClientRect();return(0!=o.width||0!=o.height||0!=o.top||0!=o.bottom||"dummy-port-element"==t.localName)&&((o.top>=0&&o.top<=(e.innerHeight||document.documentElement.clientHeight)||o.bottom>=0&&o.bottom<=(e.innerHeight||document.documentElement.clientHeight))&&(o.left>=0&&o.left<=(e.innerWidth||document.documentElement.clientWidth)||o.right>=0&&o.right<=(e.innerWidth||document.documentElement.clientWidth)))},P._doneRaf={},r.Component.registerHelper("lyteViewPort",(function(t,o){let i=this.localName,n=P.getActViewPortTemplate(t);if(n._viewPortRendered)return!1;let a,s=o,l=P.pendingViewPortElements;if(n._disable={},o&&"object"==typeof o&&(n._lazy=t._lazy=o.lazy,n._custom=!0,s=o.disableViewPort,o.viewIn||o.viewOut)){let e,i;a=!0,n._viewIn=o.viewIn?Object.assign(o.viewIn):void 0,n._viewOut=o.viewOut?Object.assign(o.viewOut):void 0,n._renderPromise=new Promise((function(t,r){e=t,i=r})),n._promiseObject={resolvedByLyte:!1,spouse:n._viewIn,resolve:function(){!n._viewOut._afterAppendCalled&&n._viewOut.beforeRemove&&n._renderPromise&&!n._viewOut._beforeRemoveCalled&&(n._viewOut.beforeRemove.apply(n._viewOut,[t._promiseObject]),n._viewOut._beforeRemoveCalled=!0),n._renderPromise&&e()},reject:function(){n._renderPromise._reject=!0,i()}},n._renderPromise.then((function(){if(!n._callee.component)return;let e=P.waitingForResolve.indexOf(t._renderPromise);-1!=e&&P.waitingForResolve.splice(e,1),n._renderPromise._resolved=!0;let r=l.indexOf(n);-1!=r&&l.splice(r,1);let o=n._viewIn;o&&o.beforeAppend&&o.beforeAppend.apply(o),P._executeIfTemplates(n),o&&o.afterAppend&&o.afterAppend.apply(o),n._renderPromise=null}),(function(){r.error("Promise rejected - Viewport cannot be toggled.")}))}if(!s)return P._doneRaf[i]||(requestAnimationFrame((function(){setTimeout((function(){let t=[];var r=Array.from(l);let o=[];for(var n=r.length-1;n>=0;n--){let e=r[n];let t=(a=P.getActViewPortTemplate(e))._viewOut;t&&t.afterAppend&&(t.afterAppend.apply(t,[a._promiseObject]),t._afterAppendCalled=!0)}for(n=r.length-1;n>=0;n--){let e=r[n];var a=P.getActViewPortTemplate(e);if(P.isViewPortTemplate(e)&&!e._callee._destroyed){let r={};if(P._isInViewPort(a,a._callee,o,void 0,r)){let o=l.splice(n,1)[0];e._inPve=!1,e._viewPortRendered=!0,!r.beforeRemoveHook&&t.push(o)}a._inPve=e._inPve,a._viewPortRendered=e._viewPortRendered}}for(let e=0;e<o.length;e++)o[e].viewOutIns.beforeRemove.apply(o[e].viewOutIns,o[e].arg),P.waitingForResolve.push(o[e].node._renderPromise);for(let e=0;e<t.length;e++)P._executeIfTemplates(t[e]);P._doneRaf[i]=!1,t.length&&requestAnimationFrame((function(){setTimeout((function(){P.executePendingViewPort()}),1)})),!e.isLyteWidget&&P.resolveLazy()}),1)})),P._doneRaf[i]=!0),-1==l.indexOf(P.getFakeTemplate(t))&&(t._inPve=!0,l.push(t)),!0;if(l.length){let e=P.getFakeTemplate(t),r=l.indexOf(e);-1!=r&&(l[r]._inpve=t._inPve=!1,l[r]._viewPortRendered=t._viewPortRendered=!0,l.splice(r,1))}})),N.waitingForResolve=[],N._isInViewPort=function(e,t,r,o,i){var n=e._caseContent[0];if(n&&P.isInViewPort(n,o)){if(e._isInView=!0,!e._custom)return!0;{let t=e._viewOut;if(t&&!e._renderPromise._resolved&&t.beforeRemove&&!t._beforeRemoveCalled){if(e._promiseObject.resolvedByLyte=!0,t._beforeRemoveCalled=!0,r.push({viewOutIns:t,arg:[e._promiseObject],node:e}),i)return i.beforeRemoveHook=!0,!0}else if(!e._renderPromise._reject)return i&&(i.beforeRemoveHook=!0),!0}}},N.__preLazyRender=!1,N.resolveLazy=function(){N.pendingViewPortElements&&requestAnimationFrame((function(){setTimeout((function(){let e=!1;for(let t in P._doneRaf)P._doneRaf[t]&&(e=!0);P.waitingForResolve.length?Promise.all(P.waitingForResolve).then((function(){N.resolveLazy()}),(function(){r.error("Promise rejected - Viewport cannot be toggled.")})):e?N.resolveLazy():(!P.__preLazyRender&&r.triggerEvent("preLazyRender"),P.__preLazyRender=!0,P.executePendingViewPort({lazy:!0}))}),1)}))},N._executeIfTemplates=function(e){let t=P.getActViewPortTemplate(e);var r,o;if(t._attributes.value=!1,t._cx||2===t.nodeType&&t.ownerElement._cx){o=t._cx||t.ownerElement._cx;var i=[];P.changeContext(o.node,i,o)}else if("LYTE-YIELD"===t.tagName&&t._callee._cx){r=!0,o=t._callee._cx;i=[];P.changeContext(o.node,i,o,!0)}t._callee.updateSwitchHelper("if",t,t._cx,!0,!0),o&&P.removeContext(o.node,i,o,r)},N.isViewPortTemplate=function(e){if(("TEMPLATE"==e.tagName||e._origTemplate)&&"if"==e.getAttribute("is"))return!0},N.getActViewPortTemplate=function(e){return e._origTemplate?e._origTemplate:e},N.getFakeTemplate=function(e){return e._fakeTemp?e._fakeTemp:e},N.executePendingViewPort=function(e){var r=P.pendingViewPortElements;if(!r.length)return;var o=Array.from(r),i=[];let n=[],a=!(!e||!e.lazy)||void 0,s=t.Component.viewPortSettings,l=s.lazy.count,d="elements"==s.lazy.toggleBy,c="screen"==s.lazy.toggleBy;if(e&&e.lazy&&e.lazy.toggleBy&&(l=e.lazy.count,d="elements"==e.lazy.toggleBy,c="screen"==e.lazy.toggleBy,d?P._toggleElementsCount=l:"screen"==c&&(P._toggleScreenCount=l)),e&&e.force)i=o;else{for(var p=o.length-1;p>=0;p--){let e=o[p];if(P.isViewPortTemplate(e)){let t=P.getActViewPortTemplate(e);if(a=!(!t._lazy||!a)&&a,a&&d){if(0==l){requestAnimationFrame((function(){setTimeout((function(){P.executePendingViewPort({lazy:!0})}))}));break}l--}P._isInViewPort(t,t._callee,n,a)&&(i.push(r.splice(p,1)[0]),e._inPve=!1,e._viewPortRendered=!0),t._inPve=e._inPve,t._viewPortRendered=e._viewPortRendered}else(P.isInViewPort(e._dummyViewPortF)||P.isInViewPort(e._dummyViewPortL))&&(e._dummyViewPortF=e._dummyViewPortL=void 0,i.push(r.splice(p,1)[0]))}for(let e=0;e<n.length;e++)n[e].viewOutIns.beforeRemove.apply(n[e].viewOutIns,n[e].arg)}P.isViewPortPending=!1;for(var u=0;u<i.length;u++){let e=i[u];if(P.isViewPortTemplate(e))P._executeIfTemplates(e);else{e.setData("lyteViewPort",!1);var f=r.indexOf(e);-1!=f&&r.splice(f,1)}}i.length&&requestAnimationFrame((function(){requestAnimationFrame((function(){P.executePendingViewPort()}))}))},e.addEventListener("resize",(function(){requestAnimationFrame((function(){requestAnimationFrame((function(){P.executePendingViewPort()}))}))})),document.addEventListener("scroll",(function(){var e=v.viewPortSettings.debounce;e?(P.viewPortScrollDebounce&&clearTimeout(P.viewPortScrollDebounce),P.viewPortScrollDebounce=setTimeout((function(){requestAnimationFrame((function(){requestAnimationFrame((function(){P.executePendingViewPort()}))})),P.viewPortScrollDebound=void 0}),e)):requestAnimationFrame((function(){requestAnimationFrame((function(){P.executePendingViewPort()}))}))}),!0),N.core={},N.core._constructor=R,N.core._registerComponent=R._registerComponent,N.core.registerComponent=P.registerComponent,N.core.executeBlockHelpers=R.prototype.executeBlockHelpers,N.core.updateForHelper=R.prototype.updateForHelper,N.core.updateForInHelper=R.prototype.updateForInHelper,N.core.updateSwitchHelper=R.prototype.updateSwitchHelper,v.viewPortSettings={debounce:0,lazy:{toggleBy:"elements",count:100},executePendingViewPortElements:function(e){N.executePendingViewPort(e)},resetLazy:function(){N.__preLazyRender=!1}},N.insertBeforeNative=function(e,t,r){e.insertBefore(t,r)}}(window),Lyte.registerErrorCodes({LD01:"Primary key value might be missing in the response data that is received, {0}",LD02:"{0} - {1} is not registered",LD03:"Cannot set the error {0} for {1}",LD04:"No such record to merge, {0}",LD05:"Model( {0} ) of related property - {1} not found in model - {2}",LD06:"Backward relation not present in model( {0} ), for the property {1} of model( {2} )",LD07:"{0} type not handled in handleArrayOperations",LD08:"{0} {1} will be deprecated from next version {2}",LD09:"deserializeKey cannot be processed for payload with more than two keys. Please use payloadKey callback instead or try modifying the same in normalizeResponse callback",LD10:"Response data not in a format lyte data store expects",LD11:"Deprecation Warning! findRecord response payload will not accept an array. It will be deprecated from the next version",LD12:"Response ( {0} ) is not in a format, lyte data store expects",LD13:"Response processing failed in {0} for model-{1} {2}, since invalid data is received in {1}(modelName) key of the data",LD14:"Cannot register {0} - {1}, as it already exists.",LD15:"Primary key value might be missing in the response data that is received, {0}",LD16:"Record merge failed for the record in model - {0} with primaryKey value - {1}, since either the persisted(saved) primary key value for a newly created record is not received from server or not in the proper structure to merge",LD17:"Record with the primary key value already exists",LD18:"No { 0 } present",LD19:"Deprecation Warning! findAll will not accept response payload values other than an array or any empty value. Current implementation which allows this will be deprecated from the next version",LD20:"Record cannot be saved as a state, when it is not either a new or a modified record or in a error state.",LD21:"No such state ( {0} ) saved for the record.",LD22:"For create / createRecord, response with a primary key value should be received",LD23:"PrimaryKey field {1} in {0} cannot have default value",LD24:"Response couldn't be parsed, {0}",LD25:"Cannot create record for the data - {0}",LD26:"Only one baseKey is allowed for a model",LD27:"Record merge failed, since the data passed is invalid - {0}",LD28:"Record merge failed for the model - {0}, since a valid primary key value is not found in the data to be merged - {1}",LD29:"Unloaded record-{0} of the model-{1} is being saved",LD30:"Variable value in query is mandatory for {0}",LD31:"Datatype defined for {0} is mismatch with the value's datatype",LD32:"Query '{0}' was not registered for the model '{1}"});var $Record=function(){Object.assign(this,{inIDB:!1,isPersisted:!0,isUnloaded:!1,isModified:!1,isNew:!1,isDeleted:!1,isError:!1,events:[],validatedOnCreate:!0,error:{}})},Record=function(e,t,r,o){var i=store.modelFor(e),n=r?r.delayPersistence:store.$.getFromCB("adapter",e,"delayPersistence");Object.assign(this,t),Object.defineProperties(this,{$:{writable:!0,value:new $Record}});var a=store.$.getpKVal(this,i);o&&Object.defineProperties(this.$,{isCloned:{value:!0,writable:!1},donor:{value:store.$.peekRecord(e,a)}}),Object.defineProperties(this.$,{pK:{value:a,writable:!0},model:{value:i},_attributes:{value:{},writable:!0},_relationships:{value:{},writable:!0},isDirty:{value:function(){var e,t=this.record;return!!t.$.isModified||!!(e=store.$.isDirty(t,this.model.relations)).length&&e}},undoStack:{value:store.$.genUnRedoStack(),writable:!0},redoStack:{value:store.$.genUnRedoStack(),writable:!0},delayPersistence:{value:n}}),this.$.record=this;var s=store.$.saveParent;s&&this!==s&&store.$.defProp(this.$,"parent",s);var l=i._fldGrps.default,d=i._fldGrps.watch,c=i._fldGrps.hasMany,p=i._fldGrps.nested_prop;for(var u in l){var f=l[u],h=t[u];void 0!==h&&""!==h||(this[u]=store.$.getDefaultVal(this,f.default))}for(var m in d)Lyte.establishObjectBinding(this,m,!0,void 0,void 0,!0);for(var y in p)Lyte.establishObjectBinding(this,y,!0,void 0,void 0,y&&y.watch?y.watch:void 0);for(var _ in c){var v=c[_];if(this.hasOwnProperty(_))this[_]=Array.isArray(this[_])?Array.from(this[_]):this[_];else if(store.modelFor(v.relatedTo)&&!o){store.$.getFromCB("serializer",v.relatedTo,"initHasManyRelation")&&(this[_]=[])}}var g=i._properties;Object.keys(g).length&&(this._bindings||store.$.defProp(this,"_bindings",new Set,!1,!0),this._bindings.add(g),store.$.establishObserverBindings(this,g))};Object.defineProperties($Record.prototype,{get:{value:function(e){var t=this.record[e];return Lyte.Component&&Lyte.Component._get&&(t=Lyte.Component._get(this.record,e)),Lyte.getConfig("mutable")&&(Lyte.isRecord(t)||Array.isArray(t)&&t.model)?Lyte.mut(t):t}},set:{value:function(e,t,r){return this.isDeleted?store.$.setRecErr(this,this.model._pK,"ERR17"):store.$.setData(this,e,t,r),this.record}},getDirtyAttributes:{value:function(){var e=[],t=this._attributes;if(Object.keys(t).length)for(var r in t)e.push(r);return e}},rollBackAttributes:{value:function(e,t){Array.isArray(e)||(e=[e]);for(var r=this.record.$.record,o=[],i=this.model,n=this._attributes,a=0;a<e.length;a++){var s=e[a];if(n.hasOwnProperty(s)){var l=i.fieldList[s],d=n[s];if("relation"==l.type)store.$.rllBckRecArr(d,r,i,l),(r.$.dN&&r.$.dN.hasOwnProperty(s)?r.$.dN[s]:new Map).forEach((function(e,t){store.$.deleteDeepNest(r,s,t)}));else store.$.cmpSet(r,s,d,void 0,!0);o.push(s),delete n[s]}store.$.clrRecErr(this,s)}if(Object.keys(this._attributes).length||(this.hasOwnProperty("dN")&&(!this.dN||Object.keys(this.dN).length)||r.$.isNew||store.$.removeParentNesting(r,"modified"),store.$.cmpSet(this,"isModified",!1),store.$.changePersist(r,!0),this.isNew||store.$.deleteFromArray(i.dirty,this.get(i._pK))),o.length>0){var c=[r,o];this.emit("change",c),i.emit("change",c),this.undoStack=store.$.genUnRedoStack(),this.redoStack=store.$.genUnRedoStack()}}},rollBack:{value:function(e,t){var r=this.model,o=(r._pK,new Map);t=!1!==t&&(r._fldGrps.inherit&&Object.keys(r._fldGrps.inherit).length),e?(this.rollBackState(e,t),store.$.removeOnSave(this.model._name,this.record.$.pK)):(t&&store.$.rBinherit(this,o,""),store.$.rollBackRecord(this))}},deleteRecord:{value:function(e){var t=this.model,r=this.record.$.record;e=void 0!==e?e:r.$.delayPersistence?r.$.delayPersistence.delete:void 0;store.$.removeFromStore(t,r.$.pK,void 0,void 0,e)}},destroyRecord:{value:function(e,t,r,o){return this.deleteRecord(r),this.save(e,t,"destroyRecord",void 0,o)}},addEventListener:{value:function(e,t){return store.$.eventListeners.add(this,e,t)}},removeEventListener:{value:function(e){store.$.eventListeners.remove(this,e)}},emit:{value:function(e,t){store.$.eventListeners.emit(this,e,t)}},triggerAction:{value:function(e,t,r,o,i){var n=this.model,a=n.actions;return(a?a[e]:void 0)?store.adapter.$.handleAction(e,n,this.record.$.record,t,r,o,i):Promise.reject({code:"ERR18",message:Lyte.errorCodes.ERR18,data:e})}},save:{value:function(e,t,r,o,i){var n=this;if(this.isCloned){if(this.isUnloaded)return Promise.resolve();n=store.$.savingDonorRecord(this)}var a,s=n.model,l=n.record,d=n.isDirty(),c=r&&r.validateOnSave,p=r&&r.skipValidation,u=s.fieldList;if(!0!==n.isUnloaded)if(n.isDeleted){if(!n.isNew)return store.adapter.$.del(s._name,l,!0,o,e,t,i)}else{if(n.isNew){var f=n;return p||l.$.validatedOnCreate&&!c||(a=store.$.validateRecord(n.record,u)),!p&&(0==a||f&&f.error&&Object.keys(f.error).length>0)?Promise.reject(f.error):store.adapter.$.create(s._name,l,!0,e,t,i)}if(n.isModified||d&&d.length){if(!p&&r&&c&&(a=store.$.validateRecord(n.record,u)),!p&&(0==a||l&&l.$&&l.$.isError))return Promise.reject(l.$.error);var h=store.$.updateJSON(n.record,s,d);return store.adapter.$.put(s._name,h,l,!0,e,t,i)}}else if(Lyte.warn("LD29","object"==typeof l.$.pK?JSON.stringify(l.$.pK):l.$.pK,s._name),store.$.getFromCB("adapter",s._name,"rejectUnloadRecordSave"))return Promise.reject({code:"ERR28",message:Lyte.errorCodes.ERR28,data:l});return Promise.resolve()}},getInitialValues:{value:function(e){var t=!1;e?(Array.isArray(e)||(e=[e]),t=!0):e=this.getDirtyAttributes();for(var r={},o=this.record.$.record,i=this._attributes,n=0;n<e.length;n++)if(null!=o[e]&&o[e[n]].add){r[e[n]]=o[e[n]].slice(0);for(var a=i[e[n]],s=o[e[n]].model._pK,l=a.length-1;l>=0;l--)if("added"==a[l]._type)for(var d=0;d<a[l].records.length;d++){var c=store.$.getIndex(r[e[n]],s,a[l].records[d].$.pK);-1!=c&&r[e[n]].splice(c,1)}else if("removed"==a[l]._type)for(d=a[l].records.length-1;d>=0;d--)r[e[n]].splice(a[l]._indices[d],0,a[l].records[d]);else"changed"==a[l]._type&&(r[e[n]]=Array.isArray(a[l].records)?Array.from(a[l].records):a[l].records)}else r[e[n]]=i[e[n]];return t?r[e[0]]:r}},toJSON:{value:function(e,t){var r=!0;return t=!!t,"object"==typeof e&&0==e.inherit&&(r=e.inherit),Object.assign({},store.$.toJSON(this.model._name,this.record.$.record,e||!0,void 0,void 0,r,t))}},undo:{value:function(e,t){var r=this.undoStack._order_.length;for(t=t||(r?r-1:r);r-- >t;)store.$.unredoOp(1,this,e)}},getCurrentState:{value:function(){return this.undoStack._order_.length}},redo:{value:function(e){store.$.unredoOp(2,this,e)}},validate:{value:function(e){var t={},r=this.model.fieldList;Array.isArray(e)&&e.forEach((function(e,o){r[e]&&(t[e]=r[e])})),0==Object.keys(t).length&&(t=r);var o=this.record;store.$.validateRecord(o,t)}},saveState:{value:function(e){if(this.isNew||this.isModified){for(var t,r=this._savedState=this._savedState||{},o=e;!o;)t=Math.floor(1e5*Math.random()+1),o=r.hasOwnProperty(t)?o:t;var i=this.toJSON("state");store.$.defProp(i,"$",{},!1,!0),this.model._arrPk.forEach((function(e){delete i[e]}));var n=this.undoStack,a=this.redoStack,s=this._attributes;if(n&&Object.keys(n).length){var l=n._order_;n=i.$.undoStack=store.$.deepCopyStack(n),store.$.defProp(n,"_order_",Lyte.deepCopyObject(l),!1,!0)}if(a&&Object.keys(a).length){l=a._order_;a=i.$.redoStack=store.$.deepCopyStack(a),store.$.defProp(a,"_order_",Lyte.deepCopyObject(l),!1,!0)}return s&&Object.keys(s).length&&(i.$._attributes=store.$.deepCopyAttrs(this.model,s)),this._savedState[o]=i,o}Lyte.warn("LD20")}},clearState:{value:function(e){e?delete this._savedState[e]:this._savedState={}}},rollBackState:{value:function(e,t){var r=this._savedState,o=r?r[e]:void 0;o?(this.dN&&(this.dN={}),store.$.setData(this,o,void 0,void 0,{},!0,t),store.$.updateDn(this.record.$.record),this.undoStack=o.$.undoStack||store.$.genUnRedoStack(),this.redoStack=o.$.redoStack||store.$.genUnRedoStack(),this._attributes=o.$._attributes||{},store.$.checkAttrs(this.record.$.record),delete this._savedState[e]):Lyte.warn("LD21",e)}},hasSavedState:{value:function(e){return!(!this._savedState||!this._savedState.hasOwnProperty(e))}},persist:{value:function(e){var t,r,o=this.model._name,i=this.record.$.record,n={obj:new Map};if(this.isNew)t="create",store.$.toJSON(o,i,void 0,t,n);else if(r=this.isDirty()){var a=store.$.updateJSON(i,this.model,r);store.$.toJSON(o,a,void 0,void 0,n)}var s=n.obj.get(this.pK);store.adapter.$.mergeResponse(i,this.model,void 0,this.pK,s,!0),store.adapter.$.updateIDB(o,t||(i.$.isDeleted?"deleteRecord":i.$.isModified||r?"updateRecord":void 0),i)}},clone:{value:function(){var e=this.record.$.record,t=this.record.$.toJSON({type:"isClone"});return store.$.insertIntoStore(e.$.model._name,t,void 0,void 0,void 0,void 0,void 0,{type:"isClone"})}}});var Model=function(e,t){Object.assign(this,{_name:e,fieldList:{id:{type:"string",primaryKey:!0,defined:!1}},relations:{},_properties:{},_fldGrps:{default:{},hasMany:{},watch:{},inherit:{},nested_prop:{},inverse:{},JsonPathWatch:{}},data:[],dirty:[],_deleted:new Map,events:{}}),store.$.defProp(this.data,"_recMap",new Map);var r=[];for(var o in t)store.$.registerField(this,o,t[o],r);this._pK||(this._pK="id"),this.isComp=!1;var i=this._pK.split(",");i.length>1&&(this.isComp=!0),this._arrPk=i,"undefined"!=typeof Lyte&&(Lyte.establishObserverBindings(r,!0,this._properties,this),Lyte.establishWatchScope(this._fldGrps.JsonPathWatch,this)),store.$.defArrUtls(this.data),store.$.defUtls(this.data,this),store.$.defProp(this,"extends",store.$.extendModel)};Model.prototype.addEventListener=function(e,t){return store.$.eventListeners.add(this,e,t)},Model.prototype.removeEventListener=function(e){store.$.eventListeners.remove(this,e)},Model.prototype.emit=function(e,t){store.$.eventListeners.emit(this,e,t)},Model.prototype.on=function(e,t){return this.addEventListener(e,t)},Model.prototype.setGql=function(e,t,r){store.$.setQuery(this,t,e,r)};var store={model:{},$:{idbOpen:!0,request:{},toRelate:{},idbQueue:[],idbQ:{},idbQ2:{},nestScp:{},nestScpId:1,getAdapter:function(e){if("application"==e.name)return store.adapter[e.name];if(e.model||e.name){var t=e.model||store.model[e.name];if(t&&t.extend&&!store.adapter.hasOwnProperty(t._name))return store.adapter[t.extend];var r=t?t._name:e.name;return store.adapter[r]}},registerModel:function(e,t,r){if(store.model.hasOwnProperty(e))return Lyte.warn("LD14","Model",e),Lyte._postRegister(),{error:Lyte.getErrorMessage("LD14","Model",e),extends:function(){}};try{var o,i,n,a;if(r&&"object"==typeof r&&(o=r.extends||void 0,i=r.actions||void 0,n=r.idb||void 0,a=r.gql||void 0),o){var s=Object.assign({},store.model[o].fieldList);for(var l in s)"relation"==s[l].type&&delete s[l];t=Object.assign(t,s)}var d=store.model[e]=new Model(e,t);o&&store.$.extendModel(o,d),i&&(d.actions=i),n&&(d.idb=n),a&&(d.gql=a),Lyte._postRegister()}catch(e){Lyte._postRegister()}return d},changePersist:function(e,t){if(!e.$.isUnloaded||e.$.isPeristed!==t)switch(t){case!0:e.$.isNew||e.$.isModified||e.$.isDeleted||store.$.cmpSet(e.$,"isPersisted",!0);break;case!1:(e.$.isNew||e.$.isModified||e.$.isDeleted||e.$.dN&&Object.keys(e.$.dN)&&Object.keys(e.$.dN).length)&&store.$.cmpSet(e.$,"isPersisted",!1)}},getFromCB:function(e,t,r){var o,i=store[e];/^(adapter|serializer)$/.test(e)&&store.model.hasOwnProperty(t)&&store.model[t].extend&&(o=store.model[t].extend);for(var n=i&&i.hasOwnProperty(t)?i[t]:o&&i.hasOwnProperty(o)?i[o]:void 0,a=n?n[r]:void 0;void 0===a;)if(n&&n.$super)a=(n=n.$super)?n[r]:void 0;else{if(n||(n=i.application),!n||!n.hasOwnProperty(r)){if("adapter"==e){switch(r){case"host":a=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host;break;case"namespace":a="";break;case"actionNamespace":a="action";break;case"batchNamespace":a="batch";break;default:a=void 0}break}break}if(a=n[r],!n&&!a)break}return a},newCB:function(e,t,r,o,i){for(var n in t.__extendedBy=[],o)t[n]=o[n];store.$.extendOptions(i,e,r,t,store),store.$.lazyExtend(e,t,r),store.$.defProp(t,"is",e),store.$.defProp(t,"__name",r)},extendOptions:function(e,t,r,o,i){e&&e.mixins&&e.mixins.length&&e.mixins.forEach((function(e){if(Lyte.Mixin.exists(e)){var n=Lyte.registeredMixins[e];for(var a in n)o[a]=n[a]}else Lyte.$.requiredMixins(e,{name:r,scope:i},t)}));var n=e?e.services:[];if(store.$.extendService(n,t,r,o,i),Lyte.toBeInjectedServices){var a=Lyte.toBeInjectedServices,s=[];for(var l in a)s.push({as:l,service:a[l]});store.$.extendService(s,t,r,o,i,!0)}},extendService:function(e,t,r,o,i,n,a){Lyte.extendService({services:e,type:t,name:r,ins:o,isGlobal:n,data:a,callback:function(e,r,o){Lyte.$.lazyRegisterService(n?e:new e,{scope:i,type:t,name:o,key:r})}})},lazyExtend:function(e,t,r){var o=store[e];if(o.__toAddSuper&&o.__toAddSuper.hasOwnProperty(r)){for(var i=o.__toAddSuper[r],n=0;n<i.length;n++){var a,s=o[i[n]];if(s&&s.is==e)s.$super=t,t.__extendedBy.push(i[n]),"application"!=r&&(o.__toAddSuper.application&&(a=o.__toAddSuper.application.indexOf(s.__name))>-1&&o.__toAddSuper.application.splice(a,1),o.application&&(a=o.application.__extendedBy.indexOf(s.__name))>-1&&o.application.__extendedBy.splice(a,1))}delete o.__toAddSuper[r]}},cbDef:function(e,t){Object.defineProperties(e.prototype,{super:{value:function(){return store.$.super.call(this,arguments)}},extends:{value:function(e){store.$.extendCallback.call(this,store,t,e)}}})},changeRelPkMaps:function(e,t,r,o,i){var n=e.$.model,a=n.relations;for(var s in a)for(var l=a[s],d=l.length,c=0;c<d;c++){var p=l[c],u=p.relKey,f=p.relType;if(e.hasOwnProperty(u)){var h,m=e[u],y=store.model[p.relatedTo];if(y&&(h=store.$.getBackwardRel(n,p,y))&&"hasMany"==h.relType)if(w=h.opts&&h.opts.sort&&h.opts.sort.sortFn&&h.opts.sort.observes,"belongsTo"==f&&Lyte.isRecord(m))switch(o){case"sort":case"srtObsChk":if(m&&Array.isArray(m[h.relKey]))if("sort"==o)w&&-1!=h.opts.sort.observes.indexOf(i)&&store.$.handleArrOp(m[h.relKey],"sort");else if(i!==h.relKey)return!0;break;default:m[h.relKey]&&m[h.relKey]._recMap&&m[h.relKey]._recMap.delete(t)&&m[h.relKey]._recMap.set(r,e)}else if("hasMany"==f&&Array.isArray(m))for(var _=m.length,v=0;v<_;v++){var g=m[v];switch(o){case"sort":case"srtObsChk":if(g&&Array.isArray(g[h.relKey]))if("sort"==o)w&&-1!=h.opts.sort.observes.indexOf(i)&&store.$.handleArrOp(g[h.relKey],"sort");else if(i!==h.relKey)return!0;break;default:Lyte.isRecord(g)&&g[h.relKey]&&g[h.relKey]._recMap&&g[h.relKey]._recMap.delete(t)&&g[h.relKey]._recMap.set(r,e)}}}}var b=e.$._relationships;for(var A in b){var $=b[A],L=store.modelFor(A);for(var u in $)for(var E=$[u],R=L.fieldList[u],w=R.opts&&R.opts.sort&&R.opts.sort.sortFn&&R.opts.sort.observes,N=E.length,P=0;P<N;P++){var C=(g=E[P])[u];if(Array.isArray(C))switch(o){case"sort":case"srtObsChk":if(Array.isArray(C))if("sort"==o)w&&-1!=R.opts.sort.observes.indexOf(i)&&store.$.handleArrOp(C,"sort");else if(i!==R.relKey)return!0;break;default:C._recMap&&C._recMap.delete(t)&&C._recMap.set(r,e)}}}},updateNestScp:function(e,t){if(Lyte.isRecord(e)){var r=e.$.__scpObj||{};for(var o in r){if(n=(n=r[o]).split("_")[0],Lyte.nestScp&&Lyte.nestScp.hasOwnProperty(n)&&Lyte.nestScp[n].model){var i=Lyte.nestScp[n].model.get(e.$.model._name);if(i.has(t)){var n=i.get(t);i.delete(t),i.set(e.$.pK,n)}}}}},getDefaultVal:function(e,t){return"function"!=typeof t?t:t.call(e)},deepValueChange:function(e,t,r,o){var i={emit:!1,attr:[],oldRec:{}};store.$.estAttrs(e,t,r,i,o),store.$.checkAttrs(e),store.$.changeCallbck(e,i)},updateDn:function(e){var t=e.$.model.relations;for(var r in t){t[r].forEach((function(t){var r=t.opts,o=t.relKey,i=t.relType;if(r&&r.deepNest&&e.hasOwnProperty(o)){var n=e[o];"belongsTo"==i&&(n.$.isModified||n.$.dN&&Object.keys(n.$.dN).length)?store.$.setDeepNest(e,o,n.$.pK,"updated"):"hasMany"==i&&Array.isArray(n)&&n.forEach((function(t){(t.$.isModified||t.$.dN&&Object.keys(t.$.dN).length)&&store.$.setDeepNest(e,o,t.$.pK,"updated")}))}}))}},genUnRedoStack:function(){var e={};return store.$.defProp(e,"_order_",[],!1),e},deepCopyStack:function(e){if(e&&"object"==typeof e)for(var t in e=Object.assign({},e))if(Array.isArray(e[t])){var r=e[t]=Array.from(e[t]);r.forEach((function(e,t){r[t]=Object.assign(e)}))}return e},deepCopyAttrs:function(e,t){var r=e.fieldList;t=Object.assign({},t);for(var o in t){var i=t[o];r[o]&&"relation"==r[o].type&&Array.isArray(i)&&(i=t[o]=Array.from(i)).forEach((function(e,t){i[t]=Object.assign({},e),e.hasOwnProperty("records")&&e.records&&(e.records=Array.from(e.records)),e.hasOwnProperty("_indices")&&e._indices&&(e._indices=Array.from(e._indices))}))}return t},addTo_Del:function(e,t,r){var o={index:r,data:t};(e._deleted=e._deleted||new Map).set(t.$.pK,o)},scExtd:function(e,t,r,o){var i="adapter"==e?store.adapter:store.serializer;if(t)return i.hasOwnProperty(t)?(Lyte.warn("LD14",e,t),{error:Lyte.getErrorMessage("LD14",e,t),extends:function(){}}):(i[t]="adapter"==e?new Adapter(r,o,t):new Serializer(r,o,t),i.application&&"application"!=t&&(i[t].$super=i.application,i.application.__extendedBy.push(t)),i.application||"application"==t||(i.__toAddSuper=i.__toAddSuper||{},i.__toAddSuper.hasOwnProperty("application")||(i.__toAddSuper.application=[]),i.__toAddSuper.application.push(t)),i[t])},initCB:function(e,t,r,o){var i=store.$.cbScp(t,r,e),n=o.args,a={};if(i)return a.data=store.$.cB(i,n),a},cB:function(e,t){return e.func.apply(e.scope,t.concat(e.name))},cbScp:function(e,t,r){var o,i=store[r],n=i.application;/^(adapter|serializer)$/.test(r)&&store.model.hasOwnProperty(e)&&store.model[e].extend&&(o=store.model[e].extend);for(var a=i&&i.hasOwnProperty(e)?i[e]:o&&i.hasOwnProperty(o)?i[o]:void 0;;){if(a&&a[t]&&"function"==typeof a[t])return{scope:a,func:a[t],name:t};if(!a||!a.$super)return n&&n[t]&&"function"==typeof n[t]?{scope:n,func:n[t],name:t}:void 0;a=a.$super}},comparePk:function(e,t){var r=e.$.pK,o=typeof r;if("string"==o||"number"==o)return r===t;if("object"==typeof r){var i=Object.keys(r).length,n=0;for(var a in r)r[a]===t[a]&&n++;return i===n}},getpKVal:function(e,t){var r=(t=t||e.$.model)._arrPk;if(1==r.length)return e[r[0]];var o={};return r.forEach((function(t){o[t]=e[t]})),o},unredoOp:function(e,t,r){var o,i;1==e?(o=t.undoStack,i=t.redoStack):(o=t.redoStack,i=t.undoStack);var n=[],a={};if(r?(n=Array.isArray(r)?r:[r]).forEach((function(e){if(o[e].length)for(var t=o._order_.length-1;t>=0;t--){var r=o._order_[t],i=r.indexOf(e);if(i>-1){r.splice(i,1),r.length||o._order_.splice(t,1);break}}})):n=o._order_&&o._order_.length?o._order_.pop():n,n.length){for(var s=0;s<n.length;s++){var l,d=n[s];"update"==(l=o[d].pop())._type?l.hasOwnProperty("val")?store.$.setData(t,d,l.val,void 0,a):l.hasOwnProperty("records")&&store.$.setData(t,d,l.records,void 0,a):1==e&&"propAdd"==l._type?"undefined"!=typeof Lyte?(a[d]={_type:"propDelete",val:t.record[d]},l.hasOwnProperty("val")&&store.$.setData(t,d,l.val,void 0,{}),Lyte.objectUtils?Lyte.objectUtils(t.record,"delete",d):delete t.record[d]):delete t.record[d]:2==e&&"propDelete"==l._type?(a[d]={_type:"propAdd"},store.$.setData(t,d,l.val,void 0,a)):"added"==l._type?t.record.$.get(d).remove(l.records,void 0,a):"removed"==l._type&&(store.$.rllBckRecArr([l],t.record,t.model,t.model.fieldList[d]),l._type="added",a[d]=l)}var c=Object.keys(a);for(s=0;s<c.length;s++){i[d=c[s]]=i[d]||[],i[d].push(a[d])}c.length&&i._order_.push(c)}},unregisterModel:function(e,t){var r=store.modelFor(e);if(r){r.data.length&&store.unloadAll(e,void 0,t);var o=r.extendedBy;if(o&&Object.keys(o).length)for(var i in o)store.unregisterModel(i,t);var n=r.extend;if(n)delete store.modelFor(n).extendedBy[e];delete store.model[e],store.__mdlPrx&&delete store.__mdlPrx[e]}else Lyte.warn("LD02","Model ",e)},getDsrzEmpData:function(e,t){if(e.hasOwnProperty("deserializeEmptyData"))return e.deserializeEmptyData;var r=store.$.getFromCB("serializer",t,"deserializeEmptyData");return void 0!==r&&r},updateFieldValidation:function(e,t,r,o){var i=e.data,n=e.fieldList;i.forEach((function(i){var a=n[t];if(r){var s=store.$.getDsrzEmpData(a,e._name),l=!s&&i[t];i.hasOwnProperty(t)&&(l||s)&&Lyte.Transform.hasOwnProperty(a.type)&&Lyte.Transform[a.type].hasOwnProperty("deserialize")&&(i[t]=Lyte.Transform[a.type].deserialize(i[t],t,e._name,store.$.getpKVal(i,e)))}if(!o){var d=!!(i.$.error&&i.$.error.hasOwnProperty(t)&&i.$.error[t].hasOwnProperty("value")),c=d?i.$.error[t].value:void 0;store.$.clrRecErr(i.$,t),d?store.$.validateField(i,t,a,void 0,{old:!0,value:c}):store.$.validateField(i,t,a,void 0)}d&&i.$.error&&0===Object.keys(i.$.error)&&i.$.set(t,c)}))},validateRelatedRecord:function(e,t,r){var o=store.model[r.relatedTo].fieldList;if(r&&r.opts&&e&&e.hasOwnProperty(t)&&r.opts&&"record"==r.opts.serialize){if("belongsTo"==r.relType&&Lyte.isRecord(e[t]))return this.validateRecord(e[t],o);if("hasMany"==r.relType&&Array.isArray(e[t])){var i=!0,n=this;return e[t].forEach((function(e,t){Lyte.isRecord(e)&&!1===n.validateRecord(e,o)&&(i=!1)})),i}}},validateRecord:function(e,t){var r,o=!0;for(var i in t)r=this.validateField(e,i,t[i],undefined),!0===o&&!1===r&&(o=!1);return!(!1===o||!0===e.$.isError&&e.$.error&&Object.keys(e.$.error).length)},validateField:function(e,t,r,o,i){var n,a=i&&i.old?i.value:e[t],s=e.$;if("relation"==r.type){if(!1===this.validateRelatedRecord(e,t,r))return!1,false}else if(r.mandatory&&!e.$.error.hasOwnProperty(t)&&(void 0===a||""===a||Array.isArray(a)&&0===a.length))store.$.setRecErr(s,t,{code:"ERR02",message:Lyte.errorCodes.ERR02,value:a});else if(n=!0,i||e.hasOwnProperty(t)&&!e.$.error.hasOwnProperty(t)){var l=r;l.any&&Array.isArray(l)||(l=[l]);for(var d=l.length,c=!0,p=0;p<d;p++){var u=l[p];for(var f in u){var h=Lyte.checkProperty(f,a,t,u[f],u,e,void 0,Lyte.isRecord(e)?e.$.model._name:void 0);if(!0!==h){!0===c&&("object"==typeof h&&(h.value=a),c=h);break}}}!0!==c&&(store.$.setRecErr(s,t,c),n=!1),i&&n&&store.$.setData(e.$,t,a),n&&store.$.clrRecErr(s,t)}},partialData:function(e,t,r,o,i,n){var a=e[t];if(!a||!Array.isArray(a))return!0;a.partial||store.$.defPar(a);var s=a.partial=a.partial||new Map;s.get(r)||s.set(r,{});var l=!1;switch(s.get(r).type){case"added":"removed"==o&&(s.delete(r),l=!0);break;case"removed":if("added"==o){if(e[t]._recMap)var d=e[t]._recMap.get(r);if(!d||Lyte.isRecord(d)&&!d.$.isDirty())s.delete(r),l=!0;else s.get(r).type="modified"}break;case"modified":case"updated":if("added"==o)break;default:if(n)s.delete(r),l=!0;else{var c={type:o};i&&(c.polymorphicType=i),s.set(r,c)}}return l&&!s.size?(s.size||store.$.deleteDeepNest(e,t,r),!0):void 0},removeParentNesting:function(e,t,r){var o=e.$.model,i=e.$.pK,n=o.relations;for(var a in n){n[a].forEach((function(n){var a,s,l,d,c=store.model[n.relatedTo];c&&((a=store.$.getBackwardRel(o,n,c))&&a.opts&&(s=a.opts.deepNest,l=a.opts.hasOwnProperty("serialize"),d=n.relKey&&n!=a?e[n.relKey]:store.$.getRelatedRecord(e,n.relatedTo,n.dummy?n.dummy:n.relKey)),l&&!r&&(d&&!Array.isArray(d)&&(d=[d]),Array.isArray(d)&&d.forEach((function(e){if(a.relKey)if("belongsTo"==a.relType&&e&&e.$)e.$.partial&&e.$.partial[a.relKey]&&e.$.partial[a.relKey].has(i)&&(e.$.partial[a.relKey].delete(i),e.$.partial[a.relKey].size||delete e.$.partial[a.relKey]),s&&store.$.deleteDeepNest(e,a.relKey,i);else if("hasMany"==a.relType){var r=e[a.relKey];if(Array.isArray(r)){if(r.partial&&r.partial.has(i)){var o=r.partial.get(i).type;"modified"==t?/^(modified|updated)$/.test(o)&&r.partial.delete(i):r.partial.delete(i)}s&&store.$.deleteDeepNest(e,a.relKey,i)}}}))))}))}},deleteDeepNest:function(e,t,r){var o=e.$.dN;o&&(o[t]&&void 0===r?delete o[t]:o[t]&&o[t].get(r)&&(o[t].delete(r),o[t].size||delete o[t]),Object.keys(o).length||(delete e.$.dN,e.$.isModified||e.$.isNew||store.$.removeParentNesting(e),store.$.changePersist(e,!0)))},updateJSON:function(e,t,r){var o={},i=t._arrPk,n=e.$._attributes;for(var a in n)o[a]=e[a];var s=r;1==r&&(s=store.$.isDirty(e,t.relations)||[]);for(var l=0;l<s.length;l++)o[s[l]]=e[s[l]];return i.forEach((function(t){o[t]=e[t]})),o},removeDeepNest:function(e){if(Lyte.isRecord(e)&&(e.$.dN&&Object.keys(e.$.dN).length)){e.$.dN={};var t=e.$.model.relations;for(var r in t){t[r].forEach((function(t){var r=t.opts;if(r&&(r.deepNest||"partial"==r.serialize)){var o=e[t.relKey];Array.isArray(o)?o.forEach((function(e){Lyte.isRecord(e)&&(store.$.removeDeepNest(e),e.$.isNew||e.$.isModified||e.$.dN&&(!e.$.dN||0!=Object.keys(e.$.dN).length)||store.$.removeParentNesting(e))})):Lyte.isRecord(o)&&(store.$.removeDeepNest(o),o.$.isNew||o.$.isModified||o.$.dN&&(!o.$.dN||0!=Object.keys(o.$.dN).length)||store.$.removeParentNesting(o))}}))}}},addDeepNest:function(e,t,r,o,i,n){i=i||new Map;var a,s=t?store.model[e.$.model.extend]:e.$.model,l=e.$.pK,d=(r=r||"updated",s.relations);for(var c in d){d[c].forEach((function(t){var d,c,p,u,f=store.model[t.relatedTo];if(f&&(d=store.$.getBackwardRel(s,t,f),a=t.relKey&&d!==t?e[t.relKey]:store.$.getRelatedRecord(e,t.relatedTo,t.dummy?t.dummy:t.relKey))){var h,m=!1;if(!i.get(d)){var y=i.set(d,new Map);m=!0}if(y=i.get(d),(m||!y.get(a))&&(y.set(a,!0),d&&d.opts&&(c=d.opts.deepNest,p="partial"==d.opts.serialize,u=!!d.opts.serialize&&d.opts.serialize),"updated"==r&&"id"==u&&(h=!0),(!n||n&&p)&&!h&&(c&&store.$.makeDirty("dirty",a,r,d,l,i),u&&e&&a&&(!o||!o||o.model!==t.relatedTo||d.relKey!==o.relKey)))){var _=a;"hasMany"==d.relType?Array.isArray(_)?_.forEach((function(e){store.$.partialData(e,d.relKey,l,/^(added|removed)$/.test(r)?r:"modified")})):Lyte.isRecord(_)&&store.$.partialData(_,d.relKey,l,/^(added|removed)$/.test(r)?r:"modified"):Array.isArray(_)?_.forEach((function(e){"added"==r&&e&&e.$&&e.$.partial&&e.$.partial[d.relKey]&&e.$.partial[d.relKey].has(l)&&delete e.$.partial})):Lyte.isRecord(_)&&"added"==r&&_&&_.$&&_.$.partial&&_.$.partial[d.relKey]&&_.$.partial[d.relKey].has(l)&&delete _.$.partial}}}))}s.extend&&this.addDeepNest(e,!0)},getRelatedRecord:function(e,t,r){if(e){var o=e.$._relationships;if(o[t]&&o[t][r])return o[t][r]}},makeDirty:function(e,t,r,o,i,n){if("id"!=o.opts.serialize||"updated"!=r){var a=o.relKey;Array.isArray(t)?t.forEach((function(e){store.$.setDeepNest(e,a,i,r,n)})):Lyte.isRecord(t)&&store.$.setDeepNest(t,a,i,r,n)}},setDeepNest:function(e,t,r,o,i){var n=e.$.dN=e.$.dN||{},a=n[t]=n[t]||new Map;a.has(r)||a.set(r,{});var s=a.get(r);switch(s.type){case"added":"removed"==o&&store.$.deleteDeepNest(e,t,r);break;case"removed":"added"==o&&store.$.deleteDeepNest(e,t,r),"modified"==o&&(s.type="updated");break;default:s.type=o,store.$.changePersist(e,!1),store.$.addDeepNest(e,void 0,void 0,void 0,i)}},isDirty:function(e,t,r,o){var i=[];for(var n in t)for(var a=t[n],s=0;s<a.length;s++){if((n=a[s]).opts&&n.opts.serialize){var l=n.relKey,d=n.relType,c=e[l],p=store.model[n.relatedTo];if(r&&p)if(r==store.$.getBackwardRel(o,n,store.model[n.relatedTo])&&o._name!=n.relatedTo)continue;if("record"==n.opts.serialize){if(store.$.isRelDirty(n,c,n)){i.push(l);continue}}else if("partial"==n.opts.serialize)if("hasMany"==d){if(c&&c.partial&&c.partial.size){i.push(l);continue}}else if(Lyte.isRecord(c)&&c.$.isModified||e&&e.$&&e.$.partial&&e.$.partial.hasOwnProperty(l)){i.push(l);continue}n.opts.deepNest&&e.$.dN&&e.$.dN[l]&&i.push(l)}}return i},isRelDirty:function(e,t,r){var o=e.relType,i=store.model[e.relatedTo],n=i.relations;if(!store.$.isEmpty(t))if("hasMany"==o&&Array.isArray(t)&&t.length){for(var a=t.length,s=0;s<a;s++)if(1==t[s].$.isModified)return!0;for(var l=0;l<a;l++){var d=t[l];if(this.isDirty(d,n,r,i).length)return!0}}else if("belongsTo"==o&&Lyte.isRecord(t)){if(1==t.$.isModified)return!0;if(this.isDirty(t,n,r,i).length)return!0}return!1},handleCachedResponse:function(e,t){var r=store.$.cachedBatch=store.$.cachedBatch||{},o=r[e]||[],i=0;return o.forEach((function(e,r){t.splice(e.ind+i++,0,e.data)})),delete r[e],t},addToCachedBatch:function(e){var t=store.$.currentBatch,r=store.$.cachedBatch=store.$.cachedBatch||{},o=r[t]=r[t]||[],i=(store.$.batch[t]||[]).length;o.push({ind:i,data:e})},establishToRelated:function(e,t){var r=e.$.model,o={};t.forEach((function(t){var i=store.$.peekRecord(t.model,t.pkVal);if(i){var n=i.$.model;store.$.getRelations(n,t.key,r,o),store.$.establishLink(o.forward,o.backward,i,e,void 0,!0)}}))},checkObjAndAddToArr:function(e,t,r){for(var o=Object.keys(r).length,i=-1,n=e.length,a=0;a<n;a++){var s=e[a],l=0;for(var d in r)s[d]==t[d]&&l++;if(l==o)return i=a,void e.splice(a,1,t)}return-1==i&&e.push(t),i},addToRelate:function(e,t,r,o){var i=r.forward.relatedTo,n=store.$.toRelate[i]=store.$.toRelate[i]||new Map;n.has(o)||n.set(o,[]);var a=n.get(o),s={model:e,pkVal:t.$.pK,key:r.forward.relKey};a.push(s)},addOnSave:function(e,t,r,o,i,n){store.$.onSave=store.$.onSave||{};var a=store.$.onSave[e]=store.$.onSave[e]||{},s=a[t[i]]=a[t[i]]||{},l=t[r]||[];"belongsTo"==o.relType&&(l=Array.isArray(t[r])?t[r]:[t[r]]),l.forEach((function(e){var t=s[o.relKey]=s[o.relKey]||[];store.$.checkAndAddToArray(t,e[n])}))},addToIDBonSave:function(e,t){var r=store.model[e].fieldList,o=store.$.onSave?store.$.onSave[e]:void 0;if(o){var i=store.model[e]._pK,n=t&&i?o[t[i]]:void 0;if(n){for(var a in n){var s=n[a],l=r[a].relatedTo;s.forEach((function(e){var t=store.$.peekRecord(l,e);if(t){var r=t.$.parent;if(Lyte.isRecord(r)){var o=r.$.model,i=o._name,n=o._pK;store.$.checkAndAddToIDBQ(i,"updateRecord",store.$.peekRecord(i,r[n]).$.toJSON(!0))}else store.$.checkAndAddToIDBQ(l,"updateRecord",store.$.peekRecord(l,e).$.toJSON(!0))}}))}store.$.removeOnSave(e,t[i])}}},removeOnSave:function(e,t){var r=store.$.onSave?store.$.onSave[e]:void 0;r&&r[t]&&delete r[t]},checkAndAddToIDBQ:function(e,t,r){var o={model:e,type:t,data:r};(store.$.idbQ2[e]=store.$.idbQ2[e]||[]).push(o)},checkAndRemoveKey:function(e,t,r){for(var o in e){var i=t[o];i&&"relation"==i.type&&(r&&!this.checkPresenceInArray(r,o)?delete e[o]:this.removeNotNeededKeys(i.relatedTo,e[o]))}},removeNotNeededKeys:function(e,t,r){var o=store.model[e],i=o.fieldList,n=r?r.deserializeKeys:void 0;if(o){var a=this;Array.isArray(t)?t.forEach((function(e){a.checkAndRemoveKey(e,i,n)})):this.checkAndRemoveKey(t,i,n)}return t},getIDBObj:function(e,t,r,o,i,n){if(e&&e.hasOwnProperty("idb"))return"function"==typeof e.idb?e.idb.apply(e,[{model:n||e._name,type:r,queryParams:t,key:o,customData:i}]):e.idb},idbQ2Push:function(e,t,r,o,i,n,a){try{var s=store.model[e],l=store.$.getIDBObj(s,r,o,i,a);if(l){var d={model:e,type:o,customData:a};d.queryCache=l.queryCache;s._pK;var c=store.$.idbQ2[e]=store.$.idbQ2[e]||[];switch(o){case"action":return void delete c[o];case"update":case"create":d.data=[],t.forEach((function(e){d.data.push(Lyte.isRecord(e)?e.$.toJSON(void 0,!0):e)}));break;case"updateRecord":case"createRecord":case"delete":d.data=t;break;case"destroyRecord":case"deleteRecord":d.id=t;break;case"findRecord":d.key=i;var p=t[0].$.toJSON("idb");(u={})[e]=p,n&&(u.meta=n),!0===l.queryCache&&(d.queryParams=r),d.data=u;break;case"findAll":var u;p=[];t.forEach((function(e){p.push(e.$.toJSON("idb"))})),(u={})[e]=p,n&&(u.meta=n),!0===l.queryCache&&(d.queryParams=r),d.data=u;break;case"pushPayload":Lyte.isRecord(t)&&(t=t.$.toJSON("idb")),d.data=t}c.push(d)}}catch(e){Lyte.error("Error while adding to IDBQueue ",e)}},isEmpty:function(e){return null==e||""===e||null==e},isEmptyObj:function(e){return null!==e&&"object"==typeof e&&0==Object.keys(e).length},isEmptyArray:function(e){return!(!Array.isArray(e)||0!=e.length)},registerField:function(e,t,r,o){var i=e.fieldList[t]?Object.assign({},e.fieldList[t]):void 0;if("observer"==r.type)o.push(r);else if("callBack"==r.type){r.observes&&o.push(r.observes);for(var n=r.properties,a=0;a<n.length;a++)"didLoad"===n[a]||"init"===n[a]?(e.didLoad||(e.didLoad=[]),e.didLoad.push(r.value)):"add"!==n[a]&&"change"!==n[a]||e.on(n[a],r.value);"didLoad"==t&&(e.didLoad||(e.didLoad=[]),e.didLoad.push(r.value))}else if("didLoad"==t)e.didLoad||(e.didLoad=[]),e.didLoad.push(r);else if(Object.keys(r).length){if(r.primaryKey&&(e.fieldList.id&&0==e.fieldList.id.defined&&delete e.fieldList.id,r.hasOwnProperty("default")&&(Lyte.warn("LD23",e._name,t),delete r.default),null!=e._pK?(e._pK=e._pK+","+t,e.isComposite=!0):e._pK=t,r.baseKey)){if(e.bK)return void Lyte.warn("LD26");e.bK=t}if(e.fieldList.hasOwnProperty(t));if(e.fieldList[t]=r,i&&e._fldGrps&&(i.hasOwnProperty("default")&&delete e._fldGrps.default[t],i.hasOwnProperty("watch")&&delete e._fldGrps.watch[t],i.opts&&i.opts.hasOwnProperty("inherit")&&delete e._fldGrps.inherit[t]),r.hasOwnProperty("default")&&(e._fldGrps.default[t]=r),r&&r.opts&&r.opts.hasOwnProperty("inherit")&&(e._fldGrps.inherit[t]=r),r.hasOwnProperty("watch")&&(1==r.watch||Array.isArray(r.watch))&&/^(array|object)$/.test(r.type)&&(e._fldGrps.watch[t]=r),Lyte.Transform[r.type]){var s=Lyte.Transform[r.type];(/^(array|object)$/.test(s.extends)&&s.hasOwnProperty("properties")||s.hasOwnProperty("items"))&&(e._fldGrps.nested_prop[t]=r)}}if("relation"===r.type){r.relKey=t;var l=r.relatedTo,d=e.fieldList[t];e.relations[l]||(e.relations[l]=[]);var c={};c.relKey=d.relKey,store.$.checkObjAndAddToArr(e.relations[r.relatedTo],d,c),"hasMany"==r.relType&&(e._fldGrps.hasMany[t]=r),r.hasOwnProperty("opts")&&r.opts.hasOwnProperty("inverse")&&(e._fldGrps.inverse[l]=r)}},setError:function(e,t,r){e.$.hasOwnProperty("error")?Array.isArray(t)?t.forEach((function(t){store.$.cmpSet(e.$.error,t,r)})):store.$.cmpSet(e.$.error,t,r):Lyte.error("LD03",e,t)},unRegCb:function(e,t){var r=store[e][t];if(r){var o=r.__extendedBy;if(o.length){if(store[e].__toAddSuper=store[e].__toAddSuper||{},store[e].__toAddSuper[t]?o.forEach((function(r){store[e].__toAddSuper[t].push(r)})):store[e].__toAddSuper[t]=o.slice(),o.forEach((function(t){store[e][t].$super=void 0})),store[e].application&&"application"!=t){var i=store[e].application;o.forEach((function(t){store[e][t].$super=i,store[e].application.__extendedBy.push(t)}))}store[e].application||(store[e].__toAddSuper.application?o.forEach((function(t){store[e].__toAddSuper.application.push(t)})):store[e].__toAddSuper.application=o.slice())}r.$super&&r.$super.__extendedBy.splice(r.$super.__extendedBy.indexOf(t),1),delete store[e][t]}else Lyte.error("LD02",e,t)},eventListeners:{add:function(e,t,r){return e.events=e.events||{},e.events[t]=e.events[t]||[],e.events[t].push({f:r}),t+"-"+(e.events[t].length-1)},remove:function(e,t){var r;if(t)if(/^(add|remove|change)$/.test(t))r=t,e.events&&e.events[r]&&delete e.events[r];else{var o=t?t.split("-"):void 0;if(o){var i=e.events[o[0]];i&&o[1]&&(i[o[1]]=null)}}else{var n=e.events;for(var a in n)n&&n[a]&&delete n[a]}},emit:function(e,t,r){for(var o=e.events&&e.events[t]?e.events[t]:[],i=0;i<o.length;i++)o[i]&&o[i].f.apply(null,r)}},extendCallback:function(e,t,r){var o,i,n=e[t];if(r&&"string"==typeof r&&((i=n[r])||(n.__toAddSuper=n.__toAddSuper||{},n.__toAddSuper.hasOwnProperty(r)||(n.__toAddSuper[r]=[]),n.__toAddSuper[r].push(this.__name))),i&&i.is==t&&(!this.$super||"application"==this.$super.__name)){if(this.$super=i,i.__extendedBy.push(this.__name),n.application){var a=n.application.__extendedBy.indexOf(this.__name);a>-1&&n.application.__extendedBy.splice(a,1)}if((o=n.__toAddSuper)&&o.application){var s=o.application.indexOf(this.__name);s>-1&&n.__toAddSuper.application.splice(s,1)}}return this},super:function(){var e=this.$super,t=arguments[0][0][arguments[0][0].length-1],r=[],o=arguments[0][0],i=e[t];if("function"==typeof i){for(var n in delete o[o.length-1],o)o.hasOwnProperty(n)&&r.push(o[n]);return i.apply(e,r)}if(i)return i},extendModel:function(e,t){var r=t||this;if(e&&store.model[e]){var o=Object.assign({},store.model[e].fieldList);for(var i in o)"relation"==o[i].type&&delete o[i];var n={},a="id"==r._pK&&0==r.fieldList.id.defined;for(var i in o){var s=o[i];a&&s.primaryKey&&s.defined;if(r.fieldList.hasOwnProperty(i)&&r._fldGrps){var l=r.fieldList[i];l.hasOwnProperty("default")&&delete r._fldGrps.default[i],l.hasOwnProperty("watch")&&delete r._fldGrps.watch[i]}s.hasOwnProperty("default")&&(r._fldGrps.default[i]=s),s.hasOwnProperty("watch")&&1==s.watch&&/^(array|object)$/.test(s.type)&&(r._fldGrps.watch[i]=s),s.primaryKey?n[i]=s:r.fieldList[i]=s}var d=Object.keys(n),c=d.length;if(a&&c){for(var i in delete r.fieldList.id,n)r.fieldList[i]=n[i];1==c?(r._pK=d[0],r._arrPk=Array.from(d)):(r.isComp=!0,r._arrPk=Array.from(d),r._pK=r._arrPk.toString())}var p=r._name;if(store.model[p].extend=e,store.model[e].extendedBy=store.model[e].extendedBy||{},store.model[e].extendedBy[p]=!0,store.model[e].actions){var u=r.actions=r.actions||{};for(var i in store.model[e].actions)u.hasOwnProperty(i)||(u[i]=store.model[e].actions[i])}}},demoLishObserverBindings:function(e,t,r){for(key in r||(r=e),t){if(e[key]instanceof Object){if(r&&e[key]._setterScope){var o=e[key]._setterScope.indexOf(r);-1!=o&&e[key]._setterScope.splice(o,1)}Object.keys(t[key]).length&&this.demoLishObserverBindings(e[key],t[key],e)}if(e._setterScope&&e!=r){var i=e._setterScope.indexOf(r);-1!=i&&e._setterScope.splice(i,1)}}},establishObserverBindings:function(e,t,r){for(key in r||(r=e),t){if(e[key]instanceof Object)e[key]._bindings||store.$.defProp(e[key],"_bindings",new Set,!1,!0),r&&!e[key]._setterScope&&store.$.defProp(e[key],"_setterScope",[]),-1==e[key]._setterScope.indexOf(r)&&e[key]._setterScope.push(r),e[key]._bindings.add(t[key]),Object.keys(t[key]).length&&this.establishObserverBindings(e[key],t[key],e);e._setterScope||(store.$.defProp(e,"_setterScope",[]),e._setterScope.push(e))}},setData:function(e,t,r,o,i,n,a){var s,l={emit:!1,attr:[],oldRec:{}},d=e.model,c=!1,p=e.record;if(a&&t){var u=e.model._fldGrps.inherit;for(var f in u)if(e.record[u[f].relKey]&&t[u[f].relKey]){if("belongsTo"==u[f].relType)e.model._arrPk.forEach((function(e){delete t[u[f].relKey][e]})),this.setData(e.record[u[f].relKey].$,t[u[f].relKey],void 0,void 0,void 0,n,!0);else for(var h=t[u[f].relKey].length-1;h>=0;h--)e.model._arrPk.forEach((function(e){delete t[u[f].relKey][h][e]})),this.setData(e.record[u[f].relKey][h].$,t[u[f].relKey][h],void 0,void 0,void 0,n,!0);delete t[u[f].relKey]}}if(t&&"object"==typeof t)for(var m in s=[],o=r,t)s.push(m),this.setValue(e,m,t[m],o,l,n),d&&d._properties&&d._properties.hasOwnProperty(m)&&(c=!0);else s=t,this.setValue(e,t,r,o,l,n),d&&d._properties&&d._properties.hasOwnProperty(t)&&(c=!0);return e.emit("set",[e.record,s]),e.model.emit("set",[d._name,e.record,s]),store.emit("set",[d._name,e.record,s]),c&&store.$.establishObserverBindings(p,d._properties),!n&&l.emit&&store.$.changeCallbck(p,l,i),p},changeCallbck:function(e,t,r){var o=[e,t.attr],i=e.$;if(i.emit("change",o),i.model.emit("change",o),store.emit("change",[i.model._name,i.record,t.attr]),r)for(var n in t.oldRec)r[n]=t.oldRec[n];else{for(var a=0;a<t.attr.length;a++){n=t.attr[a];i.undoStack[n]=i.undoStack[n]||[],i.undoStack[n].push(t.oldRec[n])}i.undoStack._order_.push(t.attr)}},setValue:function(e,t,r,o,i,n,a){var s=e.model,l=s._pK,d=e.record;if(t!=s._pK){var c=s.fieldList[t],p=c&&c.opts?1==c.opts.watch:void 0;d.hasOwnProperty(t),d[t];if(!c)return void store.$.cmpSet(d,t,r,void 0,!0);if(!c.mandatory||null!=r&&null!=r&&""!==r){if(c.relType){var u,f,h=c.relType,m={},y=store.modelFor(c.relatedTo),_=y._pK,v=y._pK,g=(b=y.isComp)||y.fieldList[_].type,b=y.isComp,A=(_=y._pK,g=b?"object":y.fieldList[_].type,c&&c.opts?c.opts.polymorphic:void 0);if(this.getRelations(s,c.relKey,y,m),d[t]&&"hasMany"==h){if(u=[],d[t].forEach((function(e){u.push(e.$.pK)})),d[t]===r)return;if(Array.isArray(r)&&r.length===d[t].length){for(var $,L=r.length,E=0,R=0;R<L&&($=r[R],Lyte.isRecord($)?f=$:$&&typeof $==g&&(f=store.$.peekRecord($._type?$._type:c.relatedTo,$)),Lyte.isRecord(f)&&f.$.record===d[t][R]);R++)E++;if(E&&E==L)return}store.$.addOnSave(s._name,d,t,c,l,v),Array.from(d[t]).forEach((function(e){store.$.demolishLink(e,v,d,m.forward.relKey,void 0,void 0,void 0,!0),null!==m.backward&&store.$.demolishLink(d,s._pK,e,m.backward.relKey,m.forward)}))}else if(d[t]&&Lyte.isRecord(d[t])&&"belongsTo"==h){if(u=d[t].$.pK,Lyte.isRecord(r)?f=r:r&&typeof r==g&&(f=store.$.peekRecord(r._type?r._type:c.relatedTo,r)),Lyte.isRecord(f)&&f.$.record===d[t])return;store.$.addOnSave(s._name,d,t,c,l,v);var w=d[t];store.$.demolishLink(w,v,d,m.forward.relKey,void 0,void 0,void 0,!0),null!==m.backward&&store.$.demolishLink(d,s._pK,w,m.backward.relKey,m.forward),store.$.cmpSet(d,t,{},o,!0)}if("hasMany"==h&&store.$.isEmpty(r)){var N=d[t]&&d[t].partial?d[t].partial:void 0;store.$.cmpSet(d,t,[],o,!0),N&&store.$.defProp(d[t],"partial",N),store.$.establishObserverBindings(d,d.$.model._properties),store.$.defArrUtls(d[t]),store.$.defPolyUtls(d[t]),store.$.defUtls(d[t],y,d,t)}if(Array.isArray(r)){if("belongsTo"==h)return this.revertToOldVal(d,t,u,m),void store.$.setRecErr(e,t,"ERR21",r)}else r=[r];var P=[];for(R=0;R<r.length;R++)if(!(this.isEmpty(r[R])||"belongsTo"==h&&this.isEmptyObj(r[R])||"hasMany"==h&&this.isEmptyArray(r[R]))){var C=r[R],O=r[R]&&r[R]._type?r[R]._type:c.relatedTo;if(!b&&r[R]&&typeof r[R]===g){if(null==(C=store.$.peekRecord(r[R]._type?r[R]._type:c.relatedTo,r[R])))this.addToRelate(s._name,d,m,r[R]);else if(C.$&&C.$.isError){P.push({code:"ERR15",message:Lyte.errorCodes.ERR15,error:Object.assign({},C)});continue}}else if(r[R]&&"object"==typeof r[R]){if(C.$&&C.$.isError){P.push({code:"ERR15",message:Lyte.errorCodes.ERR15,error:Object.assign({},C)});continue}if(Lyte.isRecord(C))C=C.$.record;else if(A&&r[R]&&r[R]._type?C=store.$.peekRecord(r[R]._type,store.$.getpKVal(r[R],store.modelFor(r[R]._type))):b&&(C=store.$.peekRecord(r[R]._type?r[R]._type:c.relatedTo,r[R]))||(C=this.newRecord(O,r[R],o?o.skipValidation:void 0)),C.$.isError){P.push({code:"ERR15",data:r[R],message:Lyte.errorCodes.ERR15,error:Object.assign({},C)});continue}}1!=(x=this.establishLink(m.forward,m.backward,d,C,void 0,!!n||void 0))?P.push({code:x,data:r[R],message:Lyte.errorCodes[x]}):store.$.addOnSave(s._name,d,t,c,l,v)}if(P.length&&P.length==r.length)return this.revertToOldVal(d,t,u,m),void("belongsTo"==c.relType?store.$.setRecErr(e,t,P[0]):store.$.setRecErr(e,t,P));if(P.length>1?store.$.setRecErr(e,t,P):store.$.clrRecErr(e,t),!n){var T=d.$._attributes;T.hasOwnProperty(t)||(T[t]=[]),T[t].push({_type:"changed",records:u}),i.emit=!0,i.attr.push(t);var S={};S.records=u,S._type="update",i.oldRec[t]=S;var k=d.$.getInitialValues(t),x=!0;if(k&&Array.isArray(d[t])&&k.length==d[t].length){x=!1;for(R=0;R<k.length;R++)if(!store.$.comparePk(d[t][R],k[R])){x=!0;break}}x||delete T[t]}}else if(r!==d[t]){if(!o||o&&!0!==o.skipValidation){(K=c).any&&Array.isArray(K)||(K=[K]);var D=K.length,j=!0;for(R=0;R<D;R++){var I=K[R];for(var M in I){!0!==(V=Lyte.checkProperty(M,r,t,I[M],I,d,void 0,s._name))&&!0===j&&("object"==typeof V&&(V.value=r),j=V)}}if(!0!==j)return void store.$.setRecErr(e,t,j)}if(n){var B=!1;if(Lyte.Transform[c.type]){var F=Lyte.Transform[c.type];(F.hasOwnProperty("properties")||F.hasOwnProperty("items"))&&(B=!0)}(p&&/^(array|object)$/.test(c.type)||B)&&Lyte.establishObjectBinding(d,t,!0),store.$.cmpSet(d,t,r,o,!0)}else store.$.estAttrs(d,t,r,i,a,o)}else if(r===d[t]&&d.$.isError&&d.$.error[t]){var K,H=!0;(K=c).any&&Array.isArray(K)||(K=[K]);for(D=K.length,j=!0,R=0;R<D;R++){I=K[R];for(var M in I){var V;!0!==(V=Lyte.checkProperty(M,r,t,I[M],I,d,void 0,s._name))&&(j=!1)}}!0!==j&&(H=!1),H&&store.$.clrRecErr(e,t)}}else store.$.setRecErr(e,t,{code:"ERR02",message:Lyte.errorCodes.ERR02,value:r});store.$.checkAttrs(d)}else d[t]!==r&&store.$.setRecErr(e,t,"ERR01",r)},estAttrs:function(e,t,r,o,i,n){var a=e.$._attributes,s=e.$.model,l=a[t],d=a.hasOwnProperty(t);d?(i&&Lyte.cmpData(d?l:i.data,e[t])||r&&"object"==typeof r&&!i&&store.adapter.$.compareObjects(l,r)||l==r)&&delete a[t]:a[t]=i?i.data:this.createCopy(e[t]);var c=e.hasOwnProperty(t),p=i?i.data:e[t];if(!i){var u={};s._properties&&s._properties.hasOwnProperty(t)&&(u[t]=s._properties[t],store.$.demoLishObserverBindings(e,u)),store.$.cmpSet(e,t,r,n,!0)}store.$.clrRecErr(e.$,t),e.$.srtObs&&store.$.changeRelPkMaps(e,void 0,void 0,"sort",t);var f={_type:"update"};f.val=p,c||(f._type="propAdd"),o.emit=!0,o.attr.push(t),o.oldRec[t]=f},checkAttrs:function(e){var t=e.$.model;Object.keys(e.$._attributes).length?(store.$.cmpSet(e.$,"isModified",!0),store.$.changePersist(e,!1),store.$.addDeepNest(e),this.checkAndAddToArray(t.dirty,e.$.pK)):(store.$.cmpSet(e.$,"isModified",!1),store.$.changePersist(e,!0),e.$.isNew||e.$.hasOwnProperty("dN")&&(!e.$.dN||Object.keys(e.$.dN).length)||store.$.removeParentNesting(e),e.$.isNew||this.deleteFromArray(t.dirty,e.$.pK))},checkForCorrectRelation:function(e,t){var r=e.relatedTo;return!!Lyte.isRecord(t)&&(e.opts&&e.opts.polymorphic?!!t.$.model.extend&&e.relatedTo===t.$.model.extend:!(!e||!t)&&r===t.$.model._name)},removeKeys:function(e,t){for(var r in t)if(e.hasOwnProperty(r)){var o=e[r];("belongsTo"===o.type||"hasMany"===o.type&&t[r])&&this.removeNotDefinedKeys(o.relatedTo,t[r],!(!o.opts||!o.opts.polymorphic)||void 0)}else delete t[r]},removeNotDefinedKeys:function(e,t,r){var o=e.fieldList;if(Array.isArray(t))for(var i=0;i<t.length;i++){var n=t[i];this.removeKeys(r&&Lyte.isRecord(n)?n.$.model.fieldList:o,n)}else this.removeKeys(r&&Lyte.isRecord(t)?t.$.model.fieldList:o,t)},add:function(e,t,r,o){var i,n=this.record.$.record,a=n.$.model,s=this.key,l=a.fieldList[s],d={};store.$.getRelations(a,l.relKey,store.modelFor(l.relatedTo),d),Array.isArray(e)||(e=[e]);var c=store.modelFor(d.forward.relatedTo),p=c._pK,u=[],f=[],h=c.isComp;n.$._attributes.hasOwnProperty(s)&&n.$._attributes[s].length&&(i=n.$.getInitialValues(s));for(var m=0;m<e.length;m++){var y=e[m];if(h&&"object"==typeof y&&Object.keys(y).length===c._arrPk.length){if(this.polymorphic&&!t){u.push({code:"ERR22",data:e[m],message:Lyte.errorCodes.ERR22});continue}y=store.$.peekRecord(t||d.forward.relatedTo,y)}if(!h&&c.fieldList[p].type.toLowerCase()==typeof y||h&&"object"==typeof y&&Object.keys(y).length===c._arrPk.length){if(this.polymorphic&&!t){u.push({code:"ERR22",data:e[m],message:Lyte.errorCodes.ERR22});continue}y=store.$.peekRecord(t||d.forward.relatedTo,y)}else"object"!=typeof y||Lyte.isRecord(y)||(y=store.$.newRecord(y._type?y._type:t||l.relatedTo,y,r?r.skipValidation:void 0));var _=this.polymorphic&&t?t:y&&y._type?y._type:void 0;if(null==y)u.push({code:"ERR13",data:e[m],message:Lyte.errorCodes.ERR13});else if(y.$&&y.$.isError)u.push({code:"ERR15",data:e[m],message:Lyte.errorCodes.ERR15,error:y});else if(Lyte.isRecord(y)&&!store.$.hasDuplicateRelation(y,n[s],p,_,c)){y=y.$.record;var v=store.$.establishLink(d.forward,d.backward,n,y);1!=v?u.push({code:v,data:e[m],message:Lyte.errorCodes[v]}):f.push(y)}}if(f.length){var g=n.$._attributes;g[s]?store.$.hasRecordsArrayChanged(n,s,i)?g[s].push({_type:"added",records:f}):(delete n.$._attributes[s],Object.keys(n.$._attributes).length||(store.$.cmpSet(n.$,"isModified",!1),store.$.changePersist(n,!0),delete g[s],n.$.isNew||(store.$.deleteFromArray(a.dirty,n.$.pK),(!n.$.dN||n.$.dN&&!Object.keys(n.$.dN).length)&&store.$.removeParentNesting(n)))):(g[s]=[{_type:"added",records:f}],store.$.cmpSet(n.$,"isModified",!0),store.$.changePersist(n,!1),store.$.checkAndAddToArray(a.dirty,n[a._pK])),store.$.emit("change",n,[s]);var b={_type:"added",records:f};if(o)o[s]=b;else{n.$.undoStack[s]=n.$.undoStack[s]||[],n.$.undoStack[s].push(b),n.$.undoStack._order_.push([s])}}return u.length>0?store.$.setRecErr(n.$,s,u):store.$.clrRecErr(n.$,s),n},remove:function(e,t,r){var o,i=this.record.$.record,n=i.$.model,a=this.key,s=n.fieldList[a],l={};store.$.getRelations(n,s.relKey,store.modelFor(s.relatedTo),l),Array.isArray(e)||(e=[e]);var d,c=store.modelFor(l.forward.relatedTo),p=c._pK,u=c.isComp,f=[],h=[],m=[];i.$._attributes.hasOwnProperty(a)&&i.$._attributes[a].length&&(o=i.$.getInitialValues(a));for(var y=0;y<e.length;y++){var _,v=e[y];if(!u&&c.fieldList[p].type.toLowerCase()==typeof e[y]||u&&"object"==typeof v&&Object.keys(v).length===c._arrPk.length){if(1==this.polymorphic&&!t){f.push({code:"ERR22",data:e[y],message:Lyte.errorCodes.ERR22});continue}d=store.$.peekRecord(t||l.forward.relatedTo,e[y]),_=t}else Lyte.isRecord(e[y])&&(d=e[y].$.record,_=t||(d&&d._type?d._type:void 0));if(d){var g=store.$.getIndex(i[a],p,d.$.get(p),_);store.$.demolishLink(d,p,store.$.peekRecord(n._name,i.$.pK),l.forward.relKey,void 0,void 0,void 0,!0),null!=l.backward&&store.$.demolishLink(i,n._pK,store.$.peekRecord(_||l.forward.relatedTo,d.$.pK),l.backward.relKey,l.forward),h.push(d),m.push(g)}}if(h.length){var b=i.$._attributes;b[a]?store.$.hasRecordsArrayChanged(i,a,o)?b[a].push({_type:"removed",records:h,_indices:m}):(delete i.$._attributes[a],Object.keys(i.$._attributes).length||(store.$.cmpSet(i.$,"isModified",!1),store.$.changePersist(i,!0),delete b[a],i.$.isNew||(store.$.deleteFromArray(n.dirty,i.$.pK),(!i.$.dN||i.$.dN&&!Object.keys(i.$.dN).length)&&store.$.removeParentNesting(i)))):(b[a]=[{_type:"removed",records:h,_indices:m}],store.$.cmpSet(i.$,"isModified",!0),store.$.changePersist(i,!1),store.$.checkAndAddToArray(n.dirty,i[n._pK])),store.$.emit("change",i,[a]);var A={_type:"removed",records:h,_indices:m};if(r)r[a]=A;else{i.$.undoStack[a]=i.$.undoStack[a]||[],i.$.undoStack[a].push(A),i.$.undoStack._order_.push([a])}}f.length>0?store.$.setRecErr(i.$,a,f):store.$.clrRecErr(i.$,a)},filter:function(e,t,r){var o=0;for(var i in t)e[i]===t[i]&&o++;if(o===r)return!0},filterBy:function(e){for(var t=Object.keys(e).length,r=[],o=0;o<this.length;o++)store.$.filter(this[o],e,t)&&r.push(this[o]);return r.filterBy||(store.$.defArrUtls(r),store.$.defUtls(r,this.model)),r},idbSerialize:function(e,t,r,o,i,n){var a=t.forward.relatedTo,s=r._pK,l=o._pK;Array.isArray(e)?e.forEach((function(r,d){Lyte.isRecord(r)&&r.$.inIDB||store.$.checkPresenceInArray(store.$.recStack[a],r[l])?e[d]=r[l]:(store.$.removeBackwardRel(r,t,s,i,!0),store.$.removeSelfCircularReference(o._name,r,n))})):e&&Lyte.isRecord(e)&&(Lyte.isRecord(e)&&e.$.inIDB||this.checkPresenceInArray(store.$.recStack[a],e[l])?e[t.relKey]=e[l]:(this.removeBackwardRel(e,t,s,i,!0),this.removeSelfCircularReference(o._name,e,n)))},idSerialize:function(e,t,r,o,i){var n=t.forward.opts?t.forward.opts.polymorphic:void 0,a=t.forward.relKey,s=e[a=t.forward.relKey],l=store.model[t.backward.relatedTo],d=store.model[t.forward.relatedTo],c=store.$.getpKVal(e,l);if(Array.isArray(s))if(n)e[a]=this.polymorphicToJSON(t.forward,s);else{var p=[];if(o)var u=o[a]=o[a]||[];s.forEach((function(e){if(e.$&&e.$.isNew&&1!=r&&"state"!=r)!0,store.$.rSerialize(e,t,d,l._pK,c,r,u,i),p.push(e);else{if(u){var o={},n="related";e.$.isDeleted&&(n="removed"),store.$.defProp(o,"$",{});var a=o.$,s=t.forward.relatedTo;Object.defineProperties(a,{pkVal:{value:e.$.pK},type:{value:n},model:{value:s},record:{value:store.$.peekRecord(s,e.$.pK)}}),e.$.isDeleted&&(o.$.onlyDetach=!0),u.push(o)}e.$&&!e.$.isDeleted&&p.push(e.$.pK&&"object"==typeof e.$.pK?Object.assign({},e.$.pK):e.$.pK)}})),e[a]=p}else if(s&&Lyte.isRecord(s))if(s.$.isNew&&1!=r&&"state"!=r){if(o)u=o[a]=o[a]||{};u=store.$.rSerialize(s,t,d,l._pK,c,r,u,i),o[a]=u}else n?e[a]=this.polymorphicToJSON(t.forward,s):s.$.isDeleted||(e[a]=s.$.pK&&"object"==typeof s.$.pK?Object.assign({},s.$.pK):s.$.pK)},recordSerialize:function(e,t,r,o,i,n,a,s,l,d){var c=i._pK;if(Array.isArray(r)){if(0==r.length)return delete e[t],0;r=Array.from(r);var p=l[t]=l[t]||[];if(r.length){for(var u=[],f=0;f<r.length;f++)r[f]&&Lyte.isRecord(r[f])&&(this.rSerialize(r[f],o,n,c,a,s,p,d),r[f].$.isDeleted&&(p[f]&&p[f].$&&(p[f].$.onlyDetach=!0),r.splice(f,1),f--));if(u.length)for(var h=0;h<u.length;h++)r.splice(h,1)}}else if(r&&Lyte.isRecord(r)){p=l[t]=l[t]||{};p=this.rSerialize(r,o,n,c,a,s,p,d),l[t]=p}},rSerialize:function(e,t,r,o,i,n,a,s){var l=t.forward.relatedTo,d=(store.model[t.backward.relatedTo],t.forward.opts?t.forward.opts.polymorphic:void 0);if(this.removeBackwardRel(e,t,o,i),a){var c,p={},u=e.$.isNew?"added":e.$.isModified?"modified":e.$.isDeleted?"removed":"related";d&&(c=e.$.model._name,e.$.polymorphicType=c,r=store.model[c]),store.$.defProp(p,"$",{});var f=p.$,h=d?c:l;Object.defineProperties(f,{pkVal:{value:e.$.pK},type:{value:u},model:{value:h},record:{value:store.$.peekRecord(h,e.$.pK)}}),Array.isArray(a)&&a.push(p)}return this.removeSelfCircularReference(r._name,e,n,void 0,p,s),p},partialSerialize:function(e,t,r,o,i,n,a,s,l,d){var c=o.forward,p=i._pK,u=o.forward.relatedTo,f=o.forward.opts?o.forward.opts.polymorphic:void 0;if("hasMany"==c.relType)if(r&&r.partial){var h=r.partial,m=n._pK;if(l&&(L=l[t]=l[t]||[],store.$.defProp(L,"partial",!0)),h){var y,_,v=[],g=this;h.forEach((function(e,t){if(_=t,/^(added|modified)$/.test((y=e).type)){var i="related",l=store.$.getIndex(r,m,_,void 0,store.model[u]);if(-1!=l){var c,h,b,A=r[l];A&&A.$&&(h=Object.assign({},A.$),A=Object.assign({},A),store.$.defProp(A,"$",h)),c=A,f&&A&&(b=A._type?A._type:A.$.model._name,n=store.model[b]);var $=store.$.peekRecord(n._name,_);if(g.removeBackwardRel(A,o,p,a),A.$.isNew)i="added";else if(A.$.isModified){i="modified";var E=store.$.isDirty($,n.relations);c=store.$.updateJSON(A,n,E)}else{E=store.$.isDirty($,n.relations);c=store.$.updateJSON(A,n,E)}if(L){var R={};store.$.defProp(R,"$",{});var w=R.$,N=f?b:u;Object.defineProperties(w,{pkVal:{value:_},type:{value:i},model:{value:f?b:u},record:{value:store.$.peekRecord(N,_)}}),L.push(R)}g.removeSelfCircularReference(n._name,c,s,void 0,R,d),Lyte.isRecord(c)?c.$.partialType=y.type:(store.$.defProp(c,"$",{}),store.$.defProp(c.$,"partialType",y.type),c.$.hasOwnProperty("pK")||store.$.defProp(c.$,"pK",_)),f&&(c.$.polymorphicType=b),v.push(c)}}else if("removed"==y.type){var P={};_&&"object"==typeof _?Object.assign(P,Object.assign({},_)):P[m]=_;$=store.$.peekRecord(n._name,_)||store.$.peekRecord(n._name,_,!0);if(L){R={};store.$.defProp(R,"$",{});w=R.$;if(Object.defineProperties(w,{pkVal:{value:_},type:{value:"removed"},model:{value:f&&y.polymorphicType?y.polymorphicType:u},record:{value:$}}),d){var C="rec"+ ++d.size;P[d.refKey]=C,d.set(C,R)}L.push(R)}store.$.defProp(P,"$",{}),P.$.partialType="removed",f&&y.polymorphicType&&(P.$.polymorphicType=y.polymorphicType),P.$.hasOwnProperty("pK")||(P.$.pK=_),v.push(P)}})),v.length?r=e[t]=v:delete e[t]}}else delete e[t];else if("belongsTo"==c.relType&&r&&Lyte.isRecord(r)){var b;f&&r&&(b=r._type?r._type:r.$.model._name,n=store.model[b]),this.removeBackwardRel(r,o,p,a);var A,$=r;if(r.$.isNew?this.removeBackwardRel(r,o,p,a):(A=store.$.isDirty(r,n.relations),$=store.$.updateJSON(r,n,A)),l){var L=l[t]=l[t]||{},E=r.$.isNew?"added":r.$.isModified?"modified":"related";store.$.defProp(L,"$",{});var R=L.$,w=f?b:u;Object.defineProperties(R,{pkVal:{value:r.$.pK},type:{value:E},model:{value:w},record:{value:store.$.peekRecord(w,r.$.pK)}})}f&&($.$||store.$.defProp($,"$",{}),$.$.polymorphicType=b),this.removeSelfCircularReference(n._name,$,s,void 0,L,d),r=e[t]=$}},removeSelfCircularReference:function(e,t,r,o,i,n,a,s){var l=store.model[e],d=l.fieldList,c=(l.extend,store.$.getpKVal(t,l));store.$.recStack[e]=store.$.recStack[e]||[];store.$.checkAndAddToArray(store.$.recStack[e],c);var p,u=store.$.peekRecord(e,c),f=Lyte.isRecord(u)?u.$.partial:void 0,h=t&&t.$?t.$.polymorphicType:void 0,m=new Map;if(m.set(t,c),n){p="rec"+ ++n.size;var y={};store.$.defProp(y,"$",{pkVal:u.$.pK,model:u.$.model._name}),n.set(p,y)}var _=store.$.getFromCB("serializer",e,"serializeEmptyRelation");for(var v in t){var g,b,A,$,L,E=d[v],R=!1;if(!(!("create"==o||Lyte.isRecord(t)&&t.$.isNew)||l._pK!=v)&&1!=r)delete t[v];else if(E)if(E&&"relation"!=E.type&&!r&&Lyte.Transform[E.type]&&Lyte.Transform[E.type].serialize&&t.hasOwnProperty(v))t[v]=Lyte.Transform[E.type].serialize(t[v],v,u);else{if(f&&f.hasOwnProperty(v)){var w={},N=store.model[E.relatedTo]._pK,P=!1;if(f[v].forEach((function(e,r){if((!0===_||Array.isArray(_)&&_.indexOf(E.relKey))&&E.opts&&/^(id|record)$/.test(E.opts.serialize)?(t[v]=null,P=!0):"partial"==E.opts.serialize&&(w[N]=r,store.$.defProp(w,"$",{}),store.$.defProp(w.$,"partialType","removed"),store.$.defProp(w.$,"pK",r),t[v]=w,P=!0),i){var o=i[v]=i[v]||{};store.$.defProp(o,"$",{});var n=o.$;Object.defineProperties(n,{pkVal:{value:r},type:{value:"removed"},model:{value:E.relatedTo},parent:{value:u},record:{value:store.$.peekRecord(E.relatedTo,r)}}),E&&E.opts&&/^(id|record)$/.test(E.opts.serialize)&&Object.defineProperties(n,{onlyDetach:{value:!0},relKey:{value:v}})}})),P)continue}if(1!=r&&"state"!=r||!t[v]||"object"!=typeof t[v]||!E||"relation"==E.type){if(r&&"isClone"==r.type&&t[v]&&E&&"relation"==E.type&&((L=!(!E.opts||!E.opts.inherit))||delete t[v]),t[v]&&E&&"relation"==E.type){if(b=E.relatedTo,$=E.relType,L=!(!E.opts||!E.opts.inherit),null==(A=store.modelFor(b)))continue;var C=E.relKey,O={};R?this.getRelations(g,E.relKey,A,O):this.getRelations(l,C,A,O);var T=E.opts,S=T?T.serialize:void 0,k=t[C];if("idb"==r)store.$.idbSerialize(k,O,l,A,c,r);else if(a&&L)store.$.toChildJSON(b,$,t[v],v,e,m,s),"belongsTo"==$&&(t[v]=Object.assign({},t[v]),t[v][store.modelFor(b)._pK]==c&&b==e&&(t[v]=c));else if(r&&!a||a&&!L||"id"==S)store.$.idSerialize(t,O,r,i,n);else if("record"===S){if(0==store.$.recordSerialize(t,v,k,O,l,A,c,r,i,n)&&"hasMany"===$&&(!0===_||Array.isArray(_)&&_.indexOf(E.relKey))&&Array.isArray(u[v])&&u[v].partial&&u[v].partial.size){var x=!0;if(u[v].partial.forEach((function(e){"removed"!==e.type&&(x=!1)})),x){t[v]=[];continue}}}else{if("partial"!==S){delete t[C];continue}store.$.partialSerialize(t,v,k,O,l,A,c,r,i,n)}((k=t?t[C]:void 0)&&"hasMany"==$&&Array.isArray(k)&&0==k.length||"belongsTo"==$&&"object"==typeof k&&0==Object.keys(k).length)&&((!0===_||Array.isArray(_)&&_.indexOf(E.relKey))&&"hasMany"==$&&E.opts&&/^(id|record)$/.test(E.opts.serialize)?t[C]=[]:delete t[C])}}else t[v]=Lyte.deepCopyObject(t[v])}else h&&(g=store.modelFor(h),E=g.fieldList[v],R=!0),s||delete t[v]}if("state"==r){var D=u.$.model.fieldList;for(var v in D)t.hasOwnProperty(v)||("relation"==D[v].type&&"hasMany"==D[v].relType?t[v]=[]:t[v]=void 0)}if(n){var j=n.refKey;t[j]=p}},removeBackwardRel:function(e,t,r,o,i){if(i)delete e[t.backward.relKey];else if(null!=t.backward){var n=e[t.backward.relKey];if(Array.isArray(n)){for(var a=0;a<n.length;a++)if(this.comparePk(n[a],o))return n.splice(a,1),void(0==n.length&&delete e[t.backward.relKey])}else n&&Lyte.isRecord(n)&&this.comparePk(n,o)&&delete e[t.backward.relKey]}},polymorphicToJSON:function(e,t){var r=e.opts;if(r&&r.polymorphic){if(Array.isArray(t)){var o=[];return t.forEach((function(e){o.push(store.$.polyToJSON(e))})),o}return store.$.polyToJSON(t)}},polyToJSON:function(e){var t=e.$.model;!t.hasOwnProperty("fieldList")&&t._name&&(t=store.model[t._name]);var r=t?t._pK:void 0,o={},i=e.$.pK;return"object"==typeof i?o=Object.assign({},i):o[r]=i,o._type=e._type?e._type:e.$.model._name,o},toChildJSON:function(e,t,r,o,i,n,a){var s=store.modelFor(e),l=s.fieldList,d={};Array.isArray(r)||(r=[r]);for(var c=0;c<r.length;c++){if(!n.get(r[c])){var p=store.$.getpKVal(r[c],s);n.set(r[c],p)}if(!a)for(var u in r[c])l.hasOwnProperty(u)||delete r[c][u];for(var f in s.relations)for(var h=0;h<s.relations[f].length;h++){var m=s.relations[f][h].relKey?s.relations[f][h].relKey:void 0;if(m&&l[m]&&"relation"==l[m].type&&r[c][l[m].relKey])if(r[c][l[m].relKey]&&l[m].opts&&l[m].opts.inherit){if("hasMany"==l[m].relType&&r[c][l[m].relKey])for(var y=0;y<r[c][l[m].relKey].length;y++)if(p=store.$.getpKVal(r[c][l[m].relKey][y],store.modelFor(l[m].relatedTo)),n.get(r[c][l[m].relKey][y])){if(Lyte.isRecord(r[c][l[m].relKey][y])&&n.get(r[c][l[m].relKey][y])){if("object"==typeof p)r[c][l[m].relKey][y]=p;else{var _={};_[store.modelFor(l[m].relatedTo)._pK]=p,r[c][l[m].relKey][y]=_}r[c][l[m].relKey][y]="object"==typeof p?p:{[store.modelFor(l[m].relatedTo)._pK]:p}}}else n.set(r[c][l[m].relKey][y],p),store.$.toChildJSON(l[m].relatedTo,l[m].relType,r[c][l[m].relKey][y],l[m].relKey,l[m].relatedTo,n,a),"object"==typeof r[c][l[m].relKey][y]&&(r[c][l[m].relKey][y]=Object.assign({},r[c][l[m].relKey][y]));else"belongsTo"==l[m].relType&&r[c][l[m].relKey]&&(p=store.$.getpKVal(r[c][l[m].relKey],store.modelFor(l[m].relatedTo)),n.get(r[c][l[m].relKey])?r[c][l[m].relKey]="object"==typeof p?p:{[store.modelFor(l[m].relatedTo)._pK]:p}:(n.set(r[c][l[m].relKey],p),store.$.toChildJSON(l[m].relatedTo,l[m].relType,r[c][l[m].relKey],l[m].relKey,l[m].relatedTo,n,a),r[c][l[m].relKey]=Object.assign({},r[c][l[m].relKey])));0==Object.keys(r[c][l[m].relKey]).length&&delete r[c][l[m].relKey]}else(Lyte.isRecord(r[c][l[m].relKey])||"hasMany"==l[m].relType&&Lyte.isRecord(r[c][l[m].relKey][0]))&&(this.getRelations(s,l[m].relKey,store.modelFor(l[m].relatedTo),d),store.$.idSerialize(r[c],d,!0))}Lyte.isRecord(r[c])&&(r[c]=Object.assign({},r[c]))}},toJSONObj:function(e,t,r,o,i,n,a){var s,l,d=e._name,c=(e._pK,e._fldGrps.inherit&&Object.keys(e._fldGrps.inherit).length);if(s=1!=r&&"state"!=r||n&&(!n||c)?Lyte.deepCopyObject(t):Object.assign({},t),Lyte.isRecord(s))l=s.$.pK;else{if(!store.$.getpKVal(s,e))return;if(!store.$.peekRecord(d,store.$.getpKVal(s,e)))return;l=store.$.peekRecord(d,store.$.getpKVal(s,e)).$.pK}var p,u=i?i.obj:void 0;return u&&!u.has(l)&&(u.set(l,{}),p=u.get(l)),this.removeSelfCircularReference(d,s,r,o,p,i&&i.ref?i.ref:void 0,n,a),"idb"==r&&this.removeNotNeededKeys(d,s,e.idb),s},toJSON:function(e,t,r,o,i,n,a){var s,l=store.model[e];if(store.$.recStack={},Array.isArray(t)){for(var d=[],c=0;c<t.length;c++)s=this.toJSONObj(l,t[c],r,o,i,n,a),d.push(s);return d}return t&&("object"==typeof t||Lyte.isRecord(t))&&(s=this.toJSONObj(l,t,r,o,i,n,a)),store.$.recStack={},s},createCopy:function(e){if(Array.isArray(e)){if(e.save){for(var t=[],r=0;r<e.length;r++){var o=Lyte.deepCopyObject(e[r]);t.push(o)}return t}}else if(e&&(Lyte.isRecord(e)||"object"==typeof e))return Lyte.deepCopyObject(e);return e},compareRecords:function(e,t,r,o,i){r=i._arrPk;if(Lyte.isRecord(e)&&Lyte.isRecord(t)&&r.length){if(o&&e._type&&o!==e._type)return!1;for(var n=r.length,a=0;a<n;a++){var s=r[a];if(e[s]&&t[s]&&e[s]!==t[s])return!1}return!0}return!1},hasRecordInArray:function(e,t,r,o,i){if(Lyte.isRecord(t)&&r)for(var n=e.length,a=0;a<n;a++){var s=e[a];if(!o||s._type===o)if(i){if(this.compareRecords(s,t,r,void 0,t.$.model))return!0}else if(o&&s._type&&o===t._type&&s[r]===t[r]||s[r]===t[r])return!0}return!1},hasDuplicateRelation:function(e,t,r,o,i){var n=i.isComp;return Array.isArray(t)?n||t.isPolymorphic||!t._recMap?this.hasRecordInArray(t,e,r,o,n):t._recMap.get(e[r]):!(!t||!Lyte.isRecord(t))&&this.compareRecords(e,t,r,o,i)},checkPresenceInArray:function(e,t){return e&&e.some((function(e){return e===t}))},checkAndAddToArray:function(e,t){if(this.checkPresenceInArray(e,t))return-1;e.push(t)},deleteFromArray:function(e,t){var r=e.indexOf(t);-1!=r&&e.splice(r,1)},genPk:function(e,t,r){var o;e.forEach((function(e){o=r[e].type;var i=t[e]=Math.floor(1e5*Math.random()+1);"string"==o&&(t[e]=i.toString())}))},generateRandomPk:function(e,t,r,o){for(this.genPk(r,t,o);this.isDuplicateRecord(e,t,r.toString());)this.genPk(r,t,o)},pkPresence:function(e,t){var r=!0;return t.forEach((function(t){e.hasOwnProperty(t)&&e[t]||(r=!1)})),r},newRecord:function(e,t,r){var o=store.modelFor(e);if(void 0===o)return Lyte.warn("LD02","Model",e),new error1(void 0,void 0,Lyte.getErrorMessage("LD02","Model",e));if(void 0===t&&(t={}),t&&"object"!=typeof t)return Lyte.warn("LD25",t),new error1(void 0,void 0,Lyte.getErrorMessage("LD25",t));var i=o.fieldList,n={},a=new error1,s=o._arrPk;for(var l in this.pkPresence(t,s)?this.isDuplicateRecord(o,t,s)&&store.$.setError(a,s,{code:"ERR16",message:Lyte.errorCodes.ERR16}):this.generateRandomPk(o,t,s,i),i){"hasMany"==(R=i[l]).relType&&(n[l]=[]);var d=t[l];if("relation"!=R.type&&(void 0!==d&&""!==d||R.hasOwnProperty("default")&&(d=n[l]=store.$.getDefaultVal(n,R.default)),!r)){var c=R;c.any&&Array.isArray(c)||(c=[c]);for(var p=c.length,u=!0,f=0;f<p;f++){var h=c[f];for(var m in h){1!=(E=Lyte.checkProperty(m,d,l,h[m],h,t,n,e))&&!0===u&&("object"==typeof E&&(E.value=d),u=E)}}!0!==u&&store.$.setError(a,l,u)}}for(var y in t)n[y]=t[y];n=new Record(e,n),store.$.cmpSet(n.$,"isNew",!0),store.$.changePersist(n,!1);var _=o.relations;for(var v in _){var g=_[v];for(f=0;f<g.length;f++){var b=g[f],A=b.relKey,$=b.opts?b.opts.polymorphic:void 0;if(n&&n[A]){var L=t[A];n[A]=void 0;var E,R=g[f],w={};if(1!=(E=this.getRelations(o,R.relKey,store.modelFor(R.relatedTo),w))){store.$.setError(a,R.relKey,{code:E,data:g,message:Lyte.errorCodes[E]});continue}var N=store.modelFor(R.relatedTo),P=N._pK,C=N.isComp,O=C?void 0:N.fieldList[N._pK].type;if(Array.isArray(L)){if("belongsTo"==g[f].relType){store.$.setError(a,R.relKey,{code:"ERR21",data:L,message:Lyte.errorCodes.ERR21});continue}}else L=[L];a[R.relKey]=[];for(var T=0;T<L.length;T++){var S=void 0,k=R.relatedTo;if(L[T]&&Lyte.isRecord(L[T]))S=L[T].$.record;else if(C&&"object"==typeof L[T]){var x;if(-1!=(x=store.$.getIndex(N.data,P,store.$.getpKVal(L[T],N))))S=N.data[x];else{if($){if(!L[T]||!L[T].hasOwnProperty("_type")){store.$.setError(a,R.relKey,{code:"ERR22",data:L[T],message:Lyte.errorCodes.ERR22});continue}k=L[T]._type}S=this.newRecord(k,L[T])}}else if(L[T]&&typeof L[T]==O.toLowerCase())S=store.$.peekRecord(k,L[T]);else if(L[T]&&"object"==typeof L[T]){if($){if(!L[T]||!L[T].hasOwnProperty("_type")){store.$.setError(a,R.relKey,{code:"ERR22",data:L[T],message:Lyte.errorCodes.ERR22});continue}k=L[T]._type}S=this.newRecord(k,L[T])}S&&S.$&&S.$.isError?store.$.setError(a,R.relKey,{code:"ERR15",data:L[T],message:Lyte.errorCodes.ERR15,error:Object.assign({},S)}):S&&S.$&&!S.$.isError&&1!=(E=this.establishLink(w.forward,w.backward,n,S,void 0,false))&&store.$.setError(a,R.relKey,{code:E,data:L[T],message:Lyte.errorCodes[E]})}if(0==a[R.relKey].length&&delete a[R.relKey],"hasMany"==g[f].relType){var D=A;null==n[D]&&(n[D]=[]),n[D].add||($&&store.$.defProp(n[D],"polymorphic",!0),store.$.defArrUtls(n[D]),store.$.defUtls(n[D],store.modelFor(g[f].relatedTo),n,D),store.$.defPolyUtls(n[D]))}}}}if(a&&a.$&&Object.keys(a.$.error).length>0)return a;var j=store.$.toRelate[o._name],I=n.$.pK;if(j&&j.has(I)&&(store.$.establishToRelated(n,j.get(I)),j.delete(I)),o.didLoad){var M=o.didLoad;for(f=0;f<M.length;f++)M[f].apply(n)}return this.handleArrOp(o.data,"push",n),this.checkAndAddToArray(o.dirty,n.$.pK),o.emit("add",[n]),store.emit("add",[o._name,n]),r&&(n.$.validatedOnCreate=!1),n},toInsertData:function(e,t,r,o){var i=store.model[e],n=this.insertIntoStore(e,t[e],r,!0,void 0,void 0,void 0,void 0,o);return i&&delete i.rel,n},insertIntoStore:function(e,t,r,o,i,n,a,s,l){if(Array.isArray(t)){y=[];for(var d=0;d<t.length;d++)y[d]=this.insertIntoStore(e,t[d],r,o,i),y[d]&&y[d].$&&y[d].$.isError&&(y.$=y.$||store.$.defProp(y,"$",{}),store.$.cmpSet(y.$,"isError",!0))}else if(t&&"object"==typeof t&&Object.keys(t).length){var c=store.modelFor(e);if(t._type&&c.extendedBy&&(c=c.extendedBy[t._type]?store.modelFor(t._type):void 0),!c){var p=store.modelless,u=p[e]=p[e]||{};if(l){if(u._pK&&u._pK!==l)return void Lyte.error("");u._pK=l,u._arrPk=[l]}else u._pK=l="id",u._arrPk=[l];u.data=u.data||[],u.data.modelless||(store.$.defProp(u.data,"modelless",!0),store.$.defProp(u.data,"pK",u._pK));var f=store.$.getInd(u.data,l,t[l]);return-1==f?store.$.handleArrOp(u.data,"push",t):store.$.handleArrOp(u.data,"replaceAt",t,f),t}if(Lyte.isRecord(t)&&!s)return;if(a&&t&&c){var h=c.relations;for(var m in h){h[m].forEach((function(e){var r=e.relKey,o=e.relType;if("hasMany"==o&&t.hasOwnProperty(r)&&Array.isArray(t[r])&&t[r].length){var i=t[r],n=[];i.forEach((function(e){Lyte.isRecord(e)?n.push(e.$.pK):n.push(e)})),t[r]=n}else"belongsTo"==o&&t.hasOwnProperty(r)&&Lyte.isRecord(t[r])&&(t[r]=t[r].$.pK)}))}}if(s){_=new Record(c._name,t,c._pK,s);var y=this.validateAndPush(c,_,void 0,s)}else if(this.isDuplicateRecord(c,t,c._pK))(y=this.validateAndMerge(c,t,i))&&y.data?y=y.data:y&&y.type&&Lyte[y.type].apply(Lyte,y.args||[]);else{var _=new Record(c._name,t);c.data.push(_);var v=store.$.toRelate[c._name],g=_.$.pK;r&&(store.$.saveParent=_),y=this.validateAndPush(c,_,i),v&&v.has(g)&&(store.$.establishToRelated(_,v.get(g)),v.delete(g))}r&&(store.$.saveParent=void 0),o&&(store.$.recStack={})}return y},removeFromStore:function(e,t,r,o,i,n,a){var s=e.data,l=e._name;if(0!=s.length){Array.isArray(t)||(t=[t]);for(var d=e._pK,c=0;c<t.length;c++){var p=this.getIndex(s,d,t[c]);if(-1!=p){var u,f=s[p],h=f.$.pK,m=e.relations;if(f.$.isNew&&(n=i=void 0,r=!0),Object.keys(m).length&&this.toDemolishRelation(e,p,o,n,i,a),!0!==i&&!1!==n&&(u=this.handleArrOp(s,"removeAt",void 0,p,1),e.emit("remove",[u[0]]),store.emit("remove",[e._name,u[0]]),e._properties&&store.$.demoLishObserverBindings(f,e._properties)),!0===r){store.$.cmpSet(f.$,"isUnloaded",!0);var y=f.$.__scpObj;for(var _ in y){var v=y[_].split("_"),g=Lyte.nestScp[v[0]];g&&Lyte.removeNestScp(g._data,v[0],v[1],void 0,f,void 0,void 0,{model:l,pK:f.$.pK,attr:_})}if(A=store.model.cachedQueries){if((L=A[l])&&L.length)for(var b=L.length-1;b>=0;b--){if((E=L[b]).hasDeletedRecords)if(E.data)-1!==(R=E.data[l].indexOf(f))&&L.splice(b,1)}}}if(1!=n){var A,$=u?u[0]:f;if(!r)if(store.$.cmpSet($.$,"isDeleted",!0),store.$.changePersist($,!0),!0!==i&&!1!==n&&($.$.isNew||$.$.isModified)&&store.$.deleteFromArray(e.dirty,$.$.pK),$.$.isNew||store.$.addTo_Del(e,$,p),A=store.model.cachedQueries){var L;if((L=A[l])&&L.length)for(b=L.length-1;b>=0;b--){var E,R;if((E=L[b])&&E.data)-1!=(R=E.data[l].indexOf(f))&&(E.hasDeletedRecords=!0)}}Array.isArray(e.dirty)&&-1!=(R=e.dirty.indexOf(h))&&e.dirty.splice(R,1)}}}}},getIndex:function(e,t,r,o,i){return(i?i.isComp:t.split(",").length>1)?this.getCompInd(e,r,o,i):this.getInd(e,t,r,o)},getCompInd:function(e,t,r,o){for(var i=0;e&&i<e.length;i++){var n=e[i];if((!r||e[i]._type===r)&&store.adapter.$.compareObjects(store.$.getpKVal(n,o),t))return i}return-1},getInd:function(e,t,r,o){for(var i=0;e&&i<e.length;i++){var n=e[i];if((!o||n._type===o)&&(n[t]==r||Lyte.isRecord(n)&&n.$.get&&n.$.get(t)==r))return i}return-1},isDuplicateRecord:function(e,t){var r=e.data,o=e._pK,i=e.isComposite;if(r.length){if(!i&&e.data._recMap){var n=t[o];return void 0!==n&&void 0!==e.data._recMap.get(n.toString())}return r.some((function(r){if(store.adapter.$.compareObjects(store.$.getpKVal(t,e),store.$.getpKVal(r)))return!0}))}return!1},validateAndPush:function(e,t,r,o){e.rel||(e.rel={});for(var i=e._arrPk,n=i.length,a=0;a<n;a++){var s=i[a];if(!t.hasOwnProperty(s))return d=e.data.indexOf(t),e.data.splice(d,1),new error1(s,{code:"ERR23",data:t,message:Lyte.errorCodes.ERR23});if(null==t[s]||null==t[s])return d=e.data.indexOf(t),e.data.splice(d,1),new error1(s,{code:"ERR26",data:t,message:Lyte.errorCodes.ERR26})}if(o)return t=this.validateJSON(e,t,void 0,void 0,void 0,o);var l=null==t.$.pK||"object"==typeof t.$.pK?t.$.pK:t.$.pK.toString();e.data._recMap.set(l,t),t=this.validateJSON(e,t,void 0,void 0,r);var d=e.data.indexOf(t);if(e.data.splice(d,1),this.handleArrOp(e.data,"push",t),e.didLoad){var c=e.didLoad;for(a=0;a<c.length;a++)c[a].apply(t)}return e.emit("add",[t]),store.emit("add",[e._name,t]),t},validateAndMerge:function(e,t,r,o){if(e.rel||(e.rel={}),void 0===store.$.getpKVal(t,e))return{type:"error",args:["LD28",e._name,Lyte.isRecord(t)?t:JSON.stringify(t)]};var i=store.$.peekRecord(e._name,store.$.getpKVal(t,e));if(!i||!Lyte.isRecord(i))return{type:"error",args:["LD04",Lyte.isRecord(t)?t:JSON.stringify(t)]};if(this.mergeData(i,t,r,o),e.didLoad)for(var n=e.didLoad,a=0;a<n.length;a++)n[a].apply(i);return{data:i}},mergeData:function(e,t,r,o){if(e&&t){var i,n=e.$.model,a=!1;for(var s in o&&store.adapter.$.mergeError(n,e,t),t)if(i=n.fieldList[s]){if("relation"!=i.type){var l=store.$.getDsrzEmpData(i,n._name),d=!l&&t[s];t.hasOwnProperty(s)&&(d||l)&&Lyte.Transform.hasOwnProperty(i.type)&&Lyte.Transform[i.type].hasOwnProperty("deserialize")&&(t[s]=Lyte.Transform[i.type].deserialize(t[s],s,n._name,store.$.getpKVal(t,n)));var c={};n._properties&&n._properties.hasOwnProperty(s)&&(c[s]=n._properties[s],store.$.demoLishObserverBindings(e,c)),store.$.cmpSet(e,s,t[s],void 0,!0),n._properties&&n._properties.hasOwnProperty(s)&&(a=!0)}else if(i&&"relation"==i.type){var p={},u={};store.$.getRelations(e.$.model,s,store.modelFor(i.relatedTo),u);var f=store.model[u.forward.relatedTo];if("hasMany"==i.relType&&r&&r[s]&&r[s].replace){var h=e[s]._recMap,m=[];h.forEach((function(e,t){m.push(t)})),m.forEach((function(t){store.$.peekRecord(i.relatedTo,t).$.isNew?store.$.removeFromStore(store.modelFor(i.relatedTo),t,!0):(store.$.demolishLink(store.$.peekRecord(i.relatedTo,t),store.$.peekRecord(i.relatedTo,t).$.model._pK,e,u.forward.relKey,void 0,void 0,!0,!0),null!=u.backward&&store.$.demolishLink(e,n._pK,store.$.peekRecord(i.relatedTo,t),u.backward.relKey,u.forward,void 0,!0,!0))})),delete r[s]}var y=this.compareRelations(e,t,s,i,r?r[s]:void 0,p,o);this.mergeRecords(p,y,n,f,e,s,t,u,r,o)}}else"$"!=s&&store.$.cmpSet(e,s,t[s],void 0,!0);a&&store.$.establishObserverBindings(e,n._properties)}},mergeRecords:function(e,t,r,o,i,n,a,s,l,d){if(!s){s={};store.$.getRelations(r,n,o,s)}var c=r._pK;if(("hasMany"==s.forward.relType&&store.$.isEmptyArray(a[n])&&Array.isArray(e.remove)&&i&&i[n]&&e.remove.length!=i[n].length||i&&!i[n]&&Array.isArray(a[n]))&&(store.$.cmpSet(i,n,[],void 0,!0),store.$.establishObserverBindings(i,i.$.model._properties),store.$.defArrUtls(i[n]),store.$.defPolyUtls(i[n]),store.$.defUtls(i[n],o,i,n)),Array.isArray(e.add)&&e.add.forEach((function(e){store.$.createAndRelate(r,o,i,n,e,s,l)})),Array.isArray(e.remove)&&e.remove.forEach((function(e){var t=e.pK,r=e.model;store.$.demolishLink(i,c,store.$.peekRecord(r,t),s.backward.relKey,s.forward,s.backward,!0),store.$.demolishLink(store.$.peekRecord(r,t),store.modelFor(r)._pK,i,s.forward.relKey,s.backward,s.forward,!0)})),i&&i.hasOwnProperty(n)&&(store.$.deleteDeepNest(i,n),Array.isArray(i[n])&&i[n].hasOwnProperty("partial"))){var p=i[n].partial,u=[];p.forEach((function(e,t){u.push(t),i[n].partial.delete(t)}))}switch(t){case 0:Lyte.isRecord(i[n])&&(store.$.demolishLink(i,c,i[n],s.backward.relKey,s.forward,s.backward,!0),store.$.demolishLink(i[n],o._pK,i,s.forward.relKey,s.backward,s.forward,!0)),store.$.createAndRelate(r,o,i,n,a[n],s,l);break;case 1:default:break;case 2:this.mergeData(i[n],a[n],void 0,d)}},compareRelations:function(e,t,r,o,i,n,a){var s=store.modelFor(o.relatedTo),l=s._pK;if("belongsTo"==o.relType)return i&&"removed"===i.$.type&&(!t||t&&store.$.comparePk(e,store.$.getpKVal(t,s)))?1:this.compareRecordWithObj(e[r],t[r],l,i,a);var d=!1;if(i&&i.partial&&(d=!0),!d&&(!e.hasOwnProperty(r)||e&&e.hasOwnProperty(r)&&(store.$.isEmpty(e[r])||store.$.isEmptyArray(e[r]))))return n?void(t[r]||[]).forEach((function(e){(n.add=n.add||[]).push(e)})):0;for(var c=t[r]?t[r].length:0,p=[],u=0;u<c;u++){var f=t[r][u];if(!i||!i[u]||"removed"!=i[u].$.type){var h=this.getIndex(e[r],l,"object"==typeof f?store.$.getpKVal(f,s):f);if(-1!=h){p.push(e[r][h].$.pK);var m=this.compareRecordWithObj(e[r][h],f,l,i?i[u]:void 0,a);1==m&&0,2==m?this.mergeData(e[r][h],f,i?i[u]:void 0,a):0==m&&0}else{n&&(n.add=n.add||[]).push(f),0}}}n&&!d&&(e[r]||[]).forEach((function(e){var t=e.$.pK;-1==p.indexOf(t)&&(n.remove=n.remove||[]).push({pK:t,model:e.$.model._name})}))},compareRecordWithObj:function(e,t,r,o,i){if(!e||!Lyte.isRecord(e))return 0;var n=e.$.model,a=(n._pK,n.isComp),s=n.fieldList;if(!a&&typeof t==(d=n.fieldList[r]).type)return e[r]==t?1:0;if(t&&"object"==typeof t){if(!store.$.comparePk(e,store.$.getpKVal(t,n)))return 0;if(Lyte.isRecord(t)&&t===e)return 1;for(var l in t){var d;if(d=s[l]){if("relation"==d.type){var c={},p=this.compareRelations(e,t,l,d,o?o[l]:void 0,c,i);this.mergeRecords(c,p,n,store.modelFor(d.relatedTo),e,l,t,void 0,o)}else if(e[l]!=t[l])return 2}else if(e[l]!=t[l])return 2}return 1}return 0},validateJSON:function(e,t,r,o,i,n){var a=o?o.toValidate:void 0,s=a&&Object.keys(a).length?a:e.fieldList,l=!!e.extend;for(var d in t)if(!r||-1!=r.indexOf(d)){var c=s[d];if(c){if("relation"==c.type&&t[d]){var p=o&&o.toPartialAdd?o.toPartialAdd[d]:void 0;if(1!=(_=this.handleRelation(d,e,c,t,p,i,n)))return new error1(d,{code:_,data:t,message:Lyte.errorCodes[_]});"hasMany"!=c.relType||t[d].add||(store.$.defArrUtls(t[d]),store.$.defPolyUtls(t[d]),store.$.defUtls(t[d],store.model[c.relatedTo],t,d))}else if(c.type){var u=c;void 0===t[d]&&u.default&&(t[d]=store.$.getDefaultVal(t,u.default));var f=store.$.getDsrzEmpData(c,e._name),h=!f&&t[d];t.hasOwnProperty(d)&&(h||f)&&Lyte.Transform.hasOwnProperty(u.type)&&Lyte.Transform[u.type].hasOwnProperty("deserialize")&&(t[d]=Lyte.Transform[u.type].deserialize(t[d],d,e._name,store.$.getpKVal(t,e)))}}else if(l){var m=store.modelFor(e.extend),y=m.fieldList[d];if(y&&"relation"==y.type){var _;p=o&&o.toPartialAdd?o.toPartialAdd[d]:void 0;if(1!=(_=this.handleRelation(d,m,y,t,p)))return new error1(d,{code:_,data:t,message:Lyte.errorCodes[_]});"hasMany"!=y.relType||t[d].add||(store.$.defArrUtls(t[d]),store.$.defPolyUtls(t[d]),store.$.defUtls(t[d],m,t,d))}}}return t},handleRelation:function(e,t,r,o,i,n,a){var s={};if(t.rel.hasOwnProperty(e))s=t.rel[e];else{var l=this.getRelations(t,e,store.modelFor(r.relatedTo),s);if(!0!==l)return l;t.rel[e]=s}return this.solveRelation(s,t,store.modelFor(r.relatedTo),e,o,i,n,a)},getRelations:function(e,t,r,o){if(null==r)return Lyte.error("LD05",e.fieldList[t].relatedTo,t,e._name),"ERR11";if(o.forward=e.fieldList[t],o.backward=this.getBackwardRel(e,o.forward,r),void 0===o.backward){var i={type:"relation",relatedTo:e._name,dummy:o.forward.relKey,relKey:void 0};r.relations[e._name]=r.relations[e._name]||[],r.relations[e._name].push(i),o.backward=i}return!0},getBackwardRel:function(e,t,r){var o,i,n;if(t.opts){if(o=t.opts.inverse,i=t.opts.polymorphic,null===o)return;if(i){var a=r.extendedBy;if(a)for(var s in a){var l=store.modelFor(s);if(l.relations[e._name]){r=l;break}}}}if(o&&""!=o)n=o;else{var d,c=r.relations[e._name],p=store.modelFor(e.extend);!c&&p&&r.relations[p._name]&&(c=r.relations[p._name],d=!0),n=!c||1!=c.length||c[0].opts&&c[0].opts.inverse&&c[0].opts.inverse!==t.relKey||d&&!(d&&c[0].opts&&c[0].opts.polymorphic)?void 0:c[0].relKey}if(!n){var u=r.relations[e._name],f=store.modelFor(e.extend);if(!u&&f&&r.relations[f._name]&&r.relations[f._name].opts&&r.relations[f._name].opts.polymorphic&&(u=r.relations[f._name]),t.dummy&&u){for(var h=0;h<u.length;h++)if(u[h]&&u[h].relKey&&u[h].relKey==t.dummy){n=u[h].relKey;break}}else if(u)for(h=0;h<u.length;h++){if(u[h]&&u[h].opts&&u[h].opts.inverse&&u[h].opts.inverse===t.relKey){n=u[h].relKey;break}if(u[h]&&u[h].dummy&&u[h].dummy==t.relKey){n=u[h];break}}}return n&&n.dummy?n:n&&e._fldGrps.inverse.hasOwnProperty(t.relatedTo)&&!t.dummy&&n&&e.relations[t.relatedTo]&&e.relations[t.relatedTo].length>1&&!o&&(!r.fieldList[n].opts||r.fieldList[n].opts&&!r.fieldList[n].opts.inverse)?void 0:n&&r?r.fieldList[n]:void 0},solveRelation:function(e,t,r,o,i,n,a,s){e.backward;var l=e.forward,d=a?a[o]:void 0,c=d&&d.partial,p=(t._pK,[]);if(n)p=n;else if(c){if(Array.isArray(i[o]))p=i[o].splice(0,i[o].length)}else{if(i[o]&&(i[o].add||Lyte.isRecord(i[o])))return!0;if(Array.isArray(i[o])){if("belongsTo"==l.relType)return"ERR21"}else i[o]=[i[o]];p=i[o].splice(0,i[o].length),"belongsTo"==l.relType&&(i[o]=void 0)}for(var u=0;u<p.length;u++){var f;if(1!=(f=this.createAndRelate(t,r,i,o,p[u],e,d,s)))return f}return!0},createAndRelate:function(e,t,r,o,i,n,a,s){if(!n.backward&&(n.forward.relatedTo===e._name&&(n.backward=n.forward),void 0===n.backward))return"ERR12";var l,d=e._pK,c=t.isComp,p=n.forward&&n.forward.opts?n.forward.opts.polymorphic:void 0,u=a&&a.hasOwnProperty(i[d])?a[i[d]]:a;if(c||typeof i!=t.fieldList[t._pK].type?"object"!=typeof i||Lyte.isRecord(i)||(l=this.insertIntoStore(t._name,i,void 0,void 0,u,void 0,void 0,s)):l=store.$.peekRecord(t._name,i),l&&l.$&&l.$.isError){store.$.cmpSet(r.$,"isError",!0);var f={code:"ERR24",message:Lyte.errorCodes.ERR24,data:r,error:l.$.error};store.$.cmpSet(r.$.error,o,f)}else l?this.hasDuplicateRelation(l,r[o],t._pK,p?i._type:void 0,t)||this.establishLink(n.forward,n.backward,r,l,void 0,!0,!1):this.addToRelate(e._name,r,n,i);return!0},singleEstablishLink:function(e,t,r){var o=r.$._relationships,i=t.$.model._name,n=e.relKey;o[i]=o[i]||{},o[i][n]=o[i][n]||[],this.hasDuplicateRelation(t,o[i][n],t.$.model._pK,void 0,t.$.model)||o[i][n].push(t)},establishLink:function(e,t,r,o,i,n,a,s){if(!o)return"ERR13";if(!this.checkForCorrectRelation(e,o))return"ERR14";var l=e.relKey,d=e.opts&&e.opts.polymorphic,c=d?o._type:void 0,p={};if("belongsTo"==e.relType)r[l]!==o&&store.$.cmpSet(r,l,o,void 0,!0),r.$.partial&&Object.keys(r.$.partial).length&&r.$.partial[l]&&delete r.$.partial[l];else if("hasMany"===e.relType){if(r[l]||store.$.cmpSet(r,l,[],void 0,!0),!r[l].model){var u=o.$.model;d&&c&&(store.$.defProp(r[l],"polymorphic",!0),u=store.modelFor(u.extend)),store.$.establishObserverBindings(r,r.$.model._properties),store.$.defArrUtls(r[l]),store.$.defPolyUtls(r[l]),store.$.defUtls(r[l],u,r,l)}var f,h=e?store.modelFor(e.relatedTo):void 0;0!=a&&this.hasDuplicateRelation(o,r[l],e?h._pK:void 0,c,h)||(null!=i?this.handleArrOp(r[l],"insertAt",o,i):this.handleArrOp(r[l],"push",o)),(!n||s)&&e.opts&&e.opts.serialize&&(f=store.$.partialData(r,l,o.$.pK,"added",void 0,s),p.relKey=l,p.model=r.$.model._name)}var m=!1;if(n||(m=!f),null===t)return o.hasOwnProperty(y)&&delete o[y],!0;if(t.dummy||e==t)this.singleEstablishLink(e,r,o);else{var y=t.relKey,_=o.$.model;if(!this.checkForCorrectRelation(t,r))return"ERR14";if("belongsTo"==t.relType)null!=o[y]&&o[t.relKey]!==r&&this.toDemolishLink(_,o,t,n),o[y]!==r&&store.$.cmpSet(o,y,r,void 0,!0),o.$.partial&&Object.keys(o.$.partial).length&&o.$.partial[y]&&delete o.$.partial[y];else if("hasMany"===t.relType){o[y]||store.$.cmpSet(o,y,[],void 0,!0),o[y].model||(store.$.defArrUtls(o[y]),store.$.defPolyUtls(o[y]),store.$.defUtls(o[y],r.$.model,o,y));var v,g,b=t?store.modelFor(t.relatedTo):void 0;this.hasDuplicateRelation(r,o[y],t?b._pK:void 0,c,b)||this.handleArrOp(o[y],"push",r),(!n||s)&&t.opts&&t.opts.serialize&&(v=store.$.partialData(o,y,r.$.pK,"added",void 0,s)),n||(g=!v)}}if(m){if(e.opts&&e.opts&&e.opts.deepNest){c="added";r[e.relKey].partial&&r[e.relKey].partial.get(o.$.pK)&&(c=r[e.relKey].partial.get(o.$.pK).type),store.$.setDeepNest(r,e.relKey,o.$.pK,c),g=!1}g&&t&&t.opts&&t.opts.deepNest&&store.$.setDeepNest(o,t.relKey,r.$.pK,"added")}return!0},toDemolishRelation:function(e,t,r,o,i,n){var a=e.data[t],s=e.relations;for(var l in s)for(var d=s[l],c=0;c<d.length;c++){var p=d[c],u=store.modelFor(p.relatedTo);if(u){var f=store.$.getBackwardRel(e,p,u);if(!a[p.relKey]&&!p.dummy&&p!==f)continue;this.toDemolishLink(e,a,p,r,o,i,n)}}},toDemolishLink:function(e,t,r,o,i,n,a){var s=t[r.relKey],l=e._pK,d=store.modelFor(r.relatedTo);if(d){d._pK,r.relatedTo;var c=this.getBackwardRel(e,r,d);r.opts&&r.opts.serialize;(r.dummy||r===c)&&(s=this.getRelatedRecord(t,r.relatedTo,r.dummy?r.dummy:r.relKey));if(c)if(Array.isArray(s))for(var p=0;p<s.length;p++)this.demolishLink(t,l,s[p],c.relKey,r,c,o,void 0,i,n,a);else Lyte.isRecord(s)&&this.demolishLink(t,l,s,c.relKey,r,c,o,void 0,i,n,a)}},demolishSingleRelation:function(e,t,r,o,i,n,a){var s,l;Lyte.isRecord(e)&&(s=e.$._relationships)&&s[t]&&s[t][r]&&!1!==n&&!0!==a&&(s=s[t][r],(l=this.getIndex(s,i,o[i]))>-1&&s.splice(l,1))},demolishLink:function(e,t,r,o,i,n,a,s,l,d,c){var p,u=r[o],f=r.$.model,h=e.$.pK,m=u?u.polymorphic:void 0;if(Array.isArray(u)){var y=this.getIndex(u,t,h,m?e._type:void 0),_=r.$._attributes,v=_.hasOwnProperty(o)&&_[o]&&_[o].length?r.$.getInitialValues(o):void 0,g=!(!u.partial||!u.partial.has(h)||"added"!=u.partial.get(h).type);-1!=y&&(g||!1!==l&&!0!==d)&&(m&&(p=u[y].$.model._name),this.handleArrOp(r[o],"removeAt",void 0,y,1)),!s&&v&&(store.$.hasRecordsArrayChanged(r,o,v)||(delete r.$._attributes[o],Object.keys(r.$._attributes).length||(store.$.cmpSet(r.$,"isModified",!1),store.$.changePersist(r,!0),r.$.isNew||(store.$.deleteFromArray(f.dirty,r[f._pK]),(!r.$.dN||r.$.dN&&!Object.keys(r.$.dN).length)&&store.$.removeParentNesting(r)))))}else u&&("object"==typeof u||Lyte.isRecord(u))&&!1!==l&&!0!==d?null!=Lyte&&null!=Lyte.objectUtils?Lyte.objectUtils(r,"delete",o,void 0,void 0,!0):delete r[o]:this.demolishSingleRelation(r,e.$.model._name,i.relKey,e,t,l,d);if(n||(n=f.fieldList[o]),(!a||c)&&!0!==l){var b,A;if(n){n.opts&&("partial"==n.opts.serialize,A=!!n.opts.serialize,b=n.opts.deepNest);var $=n?n.relType:void 0}if("belongsTo"==$&&A&&!e.$.isNew){var L=r.$.partial=r.$.partial||{};c?(L&&L.hasOwnProperty(o)&&L[o].has(h)&&L[o].delete(h),b&&store.$.deleteDeepNest(r,o,h),b=!1):((L=L[o]=L[o]||new Map).has(h)||L.set(h,{}),(L=L.get(h)).type="removed")}n&&n.opts&&n.opts.serialize&&(b=(!store.$.partialData(r,o,h,"removed",p,c)||"hasMany"!=$)&&b),b&&(store.$.makeDirty("dirty",r,"removed",n,h),store.$.addDeepNest(r))}},rllBckRecArr:function(e,t,r,o){var i={},n=r._pK,a=store.modelFor(o.relatedTo)._pK;store.$.getRelations(r,o.relKey,store.modelFor(o.relatedTo),i);for(var s=e.length-1;s>=0;s--){var l=e[s].records;if("added"==e[s]._type)for(var d=0;d<l.length;d++){(f=l[d])&&f.$&&f.$.hasOwnProperty("pK")&&(this.demolishLink(f,a,t,i.forward.relKey),null!=i.backward&&this.demolishLink(t,n,f,i.backward.relKey,i.forward))}else if("removed"==e[s]._type)for(d=l.length-1;d>=0;d--){(f=l[d])&&f.$&&f.$.hasOwnProperty("pK")&&this.establishLink(i.forward,i.backward,t,f,e[s]._indices[d])}else if("changed"==e[s]._type){var c=t[o.relKey];Array.isArray(c)||(c=[c]);for(var p=c.length,u=0;u<p;u++){(f=c[0])&&f.$&&f.$.hasOwnProperty("pK")&&(this.demolishLink(f,a,t,i.forward.relKey),null!=i.backward&&this.demolishLink(t,n,f,i.backward.relKey,i.forward))}Array.isArray(l)||(l=[l]);for(d=0;d<l.length;d++){var f;"string"==typeof(f=l[d])&&(f=store.$.peekRecord(i.forward.relatedTo,f)),f&&f.$&&f.$.hasOwnProperty("pK")&&this.establishLink(i.forward,i.backward,t,f,void 0)}}}},sortBy:function(e,t){var r=store.$.mapBy.call(this,e),o=this.model.fieldList[e];o&&"string"==o.type?(r.sort(),"desc"==t&&r.reverse()):(r.sort((function(e,t){return e-t})),"desc"==t&&r.sort((function(e,t){return t-e})));for(var i=this.slice(0),n=[],a=0;a<r.length;a++)if(null!=r[a]){var s=store.$.getIndex(i,e,r[a]);n.push(i[s]),i.splice(s,1)}return i.length>0&&(n="desc"==t?n.concat(i):i.concat(n)),store.$.defArrUtls(n),store.$.defUtls(n,this.model),n},mapBy:function(e){return this.map((function(t){return t.$.get(e)}))},revertToOldVal:function(e,t,r,o){if(null!=r&&0!=r.length){Array.isArray(r)||(r=[r]);for(var i=0;i<r.length;i++){var n=o.forward.relatedTo,a=store.$.peekRecord(n,r[i]);this.establishLink(o.forward,o.backward,e,a,void 0)}}},removePartial:function(e,t){var r=e.$.partial;r&&r[t]&&delete r[t]},findCurrentInd:function(e,t){var r,o,i=e._deleted,n=!1;return i.forEach((function(e,i){n&&e.index<r&&o--,i==t&&(n=!0,o=r=e.index)})),o},modifyDelInd:function(e,t){var r,o=e._deleted,i=!1;o.forEach((function(e,o){i&&e.index>=r&&(e.index=e.index+1),o==t&&(i=!0,r=e.index)}))},rollBackDelete:function(e,t,r,o){var i=[],n=e._name;if(t){var a=e._deleted.get(t),s=e._pK;i=[a]}else e._deleted.forEach((function(e){i.push(e)}));for(var l=this,d=i.length-1;d>=0;d--){var c=(a=i[d]).data,p=e.data._recMap?e.data._recMap.get(c.$.pK):-1!==e.data.indexOf(c);if(Lyte.isRecord(c)){store.$.cmpSet(c.$,"isDeleted",!1),store.$.changePersist(c,!0);var u=store.$.isDuplicateRecord(e,c);if(p)store.$.addDeepNest(c,void 0,"added");else{r?l.handleArrOp(e.data,"insertAt",c,a.index):l.handleArrOp(e.data,"push",c),e.emit("add",[c]),store.emit("add",[e._name,c]);var f=e.relations;if(f)for(var h in f){(f[h]||[]).forEach((function(t){var r,o,i;t.relKey;o=store.modelFor(t.relatedTo),r=l.getBackwardRel(e,t,o),i=t.relKey&&t!=r?c[t.relKey]:store.$.getRelatedRecord(c,t.relatedTo,t.dummy?t.dummy:t.relKey),Array.isArray(i)?i.forEach((function(e,o){t==r?l.establishLink(r,t,e,c,void 0,!1):l.establishLink(t,r,c,e,void 0,!1)})):t==r?l.establishLink(r,t,i,c,void 0,!1):l.establishLink(t,r,c,i,void 0,!1)}))}}var m=store.model.cachedQueries;if(m){var y=m[n];if(y&&y.length)for(var _=y.length-1;_>=0;_--){if((a=y[_])&&a.hasDeletedRecords)-1!=a.data[n].indexOf(c)&&delete a.hasDeletedRecords}}(c.$.isNew||c.$.isModified)&&this.checkAndAddToArray(e.dirty,c[e._pK]),store.$.clrRecErr(c.$,s,"ERR17"),u||e.data._recMap.set("object"==typeof c.$.pK?c.$.pK:c.$.pK.toString(),c),e._deleted.delete(c.$.pK)}}},rollBackNew:function(e,t,r,o){store.$.removeFromStore(e,t.$.pK,!0,o)},emit:function(e,t,r,o){t.$.emit(e,[t,r,o]),t.$.model.emit(e,[t,r,o]),store.emit(e,[t.$.model._name,t,r,o])},hasRecordsArrayChanged:function(e,t,r){var o=r||e.$.getInitialValues(t),i=!0;e.$.model._pK;if(o&&o.length==e[t].length){i=!1;for(var n=0;n<o.length;n++)if(-1==e[t].indexOf(o[n]))return!0}return i},setRecErr:function(e,t,r,o){store.$.cmpSet(e,"isError",!0);var i=r;if("object"==typeof i)store.$.cmpSet(e.error,t,i);else{if("string"==typeof r)i=Lyte.errorCodes[r]?{code:r,message:Lyte.errorCodes[r]}:r;store.$.cmpSet(e.error,t,i),o&&store.$.cmpSet(e.error[t],"value",o)}store.$.emit("error",e.record,t,i)},clrRecErr:function(e,t,r){var o=Lyte.objectUtils,i=e.error;if(r)e.error.code==r&&(void 0!==o?o(i,"delete",t):delete i[t]);else if(t)void 0!==o?o(i,"delete",t):delete i[t];else if(void 0!==o)for(var n in i)o(i,"delete",n);else e.error={};0==Object.keys(e.error).length&&store.$.cmpSet(e,"isError",!1)},cacheQuery:function(e,t,r,o){var i=store.model.cachedQueries;(i=(i=store.model.cachedQueries=i||{})[e]=i[e]||[]).push({cacheQuery:t,data:r,status:o})},cacheRecordQuery:function(e,t,r,o,i){var n=store.model.cachedRecordQueries;(n=(n=(n=store.model.cachedRecordQueries=n||{})[e]=n[e]||{})[t]=n[t]||[]).push({cacheQuery:r,data:o,status:i})},isModelDataArray:function(e){if(Array.isArray(e)&&(e.modelless||e.model&&e.model instanceof Model&&!e.polymorphic))return!0},handleArrOp:function(e,t,r,o,i){i=null!=i?i:0;var n,a,s=void 0!==Lyte.arrayUtils;if(e.key&&e.record){var l=e.record.$.model.fieldList[e.key],d=!1;l&&l.opts&&l.opts.sort&&(l.opts.sort.sortFn?(a=l.opts.sort.sortFn,l.opts.sort.observes&&(d=!0)):a={sortBy:l.opts.sort.sortBy,sortOrder:l.opts.sort.sortOrder})}switch(t){case"push":this.isModelDataArray(e)&&(null==e._recMap&&store.$.defProp(e,"_recMap",new Map),e.modelless?e._recMap.set(r[e.pK],r):e._recMap.set("object"==typeof r.$.pK?r.$.pK:r.$.pK.toString(),r)),n=a?s?Lyte.arrayUtils(e,"sort",a,[r]):e.push(r):s?Lyte.arrayUtils(e,t,r):e.push(r),d&&r&&r.$&&(r.$.hasOwnProperty("srtObs")||store.$.defProp(r.$,"srtObs",!0,!1,!0));break;case"removeAt":if(this.isModelDataArray(e))for(var c=i,p=0;p<c;p++){var u=void 0;if(e.modelless)u=e[o+p][e.pK];else{var f=e[o+p]?e[o+p].$.pK:void 0;u=f="object"==typeof f?f:f.toString()}void 0!==u&&e._recMap&&e._recMap.delete(u)}var h=e[o];d&&h&&h.$&&!store.$.changeRelPkMaps(h,void 0,void 0,"srtObsChk",e.key)&&h.$.hasOwnProperty("srtObs")&&(h.$.srtObs=!1),n=s?Lyte.arrayUtils(e,t,o,i):e.splice(o,i);break;case"insertAt":this.isModelDataArray(e)&&(null==e._recMap&&store.$.defProp(e,"_recMap",new Map),e.modelless?e._recMap.set(r[e.pK],r):e._recMap.set("object"==typeof r.$.pK?r.$.pK:r.$.pK.toString(),r)),n=a?s?Lyte.arrayUtils(e,"sort",a,[r]):e.splice(o,i,r):s?Lyte.arrayUtils(e,t,o,r):e.splice(o,i,r),d&&r&&r.$&&(r.$.hasOwnProperty("srtObs")||store.$.defProp(r.$,"srtObs",!0,!1,!0));break;case"replaceAt":n=a?s?Lyte.arrayUtils(e,"sort",a,[r]):e.splice(o,i,r):s?Lyte.arrayUtils(e,t,o,r):e.splice(o,i,r),d&&r&&r.$&&(r.$.hasOwnProperty("srtObs")||store.$.defProp(r.$,"srtObs",!0,!1,!0));break;case"sort":n=Lyte.arrayUtils(e,"sort",a);break;default:Lyte.error("LD07",t)}return n},defpayObjUtls:function(e){Object.defineProperties(e,{set:{value:store.$.payloadSet},remove:{value:store.$.payloadRemove}})},defPayArrUtls:function(e){Object.defineProperties(e,{add:{value:store.$.payloadAdd},remove:{value:store.$.payloadRemove}})},defArrUtls:function(e){Object.defineProperties(e,{filterBy:{value:store.$.filterBy},sortBy:{value:store.$.sortBy},mapBy:{value:store.$.mapBy}})},defPolyUtls:function(e){Object.defineProperties(e,{add:{value:store.$.add},remove:{value:store.$.remove}})},defUtls:function(e,t,r,o){t&&store.$.defProp(e,"model",t),r&&store.$.defProp(e,"record",r,!1,!0),o&&store.$.defProp(e,"key",o)},defPar:function(e){store.$.defProp(e,"partial",new Map)},cmpSet:function(e,t,r,o,i){void 0!==Lyte.Component?Lyte.Component.set(e,t,r,o,i):e[t]=r},defProp:function(e,t,r,o,i){o=!!o,i=!!i,Object.defineProperty(e,t,{value:r,enumerable:o,writable:i})},removeChildRecords:function(e,t,r,o){if(!r.get(t)&&e){r.set(t,!0);var i=t?t.$.pK:void 0,n=[],a=e._fldGrps.inherit;for(var s in a){var l=a[s].relKey?a[s].relKey:void 0;if(t&&l)if("belongsTo"==e.fieldList[l].relType&&t[e.fieldList[l].relKey])this.removeChildRecords(store.modelFor(e.fieldList[l].relatedTo),t[e.fieldList[l].relKey],r);else if("hasMany"==e.fieldList[l].relType&&t[e.fieldList[l].relKey])for(var d=t[e.fieldList[l].relKey].length-1;d>=0;d--)this.removeChildRecords(store.modelFor(e.fieldList[l].relatedTo),t[e.fieldList[l].relKey][d],r)}n.push(i),this.removeFromStore(e,n,!0,!0,void 0,void 0,o)}},rBinherit:function(e,t){var r=e.record,o=e.model._fldGrps.inherit;for(var i in o){if(o[i].opts&&o[i].opts.inherit&&r[o[i].relKey])if("belongsTo"===o[i].relType)(s=r[o[i].relKey])&&!t.get(s)&&(t.set(s,!0),this.rollBackRecord(s.$,{inherit:!0}),store.$.rBinherit(s.$,t));else if("hasMany"===o[i].relType){var n=r[o[i].relKey].length;if(0!=n)for(var a=n-1;a>=0;a--){var s;(s=r[o[i].relKey][a])&&!t.get(s)&&(t.set(s,!0),this.rollBackRecord(s.$,{inherit:!0}),store.$.rBinherit(s.$,t))}}}},rollBackRecord:function(e,t){var r=e.model,o=r._pK;e.isModified&&(e.rollBackAttributes(e.getDirtyAttributes(),t),delete e._savedState),e.isDeleted?store.$.rollBackDelete(r,e.get(o),void 0,t):e.isNew?store.$.rollBackNew(r,e.record,o,t):e.isError&&store.$.clrRecErr(e),store.$.removeOnSave(e.model._name,e.record.$.pK)},buildVariables:function(e,t,r,o){for(var i in e=e||{},t){if(-1!=t[i].search(/!/g)&&!e[i]&&!r)return{LdEr:"LD30",LyteError:"ERR30",key:i};-1!=t[i].search(/!/g)&&(t[i]=t[i].replace(/!/g,"")),r&&-1==t[i].search(/\./g)&&("ID"!=t[i]&&"ID!"!=t[i]||(e[i]=r));var n={LdEr:"LD31",LyteError:"ERR30",key:i};if(e&&e[i])switch(t[i]){case"Int":case"Float":if("number"!=typeof e[i])return n;break;case"String":if("string"!=typeof e[i])return n;break;case"Boolean":if("boolean"!=typeof e[i])return n;break;case"Object":if("object"!=typeof e[i])return n}}for(var a in e)"string"!=typeof e[a]&&"object"!=typeof e[a]||(e[a]=store.$.LyteStringfy(e[a],""));return e},buildQuery:function(e,t,r,o,i,n,a,s,l,d){var c="",p=!1;for(var u in r)if("object"==typeof r[u]){if(c+=Object.keys(r)[0]+" ",a){for(var f in c+="( ",a)if(-1==f.search(/[.]/g)&&""==i)c+=f+":"+a[f]+" ";else if(""!=i&&-1!=f.search(/[.]/g)&&i==f.match(/.*(?=\..*$)/g)[0]){var h=f.split(".");c+=h[h.length-1]+":"+a[f]+" "}c=(c+=") ").replace(/\([ ]*\)/g,"")}c+="{ ";for(var m=0;m<r[u].length;m++){var y=r[u][m];p=!1,l&&(p=!("string"!=typeof y||!l.includes(y)||""!=i)||!("object"!=typeof y||!l.includes(Object.keys(y)[0])||""!=i)),p||("string"==typeof y?c=c+y+" ":(i=(i?i+".":"")+Object.keys(y)[0],c+=store.$.buildQuery(e,t,y,o,i,n,a,s,l,d),i=u==n?"":u))}c+=" } "}return c},QueryCallback:function(e,t,r,o,i,n,a,s,l){var d;if("object"==typeof o){for(var c=Object.keys(o)[0],p=0;p<o[c].length;p++){var u=o[c][p];"object"==typeof u&&store.modelFor(e).fieldList[Object.keys(u)[0]]&&store.modelFor(e).fieldList[Object.keys(u)[0]].relatedTo&&(d=store.modelFor(e).fieldList[Object.keys(u)[0]].relatedTo,store.$.QueryCallback(d,t,r,u,i,n,a,s,l))}var f=store.$.initCB("serializer",e,"serializeSelfQuery",{args:[e,t,l,o,i,n]});if(f){var h=f.data[Object.keys(o)[0]];o[Object.keys(o)[0]]=h}}},buildFields:function(e,t,r,o,i,n){var a=store.modelFor(e),s=a.fieldList,l=a.gql&&a.gql.localAttrs?a.gql.localAttrs:[];n?s=n:i.set(e,!0);var d={},c=[];for(var p in s)if(!l.includes(p)){if("relation"==s[p].type){if(store.modelFor(s[p].relatedTo)&&s[p].relatedTo!=o&&s[p].relatedTo!=e){var u=store.$.getBackwardRel(store.modelFor(e),s[p],store.modelFor(s[p].relatedTo));if(u&&u.relatedTo==t&&null==u.dummy)continue;i.has(s[p].relatedTo)||c.push(store.$.buildFields(s[p].relatedTo,s[p].relatedTo,p,o,i))}continue}"object"==s[p].type&&s[p].properties?c.push(store.$.buildFields(e,t,p,o,i,s[p].properties)):c.push(p)}return d[r]=c,i.delete(e),d},parseQuery:function(e,t,r,o,i,n,a,s,l,d,c){var p,u,f,h={},m={};if("object"==typeof n){var y,_;"variables"!=(_=Object.keys(n.query))[0]?_[0]:_[1];u=Object.assign({},n.query.variables),m["variables"!=_[0]?_[0]:_[1]]=Object.assign(n.query["variables"!=_[0]?_[0]:_[1]]),"object"==typeof m&&(y=m)}if("string"==typeof n&&-1!=n.search(/[ ]/g)){var v=n,g={};v=(v=(v=(v=(v=(v=(v=(v=(v=(v=(v=(v=(v=(v=(v=v.replace(new RegExp("\n","g")," ")).replace(/ *[ ]*\(/g,":{variables:[")).replace(/ *\) *{/g,"],attrs:[")).replace(/\w+/g,'"$&"')).replace(/"!/g,'!"')).replace(/" +"/g,'", "')).replace(/\S+{"variables"/g,"{$&")).replace(/} *"/g,'}, "')).replace(/" *{/g,'" :{"attrs" :[')).replace(/\} *\}/g,"]}}")).replace(/" *}/g,'"]} }')).replace(/]}}/g,"]}}]}}")).replace(/]}}]}} *}/g,"]}}]}}]}}")).replace(/} *{/g,"},{")).replace(/\S+ *:{"attrs"/g,"{$&"),v=JSON.parse(v),y=store.$.buildQueryFields(v,g,"",Object.keys(v)[0]),u=g}if("object"==typeof y){store.$.QueryCallback(e,r,e,y,a,y,u,o,s),i.query=y,a&&(i.variables=a);var b=Object.keys(u)[0];"Mutation"!=i.type||1!=Object.keys(u).length||"Object"!=u[b]&&"Object!"!=u[b]?i.variables:i.variables[b]=d;var A=store.$.initCB("serializer",e,"serializeGqlQuery",{args:[e,r,t,i,s,d,c]});if(A&&(y=A.data.query,A.data.variables&&(a=A.data.variables)),(f=store.$.buildVariables(a,u,t,s.type))&&f.LdEr)return f;s.gqlObj=i,p="{ "+(p=store.$.buildQuery(e,r,y,u,"",Object.keys(y)[0],0!=Object.keys(f).length?f:void 0,t,l,e))+" }"}return"Query"==i.type?h.query=p:h.query="mutation "+p,h},graphQlconfig:function(e,t,r,o,i,n,a,s,l){var d,c,p={},u=store.modelFor(e),f={},h=new Map,m=u.gql&&u.gql.localAttrs?u.gql.localAttrs:[];if("findAll"==r||"findRecord"==r){if(f.type="Query",void 0===(c=u.gql&&u.gql.query&&u.gql.query[i]?u.gql.query[i]:i)){var y=store.$.buildFields(e,null,e,e,h);(d={}).query=y,f.queryType="default"}else if("string"==typeof i&&-1!=i.search(/[ ]/g))d=i,f.queryType="query";else if("object"==typeof i)d=i;else if("object"==typeof c)d=c;else{if("string"!=typeof c||-1==c.search(/[ ]/g))return{LdEr:"LD32",LyteError:"ERR31",key:i};d=c,f.queryType="namedQuery",f.queryName=i}n=n?Object.assign({},n):void 0}else if(f.type="Mutation",c=u.gql&&u.gql.mutation&&u.gql.mutation[i]?u.gql.mutation[i]:i,"string"==typeof i&&-1!=i.search(/[ ]/g))d=i,f.mutationType="customMutation";else{if("string"!=typeof c||-1==c.search(/[ ]/g))return{LdEr:"LD32",LyteError:"ERR31",key:i};d=c,f.mutationType="namedMutation",f.MutationName=i}var _=store.$.parseQuery(e,t,r,o,f,d,n,a,m,s,l);return _.LdEr?_:(p.data=JSON.stringify(_),p.data)},setQuery:function(e,t,r,o){var i=e;i.gql?(i.gql[r]=i.gql[r]?i.gql[r]:{},i.gql[r][t]=i.gql[r][t]?i.gql[r][t]:{}):(i.gql={},i.gql[r]={},i.gql[r][t]={}),i.gql[r][t]=o},buildQueryFields:function(e,t,r,o){var i=Object.keys(e)[0],n=[],a={};if(e[i].variables)for(var s=0;s<e[i].variables.length;s+=2)t[(r?r+".":"")+e[i].variables[s]]=e[i].variables[s+1];for(var l=0;l<e[i].attrs.length;l++)"object"==typeof e[i].attrs[l]?(r=(r?r+".":"")+Object.keys(e[i].attrs[l])[0],n.push(this.buildQueryFields(e[i].attrs[l],t,r,o)),r=i!=o?i:""):n.push(e[i].attrs[l]);return a[i]=n,a},LyteStringfy:function(e,t,r){if("string"==typeof e)return'"'+e+'" ';if(Array.isArray(e)){t+="[";var o=0,i=e.length;e.forEach((function(r){o++,"string"==typeof r?t=t+'"'+r+'" ':"object"==typeof r?t=store.$.LyteStringfy(r,t):"number"==typeof r&&(t+=e.toString()),t=o!=i?t+",":t})),t+="]"}else{if(!e||Array.isArray(e)||"object"!=typeof e)return e.toString();t+="{";var n=0;for(var o in e)n++,"string"==typeof e[o]?t=t+o+' : "'+e[o]+'" ':"object"==typeof e[o]?(t=t+o+" : ",t=store.$.LyteStringfy(e[o],t)):t=t+o+" : "+e[o].toString(),Object.keys(e).length!=n&&(t+=", ");t+="}"}return t},cpdGql:function(e,t,r,o,i,n){o.gql&&("object"==typeof o.gql?mutName=o.gql.mutation:1==o.gql&&(mutName=void 0),o.data=store.$.graphQlconfig(e,void 0,t,r,mutName,[],o,i,n))},payloadAdd:function(e,t){Array.isArray(e)||(e=[e]);for(var r=this._model,o=this._partialObj,i=this._payloadObj,n={opts:{serialize:this._serialize}},a={},s={},l=0;l<e.length;l++){if(o._removedRecords&&o._removedRecords.hasOwnProperty(e[l]))a=o._removedRecords[e[l]]._payload,s=o._removedRecords[e[l]]._partial,delete o._removedRecords[e[l]];else{var d=store.$.peekRecord(r,e[l]),c=store.$.PayloadSerialize(n,a,d,void 0,store.modelFor(r),s);a=c.payload,s=c.partial}this.partRecMap.get(e[l])||(null!=t&&"number"==typeof t?(Lyte.arrayUtils(o,"insertAt",t,s),Lyte.arrayUtils(i,"insertAt",t,_pK),t=t++):(Lyte.arrayUtils(o,"push",s),Lyte.arrayUtils(i,"push",a)),this.partRecMap.set(e[l],!0))}},payloadRemove:function(e){this._model;var t=this._partialObj,r=this._payloadObj;Array.isArray(e)||(e=[e]);for(var o=0;o<e.length;o++)if(Array.isArray(r)){var i=r.length;if(this._serialize&&"id"==this._serialize){if(r.includes(e[o])){var n=r.indexOf(e[o]);r.splice(n,1)}}else for(var a=0;a<i;a++)t[a]&&t[a].$.pkVal==e[o]&&(t.hasOwnProperty("_removedRecords")?t._removedRecords[t[a].$.pkVal]={_partial:t[a],_payload:r[a]}:Object.defineProperties(t,{_removedRecords:{value:{[t[a].$.pkVal]:{_partial:t[a],_payload:r[a]}}}}),Lyte.arrayUtils(t,"removeAt",a,1),Lyte.arrayUtils(r,"removeAt",a,1),this.partRecMap.delete(e[o]))}else r[e[o]]&&(t.hasOwnProperty("_removedAttr")&&!t._removedAttr.hasOwnProperty(e[o])?t._removedAttr[e[o]]={_partial:t[e[o]],_payload:r[e[o]]}:t.hasOwnProperty("_removedAttr")||Object.defineProperties(t,{_removedAttr:{value:{_partial:t[e[o]],_payload:r[e[o]]}}}),t[e[o]]&&(t._removedAttr[e[o]]._partial=t[e[o]],Lyte.objectUtils(t,"delete",e[o])),Lyte.objectUtils(r,"delete",e[o]))},payloadSet:function(e){Array.isArray(e)||(e=[e]);for(var t=this._model,r=this._pkVal,o=store.modelFor(t),n=this._payloadObj,a=store.$.peekRecord(t,r),s=this._partialObj,l=0;l<e.length;l++){var d=e[l];if(!this._payloadObj[d]){if(s.hasOwnProperty("_removedAttr")&&s._removedAttr.hasOwnProperty(d)&&1!=s._removedAttr[d])return n[d]=s._removedAttr[d]._payload,s._removedAttr[d]._partial&&(s[d]=s._removedAttr[d]._partial),void Lyte.objectUtils(s._removedAttr,"delete",d);var c=o.fieldList[d];if(a[d]&&"relation"==c.type)if("hasMany"==c.relType){if(s[d]=[],n[d]=[],c.opts&&"id"==c.opts.serialize&&store.$.payLoadIdSerialize(n,d,a,o,c,s),store.$.defProp(n[d],"$",{}),store.$.defPayArrUtls(n[d].$),Object.defineProperties(n[d].$,{_key:{value:c.relKey},_partialObj:{value:s[d]},_model:{value:c.relatedTo},_payloadObj:{value:n[d]},replace:{value:store.$.replaceCheck,writable:!0},partRecMap:{value:new Map}}),c.opts&&c.opts.serialize&&!n[d].$.serialize&&Object.defineProperty(n[d].$,"_serialize",{value:c.opts.serialize}),c.opts&&"id"!=c.opts.serialize||!c.opts){if("record"==c.opts.serialize)for(i=0;i<a[d].length;i++)n[d].$.add(a[d][i].$.pK);if("partial"==c.opts.serialize)a[d].partial.forEach((function(e,t){n[d].$.add(t)}))}}else{s[d]={},n[d]={};var p=store.$.PayloadSerialize(c,n[d],a[d],d,store.modelFor(c.relatedTo),s[d]);n[d]=p.payload,s[d]=p.partial}else n[d]=a[d],s[d]=a[d]}}},payLoadIdSerialize:function(e,t,r,o,i,n){var a={};e[t]=Lyte.deepCopyObject(r[t]),store.$.getRelations(o,t,store.modelFor(i.relatedTo),a),store.$.idSerialize(e,a,void 0,n)},PayloadSerialize:function(e,t,r,o,i,n){var a,s="object"==typeof r.$.pK?r.$.pK:{[r.$.model._pK]:r.$.pK},l=i,d=!1;if(e.opts&&e.opts.serialize){if(a=store.adapter.$.initPartialObj(i._name),"record"==e.opts.serialize&&(s=store.$.toJSON(i._name,r,void 0,void 0,a)),"partial"==e.opts.serialize){var c=store.$.isDirty(r,l.relations),p=r;p.$.isModified||c&&c.length?(u=store.$.updateJSON(p,l,c),s=store.$.toJSON(i._name,u,void 0,void 0,a),d=!0):a.obj.set(r.$.pK,n)}n=a.obj.get(r.$.pK)||n;var u,f={pkVal:{value:r.$.pK},type:{value:"related"},model:{value:l._name},record:{value:r[o]||r}};if(1==d&&(f.type.value="modified"),s&&(t=store.adapter.$.serializeRecords(i._name,s,r,void 0,"serializeRecord",void 0,a.obj)),e.opts&&"id"==e.opts.serialize&&(s=r.$.pK),"object"==typeof t){n&&!n.$&&store.$.defProp(n,"$",{});var h=n.$;Object.defineProperties(h,f),e.opts&&e.opts.serialize&&t.$&&!t.$._serialize&&"belongsTo"==e.relType&&Object.defineProperty(t.$,"_serialize",{value:e.opts.serialize})}return u={payload:t,partial:n}}},replaceCheck:function(e){store.$.defProp(this._partialObj,"replace",e)},savingDonorRecord:function(e){var t=e.donor,r=e.getDirtyAttributes();if(store.$.isDirty(e.record,e.model.relations).length||r.length){var o=e.toJSON("state");store.$.setData(t.$,o,void 0,void 0,void 0,void 0,!0),e.persist()}return t.$},peekRecord:function(e,t,r,o){var i,n=store.modelFor(e),a=store.$.getFromCB("adapter",e,"modelless");if(n=a?e:n){if(1==a&&n){if(!(n=store.modelless[n]))return;i=!0}if(!0===r){var s=n._deleted.get(t);if(s&&s.data)return s.data&&Lyte.getConfig("mutable")?Lyte.mut(s.data):s.data}else{var l=n.isComp;if(t=null==t?"":t,!l&&n.data._recMap){var d=n.data._recMap.get(t.toString());return o&&Lyte.getConfig("mutable")?Lyte.mut(d):d}var c,p=n.data;if((c=1!=i?p.filter((function(e){if(store.$.comparePk(e,t))return o&&Lyte.getConfig("mutable")?Lyte.mut(e):e})):p.filter((function(e){if(e[n._pK]===t)return e})))[0])return o&&Lyte.getConfig("mutable")?Lyte.mut(c[0]):c[0]}}else Lyte.warn("LD02","Model ",e)}}};function Adapter(e,t,r){Object.defineProperty(this,"$lg",{value:Lyte.__gl}),store.$.newCB("adapter",this,r,e,t)}function Serializer(e,t,r){Object.defineProperty(this,"$lg",{value:Lyte.__gl}),store.$.newCB("serializer",this,r,e,t)}store.$.cbDef(Adapter,"adapter"),store.adapter={$:{buildURL:function(e,t,r,o,i,n,a,s,l,d){var c=store.$.getAdapter({name:r}),p=store.$.getFromCB("adapter",r,"host"),u=(l=l||"",store.$.makeBatch),f={method:t};if(!(l=l||""))if(u||void 0!==p&&(l+=p,"/"!=p[p.length-1]&&(l+="/")),d){f.method="POST",f.gql=d,t=f.method;var h=store.$.getFromCB("adapter",r,"gqlNamespace");l+=h||""}else{var m=store.$.getFromCB("adapter",r,"namespace");if(""!==m&&"/"!=m[m.length-1]?l+=m+"/":l+=m,"batch"!=e&&(l+=r,o&&"object"!=typeof o&&(l+="/"+o)),"action"==e){l+="/"+store.$.getFromCB("adapter",r,"actionNamespace");var y=store.modelFor(r).actions;l+="/"+(y[a].endPoint?y[a].endPoint:a)}else"batch"==e&&(l+=store.$.getFromCB("adapter","application","batchNamespace"));f.method=t||""}if(n||(n={}),(g=store.$.initCB("adapter",r,"headersForRequest",{args:[e,n,s,a,o]}))&&(f.headers=g.data),(g=store.$.initCB("adapter",r,"buildURL",{args:[r,e,n,i,l,a,s,o]}))&&(l=g.data),(g=store.$.initCB("adapter",r,"methodForRequest",{args:[t,e,n,s,a,o]}))&&(f.method=g.data),!u&&n&&Object.keys(n).length){l+="?";var _=0;for(var v in n){var g;0!==_&&(l+="&"),(g=n[v])&&"object"==typeof g&&(g=JSON.stringify(g)),l+=v+"="+encodeURIComponent(g),_++}}return c&&1==c.withCredentials&&(f.withCredentials=!0),f.url=l,f.qP=n,f},get:function(e,t,r,o,i,n,a,s,l){var d,c=store.modelFor(t),p=store.$.makeBatch,u=l||s?{}:void 0,f=store.$.getFromCB("adapter",t,"modelless");if(f&&"string"==typeof t){var h=store.modelless,m=t;def=h[m]=h[m]||{},def._name=m}if(c||t&&f){n=null==n?store.$.getFromCB("adapter",t,"customData"):n,s&&(u.query=s),l&&(u.variables=l),d=store.$.initCB("adapter",t,"gql",{args:[t,e,o,r,u,n]});var y=this.buildURL(e,"GET",t,r,void 0,o,void 0,n,void 0,d?d.data:void 0),_=this;if(o=y.qP,toCheckParams=i&&"boolean"!=typeof i?i:o&&"object"==typeof o?o:void 0,y.gql&&("object"==typeof y.gql?(s=y.gql.query,l=y.gql.variables):!0===y.gql&&(s=l=void 0),y.data=store.$.graphQlconfig(t,r,e,o,s,l,y),y.data.LdEr))return Lyte.warn(y.data.LdEr,y.data.key,t),Promise.reject({code:y.data.LyteError,message:Lyte.errorCodes[y.data.LyteError],data:y.data.key});if("findAll"==e&&toCheckParams&&store.model.cachedQueries&&store.model.cachedQueries[t]){for(var v=store.model.cachedQueries[t],g=0;g<v.length;g++){var b=v[g];if(!b.hasDeletedRecords){var A=b.cacheQuery;if(this.compareData(A,toCheckParams,!0)){$=[b.data,"cache",void 0,b.status];break}}}if($)return new Promise((function(e){p&&store.$.addToCachedBatch(Array.isArray($)?$[0][t]:$),e($)}))}else if("findRecord"==e&&toCheckParams&&store.model.cachedRecordQueries&&store.model.cachedRecordQueries[t]&&store.model.cachedRecordQueries[t][r]){var $;for(v=store.model.cachedRecordQueries[t][r],g=0;g<v.length;g++){A=v[g].cacheQuery;if(this.compareData(A,toCheckParams,!0)){$=[v[g].data,"cache",void 0,v[g].status];break}}if($)return new Promise((function(e){p&&store.$.addToCachedBatch(Array.isArray($)?$[0][t]:$),e($)}))}else{var L=store.$.cbScp(t,"findRecord"==e?"reloadRecord":"reloadAll","adapter");if(L){var E,R=!1;if("findRecord"==e?(E=store.$.peekRecord(t,r),R=!!Lyte.isRecord(E)):"findAll"==e&&(R=!(!(E=store.peekAll(t))||!E.length)),R&&!store.$.cB(L,[E,o,n,t])){var w={};return w[t]=E,new Promise((function(e){p&&store.$.addToCachedBatch(w[t]),e([w,"cache"],"success",void 0,!0)}))}}}if("POST"==y.method){var N=store.$.initCB("serializer",t,"serialize",{args:[e,y?y.data:void 0,void 0,n,t,o,void 0,y?y.gqlObj:void 0]});N&&(y.data=N.data,!y.data||"object"!=typeof y.data&&!Lyte.isRecord(y.data)&&!Array.isArray(y.data)||y.data instanceof FormData||(y.data=JSON.stringify(y.data)))}return new Promise((function(s,l){var d,c=store.modelFor(t),u=store.$.getIDBObj(c,o,e,r,n),f=store.$.getFromCB("adapter",t,"processRequest"),h=!0,m=!1,v=[t,e,r,y,s,l,"get",void 0,n],g={cacheQuery:i,cacheData:a,customD:n};if(f){h=!1;var b=_.callGeneric(e,t,void 0,void 0,n,o,r,y.url,void 0,y.method,y.headers);b instanceof Promise?(m=!0,b.then((function(o){o=""==o?JSON.parse("{}"):JSON.parse(o),d=_.getResponse(o,t,e,r,y,void 0,n,g),s([d])}),(function(e){l(e)}))):h=!0}p&&!m?store.adapter.$.constructBatch.apply(store.adapter.$,v).then((function(o){var i=o.content;store.adapter.$.getSuccess(t,e,r,y,void 0,s,l,i,o,void 0,g)}),(function(o){store.adapter.$.getFailure(t,e,r,y,void 0,s,l,g,o.content,o.code,o)})):u?store.adapter.$.getFromIDB(u,t,e,o,r,y,n).then((function(i){var n=store.$.initCB("serializer",t,"idbResponse",{args:[t,e,o,r,i]});n&&(i=n.data),0==i?store.adapter.$.sendXHR.apply(store.adapter.$,v).then((function(o){store.adapter.$.getSuccess(t,e,r,y,o,s,l,void 0,void 0,void 0,g)}),(function(o){store.adapter.$.getFailure(t,e,r,y,o,s,l,g)})):store.adapter.$.getSuccess(t,e,r,y,void 0,s,l,i,void 0,"idb",g)}),(function(o){store.adapter.$.sendXHR.apply(store.adapter.$,v).then((function(o){store.adapter.$.getSuccess(t,e,r,y,o,s,l,void 0,void 0,void 0,g)}),(function(o){store.adapter.$.getFailure(t,e,r,y,o,s,l,g)}))})):h&&store.adapter.$.sendXHR.apply(store.adapter.$,v).then((function(o){store.adapter.$.getSuccess(t,e,r,y,o,s,l,void 0,void 0,void 0,g)}),(function(o){store.adapter.$.getFailure(t,e,r,y,o,s,l,g)}))}))}return Lyte.warn("LD02","Model",t),Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:t})},constructBatch:function(e,t,r,o){return new Promise((function(e,t){var r=store.$.currentBatch,i=store.$.batch[r]=store.$.batch[r]||[],n=store.$.batchPromise[r]=store.$.batchPromise[r]||[],a={};a.method=o.method,a.uri="/"+o.url,a.parameters=o.qP,a.content="string"==typeof o.data?JSON.parse(o.data):void 0,i.push(a),n.push({resolve:e,reject:t})}))},getFromIDB:function(e,t,r,o,i,n,a){return new Promise((function(n,s){var l=e.queryCache?"getCachedData":"findAll"==r?"getAll":"get",d={resolve:n,reject:s,type:l,model:t,req:r,key:i};"getCachedData"==l&&(d.queryParams=o),d.queryCache=e.queryCache,d.customData=a,LyteIDB.postMessage(d)}))},sendXHR:function(e,t,r,o,i,n,a,s,l){var d=new XMLHttpRequest,c=new Promise((function(i,n){for(var a in d.open(o.method,o.url,!0),o.headers)d.setRequestHeader(a,o.headers[a]);d.withCredentials=!!o.withCredentials,store.$.initCB("adapter",e,"parseRequest",{args:[t,e,d,o?o.qP:void 0,r,l]}),store.emit("beforeRequest",[d,e,t,r,o.qP]),d.send(o.data),d.onreadystatechange=function(){if(4==d.readyState)return store.emit("afterRequest",[d,e,t,r,o.qP]),"2"==d.status.toString()[0]||"3"==d.status.toString()[0]?i(d):n(d)}}));return c.xhr=d,c},getSuccess:function(e,t,r,o,i,n,a,s,l,d,c){var p,u,f=s,h=i,m=c.customD;i&&i.status;if("idb"!=d){if(h&&(f=(f=h.responseText)&&0!=f.length?JSON.parse(f):JSON.parse("{}")),l&&(p=l.index,u=l.batch,h=l.resp),h){var y=store.$.initCB("adapter",e,"parseResponse",{args:[t,e,h,f,o?o.qP:void 0,r,m,c]});if(y&&(f=y.data),f instanceof Promise)return this.handleParseResponsePromise(f,e,t,r,o,i,void 0,p,u,n,a,c)}return this.findParseRequestPromise(f,e,t,r,o,i,p,u,n,c)}n(i?[f,i.statusText,i]:null!=p?[f,"batch",{index:p,batch:u}]:d?[f,"idb"]:[f])},getFailure:function(e,t,r,o,i,n,a,s,l,d,c){var p=s.customD;if(i){var u,f=i.responseText;if(f)try{f=""==f?JSON.parse("{}"):JSON.parse(f)}catch(e){Lyte.warn("LD24",e)}u=f;var h=store.$.initCB("adapter",e,"parseResponse",{args:[t,e,i,f,o?o.qP:void 0,r,p,s]});if(h&&(u=h.data),u instanceof Promise)return this.handleParseResponsePromise(u,e,t,r,o,i,void 0,void 0,void 0,n,a,s)}else if(l){var m,y;c&&(y=c.index,m=c.batch),store.$.batchResponse[m][y]={code:d,status:"requestFailure",data:l},a({code:d,status:"requestFailure",data:l})}a(i)},getResponse:function(e,t,r,o,i,n,a,s){if(!0===(void 0===s.cacheData||null===s.cacheData||"object"!=typeof s.cacheData||!s.cacheData.hasOwnProperty("normalize")||s.cacheData.normalize)){var l,d,c,p,u=e=store.serializer.$.normalizeResponse(t,r,e,o,n?n.status:n,i,a,s),f=i?i.qP:void 0;"object"!=typeof u&&(u=JSON.parse(u)),(c=store.$.initCB("serializer",t,"extractMeta",{args:[u,t,r,f,a,s]}))&&(p=c.data,store.$.isEmpty(p)||(u.meta=p));var h=Object.keys(u),m=h.length;if(m){var y;if((c=store.$.initCB("serializer",t,"payloadKey",{args:[t,r,o,f,a,s]}))&&(y=c.data)&&y!=t){var _=u[y];u[t]=_,delete u[y]}if(l=store.$.cbScp(t,"deserializeKey","serializer")){Lyte.warn("LD08","deserializeKey","callback","Please use payloadKey callback instead"),m>2&&Lyte.error("LD09");var v=0;2==m&&"meta"==h[0]&&(v=1),d=[t,r];var g=store.$.cB(l,d),b=u[h[v]];delete u[h[v]],u[g]=b}store.serializer.$.normalize(t,r,u,o,n?n.status:n,i.headers,a,s,i)}return u}return"object"!=typeof e&&(e=JSON.parse(e)),(c=store.$.initCB("serializer",t,"extractMeta",{args:[e,t,r,f,a,s]}))&&(p=c.data,store.$.isEmpty(p)||(e.meta=p)),e},initPartialObj:function(e,t,r,o,i,n){return{obj:new Map}},create:function(e,t,r,o,i,n){var a=r?"createRecord":"create",s=n?{mutation:n}:void 0,l=store.$.initCB("adapter",e,"gql",{args:[e,a,i,void 0,s,o]});o=null==o?store.$.getFromCB("adapter",e,"customData"):o;var d=this.buildURL(a,"POST",e,void 0,t,i,void 0,o,void 0,l?l.data:void 0);i=d.qP;var c=this.initPartialObj(e,a,i,void 0,d.url,o),p=store.$.toJSON(e,t,void 0,"create",c);return this.sendingData(e,p,d,a,o,t,c.obj),d.gql&&store.$.cpdGql(e,a,i,d,p,o),this.handleRequest(d,e,t,a,p,o,c.obj,void 0,void 0,c.ref)},put:function(e,t,r,o,i,n,a){var s=store.model[e],l=s.bK,d=s.isComp,c=a?{mutation:a}:void 0,p=o?"updateRecord":"update",u=(new Map,o?d&&l?r[l]:r.$.pK:void 0),f=store.$.initCB("adapter",e,"gql",{args:[e,p,n,void 0,c,i]});i=null==i?store.$.getFromCB("adapter",e,"customData"):i;var h=this.buildURL(p,"PATCH",e,u,t,n,void 0,i,void 0,f?f.data:void 0);n=h.qP;var m=this.initPartialObj(e,p,n,u,h.url,i),y=store.$.toJSON(e,t,void 0,void 0,m);return this.sendingData(e,y,h,p,i,r,m.obj),h.gql&&store.$.cpdGql(e,p,n,h,y,i),this.handleRequest(h,e,r,p,y,i,m.obj,void 0,void 0,m.ref)},del:function(e,t,r,o,i,n,a){var s=store.model[e],l=s.bK,d=s.isComp,c=a?{mutation:a}:void 0,p=o||"deleteRecord",u=r?d&&l?t[l]:t.$.pK:void 0;i=null==i?store.$.getFromCB("adapter",e,"customData"):i;var f=store.$.initCB("adapter",e,"gql",{args:[e,p,n,void 0,c,i]}),h=this.buildURL(p,"DELETE",e,u,t,n,void 0,i,void 0,f?f.data:void 0);n=h.qP;this.initPartialObj(e,p,n,u,h.url,i);var m=[];r||(m=t.map((function(e){return e.$.pK})));var y=r?t?t.$.pK:void 0:m;return this.sendingData(e,y,h,p,i,t),h.gql&&store.$.cpdGql(e,p,n,h,y,i),this.handleRequest(h,e,t,p,y,i,void 0,u)},sendingData:function(e,t,r,o,i,n,a){var s,l=e,d={},c=r?r.qP:void 0,p={};for(var u in r)p[u]=r[u];p.type=o,p.model=e,(s=store.$.initCB("serializer",e,"serializeKey",{args:[e,o,i,c]}))&&(l=s.data),t=this.serializeRecords(e,t,n,p,"serializeRecord",i,a),l?(Array.isArray(t)||"object"==typeof t||Lyte.isRecord(t))&&(d[l]=t):d=t,(s=store.$.initCB("serializer",e,"serialize",{args:[o,d,n,i,e,c,r?r.gqlObj:void 0]}))&&(d=s.data),r.data=d},serializeRecords:function(e,t,r,o,i,n,a){store.$.getFromCB("adapter",e,"modelless");var s=store.modelFor(e);if(!s)return t;var l,d=s.relations;if(r||"normalizeRecord"==i||(r=store.$.peekRecord(s._name,t.$.pK)),Array.isArray(t)){l=[];for(var c=0;c<t.length;c++){var p=t[c];p&&"object"==typeof p?l.push(this.serializeSingleRecord(s._name,p,r?r[c]:void 0,o,d,i,n,a)):l.push(p)}}else t&&(l=t,"object"==typeof t&&(l=this.serializeSingleRecord(s._name,t,r,o,d,i,n,a)));return l},serializeSingleRecord:function(e,t,r,o,i,n,a,s){var l;if("serializeRecord"==n&&"object"==typeof t&&null==t.$&&store.$.defProp(t,"$",{}),"normalizeRecord"==n&&Lyte.isRecord(t))return t;if("object"==typeof s&&r&&r.$&&r.$.pK){var d;if(l=s.get?s.get(r.$.pK):s,t.$&&t.$._partialObj)d=Object.assign({},t.$),t=Object.assign({},t),store.$.defProp(t,"$",d);var c=store.$.isDirty(r,r.$.model.relations);if(r.$.isModified||Array.isArray(c)&&0!=c.length){var p=r.$.getDirtyAttributes();Array.isArray(c)&&p.concat(c);var u=Object.keys(t);l.hasOwnProperty("_removedAttr")||Object.defineProperties(l,{_removedAttr:{value:{}}}),p.forEach((function(e){u.includes(e)||r.$.model._arrPk.includes(e)||(l._removedAttr[e]=!0)}))}Object.defineProperties(t.$,{_partialObj:{value:l},_pkVal:{value:r.$.pK},_model:{value:e},_payloadObj:{value:t}})}"serializeRecord"==n&&store.$.defpayObjUtls(t.$);var f,h=store.$.cbScp(e,n,"serializer");h&&(f="serializeRecord"==n?[o,t,r,e,a]:[o,t,e,a],t=store.$.cB(h,f));for(var m in i)for(var y=i[m],_=y.length,v=0;v<_;v++){var g,b,A,$,L=y[v],E=t[L.relKey];if("relation"==L.type&&E&&("normalizeRecord"==n||"serializeRecord"==n&&L.opts&&L.opts.serialize&&"id"!=L.opts.serialize))if(g=r?r[L.relKey]:void 0,b=L.relatedTo,A=L.opts?L.opts.serialize:void 0,$=L.opts?L.opts.polymorphic:void 0,"hasMany"===L.relType){Array.isArray(E)||(E=[E]);var R=E.length,w=[];"serializeRecord"==n&&(store.$.defProp(w,"$",{}),store.$.defPayArrUtls(w.$),l&&l[L.relKey]&&(Object.defineProperties(w.$,{_key:{value:L.relKey},_partialObj:{value:l[L.relKey]},_model:{value:b},_payloadObj:{value:w},replace:{value:store.$.replaceCheck,writable:!0},partRecMap:{value:new Map}}),L.opts&&L.opts.serialize&&Object.defineProperty(w.$,"_serialize",{value:L.opts.serialize})));for(var N=0;N<R;N++){var P=b;if($&&("normalizeRecord"==n?P=E[N]&&E[N]._type?E[N]._type:b:"serializeRecord"==n&&("record"==A?P=g&&Lyte.isRecord(g[N])?g[N].$.model._name:b:"partial"==A&&(P=E[N]&&E[N].$?E[N].$.polymorphicType:b))),"serializeRecord"==n){var C=store.modelFor(b)._pK;w.$.partRecMap.set(E[N][C],!0)}w.push(this.serializeRecords(P,E[N],void 0,o,n,a,l?l[L.relKey][N]:void 0))}t[L.relKey]=w}else{P=b;$&&("normalizeRecord"==n?P=t[L.relKey]&&t[L.relKey]._type?t[L.relKey]._type:b:"serializeRecord"==n&&(P=Lyte.isRecord(r[L.relKey])?r[L.relKey].$.model._name:b)),E&&"object"==typeof E&&!E.$&&L.opts&&L.opts.serialize&&(store.$.defProp(E,"$",{}),Object.defineProperty(E.$,"_serialize",{value:L.opts.serialize})),t[L.relKey]=this.serializeRecords(P,t[L.relKey],r?r[L.relKey]:void 0,o,n,a,l?l[L.relKey]:void 0)}else"serializeRecord"==n&&L.opts&&L.opts.serialize&&"id"==L.opts.serialize&&"relation"==L.type&&"hsaMany"==L.relType&&(store.$.defProp(t[L.relKey],"$",{}),store.$.defPayArrUtls(t[L.relKey].$),l&&l[L.relKey]&&(Object.defineProperties(t[L.relKey].$,{_key:{value:L.relKey},_partialObj:{value:l[L.relKey]},_model:{value:b},_payloadObj:{value:t[L.relKey]},replace:{value:store.$.replaceCheck,writable:!0}}),L.opts&&L.opts.serialize&&Object.defineProperty(w.$,"_serialize",{value:L.opts.serialize})))}return t},handleAjax:function(e){if(e.url&&!e.model)return Lyte.error("Please pass model param to ajax call"),Promise.reject("Please pass model param to ajax call");var t=store.adapter.$.buildURL("ajax",e.type,e.model,e.index,void 0,e.queryParams,void 0,e.customData,e.url);t.data=e.data;var r=t.qP;store.$.initCB("serializer",e.model,"serialize",{args:["ajax",t.data,void 0,e.customData,e.model,r,void 0]});return store.adapter.$.handleRequest(t,e.model,void 0,"ajax",void 0,e.customData,void 0,void 0,void 0,void 0)},handleAction:function(e,t,r,o,i,n,a){var s;r&&Lyte.isRecord(r)&&(s=r.$.get(t._pK));var l=t._name,d="action";o=null==o?store.$.getFromCB("adapter",t._name,"customData"):o;var c=this.buildURL(d,n||"POST",t._name,s,r,i,e,o);c.data=a,i=c.qP;var p=store.$.initCB("serializer",t._name,"serialize",{args:["action",a,r,o,l,i,e]});return p&&(c.data=p.data),this.handleRequest(c,t._name,void 0,d,void 0,o,void 0,void 0,e)},handleRequest:function(e,t,r,o,i,n,a,s,l,d){if(e.data&&e.data.LdEr)return Lyte.warn(e.data.LdEr,e.data.key,t),Promise.reject({code:e.data.LyteError,message:Lyte.errorCodes[e.data.LyteError],data:e.data.key});!e.data||"object"!=typeof e.data&&!Lyte.isRecord(e.data)&&!Array.isArray(e.data)||e.data instanceof FormData||(e.data=JSON.stringify(e.data));var c,p=this;return new Promise((function(i,u){var f=store.$.getFromCB("adapter",t,"processRequest"),h=!0,m=store.$.makeBatch,y=!1;if(f){h=!1;var _,v=p.callGeneric(o,t,e.data,r,n,e?e.qP:void 0,s,e.url,l,e.method,e.headers);v instanceof Promise?(y=!0,v.then((function(s){if("action"==o||"ajax"==o)try{s=JSON.parse(s)}catch(e){s=s}else s=JSON.parse(s);_=p.genericResponse(s,t,o,r,e,void 0,a,n),i(_)}),(function(e){u(e)}))):h=!0}if(m&&!y)store.adapter.$.constructBatch(t,o,s,e).then((function(a){var p=a.content;store.adapter.$.handleSuccess(t,o,c,r,e,i,p,a,void 0,u,s,n,l,d)}),(function(a){store.adapter.$.handleFailure(t,o,c,r,e,i,a.content,void 0,u,s,n,a.code,l,a)}));else if(h){var g=[t,o,s,e,i,u,"other",r,n];store.adapter.$.sendXHR.apply(store.adapter.$,g).then((function(c){store.adapter.$.handleSuccess(t,o,c,r,e,i,void 0,void 0,a,u,s,n,l,d)}),(function(d){store.adapter.$.handleFailure(t,o,d,r,e,i,void 0,a,u,s,n,void 0,l)}))}}))},handleSuccess:function(e,t,r,o,i,n,a,s,l,d,c,p,u,f){var h,m,y,_=r?r.responseText:void 0;r&&r.status;if(a)_=a;else if(_&&0!=_.length)if("action"==t)try{a=JSON.parse(_)}catch(e){a=_}else a=JSON.parse(_);else a=JSON.parse("{}");r&&(h=r),s&&(m=s.index,y=s.batch,h=s.resp);var v={customD:p};if(h){var g=store.$.initCB("adapter",e,"parseResponse",{args:[t,e,h,a,i?i.qP:void 0,c,p,void 0,u]});if(g&&(a=g.data)instanceof Promise)return this.handleParseResponsePromise(a,e,t,o,i,r,l,m,y,n,d,v)}return this.otherParseRequestPromise(a,e,t,o,i,r,l,m,y,n,d,p,f,c)},handleFailure:function(e,t,r,o,i,n,a,s,l,d,c,p,u,f){if(r){store.$.cbScp(e,"parseResponse","adapter");var h,m=r.responseText;if(m)try{m=""==m?JSON.parse("{}"):JSON.parse(m)}catch(e){Lyte.warn("LD24",e)}var y=store.$.initCB("adapter",e,"parseResponse",{args:[t,e,r,m,i?i.qP:void 0,d,c,void 0,u]});if(y&&(h=y.data)instanceof Promise)return this.handleParseResponsePromise(h,e,t,o,i,r,s,void 0,void 0,n,l,c)}else if(a){var _,v;f&&(v=f.index,_=f.batch),store.$.batchResponse[_][v]={code:p,status:"requestFailure",data:a},l({code:p,status:"requestFailure",data:a})}l(r)},updateIDB:function(e,t,r,o,i,n){r&&!Array.isArray(r)&&(r=[r]);var a=store.model[e],s=store.$.getIDBObj(a,i&&i.qP?i.qP:void 0,t,n,o);if(a&&s&&(!s||s.hasOwnProperty("queryCache"))){var l=store.$.idbQ2[e]=store.$.idbQ2[e]||[],d=s.queryCache;if(r)switch(t){case"update":case"updateRecord":r.forEach((function(t,r){if(t&&Lyte.isRecord(t)){var i=store.model[e].relations;t.$.inIDB&&t.$.inIDB.self&&l.push({type:"updateRecord",model:e,data:t.$.toJSON("idb"),queryCache:d,customData:o}),store.adapter.$.updateRelationsIDB(t,i,o),store.$.addToIDBonSave(e,t)}}));break;case"delete":case"deleteRecord":case"destroyRecord":var c=store.modelFor(e)._arrPk;r.forEach((function(t,r){if(t&&Lyte.isRecord(t)){var i=store.model[e].relations;t.$.parent;for(var n={},a=0;a<c.length;a++)n[c[a]]=t[c[a]];t.$.inIDB&&t.$.inIDB.self&&l.push({type:"deleteRecord",model:e,key:n,queryCache:d,customData:o}),store.adapter.$.updateRelationsIDB(t,i,o),store.$.removeOnSave(e,t.$.pK)}}));break;case"create":case"createRecord":r.forEach((function(t,r){if(t&&Lyte.isRecord(t)){var i=store.model[e].relations;l.push({type:"createRecord",model:e,data:t.$.toJSON("idb"),queryCache:d,customData:o}),store.adapter.$.updateRelationsIDB(t,i,o,"create"),store.$.addToIDBonSave(e,t)}}))}}else r.forEach((function(r,i){r&&Lyte.isRecord(r)&&store.adapter.$.updateRelationsIDB(r,store.model[e].relations,o,t)}))},updateRelationsIDB:function(e,t,r,o){switch(o){case"create":case"createRecord":for(var i in t){t[i].forEach((function(t){var o,i=t.relKey,n=t.relatedTo;store.$.idbQ2[n]=store.$.idbQ2[n]||[],e.$.inIDB;(o=t.dummy?store.$.getRelatedRecord(e,t.relatedTo,t.dummy):e[i])&&!Array.isArray(o)&&(o=[o]),o&&o.forEach((function(e){var t=e.$.model,o=store.$.idbQ2[t._name]=store.$.idbQ2[t._name]||[];for(var i in e.$.inIDB.self&&o.push({type:"updateRecord",model:t._name,data:e.$.toJSON("idb"),customData:r}),e.$.inIDB){var n=e.$.inIDB[i],a=store.$.idbQ2[i]=store.$.idbQ2[i]||[];n.forEach((function(e,t){a.push({type:"updateRecord",model:i,data:store.$.peekRecord(i,t).$.toJSON("idb"),customData:r})}))}}))}))}break;default:var n=e.$.inIDB;if(n)for(mKey in n){n[mKey].forEach((function(e,t){var o=store.$.peekRecord(mKey,t);(store.$.idbQ2[mKey]=store.$.idbQ2[mKey]||[]).push({type:"updateRecord",model:mKey,data:o.$.toJSON("idb"),customData:r})}))}}},callGeneric:function(e,t,r,o,i,n,a,s,l,d,c){var p=store.$.initCB("adapter",t,"processRequest",{args:[e,t,r,o,i,n,a,s,l,d,c]});return p?p.data:void 0},genericResponse:function(e,t,r,o,i,n,a,s,l){var d,c,p=e,u=(n&&n.status,i?i.qP:void 0);if(d=store.$.cbScp(t,"extractMeta","serializer"))if(p){var f=store.$.cB(d,[p,t,r,u,s]);store.$.isEmpty(f)||(p.meta=f),c=!0}else c=!1;if(p&&"action"!=r&&"ajax"!=r){if(p=store.serializer.$.buildJSON(t,r,p,Lyte.isRecord(o)?o[store.modelFor(t)._pK]:void 0,n?n.status:void 0,i,s,u),0==c&&d&&p){f=store.$.cB(d,[p,t,r,u,s]);store.$.isEmpty(f)||(p.meta=f)}var h=Object.keys(p),m=h.length;if(d=store.$.cbScp(t,"deserializeKey","serializer")){Lyte.warn("LD08","deserializeKey","callback","Please use payloadKey callback instead"),m>2&&Lyte.error("LD09");var y=0;"meta"==h[0]&&(y=1);var _=store.$.cB(d,[t,r]),v=p[h[y]];delete p[h[y]],p[_]=v}this.handleResponse(o,p,store.modelFor(t),r,a,void 0,l)}return p},removePartialKeys:function(e,t,r){var o=t.relations,i=e.$.pK;for(var n in o){o[n].forEach((function(r){var o;if(bMod=store.model[r.relatedTo],bMod&&(o=store.$.getBackwardRel(t,r,bMod))&&"hasMany"==o.relType&&o.opts&&o.opts.serialize){var n=r.relKey,a=o.relKey,s=e[n];if(s)if(Array.isArray(s))s.forEach((function(e){var t=e[a];t&&t.partial&&t.partial.get(i)&&t.partial.delete(i)}));else if(s[a]){var l=s[a];l&&l.partial&&l.partial.get(i)&&l.partial.delete(i)}}}))}},mergeError:function(e,t,r){if(r&&r.$&&r.$.isError){if(r.$.error){var o=r.$.error;for(var i in o)e.fieldList.hasOwnProperty(i)&&store.$.setRecErr(t.$,i,o[i])}return delete r.$.error,delete r.$.isError,!0}},mergeResponse:function(e,t,r,o,i,n){if(this.removePartialKeys(e,t,o),i&&Object.keys(i).length&&this.mergeNewDataKeys(i,e,r,n),!this.mergeError(t,e,r)){var a=store.$.peekRecord(e.$.model._name,e.$.pK),s=!1;e.$.isDeleted&&this.mergeDeletedRec(i,e,n),e.$.isNew&&a&&(s=this.mergeNewRecord(i,e,r,!0,n)),e.$.isModified&&a&&this.mergeModifiedRec(i,e,r,!0,s,n),t.dirty.length&&store.$.deleteFromArray(t.dirty,undefined),i&&Object.keys(i).length&&r&&!s&&r&&(a?(result=store.$.validateAndMerge(t,r,i,!0),result&&result.data?result=result.data:result&&result.type&&Lyte[result.type].apply(Lyte,result.args||[])):result=store.$.insertIntoStore(t._name,r,void 0,void 0,i)),store.adapter.$.removeDirtyStack(e,i)}},removeDirtyStack:function(e,t){if(t&&t._removedAttr&&0!=Object.keys(t._removedAttr).length)for(var r in e.$._attributes)t._removedAttr.hasOwnProperty(r)||delete e.$._attributes[r];else e.$._attributes={};e.$.undoStack=store.$.genUnRedoStack(),e.$.redoStack=store.$.genUnRedoStack(),delete e.$._savedState,store.$.clrRecErr(e.$)},removeBackwardRelDirty:function(e,t){var r=e.$.model,o=r.relations;for(var i in o){o[i].forEach((function(o){var i;e.hasOwnProperty(o.relKey)&&(store.modelFor(o.relatedTo)&&(i=store.$.getBackwardRel(r,o,store.modelFor(o.relatedTo))),i&&i.opts&&i.opts.serialize&&("hasMany"==i.relType||"belongsTo"==i.relType)&&store.adapter.$.removeRelPartial(e[o.relKey],i,t))}))}},removeRelPartial:function(e,t,r){if(Array.isArray(e))e.forEach((function(e){var o=e[t.relKey];o&&("hasMany"==t.relType?o.partial&&(o.partial.delete(r),o.partial.size||store.$.deleteDeepNest(e,t.relKey,r)):store.$.deleteDeepNest(e,t.relKey,r))}));else if(Lyte.isRecord(e)){var o=e[t.relKey];o&&("hasMany"==t.relType?o.partial&&(o.partial.delete(r),o.partial.size||store.$.deleteDeepNest(e,t.relKey,r)):store.$.deleteDeepNest(e,t.relKey,r))}},mergeNewRecord:function(e,t,r,o,i){var n,a=e.$?e.$.model:t.$.model._name,s=store.model[a],l=s._arrPk,d=t.$.pK,c=store.$.peekRecord(a,d),p=e.$?e.$.record:void 0;if(!Lyte.isRecord(p)||p===c){if(c){var u="object"==typeof d?d:d.toString(),f=!1;if(!0!==i){l.forEach((function(e){r&&r.hasOwnProperty(e)?(store.$.cmpSet(t,e,r[e],void 0,!0),f=!0):Lyte.error("LD16",a,Lyte.isRecord(t)?"object"==typeof t.$.pK?JSON.stringify(t.$.pK):t.$.pK:void 0)}));var h=store.$.getpKVal(t);store.$.cmpSet(t.$,"pK",store.$.getpKVal(t));var m="object"==typeof h?h:h.toString();s.data._recMap&&(s.data._recMap.delete(u),s.data._recMap.set(m,t)),store.$.changeRelPkMaps(t,u,m),store.$.updateNestScp(t,d)}if(f&&e&&e.$&&(e.$.processed=!0),o&&!0!==i&&((n=store.$.validateAndMerge(s,r,e,!0))&&n.data?n=n.data:n&&n.type&&Lyte[n.type].apply(Lyte,n.args||[])),store.$.cmpSet(t.$,"isNew",!1),e.hasOwnProperty("_removedAttr")&&0!=Object.keys(e._removedAttr).length)return n;store.$.cmpSet(t.$,"isModified",!1),store.$.changePersist(t,!0),store.$.deleteFromArray(s.dirty,d),store.adapter.$.removeBackwardRelDirty(t,d),(!t.$.dN||t.$.dN&&0==Object.keys(t.$.dN).length)&&store.$.removeParentNesting(t)}return n}},mergeModifiedRec:function(e,t,r,o,i,n){var a,s=s||t.$.pK;return t.$.isDeleted||!r||i||!0===n||(r&&o&&((a=store.$.validateAndMerge(t.$.model,r,e,!0))&&a.data?a=a.data:a&&a.type&&Lyte[a.type].apply(Lyte,a.args||[])),i=!0),e&&e.hasOwnProperty("_removedAttr")&&Object.keys(e._removedAttr).length||(store.$.cmpSet(t.$,"isModified",!1),store.$.changePersist(t,!0),store.$.deleteFromArray(t.$.model.dirty,t.$.pK),store.adapter.$.removeBackwardRelDirty(t,t.$.pK),(!t.$.dN||t.$.dN&&0==Object.keys(t.$.dN).length)&&store.$.removeParentNesting(t)),a},mergeDeletedRec:function(e,t){var r,o,i;e?(r=e.$.model,o=e.$.pkVal):t&&(r=t.$.model._name,o=t.$.pK);var n=(h=(i=store.model[r])._deleted.get(o))?h.data:void 0,a=store.$.peekRecord(r,o);if(n){store.$.cmpSet(n.$,"isDeleted",!1),store.$.cmpSet(n.$,"isUnloaded",!0),store.$.cmpSet(n.$,"isPersisted",!0);var s=n.$.__scpObj;for(var l in s){var d=s[l].split("_"),c=Lyte.nestScp[d[0]];c&&Lyte.removeNestScp(c._data,d[0],d[1],void 0,n,void 0,void 0,{model:r,pK:o,attr:l})}i._deleted.delete(o),store.$.removeParentNesting(n)}if(a)store.$.removeFromStore(i,o,!0,void 0,void 0,!0),store.$.removeParentNesting(a);else{var p=store.model.cachedQueries;if(p){var u=p[r];if(u&&u.length)for(var f=u.length-1;f>=0;f--){var h;if((h=u[f]).hasDeletedRecords)if(h.data)-1!==h.data[r].indexOf(n)&&u.splice(f,1)}}}e&&e.$&&e.$.parent&&(e.$.parent.$.partial={}),e&&e.$&&(e.$.processed=!0)},mergePartialObj:function(e,t,r,o,i){var n,a=store.$.peekRecord(e.$.model,e.$.pkVal),s=(t=t||a,!!a);if(!(e&&e.$&&e.$.processed||this.mergeError(store.model[e.$.model],t,r)))if("removed"!=e.$.type){if(("added"==e.$.type||t&&t.$&&1==t.$.isNew)&&s?n=this.mergeNewRecord(e,t,r,o,i):("modified"==e.$.type||"related"==e.$.type||t&&t.$&&1==t.$.isModified)&&s&&this.mergeModifiedRec(e,t,r,o,n,i),s){if("removed"!=e.$.type)for(var l in e){var d=e[l];this.mergeNewDataKeys(d,t[l],r?r[l]:void 0,i)}t.$.partial&&Object.keys(t.$.partial)&&(t.$.partial=new Map),store.adapter.$.removeDirtyStack(t,e)}}else this.mergeDeletedRec(e,t,i)},mergeNewDataKeys:function(e,t,r,o){if(e&&(t&&t.partial&&t.partial.size||1==e.partial)){var i=this;if(Array.isArray(e)){var n=!!e.replace&&e.replace;if(e.forEach((function(e,a){if(e.$){var s=store.model[e.$.model]._pK,l=store.$.getIndex(t,s,e.$.pkVal);!0===e.$.onlyDetach?(t.record&&t.key&&store.$.deleteDeepNest(t.record,t.key,e.$.pkVal),store.$.handleArrOp(t,"removeAt",void 0,l,1)):(n&&e.$.record&&e.$.record.$.isNew?n=!0:i.mergeNewDataKeys(e,-1!=l?t[l]:void 0,r?r[a]:void 0,o),t.partial&&t.partial.delete(e.$.pkVal)),(!e._removedAttr||e._removedAttr&&Object.keys(e._removedAttr).length)&&t.partial&&t.partial.delete(e.$.pkVal)}})),Array.isArray(t)&&t.partial&&t.partial.size&&t.record&&t.key&&t.record.$.model){var a=t.record.$.model.fieldList[t.key],s=[];a.opts&&/^(id|record)$/.test(a.opts.serialize)&&(t.partial.forEach((function(e,t){"removed"==e.type&&s.push(t)})),s.forEach((function(e){var r=store.$.peekRecord(t.model._name,e)||store.$.peekRecord(t.model._name,e,!0);t.partial.delete(e),r&&store.$.removeParentNesting(r)})))}}}else if(e&&e.$&&e.$.type)if(e.$.onlyDetach){var l=e.$.parent;if(l&&l.$.partial&&l.$.partial[e.$.relKey]&&l.$.partial[e.$.relKey].has(e.$.pkVal)&&"removed"==l.$.partial[e.$.relKey].get(e.$.pkVal).type){var d=store.$.peekRecord(e.$.model,e.$.pkVal)||store.$.peekRecord(e.$.model,e.$.pkVal,!0);l.$.partial[e.$.relKey].delete(e.$.pkVal),l.$.partial[e.$.relKey].size||(delete l.$.partial[e.$.relKey],Object.keys(l.$.partial).length||delete l.$.partial),d&&store.$.removeParentNesting(d)}}else this.mergePartialObj(e,t,r,void 0,o);else if(Array.isArray(e)){i=this;e.forEach((function(e,n){i.mergeNewDataKeys(e,t[n],r?r[n]:void 0,o)}))}else if("object"==typeof e)for(var c in e){e[c];this.mergeNewDataKeys(e[c],t[c],r?r[c]:void 0,o)}},handleResponse:function(e,t,r,o,i,n,a){var s,l,d,c=r._pK;if(t=t[r._name],Array.isArray(e))for(var p=0;p<e.length;p++)d=(l=e[p]).$.pK,s=i&&l&&d?i.get(d):void 0,this.mergeResponse(e[p],r,Array.isArray(t)?t[p]:t,c,s);else d=e.$.pK,s=i&&e&&d?i.get(d):void 0,this.mergeResponse(e,r,t,c,s)},compareData:function(e,t,r){if(!store.$.isEmpty(e)&&!store.$.isEmpty(t)){var o=typeof e;if(o!==typeof t)return!1;switch(o){case"string":case"number":case"boolean":if(e===t)return!0;break;case"object":return this.compareObjects(e,t,r)}}return!1},compareObjects:function(e,t,r){if(!(e instanceof Object&&t instanceof Object))return!1;if(Object.keys(e).length!=Object.keys(t).length)return!1;for(var o in e){var i=e[o],n=t[o];if(r&&Array.isArray(i)&&Array.isArray(n)){if(i.length!=n.length)return!1;for(var a=i.length,s=0;s<a;s++){if(!store.adapter.$.compareData(i[s],n[s],r))return!1}}else if(void 0===n||!store.adapter.$.compareData(i,n,r))return!1}return!0},handleBatchPromise:function(e){var t=e.response,r=e.batch;if(e.fail){store.$.batchPromise[r].forEach((function(e,t){e.reject({content:{},index:t,batch:r,code:"400",resp:{}})}))}else{var o=store.$.initCB("serializer","application","normalizeResponse",{args:[void 0,"batch",e.response]});o&&(t=o.data),t.batch_requests.forEach((function(e,t){var o=store.$.batchPromise[r][t],i=e.status.toString(),n=i[0];"2"==n?o.resolve({content:e.content,index:t,batch:r,resp:e}):"4"!=n&&"5"!=n||(store.$.batchResponse[r][t]=void 0,o.reject({content:e.content,index:t,batch:r,resp:e,code:i}))}))}delete store.$.batch[r],delete store.$.batchPromise[r]},handleParseResponsePromise:function(e,t,r,o,i,n,a,s,l,d,c,p){e.then((function(e){"findRecord"==r||"findAll"==r?store.adapter.$.findParseRequestPromise(e,t,r,o,i,n,s,l,d,p):store.adapter.$.otherParseRequestPromise(e,t,r,o,i,n,a,s,l,d,c,p?p.customD:void 0,void 0,o)}),(function(e){c(n)}))},findParseRequestPromise:function(e,t,r,o,i,n,a,s,l,d){var c=Object.assign({},d);delete c.customD;var p=this.getResponse(e,t,r,o,i,n,d?d.customD:void 0,c);l(n?[p,n.statusText,n]:null!=a?[p,"batch",{index:a,batch:s}]:[p])},otherParseRequestPromise:function(e,t,r,o,i,n,a,s,l,d,c,p,u,f){var h=this.genericResponse(e,t,r,o,i,n,a,p,u);null!=s&&(store.$.batchResponse[l][s]=h),"action"!=r&&"ajax"!=r&&this.updateIDB(t,r,o,p,i,f),d(h)}}},store.$.defProp(store.adapter,"extends",(function(e,t,r){return store.$.scExtd("adapter",e,t,r)}),!1),Lyte.$.requiredMixins.serializer=Lyte.$.requiredMixins.adapter=function(e,t,r){Object.keys(e).length&&t.forEach((function(t,o){var i=t.scope,n=t.name,a=i[r][n];if(a)for(var s in e)a[s]=e[s]}))},Lyte.$.injectServices&&(Lyte.$.injectServices.adapter=Lyte.$.injectServices.serializer=function(e,t,r,o,i,n){var a=store[r],s={};for(var l in s.as=e,s.service=t,a){var d=a[l];store.$.extendService([s],r,l,d,store,!0,n)}}),store.$.cbDef(Serializer,"serializer"),store.serializer={$:{buildJSON:function(e,t,r,o,i,n,a,s){var l=n?n.headers:void 0,d=r,c=store.$.initCB("serializer",e,"normalizeResponse",{args:[e,t,d,o,i,l,n?n.qP:void 0,a,void 0,n?n.gqlObj:void 0]});c&&(d=c.data);var p,u=/^(findRecord|findAll)$/.test(t);if(!u&&d&&"object"==typeof d&&(c=store.$.initCB("serializer",e,"payloadKey",{args:[e,t,void 0,s,a]}))){var f=c.data;if(f&&f!=e){var h=d[f];d[e]=h,delete d[f]}}if(u||d&&d[e]){if(p=d[e],!0,scope=store.$.cbScp(e,"normalize","serializer"),scope)if(Array.isArray(p))for(var m=0;m<p.length;m++)p[m]=store.$.cB(scope,[e,t,p[m],a]);else p=store.$.cB(scope,[e,t,p,a]);var y="pushPayload"!=t?{url:n.url,method:n.method,headers:n.headers,type:t,qP:n.qP,withCredentials:n.withCredentials,model:e}:void 0;p=store.adapter.$.serializeRecords(e,p,void 0,y,"normalizeRecord",a),d[e]=p}return d},normalizeResponse:function(e,t,r,o,i,n,a,s){var l=n?n.headers:void 0,d=r,c=store.$.initCB("serializer",e,"normalizeResponse",{args:[e,t,d,o,i,l,n?n.qP:void 0,a,s,n?n.gqlObj:void 0]});return c&&(d=c.data),d},normalize:function(e,t,r,o,i,n,a,s,l){var d=r,c=!1;(/^(findRecord|findAll)$/.test(t)||d[e])&&(d=d[e],c=!0);var p=store.$.cbScp(e,"normalize","serializer");if(p)if(Array.isArray(d))for(var u=0;u<d.length;u++)d[u]=store.$.cB(p,[e,t,d[u],a,s]);else d=store.$.cB(p,[e,t,d,a,s]);c&&(r={},d=store.adapter.$.serializeRecords(e,d,void 0,{url:l.url,method:l.method,headers:l.headers,type:t,qP:l.qP,withCredentials:l.withCredentials,model:e},"normalizeRecord",a),r[e]=d)}}},store.$.defProp(store.serializer,"extends",(function(e,t,r){return store.$.scExtd("serializer",e,t,r)})),Object.defineProperties(store,{modelless:{value:{}},registerModel:{get:()=>(Lyte._preRegister(),store.$.registerModel)},ajax:{value:function(e){if(!e.model)return Promise.reject("Model name is mandatory for ajax method");if(1!=store.$.getFromCB("adapter",e.model,"modelless"))return Promise.reject("Modelless behaviour is not enabled. Please enable it to make ajax call for models that are not defined");if(!e.type)return Promise.reject(e.type+" is not a valid HTTP method");var t="string"==typeof e.model?this.model[e.model]:void 0;return t&&t.fieldList?Promise.reject(e.model+" is a defined model. ajax is supported only for a model which is not defined"):store.adapter.$.handleAjax(e)}},triggerUpdate:{value:function(e,t,r,o,i,n){var a,s=[],l=[];if(null==(p=store.modelFor(e)))return Lyte.warn("LD02","Model",e),Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});a=Array.isArray(t)?t:[t];for(var d=0;d<a.length;d++){var c=store.$.peekRecord(e,a[d]);if(!c)return Promise.reject("No such record found");var p,u={},f=(p=c.$.model)._arrPk;(r||Object.keys(p.fieldList)).forEach((function(e){u[e]=c[e]})),f.forEach((function(e){u[e]=c[e]})),s.push(u),l.push(c)}var h=!1;return Array.isArray(t)||(s=s[0],l=l[0],h=!0),store.adapter.$.put(e,s,l,h,i,o,n)}},batch:{value:function(e){return new Promise((function(t,r){store.$.makeBatch=!0,store.$.batch=store.$.batch||{},store.$.batchPromise=store.$.batchPromise||{};var o,i,n=void 0===store.$.currentBatch?Object.keys(store.$.batch).length:store.$.currentBatch+1,a=store.$.currentBatch=n;e&&"function"==typeof e?o=e:e&&"object"==typeof e&&(o=e.method,i=e.customData);try{o()}catch(e){throw store.$.makeBatch=!1,e}store.$.makeBatch=!1;var s={batch:store.$.batch[a]},l=store.adapter.$.buildURL("batch","POST","application",void 0,s,void 0,void 0,i),d=s.batch;if(store.$.isEmpty(d)){if(store.$.cachedBatch&&store.$.cachedBatch[a]&&store.$.cachedBatch[a].length){var c=store.$.handleCachedResponse(a,[]);return t(c)}return t()}var p=store.$.initCB("serializer","application","serialize",{args:["batch",s,void 0,i]});p&&(s=p.data);var u=new XMLHttpRequest;for(var f in u.open("POST",l.url,!0),l.headers)u.setRequestHeader(f,l.headers[f]);u.withCredentials=!!l.withCredentials,u.send(JSON.stringify(s)),u.onreadystatechange=function(){if(4==u.readyState)if("2"==u.status.toString()[0]||"3"==u.status.toString()[0]){var e=JSON.parse(u.responseText);store.$.batchResponse=store.$.batchResponse||{},store.$.batchResponse[a]=[],store.adapter.$.handleBatchPromise({response:e,batch:a,resolve:t}),setTimeout((function(){var e=store.$.handleCachedResponse(a,store.$.batchResponse[a]);t(e),store.$.batchResponse[a]=[]}),0)}else store.$.batchResponse[a]=[],store.adapter.$.handleBatchPromise({batch:a,resolve:t,fail:!0}),setTimeout((function(){var e=store.$.handleCachedResponse(a,store.$.batchResponse[a]);r(e)}),0)}}))}},pushPayload:{value:function(e,t,r,o){var i=store.modelFor(e);if(i=store.$.getFromCB("adapter",e,"modelless")?e:i){var n,a=t;if(r){t=store.serializer.$.buildJSON(e,"pushPayload",t);var s=store.$.cbScp(e,"deserializeKey","serializer");if(n=t?Object.keys(t).length:void 0,s){Lyte.warn("LD08","deserializeKey","callback","Please use payloadKey callback instead"),n>2&&Lyte.error("LD09");var l=Object.keys(t),d=0;2==l.length&&"meta"==l[0]&&(d=1);var c=store.$.cB(s,[e,"pushPayload"]),p=t[l[d]];delete t[l[d]],t[c]=p}a=t[e]}var u=(t=store.$.insertIntoStore(e,a,!0,void 0,void 0,d,!0,void 0,o))||[];Array.isArray(u)||(u=[u]);var f=i&&i.hasOwnProperty("idb");return window.LyteIDB&&u.forEach((function(t){Lyte.isRecord(t)&&(f&&store.$.idbQ2Push(e,t,void 0,"pushPayload"),t.$.isError||t.$.inIDB&&Object.keys(t.$.inIDB).length&&store.adapter.$.updateRelationsIDB(t,t.$.model.relations))})),i&&delete i.rel,t&&Lyte.getConfig("mutable")?Lyte.mut(t):t}Lyte.warn("LD02","Model",e)}},unregisterModel:{value:function(e,t){t=!1!==t,Array.isArray(e)?e.forEach((function(e){store.$.unregisterModel(e,t)})):store.$.unregisterModel(e,t)}},unregisterAdapter:{value:function(e){Array.isArray(e)?e.forEach((function(e){store.$.unRegCb("adapter",e)})):store.$.unRegCb("adapter",e)}},unregisterSerializer:{value:function(e){Array.isArray(e)?e.forEach((function(e){store.$.unRegCb("serializer",e)})):store.$.unRegCb("serializer",e)}},addField:{value:function(e,t,r,o,i,n){var a,s=store.modelFor(e),l=[];if(s.fieldList.hasOwnProperty(t)&&"relation"==s.fieldList[t].type){var d=s.fieldList[t],c=s.relations[d.relatedTo];if(Array.isArray(c)){var p=c.indexOf(d);c.splice(p,1)}"hasMany"==d.relType&&delete s._fldGrps.hasMany[t]}if(r&&"object"==typeof r){store.$.registerField(s,t,r,l),a="relation"==r.type?"relation":"attr";n=arguments[4],i=void 0===i?arguments[3]:i}else{var u=Lyte.attr(r,o);store.$.registerField(s,t,u,l)}"relation"!=a&&(i&&!n||store.$.updateFieldValidation(s,t,n,i))}},modelFor:{value:function(e){return store.model[e]}},createRecord:{value:function(e,t,r){var o=this.$.newRecord(e,t,r);return o&&Lyte.getConfig("mutable")?Lyte.mut(o):o}},deleteRecord:{value:function(e,t){this.$.removeFromStore(store.modelFor(e),t,void 0)}},findAll:{value:function(e,t,r,o,i,n,a,s){return store.adapter.$.get("findAll",e,void 0,t,r,i,o,n,a).then((function(){var n,a,l,d=arguments,c=d[0][0],p=d[0][2],u=p?p.status:d[0][3],f="cache"==d[0][1],h="batch"==d[0][1]?d[0][2]:void 0,m="idb"==d[0][1],y=store.$.getFromCB("adapter",e,"modelless");if(n=store.model[e],a=r&&!0!==r?r:!0===r&&t&&"object"==typeof t&&Object.keys(t).length?t:void 0,n||null!=o?y&&!n&&1==o&&(l=!0):o=!1,void 0!==o&&"object"==typeof o&&null!==o&&(o=!o.hasOwnProperty("cache")||o.cache),!1===o)return!f&&a&&store.$.cacheQuery(e,a,c,u),null!=h&&(store.$.batchResponse[h.batch][h.index]=c),c;if(c&&!c.save){if(!f){if(!c||!c.hasOwnProperty(e))return void Lyte.error("LD13","findAll",e,t&&"object"==typeof t?",queryParams-"+JSON.stringify(t):"");var _=c[e];if(null==_||store.$.isEmptyArray(_))c[e]=[];else{Array.isArray(_)||Lyte.warn("LD19");var v=l?"id":void 0,g=l&&null!=s?s:v,b=store.$.toInsertData(e,c,!0,g),A=b;b&&!Array.isArray(b)&&(A=[b]),window.LyteIDB&&!m&&(A&&!A.$||b&&b.$&&!b.$.isError)&&(n&&n.hasOwnProperty("idb")&&store.$.idbQ2Push(e,A,t,"findAll",void 0,void 0,i),A.forEach((function(e){e&&e.$&&e.$.inIDB&&Object.keys(e.$.inIDB).length&&store.adapter.$.updateRelationsIDB(e,e.$.model.relations)}))),window.LyteIDB&&m&&A&&Array.isArray(A)&&A.forEach((function(e){LyteIDB.changeIDBState(e)})),c[e]=b}c.hasOwnProperty("meta")&&(c[e].$||store.$.defProp(c[e],"$",{}),c[e].$.meta=c.meta),a&&store.$.cacheQuery(e,a,c)}return null!=h&&(store.$.batchResponse[h.batch][h.index]=c[e]),Lyte.getConfig("mutable")?Lyte.mut(c[e]):c[e]}return arguments}),(function(e){return Promise.reject(e)}))}},findRecord:{value:function(e,t,r,o,i,n,a,s,l){return null==t?Promise.reject({code:"ERR20",message:Lyte.errorCodes.ERR20}):store.adapter.$.get("findRecord",e,t,r,o,n,i,a,s).then((function(){var a,s=arguments[0][0],d="cache"==arguments[0][1],c=arguments[0][2],p=c?c.status:arguments[0][3],u="batch"==arguments[0][1]?arguments[0][2]:void 0,f="idb"==arguments[0][1],h=store.model[e],m=o&&!0!==o?o:!0===o&&r&&"object"==typeof r&&Object.keys(r).length?r:void 0,y=store.$.getFromCB("adapter",e,"modelless");if(h||null!=i?y&&!h&&1==i&&(a=!0):i=!1,void 0!==i&&"object"==typeof i&&null!==i&&(i=!i.hasOwnProperty("cache")||i.cache),!1===i)return!d&&m&&store.$.cacheRecordQuery(e,t,m,s,p),null!=u&&(store.$.batchResponse[u.batch][u.index]=s),s;if(s){if(!d){var _;if(!s||!s.hasOwnProperty(e))return void Lyte.error("LD13","findRecord",e,",key-"+("object"==typeof t?JSON.stringify(t):t)+(r&&"object"==typeof r?", queryParams-"+JSON.stringify(r):""));if(!Lyte.isRecord(s)){var v=s[e];if((store.$.isEmpty(v)||store.$.isEmptyObj(v))&&(s[e]={},_=!0),("object"!=typeof v||Array.isArray(v))&&Lyte.warn("LD11"),!_){var g,b=a?"id":void 0,A=a&&null!=l?l:b,$=store.$.insertIntoStore(e,v,!0,!0,void 0,void 0,void 0,void 0,A);window.LyteIDB&&!f&&Lyte.isRecord($)&&!$.$.isError&&(Array.isArray($)||(g=[$]),h&&h.hasOwnProperty("idb")&&store.$.idbQ2Push(e,g,r,"findRecord",t,s&&s.meta?s.meta:void 0,n),g.forEach((function(e){e&&e.$&&e.$.inIDB&&Object.keys(e.$.inIDB).length&&store.adapter.$.updateRelationsIDB(e,e.$.model.relations)}))),window.LyteIDB&&f&&g&&Array.isArray(g)&&g.forEach((function(e){LyteIDB.changeIDBState(e)})),s[e]=$}s.hasOwnProperty("meta")&&(Lyte.isRecord($)?$.$.meta=s.meta:((v=s[e]).$||store.$.defProp(v,"$",{}),v.$.meta=s.meta))}!d&&m&&store.$.cacheRecordQuery(e,t,m,s)}return null!=u&&(store.$.batchResponse[u.batch][u.index]=s[e]),Lyte.getConfig("mutable")?Lyte.mut(s[e]):s[e]}return arguments}),(function(e){return Promise.reject(e)}))}},peekRecord:{value:function(e,t,r){return store.$.peekRecord(e,t,r,!0)}},peekAll:{value:function(e){var t=this.modelFor(e),r=store.$.getFromCB("adapter",e,"modelless");if(t=r?e:t){if(1!=r||!t||(t=store.modelless[t]))return arr=t.data,r?arr:Lyte.getConfig("mutable")?Lyte.mut(arr):arr}else Lyte.warn("LD02","Model ",e)}},deleteMany:{value:function(e,t){this.$.removeFromStore(store.modelFor(e),t,void 0)}},unloadRecord:{value:function(e,t,r){var o,i=this.modelFor(e),n=store.$.getFromCB("adapter",e,"modelless");if(i=n?e:i){if(1==n&&i){if(!(i=store.modelless[i]))return;o=!0}null==t&&Lyte.warn("LD18","key");var a,s=store.$.peekRecord(e,t);if(1==o)-1!=(h=store.$.getInd(i.data,i._pK,t))&&store.$.handleArrOp(i.data,"removeAt",void 0,h,1);else if(s){var l=i._fldGrps.inherit&&Object.keys(i._fldGrps.inherit).length;if(r=!1!==r,a=s.$.pK,r&&l){var d=new Map;store.$.removeChildRecords(i,s,d,!0)}else this.$.removeFromStore(i,a,!0,!0,void 0,void 0,!0);i._deleted.delete(t);var c=this.model.cachedRecordQueries;c&&c[e]&&c[e][t]&&(c[e][t]=[]);var p=store.model.cachedQueries;if(p){var u=p[e];if(u&&u.length)for(var f=u.length-1;f>=0;f--){var h,m=u[f];if(m&&m.data)-1!=(h=m.data[e].indexOf(s))&&u.splice(f,1)}}}}else Lyte.warn("LD02","Model ",e)}},unloadAll:{value:function(e,t,r){var o,i=this.modelFor(e),n=store.$.getFromCB("adapter",e,"modelless");if(i=n?e:i){if(1==n&&i){if(!(i=store.modelless[i]))return;o=!0}var a=[],s=t||store.peekAll(e);if(1==o)store.$.handleArrOp(i.data,"removeAt",void 0,0,i.data.length);else{if(s)for(var l=0;l<s.length;l++)a.push(s[l].$.pK);var d=i._fldGrps.inherit&&Object.keys(i._fldGrps.inherit).length;if((r=!1!==r)&&d)for(l=a.length-1;l>=0;l--){var c=s[l],p=new Map;store.$.removeChildRecords(i,c,p,!0)}else this.$.removeFromStore(i,a,!0,!0,void 0,void 0,!0);this.model[e].dirty=[],this.model[e]._deleted=new Map;var u=store.model.cachedQueries;u&&u[e]&&(u[e]=[]);var f=this.model.cachedRecordQueries;f&&f[e]&&(f[e]=[])}}else Lyte.warn("LD02","Model ",e)}},triggerAction:{value:function(e,t,r,o,i,n){var a=store.modelFor(e);return null==a?(Lyte.warn("LD02","Model",e),Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e})):(a.actions?a.actions[t]:void 0)?store.adapter.$.handleAction(t,a,store.peekAll(e),r,o,i,n).then((function(e){return e}),(function(e){return Promise.reject(e)})):Promise.reject({code:"ERR18",message:Lyte.errorCodes.ERR18})}},rollBack:{value:function(e){var t=this.modelFor(e);t.relations;if(null!=t){for(var r=t._pK,o=Array.from(t.dirty),i=o.length,n=0;n<i;n++){var a=this.peekRecord(e,o[n]);a&&a.$.isDeleted||(a&&a.$.isNew?this.$.rollBackNew(t,a,r):a&&a.$.isModified&&a.$.rollBackAttributes(a.$.getDirtyAttributes()))}this.$.rollBackDelete(t,void 0,!0)}else Lyte.warn("LD02","Model",e)}},create:{value:function(e,t,r,o,i,n){var a=store.modelFor(e);if(null==a)return Lyte.warn("LD02","Model",e),Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});if(Array.isArray(t)){var s=this;t.forEach((function(t){var r=s.$.newRecord(e,t);if(r.$.isError)return Promise.reject(r)}))}else if(t&&"object"==typeof t){var l=this.$.newRecord(e,t);if(l.$.isError)return Promise.reject(l)}for(var d,c=a.dirty,p=c.length,u=[],f=0;f<p;f++){var h=store.peekRecord(e,c[f]);if(h&&h.$.isNew){if(i&&-1==i.indexOf(h))continue;if(d=new error1,store.$.validateRecord(h,a.fieldList),h.$.isError&&Object.keys(h.$.error).length>0)return Promise.reject(d);u.push(h.$.record)}}return u.length?store.adapter.$.create(e,u,!1,r,o,n):Promise.resolve()}},update:{value:function(e,t,r,o,i){if(null==(n=this.modelFor(e)))return Lyte.warn("LD02","Model",e),Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});var n,a=[],s=[],l=o||store.peekAll(e),d=(n=store.model[e]).relations;return l.forEach((function(t){if(Lyte.isRecord(t)&&t.$.model._name==e){var r=t,o=store.$.isDirty(r,d);if(r&&!r.$.isNew&&!r.$.isDeleted&&(r.$.isModified||o&&o.length)){var i=store.$.updateJSON(r,n,o);a.push(i),s.push(r.$.record)}}})),a.length?store.adapter.$.put(e,a,s,!1,t,r,i):Promise.resolve()}},delete:{value:function(e,t,r,o,i,n){var a=store.modelFor(e);if(null==a)return Lyte.warn("LD02","Model",e),Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});t&&this.deleteRecord(e,t);var s=[];if(a._deleted.forEach((function(e,t){s.push(e.data)})),i){var l=[];i.forEach((function(e){-1!=s.indexOf(e.$.record)&&l.push(e.$.record)})),s=l}return s.length?store.adapter.$.del(e,s,void 0,"delete",r,o,n).then((function(e){return e}),(function(e){return Promise.reject(e)})):Promise.resolve()}},registerAdapter:{value:store.adapter.extends},registerSerializer:{value:store.serializer.extends},clearCachedQuery:{value:function(e,t,r){var o,i;!(!e||"object"!=typeof e)?(e=(i=e).modelName,t=i.key,o=r=i.cacheQuery):t&&"object"==typeof t?(o=t,t=void 0):r&&"object"==typeof r&&(o=r);var n=[];if(o){if(o){if(null==t)(s=this.model.cachedQueries)&&s[e]&&(n=s[e]);else(l=this.model.cachedRecordQueries)&&l[e]&&l[e][t]&&(n=l[e][t]);for(var a=0;a<n.length;a++)if(this.adapter.$.compareData(n[a].cacheQuery,o,!0)){n.splice(a,1);break}}}else if(e){var s=this.model.cachedQueries,l=this.model.cachedRecordQueries;s&&s.hasOwnProperty(e)&&delete s[e],l&&l.hasOwnProperty(e)&&(t?delete l[e][t]:delete l[e])}else this.model.cachedQueries=[],this.model.cachedRecordQueries={}}},getErrorMessage:{value:function(e){return Lyte.errorCodes[e]}},setErrorMessages:{value:function(e){Object.assign(Lyte.errorCodes,e)}},addEventListener:{value:function(e,t){return store.$.eventListeners.add(store,e,t)}},removeEventListener:{value:function(e){store.$.eventListeners.remove(store,e)}},emit:{value:function(e,t){store.$.eventListeners.emit(store,e,t)}},getPrimaryKey:{value:function(e){var t=store.model[e];if(t)return t._pK;Lyte.warn("LD02","Model ",e)}},getDirtyRecords:{value:function(e,t,r){var o=store.modelFor(e);if(o){for(var i=o.dirty,n=[],a={isNew:[],isModified:[],isDeleted:[]},s=0;s<i.length;s++){var l=store.$.peekRecord(e,i[s]);l&&(l.$.isNew?a.isNew.push(l):a.isModified.push(l))}if(o._deleted.size)o._deleted.forEach((function(e){a.isDeleted.push(e.data)}));if((o.dirty||o._deleted.size)&&(null!=t&&1!=t||(n=n.concat(a.isNew,a.isModified,a.isDeleted)),Array.isArray(t)&&t.forEach((function(e){n=n.concat(a[e])})),"string"==typeof t&&(n=a[t])),r)store.peekAll(e).forEach((function(e){!e||e.$.isNew||e.$.isDeleted||!e.$.isDirty()||n.includes(e)||n.push(e)}));return n}Lyte.warn("LD02","Model ",e)}}});var error1=function(e,t,r){Object.defineProperties(this,{$:{value:{isError:!0,error:r||{}}}}),e&&store.$.setError(this,e,t)};Lyte.Compile.debug=!0;var _LC=LyteComponent;_LC.needDummyComponentsDiv=!0,_LC.dummyLyteComponentsDiv=document.createElement("div"),_LC.dummyLyteComponentsDiv.setAttribute("id","dummy-lyte-components-div"),Lyte._ie||("complete"===document.readyState||"interactive"===document.readyState?document.body.appendChild(_LC.dummyLyteComponentsDiv):document.addEventListener("DOMContentLoaded",(function(){document.body.appendChild(_LC.dummyLyteComponentsDiv)}),!0)),Lyte.Compile.elifHold=!1,Lyte.Compile.getArgString=function(e,t){for(var r=0;r<t.length;r++)"object"==typeof t[r]&&(t[r]=this.getArgString(t[r].value.name,t[r].value.args));return e?e+"("+t.toString()+")":t.toString()},Lyte.Compile.trimAttr=function(e,t,r){var o;o=e.replace(/((const)|(continue)|(default)|(delete)|(do)|(else)|(enum)|(export)|(extends)|(finally)|(for)|(function)|(if)|(import)|(in)|(instanceof)|(new)|(return)|(super)|(switch)|(try)|(typeof)|(var)|(void)|(while)|(with))(?!\w)/g,"__LyteHelper$1__");try{var i=expHandlers.handleExpression(Espree.parse(o),!0);i&&i!==o&&(e="{{"+(i=i.replace(/__LyteHelper(\w*?)__/g,"$1"))+"}}")}catch(i){e=o=o.replace(/__LyteHelper(\w*?)__/g,"$1"),r.push({message:i.message+t.nodeName+"in the value "+e})}return e},Lyte.Compile.compIntell={},Lyte.Compile.getDynamicNodes=function(e,t,r,o){var i;window.pending=!0;var n,a,s=[],l=[];if((a=r||document.querySelector("template[tag-name='"+e+"']"))?n=Lyte._ie?a:a.content:(e,s.push({message:"Cannot find template "+e}),i={componentName:e,errors:s,warning:l}),o&&(o.directives={},this.compIntell[e]=o),n){this.splitTextNodes(n,l);var d=[];null!=a.getAttribute("use-strict")&&(n.querySelector("script")&&s.push({message:"Security: Script tags should not be included",strict:!0}),n.querySelector("style")&&s.push({message:"Security: Style tags should not be included",strict:!0}));var c=[];this.newGetDeepNodes(e,a,c,[],void 0,!0,s,l),this.processTemplate(n,d,e,null!==a.getAttribute("use-strict"),s,l),i=s.length?{componentName:e,errors:s,warnings:l}:{componentName:e,dynamicNodes:d,_templateAttributes:c[0],template:JSON.stringify(a.outerHTML)},o&&(this.compIntell[e]=null,delete this.compIntell[e])}return window.pending=!1,i},Lyte.Compile.splitTextNodes=function(e,t){if("TABLE"===e.tagName&&e.children[0]&&"TBODY"!==e.children[0].tagName){var r=e.cloneNode(),o=document.createElement("tbody");o.innerHTML=e.innerHTML,r.appendChild(o),e.replaceWith(r),e=r}if(e.hasAttribute)if(e.hasAttribute("lyte-for")){var i=e.getAttribute("lyte-for"),n={};if(e.hasAttribute("lyte-options"))try{n=JSON.parse(e.getAttribute("lyte-options"))}catch(e){n={}}var a=i.split(" ");"TEMPLATE"===e.tagName?s=e:(s=document.createElement("template"),e.removeAttribute("lyte-for"),e.removeAttribute("lyte-options"),s.innerHTML=e.outerHTML,e.hasAttribute("node-id")&&s.setAttribute("node-id",e.getAttribute("node-id")),e.replaceWith(s),e=s),e.removeAttribute("lyte-for"),e.removeAttribute("lyte-options"),s.setAttribute("items",a[0]),s.setAttribute("item",a[2]||"item"),s.setAttribute("index",a[3]||"index"),s.setAttribute("is","for"),n.unbound&&s.setAttribute("unbound",n.unbound);let t=e.nextElementSibling;if(t&&(t.hasAttribute("lyte-await")||t.hasAttribute("lyte-fail"))){let r=document.createElement("template");r.setAttribute("case","true"),r.innerHTML=s.innerHTML,s.innerHTML="",s.content.appendChild(r),s.setAttribute("has-child",!0),this.ifNextElementSibling(t,s,svg),t=e.nextElementSibling,t&&this.ifNextElementSibling(t,s,svg)}}else if(e.hasAttribute("lyte-for-in")){i=e.getAttribute("lyte-for-in"),n={};if(e.hasAttribute("lyte-options"))try{n=JSON.parse(e.getAttribute("lyte-options"))}catch(e){n={}}var s;a=i.split(" ");"TEMPLATE"===e.tagName?(s=e,e.removeAttribute("lyte-for-in"),e.removeAttribute("lyte-options")):(s=document.createElement("template"),e.removeAttribute("lyte-for-in"),e.removeAttribute("lyte-options"),s.innerHTML=e.outerHTML,e.hasAttribute("node-id")&&s.setAttribute("node-id",e.getAttribute("node-id")),e.replaceWith(s),e=s),s.setAttribute("object",a[0]),s.setAttribute("value",a[2]||"value"),s.setAttribute("key",a[3]||"key"),s.setAttribute("is","forIn"),n.unbound&&s.setAttribute("unbound",n.unbound);let t=e.nextElementSibling;if(t&&(t.hasAttribute("lyte-await")||t.hasAttribute("lyte-fail"))){let r=document.createElement("template");r.setAttribute("case","true"),r.innerHTML=s.innerHTML,s.innerHTML="",s.content.appendChild(r),s.setAttribute("has-child",!0),this.ifNextElementSibling(t,s,svg),t=e.nextElementSibling,t&&this.ifNextElementSibling(t,s,svg)}}else if(e.hasAttribute("lyte-if")){var l=this.handleLyteIf(e);e.replaceWith(l),e=l}else e.hasAttribute("lyte-switch")&&this.handleLyteSwitch(e);if(e&&e.childNodes&&e.childNodes.length)for(var d=e.childNodes.length-1;d>=0;d--){var c=e.childNodes[d];c.hasAttribute?c.hasAttribute("lyte-if-else")||c.hasAttribute("lyte-else")?c.previousElementSibling&&(c.previousElementSibling.hasAttribute("lyte-if")||c.previousElementSibling.hasAttribute("lyte-else-if"))||t.push({message:"Element with lyte-else must be preceded by a element having lyte-if or lyte-else :\n \t"+c.cloneNode().outerHTML}):("false"==e.childNodes[d].getAttribute("case")&&(this.elifHold=!0),this.splitTextNodes(e.childNodes[d],t)):this.splitTextNodes(e.childNodes[d],t)}if("TEMPLATE"!==e.tagName||Lyte._ie||this.splitTextNodes(e.content?e.content:this.createDocFragment(e)),e.nodeType===e.TEXT_NODE){var p=e.nodeValue;if(p){var u=p.match(/{{[^}]*?(?:(?:('|")[^\1]*?\1)[^}]*?)*}}/g);if(!u)return;var f=[];for(d=0;d<u.length;d++){var h=p.indexOf(u[d]),m=h+u[d].length;h&&f.push(document.createTextNode(p.substring(0,h))),f.push(document.createTextNode(p.substring(h,m))),p=p.substring(m)}f.push(document.createTextNode(p)),e.replaceWith.apply(e,f)}}},Lyte.Compile.processTemplate=function(e,t,r,o,i,n){var a=e.querySelector("template[is=break]");a&&this.getTrimmedContent(e,void 0,a);var s=e.querySelector("template[is=continue]");if(s&&this.getTrimmedContent(e,void 0,s),this.helperNodes=[],e.hasChildNodes())for(var l=0;l<e.childNodes.length;l++){var d=[];d.push(l);if(e.childNodes[l].tagName){var c=e.childNodes[l].tagName,p=e.childNodes[l].getAttribute("is");"TEMPLATE"===c&&p?this.newGetDeepNodes(r,e.childNodes[l],t,d,p,o,i,n):this.newGetDeepNodes(r,e.childNodes[l],t,d,void 0,o,i,n)}else this.newGetDeepNodes(r,e.childNodes[l],t,d,void 0,o,i,n)}},Lyte.Compile.newGetDeepNodes=function(e,t,r,o,i,n,a,s){var l;t._parent=t.parentNode;if(8!=t.nodeType){if(t.tagName&&-1!==t.tagName.indexOf("-")&&"LYTE-YIELD"!==t.tagName&&(l={type:"componentDynamic",position:o.slice()}),"LYTE-YIELD"===t.tagName)l={type:"insertYield",position:o.slice()};else if("registerYield"===i||"yield"===i){var d=[];this.processTemplate(Lyte._ie?t:t.content,d,e,n,a,s),l={type:"registerYield",position:o.slice(),dynamicNodes:d}}else if("insertYield"===i)r.push({type:"insertYield",position:o.slice()});else if("for"===i){t._forTemplate={};var c=t;if(t.hasAttribute("has-child")){let r={},d=t.content.querySelectorAll("[case]");for(var p={},u=0;u<d.length;u++){let o=d[u];f=d[u];let i=o.getAttribute("case");o.setAttribute("case",i),o=o.content;let l=[];o._parent=t,this.processTemplate(o,l,e,n,a,s,nearByParent),r[i]={dynamicNodes:l},this.replaceCaseNode(f,e,a,t,p,nearByParent)}l={type:"for",position:o.slice(),cases:r},p.svg&&(l.svg=!0),t=this.replaceParentNode(t,i,l,e,a,void 0,nearByParent)}else if(c){t._forTemplate.content=c.content,t._forTemplate.content._parent=c;d=[];this.processTemplate(Lyte._ie?t._forTemplate:t._forTemplate.content,d,e,n,a,s),l={type:"for",position:o.slice(),dynamicNodes:d},t=this.replaceParentNode(t,"for",l)}}else if("forIn"===i){t._forInTemplate={};c=t;if(t.hasAttribute("has-child")){let r={},i=t.content.querySelectorAll("[case]");for(p={},u=0;u<i.length;u++){let d=i[u];f=i[u];let c=d.getAttribute("case");d.setAttribute("case",c),d=d.content;let h=[];d._parent=t,this.processTemplate(d,h,e,n,a,s,nearByParent),l={type:"forIn",position:o.slice(),cases:r},r[c]={dynamicNodes:h},this.replaceCaseNode(f,e,a,t,p,nearByParent)}}else if(c){t._forInTemplate.content=c.content,t._forInTemplate.content._parent=c;d=[];this.processTemplate(Lyte._ie?t._forInTemplate:t._forInTemplate.content,d,e,n,a,s),l={type:"forIn",position:o.slice(),dynamicNodes:d}}t=this.replaceParentNode(t,"forIn",l)}else if("switch"===i||"if"===i){var f,h={},m={},y=t.content.querySelector("[default]"),_=t.content.querySelectorAll("[case]");for(u=0;u<_.length;u++){var v=_[u];f=_[u];var g=v.getAttribute("case");if("switch"===i&&""==g&&(g='""'),"TEMPLATE"!==v.tagName||v.getAttribute("is")){var b=document.createElement("template"),A=v.cloneNode(!0);b.content.appendChild(A),b.setAttribute("case",g),A.removeAttribute("case"),f=b,v=b.content,_[u].replaceWith(b)}else v.setAttribute("case",g),v=v.content;d=[];if(v._parent=t,this.processTemplate(v,d,e,n,a,s),"if"===i&&this.replaceCaseNode(f),""===g&&(g='""'),h[g]={dynamicNodes:d},"if"!==i)(E=v.querySelector("template[is=break]"))?E.remove():_[u+1]?h[g].additional={next:_[u+1].getAttribute("case")}:y&&(h[g].additional={default:!0}),this.replaceCaseNode(f)}if(y){var $,L,E;if("TEMPLATE"!==y.tagName||y.getAttribute("is")){b=document.createElement("template"),A=y.cloneNode(!0);b.content.appendChild(A),b.setAttribute("default",""),A.removeAttribute("default"),$=b.content,L=b,y.replaceWith(b)}else $=y.content,L=y;(E=L.content.querySelector("template[is=break]"))&&E.remove();d=[];$._parent=t,this.processTemplate($,d,e,n,a,s),m={dynamicNodes:d},this.replaceCaseNode(L)}l={type:i,position:o.slice(),cases:h,default:m},t=this.replaceParentNode(t,i,l)}else if("component"===i){t._componentTemplate={},t._componentTemplate.content=t.content;d=[];this.processTemplate(t._componentTemplate.content,d,e,n,a,s),l={type:"component",position:o.slice(),dynamicNodes:d}}else if(3==t.nodeType){if(-1!==t.nodeValue.indexOf("{{")){var R,w,N=t.nodeValue;if("undefined"!=typeof Espree&&"undefined"!=typeof expHandlers)if(w=N.match(/{{[^}]*?(?:(?:[^\1]*?\1)[^}]*?)*}}/g)){for(var P=0;P<w.length;P++)R=this.trimAttr(w[P],t,a),N=N.replace(w[P],R);t.nodeValue=N}var C,O=this.getMustache(t.nodeValue);if(O&&"object"==typeof O&&!1===O.bool&&a.push({message:"Syntax error in node "+O.err+" in "+t.nodeName+" for the attribute: "+t.nodeName+" - "+t.nodeValue+" in the component "+e}),O){if(!1===(C=this.getHelper(O)))return void a.push({message:"Syntax Error in node "+t.nodeName+"for :"+t.nodeValue+" in the component "+e})}else a.push({message:"Syntax Error in node "+t.nodeName+"for :"+t.nodeValue+" in the component "+e});var T=O;C?r.push({type:"text",position:o.slice(),helperInfo:C}):T&&r.push({type:"text",position:o.slice(),dynamicValue:T})}return void o.pop()}if(t.hasAttributes&&t.hasAttributes()){var S=!1,k=[],x={},D=[];for(u=0;u<t.attributes.length;u++){if(-1!==t.attributes[u].nodeValue.indexOf("{{")){N=t.attributes[u].nodeValue;if("undefined"!=typeof Espree&&"undefined"!=typeof expHandlers&&(w=N.match(/{{[^}]*?(?:(?:[^\1]*?\1)[^}]*?)*}}/g))){for(P=0;P<w.length;P++)R=this.trimAttr(w[P],t,a),N=N.replace(w[P],R);t.attributes[u].nodeValue=N}var j,I=this.getMustache(N);if(I&&"object"==typeof I&&!1===I.bool){a.push({message:"Syntax error in node "+I.err+" in "+t.nodeName+" for the attribute: "+t.attributes[u].nodeName+" - "+t.attributes[u].nodeValue+" in the component "+e});continue}if(I){if(!1===(j=this.getHelper(I))){a.push({message:"Syntax error in node "+t.nodeName+" for the attribute:"+t.attributes[u].nodeName+"- "+t.attributes[u].nodeValue});continue}}else/{{.*}}/.test(N)&&!/\\{{.*}}/.test(N)&&(j=this.splitMixedText(N));if(j&&("action"===j.name||"method"===j.name)&&/^(onfocus|onfocusin|onfocusout|onresize|onscroll|onclick|ondblclick|onmousedown|onmouseup|onmousemove|onmouseover|onmouseout|onchange|onselect|onsubmit|onkeydown|onkeypress|onkeyup|oncontextmenu)$/.test(t.attributes[u].name)){S=!0,x[t.attributes[u].name.substr(2)]={name:t.attributes[u].name.substr(2),helperInfo:j,globalEvent:!0};var M=this.deepCopyObject(j.args),B=M.splice(0,1)[0];"string"==typeof B&&B.startsWith("'")?B=B.startsWith("'")?B.replace(/'/g,""):B:a.push({message:" action or method must start with string on "+t.nodeName+" for the attribute:"+t.attributes[u].nodeName+"- "+t.attributes[u].nodeValue});this.getArgString(B,M);k.push(t.attributes[u].name)}else if(j||I){S=!0;var F={};t.attributes[u].name.startsWith("lbind:")?(k.push(t.attributes[u].name),D.push({name:t.attributes[u].name.substring(6),value:t.attributes[u].nodeValue}),F.isLbind=!0,F.name=t.attributes[u].name.substring(6)):F.name=t.attributes[u].name,j?"lbind"===j.name?(F.dynamicValue=j.args[0],F.isLbind=!0):F.helperInfo=j:F.dynamicValue=I,S=!0,x[F.name]=F}}else/^(onfocus|onfocusin|onfocusout|onresize|onscroll|onclick|ondblclick|onmousedown|onmouseup|onmousemove|onmouseover|onmouseout|onchange|onselect|onsubmit|onkeydown|onkeypress|onkeyup|oncontextmenu|ondragstart|ondrag|ondragenter|ondragleave|ondragover|ondrop|ondragend|onload|onunload|onabort|onerror|onscroll|onreset|onblur)$/.test(t.attributes[u].nodeName)&&n&&a.push({message:"Strict-Mode: Please specify action in "+t.nodeName+" for attribute-"+t.attributes[u].nodeName,strict:!0});if(t.attributes[u].name.startsWith("@")&&-1==t.attributes[u].nodeValue.indexOf("{{")){S=!0,t._special=!0;let r={};r.name=t.attributes[u].name,r.stringValue=t.attributes[u].nodeValue,x[r.name]=r;let o=r.name;if(o=o.substring(1),("prop"==o||"data"==o)&&this.compIntell[e]){let i=this.compIntell[e].directives;i[o]||(i[o]=[]);let n={nodeName:t.localName,propName:r.stringValue};i[o].push(n),this.getParentFor(t,n)}}}if(x&&S){var K={},H=Object.keys(x);-1!==H.indexOf("style")&&(K.style=x.style),-1===H.indexOf("type")||"BUTTON"!==t.tagName&&"INPUT"!==t.tagName||(K.type=x.type),"INPUT"===t.tagName&&"number"===t.getAttribute("type")&&(K.value=x.value),-1!==H.indexOf("placeholder")&&"TEXTAREA"===t.tagName&&(t.removeAttribute("placeholder"),K.placeholder=x.placeholder),Object.keys(K).length?r.push({type:"attr",position:o.slice(),attr:K}):r.push({type:"attr",position:o.slice(),attr:x})}}if(t.hasChildNodes()&&"TEMPLATE"!==t.tagName)for(u=0;u<t.childNodes.length;u++)if(o.push(u),t.childNodes[u].tagName){var V=t.childNodes[u].tagName;i=t.childNodes[u].getAttribute("is");V&&i?this.newGetDeepNodes(e,t.childNodes[u],r,o,i,n,a,s):this.newGetDeepNodes(e,t.childNodes[u],r,o,void 0,n,a,s)}else this.newGetDeepNodes(e,t.childNodes[u],r,o,void 0,n,a,s);l&&r.push(l),o.pop()}else o.pop()},Lyte.Compile.getParentFor=function(e,t){let r=e;for(;r;){let e=r._parent;e&&e&&e.tagName&&"TEMPLATE"==e.tagName&&("for"==e.getAttribute("is")||"forIn"==e.getAttribute("is"))&&(t.parent={nodeId:e.getAttribute("node-id"),nodeType:e.getAttribute("is")},t=t.parent),r=e}},Lyte.Compile.createDocFragment=function(e){for(var t=e.cloneNode(!0).childNodes,r=document.createDocumentFragment(),o=t.length,i=0;i<o;i++)r.appendChild(t[0]);return r},Lyte.Compile.getDynamicValue=function(e){for(var t,r,o=[],i=o,n=[],a="",s=[],l=[],d=[],c=0;c<e.length;c++)if("."!==e[c])if("["!==e[c]){if(('"'===e[c]||"'"===e[c])&&e[c++]===t){for(;"s"===e[c]&&"]"!=e[c];)c++;s.pop(),r=!0}"]"!==e[c]?a=a.concat(e[c]):(l.pop(),a.length&&(!0===r||isNaN(parseInt(a))?i.push(a):d.length&&(i=d.pop(),n.length&&Array.isArray(i[i.length-1])&&!i[i.length-1].length&&i.pop(),i.push(a),!l.length&&n.length&&n.shift())),!l.length&&n.length?(o.push(n.shift()),i=o):d.length&&!n.length&&(i=d.pop()),a="",r="")}else{for(l.push(c),a.length&&i.push(a);"s"===e[c+1];)c++;'"'===e[c+1]||"'"===e[c+1]?(s.push(e[c+1]),t=e[c+1],c++):n.length?(i.push([]),d.push(i),i=i[i.length-1]):(n.push([]),d.push(i),i=n[n.length-1]),a=""}else a.length&&i.push(a),a="";return a.length&&o.push(a),s.length||l.length,o},Lyte.Compile.deepCopyObject=function(e){for(var t,r,o,i,n,a,s=[{source:e,target:Object.create(Object.getPrototypeOf(e))}],l=[e],d=s[0].target,c=[d];t=s.shift();)for(r=Object.getOwnPropertyNames(t.source),o=0;o<r.length;o++)(i=Object.getOwnPropertyDescriptor(t.source,r[o])).value&&"object"==typeof i.value?(n=i.value,i.value=Array.isArray(n)?[]:Object.create(Object.getPrototypeOf(n)),-1==(a=l.indexOf(n))?(l.push(n),c.push(i.value),Object.defineProperty(t.target,r[o],i),s.push({source:n,target:i.value})):(i.value=c[a],Object.defineProperty(t.target,r[o],i))):Object.defineProperty(t.target,r[o],i);return d},Lyte.Compile.replaceCaseNode=function(e){for(var t,r,o=0;o<e.content.children.length;o++)if("TEMPLATE"!==e.content.children[o].tagName){/^(TR|TD|TH)$/.test(e.content.children[o].tagName)&&(t=e.content.children[o].tagName);break}t&&("TR"===t?((r=e.cloneNode()).innerHTML="<table><tbody>"+e.innerHTML+"</tbody></table>",r.setAttribute("depth",2)):((r=e.cloneNode()).innerHTML="<table><tbody><tr>"+e.innerHTML+"</tr></tbody></table>",r.setAttribute("depth",3)),e.replaceWith(r))},Lyte.Compile.replaceParentNode=function(e,t,r){if(!e.parentElement)return e;var o,i=e.parentElement.tagName,n=e.cloneNode();if(e.parentElement&&/^(SELECT|TR|TABLE|TBODY)$/.test(i)){switch(i){case"SELECT":o="option";break;case"TR":n.innerHTML="<table><tbody><tr>"+e.innerHTML+"</tr></tbody></table>",n.setAttribute("depth",3),o="td";break;case"TABLE":case"TBODY":n.innerHTML="<table><tbody>"+e.innerHTML+"</table></tbody>",n.setAttribute("depth",2),o="tr"}var a=document.createElement(o);document.createElement(i);switch(t){case"for":a.setAttribute("is","for"),a.setAttribute("lyte-for","true"),e.hasAttribute("unbound")&&a.setAttribute("unbound",e.getAttribute("unbound"));break;case"if":case"switch":a.setAttribute("is",t),a.setAttribute("lyte-"+t,"true");break;case"forIn":a.setAttribute("is","forIn"),a.setAttribute("lyte-forIn","true"),e.hasAttribute("unbound")&&a.setAttribute("unbound",e.getAttribute("unbound"))}for(var s=e.attributes,l=0;l<s.length;l++)a.setAttribute(s[l].nodeName,s[l].nodeValue);return"SELECT"===i||"for"!==t&&"forIn"!==t?r.actualTemplate=e.outerHTML:(r.actualTemplate=n.outerHTML,r.tagName=i,n.hasAttribute("depth")&&a.setAttribute("depth",n.getAttribute("depth"))),e.replaceWith(a),a}return e},Lyte.Compile.siblingNullCheck=function(e){return null===e.previousSibling.nodeValue||null===e.nextSibling.nodeValue?null:1},Lyte.Compile.handleLyteIf=function(e){var t;e.hasAttribute("lyte-if")?(t=e.getAttribute("lyte-if"),e.removeAttribute("lyte-if")):e.hasAttribute("lyte-else-if")&&(t=e.getAttribute("lyte-else-if"),e.removeAttribute("lyte-else-if"));var r,o=document.createElement("template");o.setAttribute("is","if"),o.setAttribute("value",t),this.elifHold&&(o.setAttribute("el",!0),this.elifHold=!1),"TEMPLATE"===e.tagName?(r=e.cloneNode()).innerHTML=e.innerHTML:(r=document.createElement("template")).innerHTML=e.outerHTML,o.content.appendChild(r),r.setAttribute("case","true");let i=e.nextElementSibling;return i&&(this.ifNextElementSibling(i,o),i=e.nextElementSibling,i&&(i.hasAttribute("lyte-await")||i.hasAttribute("lyte-fail"))&&(this.ifNextElementSibling(i,o),i=e.nextElementSibling,i&&this.ifNextElementSibling(i,o))),o},Lyte.Compile.appendBreak=function(e){var t=document.createElement("template");t.setAttribute("is","break"),e.content.appendChild(t)},Lyte.Compile.ifNextElementSibling=function(e,t,r,o){var i,n;return e.hasAttribute("lyte-else")?n="lyte-else":e.hasAttribute("lyte-else-if")?n="lyte-else-if":e.hasAttribute("lyte-await")?n="__lyteAwait__":e.hasAttribute("lyte-fail")&&(n="__lyteFail__"),n&&("lyte-else"===n?(e.removeAttribute("lyte-else"),r&&"template"==e.tagName?((i=document.createElement("template")).setAttribute("case","false"),i.innerHTML=e.innerHTML):"TEMPLATE"===e.tagName?(i=e.cloneNode()).innerHTML=e.innerHTML:((i=document.createElement("template")).setAttribute("case","false"),i.innerHTML=e.outerHTML),i.setAttribute("case","false"),e.nextSibling&&e.previousSibling&&this.siblingNullCheck(e)&&""===e.nextSibling.nodeValue.trim()&&""===e.previousSibling.nodeValue.trim()&&e.nextSibling.remove(),e.remove()):"__lyteAwait__"===n||"__lyteFail__"==n?("__lyteAwait__"==n?e.removeAttribute("lyte-await"):"__lyteFail__"==n&&e.removeAttribute("lyte-fail"),r&&"template"==e.tagName?((i=document.createElement("template")).setAttribute("case",n),i.innerHTML=e.innerHTML):"TEMPLATE"===e.tagName?(i=e.cloneNode()).innerHTML=e.innerHTML:((i=document.createElement("template")).setAttribute("case",n),i.innerHTML=e.outerHTML),i.setAttribute("case",n),e.nextSibling&&e.previousSibling&&this.siblingNullCheck(e)&&""===e.nextSibling.nodeValue.trim()&&""===e.previousSibling.nodeValue.trim()&&e.nextSibling.remove(),e.remove()):((i=document.createElement("template")).setAttribute("case","false"),i.innerHTML=this.handleLyteIf(e,r).outerHTML,e.nextSibling&&e.previousSibling&&this.siblingNullCheck(e)&&""===e.nextSibling.nodeValue.trim()&&""===e.previousSibling.nodeValue.trim()&&e.nextSibling.remove(),e.remove()),o&&this.appendBreak(i),t.content.appendChild(i)),i},Lyte.Compile.handleLyteSwitch=function(e){var t,r,o,i=e.getAttribute("lyte-switch");"TEMPLATE"===e.tagName?((t=e).removeAttribute("lyte-switch"),r=Array.from(t.content.children),o="template"):(e.removeAttribute("lyte-switch"),(t=document.createElement("template")).setAttribute("nt",!0),r=Array.from(e.children));for(var n=0;n<r.length;n++){var a=r[n];if(a.hasAttribute("lyte-case")){var s="TEMPLATE"===a.tagName,l=a,d=a.hasAttribute("lyte-break"),c=a.getAttribute("lyte-case");if(a.removeAttribute("lyte-case"),a.removeAttribute("lyte-break"),a.hasAttribute("lyte-if")?(s=!1,a=this.handleLyteIf(a)):a.hasAttribute("lyte-switch")&&(s=!1,this.handleLyteSwitch(a)),s?(t.content.appendChild(a),a.setAttribute("case",c),a.removeAttribute("lyte-case")):((l=document.createElement("template")).setAttribute("case",c),a.removeAttribute("lyte-case"),l.content.appendChild(a),t.content.appendChild(l)),d){var p=document.createElement("template");p.setAttribute("is","break"),l.content.appendChild(p),a.removeAttribute("lyte-break")}}}var u=o?e.content.querySelector("[lyte-default]"):e.querySelector("[lyte-default]");if(u){var f="TEMPLATE"===u.tagName;if(u.removeAttribute("lyte-default"),u.hasAttribute("lyte-if")?(f=!1,u=this.handleLyteIf(u)):u.hasAttribute("lyte-switch")&&(f=!1,this.handleLyteSwitch(u)),f)t.content.appendChild(u),u.setAttribute("default","");else{var h=document.createElement("template");h.setAttribute("default",""),h.content.appendChild(u),t.content.appendChild(h)}}let m=e.nextElementSibling;m&&(m.hasAttribute("lyte-await")||m.hasAttribute("lyte-fail"))&&(this.ifNextElementSibling(m,t,svg,!0),m=e.nextElementSibling,m&&this.ifNextElementSibling(m,t,svg,!0)),t.setAttribute("value",i),t.setAttribute("is","switch"),o?e=t:e.innerHTML=t.outerHTML},Lyte.Component.compileDynamicTemplate=function(e,t){if(e&&e.hasAttribute("lyte-rendered")){if(t){if("string"==typeof t){var r=document.createElement("div");r.innerHTML=t,t=r.childNodes[0]}var o=document.createElement("template");Lyte._ie?o.appendChild(t):o.content.appendChild(t);var i=Lyte.Compile.getDynamicNodes(e.tagName,void 0,o);return _LC.doCompile(o.content,i.dynamicNodes,e.localName,e.constructor,void 0,e.component.constructor),e.renderNodes(o,i.dynamicNodes,void 0,{},!0,{},o.outerHTML)}console.error("No template is provided for appending")}else console.error("Provided element is not a component / not rendered yet")},Lyte.Component.doDomProcessing=function(e,t){_LC.ignoreDisconnect=!0,t?e.call(t):e(),_LC.ignoreDisconnect=!1},Lyte.Component.getComponentTemplate=function(e){var t=_LC.dummyLyteComponentsDiv.querySelector("template[tag-name='"+e+"']");if(t){if(t.content)return t.content;var r=document.createElement("div");return r.innerHTML=t.outerHTML,r.querySelector("template")}console.error("No such component is registered")},Lyte.Compile.getTemplateFromString=function(e,t){var r=document.createElement("div");return r.innerHTML=e,r.remove(),r.firstChild},Lyte.Compile.addComponentTemplate=function(e,t){var r=document.createElement("template");if(t){var o=document.createElement("template");o.setAttribute("tag-name",t),o.innerHTML=e,r.content.appendChild(o)}else r.innerHTML=e;Lyte.Compile.componentsDiv.appendChild(r.content)},Lyte.Compile.compileComponent=function(e,t){let r=e.name,o=e.template,i=e.style,n=e.js,a=e.observedAttributes,s=e.widgetName,l=e.mixins,d="";if("string"!=typeof r||""==r)return{errors:[{message:"Invalid Component Name - "+r}]};if("string"!=typeof o||""==o)return{errors:[{message:"Invalid Template String - "+o}]};if("string"!=typeof n||""==n)return{errors:[{message:"Invalid Javascript String - "+n}]};{let e,u=document.createElement("div");if(u.innerHTML=o,e=this.getDynamicNodes(r,void 0,u.firstChild,t),e.errors&&e.errors.length)return console.error("Errors in the component ",r," during compilation!",e.errors),{componentName:r,errors:e.errors};e.warnings&&e.warnings.length&&console.warn("Warnings in the component ",r," during compilation!",e.warnings),i="string"!=typeof i||""==i?"":"<style>"+i+"</style>";var c=/Lyte.Component.register\(+[\"\']+[a-zA-Z0-9\-]+[\"\']\s*[\,]+[\s\{]+/g.exec(n);let f=addWidgetName=!0;if(!c){let e,t,o=n.indexOf("class ");-1!=o?(e=n.substring(0,o),t=n.substring(o)):(e="",t=n);let i="";i=l?"{ mixins :"+JSON.stringify(l)+"}":"{}",n=e+'Lyte.Component.register("'+r+'", {}, '+i+", "+(s?'"'+s+'", '+t+")":' "", '+t+")"),c=/Lyte.Component.register\(+[\"\']+[a-zA-Z0-9\-]+[\"\']\s*[\,]+[\s\{]+/g.exec(n),f=addWidgetName=!1}var p=n.split(c[0]);if(d=c[0]+"_template : "+JSON.stringify(JSON.parse(e.template)+i)+",\n_dynamicNodes : "+JSON.stringify(e.dynamicNodes)+",\n"+(e._templateAttributes?"_templateAttributes : "+e._templateAttributes+",\n":"")+"_observedAttributes : "+(a?JSON.stringify(a):"[]")+",\n",d=p[0]+d+p[1],f&&l)if(Array.isArray(l)){let e=d.lastIndexOf("});"),t=d.lastIndexOf("})");if(-1!=e){let t=d.substring(0,e),r=d.substring(e);d=t+"},{mixins : "+JSON.stringify(l)+r}else if(t){let e=d.substring(0,t),r=d.substring(t);d=e+"},{mixins : "+JSON.stringify(l)+r}}else console.error("Invalid mixin passed to the component ",r," during compilation!");if(addWidgetName&&s){let e=/Lyte.Component.register\(+[\"\']+[a-zA-Z0-9\-]+[\"\']\s*[\,]+[\s]*{[\s\S]*},[\s]*{[\s\S]*}[\s]*(?<isThereComma>,?)/gm.exec(d);if(e){let t=d.split(e[0]);d=e.groups.isThereComma?e[0]+'"'+s+'"'+t[1]:e[0]+",'"+s+"'"+t[1]}}}return d};
;var speedBenchmarkEnd = +new Date();