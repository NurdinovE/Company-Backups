store.registerModel("custom_button",{id:Lyte.attr("string",{maximum:30}),name:Lyte.attr("string"),position:Lyte.attr("string"),module:Lyte.attr("object"),profiles:Lyte.attr("array"),layouts:Lyte.attr("array"),user_types:Lyte.attr("array"),description:Lyte.attr("string",{maximum:250}),sequence_number:Lyte.attr("number"),modified_time:Lyte.attr("string"),modified_by:Lyte.attr("object"),action:Lyte.attr("string"),details:Lyte.attr("object")},{actions:{execute:{endPoint:"execute"},save_function_script:{endPoint:"save_function_script"},get_merge_fields:{endPoint:"get_merge_fields"},get_button_associated_details:{endPoint:"get_button_associated_details"},get_custom_button_limit:{endPoint:"get_custom_button_limit"},count:{}}}),store.registerAdapter("custom_button",{namespace:"crm/v2/settings",delayPersistence:{delete:!0},buildURL:function(t,e,s,o,n,i,r){switch("execute"===i&&r.moduleName&&r.buttonId&&(n=(n=n.replace("settings",r.moduleName+"/actions")).replace("actions/execute",r.buttonId)),i){case"get_button_associated_details":r&&r.buttonId&&(n=n.replace("custom_button/actions/get_button_associated_details","custom_button/"+r.buttonId+"/actions/associated"));break;case"save_function_script":r&&r.functionId&&(n=n.replace("custom_button/actions/save_function_script","functions/"+r.functionId));break;case"get_merge_fields":n=n.replace("custom_button/actions/get_merge_fields","mergefields");break;case"get_custom_button_limit":n=n.replace("settings/custom_button/actions/get_custom_button_limit","__features/custom_button")}return!r||6!==r.apiVersion&&7!==r.apiVersion?r&&(r.new||r.isV2NewApi)&&(n=n.replace("v2","v2.2")):n=n.replace("v2","v6"),r&&r.hostUrl&&(n=(n=r.hostUrl.url).replace(n.match("sandbox/diff")?n.split("diff/").pop().split("v2/")[0]:n.split("crm/").pop().split("v2/")[0],"")),("createRecord"===e||r&&r.isV5Api)&&(n=n.replace("v2","v5")),r&&r.isV6Api&&(n=n.replace("v2","v6")),r&&"4"===r.apiVersion&&(n=n.replace("/v2","/v4")),n=n.replace("custom_button","custom_buttons"),"false"===window.isSandboxAcc&&window.isCanvasSandboxDiff&&(n=n.replace("/crm/","/crm/v2/sandbox/diff/")),"true"===window.isSandboxAcc&&window.isCanvasProdDiff&&(n=n.replace("/crm/","/crm/v2/production/diff/")),"Bundles__s"!==s.module&&"Bundle_Product_Relations__s"!==s.module||(n=Crm.changeBundlesApiVersion(n,"v4.1")),n},headersForRequest:function(t,e,s){var o=this.$super.headersForRequest();return s&&s.headers&&s.headers["X-CRM-ORG"]&&(o["X-CRM-ORG"]=s.headers["X-CRM-ORG"]),o},methodForRequest:function(t,e,s,o,n){return"PATCH"===t?"PUT":"count"===n?"GET":t}}),store.registerSerializer("custom_button",{serialize:function(t,e,s,o,n,i,r){return"count"!==r?(e.custom_buttons=[e.custom_button],delete e.custom_button,e):(e&&e.custom_button&&(e.custom_buttons=[e.custom_button],delete e.custom_button),"execute"===r&&o&&o.ids&&(e=new FormData).append("ids",o.ids),e)},normalizeResponse:function(t,e,s,o,n){return"updateRecord"!==e&&"createRecord"!==e||200!==n&&201!==n||(s.custom_buttons=s.custom_buttons[0].details),this.$super.normalizeResponse(t,e,s)}});
