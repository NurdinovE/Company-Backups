Lyte.Component.register("crm-orchestration-process-dropdown",{_template:'<template tag-name="crm-orchestration-process-dropdown"> <lyte-dropdown class="orchprocessdrpdwn" lt-prop-selected="{{module}}" lt-prop-freeze="false" lt-prop-tabindex="0"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="orchprocessdrpbox"> <lyte-drop-body> <template is="for" items="{{orchestchildmodulesarray}}" item="item" index="index"> <lyte-drop-item data-value="{{item.module_name}}"> <link-to lt-prop-route="crm.tab.module.custom-view.list" lt-prop-dp="[&quot;{{item.module_name}}&quot;,&quot;{{item.cvid}}&quot;]" lt-prop-td="{&quot;clickId&quot;:&quot;alphaSearch&quot;, &quot;clearCache&quot;:true, &quot;module&quot;:&quot;{{item.module_name}}&quot;}">{{item.plural_label}}</link-to> </lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["module","orchestchildmodulesarray"],data:function(){return{module:Lyte.attr("string"),orchestchildmodulesarray:Lyte.attr("array")}},init:function(){if(this.data.module.startsWith("Orchestration")){let e=this.fetchOnlyOrchestrationChildModules();crmTab.isABMConfigured&&(e=Lyte.registeredMixins.orchestration.filterOutAbmOrchestrations(e)),this.setData("orchestchildmodulesarray",e)}else this.setData("orchestchildmodulesarray",this.fetchPathfinderChildModules())}},{mixins:["orchestration","pathfinder"]}),Lyte.Component.register("crm-kanbanview-pipeline-dropdown",{_template:'<template tag-name="crm-kanbanview-pipeline-dropdown"> <div class="dIB maxW180"> <lyte-dropdown id="pipelineSelect" class="{{if(isSingleLayout,\'singleLayout\',\'\')}} crmSmallDropdown" on-option-selected="{{method(\'changePipeline\')}}" data-zcqa="kv_pipeline"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="moduleChangeDom"> <lyte-drop-body> <lyte-drop-item data-value="0">{{getI18n("crm.allcontact.show","crm.label.pipelines")}}</lyte-drop-item> <template is="if" value="{{isSingleLayout}}"><template case="true"><template is="for" items="{{pipelines}}" item="pipeline" index="index"> <lyte-drop-item data-value="{{pipeline.id}}">{{pipeline.display_value}}</lyte-drop-item> </template> <template is="if" value="{{selectedLayout}}"><template case="true"> <lyte-drop-item class="clearAfterB unaccPipeline" data-value="DELETED">{{getI18n(\'crm.pipeline.label.unaccounted\')}} <span class="fR svgIcons ico-info-filled mT5 mL5" lt-prop-title="{{getI18n(\'crm.pipeline.unnacounted.info\')}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;bottom&quot;}" lt-prop-tooltip-style="font-size: 11px"></span></lyte-drop-item> </template></template> </template><template case="false"><template is="for" items="{{pipelines}}" item="layout" index="index"> <lyte-drop-group> <lyte-drop-label>{{layout.LAYOUTNAME}}</lyte-drop-label> <template is="for" items="{{layout.PIPELINE}}" item="pipeline" index="index"> <lyte-drop-item data-value="{{pipeline.id}}">{{pipeline.display_value}}</lyte-drop-item> </template> </lyte-drop-group> </template></template></template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </div> </template>',_dynamicNodes:[{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1,1],dynamicNodes:[{type:"text",position:[1,1,1,0]},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"for",position:[0],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[2]},{type:"if",position:[2],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"attr",position:[1,2]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"for",position:[0],dynamicNodes:[{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"for",position:[1,3],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]}],_observedAttributes:["pipelines","isSingleLayout","selectedLayout"],data:function(){return{pipelines:Lyte.attr("array",{default:[]}),isSingleLayout:Lyte.attr("boolean",{default:!1}),selectedLayout:Lyte.attr("string")}},actions:{},methods:{changePipeline:function(e,t,i,o){var n=$L("#layoutSelect"),p=$L("#layoutDropdown");if(!n.length&&!p.length){var a={module:customViewObject.module,fetchOnlyBody:"true",cvid:customViewObject.cvId,clearCache:!0},l={};customViewObject.filters&&(a.filters=JSON.stringify(customViewObject.filters),l.filters=JSON.stringify(customViewObject.filters)),"0"!=t?(l.pipeline=t,a.pipeline=t):(l.pipeline=void 0,a.pipeline=void 0);var s=Lyte.Router.getRouteInstance();if(Crm.userDetails.isMultipleKanbanViewsEnabled){var r={};if(r.pipeline={id:"DELETED"===t?"-1":t},!n.length||!p.length){var d="Potentials"===customViewObject.module?"Deals":customViewObject.module,m=function(e){e&&(r.layout={id:e},$L("crm-kanbanview-component")[0].component.updateUserLevelConfig(r))},c=store.peekAll("layout").find((e=>e.module&&e.module.api_name===d&&"system"===e.generated_type));c?m(c?c.id:null):store.findAll("layout",{module:d},!0,!0,{apiVersion:"2.2"}).then((function(e){e&&(c=e.find((e=>"system"===e.generated_type)),m(c?c.id:null))}))}a.kvId=s.transition.data.kvId,a.skipUserLevelReq=!0,a.isFilterApply=!0}return store.clearCachedQuery(moduleRecordMapping[customViewObject.module].id),s.setQueryParams(l).data=a}if($L(i.$node).addClass("pipeChanged"),i.$node.className.indexOf("singleLayout")>-1&&this.data.selectedLayout)n.length?n.trigger("change"):this.executeMethod("onPipelineChange");else{var y,u=$L(o).siblings("lyte-drop-label")[0];y=u?this.data.pipelines.filter((e=>e.LAYOUTNAME===u.textContent))[0].LAYOUTID:this.data.pipelines.filter((function(e){return e.id===t}))[0].layoutId,n.length?n.val(y).trigger("change"):(p[0].ltProp("selected",y),this.executeMethod("onPipelineChange"))}}}});
