Lyte.Component.register("crm-email-summary-view",{_template:'<template tag-name="crm-email-summary-view"> <template is="if" value="{{isTranslation}}"><template case="true"> <lyte-dropdown on-before-show="{{method(\'onShowOfDropdown\')}}" on-before-hide="{{method(\'onHideOfDropdown\')}}" id="emailView_{{tabId}}" class="mR20 pR" lt-prop-disabled="{{lbind(disableDropdown)}}" lt-prop-selected="{{currentSelection}}" on-option-selected="{{method(\'optionSelected\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-button class="cP flexAlignCenter borderNone boxShadowNone edvPreventAccordion pL0 pR0 zia_emailsummary_dropbtn lh22 zi0 pT0 pB0 ziaEmailTranslateBlueIcon h27 w27 jcCenter br5" lt-prop-title="{{currentSelection}}" lt-prop-tooltip-config="{&quot;position&quot; : &quot;top&quot;}"> <span class="zcicncss-new-translate zcicn_blue_mask zcicn-cssIcons edvPreventAccordion"></span> </lyte-drop-button> <lyte-drop-box class="maxW250 zia_email_translate_dropbox_{{tabId}}"> <lyte-drop-header> <lyte-search on-search="{{method(\'onSearch\',tabId)}}" id="searchBarId" lt-prop-query-selector="{&quot;scope&quot;:&quot;.zia_email_translate_dropbox_{{tabId}}&quot;,&quot;search&quot;:&quot;lyte-drop-item&quot;}" lt-prop-component="dropdown" lt-prop-position="top" lt-prop-placeholder="{{getI18n(\'crm.globalsearch.search.title\')}}" lt-prop-close-icon="true"> </lyte-search> </lyte-drop-header> <lyte-drop-body> <template is="for" items="{{dropDownLanguages}}" item="language" index="index"> <lyte-drop-item data-value="{{language.name}}">{{language.name}} {{getId(language.id)}}</lyte-drop-item> </template> <div id="search_{{tabId}}" class="aligncenter crm-base-font-size crmNotFoundColor p15 hide">{{getI18n(\'crm.template.listview.search.no.results\')}}</div> </lyte-drop-body> <lyte-drop-footer class="alignLeft br_top_border2 cP crmLinkColor pB10 pL25 pR25 pT10 bg_crmBg3" onclick="{{action(\'originalChange\')}}"> <lyte-text lt-prop-value="{{userLan}} - {{getI18n(\'zc.editor.original\')}}"></lyte-text> </lyte-drop-footer> </lyte-drop-box> </template> </lyte-dropdown> </template><template case="false"> <lyte-modal id="email_summary" lt-prop-height="auto" lt-prop-width="990px" lt-prop-allow-multiple="true" on-close="{{method(&quot;close&quot;)}}" lt-prop-max-height="80%" lt-prop-wrapper-class="zia_emailsummary_modalWrapper {{if(expHandlers(expHandlers(viewMailData,\'!\'),\'||\',expHandlers(summary_resp,\'!\')),\'crmModalWithoutFooter\')}}" lt-prop-show="true" lt-prop-transition="{&quot;animation&quot;:&quot;slideFromTop&quot;,&quot;duration&quot;:&quot;0.5s&quot;}" lt-prop-offset="{&quot;top&quot;:&quot;0&quot;,&quot;left&quot;:&quot;center&quot;}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <div class="flexAlignStart spaceBetween"> <span class="dIB">{{getI18n(\'crm.email.summary.heading\')}}</span> <template is="if" value="{{summary_resp}}"><template case="true"> <span data-zcqa="openEmail" class="crmLinkColor crm-base-font-size cP crm-font-regular lh20 mR7" onclick="{{action(\'openEmail\')}}">{{getI18n(\'crm.signal.view.email.link\')}}</span> </template></template> </div> </lyte-modal-header> <lyte-modal-content> <template is="if" value="{{expHandlers(expHandlers(viewMailData,\'!\'),\'||\',expHandlers(summary_resp,\'!\'))}}"><template case="true"> <div class="br10 br_border2 flexDC flexAlignCenter gap10 h300 jcCenter"> <crm-ui-loaders interaction-name="crmCircleLoader" lyte-rendered="cP"> <div class="crmCircleLoader"></div> </crm-ui-loaders> <div class="crmLabelColor">{{getI18n(\'crm.email.summary.loader\')}}</div></div> </template><template case="false"> <div data-zcqa="emailSummaryContent" class="br_border2 br10 dF flexDC zia_maxhInheit boxBB"> <div class="flexAlignCenter mB5 pL20 pR10 pT20"> <template is="if" value="{{expHandlers(viewMailData.type,\'==\',\'received\')}}"><template case="true"> <crmutil-icon class="mR15" icon-name="mail-received" icon-class="zcicn-mail-received zcicn-color-blue-mixed "></crmutil-icon> </template><template case="false"> <crmutil-icon class="mR15" icon-name="mail-sent" icon-class="zcicn-mail-sent zcicn-color-green-mixed "></crmutil-icon> </template></template> <div class="flexOne oH"> <div class="flexAlignCenter gap10"> <lyte-text data-zcqa="subject" class="crm-medium-large-font-size crm-font-bold" lt-prop-value="{{viewMailData.subject}}"></lyte-text> <template is="if" value="{{isThreadMail}}"><template case="true"> <crmutil-icon class="mT3" icon-name="chat-conversation" icon-class="zcicn-chat-conversation zcicn16 "></crmutil-icon> </template></template> </div> <div class="crmLabelColor mT5">{{viewMailData.mailid}}</div> </div> </div> <div class="oA hInherit fg1 pL20 pR20 pB25"> <template is="if" value="{{isThreadMail}}"><template case="true"> <div data-zcqa="lastEmailSummary" class="mT25"> <template is="if" value="{{expHandlers(summary_resp.last_email_summary,\'&amp;&amp;\',summary_resp.overall_summary)}}"><template case="true"> <div class="crm-font-bold crm-subheading-font-size">{{getI18n(\'crm.email.summary.last.heading\')}}</div> </template><template case="false"> <div class="crm-font-bold crm-subheading-font-size">{{getI18n(\'crm.zia.summary.overall\')}}</div> </template></template> <div class="mT15 crmParagraphColor lh22"> {{summary_resp.last_email_summary}} </div> </div> </template></template> <div data-zcqa="overallSummary" class="mT25"> <template is="if" value="{{expHandlers(expHandlers(isThreadMail,\'&amp;&amp;\',summary_resp.last_email_summary),\'&amp;&amp;\',summary_resp.overall_summary)}}"><template case="true"> <div class="crm-font-bold crm-subheading-font-size">{{getI18n(\'crm.zia.summary.overall\')}} </div> </template></template> <div class="mT15 crmParagraphColor lh22"> {{summary_resp.overall_summary}} </div> </div> <template is="if" value="{{expHandlers(attachLen,\'>\',0)}}"><template case="true"> <div class="crm-small-font-size mT30" id="attachmentsDiv"> <span class="crmLinkColor" id="attachLen">{{attachLen}}</span><span class="ernSort crmLinkColor cP mL5" onclick="{{action(\'ernShowAttachmentView\',attachments)}}" data-zcqa="attachmentList">{{getI18n(\'Attachments\')}}</span> </div> </template></template> </div> </div> </template></template> </lyte-modal-content> <template is="if" value="{{summary_resp}}"><template case="true"> <lyte-modal-footer> <div class="flexAlignCenter crm-subheading-font-size"> {{getI18n(\'crm.email.summary.feedback.desc\')}} <div data-zcqa="thumbsUp" class="h30 w30 bg_crmBg6 br50per mL15 flexAlignCenter jcCenter cP {{positiveNoneClass}} {{if(ifEquals(feedbackPostive,\'zcicn_green_mask\'),\'zia_emailsummary_fb_positive\',\'\')}}" onclick="{{action(\'changeFeedback\',true)}}"> <span class="cP zcicncss-thumbsup zcicn-cssIcons {{feedbackPostive}}"></span> </div> <div data-zcqa="thumbsDown" class="h30 w30 bg_crmBg6 br50per mL15 flexAlignCenter jcCenter cP {{negativeNoneClass}} {{if(ifEquals(feedbackNegative,\'zcicn_red_mask\'),\'zia_emailsummary_fb_negative\',\'\')}}" onclick="{{action(\'changeFeedback\',false)}}"> <span class="cP zcicncss-thumbsup zcicn-cssIcons zcicn-rotate-180 {{feedbackNegative}}"></span> </div> </div> </lyte-modal-footer> </template></template> </template> </lyte-modal> <template is="if" value="{{lbind(attachments)}}"><template case="true"> <div class="ecnAttachment pA dIB bg_white br3" id="ecnAttachment"> <lyte-menu lt-prop-query="#attachmentsDiv" lt-prop-yield="true" lt-prop-event="click" lt-prop-position="down" lt-prop-freeze="false" id="ecnAttachmentUl"> <template is="registerYield" yield-name="yield"> <lyte-menu-body class="maxH300"> <template is="for" items="{{attachments}}" item="attachment" index="index"> <lyte-menu-item data-id="{{attachment.id}}" data-name="{{attachment.name}}" onclick="{{action(\'downloadEmailAttachments\',this,viewMailData.msgid,viewMailData.mailOwnerId)}}" class="m8 p5 ecnAttachmentli" data-zcqa="attachment_{{attachment.id}}" on-before-close="{{method(\'keepMenuOpen\')}}"> <lyte-menu-label><span class="attachmentImg dIB vaT mT0 mR5 {{getAttachmentStyle(attachment.name)}}"></span>{{attachment.name}}</lyte-menu-label> </lyte-menu-item> </template> </lyte-menu-body> </template> </lyte-menu> </div> </template></template> <lyte-modal lt-prop-show="{{lbind(showFeedbackModal)}}" lt-prop-width="500px" lt-prop-close-on-escape="false" lt-prop-show-close-button="false" lt-prop-offset="{&quot;top&quot;:&quot;0&quot;,&quot;left&quot;:&quot;center&quot;}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> {{getI18n(\'crm.email.summary.feedback.share.desc\')}} </lyte-modal-header> <lyte-modal-content> <lyte-radiobutton lt-prop-prevent-focus="true" class="dB mB20" lt-prop-label="{{getI18n(\'crm.email.summary.feedback.point1\')}}" lt-prop-checked="{{ifEquals(type,\'1\')}}" lt-prop-value="1" on-checked="{{method(\'feedbackChange\',1)}}"></lyte-radiobutton> <lyte-radiobutton lt-prop-prevent-focus="true" class="dB mB20" lt-prop-label="{{getI18n(\'crm.email.summary.feedback.point2\')}}" lt-prop-checked="{{ifEquals(type,\'2\')}}" lt-prop-value="2" on-checked="{{method(\'feedbackChange\',2)}}"></lyte-radiobutton> <lyte-radiobutton lt-prop-prevent-focus="true" class="dB mB20" lt-prop-label="{{getI18n(\'crm.email.summary.feedback.point3\')}}" lt-prop-checked="{{ifEquals(type,\'3\')}}" lt-prop-value="3" on-checked="{{method(\'feedbackChange\',3)}}"></lyte-radiobutton> <lyte-radiobutton lt-prop-prevent-focus="true" class="dB mB20" lt-prop-label="{{getI18n(\'crm.email.summary.feedback.point4\')}}" lt-prop-checked="{{ifEquals(type,\'4\')}}" lt-prop-value="4" on-checked="{{method(\'feedbackChange\',4)}}"></lyte-radiobutton> <lyte-radiobutton lt-prop-prevent-focus="true" class="dB" lt-prop-label="{{getI18n(\'crm.email.summary.feedback.point5\')}}" lt-prop-checked="{{ifEquals(type,\'5\')}}" lt-prop-value="5" on-checked="{{method(\'feedbackChange\',5)}}"></lyte-radiobutton> <crux-text-area-component id="EIDesc" on-value-change="{{method(\'onDescChange\')}}" class="mT10 dB pL20 {{feedback_description}}" cx-prop-maxlength="101" cx-prop-value="{{lbind(description)}}" cx-prop-appearance="box" cx-prop-from="create" cx-prop-placeholder="Enter text"> </crux-text-area-component> </lyte-modal-content> <lyte-modal-footer class="right"> <lyte-button data-zcqa="closeBtn" onclick="{{action(\'closeFeedbackModal\')}}"> <template is="registerYield" yield-name="text">{{getI18n(\'crm.button.skip\')}}</template> </lyte-button> <lyte-button data-zcqa="submitBtn" lt-prop-disabled="{{lbind(submitBtnDisabled)}}" lt-prop-appearance="primary" onclick="{{action(\'saveFeedbackModal\')}}"> <template is="registerYield" yield-name="text">{{getI18n(\'crm.button.submit\')}}</template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"attr",position:[3,1,1]},{type:"componentDynamic",position:[3,1,1]},{type:"componentDynamic",position:[3,1]},{type:"attr",position:[3,3,1]},{type:"for",position:[3,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"text",position:[1,2]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[3,3,3]},{type:"text",position:[3,3,3,0]},{type:"componentDynamic",position:[3,3]},{type:"attr",position:[3,5]},{type:"attr",position:[3,5,1]},{type:"componentDynamic",position:[3,5,1]},{type:"componentDynamic",position:[3,5]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1,1,1,0]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[1,1]},{type:"text",position:[1,3,0]}]},false:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,1,3,1,1]},{type:"componentDynamic",position:[1,1,3,1,1]},{type:"attr",position:[1,1,3,1,3]},{type:"if",position:[1,1,3,1,3],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[1]}]}},default:{}},{type:"text",position:[1,1,3,3,0]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"text",position:[1,3,1]}]}},default:{}},{type:"attr",position:[1,3,3,1]},{type:"if",position:[1,3,3,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"text",position:[1,3,3,3,1]},{type:"attr",position:[1,3,5]},{type:"if",position:[1,3,5],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,2]},{type:"text",position:[1,2,0]}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[3]},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,1]},{type:"attr",position:[1,1,3]},{type:"attr",position:[1,1,3,1]},{type:"attr",position:[1,1,5]},{type:"attr",position:[1,1,5,1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,0]},{type:"text",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"attr",position:[5]},{type:"registerYield",position:[5,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"componentDynamic",position:[3,1]},{type:"attr",position:[3,3]},{type:"componentDynamic",position:[3,3]},{type:"attr",position:[3,5]},{type:"componentDynamic",position:[3,5]},{type:"attr",position:[3,7]},{type:"componentDynamic",position:[3,7]},{type:"attr",position:[3,9]},{type:"componentDynamic",position:[3,9]},{type:"attr",position:[3,11]},{type:"componentDynamic",position:[3,11]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[5]}]}},default:{}}],_observedAttributes:["description","isTranslation","isTranslation_dropDownOpen","isThreadMail","summary_resp","viewMailData","label","topthreadsummary","isTranslation_dropDownOpen","overallsummary","userLan","emailcontent","currentSelection","dropDownLanguages","languageobj","dropDownLanguageObj","actualContentBackup","actualSubjectBackup","tabId","feedbackClass","currentFeedback","type","feedback_description","submitBtnDisabled","disableDropdown","attachLen","showAttachSection","attachments","checkboxObject","showFeedbackModal","feedbackPostive","feedbackNegative","negativeNoneClass","positiveNoneClass"],data:function(){return{description:Lyte.attr("string",{default:""}),isTranslation:Lyte.attr("boolean",{default:!1}),isTranslation_dropDownOpen:Lyte.attr("boolean",{default:!1}),isThreadMail:Lyte.attr("boolean",{default:!1}),summary_resp:Lyte.attr("object",{default:[]}),viewMailData:Lyte.attr("object",{default:{}}),label:Lyte.attr("string",{default:I18n.getMsg("crm.email.zia.activityv2.description")}),topthreadsummary:Lyte.attr("string",{default:""}),isTranslation_dropDownOpen:Lyte.attr("string",{default:""}),overallsummary:Lyte.attr("string",{default:""}),userLan:Lyte.attr("string",{default:""}),emailcontent:Lyte.attr("string",{default:I18n.getMsg("crm.email.translate")}),currentSelection:Lyte.attr("string",{default:I18n.getMsg("crm.email.translate")}),dropDownLanguages:Lyte.attr("array",{default:[{id:"Tamil",name:"தமிழ்"},{id:"English",name:"English"},{id:"French",name:"Français"},{id:"German",name:"Deutsch"},{id:"Italian",name:"Italiano"},{id:"Portuguese",name:"Português"},{id:"Spanish",name:"español"},{id:"Dutch",name:"Nederlands"},{id:"Assamese",name:"অসমীয়া"},{id:"Bengali",name:"বাংলা"},{id:"Gujarati",name:"ગુજરાતી"},{id:"kannada",name:"ಕನ್ನಡ"},{id:"Malayalam",name:"മലയാളം"},{id:"Marathi",name:"मराटी"},{id:"Oriya",name:"ଓଡିଆ"},{id:"Punjabi",name:"ਪੰਜਾਬੀ"},{id:"Telugu",name:"తెలుగు"},{id:"Hindi",name:"हिन्दी"},{id:"Russian",name:"Русский"},{id:"Croatian",name:"Hrvatski"},{id:"Czech",name:"čeština"},{id:"Polish",name:"Polski"},{id:"Ukrainian",name:"українська"},{id:"Arabic",name:"عربي"},{id:"Persian",name:"فارسی"},{id:"Urudu",name:"اردو"},{id:"Armenian",name:"հայերեն"},{id:"Georgian",name:"ქართული"},{id:"Hebrew",name:"עִברִית"},{id:"Catalan",name:"català"},{id:"Danish",name:"dansk"},{id:"Romanian",name:"Română"},{id:"Swedish",name:"svenska"},{id:"Greek",name:"Ελληνικά"},{id:"Estonian",name:"eesti keel"},{id:"Finnish",name:"Suomalainen"},{id:"Serbian",name:"Српски"},{id:"Hungarian",name:"Magyar"},{id:"Japanese",name:"日本"},{id:"Chinese",name:"中文"},{id:"Korean",name:"한국어"},{id:"Belarusian",name:"беларускі"},{id:"Bulgarian",name:"български"},{id:"Latvian",name:"latviski"},{id:"Lithuanian",name:"lietuvis"},{id:"Slovak",name:"slovenský"},{id:"Slovenian",name:"Slovenščina"},{id:"Macedonian",name:"македонски"},{id:"Indonesian",name:"Bahasa Indonesia"},{id:"Malay",name:"Bahasa Melayu"},{id:"Tagalog",name:"Wikang Tagalog"},{id:"Filipino",name:"Wikang Filipino"},{id:"Afrikaans",name:"Afrikaans"},{id:"Albanian",name:"Gjuha shqipe"},{id:"Azerbaijani",name:"آذربایجان دیلی"},{id:"Basque",name:"euskara"},{id:"Esperanto",name:"Esperanto"},{id:"Galician",name:"galego"},{id:"Icelandic",name:"íslenska"},{id:"Irish",name:"Gaeilge"},{id:"Khmer",name:"ភាសាខ្មែរ"},{id:"Lao",name:"ພາສາລາວ"},{id:"Maltese",name:"Malti"},{id:"Norwegian",name:"norsk"},{id:"Thai",name:"ภาษาไทย"},{id:"Turkish",name:"Türkçe"},{id:"Vietnamese",name:"Tiếng Việt"},{id:"Yiddish",name:"ייִדיש"},{id:"Sinhala",name:"සිංහල"},{id:"Malagasy",name:"malagasy"},{id:"Swahili",name:"كِيْسْوَاحِيْلِيْ"},{id:"Sundanese",name:"بَاسَا سُوْندَا"}]}),languageobj:Lyte.attr("object",{default:{iw_IL:"עִברִית",en_US:"English",en_GB:"English",zh_CN:"中文",zh_TW:"中文",fr_FR:"Français",ja_JP:"日本",ar_EG:"عربي",id_ID:"Bahasa Indonesia",bg_BG:"български",hr_HR:"hrvatski",cs_CZ:"čeština",da_DK:"dansk",de_DE:"Deutsch",he_IL:"עִברִית",hi_IN:"हिन्दी",hu_HU:"Magyar",it_IT:"Italiano",ko_KR:"한국어",pt_PT:"Português",pt_BR:"Português",ru_RU:"Русский",es_ES:"español",sv_SE:"svenska",pl_PL:"Polski",th_TH:"ภาษาไทย",tr_TR:"Türkçe",nl_NL:"Nederlands",vi_VN:"Tiếng Việt"}}),dropDownLanguageObj:Lyte.attr("object",{default:{Tamil:"தமிழ்",English:"English",French:"Français",German:"Deutsch",Italian:"Italiano",Portuguese:"Português",Spanish:"español",Dutch:"Nederlands",Assamese:"অসমীয়া",Bengali:"বাংলা",Gujarati:"ગુજરાતી",Kannada:"ಕನ್ನಡ",Malayalam:"മലയാളം",Marathi:"मराटी",Oriya:"ଓଡିଆ",Punjabi:"ਪੰਜਾਬੀ",Telugu:"తెలుగు",Hindi:"हिन्दी",Russian:"Русский",Croatian:"Hrvatski",Czech:"čeština",Polish:"Polski",Ukrainian:"українська",Arabic:"عربي",Persian:"فارسی",Urudu:"اردو",Armenian:"հայերեն",Georgian:"ქართული",Hebrew:"עִברִית",Catalan:"català",Danish:"dansk",Romanian:"Română",Swedish:"svenska",Greek:"Ελληνικά",Estonian:"eesti keel",Finnish:"Suomalainen",Serbian:"Српски",Hungarian:"Magyar",Japanese:"日本",Chinese:"中文",Korean:"한국어",Belarusian:"беларускі",Bulgarian:"български",Latvian:"latviski",Lithuanian:"lietuvis",Slovak:"slovenský",Slovenian:"Slovenščina",Macedonian:"македонски",Indonesian:"Bahasa Indonesia",Malay:"Bahasa Melayu",Tagalog:"Wikang Tagalog",Filipino:"Wikang Filipino",Afrikaans:"Afrikaans",Albanian:"Gjuha shqipe",Azerbaijani:"آذربایجان دیلی",Basque:"euskara",Esperanto:"Esperanto",Galician:"galego",Icelandic:"íslenska",Irish:"Gaeilge",Khmer:"ភាសាខ្មែរ",Lao:"ພາສາລາວ",Maltese:"Malti",Norwegian:"norsk",Thai:"ภาษาไทย",Turkish:"Türkçe",Vietnamese:"Tiếng Việt",Yiddish:"ייִדיש",Sinhala:"සිංහල",Malagasy:"malagasy",Swahili:"كِيْسْوَاحِيْلِيْ",Sundanese:"بَاسَا سُوْندَا"}}),actualContentBackup:Lyte.attr("string"),actualSubjectBackup:Lyte.attr("string"),tabId:Lyte.attr("string"),feedbackClass:Lyte.attr("string"),currentFeedback:Lyte.attr("string"),type:Lyte.attr("string"),feedback_description:Lyte.attr("string",{default:"hide"}),submitBtnDisabled:Lyte.attr("boolean",{default:!0}),disableDropdown:Lyte.attr("boolean"),attachLen:Lyte.attr("string"),showAttachSection:Lyte.attr("boolean",{default:!1}),attachments:Lyte.attr("array",{default:[]}),checkboxObject:Lyte.attr("object",{default:{1:!1,2:!1,3:!1,4:!1,5:!1,6:!1}}),showFeedbackModal:Lyte.attr("boolean",{default:!1}),feedbackPostive:Lyte.attr("string",{default:""}),feedbackNegative:Lyte.attr("string",{default:""}),negativeNoneClass:Lyte.attr("string",{default:""}),positiveNoneClass:Lyte.attr("string",{default:""})}},didConnect:function(){Lyte.addEventListener("beforeRouteTransition",this.hideFn)},hideFn:function(){var e=$L("#email_summary")[0];e&&e.ltProp("show",!1)},init:function(){var e=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("threadsummaryandtranslation")],ResourceConstants.CRM);e=e.concat(networkUtils.returnDependencyFiles(["crm-emailconversation-view.js"],ResourceConstants.CRMClient));var t="";if(this.getData("isTranslation")){let e=editor.getEditorMode();"plainEditor"===e?t=editor.getContent():"richEditor"===e&&(t=editor.zEditor.editorDiv.innerText)}var a=$L("#ceSubject_"+EmailComposeUtil.CURRENT_TAB).val(),i=this;Lyte.injectResources(e,void 0,(function(){var e=i.getData("summary_resp");if(i.getData("isTranslation"))i.initMethod(i,t,EmailComposeUtil.CURRENT_TAB,a);else{var n=i.getData("viewMailData");n&&e&&(i.setData("attachLen",n.attachments?n.attachments.length:0),i.getData("isThreadMail")?i.setData({topthreadsummary:e.last_email_summary,overallsummary:e.overall_summary}):i.setData("overallsummary",e.summary))}}))},methods:{onSearch(e,t){var a=$L("#search_"+e);t.length?a.addClass("hide"):a.removeClass("hide")},close:function(){this.$node.remove()},feedbackChange:function(e){this.setData({currentFeedback:e,type:e,submitBtnDisabled:!1})},onShowOfDropdown:function(){this.setData("isTranslation_dropDownOpen","")},onHideOfDropdown:function(){this.setData("isTranslation_dropDownOpen","zcicn-rotate-180")},optionSelected:function(e,t){var a=$L(".loaderClass_"+EmailComposeUtil.CURRENT_TAB);a.removeClass("hide");var i=$L("#etnSub_"+EmailComposeUtil.CURRENT_TAB);i.addClass("zia_email_subject_freeze"),this.setData({disableDropdown:!0,userLan:this.getData("userLan"),currentSelection:t});var n="";let o=this.getData("dropDownLanguageObj");for(const e in o)if(`${o[e]}`===t){n=`${e}`;break}let s=editor.getEditorMode();Crm.client_tracking("Email Translation - selected from email compose with target language of "+n);let r="";var l=this.getData("tabId"),m=EmailComposeUtil.tabDetails[l].zEditor;r=m.editorDiv.innerHTML;var c=this;r=c.getData("actualContentBackup");var d=c.getData("actualSubjectBackup");if(r){var p=c.languageDetectAPICall(r);p.then((function(e){(e=e.zia_config).dummy.response[0].language!==n?(p=c.translateAPICall(r,e,n,d)).then((function(e){if(i.removeClass("zia_email_subject_freeze"),$L(".loaderClass_"+EmailComposeUtil.CURRENT_TAB).addClass("hide"),c.setData("disableDropdown",!1),(e=e.zia_config)&&e.dummy.translated_text){if("plainEditor"===s){var t=EmailCompose.extractHTMLTags(e.dummy.translated_text,!0);editor.setContent(t),c.setData("oldEditorContent",t)}else if("richEditor"===s){(t=e.dummy.translated_text).replaceAll("\n","<br>"),editor.zEditor.editorDiv.innerHTML=t,c.setData("oldEditorContent",t)}EmailComposeUtil.setSubject(e.dummy.translated_subject)}else(e.dummy.status&&"error"===e.dummy.status&&"LANGUAGE_NOT_SUPPORTED"===e.dummy.code||e.dummy.status&&"error"===e.dummy.status&&"INTERNAL_SERVER_ERROR"===e.dummy.code)&&_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.summary.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.summary.desc"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}})}),(function(){a.addClass("hide"),i.removeClass("zia_email_subject_freeze"),c.errorHandling(),c.setData("disableDropdown",!1)})):(i.removeClass("zia_email_subject_freeze"),a.addClass("hide"),c.setData("disableDropdown",!1),"plainEditor"===s?editor.setContent(EmailCompose.extractHTMLTags(c.getData("actualContentBackup"),!0)):"richEditor"===s&&(editor.zEditor.editorDiv.innerHTML=c.getData("actualContentBackup")),EmailComposeUtil.setSubject(c.getData("actualSubjectBackup")))}),(function(){c.setData("disableDropdown",!1),i.removeClass("zia_email_subject_freeze"),a.addClass("hide"),c.errorHandling()}))}else a.addClass("hide")}},actions:{downloadEmailAttachments:function(e,t,a){var i=$L("#module").val(),n=$L("#id").val(),o=$L(e).data("id"),s=$L(e).data("name"),r="/crm/email/v2/"+(i=void 0===moduleApiMapping[i]?opener.window.moduleApiMapping[i]:moduleApiMapping[i])+"/"+n+"/Emails/attachments?id="+o+"&name="+s+"&user_id="+a+"&message_id="+t;store.triggerAction("dummy","emailSummary",{url:r,method:"GET"}).then((function(e){try{var t=new Blob([e],{type:"application/octet-stream"}),a="data:application/octet-stream;base64,"+btoa(t);if(s){commonUtils.showHideLoadingDiv(!1);var i=document.createElement("a");i.style.display="none",void 0===i.download?window.location=encodeURI(a):(i.href=encodeURI(a),i.download=s,document.getElementById("ecnAttachment").append(i),i.target="_blank",i.click(),i.remove())}else window.location=encodeURI(a)}catch(e){murphy.error(e),_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropYield:!0,ltPropMessage:I18n.getMsg("crm.mail.error")}})}}),(function(){_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropYield:!0,ltPropMessage:I18n.getMsg("crm.mail.error")}})}))},ernShowAttachmentView:function(){event.stopPropagation();var e=$L("#ecnAttachment");e.removeClass("hide"),e.css({top:20,left:0}),e.click((function(){event.stopPropagation()}));var t=this.getData("viewMailData");this.setData("attachments",[]),Lyte.arrayUtils(this.getData("attachments"),"push",t.attachments)},changeFeedback:function(e){e?(_cruxUtils.showCustomMessage({params:{ltPropType:"success",ltPropCloseManually:!1,ltPropYield:!0,ltPropMessage:I18n.getMsg("crm.email.summary.feedback")},close:function(){Crm.client_tracking("Email Summary Feedback - positive")}}),this.setData({feedbackPostive:"zcicn_green_mask",feedbackNegative:"",positiveNoneClass:"eventNone",negativeNoneClass:""})):(Crm.client_tracking("Email Summary Feedback - negative"),this.setData({type:"",submitBtnDisabled:!0,showFeedbackModal:!0}))},closeFeedbackModal:function(){_cruxUtils.showCustomMessage({params:{ltPropType:"success",ltPropCloseManually:!1,ltPropYield:!0,ltPropMessage:I18n.getMsg("crm.email.summary.feedback")},close:function(){Crm.client_tracking("Email Summary Feedback - skip button is clicked")}}),this.setData({type:"",submitBtnDisabled:!0,feedbackPostive:"",positiveNoneClass:"",feedbackNegative:"zcicn_red_mask",negativeNoneClass:"eventNone",showFeedbackModal:!1})},saveFeedbackModal:function(){this.setData("submitBtnDisabled",!1);var e=this;_cruxUtils.showCustomMessage({params:{ltPropDuration:"1000",ltPropType:"success",ltPropCloseManually:!1,ltPropYield:!0,ltPropMessage:I18n.getMsg("crm.email.summary.feedback")},close:function(){Crm.client_tracking("Email Summary Feedback - submit button clicked");var t=e.getCheckBoxOptions(e.getData("currentFeedback"));Crm.client_tracking("Email Summary Feedback - "+t),e.setData("type","")}}),this.setData({type:"",submitBtnDisabled:!0,feedbackPostive:"",positiveNoneClass:"",feedbackNegative:"zcicn_red_mask",negativeNoneClass:"eventNone",showFeedbackModal:!1})},originalChange:function(){var e=$L(".loaderClass_"+EmailComposeUtil.CURRENT_TAB);e.removeClass("hide"),$L("#etnSub_"+EmailComposeUtil.CURRENT_TAB).removeClass("zia_email_subject_freeze"),$L("#emailView_"+this.getData("tabId"))[0].close(),this.setData({userLan:this.getData("userLan"),currentSelection:this.getData("userLan")});let t=editor.getEditorMode();if("plainEditor"===t){var a=EmailCompose.extractHTMLTags(this.getData("actualContentBackup"),!0);editor.setContent(a)}else if("richEditor"===t){var i=this.getData("actualContentBackup");i.replaceAll("\n","<br>"),editor.zEditor.editorDiv.innerHTML=i}EmailComposeUtil.setSubject(this.getData("actualSubjectBackup")),e.addClass("hide")},openEmail:function(){var e=this.getData("viewMailData");this.viewEntEmail(e.msgid,e.mailType,e.closeStr,e.sentOrReceived,e.zfsDown,e.ismailkanbanview,e.markAsRead,e.mailOwnerId,e.curEl,e.contactId,e.id,void 0,void 0,void 0,e.thread_id)}}},{mixins:["crm-email-summary-mixin","crm-emails-related-mixin"]}),Lyte.Mixin.register("crm-email-summary-mixin",{translateAPICall:function(e,t,a,i){var n={};if(n.id=$L.moment().toDate().getTime(),n.text=e,"Marati"===a&&(a="Marathi"),"Urudu"===a&&(a="Urdu"),t=t.zia_config?t.zia_config:t)return n.target_language=a,n.source_language=t.dummy.response[0].language,i&&(n.subject=i),Lyte.resolvePromises({zia_config:store.findAll("dummy",void 0,!1,!1,{url:"crm/zia/text/v1/translate.do",method:"POST",payLoad:JSON.stringify(n)})}).then((function(e){return e}));_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.translation.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.translation.desc"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}})},languageDetectAPICall:function(e){var t={},a={};a.id=$L.moment().toDate().getTime(),a.text=e;var i=[];return i.push(a),t.texts=i,Lyte.resolvePromises({zia_config:store.findAll("dummy",void 0,!1,!1,{url:"crm/zia/text/api/language/detect.do",method:"POST",payLoad:JSON.stringify(t)})}).then((function(e){return e}))},getLanguage:function(e){return this.getData("languageobj")[e]},initMethod:function(e,t,a,i){var n=$L("#editorContent_"+EmailComposeUtil.CURRENT_TAB).closest("#composeEditor");n.addClass("zia_email_freeze_wrap");var o=document.createElement("crm-ui-loaders");o.setAttribute("class","bg_white bottom0 w100_per op08 pA top46 dF zia_email_circle_loader loaderClass_"+EmailComposeUtil.CURRENT_TAB),o.setAttribute("interaction-name","crmCircleLoader"),n.append(o);var s=$L("#etnSub_"+EmailComposeUtil.CURRENT_TAB);s.addClass("zia_email_subject_freeze"),e.setData({disableDropdown:!0,actualContentBackup:t,actualSubjectBackup:i});let r=editor.getEditorMode();var l=this.languageDetectAPICall(t);l.then((function(n){var o=(n=n.zia_config).dummy.response[0].language;o=e.getLanguageNameInSpecific(o);var m=Crm.userDetails.LOCALE,c=e.getLanguage(m);if(Crm.client_tracking("Email Translation - clicked from email compose with target language of "+c),e.setData({currentSelection:c,newUserLan:o,userLan:o}),c=Lyte.registeredMixins["crm-emailconversation-view-mixin"].getLanguageNameInEnglish(c,!0,e),n.dummy.response[0].language!==c)(l=e.translateAPICall(t,n,c,i)).then((function(t){e.setData("disableDropdown",!1),$L("#emailView_"+a)[0].toggle(),$L(".loaderClass_"+EmailComposeUtil.CURRENT_TAB).addClass("hide"),(t=t.zia_config)&&t.dummy.translated_text?(s.removeClass("zia_email_subject_freeze"),"plainEditor"===r?editor.setContent(t.dummy.translated_text):"richEditor"===r&&(editor.zEditor.editorDiv.innerHTML=t.dummy.translated_text),EmailComposeUtil.setSubject(t.dummy.translated_subject)):(t.dummy.status&&"error"===t.dummy.status&&"LANGUAGE_NOT_SUPPORTED"===t.dummy.code||t.dummy.status&&"error"===t.dummy.status&&"INTERNAL_SERVER_ERROR"===t.dummy.code)&&_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.summary.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.summary.desc"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}})}),(function(){s.removeClass("zia_email_subject_freeze"),$L(".loaderClass_"+EmailComposeUtil.CURRENT_TAB).addClass("hide"),e.setData("disableDropdown",!1),e.errorHandling()}));else{var d="#emailView_"+a;e.setData("disableDropdown",!1),$L(d).removeClass("hide"),$L(d)[0].toggle(),$L(".loaderClass_"+EmailComposeUtil.CURRENT_TAB).addClass("hide"),s.removeClass("zia_email_subject_freeze")}}),(function(){s.removeClass("zia_email_subject_freeze"),$L(".loaderClass_"+EmailComposeUtil.CURRENT_TAB).addClass("hide"),e.setData("disableDropdown",!1),e.errorHandling()}))},errorHandling:function(){_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.translation.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.translation.desc"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}})},eventListenerHandling:function(e,t){let a="";if(t){let e=editor.getEditorMode();"plainEditor"===e?a=editor.getContent():"richEditor"===e&&(a=editor.zEditor.editorDiv.innerHTML)}else a=$L("#ceSubject_"+EmailComposeUtil.CURRENT_TAB).val();var i=$L(".translateClass_"+EmailComposeUtil.CURRENT_TAB);e=EmailCompose.extractHTMLTags(e,!0).trim(),a=EmailCompose.extractHTMLTags(a,!0).trim(),e&&i.hasClass("disabled eventNone")?(i.removeClass("disabled eventNone"),this.seData&&this.setData("disableDropdown",!1)):e||a&&""!==a||(i.removeClass("hide"),$L("#emailView_"+EmailComposeUtil.CURRENT_TAB).addClass("hide"),i.addClass("disabled eventNone"))},getCheckBoxOptions:function(e){var t="";switch(String(e)){case"1":t=I18n.getMsg("crm.email.summary.feedback.point1");break;case"2":t=I18n.getMsg("crm.email.summary.feedback.point2");break;case"3":t=I18n.getMsg("crm.email.summary.feedback.point3");break;case"4":t=I18n.getMsg("crm.email.summary.feedback.point4");break;case"5":t=I18n.getMsg("crm.email.summary.feedback.point5");break;case"6":t=I18n.getMsg("Others")}return t},getLanguageNameInSpecific:function(e){return this.getData("dropDownLanguageObj")[e]},contentBackup:function(e){let t=e.getEditorMode(),a="";"plainEditor"===t?a=e.getContent():"richEditor"===t&&(a=e.zEditor.editorDiv.innerHTML);var i=$L("crm-email-summary-view")[EmailComposeUtil.CURRENT_TAB-1];i&&i.component&&i.component.setData({actualContentBackup:a,userLan:i.component.getData("currentSelection")}),Lyte.registeredMixins["crm-email-summary-mixin"].eventListenerHandling(a,!1)},subjectBackup:function(){var e=$L("#ceSubject_"+EmailComposeUtil.CURRENT_TAB).val(),t=$L("crm-email-summary-view")[EmailComposeUtil.CURRENT_TAB-1];t&&t.component&&(t.component.setData("actualSubjectBackup",e),t.component.eventListenerHandling(e,!0)),Lyte.registeredMixins["crm-email-summary-mixin"].eventListenerHandling(e,!0)}},{mixins:["crm-email-summary-mixin"]}),Lyte.Component.registerHelper("getAttachmentStyle",(function(e){var t="";switch(e.substr(e.lastIndexOf(".")+1).toLowerCase()){case"jpg":case"gif":case"png":case"jpeg":case"bmp":t="attachmentsPng";break;case"pdf":t="attachmentsPdf";break;case"docx":case"doc":t="attachmentsDocx";break;case"ppt":case"pptx":t="attachmentsPpt";break;case"xlsx":case"xls":t="attachmentsXls";break;case"html":case"xml":case"xhtml":t="attachmentsHtml";break;case"zip":case"rar":case"7z":case"zipx":t="attachmentsRar";break;case"3gp":case"mp4":case"avi":case"flv":case"mpeg":case"wmv":t="attachmentsVideo";break;case"mp3":case"wav":case"wma":t="attachmentsAudio";break;default:t="attachmentsFile"}return t})),Lyte.Component.registerHelper("getId",(function(e){return"English"===e?"":" - "+e}));
