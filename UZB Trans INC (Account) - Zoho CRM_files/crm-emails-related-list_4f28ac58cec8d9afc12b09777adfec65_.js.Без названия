Lyte.Component.register("crm-emails-related-list",{_template:'<template tag-name="crm-emails-related-list"> <span id="isFromNewAPI" value="{{isFromNewAPI}}"></span> <span id="prev_index" value="{{prev_index}}"></span> <span id="next_index" value="{{next_index}}"></span> <div id="ern" class="ernView pR zi1 mB15"> <div id="ernAllMails" class="ernTable"> <div id="mailOuterDiv" class="eRLSessionArea"> <div class="mailDetailToolTip"> <div class="hvrIn crm-font-regular crm-small-font-size">test</div> <span id="mailsToDelete"></span> <span id="mailsSub" class="vH"></span> <template is="if" value="{{expHandlers(module,\'==\',&quot;Quotes&quot;)}}"><template case="true"> <input type="hidden" id="associatedContEmail" value="{{associatedContEmail}}"> </template></template> </div> <lyte-modal data-zcqa="draftECWModal" id="draftEditOld" lt-prop-show="false" lt-prop-height="auto" lt-prop-offset="{&quot;top&quot;:&quot;0px&quot;}" lt-prop-max-width="750px" lt-prop-width="750px"> <template is="registerYield" yield-name="modal"> <lyte-modal-header class="crm-heading-font-size pB10"> {{getI18n(\'crm.email.compose.switch.label.switchtoNew\')}} </lyte-modal-header> <lyte-modal-content class="pT0 pB0"> <div class="mB20 crm-base-font-size lh20"> {{getI18n(\'crm.email.editor.switch.disclaimer.draft\')}} </div> <div class="ecwInfoBlueDiv crm-base-font-size lh20"> <span class=" crm-font-semibold"> {{getI18n(\'crm.label.note\')}}:</span> {{getI18n(\'crm.email.editor.switch.disclaimer.draft.note\')}} </div> </lyte-modal-content> <lyte-modal-footer class="right p30"> <lyte-button data-zcqa="cancelBtnECW" onclick="{{action(\'EmailCompose\',\'close\')}}"> <template is="registerYield" yield-name="text">{{getI18n("crm.button.cancel")}}</template> </lyte-button> <lyte-button data-zcqa="proceedBtnECW" lt-prop-appearance="primary" onclick="{{action(\'EmailCompose\',\'open\')}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.email.editor.btn.proceed\')}}</template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> <template is="if" value="{{expHandlers(mailsList.length,\'!=\',0)}}"><template case="true"><template is="if" value="{{isStringType(mailsList[0])}}"><template case="true"> <lyte-table lt-prop-aria="{{isAccessibilityConfigSupported}}" class="noBorderTable" lt-prop-yield="true" style="width: 100%;"> <template is="registerYield" yield-name="yield"> <lyte-table-structure> <lyte-tbody class="ernLyteBody"> <lyte-tr> <template is="if" value="{{ifContains(mailsList[0],&quot;zohomailunavailable&quot;)}}"><template case="true"> <lyte-td><div class="aligncenter">{{getI18n(\'crm.zmail.unavailable.note\',partnerName)}}</div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;searchfunctionnotavailable&quot;)}}"><template case="true"> <lyte-td><div class="aligncenter">{{getI18n(\'crm.zmail.search.funtion.notavailable\')}}</div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;currentUserMailboxUnavailable&quot;)}}"><template case="true"> <lyte-td><div id="unabletosendmail">{{getI18n(\'crm.zmail.selected.mailbox.unavailable\',zmailId)}}</div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;mailboxUnavailable&quot;)}}"><template case="true"> <lyte-td><div class="aligncenter">{{getI18n(\'crm.zmail.otheruser.mailboxunavil.note\',user_name,user_name,partnerName)}}</div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;ticketUnavailable&quot;)}}"><template case="true"> <lyte-td><div class="aligncenter">{{getI18n(\'crm.zmail.otheruser.pwdchange.note\',user_name,user_name,partnerName)}}</div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;currentUserTicketUnavailable&quot;)}}"><template case="true"> <lyte-td><div class="aligncenter" id="currentUserTicketUnavailable">{{getI18n(\'crm.zmail.update.iscticket\',partnerName)}}</div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;initiateBackup&quot;)}}"><template case="true"> <lyte-td><div class="aligncenter" id="initiateBackup"> <template is="if" value="{{isAdminProfileUser}}"><template case="true"> {{getI18n(\'crm.zmail.backup.status.deactivated.admin\')}} <link-to lt-prop-route="crm.settings.section.zmail-users"> <b>{{getI18n(\'crm.zmail.here\')}}</b> </link-to> </template><template case="false"> {{getI18n(\'crm.zmail.backup.status.deactivated\')}} </template></template> </div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;accountnotactive&quot;)}}"><template case="true"> <lyte-td><div id="accountnotactive" class="pL25 aligncenter">{{getI18n(\'crm.zmail.accountnotactive\',partnerName)}}</div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;imap_sync_in_progress&quot;)}}"><template case="true"> <lyte-td><div id="imap_sync_status" class="aligncenter">{{getI18n(\'crm.label.sync.in.progress\')}}</div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;imap_sync_yet_to_start&quot;)}}"><template case="true"> <lyte-td><div id="imap_sync_status" class="aligncenter">{{getI18n(\'crm.label.sync.not.started\')}}</div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;errorwhileprocessing&quot;)}}"><template case="true"> <lyte-td><div class="aligncenter">{{unescape(getI18n(\'crm.zmail.error.whileprocessing\',supportMailId))}}</div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;permission_disabled&quot;)}}"><template case="true"> <lyte-td><div class="bodyText aligncenter">{{permissionDisabled}}</div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;noAccessToRecord&quot;)}}"><template case="true"> <lyte-td><div class="aligncenter">{{getI18n(\'crm.label.widgets.error.authorization\')}}</div></lyte-td> </template><template case="false"><template is="if" value="{{ifContains(mailsList[0],&quot;gmailOAuth2Error&quot;)}}"><template case="true"> <lyte-td><div class="aligncenter">{{getI18n(\'crm.gmail.authFail\')}}</div></lyte-td> </template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template> </lyte-tr> </lyte-tbody> </lyte-table-structure> </template> </lyte-table> </template><template case="false"> <lyte-table lt-prop-yield="true" class="erlNew noBorderTable erlTable mB20" id="ernTable" on-resize-end="{{method(\'resizeEnd\')}}" after-render="{{method(\'mailsRendered\')}}"> <template is="registerYield" yield-name="yield"> <lyte-table-structure class="erlTableStructure erlTableFixed"> <lyte-thead class="crm-base-font-size ernTableHead {{addTableResizeProp()}}"> <template is="if" value="{{toggleTableHead}}"><template case="true"><lyte-tr> <lyte-th class="ecnChkBoxtd w60" fixed="enable"> <template is="if" value="{{expHandlers(expHandlers(hasPermissionToDeleteMail(module),\'&amp;&amp;\',expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(mailType,\'==\',&quot;ALLUSERSMAILS&quot;),\'||\',expHandlers(mailType,\'==\',&quot;sent_from_crm&quot;)),\'||\',expHandlers(mailType,\'==\',&quot;drafts&quot;)),\'||\',expHandlers(mailType,\'==\',&quot;all_contacts_draft_crm_emails&quot;)),\'||\',expHandlers(mailType,\'==\',&quot;allContacts&quot;))),\'||\',expHandlers(isCheckboxNeeded(user_id),\'&amp;&amp;\',expHandlers(mailType,\'!=\',\'GMail\')))}}"><template case="true"> <lyte-checkbox class="crm-rl-write-action dIB" lt-prop-name="ernHead" lt-prop-value="val" lt-prop-id="checkbox" on-changed="{{method(\'eRLCheckboxActionAll\')}}" data-zcqa="selectAll_{{mail.subject}}"></lyte-checkbox> </template></template> </lyte-th> <template is="if" value="{{expHandlers(expHandlers(mailType,\'==\',&quot;drafts&quot;),\'||\',expHandlers(mailType,\'==\',&quot;all_contacts_draft_crm_emails&quot;))}}"><template case="true"> <lyte-th class="{{setColWidth(this,columnWidths)}}" data-zcqa="erl_subject" data-col-name="subject"> <lyte-text lt-prop-value="{{getI18n(\'crm.label.subject\')}}"></lyte-text> </lyte-th> </template><template case="false"> <lyte-th class="ernViewSummaryTH {{setColWidth(this,columnWidths)}}" data-zcqa="erl_subject" data-col-name="subject"><lyte-text lt-prop-value="{{getI18n(\'crm.label.subject\')}}"></lyte-text></lyte-th> </template></template> <template is="if" value="{{expHandlers(expHandlers(expHandlers(isEmailSummaryEnabled,\'&amp;&amp;\',expHandlers(mailType,\'!=\',&quot;drafts&quot;)),\'&amp;&amp;\',expHandlers(mailType,\'!=\',&quot;all_contacts_draft_crm_emails&quot;)),\'&amp;&amp;\',expHandlers(isThreadViewEnabled(),\'!\'))}}"><template case="true"> <lyte-th></lyte-th> </template></template> <template is="if" value="{{expHandlers(isZiaEnabled,\'&amp;&amp;\',isSentimentEnabled)}}"><template case="true"> <lyte-th class=" {{setColWidth(this,columnWidths)}}" data-zcqa="erl_sentiment" data-col-name="sentiment"><lyte-text lt-prop-value="{{getI18n(\'sentiment\')}}"></lyte-text></lyte-th> </template></template> <template is="if" value="{{expHandlers(isZiaEnabled,\'&amp;&amp;\',isEmotionsEnabled)}}"><template case="true"> <lyte-th class="{{setColWidth(this,columnWidths)}}" data-zcqa="erl_emotion" data-col-name="emotion"><lyte-text lt-prop-value="{{getI18n(\'crm.label.zia.emotion\')}}"></lyte-text></lyte-th> </template></template> <template is="if" value="{{expHandlers(isZiaEnabled,\'&amp;&amp;\',isIntentEnabled)}}"><template case="true"> <lyte-th class="{{setColWidth(this,columnWidths)}}" data-zcqa="erl_intent" data-col-name="intent"><lyte-text lt-prop-value="{{getI18n(\'crm.imap.intent\')}}"></lyte-text></lyte-th> </template></template> <template is="if" value="{{expHandlers(expHandlers(mailType,\'==\',&quot;drafts&quot;),\'||\',expHandlers(mailType,\'==\',&quot;all_contacts_draft_crm_emails&quot;))}}"><template case="true"> <lyte-th class="pL10 {{setColWidth(this,columnWidths)}}" data-zcqa="erl_content" data-col-name="content"><lyte-text lt-prop-value="{{getI18n(\'crm.email.compose.draft.content\')}}"></lyte-text></lyte-th> </template></template> <lyte-th class="{{setColWidth(this,columnWidths)}}" data-zcqa="erl_date" data-col-name="date"><lyte-text lt-prop-value="{{getI18n(\'Date\')}}"></lyte-text></lyte-th> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(mail_type,\'!=\',2),\'&amp;&amp;\',expHandlers(mail_type,\'!=\',3)),\'&amp;&amp;\',expHandlers(mail_type,\'!=\',9)),\'&amp;&amp;\',expHandlers(mail_type,\'!=\',10))}}"><template case="true"> <lyte-th class="{{setColWidth(this,columnWidths)}}" data-zcqa="erl_source" data-col-name="source"><lyte-text lt-prop-value="{{getI18n(\'crm.relatedList.emails.header.Source\')}}"></lyte-text></lyte-th> </template></template> <template is="if" value="{{expHandlers(expHandlers(mailType,\'==\',&quot;drafts&quot;),\'||\',expHandlers(mailType,\'==\',&quot;all_contacts_draft_crm_emails&quot;))}}"><template case="true"> <lyte-th class="w12_per {{setColWidth(this,columnWidths)}}" data-zcqa="erl_fromaddress" data-col-name="fromaddress"><lyte-text lt-prop-value="{{getI18n(\'crm.label.from.address\')}}"></lyte-text></lyte-th> </template><template case="false"> <lyte-th class="w10_per {{setColWidth(this,columnWidths)}}" data-zcqa="erl_sentby" data-col-name="sentby"><lyte-text lt-prop-value="{{getI18n(\'Sent By\')}}"></lyte-text></lyte-th> </template></template> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(mail_type,\'!=\',7),\'&amp;&amp;\',expHandlers(mail_type,\'!=\',8)),\'&amp;&amp;\',expHandlers(mail_type,\'!=\',9)),\'&amp;&amp;\',expHandlers(mail_type,\'!=\',10))}}"><template case="true"> <lyte-th class="{{setColWidth(this,columnWidths)}}" data-zcqa="erl_status" data-col-name="status"><lyte-text lt-prop-value="{{getI18n(\'Status\')}}"></lyte-text></lyte-th> </template></template> </lyte-tr></template></template> </lyte-thead> <lyte-tbody class="ernLyteBody"> <template is="for" items="{{mailsList}}" item="mail" index="index"> <lyte-tr class=" topband_dv_row {{getreadUnreadClass(mail.read)}}"> <lyte-td class="ecnChkBoxtd"> <template is="if" value="{{expHandlers(expHandlers(hasPermissionToDeleteMail(module),\'&amp;&amp;\',expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(mailType,\'==\',&quot;ALLUSERSMAILS&quot;),\'||\',expHandlers(mailType,\'==\',&quot;sent_from_crm&quot;)),\'||\',expHandlers(mailType,\'==\',&quot;drafts&quot;)),\'||\',expHandlers(mailType,\'==\',&quot;all_contacts_draft_crm_emails&quot;)),\'||\',expHandlers(mailType,\'==\',&quot;allContacts&quot;))),\'||\',expHandlers(isCheckboxNeeded(user_id),\'&amp;&amp;\',expHandlers(mailType,\'!=\',\'GMail\')))}}"><template case="true"> <lyte-checkbox class="crm-rl-write-action dIB" lt-prop-name="ernRows" lt-prop-value="val" lt-prop-id="checkbox" on-changed="{{method(\'eRLCheckboxAction\')}}" data-zcqa="select_{{mail.subject}}"></lyte-checkbox> </template></template> </lyte-td> <lyte-td class=" rLEmailSub cP" purpose="{{mail.viewmail}}" onclick="{{action(\'viewEntEmail\',mail.message_id,mailType,getI18n(\'crm.button.close\'),capitalizeStatus(mail.status,mail.sent),\'\',undefined,getRead(mail.read),encodeJS(mail.owner[\'id\']),this,getModuleEntIdSub(mail.linked_record,moduleEntityId),\'\',mail.thread_id)}}" index="{{index}}" viewid="mdv_{{index}}" data-searchid="{{mail.searchid}}" data-isunread="{{getRead(mail.read)}}" data-contactid="{{mail.linked_record[\'id\']}}"> <div class="{{checkIfDealsPresent(mail.linked_record[\'id\'],mail.linked_record[\'name\'])}} {{addClassForSubject()}} flexAlignCenter" data-userid="{{mail.owner[\'id\']}}" data-contactid="{{mail.linked_record[\'id\']}}" data-emailtype="{{mail.viewmail}}" data-mailsource="{{mail.massMailSource}}" data-msgid="{{mail.message_id}}" data-dealid="{{mail.linked_record[\'id\']}}" data-dealname="{{mail.linked_record[\'name\']}}" data-threadid="{{mail.thread_id}}" id="rLEmailSub_{{mail.message_id}}"> <div class="mR10 dIF mailStatusERL"> <template is="if" value="{{expHandlers(mail.sent,\'==\',true)}}"><template case="true"><template is="if" value="{{checkIfMailFailedOrScheduled(mail.status[0].type,&quot;failed&quot;)}}"><template case="true"> <template is="if" value="{{isThreadViewEnabled()}}"><template case="true"><crmutil-icon icon-name="mail-info" icon-class="zcicn-mail-info zcicn-color-red-mixed crmBaseIcon " data-zcqa="mailicon_{{mail.subject}}" onmouseover="{{action(\'toolTipShow\',element,mail.status[0].failed_reason)}}" onmouseout="{{action(\'hideTooltip\')}}"></crmutil-icon></template><template case="false"><span class="erl-mail-failed" data-zcqa="mailicon_{{mail.subject}}" onmouseover="{{action(\'toolTipShow\',element,mail.status[0].failed_reason)}}" onmouseout="{{action(\'hideTooltip\')}}"></span></template></template> </template><template case="false"><template is="if" value="{{checkIfMailFailedOrScheduled(mail.status[0].type,&quot;scheduled&quot;)}}"><template case="true"> <template is="if" value="{{isThreadViewEnabled()}}"><template case="true"><crmutil-icon icon-name="mail-scheduled" icon-class="zcicn-mail-scheduled zcicn-color-yellow-mixed crmBaseIcon " data-zcqa="mailicon_{{mail.subject}}" lt-prop-title="{{capitalize(getMailStatusForHover(mail.status))}}"></crmutil-icon></template><template case="false"><span class="erl-mail-scheduled" data-zcqa="mailicon_{{mail.subject}}" lt-prop-title="{{capitalize(getMailStatusForHover(mail.status))}}"></span></template></template> </template><template case="false"> <template is="if" value="{{isThreadViewEnabled()}}"><template case="true"><crmutil-icon icon-name="mail-sent" icon-class="zcicn-mail-sent zcicn-color-green-mixed crmBaseIcon " data-zcqa="mailicon_{{mail.subject}}" lt-prop-title="{{capitalize(getMailStatusForHover(mail.status))}}"></crmutil-icon></template><template case="false"><span class="erl-mail-outgoing" data-zcqa="mailicon_{{mail.subject}}" lt-prop-title="{{capitalize(getMailStatusForHover(mail.status))}}"></span></template></template> </template></template></template></template></template><template case="false"><template is="if" value="{{expHandlers(expHandlers(mailType,\'==\',&quot;drafts&quot;),\'||\',expHandlers(mailType,\'==\',&quot;all_contacts_draft_crm_emails&quot;))}}"><template case="true"> <template is="if" value="{{isThreadViewEnabled()}}"><template case="true"><crmutil-icon icon-name="mail-edit" icon-class="zcicn-mail-edit crmBaseIcon " data-zcqa="mailicon_{{mail.subject}}" lt-prop-title="{{capitalize(getMailStatusForHover(mail.status))}}"></crmutil-icon></template><template case="false"><span class="erl-mail-draft" data-zcqa="mailicon_{{mail.subject}}" lt-prop-title="{{capitalize(getMailStatusForHover(mail.status))}}"></span></template></template> </template><template case="false"> <template is="if" value="{{isThreadViewEnabled()}}"><template case="true"><crmutil-icon icon-name="mail-received" icon-class="zcicn-mail-received zcicn-color-blue-mixed crmBaseIcon " data-zcqa="mailicon_{{mail.subject}}" lt-prop-title="{{capitalize(getMailStatusForHover(mail.status))}}"></crmutil-icon></template><template case="false"><span class="erl-mail-incoming" data-zcqa="mailicon_{{mail.subject}}" lt-prop-title="{{capitalize(getMailStatusForHover(mail.status))}}"></span></template></template> </template></template></template></template> </div> <div class="erlSubjectBodyContainer {{checkIfDealsPresent(mail.linked_record[\'id\'],mail.linked_record[\'name\'])}}"> <div class="ecnBodyTxt dF aiCenter crm-base-font-size mB5 {{checkIfDealsPresent(mail.linked_record[\'id\'],mail.linked_record[\'name\'])}}" purpose="{{mail.viewmail}}" data-isunread="{{getRead(mail.read)}}"> <template is="if" value="{{expHandlers(mail.massMailSource,\'!=\',100)}}"><template case="true"> <div class="dF crmEllipticText vaM flex2 {{checkIfDealsPresent(mail.linked_record[\'id\'],mail.linked_record[\'name\'])}} ernDealDiv aiCenter w100_per"> <template is="if" value="{{mail.read}}"><template case="true"><template is="if" value="{{expHandlers(expHandlers(expHandlers(mailType,\'==\',&quot;drafts&quot;),\'||\',expHandlers(mailType,\'==\',&quot;all_contacts_draft_crm_emails&quot;)),\'&amp;&amp;\',expHandlers(mail.subject,\'==\',null))}}"><template case="true"> <lyte-text id="{{mail.message_id}}" data-zcqa="{{mail.subject}}" class="link emailRLSubjectText" index="{{expHandlers(index,\'+\',\'\')}}" lt-prop-value="{{getI18n(\'crm.template.email.nosubject\')}}&nbsp;" lt-prop-title="{{getI18n(\'crm.template.email.nosubject\')}}&nbsp;" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottomright&quot; }"> </lyte-text> </template><template case="false"> <lyte-text id="{{mail.message_id}}" purpose="{{mail.viewmail}}" data-zcqa="{{mail.subject}}" class="link emailRLSubjectText" index="{{expHandlers(index,\'+\',\'\')}}" lt-prop-value="{{mail.subject}}&nbsp;" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottomright&quot; }"> </lyte-text> </template></template></template><template case="false"> <lyte-text id="{{mail.message_id}}" purpose="{{mail.viewmail}}" data-zcqa="{{mail.subject}}" class="link crm-font-bold emailRLSubjectText" index="{{expHandlers(index,\'+\',\'\')}}" lt-prop-value="{{mail.subject}}&nbsp;" lt-prop-title="{{mail.subject}}&nbsp;" lt-prop-tooltip-config="{ &quot;position&quot; : &quot;bottomright&quot; }"> </lyte-text> </template></template><template is="if" value="{{expHandlers(expHandlers(expHandlers(ifAnyMatch(module,&quot;=&quot;,&quot;Contacts&quot;,module,&quot;=&quot;,&quot;Potentials&quot;,module,&quot;=&quot;,&quot;Accounts&quot;),\'&amp;&amp;\',expHandlers(mailType,\'!=\',&quot;drafts&quot;)),\'&amp;&amp;\',expHandlers(mailType,\'!=\',&quot;all_contacts_draft_crm_emails&quot;)),\'&amp;&amp;\',canShowEmailDealLinking(mailType))}}"><template case="true"><template is="if" value="{{expHandlers(mail.source,\'!=\',null)}}"><template case="true"> <input type="hidden" onclick="{{action(\'showLookUp\',mail.message_id)}}" id="assoPotential_{{mail.message_id}}" data-id="{{mail.linked_record[&quot;id&quot;]}}" data-contactid="{{mail.related_to_record[&quot;id&quot;]}}" value="{{mail.linked_record[\'name\']}}"> <template is="if" value="{{expHandlers(ifAnyMatch(module,&quot;=&quot;,&quot;Contacts&quot;,module,&quot;=&quot;,&quot;Potentials&quot;),\'||\',expHandlers(expHandlers(expHandlers(module,\'==\',&quot;Accounts&quot;),\'&amp;&amp;\',expHandlers(mailType,\'!=\',&quot;all_contacts_draft_crm_emails&quot;)),\'&amp;&amp;\',expHandlers(mailType,\'!=\',&quot;allContacts&quot;)))}}"><template case="true"><template is="if" value="{{expHandlers(&quot;Potentials&quot;,\'==\',module)}}"><template case="true"> <template is="if" value="{{isThreadViewEnabled()}}"><template case="true"><crmutil-icon class="mL10 erlLinkDealIcon cP erlThreadViewIcon hide" icon-name="link" icon-class="zcicn-link crmBaseIcon " data-zcqa="rLEmailLinkDeal" onclick="{{action(\'changeDeal\',expHandlers(\'assoPotential_\',\'+\',mail.message_id))}}" onmouseenter="{{action(\'showTooltip\',getModule(\'crm.relatedList.deals.link\',\'Potentials\'))}}" onmouseleave="{{action(\'hideTooltip\')}}"></crmutil-icon></template><template case="false"><i class="svgIcons svgAttachIcon dIB mL10 cP fL mT7 " data-zcqa="rLEmailLinkDeal" onclick="{{action(\'changeDeal\',expHandlers(\'assoPotential_\',\'+\',mail.message_id))}}" onmouseenter="{{action(\'showTooltip\',getModule(\'crm.relatedList.deals.link\',\'Potentials\'))}}" onmouseleave="{{action(\'hideTooltip\')}}"></i></template></template> </template></template><template is="if" value="{{expHandlers(isDealsMail,\'==\',true)}}"><template case="true"> <div class="fL cP mL10 pR rLEmailChangeDeal" data-zcqa="rLEmailChangeDeal" onclick="{{action(\'showDealPopup\',this,expHandlers(\'assoPotential_\',\'+\',mail.message_id),true,mail)}}"> <template is="if" value="{{isThreadViewEnabled()}}"><template case="true"><crmutil-icon class="cP mT10" icon-name="more-hr" icon-class="zcicn-more-hr crmBaseIcon "></crmutil-icon></template><template case="false"><i class="ldMoreicon {{icon()}} fL cP mT7"></i></template></template> </div> </template><template case="false"> <template is="if" value="{{isThreadViewEnabled()}}"><template case="true"><crmutil-icon icon-name="potentials" icon-class="zcicn-potentials crmBaseIcon " class="fL cP mL10 pR rLEmailChangeDeal" data-zcqa="rLEmailChangeDeal" onclick="{{action(\'showDealPopup\',this,expHandlers(\'assoPotential_\',\'+\',mail.message_id),false,mail)}}" onmouseenter="{{action(\'showHideDealToolTip\',this,\'show\')}}" onmouseleave="{{action(\'showHideDealToolTip\',this,\'hide\')}}"></crmutil-icon></template><template case="false"><div class=" cP mL10 pR rLEmailChangeDeal" data-zcqa="rLEmailChangeDeal" onclick="{{action(\'showDealPopup\',this,expHandlers(\'assoPotential_\',\'+\',mail.message_id),false,mail)}}" onmouseenter="{{action(\'showHideDealToolTip\',this,\'show\')}}" onmouseleave="{{action(\'showHideDealToolTip\',this,\'hide\')}}"> <i class="svgPotentialIcon svgIcons fL cP"></i> </div></template></template> </template></template><template is="if" value="{{expHandlers(expHandlers(&quot;Potentials&quot;,\'==\',module),\'&amp;&amp;\',expHandlers(mail.source,\'==\',getI18n(&quot;emailSource.sendmail.option.bcc&quot;)))}}"><template case="true"> <span class="MoveToMailIcon mL10" onmouseenter="{{action(\'mailToolTipHvr\',this,1)}}" onmouseleave="{{action(\'mailToolTipHvr\',this,0)}}" onclick="{{action(\'potentialPopUp\',mail.message_id,this)}}"></span> </template></template></template></template></template></template></template></template> <template is="if" value="{{expHandlers(mail.thread_id,\'!=\',null)}}"><template case="true"> <template is="if" value="{{isThreadViewEnabled()}}"><template case="true"><crmutil-icon icon-name="chat-conversation" icon-class="zcicn-chat-conversation zcicn16 crmBaseIcon " class="erlThreadViewIcon mL10" lt-prop-title="{{getI18n(\'crm.zmail.view.relatedmails\')}}" onclick="{{action(\'getRelatedMails\',mail.message_id,encodeJS(mail.owner[\'id\']),mailType,capitalizeStatus(mail.status,mail.sent),this,getModuleEntIdSub(mail.linked_record,moduleEntityId),mail.thread_id)}}" data-zcqa="relMails_{{mail.subject}}"></crmutil-icon></template><template case="false"><span style="margin-top: 6px;" class="erlThreadViewIcon {{icon()}} mR10 mL10 fShrink" lt-prop-title="{{getI18n(\'crm.zmail.view.relatedmails\')}}" onclick="{{action(\'getRelatedMails\',mail.message_id,encodeJS(mail.owner[\'id\']),mailType,capitalizeStatus(mail.status,mail.sent),this,getModuleEntIdSub(mail.linked_record,moduleEntityId),mail.thread_id)}}" data-zcqa="relMails_{{mail.subject}}"></span></template></template> </template></template> </div> </template></template> </div> <div class="crmEllipticText crm-base-font-size ernUserName flexAlignCenter" data-zcqa="receiver_{{mail.subject}}"> <template is="if" value="{{showAttachIcon(mail)}}"><template case="true"> <crmutil-icon icon-name="attachment" class="etViewMain edViewAttachementIcon dIB vaM mR10" icon-class="zcicn-attachment crmBaseIcon" onclick="{{action(\'showAttachments\',this,mail.message_id,encodeJS(mail.owner[\'id\']),mail.thread_id,getModuleEntIdSub(mail.linked_record,moduleEntityId))}}" data-zcqa="email_attachments_{{mail.subject}}"></crmutil-icon> </template></template> <lyte-text lt-prop-value="{{removeQoutes(toMailsListText(mail))}}" lt-prop-title="{{toMailsList(mail)}}"> </lyte-text> </div> </div> </div> <template is="if" value="{{expHandlers(expHandlers(expHandlers(isEmailSummaryEnabled,\'&amp;&amp;\',expHandlers(mailType,\'!=\',&quot;drafts&quot;)),\'&amp;&amp;\',expHandlers(mailType,\'!=\',&quot;all_contacts_draft_crm_emails&quot;)),\'&amp;&amp;\',isThreadViewEnabled())}}"><template case="true"> <div class="pA pL10 ernSummaryContainer"> <span class="ernBlueTxt cP crm-base-font-size vH fR ernSummery summary_{{mail.message_id}}" id="ernSummery2" onclick="{{action(\'viewSummary\',mail.message_id,mailType,getI18n(\'crm.button.close\'),capitalizeStatus(mail.status,mail.sent),\'\',undefined,getRead(mail.read),encodeJS(mail.owner[\'id\']),this,getModuleEntIdSub(mail.linked_record,moduleEntityId),\'\',mail.thread_id,mail.subject,mailobj,mail.status[0].type)}}" data-zcqa="view_summary_{{mail.subject}}">{{getI18n(\'crm.view.email.summary\')}}</span> </div> </template></template> </lyte-td> <template is="if" value="{{expHandlers(expHandlers(mailType,\'==\',&quot;drafts&quot;),\'||\',expHandlers(mailType,\'==\',&quot;all_contacts_draft_crm_emails&quot;))}}"><template case="true"> <lyte-td class="draftContDiv eRl_tableWordBreak" data-zcqa="summary_{{mail.subject}}"><lyte-text lt-prop-value="{{mail.summary}}"></lyte-text></lyte-td> </template><template case="false"><template is="if" value="{{expHandlers(isEmailSummaryEnabled,\'&amp;&amp;\',expHandlers(isThreadViewEnabled(),\'!\'))}}"><template case="true"> <lyte-td> <span class="ernBlueTxt cP crm-base-font-size dF vH flex1 fR ernSummery summary_{{mail.message_id}}" id="ernSummery2" onclick="{{action(\'viewSummary\',mail.message_id,mailType,getI18n(\'crm.button.close\'),capitalizeStatus(mail.status,mail.sent),\'\',undefined,getRead(mail.read),encodeJS(mail.owner[\'id\']),this,getModuleEntIdSub(mail.linked_record,moduleEntityId),\'\',mail.thread_id,mail.subject,mail.status[0].type)}}" data-zcqa="view_summary_{{mail.subject}}"><lyte-text lt-prop-value="{{getI18n(\'crm.view.email.summary\')}}"></lyte-text></span> </lyte-td> </template></template></template></template> <template is="if" value="{{expHandlers(isZiaEnabled,\'&amp;&amp;\',isSentimentEnabled)}}"><template case="true"> <lyte-td> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(isThreadViewEnabled(),\'&amp;&amp;\',expHandlers(mail.sentiment_info,\'!=\',undefined)),\'&amp;&amp;\',expHandlers(mail.sentiment_info,\'!=\',&quot;&quot;)),\'&amp;&amp;\',expHandlers(mail.sentiment_info,\'!=\',&quot;Neutral&quot;)),\'&amp;&amp;\',expHandlers(mail.sentiment_info,\'!=\',&quot;Consecutive Negative&quot;))}}"><template case="true"> <crmutil-icon class="erlSentimentScale" lt-prop-title="{{getSentimentHoverValue(mail.sentiment_info)}}" icon-name="{{getSentimentIconUtilName(mail.sentiment_info)}}" icon-class="{{getSentimentIconUtilClass(mail.sentiment_info)}}" data-zcqa="{{mail.sentiment_info}}_{{mail.message_id}}" lt-prop-tooltip-config=" { &quot;position&quot; : &quot;top&quot; , &quot;appearance&quot; : &quot;box&quot; , &quot;margin&quot; : 0 , &quot;showdelay&quot; : 0 , &quot;hidedelay&quot; : 0 , &quot;maxdisplaytime&quot; : 5000 } "></crmutil-icon> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(mail.sentiment_info,\'!=\',undefined),\'&amp;&amp;\',expHandlers(mail.sentiment_info,\'!=\',&quot;&quot;)),\'&amp;&amp;\',expHandlers(mail.sentiment_info,\'!=\',&quot;Neutral&quot;)),\'&amp;&amp;\',expHandlers(mail.sentiment_info,\'!=\',&quot;Consecutive Negative&quot;))}}"><template case="true"> <span class="sentiment{{mail.sentiment_info}}" data-value="{{mail.sentiment_info}}" lt-prop-title="{{getSentimentHoverValue(mail.sentiment_info)}}" name="sentimenticon_{{mail.message_id}}" data-zcqa="{{mail.sentiment_info}}_{{mail.message_id}}" lt-prop-tooltip-config=" { &quot;position&quot; : &quot;top&quot; , &quot;appearance&quot; : &quot;box&quot; , &quot;margin&quot; : 0 , &quot;showdelay&quot; : 0 , &quot;hidedelay&quot; : 0 , &quot;maxdisplaytime&quot; : 5000 } "></span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(expHandlers(mail.sentiment_info,\'!=\',undefined),\'&amp;&amp;\',expHandlers(mail.sentiment_info,\'!=\',&quot;&quot;)),\'&amp;&amp;\',expHandlers(mail.sentiment_info,\'!=\',&quot;Neutral&quot;))}}"><template case="true"> <span class="sentimentCNS" data-value="CNS" lt-prop-title="{{getSentimentHoverValue(\'CNS\')}}" name="sentimenticon_{{mail.message_id}}" data-zcqa="CNS_{{mail.message_id}}" lt-prop-tooltip-config=" { &quot;position&quot; : &quot;top&quot; , &quot;appearance&quot; : &quot;box&quot; , &quot;margin&quot; : 0 , &quot;showdelay&quot; : 0 , &quot;hidedelay&quot; : 0 , &quot;maxdisplaytime&quot; : 5000 } "></span> </template><template case="false"> <span class="dI">-</span> </template></template></template></template></template></template> </lyte-td> </template></template> <template is="if" value="{{expHandlers(isZiaEnabled,\'&amp;&amp;\',isEmotionsEnabled)}}"><template case="true"> <lyte-td class="crm-base-font-size"> <template is="if" value="{{expHandlers(expHandlers(isThreadViewEnabled(),\'&amp;&amp;\',expHandlers(mail.emotion,\'!=\',undefined)),\'&amp;&amp;\',expHandlers(mail.emotion,\'!=\',&quot;&quot;))}}"><template case="true"> <span class="crm-base-font-size erlEmotion maxW100per {{getEmotionClass(mail.emotion)}} boxBB dIF aiCenter" data-zcqa="{{mail.emotion}}_{{mail.subject}}"> <lyte-text lt-prop-value="{{getTranslatedEmotionValue(mail.emotion)}}"></lyte-text> </span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(mail.emotion,\'!=\',undefined),\'&amp;&amp;\',expHandlers(mail.emotion,\'!=\',&quot;&quot;))}}"><template case="true"> <span class="crm-base-font-size" data-zcqa="{{mail.emotion}}_{{mail.subject}}" lt-prop-title="{{getTranslatedEmotionValue(mail.emotion)}}" lt-prop-tooltip-config=" { &quot;position&quot; : &quot;top&quot; , &quot;appearance&quot; : &quot;box&quot; , &quot;margin&quot; : 0 , &quot;showdelay&quot; : 0 , &quot;hidedelay&quot; : 0 , &quot;maxdisplaytime&quot; : 5000 } "><lyte-text lt-prop-value="{{getTranslatedEmotionValue(mail.emotion)}}"></lyte-text></span> </template><template case="false"> <span class="dI">-</span> </template></template></template></template> </lyte-td> </template></template> <template is="if" value="{{expHandlers(isZiaEnabled,\'&amp;&amp;\',isIntentEnabled)}}"><template case="true"> <lyte-td class="crm-base-font-size"> <template is="if" value="{{expHandlers(expHandlers(isThreadViewEnabled(),\'&amp;&amp;\',expHandlers(mail.intent,\'!=\',undefined)),\'&amp;&amp;\',expHandlers(mail.intent,\'!=\',&quot;&quot;))}}"><template case="true"> <span class="erlIntent edvBlack crm-base-font-size boxBB dIF aiCenter maxW100per" lt-prop-title="{{getTranslatedIntentValue(mail.intent,\'true\')}}" lt-prop-tooltip-config=" { &quot;position&quot; : &quot;top&quot; , &quot;appearance&quot; : &quot;box&quot; , &quot;margin&quot; : 0 , &quot;showdelay&quot; : 0 , &quot;hidedelay&quot; : 0 , &quot;maxdisplaytime&quot; : 5000 } "> <lyte-text lt-prop-value="{{getTranslatedIntentValue(mail.intent)}}"></lyte-text> </span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(mail.intent,\'!=\',undefined),\'&amp;&amp;\',expHandlers(mail.intent,\'!=\',&quot;&quot;))}}"><template case="true"> <span data-zcqa="{{mail.intent}}_{{mail.subject}}" lt-prop-title="{{getTranslatedIntentValue(mail.intent,\'true\')}}" class="crm-base-font-size" lt-prop-tooltip-config=" { &quot;position&quot; : &quot;top&quot; , &quot;appearance&quot; : &quot;box&quot; , &quot;margin&quot; : 0 , &quot;showdelay&quot; : 0 , &quot;hidedelay&quot; : 0 , &quot;maxdisplaytime&quot; : 5000 } ">{{getTranslatedIntentValue(mail.intent)}}</span> </template><template case="false"> <span class="dI">-</span> </template></template></template></template> </lyte-td> </template></template> <template is="if" value="{{expHandlers(isThreadViewEnabled(),\'!\')}}"><template case="true"> <lyte-td class="crm-base-font-size ellipsistext"> <lyte-text class="lv_datefield" data-zcqa="date_{{mail.subject}}" lt-prop-title="{{getDateNTime(mail.time)}}" lt-prop-value="{{getSentDate(mail.time)}}"></lyte-text> </lyte-td> </template><template case="false"> <lyte-td class="crm-base-font-size"> <lyte-text class="lv_datefield" data-zcqa="date_{{mail.subject}}" lt-prop-value="{{getMailMagnetDateNTime(mail.time)}}"></lyte-text> </lyte-td> </template></template> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(mail_type,\'!=\',2),\'&amp;&amp;\',expHandlers(mail_type,\'!=\',3)),\'&amp;&amp;\',expHandlers(mail_type,\'!=\',9)),\'&amp;&amp;\',expHandlers(mail_type,\'!=\',10))}}"><template case="true"> <lyte-td class="crm-base-font-size ellipsistext" data-zcqa="source_{{mail.subject}}"><lyte-text lt-prop-value="{{mail.source}}"></lyte-text></lyte-td> </template></template> <lyte-td style="text-overflow: ellipsis;overflow: hidden;"><lyte-text lt-prop-value="{{getSentBy(mail.from)}}"></lyte-text></lyte-td> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(mail_type,\'!=\',7),\'&amp;&amp;\',expHandlers(mail_type,\'!=\',8)),\'&amp;&amp;\',expHandlers(mail_type,\'!=\',9)),\'&amp;&amp;\',expHandlers(mail_type,\'!=\',10))}}"><template case="true"><template is="if" value="{{expHandlers(mail.status[0].type,\'==\',\'bounced\')}}"><template case="true"> <lyte-td class="crm-base-font-size" data-zcqa="status_{{mail.subject}}"> <div class="emailTrackingDiv cP"> <div class="emailtracking_Arrow pA" style="top:50%"></div> <div class="fL"> <div class="crm-small-font-size crm-font-regular fL cBoth"> <lyte-text class="w70_per" lt-prop-value="{{mail.status[0].type}}"></lyte-text></div> <template is="if" value="{{expHandlers(mail.status[0].bounced_reason,\'!=\',undefined)}}"><template case="true"> <div class="fL cBoth" style="max-width:300px;"><span class="crm-small-font-size crm-font-regular">{{getI18n(\'crm.InvalidTicket.Reasons\')}}: </span><span class="crm-small-font-size crm-font-regular" style="word-wrap:break-word;white-space:normal">{{mail.status[0].bounced_reason}}</span></div> </template></template> </div> </div> <lyte-text class="vaM " lt-prop-value="{{getI18n(\'crm.emailstats.bounces\')}}"></lyte-text> <crmutil-icon onmouseover="{{action(\'showRLEmailStatusTooltipOver\',this,getDateNTime(mail.status[0].bounced_time),mail.status[0].bounced_reason,mail.status[0].category,mail.status[0].sub_category)}}" lyte-hovercard="true" class="mL5 erlStatusInfo hide vaM" icon-name="alert-filled" icon-class="zcicn-alert-filled zcicn12 zcicn_sandal "></crmutil-icon> </lyte-td> </template><template case="false"><template is="if" value="{{expHandlers(mail.status[0].type,\'==\',\'unsubscribed\')}}"><template case="true"> <template is="if" value="{{isThreadViewEnabled()}}"><template case="true"> <lyte-td class=" crm-base-font-size"> <span class="dIB pR" id="mailTrackingDiv"> <lyte-text class="vaM " lt-prop-value="{{getI18n(\'crm.unsubscription.unsubscribed\')}}"></lyte-text><crmutil-icon onmouseover="{{action(\'showRLEmailStatusTooltipOver\',this,\'subscription\',getDateNTime(mail.status[0].unsubTime))}}" lyte-hovercard="true" class="mL5 erlStatusInfo hide vaM {{if(popoverElem === ,\'className\',\'\')}}" icon-name="info-rounded" icon-class="zcicn-info-rounded crmBaseIcon "></crmutil-icon> </span> </lyte-td> </template><template case="false"> <lyte-td class="cP crm-base-font-size" onmouseover="{{action(\'showRLEmailStatusTooltipOver\',this,\'subscription\',getDateNTime(mail.status[0].unsubTime))}}" onmouseout="{{action(\'showRLEmailStatusTooltipOut\',this)}}"> <span class="dIB pR" id="mailTrackingDiv"> {{getI18n(\'crm.unsubscription.unsubscribed\')}} </span> </lyte-td> </template></template> </template><template case="false"><template is="if" value="{{expHandlers(mail.status[0].first_open,\'!=\',undefined)}}"><template case="true"> <template is="if" value="{{expHandlers(isThreadViewEnabled(),\'!\')}}"><template case="true"> <lyte-td class="cP crm-base-font-size" onmouseover="{{action(\'showRLEmailStatusTooltip\',this,1,\'openedClicked\',checkUndefinedAndGetDate(getClickVal(mail.status,1)),mail.status[0].count,getDateNTime(mail.status[0].first_open),getDateNTime(mail.status[0].last_open),getClickVal(mail.status,2),checkUndefinedAndGetDate(getClickVal(mail.status,3)))}}" onmouseout="{{action(\'showRLEmailStatusTooltipOut\',this)}}" data-zcqa="status_{{mail.subject}}"> <template is="if" value="{{expHandlers(expHandlers(mail.status.length,\'>\',1),\'&amp;&amp;\',expHandlers(mail.status[1].first_click,\'!=\',undefined))}}"><template case="true">{{getI18n(\'crm.emailstats.clicks\')}}</template><template case="false">{{getI18n(\'crm.emailstats.opens\')}}</template></template> </lyte-td> </template><template case="false"> <lyte-td class=" crm-base-font-size" data-zcqa="status_{{mail.subject}}"> <template is="if" value="{{expHandlers(expHandlers(mail.status.length,\'>\',1),\'&amp;&amp;\',expHandlers(mail.status[1].first_click,\'!=\',undefined))}}"><template case="true"> <div class="crm-font-regular"><lyte-text class="vaM " lt-prop-value="{{getI18n(\'crm.emailstats.clicks\')}}"></lyte-text><crmutil-icon onmouseover="{{action(\'showRLEmailStatusTooltip\',this,1,\'openedClicked\',checkUndefinedAndGetDate(getClickVal(mail.status,1)),mail.status[0].count,getDateNTime(mail.status[0].first_open),getDateNTime(mail.status[0].last_open),getClickVal(mail.status,2),checkUndefinedAndGetDate(getClickVal(mail.status,3)))}}" onmouseout="{{action(\'showRLEmailStatusTooltipOut\',this)}}" lyte-hovercard="true" class="mL5 erlStatusInfo hide vaM" icon-name="info-rounded" icon-class="zcicn-info-rounded crmBaseIcon "></crmutil-icon></div> </template><template case="false"> <div class="crm-font-regular"><lyte-text lyte-hovercard="true" class="vaM " lt-prop-value="{{getI18n(\'crm.emailstats.opens\')}}"></lyte-text><crmutil-icon onmouseover="{{action(\'showRLEmailStatusTooltip\',this,1,\'openedClicked\',checkUndefinedAndGetDate(getClickVal(mail.status,1)),mail.status[0].count,getDateNTime(mail.status[0].first_open),getDateNTime(mail.status[0].last_open),getClickVal(mail.status,2),checkUndefinedAndGetDate(getClickVal(mail.status,3)))}}" onmouseout="{{action(\'showRLEmailStatusTooltipOut\',this)}}" class="mL5 erlStatusInfo hide vaM" icon-name="info-rounded" icon-class="zcicn-info-rounded crmBaseIcon "></crmutil-icon></div> </template></template> </lyte-td> </template></template> </template><template case="false"> <lyte-td class="tableData crm-base-font-size" data-zcqa="status_{{mail.subject}}"> <template is="if" value="{{expHandlers(mail.status[0].type,\'==\',\'received\')}}"><template case="true"> <lyte-text lt-prop-value="{{getI18n(\'Received\')}}"></lyte-text> </template><template case="false"><template is="if" value="{{expHandlers(mail.status[0].type,\'==\',\'delivered\')}}"><template case="true"> <lyte-text lt-prop-value="{{getI18n(\'Delivered\')}}"></lyte-text> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(mail.status[0].type,\'==\',\'scheduled\'),\'||\',expHandlers(mail.status[0].type,\'==\',\'zscheduled\'))}}"><template case="true"> <lyte-text lt-prop-value="{{getI18n(\'Scheduled\')}}"></lyte-text> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(mail.status[0].type,\'==\',\'failed\'),\'||\',expHandlers(mail.status[0].type,\'==\',\'zfailed\'))}}"><template case="true"> <lyte-text lt-prop-value="{{getI18n(\'Failed\')}}"></lyte-text> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(mail.status[0].type,\'==\',\'retrying\'),\'||\',expHandlers(mail.status[0].type,\'==\',\'zpending\'))}}"><template case="true"> <lyte-text lt-prop-value="{{getI18n(\'Retrying\')}}"></lyte-text> </template><template case="false"><template is="if" value="{{expHandlers(mail.status[0].type,\'==\',\'opened\')}}"><template case="true"> <lyte-text lt-prop-value="{{getI18n(\'crm.emailstats.opens\')}}"></lyte-text> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(mail.status.length,\'>\',1),\'&amp;&amp;\',expHandlers(mail.status[1].type,\'==\',\'clicked\'))}}"><template case="true"> <lyte-text lt-prop-value="{{getI18n(\'crm.emailstats.clicks\')}}"></lyte-text> </template><template case="false"><template is="if" value="{{expHandlers(mail.status[0].type,\'==\',\'bounced\')}}"><template case="true"> <lyte-text lt-prop-value="{{getI18n(\'crm.emailstats.bounces\')}}"></lyte-text> </template><template case="false"><template is="if" value="{{expHandlers(mail.status[0].type,\'==\',\'sent\')}}"><template case="true"> <lyte-text lt-prop-value="{{getI18n(\'Sent\')}}"></lyte-text> </template><template case="false"> <lyte-text lt-prop-value="{{getI18n(mail.status[0].type)}}"></lyte-text> </template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template> </lyte-td> </template></template></template></template> </template></template></template></template> </lyte-tr> <template is="if" value="{{showRelMails(mail)}}"><template case="true"> <lyte-tr id="test_{{mail.message_id}}" style="display: none;"> <lyte-td> <div class="ernThreadVSection"> <div id="RelMails_{{mail.message_id}}" style="display:none;"> <template is="if" value="{{expHandlers(mail.relatedMailList,\'!=\',undefined)}}"><template case="true"> <table lt-prop-yield="true" style="width: 95%;" class="thread"> <tbody> <tr is="for" lyte-for="true" items="{{mail.relatedMailList}}" item="relMail" index="ind" depth="2"></tr> </tbody> </table> </template></template> </div> </div> </lyte-td> </lyte-tr> {{checkBrowser(mail.message_id)}} </template></template> </template> </lyte-tbody> </lyte-table-structure> </template> </lyte-table> <template is="if" value="{{expHandlers(expHandlers(toIndex,\'>=\',10),\'||\',isCanvasView)}}"><template case="true"><template is="if" value="{{or(expHandlers(noOfMails,\'!=\',0),expHandlers(startIndex,\'>\',1))}}"><template case="true"> <div class="listNav cBafter rLEmailFooter"> <div id="previousPageToken" style="display:none;">{{previousPageToken}}</div> <div id="currentPageToken" style="display:none;">{{currentPageToken}}</div> <div id="nextPageToken" style="display:none;">{{nextPageToken}}</div> <div id="navigationIndex" style="display:none;">{{fromIndex}}</div> <div id="navigationEntityId" style="display:none;">{{moduleEntityId}}</div> <div id="navigationModule" style="display:none;">{{encodeJS(module)}}</div> <div id="navigationFullname" style="display:none;">{{encodeJS(fullname)}}</div> <div id="navigationEmailid" style="display:none;">{{encodeJS(emailId)}}</div> <div id="navigationRefreshKey" style="display:none;">false</div> <lyte-table lt-prop-yield="true" class="fR mailNavRL mB3 mT3 noBorderTable" id="mailNav"> <lyte-table-structure> <lyte-tbody> <lyte-tr> <lyte-td class="eRL_pageChaArrowRTL alignRight pR10 pL0 mailNavarrowZoom"> <template is="if" value="{{expHandlers(startIndex,\'==\',1)}}"><template case="true"> <span class="previous_disabled vaM dIB"></span> </template><template case="false"> <span class="link" onclick="{{action(\'showMailsList\',\'\',fromIndex,\'previous\')}}"><span class="previous vaM dIB cP" data-zcqa="previousMail"></span></span> </template></template> </lyte-td> <lyte-td class="aligncenter crm-small-font-size pR0 pL0 flexAlignCenter justifyFlexCenter mT2"> <span class="crm-base-font-size">{{startIndex}}<span class="dim mR8 mL8">&nbsp;{{getI18n(\'crm.label.lowercase.to\')}}&nbsp;</span>{{toIndex}}</span> </lyte-td> <lyte-td class="pR0 pL10 mailNavarrowZoom"> <template is="if" value="{{expHandlers(expHandlers(10,\'>\',noofMails),\'||\',disableNext)}}"><template case="true"> <span class=" disabled"></span><span class="next_disabled vaM dIB"></span> </template><template case="false"> <span class="link" onclick="{{action(\'showMailsList\',\'\',fromIndex,\'nextPage\')}}"><span class="next vaM dIB" data-zcqa="nextMail"></span></span> </template></template> </lyte-td> </lyte-tr></lyte-tbody></lyte-table-structure></lyte-table></div></template><template case="false"> <lyte-td id="emptytd">&nbsp;</lyte-td> </template></template>      </template></template> </template></template></template><template case="false"> <div class="noresultstyle">{{getI18n(\'crm.new.label.no.records\')}}</div> </template></template> </div> </div> <span class="hide" id="email_attachments"></span> <input type="hidden" id="mail_type" value="{{mailType}}"> </div> <lyte-hovercard lt-prop-close-on-escape="false" id="erlStatusHoverCard" lt-prop-keep-alive="true" lt-prop-origin-elem=".erlStatus" on-hovercard-hide="{{method(\'statusHoverCardHide\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content> {{unescape(hovercardContent)}} </lyte-hovercard-content> </template> </lyte-hovercard> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"attr",position:[5]},{type:"attr",position:[7,1,1,1,7]},{type:"if",position:[7,1,1,1,7],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"registerYield",position:[7,1,1,3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]},{type:"text",position:[3,1,1]},{type:"text",position:[3,3,1,1]},{type:"text",position:[3,3,3]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[7,1,1,3]},{type:"attr",position:[7,1,1,5]},{type:"if",position:[7,1,1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1,1]},{type:"if",position:[1,1,1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1,0,1]},{type:"if",position:[1,0,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]},{type:"text",position:[3,1,0]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0,1,1]},{type:"if",position:[0,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[0,1]},{type:"attr",position:[0,3]},{type:"if",position:[0,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[0,5]},{type:"if",position:[0,5],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[0,7]},{type:"if",position:[0,7],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[0,9]},{type:"if",position:[0,9],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[0,11]},{type:"if",position:[0,11],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[0,13]},{type:"if",position:[0,13],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[0,15]},{type:"attr",position:[0,15,0]},{type:"componentDynamic",position:[0,15,0]},{type:"componentDynamic",position:[0,15]},{type:"attr",position:[0,17]},{type:"if",position:[0,17],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[0,19]},{type:"if",position:[0,19],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[0,21]},{type:"if",position:[0,21],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[0]}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"attr",position:[1,3,1]},{type:"attr",position:[1,3,1,1,1]},{type:"if",position:[1,3,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"componentDynamic",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"componentDynamic",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"componentDynamic",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"componentDynamic",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"componentDynamic",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3,1,3]},{type:"attr",position:[1,3,1,3,1]},{type:"attr",position:[1,3,1,3,1,1]},{type:"if",position:[1,3,1,3,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,2]},{type:"if",position:[1,2],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"componentDynamic",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]}},default:{}},{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"componentDynamic",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]}},default:{}},{type:"attr",position:[2]},{type:"if",position:[2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,4]},{type:"if",position:[1,4],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"componentDynamic",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3,1,3,3]},{type:"attr",position:[1,3,1,3,3,1]},{type:"if",position:[1,3,1,3,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3,1,3,3,3]},{type:"componentDynamic",position:[1,3,1,3,3,3]},{type:"attr",position:[1,3,3]},{type:"if",position:[1,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]}]}},default:{}},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,0]},{type:"componentDynamic",position:[1,1,0]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,7]},{type:"if",position:[1,7],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,9]},{type:"if",position:[1,9],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]}]},false:{dynamicNodes:[]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,11]},{type:"if",position:[1,11],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,13]},{type:"if",position:[1,13],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,15]},{type:"if",position:[1,15],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,17,0]},{type:"componentDynamic",position:[1,17,0]},{type:"componentDynamic",position:[1,17]},{type:"attr",position:[1,19]},{type:"if",position:[1,19],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,3,1,1]},{type:"componentDynamic",position:[1,1,3,1,1]},{type:"attr",position:[1,1,3,3]},{type:"if",position:[1,1,3,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]},{type:"text",position:[1,1,0]}]}},default:{}},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,1,2]},{type:"componentDynamic",position:[1,1,2]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]},false:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1,1]},{type:"attr",position:[1,1,1,1,1]},{type:"if",position:[1,1,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"text",position:[1,1,1,1,0]},{type:"text",position:[1,1,1,3]},{type:"text",position:[1,3,0]}],actualTemplate:'<template is="for" items="{{mail.relatedMailList}}" item="relMail" index="ind" depth="2"><table><tbody> <tr id="{{relMail.message_id}}"> <td class="pL80 w65_per"> <a class="link" data-isunread="{{relMail.read}}" href="javascript:;" purpose="{{relMail.viewmail}}" onclick="{{action(\'viewEntEmail\',relMail.message_id,\'GMail\',getI18n(\'crm.button.close\'),relMail.sentOrReceived,relMail.zfsDown,undefined,relMail.read,encodeJS(relMail.mailOwnerId),this,relMail.moduleEntityId,relMail.id,mail.thread_id)}}"> <em>{{relMail.from}}</em> - {{relMail.subject}} </a> </td> <td width="35%">{{relMail.date}}</td> </tr> </tbody></table></template>',tagName:"TBODY"}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]},{type:"text",position:[3]}]}},default:{}}]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"text",position:[1,3,0]},{type:"text",position:[1,5,0]},{type:"text",position:[1,7,0]},{type:"text",position:[1,9,0]},{type:"text",position:[1,11,0]},{type:"text",position:[1,13,0]},{type:"text",position:[1,15,0]},{type:"attr",position:[1,19,1,1,1,1,1]},{type:"if",position:[1,19,1,1,1,1,1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,19,1,1,1,1]},{type:"text",position:[1,19,1,1,1,3,1,0]},{type:"text",position:[1,19,1,1,1,3,1,2,1]},{type:"text",position:[1,19,1,1,1,3,1,3]},{type:"componentDynamic",position:[1,19,1,1,1,3]},{type:"attr",position:[1,19,1,1,1,5,1]},{type:"if",position:[1,19,1,1,1,5,1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,19,1,1,1,5]},{type:"componentDynamic",position:[1,19,1,1,1]},{type:"componentDynamic",position:[1,19,1,1]},{type:"componentDynamic",position:[1,19,1]},{type:"componentDynamic",position:[1,19]}]},false:{dynamicNodes:[{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[7,5]},{type:"attr",position:[9]},{type:"registerYield",position:[9,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[9]}],_observedAttributes:["entityId","fromIndex","fullname","imagePath","isAllowedZGID","isDealsMail","isadminprofileuser","mailRange","mailType","mailsList","module","noofMails","partnerName","sentimentEnabled","startIndex","supportMailId","toIndex","emails","erlCheckboxChecked","columnWidths","hovercardContent","hovercardOrigin","isAccessibilityConfigSupported","toggleTableHead"],data:function(){return{entityId:Lyte.attr("string",{default:""}),fromIndex:Lyte.attr("number",{default:0}),fullname:Lyte.attr("string",{default:""}),imagePath:Lyte.attr("string",{default:""}),isAllowedZGID:Lyte.attr("boolean",{default:!1}),isDealsMail:Lyte.attr("boolean",{default:!1}),isadminprofileuser:Lyte.attr("boolean",{default:!1}),mailRange:Lyte.attr("object",{default:{}}),mailType:Lyte.attr("string",{default:""}),mailsList:Lyte.attr("array",{default:[]}),module:Lyte.attr("string",{default:""}),noofMails:Lyte.attr("number",{default:0}),partnerName:Lyte.attr("string",{default:""}),sentimentEnabled:Lyte.attr("boolean",{default:!1}),startIndex:Lyte.attr("number",{default:0}),supportMailId:Lyte.attr("string",{default:""}),toIndex:Lyte.attr("number",{default:0}),emails:Lyte.attr("object"),erlCheckboxChecked:Lyte.attr("boolean",{default:!1}),columnWidths:Lyte.attr("object",{default:{}}),hovercardContent:Lyte.attr("string",{default:"dummy value"}),hovercardOrigin:Lyte.attr("string",{default:"dummy value"}),isAccessibilityConfigSupported:Lyte.attr("boolean",{default:Crm.userDetails.isAccessibilityConfigSupported&&!featuresAvailable.NEXTGENUI_ENABLED}),toggleTableHead:Lyte.attr("boolean",{default:!0})}},init:function(){var e=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("threadsummaryandtranslation")],ResourceConstants.CRM);Lyte.injectResources(e,void 0,void 0),this.columnsUpdated=!1,this.listenerId=!1},didConnect:function(){this.listenerId=Lyte.addEventListener("beforeRouteTransition",this.updateColumnWidth.bind(this)),window.addEventListener("beforeunload",this.updateColumnWidth.bind(this))},updateColumnWidth:function(){this.columnsUpdated&&(store.update("email_column_widths"),this.columnsUpdated=!1)},didDestroy:function(){Lyte.removeEventListener(this.listenerId)},actions:{viewEntEmail:function(e,t,a,i,s,l,o,n,p,m,r,c){this.viewEntEmail(e,t,a,i,s,l,o,n,p,m,r,void 0,void 0,void 0,c)},showAttachments:function(e,t,a,i,s){event.stopImmediatePropagation(),commonUtils.showHideLoadingDiv(!0);let l=Lyte.registeredMixins["crm-emailconversation-view-mixin"].getModuleInfo(void 0,s),o=l[1],n=l[0],p={user_id:a},m=$L(e).closest(".rLEmailSub"),r=$L(e).offset().top;m.addClass("rLAttachment"),i&&(p.thread_id=i),t&&(p.message_id=t);let c=i||t;store.findRecord("emails_rl_attachments",c,p,!0,!0,{meta:{entityId:o,module:n}}).then((a=>{if(void 0===a.attachmentData)return _cruxUtils.showCustomMessage({params:{ltPropType:"info",ltPropMessage:"no attachments found",ltPropDuration:"3000",ltPropShow:!0}}),void commonUtils.showHideLoadingDiv(!1);let s=$L("#"+t).hasClass("crm-font-bold");!i&&s&&a.attachmentData.forEach((e=>{e.read=!1})),$L(".popoverActive").removeClass("popoverActive"),e.classList.add("popoverActive");let l="300px",p=renderingUtils.windowHeight-r<=400?"top":"bottom";"top"===p&&(l=r-100+"px"),$L(e).closest(".topband_dv_row").addClass("etViewThreadHighight"),m.removeClass("rLAttachment");let c={attachments:Array.from(a.attachmentData),moduleInfo:{moduleName:n,moduleId:o},placement:p,showPopover:!0,maxHeight:l},d=$L("crm-email-attachments");0!==d.length&&d[0].remove(),Lyte.Component.render("crm-email-attachments",c,"#email_attachments"),commonUtils.showHideLoadingDiv(!1)}),(e=>{m.removeClass("rLAttachment"),_cruxUtils.showCustomMessage({params:{ltPropType:"error",ltPropMessage:JSON.parse(e.responseText).message,ltPropDuration:"3000",ltPropShow:!0}}),commonUtils.showHideLoadingDiv(!1)}))},getRelatedMails:function(e,t,a,i,s,l,o){let n=$L(s);getRelatedMails(e,t,a,i,n.closest("lyte-td.rLEmailSub")[0],l,o)},potentialPopUp:function(e,t){this.potentialPopUp(e,t)},changeDeal:function(e){EntityEmail.listViewChangeDeal(e)},showDealPopup:function(e,t,a){event&&(event.cancelBubble=!0,event.stopPropagation&&event.stopPropagation()),EntityEmail.showDealPopup(e,t,a)},showMailsList:function(e,t,a){showMailsListViaAPI(e,t,a)},showRLEmailStatusTooltip:function(e,t,a,i,s,l,o,n,p){$L(e).addClass("erlHoverCardShow"),crmEmailTrackingStatus.showRLEmailStatusTooltip(e,t,a,i,s,l,o,n,p)},viewSummary:function(e,t,a,i,s,l,o,n,p,m,r,c,d,u,y){Crm.userDetails.isEmailsAIClickableSupport?Crm.client_tracking("Email summary on demand click"):c?Crm.client_tracking("Email thread summary - clicked "):Crm.client_tracking("Email summary - clicked "),m=Lyte.Router.getRouteInstance().parent.getDynamicParam();var f="#module",g=detailView&&detailView.changedBCJson&&detailView.changedBCJson.BCViewObject&&detailView.changedBCJson.BCViewObject[3]&&detailView.changedBCJson.BCViewObject[3].defaultvalue?detailView.changedBCJson.BCViewObject[3].defaultvalue:store.peekRecord(moduleRecordMapping[$L(f).val()].id,m).Email,v={msgid:e,mailType:t,closeStr:a,sentOrReceived:i,zfsDown:s,ismailkanbanview:l,markAsRead:o,mailOwnerId:n,curEl:p,contactId:m,id:r,thread_id:c,subject:d,type:y,mailid:g};if(Lyte.Component.render("crm-email-summary-view",{summary_resp:void 0,viewMailData:v,isThreadMail:!0},"body"),c&&"IMAP"!==t&&"GMail"!==t){var h={module:D=$L(f).val(),id:m,msgid:e,thread_id:c},x=store.peekRecord("email_summary",c);if(x)x.thread_summary?setTimeout((()=>{$L("crm-email-summary-view")[0].component.setData({summary_resp:x.thread_summary,viewMailData:v,isThreadMail:!0})}),900):x&&!x.thread_summary?($L("crm-email-summary-view")[0].component.$node.remove(),_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.summary.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.translation.limitedcount.error"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}})):($L("crm-email-summary-view")[0].component.$node.remove(),_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.summary.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.summary.desc"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}}));else{var _=$L("crm-email-summary-view")[0];store.findAll("email_summary",{thread_id:c,userid:n},void 0,void 0,h).then((function(e){$L("crm-email-summary-view")[0].component;e&&e.thread_summary?_.component.setData({summary_resp:e.thread_summary,viewMailData:v,isThreadMail:!0}):e&&!e.thread_summary?(_.component.$node.remove(),_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.summary.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.translation.limitedcount.error"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}})):(_.component.$node.remove(),_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.summary.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.summary.desc"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}}))}),(function(){$L("crm-email-summary-view")[0].component.$node.remove(),_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.summary.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.summary.desc"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}})}))}}else{var b=store.peekRecord("email_summary",e);if(b)setTimeout((()=>{$L("crm-email-summary-view")[0].component.setData({attachments:[],summary_resp:b.thread_summary,viewMailData:b.viewMailData,attachments:b.viewMailData.attachments,attachLen:b.viewMailData.attachments?b.viewMailData.attachments.length:0,isThreadMail:!1})}),801);else{Crm.client_tracking("Email summary - clicked");var D=$L(f).val(),q=(r=$L("#id").val(),null),L={},I=$L("#selectMails"),H=$L("#isFromNewAPI"),w=$L("#contactSelDropdownInAcc");if("Deals"===(D=void 0===moduleApiMapping[D]?opener.window.moduleApiMapping[D]:moduleApiMapping[D])&&(D="Potentials"),"Accounts"===D&&0!=w.length){var C=w.attr("lt-prop-selected");"ACCOUNTS_ALL"!=C&&"ALL"!=C&&(D="Contacts",r=C)}var M=document.querySelector("crm-emails-related-list").component,T=store.peekRecord("emails_rl_user",e);if(T){var N=T.data;M.actions.populateSummaryDet(p,N,N),M.actions.populateMailDataInSpan(N)}else{if(I.length>0){var S=void 0===I[0].value?I[0].getAttribute("lt-prop-selected"):I[0].value;if(H.length>0&&(S=I[0].getAttribute("lt-prop-selected")),"IMAP_ALL"===S||"ALL_MAIL_VIEW"===S||"POP_ALL"===S||"ALL"===S)q=n,"CRMMASSMAIL"===$L("#"+e).attr("purpose")&&(t="ALLUSERSMAILS");else q=S.substring(0,S.indexOf("_"))}""!==q&&null!==q&&(L.user_id=q),L.message_id=e;var k={};store.findAll("emails_rl_user",L,!1,!1,{module:D,entityId:m,action:"getEmailDetails"}).then((function(a){(k=a.email_related_list[0]).sentOrReceived=i,k.mailType=t,k.mailStatus=k.status,q&&(q=Crm.userDetails.USER_ID),k.user_id=q,k.mailOwnerId=n,k.message_id=e,L={};var s=[],l={};l.email_body=k.content,s[0]=l,L.emails=s,v.attachments=k.attachments,store.findAll("dummy",void 0,!1,!1,{url:"/crm/zia/text/api/v2/emailsummary/extract.do",method:"POST",payLoad:JSON.stringify(L)}).then((function(t){var a=t.dummy;if(a&&a.status&&"success"===a.status&&a.statusCode&&200===a.statusCode){var i=a.summaries[0];if(i&&i.status&&"success"===i.status&&i.statusCode&&200===i.statusCode){i.response.overall_summary=i.response.summary,store.pushPayload("email_summary",{id:e,thread_summary:i.response,viewMailData:v});var s=$L("crm-email-summary-view")[0];if(s){var l=s.component;l&&l.setData({summary_resp:i.response,viewMailData:v,attachLen:v.attachments?v.attachments.length:0,isThreadMail:!1})}}else i&&i.statusCode&&204===i.statusCode&&($L("crm-email-summary-view")[0].component.$node.remove(),_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.summary.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.translation.limitedcount.error"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}}))}else{$L("crm-email-summary-view")[0].component.$node.remove(),a&&a.summaries&&a.summaries[0]&&400===a.summaries[0].statusCode&&"LANGUAGE_NOT_SUPPORTED"===a.summaries[0].code?_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.translation.unsupported.lan"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.translation.unsupported.error"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}}):_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.summary.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.translation.limitedcount.error"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}})}}),(function(){$L("crm-email-summary-view")[0].component.$node.remove(),_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.summary.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.summary.desc"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}})}))}),(function(){$L("crm-email-summary-view")[0].component.$node.remove(),_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.email.summary.error"),ltPropType:"error",ltPropSecondaryMessage:I18n.getMsg("crm.email.summary.desc"),ltPropButtons:[{type:"accept",appearance:"default",text:I18n.getMsg("crm.button.ok.got.it"),cxPropZcqa:"button_1"}]}})}))}}}},storeMailAndSummmaryDet:function(e,t,a){t.from=e.from&&null!==e.from&&null!==e.from.user_name?e.from.user_name+"<"+e.from.email+">":e.from.email,t.subject=e.subject,t.msgid=a,t.sentOrReceived=e.sentOrReceived;for(var i=e.to,s=i.length,l="",o=0;o<s;o++)l+=i[o].email,o!==s-1&&(l+=",");if(e.cc){for(var n=e.cc,p=n.length,m="",r=0;r<p;r++)m+=n[r].email,r!==p-1&&(m+=",");t.cc=m}if(e.bcc){for(var c=e.bcc,d=c.length,u="",y=0;y<d;y++)u+=c[y].email,y!==d-1&&(u+=",");t.bcc=u}var f=new CrmDate(e.sent_time);t.sentDateTime=f.getDateInUserPattern()+" "+f.getTimeInUserPattern(),t.content=e.content,t.user_id=e.user_id,t.mailOwnerId=e.mailOwnerId,t.mailType=e.mailType,t.to=l,void 0!==e.linked_deal&&(t.linked_deal=e.linked_deal),t.attachments=e.attachments,t.editable=e.editable,t.mailStatus=e.mailStatus,t.message_id=e.message_id,t.reply_to=e.reply_to&&null!==e.reply_to.user_name?e.reply_to.user_name+"<"+e.reply_to.email+">":e.reply_to.email,store.pushPayload("emails_rl_user",{content:a,data:t}),document.querySelector("crm-emails-related-list").component.actions.populateMailDataInSpan(t)},populateMailDataInSpan:function(e){$L("#summaryMailDet").data({from:e.from,to:e.to,cc:e.cc,bcc:e.bcc,reply_to:e.reply_to,subject:e.subject,msgid:e.msgid,sentOrReceived:e.sentOrReceived,sentDateTime:e.sentDateTime,mailContent:e.content,user_id:e.user_id})},populateSummaryDet:function(e,t,a){$L("#dvinner,#detailcanvascontainer").on("scroll",(function(){hideEmailSummaryDiv()}));var i=$L(e).offsetParent().parent().children(),s=i.eq(i.length-1).text(),l=$L("#module"),o={},n=document.querySelector("email-summary");if(void 0!==t&&"success"===t.status){o.hasSummary=!0,o.isLoading=!1,o.mail={},o.mail.subject=unescape(a.subject),o.mail.message_id=a.message_id,o.mailOwnerId=a.mailOwnerId;var p=t.summaries;if(""===p[0].response.summary)return o.hasSummary=!1,n.component.setData(o),void document.querySelector("crm-emails-related-list").component.actions.storeMailAndSummmaryDet(a,t,a.msgid);o.mail.summary=p[0].response.summary;var m=a.attachments;if(m&&m.length>0){var r=m.length;o.mail.attachLen=r,o.mail.attach=m}if(o.mail.isEditable=a.editable,a.mailStatus&&a.mailStatus.length>0&&"scheduled"===a.mailStatus[0].type?o.mail.isScheduled=!0:s&&(s.includes("Failed")?o.mail.isFailed=!0:(o.emailConfigured=Crm.userDetails.mailConfigured,o.mailType=a.mailType,o.module=l.val(),o.entityId=$L("#id").val())),void 0!==a.linked_deal)o.mail.linked_deal=a.linked_deal;else if(Crm.userDetails.IMAP_STATUS&&("Contacts"===l.val()||"Potentials"===l.val())){var c=$L("#selectMails");if(c.length>0){var d=void 0===c[0].value?c[0].getAttribute("lt-prop-selected"):c[0].value,u=$L("crm-emails-related-list"),y="true"===$L("#isMailAppsFlow").val();("IMAP_ALL"===d||"ALL"===d||(y||!y&&"ZMAIL"!==u.attr("mail-type"))&&"GMail"!==u.attr("mail-type"))&&(o.mail.showLinkDeal=!0)}}}else o.hasSummary=!1,Crm.client_tracking("Email summary - summary not available");n.component.setData(o)},toolTipShow:function(e,t){crmui.toolTip_show(e,"left",t,!0)},showRLEmailStatusTooltipOver:function(e,t,a,i,s){$L(e).addClass("erlHoverCardShow"),crmEmailTrackingStatus.showRLEmailStatusTooltip(e,1,t,a,null,null,null,null,null,i,s)},showRLEmailStatusTooltipOut:function(e){$L(e).addClass("erlHoverCardShow"),crmEmailTrackingStatus.showRLEmailStatusTooltip(e,0)},hideTooltip:function(){crmui.hideTooltip()},EmailCompose:function(e){"close"===e?EmailCompose.closeDraftDisclaimer():EmailCompose.openDraftFromOldCompose()},showLookUp:function(e){var t=this.getData("moduleEntityId");if(this.fldIdVal="assoPotential_"+e,Crm.userDetails.isLookupAdvancedSearchEnabled){var a={};a.labelName=this.fldIdVal,a.source="rLEmail",a.lookupModule="Potentials",a.searchModule="Potentials",a.parentModule=this.getData("module"),a.contactId=t,this.openNewLookup(a)}else Crm.showLookUp(this.getData("module"),"assoPotential_"+e,"assoPotential_"+e,"Potentials","Potentials","rLEmail")},ernShowOptions:function(e){ernShowOptions(e)},showTooltip:function(e){crmui.showTooltip(e)},showHideDealToolTip:function(e,t){"show"===t?EntityEmail.showHideDealToolTip("show",e):EntityEmail.showHideDealToolTip("hide")},mailToolTipHvr:function(e,t){this.mailToolTipHvr(e,t)}},methods:{resizeEnd:function(e){if(e.dataset&&e.dataset.colName){let a=e.dataset.colName,i=e.offsetWidth;var t=store.peekRecord("email_column_widths",Lyte.registeredMixins["crm-emailconversation-view-mixin"].getSelectedTab());t&&(this.columnsUpdated=!0,t.$.set(a,i),t.$.set("default_configuration",!1))}},eRLCheckboxActionAll:function(e,t){var a=$L("#ernTable").find("lyte-tbody lyte-checkbox"),i=$L(e).closest(".eRListPartialSelect");t.data.ltPropChecked||i.length>0?(i.hasClass("eRListPartialSelect")||$L(".ernLyteBody lyte-tr").addClass("ernSelectedRow"),i.removeClass("eRListPartialSelect")):(a.find("input").prop("checked",!1),$L(".ernLyteBody lyte-tr").removeClass("ernSelectedRow")),selectAllMails(e)},eRLCheckboxAction:function(e){var t=$L(e),a=$L("#ernTable");t.get(0).checked?t.closest("lyte-tr").addClass("ernSelectedRow"):t.closest("lyte-tr").removeClass("ernSelectedRow");var i=a.find("lyte-tbody .ecnChkBoxtd input:checked"),s=a.find("lyte-thead lyte-checkbox");i.length>0?s.addClass("lyteCheckboxPartial"):s.removeClass("lyteCheckboxPartial"),checkBoxClick(e)},statusHoverCardHide:function(){$L(".erlHoverCardShow").removeClass("erlHoverCardShow")},mailsRendered:function(){Crm.userDetails.EMAIL_THREAD_VIEW&&Lyte.registeredMixins["crm-emailconversation-view-mixin"]&&Lyte.registeredMixins["crm-emailconversation-view-mixin"].calculateTotalWidth()}},openNewLookup:function(e){var t,a=document.getElementById("lookupListPopup");if(!a){var i=document.getElementById("lookupModalDiv");if(null===i){var s=document.createElement("div");s.id="lookupModalDiv",document.body.appendChild(s),i=document.getElementById("lookupModalDiv")}}var l=[],o=networkUtils.returnDependencyFiles(["crm-entity-lookup.js","crux-lookupfilter-component.js","crux-column-list.js"],ResourceConstants.CRMClient);o=o.concat(networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("Lookup")],ResourceConstants.CRM)),Crm.userDetails.RTL_ENABLED&&(l=networkUtils.returnDependencyFiles(["crm-entity-lookup-rtl.css"],ResourceConstants.CRMClient));var n=o.concat(l);Lyte.injectResources(n,void 0,(function(){if(Crm.moduleName=e.searchModule,!a&&i){var s=document.createElement("crm-entity-lookup");s.component.setData("reqData",{}),i.append(s),t=s.component}else t=$L("crm-entity-lookup")[0].component;t.layersAnalystAgent(t,void 0,e,void 0,!0)}))},updateDetailviewRLCount:function(){Crm.userDetails.isRelatedListLyteEnabled&&Lyte.triggerEvent("relatedListCountDetail",{id:this.getData("listRelationId"),count:this.getData("toIndex"),old_flow:!0,more_records:void 0!==this.getData("disableNext")&&!this.getData("disableNext")})}.observes("mailsList.[]").on("init")},{mixins:["crm-email-emotions-mixin","crm-related-list-utils","crm-emails-related-mixin"]}),Lyte.Component.registerHelper("getreadUnreadClass",(function(e){return e?"":"ernUnread"})),Lyte.Component.registerHelper("isCheckboxNeeded",(function(e){return Crm.userDetails.USER_ID==e})),Lyte.Component.registerHelper("getModule",(function(e,t){return-1!==e.indexOf("search")||"crm.label.no.open.activities"===e?I18n.getMsg(e,Crm.moduleInfo[t].translatedPluralLabel):I18n.getMsg(e,Crm.moduleInfo[t].translatedSingularLabel)})),Lyte.Component.registerHelper("checkBrowser",(function(e){var t=window.navigator.appName,a=$L("#test_"+e);"Microsoft Internet Explorer"==t&&(a.length>0?a[0].style.display="none":getOpenerObj("test_"+e)&&(getOpenerObj("test_"+e).style.display="none"))})),Lyte.Component.registerHelper("checkIfDealsPresent",(function(e,t){return null!=e&&null!=t?"hasDeal":""})),Lyte.Component.registerHelper("getLength",(function(e){return e.length})),Lyte.Component.registerHelper("getRead",(function(e){return null!=e?1==e?"false":!1===e?"true":"false":"false"})),Lyte.Component.registerHelper("removeQoutes",(function(e){return e.replaceAll(/\\"/g,"")})),Lyte.Component.registerHelper("isStringType",(function(e){return"string"==typeof e})),Lyte.Component.registerHelper("toMailsList",(function(e){var t=e.to,a=e.cc,i=e.bcc,s=0,l=0,o=0;null!=t&&null!=t&&(s=t.length),null!=a&&null!=a&&(l=a.length),null!=i&&null!=i&&(o=i.length);for(var n="",p=0;p<s;p++){n+=t[p].email+", "}for(var m=0;m<l;m++){n+=a[m].email+", "}for(var r=0;r<o;r++){n+=i[r].email+", "}return""==n?I18n.getMsg("crm.email.draft.error.receipient.notfound"):n.substring(0,n.length-2)})),Lyte.Component.registerHelper("toMailsListText",(function(e){var t=Lyte.Component.registeredHelpers.toMailsList(e),a=t.split(", "),i=a.length;return i>1?a[0]+" "+I18n.getMsg("and")+" "+(i-1)+" "+I18n.getMsg("crm.login.more"):t})),Lyte.Component.registerHelper("getDateNTime",(function(e){var t=new CrmDate(e),a=Crm.userDetails.TIME_FORMAT,i="",s=t.userHourIn24hrFmt,l=t.userDisplayMinute<10?"0"+t.userDisplayMinute:t.userDisplayMinute,o="",n=new CrmDate;return i="HH:mm"==a?s+":"+l:(0==s?12:s>12?s-12:s)+":"+l+(s>=12?" "+I18n.getMsg("PM"):" "+I18n.getMsg("AM")),t.userDisplayYear!=n.userDisplayYear&&(o=" "+t.userDisplayYear),t.userDisplayMonthName+" "+t.userDisplayDate+o+" "+i})),Lyte.Component.registerHelper("getSentDate",(function(e){var t=new CrmDate(e),a=new CrmDate,i="";e="";if(t.userDisplayDate===a.userDisplayDate&&t.userDisplayMonth===a.userDisplayMonth&&t.userDisplayYear===a.userDisplayYear){var s=Crm.userDetails.TIME_FORMAT,l=t.userHourIn24hrFmt,o=t.userDisplayMinute<10?"0"+t.userDisplayMinute:t.userDisplayMinute;i="HH:mm"==s?l+":"+o:(0==l?12:l>12?l-12:l)+":"+o+(l>=12?" "+I18n.getMsg("PM"):" "+I18n.getMsg("AM"))}else i=t.userDisplayYear==a.userDisplayYear?t.userDisplayMonthName+" "+t.userDisplayDate:t.userDisplayMonthName+" "+t.userDisplayDate+" "+t.userDisplayYear;return i})),Lyte.Component.registerHelper("checkIfMailFailedOrScheduled",(function(e,t){if(e=null!=e&&null!=e?e.toLowerCase():"","failed"==t){if("failed"==e||"zfailed"==e||"retrying"==e||"zpending"==e)return!0}else if("zscheduled"==e||"scheduled"==e)return!0;return!1})),Lyte.Component.registerHelper("capitalizeStatus",(function(e,t){var a="";return null!=e?"delivered"!=(a=e[0].type)&&"Delivered"!=a||(a="sent"):a=1==t?"sent":"received",a[0].toUpperCase()+a.slice(1)})),Lyte.Component.registerHelper("getSentimentHoverValue",(function(e){return"Positive"==e?I18n.getMsg("crm.sentiment.Positive"):"CNS"===e?I18n.getMsg("crm.label.zia.email.cns.hovervalue"):I18n.getMsg("crm.sentiment.Negative")})),Lyte.Component.registerHelper("getClickVal",(function(e,t){if(e.length>1)return 1==t?e[1].first_click:2==t?e[1].count:e[1].last_click})),Lyte.Component.registerHelper("isAdminProfileUser",(function(){return"Administrator"==Crm.userDetails.PROFILE_NAME})),Lyte.Component.registerHelper("getModuleEntIdSub",(function(e,t){return null!=e?e.id:t})),Lyte.Component.registerHelper("getMailStatusForHover",(function(e){var t="";return e&&(t="received"==e[0].type?I18n.getMsg("Received"):"delivered"==e[0].type?I18n.getMsg("Delivered"):"scheduled"==e[0].type||"zscheduled"==e[0].type?I18n.getMsg("Scheduled"):"failed"==e[0].type||"zfailed"==e[0].type?I18n.getMsg("Failed"):"retrying"==e[0].type||"zpending"==e[0].type?I18n.getMsg("Retrying"):"opened"==e[0].type?I18n.getMsg("crm.emailstats.opens"):e.length>1&&"clicked"==e[1].type?I18n.getMsg("crm.emailstats.clicks"):"bounced"==e[0].type?I18n.getMsg("crm.emailstats.bounces"):"sent"==e[0].type?I18n.getMsg("Sent"):"saved"==e[0].type?I18n.getMsg("crm.event.layout.save.success.msg"):I18n.getMsg(e[0].type)),t})),Lyte.Component.registerHelper("checkUndefinedAndGetDate",(function(e){return null==e?void 0:Lyte.Component.registeredHelpers.getDateNTime(e)})),Lyte.Component.registerHelper("getSentBy",(function(e){return e&&e.user_name&&null!==e.user_name?e.user_name:e?e.email:e})),Lyte.Component.registerHelper("showAttachIcon",(function(e){return Crm.userDetails.EMAIL_THREAD_VIEW&&(!0===e.has_thread_attachment||!0===e.has_attachment||"true"===e.has_attachment)})),Lyte.Component.registerHelper("isThreadViewEnabled",(function(){return!0===Crm.userDetails.EMAIL_THREAD_VIEW})),Lyte.Component.registerHelper("addClassForSubject",(function(){return!0===Crm.userDetails.EMAIL_THREAD_VIEW?"eRLSubjectTextContainer":""})),Lyte.Component.registerHelper("showRelMails",(function(e){return!Crm.userDetails.EMAIL_THREAD_VIEW&&null!==e.thread_id})),Lyte.Component.registerHelper("icon",(function(){return"svgIcons"})),Lyte.Component.registerHelper("setColWidth",(function(e){let t,a=e.dataset.colName,i=$L(e);if(!Lyte.registeredMixins["crm-emailconversation-view-mixin"])return"";Crm.userDetails.EMAIL_THREAD_VIEW&&(t=store.peekRecord("email_column_widths",Lyte.registeredMixins["crm-emailconversation-view-mixin"].getSelectedTab()));let s=Lyte.registeredMixins["crm-emailconversation-view-mixin"].getColumnCount();let l=($L("#ernAllMails").width()-60-370)/s;if(Crm.userDetails.EMAIL_THREAD_VIEW&&t){let s={subject:370},o=t[a]?t[a]:200;if(s[a]&&(o=o<s[a]?s[a]:o),t.default_configuration&&"subject"!==a&&(o=l),o+="px",e.style.width=o,i.attr("resize","enable"),"subject"===a)return i.attr("fixed","enable"),"erlSubjectMinWidth";if("sentiment"===a||"intent"===a||"emotion"===a||"status"===a)return"erlSentimentMinWidth"}else{if("subject"===a&&i.hasClass("ernViewSummaryTH"))return"w300";if("status"===a)return"ernViewSummaryTH"}return""})),Lyte.Component.registerHelper("addTableResizeProp",(function(){Crm.userDetails.EMAIL_THREAD_VIEW&&$L("#ernTable")[0].ltProp("dualResize",!0)})),Lyte.Component.registerHelper("getTranslatedEmotionValue",(function(e){var t="";switch(e){case"Happy":t="crm.label.zia.email.emotion.happy";break;case"Gratitude":t="crm.label.zia.email.emotion.gratitude";break;case"Enthusiasm":t="crm.label.zia.email.emotion.enthusiasm";break;case"Trust":t="crm.label.zia.email.emotion.trust";break;case"Neutral":t="crm.label.zia.email.emotion.neutral";break;case"Discontentment":t="crm.label.zia.email.emotion.discontentment";break;case"Frustration":t="crm.label.zia.email.emotion.frustration";break;case"Confusion":t="crm.label.zia.email.emotion.confusion"}return I18n.getMsg(t)})),Lyte.Component.registerHelper("getEmotionClass",(function(e){let t="";switch(e){case"Happy":case"Enthusiasm":case"Gratitude":case"Trust":t="erlPositive";break;case"Discontentment":case"Frustration":case"Confusion":t="erlNegative";break;case"Neutral":t="erlNeutral"}return t})),Lyte.Component.registerHelper("getSentimentClass",(function(e){let t="";switch(e){case"Positive":t="erlSentimentPositive";break;case"Neutral":t="erlSentimentNeutral";break;case"Sad":t="erlSentimentSad";break;case"Negative":t="erlSentimentNegative"}return t})),Lyte.Component.registerHelper("getTranslatedIntentValue",(function(e,t){var a="";switch(e){case"Request":a="crm.zia.CI.system.request";break;case"Query":a="crm.zia.CI.system.query";break;case"Complaint":a="crm.zia.CI.system.complaint";break;case"Purchase":a="crm.zia.CI.system.purchase";break;case"Others":a="Others";break;default:return t?I18n.getMsg("crm.zia.CI.name"):e}return t?I18n.getMsg("crm.zia.CI.system.name"):I18n.getMsg(a)})),Lyte.Component.registerHelper("canShowEmailDealLinking",(function(e){var t=Lyte.Component.registeredHelpers.getUserStatus("IMAP_STATUS");return!(!Crm.userDetails.mailConfigured||!t)||"ALLUSERSMAILS"===e})),Lyte.Component.registerHelper("hasPermissionToDeleteMail",(function(e){if(Crm.userDetails&&Crm.userDetails.permissions&&Crm.userDetails.permissions["Crm_Implied_Delete_Mail_"+e])return!0})),Lyte.Mixin.register("crm-emails-related-mixin",{viewEntEmail:function(e,t,a,i,s,l,o,n,p,m,r,c,d,u,y){"drafts"===t?EmailLaunchUtil.fetchDraftDetails(e):"all_contacts_draft_crm_emails"===t?EmailLaunchUtil.fetchDraftDetails(e,"Contacts",p.dataset.contactid):viewMail(e,t,a,i,s,l,o,n,p,m,r,c,d,u,y)}}),store.registerModel("emails_rl_user",{users:Lyte.attr("object"),emails:Lyte.attr("object"),content:Lyte.attr("string",{primaryKey:!0})}),store.registerAdapter("emails_rl_user",{namespace:"crm",buildURL:function(e,t,a,i,s,l,o){switch(o.action){case"getUsers":s=s.replace("emails_rl_user","v2/"+o.module+"/"+o.entityId+"/Emails/shared_details");break;case"getEmails":s=s.replace("emails_rl_user","v6/"+o.module+"/"+o.entityId+"/Emails");break;case"getEmailDetails":s=s.replace("emails_rl_user","v2/"+o.module+"/"+o.entityId+"/Emails");break;case"getContactRoles":s=s.replace("emails_rl_user","v2/"+o.module+"/"+o.entityId+"/Contact_Roles")}return"false"===window.isSandboxAcc&&window.isCanvasSandboxDiff&&(s=s.replace("/crm/","/crm/v2/sandbox/diff/")),"true"===window.isSandboxAcc&&window.isCanvasProdDiff&&(s=s.replace("/crm/","/crm/v2/production/diff/")),s}}),store.registerSerializer("emails_rl_user",{normalizeResponse:function(e,t,a,i,s,l,o,n){if("findAll"===t&&200===s){var p={};if("string"==typeof a&&JSON.parse(a),a&&a.email_related_list&&a.email_related_list.length>0&&a.email_related_list[0].hasOwnProperty("emails_sent_from_crm"))p.content="shared_users_"+n.entityId,p.data=a;else if(a&&a.email_related_list&&a.email_related_list.length>0)p.data=a;else if(a&&a.data){for(var m={contact_details:[],meta:{}},r=a.data.length,c=0;c<r;c++)(a.data[c].Email&&""!==a.data[c].Email||a.data[c].Secondary_Email&&""!==a.data[c].Secondary_Email)&&(m.contact_details[c]={name:a.data[c].Full_Name,id:a.data[c].id,email:a.data[c].Email,secondary_email:a.data[c].Secondary_Email});m.meta=a.info,p.data=m}else p.content="emails_"+n.entityId,p.data=a;a.emails_rl_user=[p]}return a},payloadKey:function(e,t,a,i,s,l){return"emails_rl_user"}});
