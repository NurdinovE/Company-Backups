var zpb_config={cachedObj:{},viewVsDefElementId:{loginPopup:"loginPopup",UKBundlePopUp:"UKBundlePopUp",preferencePopup:"preferencesDiv",statusOptions:"preferencelistdiv",addcalleridpopup:"addCallerIdDiv",transferPopup:"preferencesDiv",callsInConvPopup:"callBarDiv",callsInQueuePopup:"callBarDiv",widgetPopup:"providerIframeDiv",dialpadUserListing:"floatingDialpad1"},viewVsMsg:{loginPopup:{action:"openpopup",cssText:"border-width:0px; position:fixed; z-index:400; top:0; left:0; color-scheme:none;"},preferencePopup:{action:"openpopup",cssText:"border-width:0px; position:fixed; z-index:400; top:0; left:0; color-scheme:none;"},UKBundlePopUp:{action:"openpopup",cssText:"border-width:0px; position:fixed; z-index:400; top:0; left:0; color-scheme:none;"},addcalleridpopup:{action:"openpopup",cssText:"border-width:0px; position:fixed; z-index:400; top:0; left:0; color-scheme:none;"},transferPopup:{action:"openpopup",cssText:"border-width:0px; position:fixed; z-index:400; top:0; left:0; color-scheme:none;"},statusOptions:{action:"openpopup",type:"preferencelist",cssText:"-webkit-box-shadow:-5px 0px 5px #ededed; box-shadow:-5px 0px 5px #ededed; border-width:0px; position:fixed; bottom:26px; z-index:400; color-scheme:none;"},callsInConvPopup:{action:"openpopup",cssText:"border-width:0px; position:fixed; z-index:400; top:0; width: 830px; height: calc(100vh - 30px); color-scheme:none;"},dialpadUserListing:{action:"openpopup",cssText:"border-width:0px; position:fixed; z-index:400; bottom:28px; width:400px; height:600px;"},callsInQueuePopup:{action:"openpopup",cssText:"border-width:0px; position:fixed; z-index:400; top:0; width: 830px; height: calc(100vh - 30px); color-scheme:none;"},widgetPopup:{action:"openpopup",type:"widgetpopup",cssText:"border-width:0px; position:fixed; bottom:26px; z-index:500; color-scheme:none;"}},chooseStatus:function(e){var t=$L(e.target).data("value")+"";zpb_config.saveStatusConfig({status:t}),zpb_config.onStatusChange(t)},choosePref:function(e){var t=$("login-form")[0].component.getAllVisibleInputValue();document.getElementById("userPreferencePopup").ltProp("show",!1),t.phoneNumberType=t.phoneNumberType||"direct",delete t.click_to_dial_allowed,zpb_config.savePrefConfig(t)},saveCallerId:function(e){var t={};t.phoneNum=document.getElementById("phoneNum").component.data.ltPropValue,zpb_config.savecallerId(t).then(function(e){if("Validationcode"in e){var o=I18n.getMsg("phonebridge.provider.inbuilt.preference.Verificationcode"),i=I18n.getMsg("phonebridge.provider.inbuilt.preference.VerificationMessage");document.getElementById("Validationcode").innerHTML=o+" : "+e.Validationcode+"<br/><br/>"+i,document.getElementById("Validationcode").style.display="block",document.getElementById("verify").style.display="none"}else document.getElementById("Validationcode").innerHTML=e.ValidationMessage,document.getElementById("Validationcode").style.display="block",document.getElementById("verify").style.display="none","success"===e.message&&(COMMON_UTILS.sendMessageToParentWindow({action:"showSuccessMessage",data:I18n.getMsg("phonebridge.provider.preference.Phonenumberverifiedalready")}),zpb_config.showCallerId().then((function(){setTimeout((function(){document.getElementById("OutBoundCallerId").ltProp("selected",t.phoneNum)}),2e3)})))}.bind(this))},showCallerId:function(){return new Promise((function(e,t){e(zpb_config.showUserFrameView("preferencePopup"))}))},chooseLoginLater:function(){zpb_config.saveStatusConfig({status:"loginlater"}),zpb_config.onStatusChange("loginlater"),pbTabManager.send({key:"Msg",functionname:"PhoneBridgeUtil.closepopup"})},saveProviderLoginConfig:function(e){e.serviceName=e.serviceName||PhoneBridgeUtil.serviceName,zpb_config.saveConfig("/phonebridge/providerlogin/save",e)},saveC2DConfig:function(e){zpb_config.saveConfig("/phonebridge/config/clicktodial",e)},saveStatusConfig:function(e){zpb_config.saveConfig("/phonebridge/userstatus/save",e)},savePrefConfig:function(e){zpb_config.saveConfig("/phonebridge/phonenumberpreference/save",e).then((function(t){"success"==t?(zpb_config.onPreferenceChange(e),pbTabManager.send({key:"Msg",functionname:"PhoneBridgeUtil.closepopup"}),PhoneBridgeUtil.showSuccessMessage(I18n.getMsg("phonebridge.preference.success"))):"\n"===t?PhoneBridgeUtil.showTopErrorMsg("Please enter a valid option"):t&&PhoneBridgeUtil.showTopErrorMsg(t)}))},savecallerId:function(e){return zpb_config.saveConfig("/phonebridge/config/setcallerid",e)},saveConfig:function(e,t){(t=t||{}).providerId=PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].providerId;var o={actionUrl:e,params:t,type:"POST",authentication:"cookies",headers:{"X-PB-ORG":PhoneBridgeUtil.getCurrentOrg(),"Content-Type":"application/x-www-form-urlencoded","X-ZCSRF-TOKEN":"phonebridgecsrparam="+COMMON_UTILS.getCookie("phonebridgecsr")}};return COMMON_UTILS.fetchRequest(o)},onLogin:function(e){PhoneBridgeUtil.closepopup(),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].isLoggedIn=!0,"offline"!==PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].userStatus&&"loginlater"!==PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].userStatus||!e&&zpb_config.saveStatusConfig({status:"online"}),"function"==typeof PhoneBridgeUtil.onLoginCallback&&PhoneBridgeUtil.onLoginCallback(),PhoneBridgeUtil.integrationCheck()},onLogout:function(){PhoneBridgeUtil.setStatusForLogout(),PhoneBridgeUtil.checkAndShowStatusIcon(PhoneBridgeUtil.getCurrentOrg()),"function"==typeof PhoneBridgeUtil.onLogoutCallback&&PhoneBridgeUtil.onLogoutCallback(),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].isLoginFormPresent&&zpb_config.showUserFrameView("loginPopup")},onStatusChange:function(e){PhoneBridgeUtil.setUserStatusInDORG(e),"online"===e?(PhoneBridgeUtil.showSuccessMessage(I18n.getMsg("phonebridge.callpopup.status","Online")),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.defaultOrg].userStatus=e):"dnd"===e?(PhoneBridgeUtil.showSuccessMessage(I18n.getMsg("phonebridge.callpopup.status","Offline")),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.defaultOrg].userStatus=e):"loginlater"===e&&PhoneBridgeUtil.closepopup(),"function"==typeof PhoneBridgeUtil.onStatusChangeCallback&&PhoneBridgeUtil.onStatusChangeCallback()},onPreferenceChange:function(e){if(PhoneBridgeUtil.closepopup(),e.phoneNumberType){PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].phoneNumberType=e.phoneNumberType,PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].phoneNumber=e.phoneNumber;var t=PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].phoneNumberType.toUpperCase(),o=PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].callControlFeature;PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].answerAllowed=o[t].includes("answer"),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].endAllowed=o[t].includes("end"),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].declineAllowed=o[t].includes("decline"),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].muteAllowed=o[t].includes("mute"),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].holdAllowed=o[t].includes("hold"),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].keypressAllowed=o[t].includes("keypress"),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].transferAllowed=o[t].includes("transfer"),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].parallelcallAllowed=o[t].includes("parallelcall"),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].mergeandleaveAllowed=o[t].includes("mergeandleave"),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].mergeAllowed=o[t].includes("merge"),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].leaveAllowed=o[t].includes("leave"),"function"==typeof PhoneBridgeUtil.onPrefChangeCallback&&PhoneBridgeUtil.onPrefChangeCallback()}},onConfigChanges:function(e){e.pbZgid&&e.pbZgid!=PhoneBridgeUtil.getCurrentOrg()||("loggedin"==e.action?(e.userStatus&&(PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].userStatus=e.userStatus),zpb_config.onLogin()):"loggedout"==e.action?zpb_config.onLogout():"status_change"==e.action?zpb_config.onStatusChange(e.status):"auto_status_change"==e.action?PhoneBridgeUtil.setUserStatusInDORG(e.status):"pref_change"==e.action&&zpb_config.onPreferenceChange(e))},processClientDynamicKVPairs:function(e){if(e.CLIENT_DYNAMIC_KVPAIRS)for(var t in e.CLIENT_DYNAMIC_KVPAIRS)if(e.CLIENT_DYNAMIC_KVPAIRS.hasOwnProperty(t)){var o=e.CLIENT_DYNAMIC_KVPAIRS[t],i=COMMON_UTILS.executeFunctionByName(o.FUNCTIONNAME,window,o.ARGUMENTS);e.CLIENT_DYNAMIC_KVPAIRS[t]=i}},showHideBasicElements:function(e){var t=["loginPopup","preferencesDiv","addCallerIdDiv","preferencelistdiv","overlayerdiv","topErrorPopup","providerIframeDiv","callBarDiv","UKBundlePopUp"],o=["providerIframeDiv"],i=t.length;-1==e.indexOf("loginPopup")&&-1==e.indexOf("preferencesDiv")&&-1==e.indexOf("addCallerIdDiv")&&-1==e.indexOf("UKBundlePopUp")||e.push("overlayerdiv"),-1!==e.indexOf("preferencelistdiv")&&"block"===document.getElementById("callBarDiv").style.display&&e.push("callBarDiv");for(var a=0;a<i;a++){var n=t[a],l=document.getElementById(n);null!=l&&(-1!=e.indexOf(n)?-1!=o.indexOf(n)?$(l).slideDown():l.style.display="block":-1!=o.indexOf(n)?$(l).slideUp():l.style.display="none")}},showUserFrameView:function(e,t,o,i,a){o=o||PhoneBridgeUtil.getCurrentOrg();var n=e+"_"+o;if("defaultStatusOptions"===e)(l={COMPONENT_NAME:"user-status-options",STATIC_KVPAIRS:{onlyDefaultOption:!0},SERVER_DYNAMIC_KVPAIRS:{},CLIENT_DYNAMIC_KVPAIRS:{}}).elementId=i,zpb_config.processUserFrameViewResponse("statusOptions",l,a);else if("defaultStatusOptionsplusPreference"===e){(l={COMPONENT_NAME:"user-status-options",STATIC_KVPAIRS:{showPrefOption:!0,onlyDefaultOption:!0},SERVER_DYNAMIC_KVPAIRS:{},CLIENT_DYNAMIC_KVPAIRS:{}}).elementId=i,zpb_config.processUserFrameViewResponse("statusOptions",l,a)}else if(-1!=Object.keys(zpb_config.cachedObj).indexOf(n)){var l;(l=JSON.parse(zpb_config.cachedObj[n])).elementId=i||l.elementId,zpb_config.processUserFrameViewResponse(e,l,a)}else{var s={providerId:PhoneBridgeUtil.multiOrgData[o].providerId};t&&(s.callRefID=t);var r={actionUrl:"/phonebridge/viewcomponent/userframe/"+e,params:s,type:"GET",authentication:"cookies",headers:{"X-PB-ORG":o,"Content-Type":"application/x-www-form-urlencoded"}};COMMON_UTILS.fetchRequest(r).then((function(t){t.CACHE&&(zpb_config.cachedObj[n]=JSON.stringify(t)),t.elementId=i||t.elementId,zpb_config.processUserFrameViewResponse(e,t,a)}))}},processUserFrameViewResponse:function(e,t,o){zpb_config.processClientDynamicKVPairs(t);var i=Object.assign(t.STATIC_KVPAIRS,t.SERVER_DYNAMIC_KVPAIRS,t.CLIENT_DYNAMIC_KVPAIRS),a=t.elementId||zpb_config.viewVsDefElementId[e];zpb_config.showHideBasicElements([a]),zpb_config.renderLyteComponent(t.COMPONENT_NAME,i,a),zpb_config.viewVsMsg.hasOwnProperty(e)&&COMMON_UTILS.sendMessageToParentWindow(zpb_config.getMsgForView(e,a)),o&&o()},showCallBar:function(){document.getElementById("callBarDiv").ltProp("show",!0)},renderLyteComponent:function(e,t,o){var i=document.getElementById(o);null!=i&&(i.innerHTML=null),Lyte.Component.render(e,t,"#"+o)},getMsgForView:function(e,t,o){var i=zpb_config.viewVsMsg[e];if(i&&i.cssText){if(t&&"preferencelistdiv"===t){var a=document.getElementById(t),n=a.offsetHeight+"px",l=a.offsetWidth+"px";i.cssText+="width:"+l+";height:"+n+";"}else o?i.cssText+=o:t&&"callBarDiv"===t||t&&"floatingDialpad1"===t?i.cssText=i.cssText:i.cssText+="width:100%; height:100%;";i.cssText+=COMMON_UTILS.isHebrew()?"left:0px;":"right:0px;"}return i},isLoginFormVisible:function(){return null!=document.getElementById("loginPopup")&&"none"!=document.getElementById("loginPopup").style.display},checkAndShowLoginPopup:function(e,t){if(PhoneBridgeUtil.getCurrentOrg()==e&&PhoneBridgeUtil.multiOrgData[e]){var o=PhoneBridgeUtil.multiOrgData[e];o.isLoginFormPresent&&"loginlater"!==o.userStatus&&PhoneBridgeUtil.currentStatus&&"phonelogin"===PhoneBridgeUtil.currentStatus.statustype&&!zpb_config.isLoginFormVisible()&&(o.isLoggedIn=!1,o.userStatus="offline",PhoneBridgeUtil.showStatusIcon(PhoneBridgeUtil.defaultOrg),zpb_config.showUserFrameView("loginPopup"),t&&tabCommunicator.publishData("dummyKey",e,"zpb_config.checkAndShowLoginPopup"))}}};Lyte.Component.register("iframe-popup",{_template:'<template tag-name="iframe-popup"> <div id="overlayerdiv" style="position: fixed;width: 100%;height: 100%;background-color: none; background: #3a3a3a;opacity: 0.2;display:none"></div> <div class="mB50 aligncenter"> <template is="if" value="{{popupTitle}}"><template case="true"> <div class="titleLoginPopup f24 pb-font-semibold mL12">{{popupTitle}}</div> </template><template case="false"> <div class="titleRingCentral mL12">{{getI18n("phonebridge.provider",providerDisplayName)}}</div> </template></template> <div class="error errorContent">Please check Credentials</div> <div class="loginbtndiv mT25 dIB"> <login-form id="login_form" login-key="{{loginKey}}" sysref-vs-value="{{sysrefVsValue}}"></login-form> <div class="aligncenter mT20"> <lyte-button lt-prop-appearance="success" onclick="{{loginFunc}}" data-zcqa="login_button"> <template is="registerYield" yield-name="text"> {{getI18n(loginFieldName,providerDisplayName)}} </template> </lyte-button> <template is="if" value="{{expHandlers(loginLater,\'==\',&quot;later&quot;)}}"><template case="true"> <lyte-button class="mL7" onclick="{{action(\'onClick\',\'zpb_config.chooseLoginLater\')}}" data-zcqa="login_later"> <template is="registerYield" yield-name="text"> Login Later </template> </lyte-button> </template><template case="false"> <lyte-button class="mL7" onclick="{{action(&quot;cancelProcess&quot;)}}" data-zcqa="cancel_login"> <template is="registerYield" yield-name="text"> {{getI18n(loginLater)}} </template> </lyte-button> </template></template> </div></div> <template is="if" value="{{showWhatQn}}"><template case="true"> <div class="p0"> <div class="whatRingcentral_txt zpb-font-semibold mT30">{{getI18n("phonebridge.provider.ringcentral.what.ques",providerDisplayName)}}</div> <div class="whatRingcentralDesc_txt mT10 pbParagraphColor">{{getI18n("phonebridge.provider.ringcentral.what.ans")}}</div> </div> </template></template> </div> </template>',_dynamicNodes:[{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[3,5,1]},{type:"componentDynamic",position:[3,5,1]},{type:"attr",position:[3,5,3,1]},{type:"registerYield",position:[3,5,3,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3,5,3,1]},{type:"attr",position:[3,5,3,3]},{type:"if",position:[3,5,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3,7]},{type:"if",position:[3,7],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"text",position:[1,3,0]}]}},default:{}}],_observedAttributes:["loginKey","sysrefVsValue","loginFunc","loginLater","providerDisplayName","loginFieldName","popupTitle","showWhatQn"],data:function(){return{loginKey:Lyte.attr("array"),sysrefVsValue:Lyte.attr("object"),loginFunc:Lyte.attr("string",{default:"Setup.enableIntegrationfromPopup()"}),loginLater:Lyte.attr("string"),providerDisplayName:Lyte.attr("string"),loginFieldName:Lyte.attr("string"),popupTitle:Lyte.attr("string"),showWhatQn:Lyte.attr("boolean",{default:!0})}},init:function(){var e=document.getElementById("popupLogin");null!=e&&(e.style.display="block"),window.addEventListener("message",(function(e){var t=e.data;"toggleDarkmode"===t.action&&COMMON_UTILS.toggleDarkmode(t.isDarkmode)}))},actions:{cancelProcess:function(){var e=document.getElementsByClassName("freezeLayer_manual")[0];e.parentNode.removeChild(e);var t=document.getElementById("popupLogin");t.innerHTML=null,t.style.display="none"},onClick:function(e,t){COMMON_UTILS.executeFunctionByName(e,window,t)}}}),Lyte.Component.register("user-status-options",{_template:'<template tag-name="user-status-options"> <template is="if" value="{{expHandlers(onlyDefaultOption,\'!\')}}"><template case="true"> <ul class="pR" style="max-height: 250px;position: relative;overflow: auto;"> <template is="for" items="{{statusOptions}}" item="item" index="index"> <template is="if" value="{{ClientProvider}}"><template case="true"> <li data-value="{{item.statusRefName}}" id="{{item.statusRefName}}" data-zcqa="{{item.statusRefName}}" class="{{if(ifEquals(item.statusLabel,currentStatus),\'selected\',\'\')}}" onclick="{{action(\'changeStatus\',event)}}"> <span class="{{item.statusColorClass}} dIB mT3" style="position:inherit"> </span> {{getI18n(item.statusLabel)}} </li> </template><template case="false"> <li data-value="{{item.statusRefName}}" id="{{item.statusRefName}}" data-zcqa="{{item.statusRefName}}" class="{{if(ifEquals(getI18n(item.statusLabel),currentStatus),\'selected\',\'\')}}" onclick="{{action(\'changeStatus\',event)}}"> <span class="{{item.statusColorClass}} dIB mT3" style="position:inherit"> </span> {{getI18n(item.statusLabel)}} </li> </template></template> </template> </ul> </template></template> <template is="if" value="{{showPrefOption}}"><template case="true"> <div onclick="{{prefFunc}}" class="prefBdr cP">{{getI18n(\'phonebridge.preferences\')}}</div> </template></template> <template is="if" value="{{showCallBarOption}}"><template case="true"> <div onclick="{{viewCallsInConv}}" data-zcqa="view_calls_InConv" class="prefBdr cP">{{getI18n(\'phonebridge.provider.preference.viewcallsinconversation\')}}</div> <div onclick="{{viewCallsInQueue}}" data-zcqa="view_calls_InQueue" class="prefBdr cP">{{getI18n(\'phonebridge.provider.preference.viewcallsinqueue\')}}</div> </template></template> <template is="if" value="{{expHandlers(expHandlers(expHandlers(ifNotEquals(serviceName,&quot;ZohoOne&quot;),\'&amp;&amp;\',ifNotEquals(serviceName,&quot;CRMPlus&quot;)),\'&amp;&amp;\',ifNotEquals(serviceName,&quot;VCRM&quot;)),\'&amp;&amp;\',ifNotEquals(serviceName,&quot;SDPOnPremise&quot;))}}"><template case="true"> <div> <ul> <li class="{{if(popupHidden,\'unselected\',\'selected\')}} cP" data-zcqa="show_popup" onclick="{{action(\'showCallPopup\')}}">Show call popup in {{serviceDisplayName}}</li> <li class="{{if(popupHidden,\'selected\',\'unselected\')}} cP" data-zcqa="dont_show_popup" onclick="{{action(\'hideCallPopup\')}}">Don\'t show call popup in {{serviceDisplayName}}</li> </ul> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,3]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,3]}]}},default:{}}]}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"attr",position:[3]},{type:"text",position:[3,0]}]}},default:{}},{type:"attr",position:[7]},{type:"if",position:[7],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"text",position:[1,1,1,1]},{type:"attr",position:[1,1,3]},{type:"text",position:[1,1,3,1]}]}},default:{}}],_observedAttributes:["statusOptions","showPrefOption","showCallBarOption","prefFunc","saveFunc","viewCallsInConv","viewCallsInQueue","serviceName","serviceDisplayName","currentStatus","parentElement","popupHidden","ClientProvider","type5providerList","type4providerStatus"],data:function(){return{statusOptions:Lyte.attr("array"),showPrefOption:Lyte.attr("boolean"),showCallBarOption:Lyte.attr("boolean",{default:!1}),prefFunc:Lyte.attr("string",{default:"zpb_config.showUserFrameView('preferencePopup')"}),saveFunc:Lyte.attr("string"),viewCallsInConv:Lyte.attr("string",{default:"zpb_config.showUserFrameView('callsInConvPopup')"}),viewCallsInQueue:Lyte.attr("string",{default:"zpb_config.showUserFrameView('callsInQueuePopup')"}),serviceName:Lyte.attr("string"),serviceDisplayName:Lyte.attr("string"),currentStatus:Lyte.attr("string"),parentElement:Lyte.attr("object"),popupHidden:Lyte.attr("boolean",{default:!1}),ClientProvider:Lyte.attr("boolean",{default:!1}),type5providerList:Lyte.attr("array",{default:["awsconnect"]}),type4providerStatus:Lyte.attr("object",{default:{online:"Online",dnd:"Offline",offline:"Offline",Available:"Online"}})}},actions:{changeStatus:function(e){var t=this.getData("saveFunc");void 0!==t?(COMMON_UTILS.executeFunctionByName(t,window,e),setTimeout((()=>{PhoneBridgeUtil.showSuccessMessage(I18n.getMsg("phonebridge.callpopup.status",e.target.innerText))}),1e3)):(zpb_config.chooseStatus(e),PhoneBridgeUtil.closepopup())},showCallPopup:function(){this.setData("popupHidden",!1),PhoneBridgeUtil.initialiseCallPopup().then(PhoneBridgeUtil.showCallPopup)},hideCallPopup:function(){this.setData("popupHidden",!0),PhoneBridgeUtil.initialiseCallPopup().then(PhoneBridgeUtil.hideCallPopup)}},init:function(){var e,t=this.getData("type5providerList");if("D_ORG"===PhoneBridgeUtil.currentOrgtype&&(e=t.includes(PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.defaultOrg].providerName)),this.setData("serviceName",PhoneBridgeUtil.serviceName),this.setData("serviceDisplayName",PhoneBridgeUtil.serviceDisplayName),this.setData("popupHidden",PhoneBridgeUtil.popupHidden),e)this.setData("ClientProvider",!0),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.defaultOrg].userStatus=zpb_awsconnect.agent.getStatus().name,this.setData("currentStatus",zpb_awsconnect.agent.getStatus().name);else if(PhoneBridgeUtil.defaultOrg&&PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.defaultOrg]){var o=this.getData("type4providerStatus");o[PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.defaultOrg].userStatus]&&this.setData("currentStatus",o[PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.defaultOrg].userStatus])}}}),Lyte.Component.register("user-preference-popup",{_template:'<template tag-name="user-preference-popup"> <lyte-modal id="userPreferencePopup" lt-prop-offset="{&quot;top&quot;:&quot;0&quot;}" lt-prop-show-close-button="false" lt-prop-width="670px"> <template is="registerYield" yield-name="modal"> <lyte-modal-header>{{getI18n("phonebridge.preferences")}}</lyte-modal-header> <lyte-modal-content> <login-form id="login_form" login-key="{{loginKey}}" sysref-vs-value="{{sysrefVsValue}}" sysref-vs-actions="{{sysrefVsActions}}" labeltd-class="w40per" valuetd-class="w50per"></login-form> </lyte-modal-content> <lyte-modal-footer class="right"> <lyte-button onclick="PhoneBridgeUtil.cancelPref()"> <template is="registerYield" yield-name="text"> {{getI18n(\'phonebridge.cancel.propercase\')}} </template> </lyte-button> <lyte-button lt-prop-appearance="primary" onclick="{{saveFunc}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'phonebridge.save.propercase\')}} </template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </template>',_dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"componentDynamic",position:[3,1]},{type:"componentDynamic",position:[3]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["loginKey","sysrefVsValue","sysrefVsActions","saveFunc"],data:function(){return{loginKey:Lyte.attr("array"),sysrefVsValue:Lyte.attr("object"),sysrefVsActions:Lyte.attr("object"),saveFunc:Lyte.attr("string",{default:"zpb_config.choosePref(event)"})}},didConnect:function(){document.getElementById("userPreferencePopup").ltProp("show",!0)},actions:{onSave:function(){}}}),Lyte.Component.register("uk-bundle-popup",{_template:'<template tag-name="uk-bundle-popup"> <lyte-modal id="UKBundlePopUp1" lt-prop-offset="{&quot;top&quot;:&quot;0&quot;}" lt-prop-show-close-button="false" lt-prop-width="670px"> <template is="registerYield" yield-name="modal"> <lyte-modal-header class="pB5">{{getI18n("phonebridge.ukBundleTitle")}}</lyte-modal-header> <lyte-modal-content><div>{{getI18n("phonebridge.ukBundleMessage")}}</div> <div class="mT10">{{getI18n("phonebridge.ukBundleMessage1")}}</div> <div class="mT10">{{getI18n("phonebridge.ukBundleMessage2")}}</div> <div class="mT10">{{getI18n("phonebridge.ukBundleMessage3")}}</div> <div class="mT10">{{getI18n("phonebridge.ukBundleMessage4")}}</div> <div class="mT10 pbNotesContent lh20">{{getI18n("phonebridge.ukBundleMessage5")}}</div></lyte-modal-content> <lyte-modal-footer class="right"> <lyte-button onclick="PhoneBridgeUtil.cancelUkPopUp()"> <template is="registerYield" yield-name="text"> {{getI18n(\'phonebridge.cancel.propercase\')}} </template> </lyte-button> <lyte-button lt-prop-appearance="primary" rel="noopener noreferrer" onclick="{{action(\'openHelp\')}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'phonebridge.submitnow.propercase\')}} </template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </template>',_dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]},{type:"text",position:[3,0,0]},{type:"text",position:[3,2,0]},{type:"text",position:[3,4,0]},{type:"text",position:[3,6,0]},{type:"text",position:[3,8,0]},{type:"text",position:[3,10,0]},{type:"componentDynamic",position:[3]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,1]},{type:"attr",position:[5,3]},{type:"registerYield",position:[5,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,3]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["saveFunc"],data:function(){return{saveFunc:Lyte.attr("string",{default:"zpb_config.choosePref(event)"})}},init:function(){},didConnect:function(){document.getElementById("UKBundlePopUp1").ltProp("show",!0)},actions:{onSave:function(){},openHelp:function(){obj={actionUrl:"/phonebridge/config/AccountSID",type:"GET",params:{orgId:PhoneBridgeUtil.getCurrentOrg()},authentication:"cookies",headers:{"Content-Type":"application/x-www-form-urlencoded","X-PB-ORG":PhoneBridgeUtil.getCurrentOrg()}},COMMON_UTILS.fetchRequest(obj).then(function(e){this.setData("help_url",e);var t=this.getData("help_url");window.open(t,"help","toolbar=no,statusbar=no,menubar=no,directories=no,scrollbars=yes,resizeable=yes,menubar=no,width=1040,height=600"),PhoneBridgeUtil.cancelUkPopUp()}.bind(this))}}}),Lyte.Component.register("pb-picklist",{_template:'<template tag-name="pb-picklist"> <template is="if" value="{{defaultOptions}}"><template case="true"> <lyte-dropdown id="{{sysrefName}}" lt-prop-type="{{type}}" on-option-selected="{{method(&quot;onOptionChosen&quot;)}}" class="{{if(isMandatory,\'mandatoryField\',\'\')}} tp_BoxDropdown w100per picklistOptionDiv picklistOption" lt-prop-selected="{{defaultOptionRefName}}" lt-prop-placeholder="{{defaultPlaceHolder}}" lt-prop-animate="false" lt-prop-freeze="false" lt-prop-tabindex="5" lt-prop-show="false" data-zcqa="dropdown_{{sysrefName}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="picklistDropBox"> <template is="if" value="{{expHandlers(expHandlers(type,\'!=\',\'multisearch\'),\'&amp;&amp;\',expHandlers(defaultOptions.length,\'>=\',5))}}"><template case="true"> <lyte-drop-header> <div class="mL20 mR20 mT10"> <lyte-search on-search="{{method(&quot;showResult&quot;)}}" lt-prop-query-selector="{&quot;scope&quot;:&quot;.ltbody_{{sysrefName}}&quot;,&quot;search&quot;:&quot;lyte-drop-item&quot;}" lt-prop-appearance="box" data-zcqa="search_{{sysrefName}}"> </lyte-search> </div> </lyte-drop-header> </template></template> <lyte-drop-body class="ltbody_{{sysrefName}}"> <template is="for" items="{{defaultOptions}}" item="item" index="index"> <template is="if" value="{{item.optionLabelArray}}"><template case="true"> <lyte-drop-item data-value="{{item.optionRefName}}" class="picklistOptionDiv" data-zcqa="{{sysrefName}}_{{index}}"> <template is="for" items="{{item.optionLabelArray}}" item="label" index="index"> <div class="picklistOption" title="{{getI18n(label)}}">{{getI18n(label)}}</div> </template> </lyte-drop-item> </template><template case="false"> <lyte-drop-item data-value="{{item.optionRefName}}" class="picklistOptionDiv picklistOption" title="{{getI18n(item.optionLabel)}}" data-zcqa="{{sysrefName}}_{{index}}"> {{getI18n(item.optionLabel)}} </lyte-drop-item> </template></template> </template> </lyte-drop-body> <template is="if" value="{{expHandlers(defaultOptions.length,\'==\',0)}}"><template case="true"> <div id="noresultdiv" class="noresultstyle">{{getI18n(\'phonebridge.noresultfound\')}}</div> </template></template> </lyte-drop-box> </template> </lyte-dropdown> </template><template case="false"><template is="if" value="{{optionPromiseFn}}"><template case="true"> <span class="pbPickListBox"> <span id="rcLoading" class="loading">{{getI18n(\'phonebridge.loading.propercase\')}}<span class="loadingIcon"></span></span> </span> </template><template case="false"> <lyte-dropdown id="{{sysrefName}}" lt-prop-type="{{type}}" on-option-selected="{{method(&quot;onOptionChosen&quot;)}}" class="tp_BoxDropdown w100per picklistOptionDiv picklistOption {{if(isMandatory,\'mandatoryField\',\'\')}}" lt-prop-selected="{{defaultOptionRefName}}" lt-prop-placeholder="{{defaultPlaceHolder}}" lt-prop-animate="false" lt-prop-freeze="false" lt-prop-tabindex="5" lt-prop-show="false" data-zcqa="dropdown_{{sysrefName}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="picklistDropBox"> <template is="if" value="{{expHandlers(expHandlers(type,\'!=\',\'multisearch\'),\'&amp;&amp;\',expHandlers(options.length,\'>=\',5))}}"><template case="true"> <lyte-drop-header> <div class="mL20 mR20 mT10"> <lyte-search on-search="{{method(&quot;showResult&quot;)}}" lt-prop-query-selector="{&quot;scope&quot;:&quot;.ltbody_{{sysrefName}}&quot;,&quot;search&quot;:&quot;lyte-drop-item&quot;}" lt-prop-appearance="box" data-zcqa="search_{{sysrefName}}"> </lyte-search> </div> </lyte-drop-header> </template></template> <lyte-drop-body class="ltbody_{{sysrefName}}"> <template is="for" items="{{options}}" item="item" index="index"> <template is="if" value="{{item.optionLabelArray}}"><template case="true"> <lyte-drop-item data-value="{{item.optionRefName}}" class="picklistOptionDiv" data-zcqa="{{sysrefName}}_{{index}}"> <template is="for" items="{{item.optionLabelArray}}" item="label" index="index"> <div class="picklistOption" title="{{getI18n(label)}}">{{getI18n(label)}}</div> </template> </lyte-drop-item> </template><template case="false"><template is="if" value="{{item.audioFileObj}}"><template case="true"> <lyte-drop-item data-value="{{item.optionRefName}}" class="picklistOptionDiv"> <span class="picklistOption" title="{{getI18n(label)}}"> {{getI18n(item.optionLabel)}} </span> <pb-stored-audio class="fR" mode="optionsView" picklist-id="{{sysrefName}}" show-drag-section="false" show-delete-confirm="false" prevent-stop-event="true" recording-obj="{{item.audioFileObj}}" record-id="{{item.optionRefName}}"> </pb-stored-audio> </lyte-drop-item> </template><template case="false"> <lyte-drop-item data-value="{{item.optionRefName}}" class="picklistOptionDiv picklistOption" title="{{getI18n(item.optionLabel)}}" data-zcqa="{{sysrefName}}_{{index}}"> {{getI18n(item.optionLabel)}} </lyte-drop-item> </template></template></template></template> </template> </lyte-drop-body> <template is="if" value="{{showAttachFile}}"><template case="true"> <lyte-drop-footer> <lyte-fileupload id="ltFileUpload_{{sysrefName}}" lt-prop-message="{{getI18n(\'browse\')}}" lt-prop-auto-upload="true" lt-prop-accept="audio/wav,audio/mpeg" lt-prop-file-limit="20000000" lt-prop-appearance="Input" lt-prop-multiple="true" lt-prop-upload-multiple="false" on-file-success="{{method(&quot;onFileUpload&quot;)}}" lt-prop-ajax="{&quot;url&quot;:&quot;/phonebridge/config/audiofile&quot;,&quot;headers&quot;: {{getAuthHeadersJson()}} }"></lyte-fileupload> </lyte-drop-footer> </template></template> <template is="if" value="{{expHandlers(options.length,\'==\',0)}}"><template case="true"> <div id="noresultdiv" class="noresultstyle">{{getI18n(\'phonebridge.noresultfound\')}}</div> </template></template> </lyte-drop-box> </template> </lyte-dropdown> </template></template></template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,7]},{type:"if",position:[1,7],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["options","defaultOptions","defaultOptionRefName","defaultPlaceHolder","sysrefName","optionPromiseFn","optionPromiseFnArg","type","mode","isLoadingState","showAttachFile","isMandatory","isOnValueChangeNeeded","isPrimaryValue","index"],data:function(){return{options:Lyte.attr("array"),defaultOptions:Lyte.attr("array"),defaultOptionRefName:Lyte.attr("string"),defaultPlaceHolder:Lyte.attr("string",{default:"-"+I18n.getMsg("phonebridge.select.propercase")+"-"}),sysrefName:Lyte.attr("string"),optionPromiseFn:Lyte.attr("string"),optionPromiseFnArg:Lyte.attr("string"),type:Lyte.attr("string",{default:"default"}),mode:Lyte.attr("string",{default:"edit"}),isLoadingState:Lyte.attr("boolean",{default:!1}),showAttachFile:Lyte.attr("boolean",{default:!1}),isMandatory:Lyte.attr("boolean",{default:!1}),isOnValueChangeNeeded:Lyte.attr("boolean",{default:!1}),isPrimaryValue:Lyte.attr("boolean",{default:!1}),index:Lyte.attr("number")}},didConnect:function(){var e=this.getData("optionPromiseFn");if(e){if("view"===this.getData("mode")&&this.getData("defaultOptions"))return;var t=this.getData("optionPromiseFnArg");COMMON_UTILS.executeFunctionByName(e,window,t,this.getData("defaultOptions")).then(function(e){if(this.data&&(this.setData("optionPromiseFn",null),e)){if(this.setData({options:e.options,defaultOptions:null}),e.defaultOptionRefName)this.setData("defaultOptionRefName",e.defaultOptionRefName);else{var t=this.$node.closest("login-form");t&&t.component.resetInputValue(this.getData("sysrefName"))}e.scrollJson&&this.addListenerForScroll(e.scrollJson),e.searchJson&&this.addListenerForSearch(e.searchJson),e.mode&&this.setData("mode",e.mode);var o=new Event("input-change",{bubbles:!0});this.$node.dispatchEvent(o);var i=this.$node.querySelector("lyte-dropdown");"view"==this.getData("mode")&&(i.ltProp("iconClass","dN"),i.ltProp("placeholder","-"),i.ltProp("disabled","true"))}}.bind(this))}},onModeChange:function(){var e=this.$node.querySelector("lyte-dropdown");if(e)if("view"==this.getData("mode"))e.ltProp("iconClass","dN"),e.ltProp("placeholder","-"),e.ltProp("disabled","true");else if("edit"==this.getData("mode")){var t=this.getData("defaultPlaceHolder");e.ltProp("iconClass","dropdown"),e.ltProp("placeholder",t),e.ltProp("disabled","false")}}.observes("mode").on("didConnect"),addListenerForScroll:function(e){if(e.scrollFn){var t=function(t){if(!this.getData("isLoadingState")){var o=t.target;(o.scrollTop+o.clientHeight)/o.scrollHeight>.8&&e.scrollFn(e.scrollFnArg,this)}}.bind(this),o=COMMON_UTILS.debounceFunction(t,300);$(this.$node.querySelector("lyte-drop-body")).scroll(o)}},removeListenerForScroll:function(){$(this.$node.querySelector("lyte-drop-body")).unbind("scroll")},addListenerForSearch:function(e){if(e.searchFn){var t=this.$node.querySelector("lyte-search"),o=function(o){if(!this.getData("isLoadingState")){var i=o.keyCode?o.keyCode:o.which,a=o.target.value;return(!COMMON_UTILS.isEmpty(a)&&13!==i||(e.searchFn(e.searchFnArg,this,t,a),13!==i))&&void 0}}.bind(this);$(this.$node.querySelector("lyte-search input")).keyup(o)}},getSelectedValueRefName:function(e){var t=this.getData("sysrefName"),o=this.$node.querySelector('lyte-dropdown[id="'+t+'"]');if(o&&(e||$L(o).is(":visible"))){var i=o.getData("ltPropSelected");return i&&"string"==typeof i&&-1!==["multiple","multisearch"].indexOf(o.getData("ltPropType"))&&(i=JSON.parse(i)),i}return null},setSelectedValueRefName:function(e){this.setData("defaultOptionRefName",e);var t=this.getData("sysrefName"),o=this.$node.querySelector('lyte-dropdown[id="'+t+'"]');o&&o.setData("ltPropSelected",e)},methods:{onOptionChosen:function(){this.getData("isOnValueChangeNeeded")&&this.executeMethod("onDemoFunction");var e=new Event("input-change",{bubbles:!0});return this.$node.dispatchEvent(e),this.setData("isPlusShow",!1),!0},onDemoFunction:function(){var e=this.$node.query("lyte-dropdown").id.split("_"),t=this.$node.query("lyte-dropdown").ltProp("selected"),o=document.getElementById(e[0]+"_secondary_"+e[2]);null!==o&&COMMON_UTILS.isNotEmpty(t)&&o.component.data.ltPropValue.length>0&&this.setData("isPlusShow",!0)},showResult:function(e){var t=document.querySelector("#noresultdiv");t&&(t.style.display=e.length<=0?"block":"none")},onFileUpload:function(e){if(e&&e.responseJSON&&e.responseJSON.data){var t=e.responseJSON.data,o={};o.optionRefName=t.audio_file_id,o.optionLabel=t.name,t.pb_audio_url&&(o.audioFileObj={RecordingURL:t.pb_audio_url});var i=COMMON_UTILS.getNewArray(this.getData("options"));i.push(o),this.setData("options",i),this.setSelectedValueRefName(t.audio_file_id),ClientResourcesRelationsUtils.doNotDeleteAudioFileIds.push(t.audio_file_id),ClientResourcesRelationsUtils.saveOptionsResourceData&&ClientDataManager.pushRecordData("audio_files",t.audio_file_id,t),document.querySelector("#ltFileUpload_"+this.getData("sysrefName")).removeUpload(),this.$node.querySelector("lyte-dropdown").close()}}}}),Lyte.Component.register("login-form",{_template:'<template tag-name="login-form"> <table cellpadding="0" class="f14 loginTable"> <tbody is="for" lyte-for="true" items="{{loginKey}}" item="item" index="index" depth="2"></tbody> </table> <div class="alertInfoMsg f14" id="alertInfo" style="display: none;"> <span class="fL alertIcon-yellow fL pb_maskIcons pb-ico-warning-triangle-lg pbicn_sandal_mask"></span> <span class="fL alertInfoTxt" id="alertMsg"> </span> <div class="clearB"> </div> </div> </template>',_dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,1]},{type:"attr",position:[3,1]},{type:"componentDynamic",position:[3,1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{},actualTemplate:'<template is="if" value="{{item[&quot;fieldLabel&quot;]}}"><template case="true" depth="3"><table><tbody><tr> <td class="{{labeltdClass}}"> <div class="pbLabelColor f15 w180"> <template is="if" value="{{expHandlers(item[&quot;fieldType&quot;],\'!=\',&quot;checkbox&quot;)}}"><template case="true"> {{getI18n(item["fieldLabel"])}} </template></template> </div> </td> </tr></tbody></table></template></template>'},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"switch",position:[1,1,1],cases:{text:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},singlelinetext:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},number:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},multilinetext:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},password:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]},checkbox:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[3,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},picklist:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},multiselect:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},audio_file:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},relationmap:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},mergeFieldsInput:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},hidden:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,3,0]}]}},default:{}}]}},default:{},actualTemplate:'<template is="if" value="{{item[&quot;fieldType&quot;]}}"><template case="true" depth="3"><table><tbody><tr> <td class="{{valuetdClass}}"> <div class="w390"> <template is="switch" value="{{item[&quot;fieldType&quot;]}}"><template case="text"> <template is="if" value="{{expHandlers(mode,\'==\',&quot;view&quot;)}}"><template case="true"> <lyte-input name="{{item[&quot;SysrefName&quot;]}}" id="{{item[&quot;SysrefName&quot;]}}" class="tp_BoxInput w100per {{if(item[\'isMandatory\'],\'mandatoryField\',\'\')}}" lt-prop-maxlength="{{if(item[\'maxLength\'],item[\'maxLength\'],100)}}" lt-prop-appearance="box" lt-prop-disabled="true" lt-prop-value="-" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </lyte-input> </template><template case="false"> <lyte-input name="{{item[&quot;SysrefName&quot;]}}" id="{{item[&quot;SysrefName&quot;]}}" class="tp_BoxInput w100per {{if(item[\'isMandatory\'],\'mandatoryField\',\'\')}}" lt-prop-maxlength="{{if(item[\'maxLength\'],item[\'maxLength\'],100)}}" lt-prop-appearance="box" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </lyte-input> </template></template> </template><template case="singlelinetext"> <template is="if" value="{{expHandlers(mode,\'==\',&quot;view&quot;)}}"><template case="true"> <lyte-input id="{{item[&quot;SysrefName&quot;]}}" class="tp_BoxInput w100per {{if(item[\'isMandatory\'],\'mandatoryField\',\'\')}}" lt-prop-maxlength="{{if(item[\'maxLength\'],item[\'maxLength\'],100)}}" lt-prop-appearance="box" lt-prop-disabled="true" lt-prop-value="-" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </lyte-input> </template><template case="false"> <lyte-input id="{{item[&quot;SysrefName&quot;]}}" class="tp_BoxInput w100per {{if(item[\'isMandatory\'],\'mandatoryField\',\'\')}}" lt-prop-maxlength="{{if(item[\'maxLength\'],item[\'maxLength\'],100)}}" lt-prop-appearance="box" lt-prop-placeholder="{{item[&quot;PlaceHolder&quot;]}}" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </lyte-input> </template></template> </template><template case="number"> <template is="if" value="{{expHandlers(mode,\'==\',&quot;view&quot;)}}"><template case="true"> <lyte-number id="{{item[&quot;SysrefName&quot;]}}" class="tp_BoxInput w100per {{if(item[\'isMandatory\'],\'mandatoryField\',\'\')}}" lt-prop-appearance="box" lt-prop-disabled="true" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </lyte-number> </template><template case="false"> <lyte-number id="{{item[&quot;SysrefName&quot;]}}" class="tp_BoxInput w100per {{if(item[\'isMandatory\'],\'mandatoryField\',\'\')}}" lt-prop-appearance="box" lt-prop-max="{{item[&quot;MaxValue&quot;]}}" lt-prop-min="{{item[&quot;MinValue&quot;]}}" lt-prop-step="{{item[&quot;StepValue&quot;]}}" lt-prop-placeholder="{{item[&quot;PlaceHolder&quot;]}}" lt-prop-validate-on-input="true" lt-prop-pattern=".+" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </lyte-number> </template></template> </template><template case="multilinetext"> <template is="if" value="{{expHandlers(mode,\'==\',&quot;view&quot;)}}"><template case="true"> <lyte-input id="{{item[&quot;SysrefName&quot;]}}" class="w100per {{if(item[\'isMandatory\'],\'mandatoryField\',\'\')}}" lt-prop-maxlength="{{if(item[\'maxLength\'],item[\'maxLength\'],1000)}}" lt-prop-appearance="box" lt-prop-type="textarea" lt-prop-text-area-resize="{&quot;vertical&quot; : true , &quot;horizontal&quot; : false}" lt-prop-disabled="true" value="-" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </lyte-input> </template><template case="false"> <lyte-input id="{{item[&quot;SysrefName&quot;]}}" class="w100per {{if(item[\'isMandatory\'],\'mandatoryField\',\'\')}}" lt-prop-maxlength="{{if(item[\'maxLength\'],item[\'maxLength\'],1000)}}" lt-prop-appearance="box" lt-prop-type="textarea" lt-prop-text-area-resize="{&quot;vertical&quot; : true , &quot;horizontal&quot; : false}" lt-prop-placeholder="{{item[&quot;PlaceHolder&quot;]}}" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </lyte-input> </template></template> </template><template case="password"> <template is="if" value="{{expHandlers(mode,\'==\',&quot;view&quot;)}}"><template case="true"> <input type="password" class="inputTxtBox pR5 w100per" maxlength="50" name="{{item[&quot;SysrefName&quot;]}}" id="{{item[&quot;SysrefName&quot;]}}" disabled="true" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </template><template case="false"> <input type="password" autocomplete="nope" class="inputTxtBox pR5 w100per" id="passwordId" maxlength="50" name="{{item[&quot;SysrefName&quot;]}}" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </template></template> </template><template case="checkbox"> <div class="flex"> <template is="if" value="{{expHandlers(mode,\'==\',&quot;view&quot;)}}"><template case="true"> <span id="{{item[&quot;SysrefName&quot;]}}" class="false_ipicon checkboxInput_view" data-zcqa="{{item[&quot;SysrefName&quot;]}}"></span> <span class="mL10">{{getI18n(item["fieldLabel"])}}</span> </template><template case="false"> <lyte-checkbox lt-prop-name="{{item[&quot;SysrefName&quot;]}}" id="{{item[&quot;SysrefName&quot;]}}" lt-prop-label="{{getI18n(item[&quot;fieldLabel&quot;])}}" data-zcqa="{{item[&quot;SysrefName&quot;]}}"></lyte-checkbox> </template></template> </div> </template><template case="picklist"> <pb-picklist mode="{{mode}}" is-mandatory="{{item[\'isMandatory\']}}" id="{{item[&quot;SysrefName&quot;]}}" class="pR5 w100per" sysref-name="{{item[&quot;SysrefName&quot;]}}" options="{{item[&quot;options&quot;]}}" default-option-ref-name="{{item[&quot;defaultOptionRefName&quot;]}}" default-options="{{getDefaultOptions(sysrefVsDefaultOptions,item[\'SysrefName\'])}}" option-promise-fn="{{item[&quot;optionPromiseFn&quot;]}}" option-promise-fn-arg="{{item[&quot;optionPromiseFnArg&quot;]}}"></pb-picklist> </template><template case="multiselect"> <pb-picklist type="multiple" mode="{{mode}}" id="{{item[&quot;SysrefName&quot;]}}" class="pR5 w100per" sysref-name="{{item[&quot;SysrefName&quot;]}}" options="{{item[&quot;options&quot;]}}" default-option-ref-name="{{item[&quot;defaultOptionRefName&quot;]}}" default-options="{{getDefaultOptions(sysrefVsDefaultOptions,item[\'SysrefName\'])}}" option-promise-fn="{{item[&quot;optionPromiseFn&quot;]}}" option-promise-fn-arg="{{item[&quot;optionPromiseFnArg&quot;]}}"></pb-picklist> </template><template case="audio_file"> <pb-picklist show-attach-file="true" mode="{{mode}}" id="{{item[&quot;SysrefName&quot;]}}" class="pR5 w100per" sysref-name="{{item[&quot;SysrefName&quot;]}}" options="{{item[&quot;options&quot;]}}" default-option-ref-name="{{item[&quot;defaultOptionRefName&quot;]}}" default-options="{{getDefaultOptions(sysrefVsDefaultOptions,item[\'SysrefName\'])}}" option-promise-fn="{{item[&quot;optionPromiseFn&quot;]}}" option-promise-fn-arg="{{item[&quot;optionPromiseFnArg&quot;]}}"></pb-picklist> </template><template case="relationmap"> <pb-relationmap id="{{item[&quot;SysrefName&quot;]}}" mode="{{mode}}" sysref-name="{{item[&quot;SysrefName&quot;]}}" primary_options_label="{{item[&quot;primaryOptionsLabel&quot;]}}" secondary_options_label="{{item[&quot;secondaryOptionsLabel&quot;]}}" relation_type="{{item[&quot;relation_type&quot;]}}" primary_options="{{getOptionArr(item[&quot;primary_options&quot;])}}" secondary_options="{{item[&quot;secondary_options&quot;]}}" sysvsvaluemap="{{getSysrefVsValue(sysrefVsValue,item[\'SysrefName\'])}}"></pb-relationmap> </template><template case="mergeFieldsInput"> <template is="if" value="{{expHandlers(mode,\'==\',&quot;view&quot;)}}"><template case="true"> <lyte-input id="{{item[&quot;SysrefName&quot;]}}" class="tp_BoxInput w100per {{if(item[\'isMandatory\'],\'mandatoryField\',\'\')}}" lt-prop-appearance="box" lt-prop-disabled="true" lt-prop-value="-" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </lyte-input> </template><template case="false"> <pb-merge-input id="{{item[&quot;SysrefName&quot;]}}" class="tp_BoxInput w100per {{if(item[\'isMandatory\'],\'mandatoryField\',\'\')}}" sysref-name="{{item[&quot;SysrefName&quot;]}}" allowed-merge-fields="{{item[&quot;allowedMergeFields&quot;]}}"> </pb-merge-input> </template></template> </template><template case="hidden"> <input type="hidden" class="inputTxtBox pR5 w100per" name="{{item[&quot;SysrefName&quot;]}}" disabled="true" value="{{getSysrefVsValue(sysrefVsValue,item[\'SysrefName\'])}}" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </template><template default=""> <template is="if" value="{{expHandlers(mode,\'==\',&quot;view&quot;)}}"><template case="true"> <lyte-input name="{{item[&quot;SysrefName&quot;]}}" class="tp_BoxInput w100per {{if(item[\'isMandatory\'],\'mandatoryField\',\'\')}}" lt-prop-appearance="box" lt-prop-disabled="true" lt-prop-value="-" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </lyte-input> </template><template case="false"> <lyte-input id="textId" name="{{item[&quot;SysrefName&quot;]}}" class="tp_BoxInput w100per {{if(item[\'isMandatory\'],\'mandatoryField\',\'\')}}" lt-prop-appearance="box" data-zcqa="{{item[&quot;SysrefName&quot;]}}"> </lyte-input> </template></template> </template></template> <template is="if" value="{{item[&quot;warningMsg&quot;]}}"><template case="true"> <div class="callRecordBox_rc"> <span class="vat mT3 mR3 pb-ico-warning-triangle-lg pb_maskIcons pbicn_red_mask"></span> <span class="vam ig-info-box m0 mL5 dIB w90per">{{item["warningMsg"]}}</span> </div> </template></template> </div> </td> </tr></tbody></table></template></template>'}]}},default:{},actualTemplate:'<template is="if" value="{{item[&quot;fieldType&quot;] === &quot;relationmap&quot;}}"><template case="true" depth="3"><table><tbody><tr> <td class="alignRight pR15 pB20 vat pT0"><div class="pbLabelColor f15 w180"> {{item["fieldLabel"]}} </div></td> <td class="pB20"> <pb-relationmap id="{{item[&quot;SysrefName&quot;]}}" is-on-value-change-needed="{{item[&quot;isOnValueChangeNeeded&quot;]}}" field-label="{{item[&quot;fieldLabel&quot;]}}" mode="{{mode}}" sysref-name="{{item[&quot;SysrefName&quot;]}}" is-mandatory="{{item[&quot;isMandatory&quot;]}}" relation_type="{{item[&quot;relation_type&quot;]}}" primary_options="{{getOptionArr(item[&quot;primary_options&quot;])}}" secondary_options="{{item[&quot;secondary_options&quot;]}}" secondary_field_type="{{item[&quot;secondary_field_type&quot;]}}" primary_options_label="{{item[&quot;primaryOptionsLabel&quot;]}}" secondary_options_label="{{item[&quot;secondaryOptionsLabel&quot;]}}" sysvsvaluemap="{{getSysrefVsValue(sysrefVsValue,item[\'SysrefName\'])}}"></pb-relationmap> </td> </tr></tbody></table></template><template case="false" depth="3"><table><tbody><tr> <td is="if" lyte-if="true" value="{{item[&quot;fieldLabel&quot;]}}"></td> <td is="if" lyte-if="true" value="{{item[&quot;fieldType&quot;]}}"></td> </tr></tbody></table></template></template>'}],actualTemplate:'<template is="for" items="{{loginKey}}" item="item" index="index" depth="2"><table><tbody> <tr id="fieldRow_{{item[&quot;SysrefName&quot;]}}" data-sysrefname="{{item[&quot;SysrefName&quot;]}}" class="fieldRows"> <td is="if" lyte-if="true" value="{{expHandlers(item[&quot;fieldType&quot;],\'===\',&quot;relationmap&quot;)}}"></td> </tr> </tbody></table></template>',tagName:"TABLE"}],_observedAttributes:["loginKey","labeltdClass","valuetdClass","sysrefVsValue","sysrefVsActions","sysrefVsDefaultOptions","mode"],data:function(){return{loginKey:Lyte.attr("array"),labeltdClass:Lyte.attr("string",{default:"alignRight pR15 pB20"}),valuetdClass:Lyte.attr("string",{default:"pB20"}),sysrefVsValue:Lyte.attr("object"),sysrefVsActions:Lyte.attr("object"),sysrefVsDefaultOptions:Lyte.attr("object",{default:{}}),mode:Lyte.attr("string",{default:"edit"})}},initialiseComp:function(){var e=this.getData("sysrefVsValue");if(e)for(var t in e)e.hasOwnProperty(t)&&this.setInputValue(t,e[t]);this.showOrHideAction(),this.$node.addEventListener("input-change",this.showOrHideAction.bind(this)),$L(this.$node.querySelectorAll("input")).on("change",this.showOrHideAction.bind(this))}.observes("mode").on("didConnect"),resetCompValues:function(){var e=this.getData("sysrefVsValue");if(e)for(var t in e)e.hasOwnProperty(t)&&this.setInputValue(t,e[t]);this.showOrHideAction(),this.$node.addEventListener("input-change",this.showOrHideAction.bind(this)),$L(this.$node.querySelectorAll("input")).on("change",this.showOrHideAction.bind(this))},resetInputValue:function(e){var t=this.getData("sysrefVsValue");t&&t.hasOwnProperty(e)&&this.setInputValue(e,t[e])},showOrHideAction:function(){var e=this.getData("sysrefVsActions"),t="";if(e)for(var o in e)if(e.hasOwnProperty(o))for(var i=this.getInputValue(o),a=e[o],n=a.length,l=document.getElementById("userPreferencePopup"),s=0;s<n;s++){var r=a[s];if(r.value==i){if(r.showFields&&this.showOrHideFields(r.showFields,!0),r.hideOthers?(r.showFields.push(o),this.hideOtherFields(r.showFields)):r.hideFields&&this.showOrHideFields(r.hideFields,!1),r.errorMsg){var p=I18n.getMsg(r.errorMsg);t=""==t?p:t+"<br/>"+p}r.openCallerid&&(l&&l.ltProp("show",!1),zpb_config.showUserFrameView("addcalleridpopup"));break}}var d=this.$node.querySelector("#alertMsg");d&&(d.innerHTML=t,this.$node.querySelector("#alertInfo").style.display=""!=t?"block":"none")},showOrHideFields:function(e,t){for(var o=e.length,i=0;i<o;i++){var a=e[i];this.$node.querySelector("#fieldRow_"+a).style.display=t?"table-row":"none"}},hideOtherFields:function(e){for(var t=Array.prototype.slice.call(this.$node.querySelectorAll(".fieldRows")),o=t.length,i=0;i<o;i++){var a=t[i],n=$L(a).data("sysrefname");-1==e.indexOf(n)&&(a.style.display="none")}},getInputValue:function(e){var t,o,i;if(t=this.$node.querySelector('input[name="'+e+'"]'))return"none"!=t.style.display?"checkbox"==t.type?t.checked:t.value:null;if(o=this.$node.querySelector('lyte-input[id="'+e+'"]'))return $L(o).is(":visible")?o.getData("ltPropValue"):null;if(o=this.$node.querySelector('lyte-number[id="'+e+'"]'))return $L(o).is(":visible")?o.getData("ltPropValue"):null;if(i=this.$node.querySelector('lyte-dropdown[id="'+e+'"]')){if($L(i).is(":visible")){var a=i.getData("ltPropSelected");return a&&"string"==typeof a&&-1!==["multiple","multisearch"].indexOf(i.getData("ltPropType"))&&(a=JSON.parse(a)),a}if("DEFAULT_DEPARTMENT"===e)return 0}else{if(o=this.$node.querySelector('pb-relationmap[id="'+e+'"]'))return(o=o.component).getDataasJSON(e);if(o=this.$node.querySelector('pb-merge-input[id="'+e+'"]'))return o.component.getSelectedValue()}return null},setInputValue:function(e,t){var o,i,a,n,l;(o=this.$node.querySelector('input[name="'+e+'"]'))?"checkbox"==o.type?o.checked=t:o.value=t:(i=this.$node.querySelector('lyte-input[id="'+e+'"]'))||(i=this.$node.querySelector('lyte-number[id="'+e+'"]'))?i.setData("ltPropValue",t):(a=this.$node.querySelector('lyte-dropdown[id="'+e+'"]'))?(this.$node.querySelector('pb-picklist[id="'+e+'"]').setData("defaultOptionRefName",t),a.setData("ltPropSelected",t)):(n=this.$node.querySelector('span[id="'+e+'"]'))?(n.classList.remove("true_ipicon"),n.classList.remove("false_ipicon"),n.classList.add(t+"_ipicon")):(l=this.$node.querySelector('pb-relationmap[id="'+e+'"]'))?l.setData("sysvsvaluemap",t):(i=this.$node.querySelector('pb-merge-input[id="'+e+'"]'))&&i.component.setSelectedValue(t)},getAllVisibleInputValue:function(){var e=Array.prototype.slice.call(this.$node.querySelectorAll(".fieldRows")).filter((function(e){return"none"!=e.style.display})),t={};if(e)for(var o=e.length,i=0;i<o;i++){var a=e[i],n=$L(a).data("sysrefname");t[n]=this.getInputValue(n)}return t},validateAllVisibleInputValue:function(){var e=this.getAllVisibleInputValue(),t=this.getData("loginKey"),o=this.getData("ivrOptions"),i=0;void 0!==o&&(i=o.length);for(var a=t.length,n=!0,l=0;l<a;l++){var s=t[l],r=s.SysrefName;e.hasOwnProperty(r)&&(s.isMandatory&&COMMON_UTILS.isEmpty(e[r])?(n=!1,this.$node.querySelector("#fieldRow_"+r).classList.add("errorState")):"undefined"==typeof inbuiltTelephony||inbuiltTelephony.validateIVRInput(e[r])?this.$node.querySelector("#fieldRow_"+r).classList.remove("errorState"):(n=!1,this.$node.querySelector("#fieldRow_"+r).classList.add("errorState")))}if(o)for(l=0;l<i;l++){var p=t[l];COMMON_UTILS.isEmpty(p.value)&&COMMON_UTILS.isEmpty(p.key)&&(n=!1)}return n}}),Lyte.Component.register("outbound-callerid-popup",{_template:'<template tag-name="outbound-callerid-popup" id="outbound-callerid-popup"> <div class="preferences-header f24">{{getI18n("phonebridge.provider.preference.addcallerid")}}</div> <lyte-modal-content> <div class="mB15"> <div class="filter-form-label">{{getI18n("phonebridge.provider.inbuilt.phonenumber")}}</div> <div class="filter-form-field"> <div class="ignite-form-field-input"> <lyte-input lt-prop-appearance="box" id="phoneNum" name="phoneNum" lt-prop-pattern="^\\+[0-9]?()[0-9](\\s|\\S)(\\d[0-9]{9})$" lt-prop-title="Enter Phonenumber with country code" lt-prop-tooltip-config="{&quot;position&quot; : &quot;bottom&quot;}"></lyte-input> </div> </div> </div> <div id="Validationcode" style="display: none; text-align: center"></div> <br> <div class="calleridwarningBox w100per flex call-recording-info dF"> <span class="vam warnIcon_rc_callerid pb-ico-warning-triangle-lg pb_maskIcons pbicn_red_mask mR3"></span> <span class="warnIconTxt_rc vam ig-info-box mL5">{{getI18n("phonebridge.provider.inbuilt.callerid.note")}}</span></div> <lyte-messagebox id="verificationStatus" lt-prop-type="error"></lyte-messagebox> </lyte-modal-content> <div class="callerid-footer"> <input id="verify" type="button" onclick="{{action(\'validateNumber\')}}" class="pref_bluebutton" value="Verify"> <input type="button" onclick="PhoneBridgeUtil.cancelCallerId()" class="pref_greybutton" value="{{getI18n(\'phonebridge.provider.preference.Close\')}}"> </div> </template>',_dynamicNodes:[{type:"text",position:[1,0]},{type:"text",position:[3,1,1,0]},{type:"componentDynamic",position:[3,1,3,1,1]},{type:"text",position:[3,7,3,0]},{type:"componentDynamic",position:[3,9]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"attr",position:[5,3]}],_observedAttributes:["loginKey","sysrefVsValue","sysrefVsActions","saveFunc","isDefaultOutgoing","outboundcallerid","isVerified","verificationStatus"],data:function(){return{loginKey:Lyte.attr("array"),sysrefVsValue:Lyte.attr("object"),sysrefVsActions:Lyte.attr("object"),saveFunc:Lyte.attr("string",{default:"zpb_config.saveCallerId(event)"}),isDefaultOutgoing:Lyte.attr("boolean",{default:!1}),outboundcallerid:Lyte.attr("string"),isVerified:Lyte.attr("boolean",{default:!1}),verificationStatus:Lyte.attr("string")}},methods:{enableDO:function(){this.setData("isDefaultOutgoing",!0)},disableDO:function(){this.setData("isDefaultOutgoing",!1)},enableSave:function(){document.getElementById("updateOutgoingCallerId").ltProp("disabled",!1)},onSetCallerId:function(e){if(COMMON_UTILS.print(e),"success"===e.message)PhoneBridgeUtil.cancelCallerId(),COMMON_UTILS.sendMessageToParentWindow({action:"showSuccessMessage",data:I18n.getMsg("phonebridge.provider.preference.Phonenumberverified")}),zpb_twilio.getVerifiedNumbers().then((function(){setTimeout((function(){zpb_twilio.defaultOptionRefName=e.callerid,zpb_config.showCallerId()}),1e3)}));else{var t=I18n.getMsg("phonebridge.provider.preference.Failedtoverify");document.getElementById("verificationStatus").ltProp({message:t,show:!0}),setTimeout(zpb_config.showCallerId(),3e3)}}},actions:{onSave:function(){},validateNumber:function(e){var t=document.getElementById("phoneNum").component.data.ltPropValue;if(/^\+[1-9]\d{1,14}$/.test(t))zpb_config.saveCallerId(e);else{var o=I18n.getMsg("phonebridge.provider.inbuilt.preference.invalidPhoneNumber");document.getElementById("verificationStatus").ltProp({message:o,show:!0})}}}}),Lyte.Component.register("set-callerid",{_template:'<template tag-name="set-callerid" id="set-callerid"> <lyte-modal lt-prop-wrapper-class="calleridmodal center-freeze center-modal bulkaction-box" lt-prop-width="auto" lt-prop-height="auto" lt-prop-max-width="100%" lt-prop-max-height="60%" lt-prop-show-close-button="false" lt-prop-offset="{&quot;top&quot; : &quot;50px&quot;,&quot;left&quot; : &quot;center&quot;}" lt-prop-transition="{&quot;animation&quot;:&quot;slideFromTop&quot;,&quot;duration&quot;:&quot;0.5&quot;}" lt-prop-freeze="false" lt-prop-scroll="{&quot;horizontal&quot; : true, &quot;vertical&quot; : true}"> <div class="preferences-header f24"> {{getI18n("phonebridge.provider.preference.setcallerid")}}</div> <div class="cB"></div> <div class="clearB"></div> <lyte-modal-content> <div id="progressBar" class="loadingsplash" style="{{if(phoneBridgeloading,&quot;display:block;&quot;,&quot;display:none;&quot;)}} z-index: 1000;"></div> <div class="mB10"> <lyte-messagebox id="inbuilt_message_box_error_callerid" lt-prop-type="error"></lyte-messagebox> <lyte-messagebox id="inbuilt_message_box_success_callerid" lt-prop-type="success"></lyte-messagebox> <div class="filter-form-label">{{getI18n("phonebridge.provider.preference.callerid")}}</div> <div class="filter-form-field"> <lyte-dropdown id="callerIds" class="callerIds" lt-prop-position="down" lt-prop-search="true" lt-prop-options="{{verifiedCallerIds}}" lt-prop-placeholder="{{getI18n(&quot;phonebridge.provider.inbuilt.choosephonenumber&quot;)}}" lt-prop-selected="{{phoneNum}}" lt-prop-display-value="{{phoneNum}}" on-option-selected="{{method(\'showFinalnumber\')}}" lt-prop-yield="true" lt-prop-animate="true" lt-prop-disabled="true"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="calleridscope ignite-form-drop-box crmBoxDropbox callerIds"> <lyte-drop-header> <lyte-search style="width:100%" lt-prop-placeholder="{{getI18n(&quot;phonebridge.provider.searchstring&quot;)}}" lt-prop-query-selector="{&quot;scope&quot;:&quot;.calleridscope&quot;,&quot;search&quot;:&quot;lyte-drop-item&quot;}" on-search="{{method(\'showNoResult\')}}" lt-prop-appearance="box"> </lyte-search> </lyte-drop-header> <lyte-drop-body> <a onclick="{{action(\'openAddCallerIdPopup\')}}"><lyte-drop-item>+ New Caller Id</lyte-drop-item> </a><template is="for" items="{{verifiedCallerIds}}" item="item" index="indeval"> <lyte-drop-item id="{{item[\'phone_number\']}}" data-value="{{item[\'phone_number\']}}"> {{item[\'phone_number\']}}</lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </div> </div> </lyte-modal-content> <div class="preferences-footer"> <input id="saveCallerid" type="button" onclick="{{action(\'updateOutgoingCallerId\')}}" class="pref_bluebutton" value="{{getI18n(\'phonebridge.save.propercase\')}}" disabled="" style="opacity: 0.5"> <input type="button" onclick="PhoneBridgeUtil.cancelCallerId()" class="pref_greybutton" value="{{getI18n(\'phonebridge.cancel.propercase\')}}"> </div> </lyte-modal> </template>',_dynamicNodes:[{type:"text",position:[1,1,1]},{type:"attr",position:[1,7,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["''",{type:"helper",value:{name:"if",args:["phoneBridgeloading","'display:block;'","'display:none;'"]}},"' z-index: 1000;'"]}}}},{type:"componentDynamic",position:[1,7,3,1]},{type:"componentDynamic",position:[1,7,3,3]},{type:"text",position:[1,7,3,5,0]},{type:"attr",position:[1,7,3,7,1]},{type:"registerYield",position:[1,7,3,7,1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"componentDynamic",position:[1,3,1,0]},{type:"attr",position:[1,3,2]},{type:"for",position:[1,3,2],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,7,3,7,1]},{type:"componentDynamic",position:[1,7]},{type:"attr",position:[1,9,1]},{type:"attr",position:[1,9,3]},{type:"componentDynamic",position:[1]}],_observedAttributes:["verifiedCallerIds","oldjsondata","isSearch","isScroll","isScrollEnd","isInitialSearch","isNAN","nextSelected","initialSearchValue","resetComponent","resetSearchData","phoneNum","phoneBridgeloading"],data:function(){return{verifiedCallerIds:Lyte.attr("array",{default:[]}),oldjsondata:Lyte.attr("array",{default:[]}),isSearch:Lyte.attr("boolean",{default:!0}),isScroll:Lyte.attr("boolean",{default:!1}),isScrollEnd:Lyte.attr("boolean",{default:!0}),isInitialSearch:Lyte.attr("boolean",{default:!0}),isNAN:Lyte.attr("boolean",{default:!1}),nextSelected:Lyte.attr("boolean",{default:!1}),initialSearchValue:Lyte.attr("boolean",{default:!0}),resetComponent:Lyte.attr("boolean",{default:!0}),resetSearchData:Lyte.attr("boolean",{default:!1}),phoneNum:Lyte.attr("string",{default:PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.defaultOrg].outgoingCallerId}),phoneBridgeloading:Lyte.attr("boolean",{default:!0})}},init:function(){this.executeMethod("showVerifiedNumbers")},methods:{showNoResult:function(e){if(0==e.length){if(document.querySelector(".noresultstyle"))return;var t=document.querySelector(".parentscope"),o=document.createElement("div");o.setAttribute("class","noresultstyle"),o.textContent="No Results Found",t.appendChild(o)}else{var i=document.querySelector(".noresultstyle");i&&i.remove()}},showFinalnumber:function(){var e=document.getElementById("callerIds").ltProp("selected");this.setData("phoneNum",e),document.getElementById("saveCallerid").removeAttribute("disabled"),document.getElementById("saveCallerid").removeAttribute("style")},loadMoreData:function(){var e=arguments[0].target;e.scrollTop,e.offsetHeight,e.scrollHeight;this.getData("isScrollEnd")&&e.scrollTop+e.offsetHeight==e.scrollHeight&&(this.setData("isScroll",!0),this.getData("resetSearchData")?this.executeMethod("showSelectedNumbers"):this.executeMethod("showVerifiedNumbers"))},showVerifiedNumbers:function(){var e=PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.defaultOrg].providerId;obj={actionUrl:"/phonebridge/config/verifiednumbers",params:{providerId:e},type:"GET",authentication:"cookies",headers:{"X-PB-ORG":PhoneBridgeUtil.defaultOrg,"Content-Type":"application/x-www-form-urlencoded"}},COMMON_UTILS.fetchRequest(obj).then(function(e){var t=e;if(this.getData("isScroll")){this.setData("isScrollEnd",!0);var o=this.getData("oldjsondata"),i=e;t=o.concat(i)}this.getData("isNAN")&&(t.length=0,this.setData("isNAN",!1)),this.setData("verifiedCallerIds",t),this.setData("oldjsondata",t),document.getElementById("callerId").style.display="flex",this.setData("phoneBridgeloading",!1),document.getElementById("callerIds").ltProp("disabled",!1)}.bind(this))},selectVerifiednumber:function(e){document.getElementById(e).selected=!0,document.getElementById("set-callerid").setData("phoneNum",e),document.getElementById("saveCallerid").removeAttribute("disabled"),document.getElementById("saveCallerid").removeAttribute("style")}},actions:{onSave:function(){},openAddCallerIdPopup:function(){zpb_config.showUserFrameView("addcalleridpopup")},updateOutgoingCallerId:function(){var e=document.getElementById("callerIds").ltProp("selected");obj={actionUrl:"/phonebridge/config/updateDefaultOutgoing",type:"POST",authentication:"cookies",headers:{"Content-Type":"application/x-www-form-urlencoded","X-PB-ORG":PhoneBridgeUtil.defaultOrg,"X-ZCSRF-TOKEN":"phonebridgecsrparam="+COMMON_UTILS.getCookie("phonebridgecsr")},params:{phoneNum:e,providerId:PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.defaultOrg].providerId}},COMMON_UTILS.fetchRequest(obj).then(function(t){if("success"==t){var o=I18n.getMsg("phonebridge.provider.inbuilt.callerid.success");document.getElementById("inbuilt_message_box_success_callerid").ltProp({message:o,show:!0}),PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.defaultOrg].outgoingCallerId=e}else{o=I18n.getMsg("phonebridge.provider.inbuilt.callerid.failure");document.getElementById("inbuilt_message_box_error_callerid").ltProp({message:o,show:!0})}setTimeout(PhoneBridgeUtil.cancelCallerId,2e3)}.bind(this))}}}),Lyte.Component.register("calls-in-queue",{_template:'<template tag-name="calls-in-queue"> <div class="callConvoQue dN"> <div class="callInQueue callProcessDiv dN"> <div class="callHeadBand p20 pL25 f20"> {{getI18n("phonebridge.provider.inbuilt.callsinqueue")}} <div class="minimizeCloseIcon_pb" onclick="{{action(\'minimizeCalCq\',this)}}"></div> </div> <div class="CallTableHolder"> <lyte-table lt-prop-yield="true" class="noBorderTable"> <template is="registerYield" yield-name="yield"> <lyte-table-structure> <lyte-thead> <lyte-tr class="conQrows"> <template is="for" items="{{callQheader}}" item="list" index="indexVal"> <lyte-th class="conQTh"> {{list.data}} </lyte-th> </template> </lyte-tr> </lyte-thead> <lyte-tbody> <template is="if" value="{{expHandlers(callQBody.length,\'!=\',0)}}"><template case="true"> <template is="for" items="{{callQBody}}" item="list" index="indexVal1"> <lyte-tr class="conQrows" id="{{list.CallRefId}}" data-zcqa="callQRow_{{indexVal1}}" onclick="{{action(\'showqpopup\',list.CallRefId,list.Callerdetails,this)}}"> <lyte-td class="conQTd"> <div class="pR dIB"> <template is="if" value="{{list.Callerdetails.name}}"><template case="true"> <lyte-text class="callNameHolder">{{list.Callerdetails.name}} </lyte-text> </template><template case="false"> <lyte-text class="callNameHolder">{{list.Callerdetails.phonenumber}} </lyte-text> </template></template> <span id="callQMore_{{indexVal1}}" data-zcqa="callQMore_{{indexVal1}}" class="callStateMore callStateMoreIco svgIcons ico-dots-circle-filled dIB vam cP" onclick="{{action(\'callQMoreOpen\',this,list.CallRefId,list.From)}}"></span> </div> </lyte-td> <lyte-td class="conQTd"> {{list.To}} <div class="f13 callPathDiv mT5">{{list.Menu}}</div> </lyte-td> <lyte-td id="callQtime_{{list.CallRefId}}" class="conQTd"> </lyte-td> </lyte-tr> </template> </template><template case="false"> <lyte-tr class="conQrows eventNone"> <lyte-td></lyte-td> <lyte-td class="aligncenter"> <div class="pR dIB p20 pbNotFoundColor">No Calls in Queue</div> </lyte-td> <lyte-td></lyte-td> </lyte-tr> </template></template> </lyte-tbody> </lyte-table-structure> </template> </lyte-table> </div> <lyte-popover id="qpopup" lt-prop-show="false" lt-prop-height="auto" lt-prop-width="300px" lt-prop-content-padding="0px" lt-prop-show-close-button="true" lt-prop-freeze="false" lt-prop-placement="left" lt-prop-close-on-body-click="true" lt-prop-close-on-escape="true" lt-prop-wrapper-class="wrapperconvqPopOver" on-before-close="{{method(&quot;closeconvqpopup&quot;,clientcallid)}}" lt-prop-animation="zoom"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <call-pop callerdetails="{{callerdetails}}" phonenumber="{{callerdetails.phonenumber}}" orgid="{{orgid}}" clientcallid="{{clientcallid}}" searchdata="{{searchdata}}" viewcallsinqueue="{{viewCallsinQueue}}" style="display:block;"></call-pop> </lyte-popover-content> </template> </lyte-popover> <lyte-popover id="callQMore" lt-prop-wrapper-class="callOptList" lt-prop-height="auto" lt-prop-type="box" lt-prop-duration="400" lt-prop-content-padding="0px" lt-prop-show-close-button="false" lt-prop-freeze="false" lt-prop-close-on-body-click="true" lt-prop-close-on-escape="true" lt-prop-placement="bottom" on-before-close="{{method(&quot;callConvoMoreClose&quot;)}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <ul class="callConvoMoreList"> <li class="conQli" onclick="{{action(\'answercall\',\'callQMore\')}}" data-zcqa="answerthiscall">{{getI18n("phonebridge.provider.inbuilt.answerthiscall")}}</li> </ul> </lyte-popover-content> </template> </lyte-popover> </div> <div class="callInConver callProcessDiv dN"> <div class="callHeadBand p20 f20"> {{getI18n("phonebridge.provider.inbuilt.callsinconv")}} <div class="minimizeCloseIcon_pb" onclick="{{action(\'minimizeCalCq\',this)}}"> </div> </div> <div class="CallTableHolder"> <lyte-table lt-prop-yield="true" class="noBorderTable"> <template is="registerYield" yield-name="yield"> <lyte-table-structure> <lyte-thead> <lyte-tr> <template is="for" items="{{callConvheader}}" item="list" index="indexVal"> <lyte-th class="conQTh"> {{list.data}} </lyte-th> </template> </lyte-tr> </lyte-thead> <lyte-tbody> <template is="if" value="{{expHandlers(callConvBody.length,\'!=\',0)}}"><template case="true"> <template is="for" items="{{callConvBody}}" item="list" index="indexVal1"> <lyte-tr class="conQrows" id="{{list.Call_RefID}}" data-zcqa="callConvRow_{{indexVal1}}" onclick="{{action(\'showconvqpopup\',list.Call_RefID,list.Callerdetails,this)}}"> <lyte-td class="conQTd"> <div class="pR dIB"> <template is="if" value="{{expHandlers(list.Status,\'==\',\'hold\')}}"><template case="true"> <span class="tpcallPause dIB"></span> </template><template case="false"><template is="if" value="{{expHandlers(list.Call_Type,\'==\',\'outgoing\')}}"><template case="true"> <span class="tPcallOut dIB"></span> </template><template case="false"> <span class="tPcallIn dIB"></span> </template></template></template></template> <template is="if" value="{{list.Callerdetails.name}}"><template case="true"> <lyte-text class="callNameHolder">{{list.Callerdetails.name}} </lyte-text> </template><template case="false"> <lyte-text class="callNameHolder">{{list.Callerdetails.phonenumber}} </lyte-text> </template></template> <span id="callConMore_{{indexVal1}}" class="callStateMoreIco ico-dots-circle-filled dIB vam mL5 cP" onclick="{{action(\'convoMoreOpen\',this)}}"></span> </div> </lyte-td> <lyte-td id="callContime_{{list.Call_RefID}}" class="conQTd"> </lyte-td> <lyte-td class="conQTd"> {{list.User}} </lyte-td> </lyte-tr> </template> </template><template case="false"> <lyte-tr class="conQrows eventNone"> <lyte-td></lyte-td> <lyte-td class="aligncenter"> <div class="pR dIB p20 pbNotFoundColor">No Calls in Conversation</div> </lyte-td> <lyte-td></lyte-td> </lyte-tr> </template></template> </lyte-tbody> </lyte-table-structure> </template> </lyte-table> </div> <lyte-popover id="convqpopup" lt-prop-show="false" lt-prop-height="auto" lt-prop-width="300px" lt-prop-content-padding="0px" lt-prop-show-close-button="true" lt-prop-freeze="false" lt-prop-placement="left" lt-prop-close-on-escape="true" lt-prop-wrapper-class="wrapperconvqPopOver" on-before-close="{{method(&quot;closeconvqpopup&quot;,clientcallid)}}" lt-prop-animation="zoom"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <call-pop callerdetails="{{callerdetails}}" phonenumber="{{callerdetails.phonenumber}}" orgid="{{orgid}}" clientcallid="{{clientcallid}}" searchdata="{{searchdata}}" viewcallsinqueue="{{viewCallsinQueue}}" style="display:block;"></call-pop> </lyte-popover-content> </template> </lyte-popover> </div> </div> <lyte-popover id="callConvoMore" lt-prop-height="auto" lt-prop-duration="400" lt-prop-content-padding="0px" lt-prop-show-close-button="false" lt-prop-freeze="false" lt-prop-placement="right" on-before-close="{{method(&quot;callConvoMoreClose&quot;)}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <ul class="callConvoMoreList"> <li class="conQli" onclick="{{action(\'close\',\'callConvoMore\')}}">Request to whisper Mathikumar</li> <li class="conQli" onclick="{{action(\'close\',\'callConvoMore\')}}">Moniter this call</li> <li class="conQli" onclick="{{action(\'close\',\'callConvoMore\')}}">Join this call</li> </ul> </lyte-popover-content> </template> </lyte-popover> </template>',_dynamicNodes:[{type:"text",position:[1,1,1,1]},{type:"attr",position:[1,1,1,3]},{type:"registerYield",position:[1,1,3,1,1],dynamicNodes:[{type:"attr",position:[1,1,1,1]},{type:"for",position:[1,1,1,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1,1]},{type:"if",position:[1,1,1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,1,1,3]},{type:"componentDynamic",position:[1,1]},{type:"text",position:[1,3,1]},{type:"text",position:[1,3,3,0]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]}]},false:{dynamicNodes:[{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,3,1]},{type:"attr",position:[1,1,5]},{type:"registerYield",position:[1,1,5,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,5]},{type:"attr",position:[1,1,7]},{type:"registerYield",position:[1,1,7,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"text",position:[1,1,1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,7]},{type:"text",position:[1,3,1,1]},{type:"attr",position:[1,3,1,3]},{type:"registerYield",position:[1,3,3,1,1],dynamicNodes:[{type:"attr",position:[1,1,1,1]},{type:"for",position:[1,1,1,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1,1]},{type:"if",position:[1,1,1,1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,1,3]},{type:"if",position:[1,1,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,1,1,5]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]},{type:"text",position:[1,5,1]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]}]},false:{dynamicNodes:[{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,3,3,1]},{type:"attr",position:[1,3,5]},{type:"registerYield",position:[1,3,5,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,3,5]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"attr",position:[1,1,3]},{type:"attr",position:[1,1,5]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}],_observedAttributes:["features","callConvheader","callConvBody","isCallConnected","opt","callQheader","callQBody","callRefId","fromNumber","noOfCallsInConv","noOfCallsInQueue","upto","uptoId","startIndex","endIndex","searchdata","clientcallid","orgid","callerdetails","viewCallsinQueue"],data:function(){return{features:Lyte.attr("array"),callConvheader:Lyte.attr("array",{default:[{data:"Call From/To",bodyData:"callid"},{data:"Duration",bodyData:"callrefid"},{data:"User",bodyData:"calltype"}]}),callConvBody:Lyte.attr("array"),isCallConnected:Lyte.attr("boolean",{default:!1}),opt:Lyte.attr("string"),callQheader:Lyte.attr("array",{default:[{data:"Call From",bodyData:"callid"},{data:"Call To",bodyData:"callrefid"},{data:"Wait Time",bodyData:"calltype"}]}),callQBody:Lyte.attr("array"),callRefId:Lyte.attr("string"),fromNumber:Lyte.attr("string"),noOfCallsInConv:Lyte.attr("number",{default:0}),noOfCallsInQueue:Lyte.attr("number",{default:0}),upto:Lyte.attr("string"),uptoId:Lyte.attr("string"),startIndex:Lyte.attr("number",{default:0}),endIndex:Lyte.attr("number",{default:2}),searchdata:Lyte.attr("object"),clientcallid:Lyte.attr("string"),orgid:Lyte.attr("string"),callerdetails:Lyte.attr("object"),viewCallsinQueue:Lyte.attr("boolean",{default:!1})}},didConnect:function(){$L(".callConvoQue").removeClass("dN"),$L(".callProcessDiv").addClass("dN");var e=this.getData("opt");$L("."+e).removeClass("dN");var t=document.querySelector("calls-in-queue");"visible"===document.getElementById("multiCallDiv").style.visibility&&document.getElementById("callBarDiv").style.setProperty("z-index","325");if(t.setData("searchValue",""),"callInQueue"===e){var o={actionUrl:"/phonebridge/config/callsinqueue",params:{limit:10,search_by:"phone_number",search_value:"",serviceName:PhoneBridgeUtil.serviceName,serviceId:PhoneBridgeUtil.serviceID,uptoId:void 0===t.getData("uptoId")?"":t.getData("uptoId")},type:"GET",authentication:"cookies",headers:{"Content-Type":"application/x-www-form-urlencoded","X-ZCSRF-TOKEN":"phonebridgecsrparam="+COMMON_UTILS.getCookie("phonebridgecsr"),"X-PB-ORG":PhoneBridgeUtil.getCurrentOrg(),"X-SERVICE-ORG":PhoneBridgeUtil.serviceID,"X-SERVICE-NAME":PhoneBridgeUtil.serviceName}};COMMON_UTILS.fetchRequest(o).then((function(e){var o=e.CallsInQueue,i=o.length;t.setData("noOfCallsInQueue",e.total_records_count),t.setData("uptoId",e.uptoId),e=o,t.setData("callQBody",e);for(var a=0;a<i;a++){var n=o[a].Time,l=new Date(n),s=o[a].CallRefId,r=document.getElementById("callQtime_"+s);r&&(r.innerHTML=t.component.methods.getDuration(l))}var p=setInterval((()=>{for(var e=0;e<i;e++){var a=o[e].Time,n=new Date(a),l=o[e].CallRefId,s=document.getElementById("callQtime_"+l);s?s.innerHTML=t.component.methods.getDuration(n):clearInterval(p)}}),1e3)}))}else if("callInConver"===e){var i={actionUrl:"/phonebridge/config/activecalls",params:{limit:10,search_by:"phone_number",search_value:"",serviceName:PhoneBridgeUtil.serviceName,serviceId:PhoneBridgeUtil.serviceID,upto:void 0===t.getData("upto")?"":t.getData("upto")},type:"GET",authentication:"cookies",headers:{"Content-Type":"application/x-www-form-urlencoded","X-ZCSRF-TOKEN":"phonebridgecsrparam="+COMMON_UTILS.getCookie("phonebridgecsr"),"X-PB-ORG":PhoneBridgeUtil.getCurrentOrg(),"X-SERVICE-ORG":PhoneBridgeUtil.serviceID,"X-SERVICE-NAME":PhoneBridgeUtil.serviceName}};COMMON_UTILS.fetchRequest(i).then((function(e){for(var o=e.CallsInConversation,i=o.length,a=0;a<i;a++){null===o[a].CallFrom_To&&o.splice(a,1)}for(t.setData("upto",e.upto),t.setData("noOfCallsInConv",e.total_records_count),e=o,t.setData("callConvBody",e),i=o.length,a=0;a<i;a++){var n=o[a].Duration,l=new Date(parseInt(n)),s=o[a].Call_RefID,r=document.getElementById("callContime_"+s);r&&(r.innerHTML=t.component.methods.getDuration(l))}var p=setInterval((()=>{for(var e=0;e<i;e++){var a=o[e].Duration,n=new Date(a),l=o[e].Call_RefID,s=document.getElementById("callContime_"+l);s?s.innerHTML=t.component.methods.getDuration(n):clearInterval(p)}}),1e3)}))}},didDestroy:function(){clearInterval()},actions:{showconvqpopup:function(e,t,o){var i=$(o).attr("id");this.setData("clientcallid",PhoneBridgeUtil.getCurrentOrg()+"_"+e+"_conv"),this.setData("orgid",PhoneBridgeUtil.getCurrentOrg()),this.setData("callerdetails",t);var a=t,n={};n[a.servicename]={},n[a.servicename][a.serviceid]={},n[a.servicename][a.serviceid].portalname=a.portalname,n[a.servicename][a.serviceid].callerdetails=a,a.searchdata=n,this.setData("searchdata",n);var l=document.querySelector("#convqpopup");l.ltProp("originElem","#"+i),this.setData("viewCallsinQueue",!0),l.component.setData("ltPropBindToBody",!1),l.ltProp("show",!0);var s=l.component.$node.component.actualModalDiv.querySelector("call-pop");s.setData("searchdata",n),s.querySelector(".zpb-header").click(),s.setData("viewCallsinQueue",!0)},showqpopup:function(e,t,o){var i=$(o).attr("id");this.setData("clientcallid",e),this.setData("orgid",PhoneBridgeUtil.getCurrentOrg()),this.setData("callerdetails",t);var a=this.getData("callerdetails"),n={};n[a.servicename]={},n[a.servicename][a.serviceid]={},n[a.servicename][a.serviceid].portalname=a.portalname,n[a.servicename][a.serviceid].callerdetails=a,this.setData("searchdata",n);var l=document.querySelector("#qpopup");if(!1===document.getElementById("callQMore").ltProp("show")){l.ltProp("originElem","#"+i),l.component.setData("ltPropBindToBody",!1),l.ltProp("show",!0);var s=l.component.$node.component.actualModalDiv.querySelector("call-pop");s.querySelector(".zpb-header").click(),s.setData("viewCallsinQueue",!0)}},loadCallsInConv:function(){var e={actionUrl:"/phonebridge/config/activecalls",params:{limit:10,search_by:"phone_number",search_value:thiss.getData("searchValue"),upto:void 0===thiss.getData("upto")?"":thiss.getData("upto")},type:"GET",authentication:"cookies",headers:{"Content-Type":"application/x-www-form-urlencoded","X-ZCSRF-TOKEN":"phonebridgecsrparam="+COMMON_UTILS.getCookie("phonebridgecsr")}};COMMON_UTILS.fetchRequest(e).then((function(e){for(var t=e.CallsInConversation,o=t.length,i=0;i<o;i++){""===t[i].CallFrom_To&&t.splice(i,1)}thiss.setData("upto",e.upto),e=t,thiss.setData("callConvBody",e)}))},loadCallsInQueue:function(){var e={actionUrl:"/phonebridge/config/callsinqueue",params:{limit:10,search_by:"phone_number",search_value:thiss.getData("searchValue"),uptoId:void 0===thiss.getData("uptoId")?"":thiss.getData("uptoId")},type:"GET",authentication:"cookies",headers:{"Content-Type":"application/x-www-form-urlencoded","X-ZCSRF-TOKEN":"phonebridgecsrparam="+COMMON_UTILS.getCookie("phonebridgecsr")}};COMMON_UTILS.fetchRequest(e).then((function(e){thiss.setData("callQBody",e)}))},answercall:function(e){var t=document.querySelector("calls-in-queue"),o={actionUrl:"/phonebridge/calloperations/pickCall",params:{callRefID:t.getData("callRefId"),fromNumber:t.getData("fromNumber"),providerID:PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].providerId},type:"POST",authentication:"cookies",headers:{"Content-Type":"application/x-www-form-urlencoded","X-ZCSRF-TOKEN":"phonebridgecsrparam="+COMMON_UTILS.getCookie("phonebridgecsr"),"X-PB-ORG":PhoneBridgeUtil.getCurrentOrg()}};COMMON_UTILS.fetchRequest(o),document.getElementById(e).ltProp("show",!1),$L(".callStateMoreIco").removeClass("activeMore")},convoMoreOpen:function(e){var t=$(e),o=t.attr("id");t.addClass("activeMore");var i=document.getElementById("callConvoMore");i.ltProp("originElem","#"+o),i.ltProp("show",!0)},callQMoreOpen:function(e,t,o){var i=$(e),a=i.attr("id");i.addClass("activeMore"),this.setData("callRefId",t),this.setData("fromNumber",o);var n=document.getElementById("callQMore");n.ltProp("originElem","#"+a),n.ltProp("show",!0)},close:function(e){this.setData("searchdata",{}),document.getElementById(e).ltProp("show",!1),$L(".callStateMoreIco").removeClass("activeMore")},phonebar_filterAction:function(){var e=$(".filterSection_cr");e.hasClass("filterSectionClose")?e.removeClass("filterSectionClose"):e.addClass("filterSectionClose");var t={actionUrl:"/phonebridge/payment/callowner",params:{providerId:PhoneBridgeUtil.multiOrgData[PhoneBridgeUtil.getCurrentOrg()].providerId},type:"GET",authentication:"cookies",headers:{"X-PB-ORG":PhoneBridgeUtil.getCurrentOrg(),"X-SERVICE-ORG":PhoneBridgeUtil.serviceID,"X-SERVICE-NAME":PhoneBridgeUtil.serviceName,"Content-Type":"application/x-www-form-urlencoded"}};COMMON_UTILS.fetchRequest(t).then(function(e){void 0!==e&&this.setData("callOwnerData",e)}.bind(this));var o={actionUrl:"/phonebridge/config/ivrdata",params:{},type:"GET",authentication:"cookies",headers:{"X-PB-ORG":PhoneBridgeUtil.getCurrentOrg(),"X-SERVICE-ORG":PhoneBridgeUtil.serviceID,"X-SERVICE-NAME":PhoneBridgeUtil.serviceName,"Content-Type":"application/x-www-form-urlencoded"}};COMMON_UTILS.fetchRequest(o).then(function(e){if(this.setData("ivrjson",e),void 0!==e){for(var t=[],o=e.length,i=0;i<o;i++)for(var a in e[i])t.push(a);this.setData("phoneNumbersData",t)}}.bind(this));var i={actionUrl:"/phonebridge/config/menus",params:{},type:"GET",authentication:"cookies",headers:{"X-PB-ORG":PhoneBridgeUtil.getCurrentOrg(),"X-SERVICE-ORG":PhoneBridgeUtil.serviceID,"X-SERVICE-NAME":PhoneBridgeUtil.serviceName,"Content-Type":"application/x-www-form-urlencoded"}};COMMON_UTILS.fetchRequest(i).then(function(e){void 0!==e&&this.setData("isAllMenu",!0)}.bind(this))},minimizeCalCq:function(){if(clearInterval(),$L(".callConvoQue").addClass("dN"),document.getElementById("callBarDiv").style.display="none",PhoneBridgeUtil.closepopup(),Zoho.PhoneBridge.CallsArray.length>0){var e=Zoho.PhoneBridge.CallsArray[0];if(document.getElementById("callDiv"+e).classList.contains("zpb-currentOpenCall"))return;var t=$L("#callDiv"+e);t.removeClass("zpb-secondCallIncoming zpb-secondCall"),t.addClass("zpb-currentOpenCall");var o=$L("#pbContent_"+e);o.css("display","none");var i=$L("#pbContent_"+e+" .zpb-serviceSideBar");i.removeClass("zpb-serviceSideBarAnimate"),i.css("left","0"),o.slideDown((function(){i.addClass("zpb-serviceSideBarAnimate"),Zoho.PhoneBridge.UI.adjustMultiCallPopup()})),Zoho.PhoneBridge.UI.adjustMultiCallPopup(),Zoho.PhoneBridge.activeCall=e}else Zoho.PhoneBridge.activeCall=null}},methods:{callConvoMoreClose:function(){$L(".callStateMoreIco").removeClass("activeMore")},getDuration:function(e){var t=(new Date).getTime()-e.getTime();t/=1e3;var o=Math.floor(t%60),i=o<10?"0"+o:o+"",a=(t=Math.floor(t/60))%60,n=a<10?"0"+a:a+"",l=(t=Math.floor(t/60))%24+24*(t=Math.floor(t/24)),s=l<10?"0"+l:l+"";return"00"===s?n+":"+i:s+":"+n+":"+i},showAllPhoneNumbers:function(e,t){if("all"===t)this.setData("phoneNumberValue","All");else{this.setData("phoneNumberValue",t),this.setData("isActiveCalls",!0);for(var o=this.getData("ivrjson"),i=t,a=o.length,n=0;n<a;n++){var l=o[n];for(var s in l)if(s===i){var r=l[s],p=r.ASSOCIATED_CALL_GROUP;this.setData("callGroupJSON",p);var d=[];for(var c in p)for(var u=p[c],m=u.length,y=0;y<m;y++)d.push(u[y]);var g=r.default_outgoing_node;for(c in g){var h=g[c].CallId;d.push(h)}this.setData("callRefIdData",d),this.setData("isCallRefIds",!0);var f=r.IVR_GROUP;for(c in f)this.setData("isIVRConfig",!0);if(this.getData("isIVRConfig")){this.setData("ivrGroupJSON",f);var v=[],b=f.default_incoming_node;for(c in f)if(b===c)for(var D=(u=f[c]).length,I=0;I<D;I++){var C={},P=u[I].menu.split(" ")[1],O=u[I].next_node,N=!0;f.hasOwnProperty(O)&&(N=!1),C.menu=P,C.nodeId=O,C.isAssignUser=N,v.push(C),this.setData("isAllMenu",!0)}this.setData("menuData",v)}}}}},closeconvqpopup:function(e){this.setData("searchdata",{}),-1!==Zoho.PhoneBridge.CallsArray.indexOf(e)&&Zoho.PhoneBridge.CallsArray.splice(Zoho.PhoneBridge.CallsArray.indexOf(e),1)}},showConQ:function(e){$L(".callConvoQue").removeClass("dN"),$L(".callProcessDiv").addClass("dN"),$L("."+e).removeClass("dN")}}),store.registerModel("active_calls",{id:Lyte.attr("string"),username:Lyte.attr("string"),phone:Lyte.attr("string")}),store.registerAdapter("active_calls",{namespace:"phonebridge/resources/"}),store.registerSerializer("active_calls",{payloadKey:function(){return"data"},extractMeta:function(e){var t=e.data;return delete e.data,t},serialize:function(e){return[e]}}),store.registerModel("agents",{id:Lyte.attr("string"),username:Lyte.attr("string"),phone:Lyte.attr("string")}),store.registerAdapter("agents",{namespace:"phonebridge/resources/"}),store.registerSerializer("agents",{payloadKey:function(){return"data"},extractMeta:function(e){var t=e.data;return delete e.data,t},serialize:function(e){return[e]}}),store.registerModel("callsinqueue",{id:Lyte.attr("string"),username:Lyte.attr("string"),phone:Lyte.attr("string")}),store.registerAdapter("callsinqueue",{namespace:"phonebridge/config/"}),store.registerSerializer("callsinqueue",{payloadKey:function(){return"data"},extractMeta:function(e){var t=e.data;return delete e.data,t},serialize:function(e){return[e]}});var PaymentsUtil=PaymentsUtil||{};PaymentsUtil.paymentServiceData={},PaymentsUtil.paymentAddOnData={},PaymentsUtil.paymentServiceData.ZohoCRM=2,PaymentsUtil.paymentServiceData.ZohoBigin=64e4,PaymentsUtil.paymentServiceData.ZohoOne=36e4,PaymentsUtil.paymentServiceData.ZohoRecruit=3601,PaymentsUtil.paymentServiceData.Shift={},PaymentsUtil.paymentServiceData.ZohoCommerce={},PaymentsUtil.paymentServiceData.ZohoSurvey={},PaymentsUtil.paymentServiceData.TransMail={},PaymentsUtil.paymentServiceData.ZohoIOT={},PaymentsUtil.paymentServiceData.ZohoCreator={},PaymentsUtil.paymentServiceData.ConnectCommunity={},PaymentsUtil.paymentServiceData.ZohoSupport={},PaymentsUtil.paymentServiceData.zohobackstage={},PaymentsUtil.paymentServiceData.ZohoSubscriptions={},PaymentsUtil.paymentServiceData.POSAPI={},PaymentsUtil.paymentServiceData.ZohoBooks={},PaymentsUtil.paymentServiceData.ZohoInvoice={},PaymentsUtil.paymentServiceData.ZohoInventory={},PaymentsUtil.paymentServiceData.Solution={},PaymentsUtil.paymentAddOnData.ConnectCommunity={},PaymentsUtil.paymentAddOnData.ZohoIOT={},PaymentsUtil.paymentAddOnData.ZohoCRM={},PaymentsUtil.paymentAddOnData.Shift={},PaymentsUtil.paymentAddOnData.ZohoCreator={},PaymentsUtil.paymentAddOnData.ZohoSupport={},PaymentsUtil.paymentAddOnData.ZohoCommerce={},PaymentsUtil.paymentAddOnData.ZohoSurvey={},PaymentsUtil.paymentAddOnData.TransMail={},PaymentsUtil.paymentAddOnData.ZohoForms={},PaymentsUtil.paymentAddOnData.ZohoBigin={},PaymentsUtil.paymentAddOnData.ZohoOne={},PaymentsUtil.paymentAddOnData.ZohoRecruit={},PaymentsUtil.paymentAddOnData.zohobackstage={},PaymentsUtil.paymentAddOnData.ZohoSubscriptions={},PaymentsUtil.paymentAddOnData.POSAPI={},PaymentsUtil.paymentAddOnData.ZohoBooks={},PaymentsUtil.paymentAddOnData.ZohoInvoice={},PaymentsUtil.paymentAddOnData.ZohoInventory={},PaymentsUtil.paymentAddOnData.Solution={},PaymentsUtil.paymentAddOnData.ZohoCRM.PHONE_NUMBER=14937,PaymentsUtil.paymentAddOnData.ZohoCRM.CALL_CREDIT=14938,PaymentsUtil.paymentAddOnData.ZohoCRM.STORAGE=14959,PaymentsUtil.paymentAddOnData.ZohoBigin.PHONE_NUMBER=640204,PaymentsUtil.paymentAddOnData.ZohoBigin.CALL_CREDIT=640601,PaymentsUtil.paymentAddOnData.ZohoBigin.RECORDING_CREDITS=640603,PaymentsUtil.paymentAddOnData.ZohoBigin.PHONE_CREDITS=640603,PaymentsUtil.paymentAddOnData.ZohoOne.PHONE_CREDITS=360296,PaymentsUtil.paymentAddOnData.ZohoOne.RECORDING_CREDITS=360296,PaymentsUtil.paymentAddOnData.ZohoCRM.RECORDING_CREDITS=14987,PaymentsUtil.paymentAddOnData.ZohoCRM.PHONE_CREDITS=14987,PaymentsUtil.paymentAddOnData.ZohoRecruit.RECORDING_CREDITS=36610,PaymentsUtil.paymentAddOnData.ZohoRecruit.PHONE_CREDITS=36610,PaymentsUtil.paymentServiceData.CRMPlus=18e4,PaymentsUtil.paymentAddOnData.CRMPlus={},PaymentsUtil.paymentAddOnData.CRMPlus.PHONE_CREDITS=180611,PaymentsUtil.paymentAddOnData.CRMPlus.RECORDING_CREDITS=180611,PaymentsUtil.isFreePlan=!1,PaymentsUtil.zuid="",PaymentsUtil.planId="",PaymentsUtil.dateTimePattern="MM/dd/yyyy hh:mm a",PaymentsUtil.timeZone="Asia/Kolkata",PaymentsUtil.serviceCompany="Zoho Corporation",PaymentsUtil.customId="",PaymentsUtil.userData={},PaymentsUtil.lastPaymentId="",PaymentsUtil.lastPhoneNumberId="",PaymentsUtil.isPhoneNumberPurchase=!1,PaymentsUtil.paymentAddOnData.ZohoCRM.SMS_CREDIT=14966,PaymentsUtil.paymentAddOnData.Shift.SMS_CREDIT=149661,PaymentsUtil.paymentAddOnData.ZohoCommerce.SMS_CREDIT=510602,PaymentsUtil.paymentAddOnData.ZohoForms.SMS_CREDIT=16217,PaymentsUtil.paymentAddOnData.ZohoSurvey.SMS_CREDIT=70609,PaymentsUtil.paymentAddOnData.TransMail.SMS_CREDIT=570602,PaymentsUtil.paymentAddOnData.ZohoBigin.SMS_CREDIT=640611,PaymentsUtil.paymentAddOnData.ZohoCreator.SMS_CREDIT=770610,PaymentsUtil.paymentAddOnData.ZohoSupport.SMS_CREDIT=45605,PaymentsUtil.paymentAddOnData.ConnectCommunity.SMS_CREDIT=138601,PaymentsUtil.paymentAddOnData.zohobackstage.SMS_CREDIT=-1,PaymentsUtil.paymentAddOnData.ZohoSubscriptions.SMS_CREDIT=140630,PaymentsUtil.paymentAddOnData.POSAPI.SMS_CREDIT=-1,PaymentsUtil.paymentAddOnData.ZohoBooks.SMS_CREDIT=96669,PaymentsUtil.paymentAddOnData.ZohoInvoice.SMS_CREDIT=12535,PaymentsUtil.paymentAddOnData.ZohoInventory.SMS_CREDIT=250628,PaymentsUtil.paymentAddOnData.Solution.SMS_CREDIT=-1,PaymentsUtil.paymentAddOnData.ZohoOne.PHONEBRIDGE_SMS_CREDIT=360617,PaymentsUtil.paymentAddOnData.CRMPlus.PHONEBRIDGE_SMS_CREDIT=180618,PaymentsUtil.paymentServiceData.Shift=6400001,PaymentsUtil.paymentServiceData.ZohoIOT=1566,PaymentsUtil.paymentServiceData.ZohoCommerce=51e4,PaymentsUtil.paymentAddOnData.ZohoCommerce.PHONE_CREDITS=510603,PaymentsUtil.paymentServiceData.ZohoForms=16e3,PaymentsUtil.paymentServiceData.ZohoCreator=901,PaymentsUtil.paymentServiceData.ZohoSurvey=55708,PaymentsUtil.paymentServiceData.ZohoSupport=4501,PaymentsUtil.paymentServiceData.ConnectCommunity=1521,PaymentsUtil.paymentServiceData.ZohoSubscriptions=153,PaymentsUtil.paymentServiceData.POSAPI=189,PaymentsUtil.paymentServiceData.ZohoBooks=149,PaymentsUtil.paymentServiceData.ZohoInvoice=155,PaymentsUtil.paymentServiceData.ZohoInventory=151,PaymentsUtil.paymentServiceData.ZohoBackstage=-1,PaymentsUtil.paymentServiceData.Solution=98,PaymentsUtil.paymentServiceData.LiveDesk=2201,PaymentsUtil.paymentAddOnData.LiveDesk={PHONE_CREDITS:22609},PaymentsUtil.initiatePayment=function(e,t,o){var i=Object.assign({purchaseTitleValue:I18n.getMsg("phonebridge.provider.inbuilt.callcredit.recharge"),purchaseInfoValue:I18n.getMsg("phonebridge.provider.inbuilt.callcredit.info"),upgradeLabel:I18n.getMsg("phonebridge.provider.inbuilt.callcredit"),successTitle:I18n.getMsg("phonebridge.provider.inbuilt.callcredit.success"),successInfo:I18n.getMsg("phonebridge.provider.inbuilt.transaction.summary"),successActionLabel:I18n.getMsg("phonebridge.provider.inbuilt.payment.close")},o),a=!1,n=document.getElementById("inbuilt_manage_numbers");n&&(a=n.component.data.atleastOneNumberPurchased),i.isPurchaseDone=a,i.addOnServiceId=PaymentsUtil.customId,i.addOnId=PaymentsUtil.paymentAddOnData[inbuiltTelephony.serviceName][e],i.zuid=PaymentsUtil.zuid,i.isFreePlan=PaymentsUtil.isFreePlan,i.serviceID=inbuiltTelephony.serviceID,"ZohoCreator"===inbuiltTelephony.serviceName&&inbuiltTelephony.bundleID&&(i.serviceID=inbuiltTelephony.bundleID),i.addOnCode=e,i.hideUnit=!0,i.hideQuantity=!0,null!=t&&(i.price=t),i.purchasemode="subscription","PHONE_CREDITS"!==i.addOnCode&&"CALL_CREDIT"!==i.addOnCode&&"SMS_CREDIT"!==i.addOnCode&&"RECORDING_CREDITS"!==i.addOnCode||(i.purchasemode="onetime",i.hideUnit=!1,i.hideQuantity=!1),i.planId=PaymentsUtil.planId,"PHONE_NUMBER"===i.addOnCode&&(i.upgradeLabel=I18n.getMsg("phonebridge.provider.inbuilt.phonenumber.cost"),i.purchaseTitleValue=I18n.getMsg("phonebridge.provider.inbuilt.phonenumber.add"),i.successTitle=I18n.getMsg("phonebridge.provider.inbuilt.phonenumber.success"),i.purchaseInfoValue=" ",i.hideQuantity=!1,i.hideUnit=!1),"RECORDING_CREDITS"===i.addOnCode&&(i.purchaseTitleValue=I18n.getMsg("phonebridge.provider.inbuilt.recordingcredit.recharge"),i.upgradeLabel=I18n.getMsg("phonebridge.provider.inbuilt.recordingcredit"),i.successTitle=I18n.getMsg("phonebridge.provider.inbuilt.reccordingcredit.success"),i.purchaseInfoValue=" "),PaymentsUtil.initiatePaymentWidget(i)},PaymentsUtil.deletePhoneNumberDetails=function(){inbuiltTelephony.providerId;obj={actionUrl:"/phonebridge/payment/phonenumber/"+PaymentsUtil.lastPaymentId+"/"+PaymentsUtil.lastPhoneNumberId,type:"DELETE",authentication:"cookies",headers:{"Content-Type":"application/x-www-form-urlencoded","X-ZCSRF-TOKEN":"phonebridgecsrparam="+COMMON_UTILS.getCookie("phonebridgecsr"),"X-PB-ORG":inbuiltTelephony.orgId,"X-SERVICE-ORG":inbuiltTelephony.serviceID,"X-SERVICE-NAME":inbuiltTelephony.serviceName}},COMMON_UTILS.fetchRequest(obj),PaymentsUtil.lastPaymentId="",PaymentsUtil.lastPhoneNumberId=""},PaymentsUtil.cancelSubscription=function(e){obj={actionUrl:"/phonebridge/payment/phonenumber/cancelsubscription",params:{phoneNumber:e},type:"POST",authentication:"cookies",headers:{"Content-Type":"application/x-www-form-urlencoded","X-ZCSRF-TOKEN":"phonebridgecsrparam="+COMMON_UTILS.getCookie("phonebridgecsr"),"X-PB-ORG":inbuiltTelephony.orgId,"X-SERVICE-ORG":inbuiltTelephony.serviceID,"X-SERVICE-NAME":inbuiltTelephony.serviceName}},inbuiltTelephonyHelper.showOrHideLoadingBar(!0),inbuiltTelephony.showOrHideFreeze(!1),COMMON_UTILS.fetchRequest(obj).then(function(e){if(inbuiltTelephony.showOrHideFreeze(!1),inbuiltTelephonyHelper.showOrHideLoadingBar(!1),"success"==e){COMMON_UTILS.sendMessageToParentWindow({action:"reloadsetup"})}else if("notallowed"==e){var t=I18n.getMsg("phonebridge.permission.error.body");document.getElementById("inbuilt_message_box_error").ltProp({message:t,show:!0})}else{t=I18n.getMsg("phonebridge.provider.inbuilt.error.unabletocancelsubscription");document.getElementById("inbuilt_message_box_error").ltProp({message:t,show:!0})}}.bind(this))},PaymentsUtil.initiatePaymentWidget=function(e){var t="PHONE_CREDITS";"SMS_CREDIT"!==e.addOnCode&&"PHONEBRIDGE_SMS_CREDIT"!==e.addOnCode||(t=e.addOnCode),e.isPurchaseDone?zs_widget.init({serviceId:e.addOnServiceId,customId:e.serviceID,admin_zuid:[e.zuid],purchaseMode:e.purchasemode,type:"widget",secretKey:"phonebridgecsrparam",secretVal:COMMON_UTILS.getCookie("phonebridgecsr"),itemList:[{code:t,action:"upgrade",type:"addon",upgradeLabel:e.upgradeLabel}],settings:{upgradeTitle:e.purchaseTitleValue,upgradeInfo:e.purchaseInfoValue,successTitle:e.successTitle,successInfo:e.successInfo,successActionLabel:e.successActionLabel,successSecondaryAction:"disable",disableAddonsSelection:"CALL_CREDIT"!==e.addOnCode&&"SMS_CREDIT"!==e.addOnCode&&"PHONEBRIDGE_SMS_CREDIT"!==e.addOnCode,hideUnit:e.hideUnit,hideQuantity:e.hideQuantity},license:e.isFreePlan?{plan:e.planId,payPeriod:"PTUL",addons:null!=e.price?[{id:e.addOnId,count:e.price}]:[{id:e.addOnId}]}:{plan:e.planId,addons:null!=e.price?[{id:e.addOnId,count:e.price}]:[{id:e.addOnId}]}}):zs_widget.init({serviceId:e.addOnServiceId,customId:e.serviceID,admin_zuid:[e.zuid],purchaseMode:e.purchasemode,type:"widget",secretKey:"phonebridgecsrparam",secretVal:COMMON_UTILS.getCookie("phonebridgecsr"),itemList:[{code:t,action:"upgrade",type:"addon",upgradeLabel:e.upgradeLabel}],settings:{upgradeTitle:e.purchaseTitleValue,upgradeInfo:e.purchaseInfoValue,purchaseTitle:e.purchaseTitleValue,purchaseInfo:e.purchaseInfoValue,successTitle:e.successTitle,successInfo:e.successInfo,successActionLabel:e.successActionLabel,successSecondaryAction:"disable",disableAddonsSelection:"CALL_CREDIT"!==e.addOnCode&&"SMS_CREDIT"!==e.addOnCode&&"PHONEBRIDGE_SMS_CREDIT"!==e.addOnCode,hideUnit:e.hideUnit,hideQuantity:e.hideQuantity},license:e.isFreePlan?{plan:e.planId,payPeriod:"PTUL",addons:null!=e.price?[{id:e.addOnId,count:e.price}]:[{id:e.addOnId}]}:{plan:e.planId,addons:null!=e.price?[{id:e.addOnId,count:e.price}]:[{id:e.addOnId}]}})};var zs_store={onSuccess:function(e){Lyte.triggerEvent("credits_purchased",{is_success:!0,data:e}),document.getElementById("isSms")?ClientFrameCommunicator.sendMessage("reloadsetup",{frameName:"zpbsmssetup"}):(""!==PaymentsUtil.lastPhoneNumberId&&""!==PaymentsUtil.lastPaymentId&&PaymentsUtil.deletePhoneNumberDetails(),COMMON_UTILS.sendMessageToParentWindow({action:"reloadsetup"}))},onCancel:function(e){Lyte.triggerEvent("credits_purchased",{is_success:!1,data:e}),document.getElementById("isSms")||""!==PaymentsUtil.lastPhoneNumberId&&""!==PaymentsUtil.lastPaymentId&&PaymentsUtil.deletePhoneNumberDetails()}};