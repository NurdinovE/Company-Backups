store.registerModel("data_enrichment_count",{id:Lyte.attr("string",{primaryKey:!0}),config_count:Lyte.attr("object",{default:{}}),enrich_count:Lyte.attr("object",{default:{}}),modules:Lyte.attr("array",{default:[]}),people_enrichment:Lyte.attr("boolean",{default:!1})},{actions:{get_modules:{}}}),store.registerAdapter("data_enrichment_count",{namespace:"crm/v6/__features/",buildURL:function(e,t,i,a,r,n){return"get_modules"===n?r.split("v6/")[0]+"v2.2/settings/modules?feature_name=data_enrichment":r.replace(e,"data_enrichment")},methodForRequest:function(e,t,i,a,r){return"findAll"===t||"get_modules"===r?"GET":e}}),store.registerSerializer("data_enrichment_count",{normalizeResponse:function(e,t,i,a,r){if(200===r||201===r){let e=[],t=i.__features&&i.__features[0]?i.__features[0].details:"";return t&&(t.id="1",t.config_count=t.config_count?{limit:t.config_count.limit.total,used_count:t.config_count.used_count.total}:{},t.enrich_count=t.enrich_count?{limit:t.enrich_count.limit.total,used_count:t.enrich_count.used_count.total}:{},t.people_enrichment=t.people_enrichment_enabled,delete t.people_enrichment_enabled,e.push(t)),{data_enrichment_counts:e}}return 204===r&&(i={data_enrichment_counts:[{id:"1",status:!1}]}),i}}),store.registerModel("data_enrichment",{id:Lyte.attr("string",{primaryKey:!0}),module:Lyte.belongsTo("module"),status:Lyte.attr("boolean"),type:Lyte.attr("string"),created_by:Lyte.attr("object"),modified_by:Lyte.attr("object"),trigger_fields:Lyte.attr("array"),created_time:Lyte.attr("string"),modified_time:Lyte.attr("string"),enrich_fields:Lyte.attr("array")},{actions:{scrapy_feedback:{},enrich_reports:{},enrich_analytics:{},enrich_history:{},enrich_text:{}}}),store.registerAdapter("data_enrichment",{namespace:"crm/v7/settings/zia/",buildURL:function(e,t,i,a,r,n){switch(n){case"enrich_reports":r=r.split("v7/")[0]+"v2/Reports/actions/run";break;case"enrich_analytics":r=r.split("v7/")[0]+"v6/Analytics/components/query";break;case"enrich_history":r=r.split("v7/")[0]+"v7/settings/zia/data_enrichment_history";break;case"enrich_text":r=r.split("v7/")[0]+"v7/__zia_extracted_text_details"}return r},headersForRequest:function(e,t,i,a){let r=this.$super.headersForRequest(e,t,i);return r.Accept="application/json","createRecord"!==e&&"updateRecord"!==e&&"scrapy_feedback"!==a&&"enrich_analytics"!==a&&"enrich_reports"!==a&&"enrich_text"!==a||(r["Content-type"]="application/json; charset=utf-8"),r},methodForRequest:function(e,t,i,a,r){return"createRecord"===t||"enrich_text"===r?"POST":"findAll"===t||"findRecord"===t?"GET":"PATCH"===e||"updateRecord"===t?"PUT":"deleteRecord"===t?"DELETE":"enrich_history"===r?"GET":e},parseResponse:function(e,t,i,a,r,n,d,s,c){if("enrich_history"===c&&204===i.status){let e={data_enrichment_history:[]};a=e}return a}}),store.registerSerializer("data_enrichment",{serialize:function(e,t,i,a,r,n,d){if("updateRecord"===e){let e={};return t.data_enrichment.enrich_fields&&(e.output_data_field_mapping=this.RemoveDisplayLabel(t.data_enrichment.enrich_fields)),t.data_enrichment.trigger_fields&&(e.input_data_field_mapping=this.RemoveDisplayLabel(t.data_enrichment.trigger_fields)),void 0!==t.data_enrichment.status&&(e.status=t.data_enrichment.status),{data_enrichment:[e]}}if("createRecord"===e)return{data_enrichment:[{type:i.type,module:{id:i.module.id,api_name:i.module.api_name},input_data_field_mapping:this.RemoveDisplayLabel(i.trigger_fields),output_data_field_mapping:this.RemoveDisplayLabel(i.enrich_fields)}]};switch(d){case"scrapy_feedback":return{scrapy_feedback:a.feedback};case"enrich_analytics":t=a;break;case"enrich_reports":(t={}).Reports=[a];break;case"enrich_text":(t={}).__zia_extracted_text_details=a}return t},normalizeResponse:function(e,t,i,a,r){if(200===r||201===r)switch(t){case"findAll":let e=[];i.data_enrichment.forEach((function(t){t.module=t.module.id,t.trigger_fields=t.input_data_field_mapping,delete t.input_data_field_mapping,e.push(t)})),i={data_enrichments:e};break;case"findRecord":let t=[];i.data_enrichment.forEach((function(e){e.module=e.module.id,e.trigger_fields=e.input_data_field_mapping,e.enrich_fields=e.output_data_field_mapping,delete e.output_data_field_mapping,delete e.input_data_field_mapping,t.push(e)})),i={data_enrichments:t};break;case"createRecord":i={data_enrichments:{id:(i=i.data_enrichment[0]).details.id,created_by:i.details.created_by,created_time:i.details.created_time,modified_by:i.details.created_by,modified_time:i.details.created_time,status:!0}};break;case"updateRecord":i={data_enrichments:{id:(i=i.data_enrichment[0]).details.id,modified_by:i.details.modified_by,modified_time:i.details.modified_time}}}return 204===r&&(i={data_enrichments:[{id:"204",status:!1}]}),i}},{mixins:["enrichment-utils"]}),store.registerModel("zia-data-enrichment-meta",{id:Lyte.attr("string",{primaryKey:!0}),module:Lyte.belongsTo("module"),type:Lyte.attr("string"),trigger_fields:Lyte.attr("array"),enrich_fields:Lyte.attr("array")}),store.registerAdapter("zia-data-enrichment-meta",{namespace:"crm/v7/settings/zia/",buildURL:function(e,t,i,a,r){return"findAll"===t?r.replace(e,"data_enrichment")+"/allowed_field_mappings":r},methodForRequest:function(e,t){return"findAll"===t?"GET":e}}),store.registerSerializer("zia-data-enrichment-meta",{normalizeResponse:function(e,t,i,a,r,n,d){if((200===r||201===r)&&"findAll"===t){const e=i.allowed_field_mappings,t=store.peekAll("module").find((e=>e.api_name===d.module));return e.id=t.id,e.module=t.id,e.type=d.type,e.trigger_fields=e.input_data_field_mapping.map((e=>({enrich_field:e.enrich_field.name,display_label:e.enrich_field.display_label,crm_fields:e.crm_fields.map((e=>t.fields.find((t=>t.id===e.id)))).filter((e=>void 0!==e))}))).map((e=>(e.crm_fields.push({field_label:I18n.getMsg("crm.label.field.do.not.map"),id:""}),e))),e.enrich_fields=e.output_data_field_mapping.map((e=>({enrich_field:e.enrich_field.name,display_label:e.enrich_field.display_label,crm_fields:e.crm_fields.map((e=>t.fields.find((t=>t.id===e.id)))).filter((e=>void 0!==e))}))).map((e=>(e.crm_fields.push({field_label:I18n.getMsg("crm.label.field.do.not.map"),id:""}),e))),delete e.input_data_field_mapping,delete e.output_data_field_mapping,{"zia-data-enrichment-metas":[e]}}return i}});
