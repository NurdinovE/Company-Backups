store.registerModel("crm_social_info",{},{actions:{follow:{}}}),store.registerAdapter("crm_social_info",{namespace:"crm/v2/Social/brands/brand_id/",buildURL:function(e,r,t,a,o,i,n){return o=o.replace(e,"info"),n&&n.brand_id?o=o.replace("brand_id",n.brand_id):n&&n.network&&n.profile_id&&(o=o.replace("brands",n.network).replace("brand_id",n.profile_id)),"follow"===i&&(o=o.replace("/actions/follow","/twitter/profiles/"+n.profileId+"/actions/follow")),o}}),store.registerSerializer("crm_social_info",{payloadKey:function(){return"info"},normalizeResponse:function(e,r,t){var a=t.info;return(a=a.data?a.data:a)&&(a.id||(a.id=Math.floor(1e5*Math.random()+1)),a[0]&&a[0].error&&(a[0].id||(a[0].id=Math.floor(1e5*Math.random()+1))),t={info:a}),t},extractMeta:function(e){if(e.meta)return e.meta}}),store.registerModel("crm_social_feed",{}),store.registerAdapter("crm_social_feed",{namespace:"crm/v2/Social/brands/brand_id/",buildURL:function(e,r,t,a,o,i,n){return o=o.replace(e,"feeds"),n&&(o=o.replace("brand_id",n.brand_id)),o}}),store.registerSerializer("crm_social_feed",{payloadKey:function(){return"feeds"},normalizeResponse:function(e,r,t){var a=t;a&&($.each(a.data,(function(e,r){r&&!r.id&&("twitter"===r.network&&r.interaction_info&&r.interaction_info.id?r.id=r.interaction_info.id:"twitter"===r.network&&r.history_info&&r.history_info.id?r.id=r.history_info.id:"facebook"===r.network&&r.interaction_info&&r.interaction_info.id?r.id=r.interaction_info.id:"facebook"===r.network&&r.post_info&&r.post_info.id?r.id=r.post_info.id:"facebook"===r.network&&r.history_info&&r.history_info.id?r.id=r.history_info.id:a.data.splice(e,e+1))})),t={feeds:Lyte.registeredMixins["crm-social-tab"].processFeeds(a.data),meta:{cursor:a.cursor}});return t},extractMeta:function(e){if(e.meta)return e.meta}}),store.registerModel("crm_social_list",{}),store.registerAdapter("crm_social_list",{namespace:"crm/v2/Social/brands/brand_id/",buildURL:function(e,r,t,a,o,i,n){return o=o.replace(e,"lists"),n&&n.brand_id&&(o=o.replace("brand_id",n.brand_id)),o}}),store.registerSerializer("crm_social_list",{payloadKey:function(){return"lists"},normalizeResponse:function(e,r,t){var a=t.lists;return a&&(t={lists:a.data,meta:a.cursor}),t},extractMeta:function(e){if(e.meta)return e.meta}}),store.registerModel("crm_social_posts_comment",{}),store.registerAdapter("crm_social_posts_comment",{namespace:"crm/v2/Social/brands/brand_id/network/",buildURL:function(e,r,t,a,o,i,n){return o=o.replace(e,"posts"),n&&(o=o.replace("brand_id",n.brand_id).replace("network",n.network),n.postComments&&(o=o+"/"+n.post_id+"/comments")),o}}),store.registerSerializer("crm_social_posts_comment",{payloadKey:function(){return"comments"},serialize:function(e,r,t,a){if(a.postComments){var o=new FormData;return o.append("message",a.message),a.file&&o.append("file",a.file),a.fileName&&o.append("fileName",a.fileName),o}},normalizeResponse:function(e,r,t){var a=t.comments;return t=Array.isArray(a)?{comments:a,meta:t.offset}:{comments:a?a.data:a,meta:a.cursor}},extractMeta:function(e){if(e.meta)return e.meta}}),store.registerModel("monitor_column",{network:Lyte.attr("string"),type:Lyte.attr("string"),brand:Lyte.attr("object"),details:Lyte.attr("object")},{actions:{save_order:{}}}),store.registerAdapter("monitor_column",{namespace:"crm/v2/Social/",buildURL:function(e,r,t,a,o,i,n){return"get_social"===n?o=o+"/"+n:"save_order"===i&&(o=o.replace("save_order","reorder")),o},methodForRequest:function(e,r,t,a,o){return"save_order"===o?"POST":e}}),store.registerSerializer("monitor_column",{payloadKey:function(){return"monitor_column"},serialize:function(e,r,t,a){if(a&&a.order){var o=new FormData;return o.append("ids",a.order),a.csrfParamName&&o.append(a.csrfParamName,a.csrfToken),o}return r},normalizeResponse:function(e,r,t){var a=[];return t&&(a=t.monitor_column)&&($.each(a,(function(e,r){r.id||(r.id=r.details.id?r.details.id:Math.floor(1e7*Math.random())+1)})),t={monitor_column:a}),t}}),store.registerModel("social-entity-association",{}),store.registerAdapter("social-entity-association",{namespace:"crm/v2/tab/social",buildURL:function(e,r,t,a,o,i,n){return"Leads"!==n&&"Contacts"!==n&&"Accounts"!==n||(o=(o=o.replace(e,"")).replace("v2/tab/social/","v2.1/"+n+"/search")),"get_association"===n?o=o.replace(e,"get_association"):"get_association_entity"===n?o=o.replace(e,"get_association_entity"):"get_social_layout_fields"===n?o=(o=o.replace(e,"")).replace("/v2/tab/social/","/v2.2/settings/layouts"):n&&n.id?(o=(o=o.replace(e,"")).replace("/v2/tab/social/","/v2.2/settings/layouts/"),o+=n.id):n&&n.type&&"get_association_profiles"===n.type?o=(o=o.replace(e,"")).replace("tab/social/",n.module+"/"+n.entity_id+"/Social"):n&&n.record_image&&(o=(o=o.replace(e,"")).replace("v2/tab/social/","v2.2/"+n.module)),o}}),store.registerSerializer("social-entity-association",{payloadKey:function(){return"data"},normalizeResponse:function(e,r,t){return t.layouts?((t={data:t}).data&&!t.data.id&&(t.data.id=Math.floor(1e5*Math.random()+1)),delete t.layouts):t.data||(t={data:{}}),t.data[0]&&!t.data[0].id&&(t.data[0].id=Math.floor(1e5*Math.random()+1)),t}});
