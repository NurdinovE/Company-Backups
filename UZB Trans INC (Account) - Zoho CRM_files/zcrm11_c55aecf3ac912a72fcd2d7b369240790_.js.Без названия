var crmTemplate={clickEventIdVsMethodMapping:{userLookup:"crmTemplate.userLookup",showLookup:"crmTemplate.showLookup",clearLookup:"crmTemplate.clearLookup",sortingRecordslookup:"crmTemplate.showLookup"},weekDaysDropdownObj:[{html:I18n.getMsg("Sunday"),value:"1"},{html:I18n.getMsg("Monday"),value:"2"},{html:I18n.getMsg("Tuesday"),value:"3"},{html:I18n.getMsg("Wednesday"),value:"4"},{html:I18n.getMsg("Thursday"),value:"5"},{html:I18n.getMsg("Friday"),value:"6"},{html:I18n.getMsg("Saturday"),value:"7"}],numberStringArray:[{html:I18n.getMsg("First"),value:"1"},{html:I18n.getMsg("Second"),value:"2"},{html:I18n.getMsg("Third"),value:"3"},{html:I18n.getMsg("Fourth"),value:"4"},{html:I18n.getMsg("Last"),value:"5"}],recDateArrray:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],clickHandler:function(e,t,a){return!this.clickEventIdVsMethodMapping[a]||(Lyte.registeredMixins["crm-utilities"].executeFunctionByName(this.clickEventIdVsMethodMapping[a],window,e,t),!1)},subformContents:[],subformFldDetails:{},subformData:{1:{}},onChange:function(e,t,a,r,l,i){if(commonUtils.setErrVerifyContHeightToParent(!1,!1,!1),"setup"===l){var s=$("#"+i)[0];Crm.setDependent(void 0,r,s,l,void 0)}["36","143","144","145"].includes(a)||(CScript.Engine.Global.dispatchEvent("onChange",void 0,e),CScript.Engine.Global.dispatchEvent("onChange",t,CreatePageHandler.field_read.call({field_name:e})))},onTypesSupportedFields:new Set(["1","127","25","35","21","33","32","37","22","3","27","221"]),onTypeTimer:void 0,onType:function(e,t){CScriptLib&&(clearTimeout(crmTemplate.onTypeTimer),crmTemplate.onTypeTimer=setTimeout((()=>{t&&t.length>=2&&CScript.Engine.Global.dispatchEvent("onType",e,t)}),500))},onSave:function(){return $(".errMsg").remove(),$(".tabDiv,.tabDivCreate, .errorFieldP").removeClass("errorFieldP"),CScript.Engine.Global.dispatchIEvent("onSave")},forSubformFormulaNewEpxTriggered:!1,canSetupFormulaDependencies:!0,dependentFieldsList:[],recordCurrencyER:0,imageUploadFieldRenderedCount:0,createSubFields:function(e,t,a,r){if(0==$("#"+a).length){var l=document.createElement("div");$(l).attr({id:a,width:"75%"});var i=document.createElement("div");i.className="dIB w100_per",l.appendChild(i),r.module=e;for(var s=0;s<r.length;s++){var n=document.createElement("div");i.appendChild(n),r.currentField=r[s],"Recurring_period"===r.currentField.colname||"Custom_Recurring_period"===r.currentField.colname?n.className="tabDivCreate tabDivCreateParent "+r.currentField.colname:n.className="tabDivCreate tabDivCreateParent taskNoBorderEle "+r.currentField.colname,n.id=e+"_fldRow_"+r.currentField.colname;var o=$(crmTemplate.createFieldLabel(r)),d=$(crmTemplate.createFieldContent(r));("Tasks"!==e&&s!=r.length-1&&r[s+1].isBusHoliday||"Tasks"===e&&r.currentField.isBusHoliday)&&$(n).addClass("borderNone"),"Tasks"!==e&&r.currentField.isBusHoliday&&d.addClass("labelValCretateBh"),o&&n.appendChild(o[0]),n.appendChild(d[0]),n.appendChild($("<div class='cBoth'></div>")[0])}t.appendChild(l),"TasksrecurringDiv"!=a&&"RemindAtdiv"!=a&&($("#"+a).hide(),$("#"+a).slideDown())}else"RemindAtdiv"!=a&&$("#"+a).slideDown()},setFocus:function(e){e.focus((function(e){var t=$(this).parents("label").eq(0).attr("for");return $("#"+t).prop("checked",!0),this.focus(),renderingUtils.stopEvent(e),!1})).click((function(e){return renderingUtils.stopEvent(e),!1}))},constructDynamicFields:function(e,t,a){if(t.dynamicFields)for(var r=t.dynamicFields,l=a.querySelectorAll("label")[0],i=l||a,s=crmTemplate.getElementsByTagName("#text",i)[0],n=0;n<r.length;n++){var o=$(crmTemplate.createFieldContent({module:e,currentField:r[n]}))[0];commonUtils.cleanWhitespace(o);var d=s.nodeValue,c=/{[0-9]+}/g.exec(d);if(!c)return;for(var u=o;u.hasChildNodes();){if(l){var m=$(u).find("select,input");0!==m.length&&crmTemplate.setFocus(m.eq(0))}s.parentNode.appendChild(u.firstChild)}var p=s.splitText(c.index);p.deleteData(0,c[0].length),s.parentNode.appendChild(p),s=p}},constructRecurringEnds:function(e){var t=$("#TasksrecurringDiv > div")[0],a=[{colname:"RECURRING_END_NEVER",customfield:"false",displaylabel:I18n.getMsg("Ends"),val:[{html:I18n.getMsg("crm.databackup.backupends.none"),value:"1"}],label:"endRadioOption",mandate:"true",maxlength:"120",readonly:"false",type:"radio",uitype:"17"},{colname:"RECURRING_END_NOOFTIMES",customfield:"false",displaylabel:"",val:[{html:I18n.getMsg("crm.recurring.after.times"),value:"2"}],label:"endRadioOption",mandate:"false",maxlength:"120",readonly:"false",type:"radio",uitype:"17",dynamicFields:[{colname:"RECURRING_REPEAT_COUNT",customfield:"false",defaultvalue:1,displaylabel:"",label:"repeatEndCount",mandate:"false",maxlength:"3",readonly:"false",type:"int",uitype:"32"}]},{colname:"RECURRING_END_ON",customfield:"false",displaylabel:"",val:[{html:I18n.getMsg("crm.recurring.end.date.on"),value:"3"}],label:"endRadioOption",false:"true",maxlength:"120",readonly:"false",type:"radio",uitype:"17",dynamicFields:[{colname:"RECURRING_END_DATE",customfield:"false",displaylabel:"",label:"repeatEndDate",mandate:"false",maxlength:"120",readonly:"false",type:"Date",uitype:"24"}]}],r=$(e);if(("edit"==window.Tasks.currentStatus||"clone"==window.Tasks.currentStatus)&&null!=r.data().recdata&&""!=r.data().recdata){var l=r.data().recdata;if((l=l.split("*#")).length>0){var i=null;"weekly"==l[0]?1==(i=l[2].split("^")).length?(a[2].defaultvalue=1,a[2].dynamicFields[0].defaultvalue=r.data().enddate):"-1"==i[0]?a[0].defaultvalue=1:(a[1].defaultvalue=1,a[1].dynamicFields[0].defaultvalue=i[0]):1==(i=l[3].split("^")).length?(a[2].defaultvalue=1,a[2].dynamicFields[0].defaultvalue=r.data().enddate):"-1"==i[0]?a[0].defaultvalue=1:(a[1].defaultvalue=1,a[1].dynamicFields[0].defaultvalue=i[0])}}crmTemplate.createSubFields("Tasks",t,"taskEndPart",a),$("#taskEndPart").find('input[type="text"]').addClass("taskInput").prop("autocomplete","off"),$("#Crm_Tasks_RECURRING_END_DATE").css("width","80px"),1==a[2].defaultvalue?$("#Crm_Tasks_RECURRING_END_ON").prop("checked",!0):1==a[1].defaultvalue?$("#Crm_Tasks_RECURRING_END_NOOFTIMES").prop("checked",!0):$("#Crm_Tasks_RECURRING_END_NEVER").prop("checked",!0)},constructRecurringActivity:function(e,t){$("#Crm_Tasks_STATUS option:selected").val()==crmTasks.compDispVal&&$(".reminderSection").hasClass("freezeReminder")&&crmTasks.unfreezeReminder();var a=[{colname:"Recurring_period",customfield:"false",displaylabel:I18n.getMsg("Repeat Type"),label:"period",mandate:"true",maxlength:"120",readonly:"false",type:"Pick List",uitype:"42",val:[{html:I18n.getMsg("Daily"),content:"daily"},{html:I18n.getMsg("Weekly"),content:"weekly"},{html:I18n.getMsg("Monthly"),content:"monthly"},{html:I18n.getMsg("Yearly"),content:"yearly"},{html:I18n.getMsg("Custom"),content:"custom"}]}],r=$(t);if(("edit"==window[e].currentStatus||"clone"==window[e].currentStatus)&&null!=r.data().recdata&&""!=r.data().recdata){var l=r.data().recdata;if((l=l.split("*#")).length>0){var i=l[0];if("1"==l[l.length-2]||"yearly"==i){var s=new Date(r.data().startdate);"daily"==i&&"1"==l[1].split("^")[0]||"weekly"==i&&s.getDay()+1==l[3]||"monthly"==i&&"1"==l[1]&&s.getDate()==l[4]||"yearly"==i&&"1"==l[1]&&s.getMonth()==l[4]&&s.getDate()==l[5]?a[0].defaultvalue=l[0]:a[0].defaultvalue="custom"}else a[0].defaultvalue="custom"}$("#Crm_Tasks_Recurring_Start_Date1").data("mandate",!0),$("#Crm_Tasks_Recurring_End_Date1").data("mandate",!0),$("#Crm_Tasks_Recurring_period").data("mandate",!0),"Tasks"===e&&($("#Tasks_fldRow_remTime").show().addClass("noBorderStyle"),$("#Tasks_fldRow_RemindAt_Start_Date1").hide(),$("#Crm_Tasks_RemindAt_Start_Date1").data("mandate",!1))}if("Tasks"==e&&crmCommonModule.createEditJson&&crmCommonModule.createEditJson.isBusinessHoursCreated&&("create"===window[e].currentStatus||"clone"===window[e].currentStatus||null==r.data().recdata||""==r.data().recdata)){var n={colname:"EXCEPT_BUSINESS_HOLIDAY",customfield:"false",displaylabel:"",val:[{html:I18n.getMsg("bh.except.week.holidays"),value:"true"}],label:"exceptBus_Holiday",mandate:"false",maxlength:"120",readonly:"false",type:"checkbox",uitype:"18",isBusHoliday:!0};a.push(n),n={colname:"NEXT_BUSINESS_HOLIDAY_MONTH",customfield:"false",displaylabel:"",val:[{html:I18n.getMsg("bh.next.task.business.holiday"),value:"true"}],label:"exceptBus_Holiday",mandate:"false",maxlength:"120",readonly:"false",type:"checkbox",uitype:"18",isBusHoliday:!0},a.push(n),n={colname:"NEXT_BUSINESS_HOLIDAY_YEAR",customfield:"false",displaylabel:"",val:[{html:I18n.getMsg("bh.next.task.business.holiday"),value:"true"}],label:"exceptBus_Holiday",mandate:"false",maxlength:"120",readonly:"false",type:"checkbox",uitype:"18",isBusHoliday:!0},a.push(n)}crmTemplate.createSubFields(e,t.parentNode.parentNode,e+"recurringDiv",a),crmTemplate.hideTaskBusinessHoliday(a[0].defaultvalue?a[0].defaultvalue:"daily");var o=$("<div></div>");o.prependTo($($("#Tasks_fldRow_Recurring_period").parent())),o.next().appendTo(o),"custom"==a[0].defaultvalue&&crmTasks.showFrequencyDetails(t),$("#Crm_Tasks_Recurring_End_Date1").data("mandate",!0);var d=$("#Crm_Tasks_Recurring_period");(d.data("mandate",!0),crmTemplate.constructRecurringEnds(t),crmTasks.constructRecurFooter(),crmTasks.editTask)&&($("#Crm_Tasks_RECURRING").data("readonly")||$("#Crm_Tasks_RECURRING").prop("disabled",!1),thirdPartyUtils.bindSelect2(d))},removeRecurringActivity:function(){if(null!=$("#Crm_Tasks_RECURRING").data().recdata&&"clone"!==window.Tasks.currentStatus)crmTasks.openDeleteRecurringPopup();else{if($("#Crm_Tasks_STATUS option:selected").val()==crmTasks.compDispVal){crmTasks.freezeReminder(),crmTasks.removeReminder();var e=$("#Crm_Tasks_REMINDAT");e.prop("disabled",!0),e.parent().off("mouseenter.duedateinpast"),e.parent().off("mouseleave.duedateinpast"),e.parent().on("mouseenter.duedateinpast",(function(){crmui.toolTip_show(this,"left",I18n.getMsg("crm.task.reminder.tooltip2"))})),e.parent().on("mouseleave.duedateinpast",(function(){crmui.toolTip_hide()}))}crmTasks.removeRecurring()}},showRemindAt:function(e,t,a){var r=$(".REMINDAT").offset().top,l=t.checked,i=$("#Crm_Tasks_DUEDATE"),s=$("#Crm_Tasks_RECURRING");if("Tasks"===e)var n=null==i[0]||""==i[0].value||!$L.moment(i[0].value,Crm.userDetails.DATE_PATTERN.toUpperCase(),!0).validate(),o=!n&&s.is(":checked");var d=$(t),c={};a&&(c=d.data());var u=c&&c.alertType&&c.alertType,m=("L"===Crm.userDetails.LICENSE_TYPE||"F"===Crm.userDetails.LICENSE_TYPE||"N"===Crm.userDetails.LICENSE_TYPE)&&"Tasks"===e,p=(u=c&&c.alertType?c.alertType:m?"popup":"email",c&&c.remindBefore?c.remindBefore.split(" "):{}),f=n?new Date:i.data("dateObj"),v=new Date;(f=new Date(f)).setHours(v.getHours());var h="edit"==window[e].currentStatus||"clone"==window[e].currentStatus;if(h&&null!=c.reminderDate&&""!=c.reminderDate&&(f=c.reminderDate),l){var g,T={colname:"RemindAt_Start_Date1",customfield:"false",label:"Start Date",mandate:"false",maxlength:"120",readonly:"false",type:"Date",uitype:"786",defaultvalue:f},C={colname:"remTime",customfield:!1,label:"remTime",mandate:!1,type:"Pick List",uitype:"42",val:[{content:"0",html:I18n.getMsg("on")}],defaultvalue:p[0],period:[{value:"days",html:I18n.getMsg("crm.remind.day(s)")}],defaultvalueperiod:p[1]};if(n||o){if(!n){crmTasks.updateReminderOptions();var b=crmTasks.possibleDays,_=crmTasks.possibleWeeks,y=crmTasks.possibleMonths;_&&C.period.push({value:"weeks",html:I18n.getMsg("crm.remind.week(s)")}),y&&C.period.push({value:"months",html:I18n.getMsg("crm.remind.month(s)")});for(F=1;F<=b;F++)C.val.push({value:""+F,html:""+F})}}else{var I=i.data("dateObj"),E=new Date;if(I.setHours(0,0,0,0),E.setHours(0,0,0,0),Utils.compareDate(E,I)){var D=Utils.getDayDiff(I,E);crmTasks.updatePossiblePeriods(D),crmTasks.possibleWeeks&&C.period.push({value:"weeks",html:I18n.getMsg("crm.remind.week(s)")}),crmTasks.possibleMonths&&C.period.push({value:"months",html:I18n.getMsg("crm.remind.month(s)")});for(var F=1;F<=crmTasks.possibleDays;F++)C.val.push({value:""+F,html:""+F})}}g=m?[{html:I18n.getMsg("Pop Up"),content:"popup"}]:[{html:I18n.getMsg("Email"),content:"email"},{html:I18n.getMsg("Pop Up"),content:"popup"},{html:I18n.getMsg("Both"),content:"emailandpopup"}];var S=[T,C,{colname:"RemindAt_period",customfield:"false",displaylabel:I18n.getMsg("Repeat Type"),label:"Repeat Type",mandate:"false",maxlength:"120",readonly:"false",type:"Pick List",uitype:"42",defaultvalue:c.repeatType,val:[{html:I18n.getMsg("None"),content:"none"}]},{colname:"RemindAt_Notify",customfield:"false",displaylabel:I18n.getMsg("crm.workflow.label.notify"),label:"alertType",mandate:"false",maxlength:"120",readonly:"false",type:"Pick List",uitype:"42",defaultvalue:u,val:g}];crmTemplate.createSubFields(e,t.parentNode.parentNode,"RemindAtdiv",S);var w=$("#Crm_Tasks_RemindAt_Start_Date1"),R=$("#Crm_Tasks_RemindAt_Start_Date1_Radio"),A=$("#Tasks_fldRow_RemindAt_Start_Date1"),L=$("#Crm_Tasks_RemindAt_remTime_Radio"),N=$("#Tasks_fldRow_remTime"),k=$("#Tasks_fldRow_RemindAt_period");"Tasks"===e&&crmBstTime.showHideSuggestionForCreateTask("show"),A.addClass("nobottomborder"),N.addClass("nobottomborder"),crmTasks.updateRemPeriodSelect(),$("#Tasks_fldRow_RemindAt_Start_Date1 > .labelTabCreate").remove(),$("#Tasks_fldRow_RemindAt_Start_Date1 > .labelValCreate").removeClass("labelValCreate").addClass("remRow"),$("#Tasks_fldRow_remTime > .labelTabCreate").remove(),$("#Tasks_fldRow_remTime > .labelValCreate").removeClass("labelValCreate").addClass("remRow"),A.find(".textField").removeClass("fL"),crmTasks.constructReminderFooter(),h&&null!=c.remindBefore&&"0"!=c.remindBefore&&!n?(L.prop("checked",!0),$("#Crm_Tasks_remTime_TimeOption").val($("#Crm_Tasks_RemindAt_Start_Date1_TimeOption").val())):(R.prop("checked",!0),w.data("mandate",!1));var O=$("#Crm_Tasks_remTime");if(h&&"weeks"==p[1]){$('#Crm_Tasks_remTime option[value="0"]').prop("disabled",!0),(O.val()>crmTasks.possibleWeeks||"0"==O.val())&&$('#Crm_Tasks_remTime option[value="1"]').attr("selected","selected");for(F=_+1;F<=b;F++)$('#Crm_Tasks_remTime option[value="'+F+'"]').prop("disabled",!0)}else if(h&&"months"==p[1]){$('#Crm_Tasks_remTime option[value="0"]').prop("disabled",!0),(O.val()>crmTasks.possibleMonths||"0"==O.val())&&$('#Crm_Tasks_remTime option[value="1"]').attr("selected","selected");for(F=y+1;F<=b;F++)$('#Crm_Tasks_remTime option[value="'+F+'"]').prop("disabled",!0)}crmTasks.updateRemRepeatSelect(),w.off("change.remRepeatSelUpdate"),w.on("change.remRepeatSelUpdate",(function(){crmTasks.updateRemRepeatSelect()})),R.parent().find(".rbHtml").show(),L.parent().find(".rbHtml").show(),o?(A.hide(),L.prop("checked",!0),L.parents("label").find(".rbHtml").hide(),N.show(),k.hide(),R.parent().find(".rbHtml").hide(),L.parent().find(".rbHtml").hide()):(A.show(),N.hide(),k.show()),n?(k.hide(),o||(A.show(),N.hide()),R.parent().find(".rbHtml").hide(),L.parent().find(".rbHtml").hide()):(N.show(),o||(k.show(),A.show()));var M=$("#wmstoolbar").length?$("#wmstoolbar").outerHeight():30,U=200+r;renderingUtils.windowHeight-M<U&&$("html,body").animate({scrollTop:U})}else{(w=$("#Crm_Tasks_RemindAt_Start_Date1")).data("mandate",!1),s.data()&&null!=s.data().recdata&&null!=$("#Crm_Tasks_REMINDAT").data().reminderDate&&"clone"!==window.Tasks.currentStatus?crmTasks.openDeleteReminderPop():(crmTasks.removeReminder(),d.parents(".REMINDAT").removeClass("borderNone"),crmBstTime.showHideSuggestionForCreateTask("hide"))}2===crmTemplate.isApproved&&k.hide(),thirdPartyUtils.bindSelect2($(".newChosenSel").find("select"))},showPeriodDetails:function(e,t){var a=t.dataset.oldValue,r=t.value;$("#"+t.id+"daily1").hide(),$("#"+t.id+"monthly1").hide(),$("#"+t.id+"yearly1").hide(),$("#"+t.id+"weekly1").hide();var l=new Date($("#Crm_Tasks_DUEDATE").data("dateObj")),i=$("#"+e+"CustomFrequencyDetails")[0],s="crm.recurring.no.days",n="crm.recurring.no.weeks",o="crm.recurring.no.months",d="edit"==window[e].currentStatus||"clone"==window[e].currentStatus;switch(r){case"None":crmTasks.removeArrayElements(Crm.fieldsObj[e],crmTasks.customDailyFields),crmTasks.removeArrayElements(Crm.fieldsObj[e],crmTasks.customWeeklyFields),crmTasks.removeArrayElements(Crm.fieldsObj[e],crmTasks.customMonthlyFields),crmTasks.removeArrayElements(Crm.fieldsObj[e],crmTasks.customYearlyFields);break;case"daily":var c=[{colname:"RECURRING_DAILY_EVERYDAY_ON",customfield:"false",displaylabel:I18n.getMsg("crm.label.every"),val:I18n.getMsg(s),label:"daily11",mandate:"false",maxlength:"120",readonly:"false",type:"text",uitype:"60",dynamicFields:[{colname:"RECURRING_DAILY_REPEAT_COUNT",defaultvalue:"1",customfield:"false",displaylabel:"",label:"daily111",mandate:"true",maxlength:"2",readonly:"false",type:"int",uitype:"32"}]}];d&&null!=t.dataset.selectedradio&&"daily"===a&&(c[0].dynamicFields[0].defaultvalue=t.dataset.frequency),crmTemplate.createSubFields(e,i,t.id+"daily1",c),null==t.dataset.selectedradio&&crmTemplate.hideTaskBusinessHoliday("daily");break;case"weekly":c=[{colname:"RECURRING_WEEKLY_REPEAT",customfield:"false",displaylabel:I18n.getMsg("crm.label.every"),val:I18n.getMsg(n),label:"weekly11",mandate:"false",maxlength:"120",readonly:"false",type:"text",uitype:"60",dynamicFields:[{colname:"RECURRING_WEEKLY_REPEAT_COUNT",defaultvalue:"1",customfield:"false",displaylabel:"",label:"weekly111",mandate:"true",maxlength:"2",readonly:"false",type:"int",uitype:"32"}]},{colname:"RECURRING_WEEKLY_DAYS",customfield:"false",displaylabel:"",label:"day",mandate:"true",maxlength:"120",readonly:"false",type:"multipicklist",uitype:"100",val:crmTasks.firstLetterDays}];if(d&&null!=t.dataset.frequency&&"weekly"===a&&t.dataset.frequency&&(c[0].defaultvalue=1,c[0].dynamicFields[0].defaultvalue=t.dataset.frequency,t.dataset.seldays))for(var u=t.dataset.seldays.split(","),m=u.length,p=0;p<m;p++)0==p?c[1].defaultvalue=u[p]:c[1].defaultvalue+="; "+u[p];if(crmTemplate.createSubFields(e,i,t.id+"weekly1",c),null==t.dataset.selectedradio){crmTemplate.hideTaskBusinessHoliday("weekly");var f=l.getDay(),v=$("#Crm_Tasks_RECURRING_WEEKLY_DAYS");v.find('input.circleInput[value="'+(f+1)+'"]').prop("checked",!0),v.removeClass("multiSelect select")}break;case"monthly":c=[{colname:"RECURRING_MONTHLY_REPEAT",customfield:"false",displaylabel:I18n.getMsg("crm.label.every"),val:I18n.getMsg(o),label:"",mandate:"false",maxlength:"120",readonly:"false",type:"text",uitype:"60",dynamicFields:[{colname:"RECURRING_MONTHLY_REPEAT_COUNT",defaultvalue:"1",customfield:"false",displaylabel:"",label:"noMonths1",mandate:"true",maxlength:"2",readonly:"false",type:"int",uitype:"32"}]},{colname:"RECURRING_MONTHLY_DAYS",customfield:"false",displaylabel:"",val:[{html:I18n.getMsg("crm.recurrence.custom.month.option1"),value:"1"}],label:"monthly11",mandate:"false",maxlength:"120",readonly:"false",type:"radio",uitype:"17",defaultvalue:"1",dynamicFields:[{colname:"RECURRING_MONTHLY_DAYS_NO",customfield:"false",displaylabel:"",label:"monthly1select",mandate:"true",maxlength:"120",readonly:"false",type:"int",uitype:"28",val:crmConstants.dateArray},{colname:"RECURRING_MONTHLY_MONTH_NO",customfield:"false",displaylabel:"",defaultvalue:1,label:"noMonths1",mandate:"true",maxlength:"120",readonly:"false",type:"int",uitype:"19"}]},{colname:"RECURRING_MONTHLY_DAYS_ON",customfield:"false",displaylabel:"",val:[{html:I18n.getMsg("crm.recurrence.custom.month.option2"),value:"2"}],label:"monthly11",mandate:"false",maxlength:"120",readonly:"false",type:"radio",uitype:"17",dynamicFields:[{colname:"RECURRING_MONTHLY_WEEKSEQUENCE_TYPE",customfield:"false",displaylabel:"",label:"weeksequence",mandate:"false",maxlength:"120",readonly:"false",type:"int",uitype:"28",val:crmCalendar.weekSequence},{colname:"RECURRING_MONTHLY_WEEKSEQUENCE_DAY",customfield:"false",displaylabel:"",label:"weekdays",mandate:"false",maxlength:"120",readonly:"false",type:"int",uitype:"28",val:crmConstants.fullDaysArray},{colname:"RECURRING_MONTHLY_WEEKSEQUENCE_MONTH_NO",customfield:"false",displaylabel:"",defaultvalue:1,label:"noMonths2",mandate:"false",maxlength:"120",readonly:"false",type:"int",uitype:"19"}]}];if(d&&null!=t.dataset.selectedradio&&"monthly"===a)1==t.dataset.selectedradio?(c[1].defaultvalue=1,c[0].dynamicFields[0].defaultvalue=t.dataset.monthdata2,c[1].dynamicFields[0].defaultvalue=t.dataset.monthdata1):(t.dataset.monthdata1="-1"===t.dataset.monthdata1?"5":t.dataset.monthdata1,c[2].defaultvalue=2,c[2].dynamicFields[0].defaultvalue=crmCalendar.weekSequence[t.dataset.monthdata1-1].html,c[2].dynamicFields[1].defaultvalue=crmConstants.fullDaysArray[t.dataset.monthdata2-1].html,c[0].dynamicFields[0].defaultvalue=t.dataset.monthdata3);if(crmTemplate.createSubFields(e,i,t.id+"monthly1",c),$("#Crm_Tasks_RECURRING_MONTHLY_DAYS_ON").on("change",(function(){$("#Tasks_fldRow_NEXT_BUSINESS_HOLIDAY_MONTH").hide()})),$("#Crm_Tasks_RECURRING_MONTHLY_DAYS").on("change",(function(){$("#Tasks_fldRow_NEXT_BUSINESS_HOLIDAY_MONTH").show()})),null==t.dataset.selectedradio){crmTemplate.hideTaskBusinessHoliday("monthly");var h=l.getDate(),g=Math.ceil(h/7),T=l.getDay();$("#Crm_Tasks_RECURRING_MONTHLY_DAYS_NO").find('option[value="'+h+'"]').prop("selected",!0),$("#Crm_Tasks_RECURRING_MONTHLY_WEEKSEQUENCE_DAY").find('option[value="'+(T+1)+'"]').prop("selected",!0),$("#Crm_Tasks_RECURRING_MONTHLY_WEEKSEQUENCE_TYPE").find('option[value="'+g+'"]').prop("selected",!0)}$("#"+t.id+"monthly1").find(".rbCheckHtml").addClass("mR0");break;case"yearly":c=[{colname:"RECURRING_YEARLY_DAYS",customfield:"false",displaylabel:"",val:[{html:I18n.getMsg("crm.recurrence.custom.yearly.option1"),value:"1"}],label:"yearly11",mandate:"false",maxlength:"120",readonly:"false",type:"radio",uitype:"17",defaultvalue:"1",dynamicFields:[{colname:"RECURRING_YEARLY_DAYS_NO",customfield:"false",displaylabel:"",label:"yearlydays1select",mandate:"true",maxlength:"120",readonly:"false",type:"int",uitype:"28",val:crmConstants.dateArray},{colname:"RECURRING_YEARLY_DAYS_OF_MONTH",customfield:"false",displaylabel:"",label:"yearmonths",mandate:"true",maxlength:"120",readonly:"false",type:"int",uitype:"28",val:crmCalendar.monthName}]},{colname:"RECURRING_YEARLY_DAYS_ON",customfield:"false",displaylabel:"",val:[{html:I18n.getMsg("crm.recurrence.custom.yearly.option2"),value:"2"}],label:"yearly11",mandate:"false",maxlength:"120",readonly:"false",type:"radio",uitype:"17",dynamicFields:[{colname:"RECURRING_YEARLY_WEEKSEQUENCE_TYPE",customfield:"false",displaylabel:"",label:"weeksequence1",mandate:"false",maxlength:"120",readonly:"false",type:"int",uitype:"28",val:crmCalendar.weekSequence},{colname:"RECURRING_YEARLY_WEEKSEQUENCE_NO",customfield:"false",displaylabel:"",label:"weekdays1",mandate:"false",maxlength:"120",readonly:"false",type:"int",uitype:"28",val:crmConstants.fullDaysArray},{colname:"RECURRING_YEARLY_WEEKSEQUENCE_MONTH_NAME",customfield:"false",displaylabel:"",label:"yearmonths1",mandate:"false",maxlength:"120",readonly:"false",type:"int",uitype:"28",val:crmCalendar.monthName}]}];if(d&&null!=t.dataset.selectedradio&&"yearly"===a)1==t.dataset.selectedradio?(c[0].defaultvalue=1,c[0].dynamicFields[0].defaultvalue=t.dataset.monthdata2,c[0].dynamicFields[1].defaultvalue=crmCalendar.monthName[t.dataset.monthdata1].html):(t.dataset.monthdata1="-1"===t.dataset.monthdata1?"5":t.dataset.monthdata1,c[1].defaultvalue=0,c[1].defaultvalue=2,c[1].dynamicFields[0].defaultvalue=crmCalendar.weekSequence[t.dataset.monthdata1-1].html,c[1].dynamicFields[1].defaultvalue=crmConstants.fullDaysArray[t.dataset.monthdata2-1].html,c[1].dynamicFields[2].defaultvalue=crmCalendar.monthName[t.dataset.monthdata3].html);if(crmTemplate.createSubFields(e,i,t.id+"yearly1",c),$("#Crm_Tasks_RECURRING_YEARLY_DAYS").on("change",(function(){$("#Tasks_fldRow_NEXT_BUSINESS_HOLIDAY_YEAR").show()})),$("#Crm_Tasks_RECURRING_YEARLY_DAYS_ON").on("change",(function(){$("#Tasks_fldRow_NEXT_BUSINESS_HOLIDAY_YEAR").hide()})),null==t.dataset.selectedradio){crmTemplate.hideTaskBusinessHoliday("yearly");h=l.getDate(),g=Math.ceil(h/7),T=l.getDay();var C=l.getMonth();$("#Crm_Tasks_RECURRING_YEARLY_DAYS_OF_MONTH").find('option[value="'+C+'"]').prop("selected",!0),$("#Crm_Tasks_RECURRING_YEARLY_DAYS_NO").find('option[value="'+h+'"]').prop("selected",!0),$("#Crm_Tasks_RECURRING_YEARLY_WEEKSEQUENCE_TYPE").find('option[value="'+g+'"]').prop("selected",!0),$("#Crm_Tasks_RECURRING_YEARLY_WEEKSEQUENCE_NO").find('option[value="'+(T+1)+'"]').prop("selected",!0),$("#Crm_Tasks_RECURRING_YEARLY_WEEKSEQUENCE_MONTH_NAME").find('option[value="'+C+'"]').prop("selected",!0)}$("#"+t.id+"yearly1").find(".rbCheckHtml").addClass("mR0")}$(i).find('input[type="text"]').addClass("taskInput w40");var b=$("#TasksrecurringDiv");crmTasks.editTask&&crmTasks.isRecurringSaved&&"clone"!==window.Tasks.currentStatus&&(crmTasks.handleRecurChange(b.find("select")),crmTasks.handleRecurChange(b.find("input"))),$("#taskEndPart input").off("change.recurEdit");thirdPartyUtils.bindSelect2($("#TasksrecurringDiv").find("select"),{disable_search_threshold:100})},hideTaskBusinessHoliday:function(e){switch(e){case"daily":$("#Tasks_fldRow_EXCEPT_BUSINESS_HOLIDAY").show(),$("#Tasks_fldRow_NEXT_BUSINESS_HOLIDAY_MONTH").hide(),$("#Tasks_fldRow_NEXT_BUSINESS_HOLIDAY_YEAR").hide();break;case"weekly":case"custom":$("#Tasks_fldRow_EXCEPT_BUSINESS_HOLIDAY").hide(),$("#Tasks_fldRow_NEXT_BUSINESS_HOLIDAY_MONTH").hide(),$("#Tasks_fldRow_NEXT_BUSINESS_HOLIDAY_YEAR").hide();break;case"monthly":$("#Tasks_fldRow_EXCEPT_BUSINESS_HOLIDAY").hide(),$("#Tasks_fldRow_NEXT_BUSINESS_HOLIDAY_MONTH").show(),$("#Tasks_fldRow_NEXT_BUSINESS_HOLIDAY_YEAR").hide();break;case"yearly":$("#Tasks_fldRow_EXCEPT_BUSINESS_HOLIDAY").hide(),$("#Tasks_fldRow_NEXT_BUSINESS_HOLIDAY_MONTH").hide(),$("#Tasks_fldRow_NEXT_BUSINESS_HOLIDAY_YEAR").show()}},returnNextNum:function(e,t,a,r,l){if(field=a[r],!field||"8"!=field.showtype&&"20"!=field.uitype&&"111"!=field.uitype&&"No of comments"!=field.label&&"20"!=field.uitype){var i=[];return i.push(e),i.push(t),i.push(r),i}return l>1?r%l==0?(r=e+2,e+=2):(r=t+2,t+=2):r=t=e+=1,this.returnNextNum(e,t,a,r,l)},showCopyAddressMenu:function(e){var t=renderingUtils.getTargetElem(e),a=$(t).offset();$("#copy").show().css({top:a.top+t.offsetHeight,left:a.left,"min-width":$("#copyAddress").outerWidth()}).attr("data-close","true")},createAddressMenu:function(e){$("#copy").remove();var t=document.body.appendChild(document.createElement("div"));$(t).attr({id:"copy",class:"ddM",position:"absolute"}).hide();var a=t.appendChild(document.createElement("ul")),r=[I18n.getMsg("crm.copy.billing.to.shipping"),I18n.getMsg("crm.copy.shipping.to.billing")];"Contacts"===e&&(r=[I18n.getMsg("crm.copy.mailing.to.other"),I18n.getMsg("crm.copy.other.to.mailing")]);for(var l=0;l<2;l++){var i=a.appendChild(document.createElement("li")),s=i.appendChild(document.createElement("span"));$(s).html(r[l]),0==l?$(i).click((function(){"Contacts"===e?Crm.copyField("secContent_Address_Information",e,"MAILING","OTHER"):Crm.copyField("secContent_Address_Information",e,"BILLING","SHIPPING")})):$(i).click((function(){"Contacts"===e?Crm.copyField("secContent_Address_Information",e,"OTHER","MAILING"):Crm.copyField("secContent_Address_Information",e,"SHIPPING","BILLING")}))}},submitCreate:function(e){var t=$("#save"+e+"Btn");return t.focus(),t[0].click(),!1},downloadedContentLoaded:!1,contentLoaded:function(e,t,a){var r,l;crmTemplate.downloadedContentLoaded=!0,$.isEmptyObject(Crm.layoutRuleJSONData)||(CFRExec.init(Crm.layoutRuleJSONData,t,"edit"),CFRExec.promptIfMandatory=!1,CFRExec.evalRules("edit",!0));for(var i=0;i<e[t].section.length;i++){for(var s=e[t].section[i],n=0;n<s.FL.length;n++){var o=s.FL[n];if("false"===o.readonly){r="Crm_"+t+"_"+o.colname,l=o.uitype;break}}if(r)break}var d=this.getElemIdByColname(t,"EXCHANGERATE");if(Crm.userDetails.CURRENCY_DETAILS[window[t].defaultCurrency]){var c="";c="edit"==e.currentStatus?crmTemplate.recordCurrencyER:Crm.userDetails.CURRENCY_DETAILS[window[t].defaultCurrency].er,$("#"+d).html(c)}"Events"==t&&"Crm_Events_SUBJECT"==r&&"create"===window[t].currentStatus?setTimeout((function(){$("#"+r).select()}),10):"clientPortal"!==e.isFrom&&setTimeout((function(){"2"!==l&&"100"!==l?$("#"+r).focus():$("#"+r).next(".select2").find(".select2-selection").focus()}),10);var u=function(){var e=void 0!==a?a:$("#preHTMLContainer_"+t),r=e.find(".labelValCreate :input");r.on("change",(function(){var e=$(this).closest(".subformParentSection");e.length>0&&e[0].dispatchEvent(new Event("mouseenter")),$(this).trigger("create_edit_clone_DomChange",this)}));for(var l=e.find(".productIdFld"),i=l.length,s=[],n=0;n<i;n++)s[n]=l[n].scrollHeight;for(n=0;n<i;n++)l.eq(n).css({height:s[n]});var o=e.find("crm-user-wrapper");o.on("change",(function(){$(this).trigger("create_edit_clone_DomChange",this)})),o.on("create_edit_clone_DomChange",(function(){crmCommonModule.updateCreateEditJson(this),$(this).trigger("executeFormRules")})),r.on("create_edit_clone_DomChange",(function(){crmCommonModule.updateCreateEditJson(this),$(this).trigger("executeFormRules")})),window.removeEventListener("mouseover",u)},m=function(){!Crm.isHeadless&&crmTemplate.canSetupFormulaDependencies&&(window[t].formulaObj.setupFormulaDependencies(t),crmTemplate.canSetupFormulaDependencies=!1),this.removeEventListener("mouseenter",m)};if("edit"===window[t].currentStatus){window.addEventListener("mouseover",u);var p=document.getElementsByClassName("subformParentSection");p.length>0&&p.forEach((function(e){e.addEventListener("mouseenter",m)}))}else u(),m();if("Contacts"===t&&"edit"===window[t].currentStatus){var f=!1;if($("#Crm_Contacts_ACCOUNTID").val()&&(f=!0),!f){var v=void 0!==Crm.moduleInfo.Accounts?Crm.moduleInfo.Accounts.translatedSingularLabel:"Account",h=$("#Contacts_fldRow_REPORTINGTOCONTACTID");h.attr("class","REPORTINGTOCONTACTID tabDivCreate noclick");var g=I18n.getMsg("crm.contact.hierarchy.Specify_account_name",I18n.getMsg(v));h.attr("onmouseenter","renderingUtils.zctt.showtt('"+g+"');"),h.attr("onmouseleave","renderingUtils.zctt.hidett();"),$("#Crm_Contacts_REPORTINGTOCONTACTID").prop("disabled",!0),$("#Crm_Contacts_REPORTINGTOCONTACTID").autocomplete("disable")}}},setDependentFields:function(e,t,a,r){var l=a?$(a):$(document);Crm.setDependentInvoked=!0;for(var i={},s=0;s<this.dependentFieldsList.length;s++)i[this.dependentFieldsList[s]]=!0;for(var n in i){var o=l.find("#"+n)[0];o&&Crm.setDependent(void 0,e,o,t,r)}if("Potentials"===e&&"setup"!==window[e].currentStatus&&"view"!==window[e].currentStatus&&"crm.tab.module.entity.canvas"!==Lyte.Router.getRouteInstance().transition.target){var d=l.find("#Crm_Potentials_STAGE"),c=d.val().substring(0,d.val().indexOf(":")),u=l.find("#Crm_Potentials_PROBABILITY");u.val(c),u.length<1&&l.find("[id='value_PROBABILITY'],[id='headervalue_PROBABILITY']").text(c),Crm.calculateExpectedRevenue()}Crm.setDependentInvoked=!1},attachCalendarEvent:function(e,t){var a=$(e).data("showexecution");$(e).focusin((function(r){var l,i,s=$(e).data("colname"),n=$(e).data("timeLimit"),o=$("#Crm_Events_REPEATTYPE").val();("STARTDATETIME"!==s&&"ENDDATETIME"!==s||$("#eventRecurringDiv").is(":visible")||void 0===o||"none"===o)&&"APPOINTMENTSTARTTIME"!==s&&("future"===n?l=(new CrmDate).getDateInPattern("mm/dd/yyyy"):("past"===n||isNewCallView&&"CALLSTARTDATETIME"===s)&&(i=(new CrmDate).getDateInPattern("mm/dd/yyyy")),crmCalendar.showCalendar(r,void 0,t,a,void 0,void 0,l,i),setTimeout((function(){$(e).is(":visible")||crmCalendar.close()}),500))})).focusout((function(e){e.relatedTarget&&"todayBtn"!==e.relatedTarget.id&&"executionDayBtn"!==e.relatedTarget.id&&!/\b(cdate|calNav|sel|crmBodyWin)\b/.test(e.relatedTarget.className)&&crmCalendar.close()})).click((function(r){var l,i,s=$(e).data("colname"),n=$(e).data("timeLimit");("STARTDATETIME"!==s&&"ENDDATETIME"!==s||$("#eventRecurringDiv").is(":visible")||void 0===$("#Crm_Events_REPEATTYPE").val()||"none"===$("#Crm_Events_REPEATTYPE").val())&&("future"===n?l=(new CrmDate).getDateInPattern("mm/dd/yyyy"):("past"===n||isNewCallView&&"CALLSTARTDATETIME"===s)&&(i=(new CrmDate).getDateInPattern("mm/dd/yyyy")),$("#Calendar").is(":visible")||crmCalendar.showCalendar(r,void 0,t,a,void 0,void 0,l,i),renderingUtils.stopEvent(r))})),$(e).keyup((function(e){crmCalendar.calendarNode=this;var t=this.value,a=e.keyCode,r=$(this).data("datepattern")?$(this).data("datepattern"):Crm.userDetails.DATE_PATTERN;if(9!=a&&Utils.isValidDate(r,t)){var l=crmCalendar.getDateObjectFromGivenDateString(t);l&&crmCalendar.updateDatePicker(e,void 0,void 0,l)}}))},createLookUpClearImage:function(e){var t,a={"data-cid":"clearLookup","data-zcqa":"lookup_"+(t=e.uitype===CrmField.UITYPES.MULTI_MODULE_LOOK_UP_ENTITY.toString()?e.relatedToAttrObj.id:e.attrObj.id).split("_")[2]+"_close",src:networkUtils.getImageUrl("spacer.gif",ResourceConstants.CRM),width:"15",height:"10",title:"",align:"absmiddle",id:t+"_img",class:"clear_lookupfield lookup_hIconO dIB svgIcons ico-close-small2 mL5 op5 pR cP fR mR10 hIconO",tabIndex:e.tabIndex+1},r=document.createElement("img");if($(r).attr(a),!e.isOprDenied)return $(r).attr(a),$(r)[0].outerHTML;$(r).attr(a).attr("display","none")},createLookUpLoadImage:function(e){var t=e.attrObj.id,a={src:networkUtils.getImageUrl("Spin_lightmode.gif",ResourceConstants.CRM),width:"25",height:"25",align:"absmiddle",id:t+"_loadimg",class:"vH pA lookuploader bottom5",tabIndex:e.tabIndex+2,"data-image-mode":"true"},r=document.createElement("img");return r.setAttribute("lt-prop-aria-keydown","true"),r.setAttribute("aria-label",I18n.getMsg("Select")),$(r).attr(a),$(r)[0].outerHTML},clearLookup:function(e,t){var a=$(t).attr("id").replace("_img","");$("#"+a).removeAttr("title"),Crm.clearLookup($("#"+a))},createLookUpImage:function(e,t){var a;a=t.uitype===CrmField.UITYPES.MULTI_MODULE_LOOK_UP_ENTITY.toString()?t.relatedToAttrObj.id:t.attrObj.id;var r,l=t.lookupmodule,i=l+"-small",s=t.tabIndex+2;if((/CustomModule[0-9]/.test(l)||"Events"===e||"Calls"==e||"Tasks"===e)&&(i="lookup newSearchIcon"),"221"!==t.uitype&&"55"!==t.uitype||void 0!==l&&""!==l||(i="true"==t.readonly?"noevents":"changeUserIcon svgIcons ico-search-users lookupIconChange"),r="setup"!==window[e].currentStatus?{"data-module":e,"data-label":a,"data-lookup-module":l,"data-cid":"showLookup","data-zcqa":"lookup_"+a.split("_")[2],src:networkUtils.getImageUrl("spacer.gif",ResourceConstants.CRM),width:"17",height:"19",title:"",align:"absmiddle",id:a+"_img",class:i+" lookup_hIconO fR mR5 hIconO",tabIndex:s,"data-criteria":""}:{"data-module":e,"data-label":a,"data-lookup-module":l,"data-cid":"","data-zcqa":"lookup_"+a.split("_")[2],src:networkUtils.getImageUrl("spacer.gif",ResourceConstants.CRM),width:"17",height:"19",title:"",align:"absmiddle",id:a+"_img",class:i+" lookup_hIconO fR mR10 hIconO",tabIndex:s,"data-criteria":""},"221"!==t.uitype&&"55"!==t.uitype||void 0!==l&&""!==l||(r={"data-module":e,"data-label":a,"data-lookup-module":l,"data-cid":"userLookup","data-zcqa":"lookup_"+a.split("_")[2],src:networkUtils.getImageUrl("spacer.gif",ResourceConstants.CRM),width:"17",height:"19",title:"",align:"absmiddle",id:a+"_img",class:i+" lookup_hIconO fR mR5 hIconO",tabIndex:s,"data-criteria":""}),Crm.isInventoryModule(e)&&"BOOKID"===t.colname&&Crm.moduleInfo.PriceBooks){var n=Crm.moduleInfo.PriceBooks.translatedSingularLabel;n=n.replace(/\s+/g,"").trim(),r.title=I18n.getMsg("PriceBookNameLookUp",n)}var o=document.createElement("img");return o.setAttribute("lt-prop-aria-keydown",!0),$(o).attr(r).addClass(i),$(o)[0].outerHTML},showUserLookup:function(e){var t=$(e).closest("div"),a=$(t).attr("id").replace("temp_",""),r=$("#"+a);crmTemplate.showLookup(void 0,r)},userLookup:function(e){var t=renderingUtils.getTargetElem(e),a=$(t).data().label;validationUtils.isNotEmpty($("#"+a))&&$("#"+a+" crux-user-lookup")[0].cxProp("show",!0)},showLookup:function(e,t){var a;if(a=e?renderingUtils.getTargetElem(e):t,!$(a).closest(".zcanvas-field").hasClass("zc_disabledstate")){var r=document.getElementById($(a).data("label"));if(r&&r.getAttribute("isoprdenied"))return renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error")),void $L(window).scrollTo(0,0);var l=document.getElementById("Crm_Appointments_SEID");if(!(l&&l.selectedOptions&&moduleRecordMapping.Unknown&&moduleRecordMapping.Unknown.module_name===l.selectedOptions[0].dataset.modulenameDisabled)){var i=a.id;if("IMG"===a.nodeName){var s=$(a).attr("id");(t=$("#"+s.replace("_img","_label_select")))[0]||(t=$("#"+s.replace("_img","_select")))}else if("addToCampaignsTool"===i)crmTemplate.fromAddToCampaignTool=!0;else{t=$("#"+$(a).attr("id")+"_label_select");a=$("#"+$(a).attr("id")+"_img"),t[0]||(t=$("#"+$(a).attr("id")+"_select"))}var n=$(a).data();if(n){var o=n.label,d=$("#"+o).data();if(t[0])var c=t.val();else c=n.lookupModule;var u,m=d?d.linkingmodule:void 0,p=d?d.subformdisplaylabel:void 0,f=Crm.isLineItemSubFormModule(p),v=n.criteria||d&&d.criteria;try{if(v=v&&"undefined"!==v?v:"",n.criteria=v,d&&(d.criteria=v),Lyte.registeredMixins["crm-create-init-mixin"].getLyteCreateComponentForCscript()){const e=$L(`[fld-id=${n.label}]`);if(e&&e.length){const{criteria:t}=e[0].component.data.moduledataUicomp;t&&(n.criteria=v={criteria:t.criteria,...t.config},d&&(d.criteria=v))}}else{const e=$(`#${n.label}`).attr("data-criteria");e&&(v!==e||Lyte.registeredMixins["crm-detailcanvas-utils"]&&Lyte.registeredMixins["crm-detailcanvas-utils"].isFormViewCommonCheck())&&(n.criteria=v=JSON.parse(e),d&&(d.criteria=v))}}catch(e){v="",murphy.error(e)}if("PriceBooks"==c)if(d&&void 0!==p&&f&&!1===d.customfield){var h=$(productDetails.sfFldIdSuffix+"PRODUCTID_"+$(a).closest("tr").data("data-rowid"));u=h.data("id")}else{var g=/.*?(\d+)/g.exec(a.id);g=g?g[1]:"",u=$("#Crm_"+c+"_txtProduct"+g).data("id")}else"Products"==c?u=d&&f&&"PurchaseOrders"===n.module&&!1===d.customfield?$("#Crm_"+n.module+"_VENDORID").data("id"):$("#Crm_"+c+"_VENDORID").data("id"):"Contacts"==c&&"Potential"==c&&(u=$("#Crm_Potentials_ACCOUNTID").data("id"));if(d&&f&&"PriceBooks"===c&&"BOOKID"===d.colname||!Crm.userDetails.isLookupAdvancedSearchEnabled||void 0!==m){var T,C;n.fromaddcamppopup&&(T=n.campaignid||!0),d&&(d.permissionDeniedLookup&&!c&&(c=d.permissionDeniedLookup),d.lookupModule&&d.permissionDeniedLookup&&(d.permissionDeniedLookup=null),C=d.permissionDeniedLookup),Crm.showLookUp(n.module,o,o,c,c,u,null,u,null,null,null,null,null,null,m,null,T,null,C,p,null,encodeURIComponent(JSON.stringify(v)))}else{var b="",_=networkUtils.returnDependencyFiles(["crm-entity-lookup.js","crux-lookupfilter-component.js","crux-column-list.js"],ResourceConstants.CRMClient);_=_.concat(networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("Lookup")],ResourceConstants.CRM));var y=[];Crm.userDetails.RTL_ENABLED&&(y=networkUtils.returnDependencyFiles(["crm-entity-lookup-rtl.css"],ResourceConstants.CRMClient));var I=_.concat(y);Lyte.injectResources(I,void 0,(function(){function e(){b.labelName=o,b.lookupModule=c,b.searchModule=c,b.parentModule=n.module,Crm.moduleName=n.module,b.subformsectionlabel=d?d.subformsectionlabel:void 0,b.linkingmodule=m;var e=document.getElementById("lookupListPopup"),t=$("#"+o+"_label"),a=$("#"+n.label);if(!e){"PRODUCTDETAILS"===b.colname&&(t=a.closest("td.pR")),d&&d.subformsectionlabel&&(t=a.closest("td"));var r=$("#"+o);0==$(t).length&&(t=r.closest("span.labelValTwo"),0==$(t).length&&(t=$("#addToCampaignsTool").closest("div"))),0==$(t).length&&(t=r),(u=document.createElement("crm-entity-lookup")).component&&u.component.setData("reqData",{}),t.append(u),e=document.getElementById("lookupListPopup")}if(CScriptLib){const e=$(`#${n.label}`).attr("data-criteria-str");if(e)b.defaultCriteriaStr=e;else if(d){const e=$("#mouseArea__"+d.colname).attr("data-criteria-str");e&&(b.defaultCriteriaStr=e)}}var l=$("crm-entity-lookup")[0].component;l.layersAnalystAgent(l,void 0,b,void 0,!0);let i=!1;if("import"===Lyte.Router.getRouteInstance().routeName){var s=store.peekRecord("field",d.fieldid);if(s&&s.lookup&&s.lookup.query_details&&s.lookup.query_details.criteria){let e=function e(t){if(!t.group)return"field"===t.type;{let r=t.group[0],l=t.group[1];var a=e(r);if(a)return!0;if(a=e(l))return!0}}(s.lookup.query_details.criteria);e&&(_cruxUtils.showMsgBand("error","Cannot assign default values to this field",5e3),i=!0)}}if(!i){let e=document.getElementById("lookupListPopup");if(!e){"PRODUCTDETAILS"===b.colname&&(t=a.closest("td.pR")),d&&d.subformsectionlabel&&(t=a.closest("td"));let r=$("#"+o);var u;0===t.length&&(t=r.closest("span.labelValTwo"),0===t.length&&0===(t=$("#addToCampaignsTool").closest("div")).length&&(t=r)),(u=document.createElement("crm-entity-lookup")).component.setData("reqData",{}),t.append(u),e=document.getElementById("lookupListPopup")}let r=$("crm-entity-lookup")[0].component;r.layersAnalystAgent(r,void 0,b,void 0,!0)}}var t;(b=$.extend({},b,n,d,u,null),store.peekRecord("field",b.fieldid))?e():(f?t=o.split("_")[2]:moduleRecordMapping[n.module]&&(t=moduleRecordMapping[n.module].id),t&&Lyte.resolvePromises([store.findRecord("module",t)]).then((function(){e()}),(function(){renderingUtils.showCustomAlert("Error while fetching subform data")})))}))}}}}},formatFieldValues:function(e,t,a,r,l){let i,s;const n=/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])$/;if("view"===a){i=e.val().trim(),i||(i=8===t&&l&&"Tasks"===l?$("#Crm_Tasks_SMOWNERID").data().id:221===t?e[0].component.data.dataId:e.text().trim());let a=$L("#mouseArea__"+r[0].column_name);if(a&&a[0]&&a[0].dataset&&(s=JSON.parse(a[0].dataset.params)),i)301===t?i=e.is(":checked"):n.test(i)||202!==t&&24!==t||(i=$L.moment(i,Crm.userDetails.DATE_PATTERN.toUpperCase()).i18N("YYYY-MM-DD"));else if(143!==t&&144!==t&&145!==t&&36!==t||!s)if(52===t||32===t)i=i.replaceAll(",","");else if(24===t)i=$L.moment(i,"MMM DD, YYYY").i18N("YYYY-MM-DD");else if(333===t)i=$L.moment(i,"DD/MM/YYYY HH:mm A").i18N("YYYY-MM-DDTHH:mm:ss");else if(133!==t&&221!==t||!s)if(33===t&&s)i=s.dbPhoneValue;else if(100===t&&s){let e=s.defaultvalue.split(";"),t=e.length;i=[];for(let a=0;a<t;a++)i.push(e[a].trim())}else 221!==t&&8!==t&&55!==t||!s||(i=s.defaultid);else i=s.defaultid;else i=s.defaultvalue}else if("quickCreate"===a||"blueprint"===a||"formRule"===a||"FOLPopUp"===a||"taskPopUp"===a)if(133===t)i=e.val()&&e.attr("data-selectedid")?e.attr("data-selectedid"):null;else if(221===t||8===t)i=e.attr("data-id")?e.attr("data-id"):null;else if(301===t)i=e.is(":checked");else if(333===t){if("quickCreate"===a){var o=$L("#"+CSS.escape("property(")+r[0].column_name+CSS.escape("time)")).val(),d=$L("#"+r[0].column_name+"_ampmSpan").text().toLowerCase();if(o=d?o+" "+d:o,e.val()){i=$L.moment(e.val(),Crm.userDetails.DATE_PATTERN.toLocaleUpperCase()).i18N("YYYY-MM-DD")+"T"+$L.moment(o,Crm.userDetails.TIME_FORMAT).i18N("HH:mm:ss")}else i=null}else if("formRule"===a||"FOLPopUp"===a){let t=e[0].value,a=$L($L($L("#"+l+"_fldRow_"+r[0].column_name).children().eq(1)).children().eq(2)).val();var c=$L.moment(a,Crm.userDetails.TIME_FORMAT).i18N("HH:mm:ss");if(!c){let e=Crm.userDetails.TIME_FORMAT.replace("a","A");c=$L.moment(a,e).i18N("HH:mm:ss")}var u=$L.moment(t,Crm.userDetails.DATE_PATTERN).i18N("YYYY-MM-DD");if(!u){var m=Crm.userDetails.DATE_PATTERN.toUpperCase();u=$L.moment(t,m).i18N("YYYY-MM-DD")}i=u+"T"+c}}else if(100===t){var p;p="blueprint"===a?Lyte.Router.getRouteInstance().transition.data.primary_module:l,i="quickCreate"===a?$("#createEntityForm")[0].querySelector(".Crm_"+p+"_"+r[0].column_name).options.filter((e=>e.selected)).map((e=>e.value)):"formRule"===a?$L("#formRuleMandatoryFields #Crm_"+p+"_"+r[0].column_name)[0].options.filter((e=>e.selected)).map((e=>e.value)):$("#multipleFieldsEditPop")[0].querySelector("#"+p+"_fldRow_"+r[0].column_name).querySelector("select").options.filter((e=>e.selected)).map((e=>e.value))}else i=e.val(),24!==t&&202!==t||(i=Lyte.Transform[r[0].data_type].serialize(i,r[0].api_name)),i||("blueprint"!==a&&"FOLPopUp"!==a&&"formRule"!==a||110!==t||(i=e[0].component.data.cxPropValue),i||(i=null));return i},iterateGroupFieldsAndGetFieldValues:function(e,t,a,r,l){if(e){var i=e.group;if(i){if(i.length>1){var s=e.group[0],n=e.group[1];crmTemplate.iterateGroupFieldsAndGetFieldValues(s,t,a,r,l),crmTemplate.iterateGroupFieldsAndGetFieldValues(n,t,a,r,l)}}else{var o=e.value;let i;o="object"==typeof o?o.api_name:o;let s=!1;if("field"===e.type){o.includes(".")&&o.split(".")[0].endsWith("__r")?(s=!0,i=3===o.split(".").length?o.split(".")[0]+o.split(".")[1]:o):i=o.split(".")[0];let e=$("#createEntityForm").is(":visible"),n=$("#multipleFieldsEditPop").is(":visible"),h=$L("#dealCreateConfigurationModal").is(":visible"),g=$L("#formRuleMandatoryFields").is(":visible"),T=$L("#VRAjaxEdit").is(":visible"),C=$L("#newRelatedListPopUpDiv").is(":visible"),b=t.filter((function(e){if(e.api_name===i)return e}));if(b&&b.length>0){var d,c,u=b[0].ui_type;if(C)d=$L("#newRelatedListPopUpDiv #Crm_"+r+"_"+b[0].column_name),c=crmTemplate.formatFieldValues(d,b[0].ui_type,"taskPopUp",b,r),a[i]=c;else if(n){var m=[];let e=$L("#multipleFieldsEditPop #duringTabs").find(".sel");if(ProcessFlow.getAllRelatedModulesInDuringTrans(m),m.length){let t="fieldsContainer_header"!==e.attr("id");if(t){let t=e.attr("data-tab").split("_")[0],a="Crm_"+r+"_"+t+"_"+b[0].column_name;if(s){let e=l.index;a="Crm_"+r+"_"+l.subformTabId+"_"+b[0].column_name+"_"+e,d=$L("#duringTabDivs #"+a)}else if(l&&l.isSubformField)d=$L("#"+a);else{d=crmLookupAutoComplete.fldName.split("_")[2]===t?$L("#"+a):$L("#duringTabDivs #Crm_"+r+"_"+t+"_"+b[0].column_name)}}else d=$L("#duringTabDivs #Crm_"+r+"_"+b[0].column_name);t||(d=$L("#duringTabDivs #Crm_"+r+"_"+b[0].column_name))}else d=$L("#duringTabDivs #Crm_"+r+"_"+b[0].column_name);if(d&&d.is(":visible")){let e=[];if(s&&(i=i.split(".")[1]),133===u)c=crmTemplate.formatFieldValues(d,u,"blueprint",b);else if(2===u)(c=$L(d.children[1]).eq(0).find("select").val())||(c=d.val());else if(333===u){let e=d.val();if(e){let t=$L($L($L("#"+r+"_fldRow_"+b[0].column_name).children().eq(1)).children().eq(2)).val();var p=$L.moment(t,Crm.userDetails.TIME_FORMAT).i18N("HH:mm:ss");if(!p){let e=Crm.userDetails.TIME_FORMAT.replace("a","A");p=$L.moment(t,e).i18N("HH:mm:ss")}var f=$L.moment(e,Crm.userDetails.DATE_PATTERN).i18N("YYYY-MM-DD");if(!f){var v=Crm.userDetails.DATE_PATTERN.toUpperCase();f=$L.moment(e,v).i18N("YYYY-MM-DD")}c=f+"T"+p}}else 301===u||221===u?c=crmTemplate.formatFieldValues(d,u,"blueprint",b):8===u?(d=$L("#duringTabDivs #ownerNameLookupSpan"))&&((c=d[0].getAttribute("userid"))||(c=(d=$L("#duringTabDivs #Crm_"+r+"_"+b[0].column_name)).data().id)):c=crmTemplate.formatFieldValues(d,u,"blueprint",b);s?Object.keys(a).contains(l.subformApiName)?(e=a[l.subformApiName],e[0][i]=c,a[l.subformApiName][0]=e[0]):(e.push({[i]:c}),a[l.subformApiName]=e):a[i]=c}else if(2===u){let e=$L("#"+r+"_fldRow_"+b[0].column_name);if(e&&e[0]&&"none"===e[0].style.display){let e=$L(d.eq(0)).data().fieldid;e&&e.toString()===b[0].id&&(c=ProcessFlow.currentTransitionDetails.ToStateActualValue,a[i]=c)}}}else if("view"!==window[r].currentStatus||e)if(Crm.isInventoryModule(r))(d=document.getElementById("Crm_"+r+"_"+b[0].column_name))&&(c=d.value);else if(e){let e=[133],t=[221];d=[24,333,202].includes(u)?$L("#createEntityForm #"+CSS.escape("property(")+b[0].column_name+CSS.escape(")")):e.includes(u)?$L("#createEntityForm #"+b[0].column_name):t.includes(u)?$L("#createEntityForm #Crm_User_"+r+"_"+b[0].column_name):$L("#createEntityForm #Crm_"+r+"_"+b[0].column_name),c=crmTemplate.formatFieldValues(d,u,"quickCreate",b,r),a[i]=301===u?!!c:c||null}else if(h){let e=$L(".createRecord_field_"+b[0].api_name)[0].component.data;switch(b[0].ui_type){case 24:case 333:c=null;break;case 100:c=e.displayValue;break;default:c=e.cxPropValue}a[i]=c}else c=(d=$L("#Crm_"+r+"_"+b[0].column_name)).value,"Tasks"===r&&(c=d.val()),c=crmTemplate.formatFieldValues(d,u,"view",b,r),a[i]=c;else T?d=$L("#VRAjaxEdit #Crm_"+r+"_"+b[0].column_name):g&&(!(d=$L("#formRuleMandatoryFields #Crm_"+r+"_"+b[0].column_name))||d.length<1)&&(d=$L("#Crm_"+r+"_"+b[0].column_name)),d&&d.length&&(c=crmTemplate.formatFieldValues(d,b[0].ui_type,T?"FOLPopUp":"formRule",b,r),a[i]=c)}}}}},create:function(e,t,a,r,l){this.dependentFieldsList=[],Crm.isHeadless||(window[t].formulaObj=new crmFormulaInit,window[t].formulaObj.resetProps()),e.module=t,e.showHelp="create"===window[t].currentStatus,e.showEdit=Crm.userDetails.permissions.Crm_Implied_Customize_Zoho_CRM,e.currentStatus=window[t].currentStatus,e.dependentFields=this.getFieldsInDependency(t),Handlebars.registerPartial("toolTipTemplate",Handlebars.templates.toolTipTemplate);var i,s,n=null,o=null,d=e[t].section.length;if("Appointments"==t)for(var c=d-1;c>=0;c--)if(Crm.isAppAction&&"appointmentCompletePopup"!==Crm.isAppAction){if("Reschedule Information"===Crm.isAppAction&&"Appointment Information"===e[t].section[c].systemName)for(var u=e[t].section[c].FL.length,m=0;m<u;m++)"APPOINTMENTDATEANDTIME"===e[t].section[c].FL[m].colname&&(n=e[t].section[c].FL[m]),"SMOWNERID"===e[t].section[c].FL[m].colname&&(o=e[t].section[c].FL[m]),"CURRENCYISOCODE"===e[t].section[c].FL[m].colname&&(i=e[t].section[c].FL[m],detailView.rescheduleAppSection.isCurrency=!0);if("Cancellation Information"===Crm.isAppAction&&"Appointment Information"===e[t].section[c].systemName){var p=e[t].section[c].FL.length;for(m=0;m<p;m++)"CURRENCYISOCODE"===e[t].section[c].FL[m].colname&&(s=e[t].section[c].FL[m],detailView.cancelAppSection.isCurrency=!0)}"Reschedule Information"===e[t].section[c].systemName&&(detailView.rescheduleAppSection=e[t].section[c]),"Cancellation Information"===e[t].section[c].systemName&&(detailView.cancelAppSection=e[t].section[c]),e[t].section[c].systemName!==Crm.isAppAction&&e[t].section.splice(c,1)}else"Appointment Information"!==e[t].section[c].name&&e[t].section.splice(c,1);var f=e[t].section;f.length||(e[t].section=f=[f]);for(var v=e[t].section.length,h=0;h<v;h++){if("Record Image"===e[t].section[h].name){e.modulelogo=!0,e.pfReadOnly="true"===e[t].section[h].FL.readonly,"setup"==e.currentStatus&&(CMB.oCHolder.isProfileImageAvailable?e.modulelogo=!0:CMB.oCHolder.isProfileImageAvailable||(e.modulelogo=!1),e.pfReadOnly="true"===e[t].section[h].FL[0].readonly),"edit"==e.currentStatus?(e.imgId=t+"_"+e.entityId+"_photo",null!=e.photoFileId?(e.imgSrc=Crm.getCrmBasePath()+"/EntityImageAttach.do?action_module="+t+"&entityId="+e.entityId+"&actionName=readImage&fileId="+e.photoFileId,e.imgSrc=networkUtils.getPortalURL(e.imgSrc)):"Leads"===t||"Contacts"===t?e.imgSrc=networkUtils.getImageUrl("user_profile_lightmode.svg",ResourceConstants.CRM):-1!==t.indexOf("CustomModule")||"Vendors"===t||"Products"===t||"Cases"==t||"Solutions"==t||"Potentials"==t?e.imgSrc=networkUtils.getImageUrl("image_pholder_lightmode.svg",ResourceConstants.CRM):e.imgSrc=networkUtils.getImageUrl("companylogonew.svg",ResourceConstants.CRM)):"clone"==e.currentStatus&&null!=e.photoFileId?e.imgSrc=Crm.getCrmBasePath()+"/EntityImageAttach.do?action_module="+t+"&actionName=readImage&fileId="+e.photoFileId:(e.imgId=t+"_photo","Leads"===t||"Contacts"===t?e.imgSrc=networkUtils.getImageUrl("user_profile_lightmode.svg",ResourceConstants.CRM):-1!==t.indexOf("CustomModule")||"Vendors"===t||"Products"===t||"Cases"==t||"Solutions"==t||"Potentials"==t?e.imgSrc=networkUtils.getImageUrl("image_pholder_lightmode.svg",ResourceConstants.CRM):e.imgSrc=networkUtils.getImageUrl("companylogonew.svg",ResourceConstants.CRM));break}if(e.modulelogo=!1,"Appointments"==t){if("Reschedule Information"===e[t].section[h].name){var g=e[t].section[h].FL.length;for(c=0;c<g;c++)if("RESCHEDULEDTO"===e[t].section[h].FL[c].colname){e[t].section[h].FL[c]=n;break}e[t].section[h].FL[g]=o,i&&(e[t].section[h].FL[g+1]=i)}if("Cancellation Information"===e[t].section[h].name){var T=e[t].section[h].FL.length;s&&(e[t].section[h].FL[T]=s)}}}crmTemplate.isApproved=e.isApproved,crmTemplate.record_modification=e.record_modification,crmTemplate.approval_buttons=e.approval_buttons,0!=fileupload.uploadedFileObject.length&&(fileupload.uploadedFileObject.length=0);var C=store.peekAll("wizard"),b=[];if(C&&C.length&&C.forEach((function(a){if(!a.$.isNew&&a.module.module_name===t&&a.active){b.push(Object.assign({},a));var r=e.layout_jsonarrayObj.layout_jsonarrayObj.map((function(e){return e.LAYOUTID}));a.layouts.forEach((function(e,t){r.contains(e.id)||b[b.length-1].layouts.splice(t,1)})),b[b.length-1].layouts.length<=0&&b.pop(a)}})),e.layout_jsonarrayObj){var _=e.layout_jsonarrayObj.layout_jsonarrayObj,y=b.length;for(c=0;c<y;c++)b[c].isWizard=!0,_.push(b[c]);e.layout_jsonarrayObj.layout_jsonarrayObj=_,b.length>=1&&(e.isWizard=!0,e.showLayoutLabel=!0)}if(e.isFrom&&"clientPortal"===e.isFrom){var I=e.layout_jsonarrayObj.layout_jsonarrayObj;let t=I.length;for(var E=[],D=0,F=!1,S=[],w=[],R=!1,A=0;A<t;A++)if(I[A].PRIMARYLAYOUTID){(0===w.length||w.length>0&&!w.contains(I[A].PRIMARYLAYOUTID))&&D++,w.contains(I[A].PRIMARYLAYOUTID)&&(R=!0),w.push(I[A].PRIMARYLAYOUTID);var L=e.layout_jsonarrayObj.layout_jsonarrayObj.filter((function(e){return e.isWizard&&e.id===I[A].PRIMARYLAYOUTID}));if(L.length>0){var N=L[0].layouts;let e=N.length;for(var k=0;k<e;k++)if(I[A].LAYOUTID===N[k].id){N[k].selectedInPortals=!0;break}}e.layout_jsonarrayObj.sysLayoutId===I[A].LAYOUTID&&(F=!0)}else E.push(I[A]),I[A].STATUS&&S.push(I[A].LAYOUTID);let a=E.length;if(D!==a&&0!==S.length||(e.showLayoutLabel=!1),0===D||1===D&&1===a&&!R||0===S.length&&1===D&&!R)e.isWizard=!1;else if(F&&D<a)for(var O=0;O<a;O++)if(E[O].STATUS){E[O].ISSYSTEMLAYOUT=!0;break}if(D>0)for(var M=0;M<a;M++)if(E[M].isWizard){var U=E[M].layouts,x=[];let e=U.length;for(k=0;k<e;k++)U[k].selectedInPortals&&!0===U[k].selectedInPortals&&x.push(U[k]);x.length>0?E[M].layouts=x:E[M].isWizard=!1}e.layout_jsonarrayObj.layout_jsonarrayObj=E}var P=$(Handlebars.templates.crmCreateLayout(e));"create"!=e.currentStatus&&"edit"!=e.currentStatus&&"setup"!=e.currentStatus&&"clone"!=e.currentStatus||e.imgSrc!==networkUtils.getImageUrl("user_profile_lightmode.svg",ResourceConstants.CRM)&&e.imgSrc!==networkUtils.getImageUrl("companylogonew.svg",ResourceConstants.CRM)&&e.imgSrc!==networkUtils.getImageUrl("image_pholder_lightmode.svg",ResourceConstants.CRM)||P.find("#preHTMLContainer_"+t).find(".lnPhoto").addClass("lnPhotoHover");var H=crmTemplate.createSectionLayout(e,t,r,l);P.find("#preHTMLContainer_"+t).append(H);var B="#preHTMLContainer_"+t,V=P.find(B);return-1===crmTemplate.arrayNewClass.indexOf(t)||"Calls"===t&&isNewCallView?V.addClass("newInputStyleEle"):V.addClass("noNewInputStyleEle"),Crm.userDetails.CLIENT_ACCOUNT&&V.addClass("clientportalenabled"),"setup"!=window[t].currentStatus&&P.find("#rwb").eq(0).append($(Handlebars.templates.crmCreateButtonLayout(e))),setCurrencySymbol(t,P),"Events"!==t&&(window.onscroll=fixedBtnFnCreate),P},getElemIdByColname:function(e,t){var a="Crm_"+e;return a+="setup"===window[e].currentStatus?"_setup_":"_",a+=t},getFieldsInDependency:function(e){for(var t={},a=objectUtils.getKeys(Crm.fieldDependency[e]),r=0;r<a.length;r++)for(var l=objectUtils.getKeys(Crm.fieldDependency[e][a[r]]),i=0;i<l.length;i++)"CALLTYPE"!=l[i]&&(t[l[i]]=!0);return t},arrayNewClass:["Events","Calls","Tasks"],lookupNewStylePopupId:"topBandPopup",setPreviousValueToContainer:!1,memberDataStoreLI:""};function currencyForVariables(e){return e&&""!=e||(e=Crm.userDetails.defaultOrgCurrency?Crm.userDetails.defaultOrgCurrency:""),e}function setFocusClass(e){if(e=e.currentTarget){var t=$(e).data("uitype");$(e).prop("tagName");if($(".labelValCreate").removeClass("focusEleField"),"3"!=t&&"110"!=t||($("#span_tarea").remove(),$(e).off("keyup focus").on("keyup focus",(function(){if(0==$("#span_tarea").length){var t=parseFloat($(e).outerWidth()),a=$("<span>");a.attr({id:"span_tarea",class:"dIB newgraybtn"}).css({"font-size":"1rem","overflow-y":"scroll","line-height":"18px",width:t}),$("body").append(a)}var r=$("#span_tarea");r.text($(e).val());var l=18*parseInt(r.outerHeight()/18);l>354?(r.remove(),$(e).css({height:"354px"})):(l=l<=18?54:l+30,$(e).css({height:l}))}))),"123"!=t&&($(e).closest(".labelValCreate,.tabDiv").addClass("focusEleField"),"saveCancelSpan"==$(e).next().attr("id")&&$(e).off("blur",removeFocusClass)),"786"==t||"301"==t){var a=$(e);"checkbox"===a.attr("type")&&a.addClass("cb-focus")}return $(e).closest(".tabDivCreate").find(".infotoolTip").css("visibility","visible").addClass("infoTTStay"),!0}}function removeFocusClass(e){var t;if(e=e.currentTarget,$(e).closest(".labelValCreate,.tabDiv").removeClass("focusEleField"),3==(t=$(e).data("uitype"))||110==t){if($(e).outerHeight()>360)return $("#span_tarea").remove(),!1;var a=$(e),r=$("#span_tarea");r.text(a.val());var l=""===a.val()?18:a.height();a.css({height:l}),r.remove()}if("786"==t||"301"==t){var i=$(e);"checkbox"===i.attr("type")&&i.removeClass("cb-focus")}return $(e).closest(".tabDivCreate").find(".infotoolTip").css("visibility","hidden").removeClass("infoTTStay"),!0}function setSubfrmFocusClass(e){if((e=$(e.currentTarget)).closest("table").hasClass("subformTabl")){$(".topband_dv_row").removeClass("txtFldFocusedRow"),$(".topband_dv_row div").removeClass("focusEleField"),e.is("[readonly]")?e.closest("div").removeClass("focusEleField"):e.closest("div").addClass("focusEleField"),e.closest("tr").addClass("txtFldFocusedRow");var t=e.data("uitype");if(-1===[24,202,301,333].indexOf(t)){110!==t&&3!==t||$("#span_tarea").remove();e.val();e.off("keyup focus paste").on("keyup focus paste",(function(a){var r=$(this),l=$(r).outerWidth(),i=$(".subFrmTempwidthCalElm");i.text(e.val());i.outerWidth();var s=i.outerHeight();Crm.isLineItemSubFormModule(r.data("subformdisplaylabel"))&&"PRODUCTID"===r.data("colname")||555!==t&&e.css("height",s);e.closest(".subFrmTablWrapper").outerHeight();var n=e.closest("td").index(),o=e.closest("td").outerWidth();if(setTimeout((function(){var t=e.closest("td").outerHeight()-9;e.closest(".subformTabl").find(".tableHeadBg td").eq(n).css("min-width",o),e.closest(".subFrmTablWrapper").find(".subFrmSnFld").length>0&&e.closest(".subFrmLayout").find(".subFrmTablSerlNoOverlay tbody tr").eq(e.closest("tr").index()).find("td .labelValCreate").css("height",t),e.closest(".subFrmLayout").find(".SubFrmScrolIn").length>0&&e.closest(".subFrmLayout").find(".SubFrmScrolIn").css("height",e.closest(".subFrmTablWrapper").outerHeight()-20)}),200),(110===t||3===t)&&"ITEMDESCRIPTION"!=r.data("colname")){if(0==$("#span_tarea").length){var d=parseFloat(l),c=$("<span>");c.attr({id:"span_tarea",class:"dIB newgraybtn"}).css({"font-size":"1rem","overflow-y":"scroll","line-height":"18px",width:d}),$("body").append(c)}var u=$("#span_tarea");u.text($(r).val());var m=18*parseInt(u.outerHeight()/18);m>354?(u.remove(),$(r).css({height:"354px"})):(m=m<=18?54:m+30,$(r).css({height:m}))}Crm.isLineItemSubFormModule(r.data("subformdisplaylabel"))&&"PRODUCTID"===r.data("colname")&&$("#lookFieldSrcWrap").addClass("pli_prdAutoCompListView"),133!==t||e.data("uiAutocomplete")||(crmLookupAutoComplete.initAutoCompletePlugin(e,"createPageLookup"),e.click((function(){$(this).autocomplete("search")}))),36!==t&&143!==t&&144!==t&&145!==t||crmTemplate.calculatorOperation(r,a)}))}}else e.is("[readonly]")?e.closest(".labelValCreate").removeClass("focusEleField"):e.closest(".labelValCreate").addClass("focusEleField")}function removeSubfrmFocusClass(e){var t=(e=$(e.currentTarget)).data("uitype");if(3==t||110==t&&"ITEMDESCRIPTION"!=e.data("colname")){var a=e.height(),r=$("#span_tarea");if(e.outerHeight()>360)return r.remove(),!1;var l=e;r.text(l.val());var i=""===l.val()?18:a;l.css({height:i}),r.remove()}Crm.isLineItemSubFormModule(e.data("subformdisplaylabel"))&&"PRODUCTID"===e.data("colname")&&$("#lookFieldSrcWrap").removeClass("pli_prdAutoCompListView"),$(".topband_dv_row").removeClass("txtFldFocusedRow"),$(".topband_dv_row div, .labelValCreate").removeClass("focusEleField")}Handlebars.registerHelper("setHeadingLayout",(function(e){return"create"===e.currentStatus&&(e.layout_jsonarrayObj.activeLayoutCnt>=2||e.isWizard)?e.showMultipageLayout=!0:e.showMultipageLayout=!1,"create"===e.currentStatus&&Crm.userDetails.TaskPopup&&"Tasks"===e.module?e.isTaskPopup="true":e.isTaskPopup="false",Handlebars.templates.crmCreateHeadingLayout(e)})),Handlebars.registerHelper("setFieldsListHeading",(function(e){return void 0===e.isFieldPermNeeded||e.isFieldPermNeeded||(e.layout_jsonarrayObj.layoutCnt>=2&&e.isMPLAvailable?e.showMultipageLayout=!0:e.showMultipageLayout=!1),Handlebars.templates.fieldsListHeading(e)})),Handlebars.registerHelper("createNewNotes",(function(e){return Handlebars.templates.createnewNotes(e)})),crmTemplate.createSectionLayout=function(e,t,a,r){var l=e[t].section;if(null!=window[t].createEditJson.layout_jsonarrayObj)var i=window[t].createEditJson.layout_jsonarrayObj.currLayoutId;!0===Crm.userDetails.LAYOUTRULEAVAILABLE&&CFRExec.holdFormRule()&&i===CFRExec.ruleLayoutId?CFRExec.tabIndexingRequired=!0:CFRExec.tabIndexingRequired=!1,null==l.length&&(l=[l],e[t].section=l);t=e.module;for(var s=document.createDocumentFragment(),n=1,o=0,d="Quotes"==t||"Invoices"==t||"SalesOrders"==t||"PurchaseOrders"==t,c=0;c<l.length;c++){var u=void 0;if(void 0!==l[c].FL||"Consents"!==t){e.currentSection=l[c];var m=$(Handlebars.templates.crmCreateSectionLayout(e));e.currentSection.isLineItemSF&&m.addClass(m.attr("class")+" pli_lineItemProduct"),"Tasks"===t&&m.find("table, div").css("width","100%"),"PriceBooks"===t&&"create"===window[t].currentStatus&&"Pricing Details"===e.currentSection.name&&m.hide(),"Events"===t&&0!=c&&"relatedlist_meetnow"!=Events.createSource&&m.hide();var p=l[c].name.replace(/ |'/g,"_"),f=m.find("[id='secContent_"+p+"']");$(f).data("data-secsequence",c+1),$(f).attr("tab-traversal",l[c].tabTraversal);var v,h,g,T=l[c].layout,C=l[c].FL,b=l[c],_=l[c].subFormTabId;d&&"Product_Details"===p&&$(f).addClass("productCheck"),null==C.length&&(C=l[c].FL=[C]);for(var y=[],I=[],E=0;E<C.length;E++)"500"!=C[E].uitype?"OTHERSERVICE"==C[E].colname||"CONTACTTHROUGHSOCIAL"==C[E].colname||"SERVICESTATUS"===C[E].colname||"APPOINTMENTSTATUS"===C[E].colname||"RESCHEDULECOUNT"===C[E].colname||"APPOINTMENTID"===C[E].colname&&(C[E].uitype===CrmField.UITYPES.SYSTEM_SINGLE_LOOK_UP_ENTITY.toString()||C[E].uitype===CrmField.UITYPES.LOOK_UP_ENTITY.toString())||"UNAVAILABLE_TILL"===C[E].colname||"UNAVAILABLE_FROM"===C[E].colname||"ISJOBSHEETCREATED"===C[E].colname||"JOBSHEETSECTION"===C[E].colname&&"Appointments"===t||"209"===C[E].uitype||"207"===C[E].uitype&&"clone"===window[t].currentStatus||("208"!==C[E].uitype&&"207"!==C[E].uitype||"create"!==window[t].currentStatus)&&(E%T==0?y.push(C[E]):I.push(C[E])):(v=C[E].label,h=C[E].colname,g=C[E].sysRefName);g&&m.attr("cscript-tag",g);for(var D,F=0,S=0;S<y.length;S++)if(!0!==y[S]&&"Formula"!==y[S].type&&"Auto Number"!==y[S].type&&"Rollup_Summary"!==y[S].type&&"layoutPreview"!==a){if(y[S].tabIndex=n,n=CFRExec.getIndexForTab(y[S].type,n),void 0!==l[c].tabTraversal&&"2"===l[c].tabTraversal||void 0!==l[c].tabtraversal&&2===l[c].tabtraversal)for(var w=F;w<I.length;w++){if(!0!==I[w]&&"Formula"!==I[w].type&&"Auto Number"!==I[w].type&&"Rollup_Summary"!==I[w].type){I[w].tabIndex=n,n=CFRExec.getIndexForTab(I[w].type,n),F++;break}I[w].tabIndex=-1,F++}}else y[S].tabIndex=-1;for(var R=F;R<I.length;R++)"layoutPreview"!==a?(1!=I[R]&&(I[R].tabIndex=n),n=CFRExec.getIndexForTab(I[R].type,n)):I[R].tabIndex=-1;if(D=0===I.length&&"Events"===t?$("<div class='contInfoTab singleColLayout eventsModule'>"):""!=_&&null!=_&&"null"!=_?$("<div class='contInfoTab subFrmLayout "+t+"'>"):0==I.length?$("<div class='contInfoTab fL singleColLayout "+t+"'>"):$("<div class='contInfoTab fL formViewCreate'>"),""!=_&&null!=_&&"null"!=_){var A;if(Crm.userDetails.SUBFORM_PERMISSIONS){for(var L=e[t].subforms&&e[t].subforms.section?e[t].subforms.section:[],N=L.length,k=0;k<N;k++)if(L[k].subFormTabId===_){A=L[k].profilePermissionMap;break}if(A&&!A.view)continue}var O=crmTemplate.createSubForm(t,e,v,b,h,A);if(!O)continue;Crm.userDetails.isMandatorySubFormEnabled&&"true"===O.getAttribute("subform-mandatory")&&m.addClass("subformMandatory"),D.addClass("aggTempClass").append("<div class='subFrmTablWrapper mT13' onscroll='crmTemplate.subFrmScroll(this)'></div><div class='subFrmAggTablWrapper'></div>");var M={};M.subFormCreateJSON=e,M.moduleName=t,M.subFormSectionId="[id='secContent_"+p+"']",M.subFormContent=D,M.subFormTable=O,M.subFormTabId=_,M.subFormAggContent=y,M.layout=T,M.subFormSecData=b,crmTemplate.subformContents["subFormRender"+ ++o]=M,f.append(D)}else{for(E=0;y&&E<y.length;E++)if(1!=y[E]){u=crmTemplate.createFieldRow(T,t,void 0,y[E],e,r);var U=$(u).find(".labelTabCreate");null!==u&&(U.addClass("columnCal1"),e.currentField&&e.currentField.tooltiptype&&"1"==e.currentField.tooltiptype&&U.addClass("containTooltip")),D.append(u)}if(f.append(D),I.length>0){D=$("<div class='contInfoTab fR formViewCreate'>");for(E=0;I&&E<I.length;E++){if(1!=I[E])u=crmTemplate.createFieldRow(T,t,void 0,I[E],e),(U=$(u).find(".labelTabCreate")).addClass("columnCal2"),e.currentField&&e.currentField.tooltiptype&&"1"==e.currentField.tooltiptype&&U.addClass("containTooltip"),D.append(u)}f.append(D)}}s.appendChild(m[0]),f.append($("<div class='cBoth'></div>")[0])}else l.splice(c)}return s},crmTemplate.subFrmScroll=function(e){var t=$L(document),a=$(e),r=a.scrollLeft(),l=t.scrollTop(),i=a.offset(),s=a.find(".subFrmSnFld").length,n=Math.round(a.outerWidth()),o=Math.round(a[0].scrollWidth),d=a.closest(".subFrmLayout"),c=$("#createFixedButtonDiv").outerHeight(),u="",m=a.find(".subFrmTablSerlNoOverlay tbody tr"),p=r,f=a.find("table.subformTabl");if($("#cNsubformFileAttachDrop").hide(),u=d.hasClass("reorderEnabled")?10:0,!0===Crm.userDetails.RTL_ENABLED)p=-r;s>0&&a.find(".subformTabl tbody tr").each((function(){m.eq($(this).index()).find(".labelValCreate").css({height:$(this).outerHeight()-9})})),a.hasClass("leftFixedSubFrmDisp")||(i.top<l+c?s>0&&p>u?(a.addClass("leftFixedSubFrm"),!0===Crm.userDetails.RTL_ENABLED?a.find("thead").addClass("pFixed").css({right:r+30,top:c,"z-index":"3",background:"#fff"}):a.find("thead").addClass("pFixed").css({left:i.left-r,top:c,"z-index":"3",background:"#fff"}),a.find(".subFrmTablSerlNoOverlay").css({top:i.top-l,display:"block"}),a.find(".subFrmTablSerlNoheadOverlay").css({top:c,display:"block"})):(a.removeClass("leftFixedSubFrm"),!0===Crm.userDetails.RTL_ENABLED?a.find("thead").addClass("pFixed").css({right:r+30,top:c,"z-index":"3",background:"#fff"}):a.find("thead").addClass("pFixed").css({left:i.left-r,top:c,"z-index":"3",background:"#fff"}),a.find(".subFrmTablSerlNoOverlay").removeAttr("style").css("display","none"),a.find(".subFrmTablSerlNoheadOverlay").removeAttr("style").css({top:0,display:"block"})):s>0&&p>u?(a.addClass("leftFixedSubFrm"),a.find(".subFrmTablSerlNoOverlay").css({top:i.top-l,display:"block"}),a.find(".subFrmTablSerlNoheadOverlay").removeAttr("style").css("display","none")):(a.removeClass("leftFixedSubFrm"),a.find(".subFrmTablSerlNoOverlay").removeAttr("style").css("display","none"),a.find(".subFrmTablSerlNoheadOverlay").removeAttr("style").css("display","none"))),r===o-n?a.closest(".subFrmLayout").find(".SubFrmScrolIn").hide():a.closest(".subFrmLayout").find(".SubFrmScrolIn").show(),0!==r?f.addClass("sbmScrollPinnedTable"):f.removeClass("sbmScrollPinnedTable")},crmTemplate.productLineItemSettingsAddRow=function(e){var t=$(".topband_dv_row:eq(0) .pli_quantityCtn").attr("style");return $(e).find(".pli_quantityCtn").attr("style",t),e},crmTemplate.productLineItemSettings=function(){var e=[],t=$(".subformTabl thead td, .subformTabl tbody tr:first-child td"),a=Math.floor($(".pli_lineItemProduct .pli_quantity").outerWidth()/6);t.each((function(){var t=$(this),a=t.outerWidth();t.hasClass("subFrmDragIconWrap")||"subFrmFileUploadFld"===this.className?e.push(Math.floor(a)):e.push(Math.floor(a-25))})),t.each((function(t){var r=$(this),l=r.hasClass("pli_quantity"),i=r.hasClass("pli_quantityCtn"),s=e[t]-a;l||i?(r.css({"min-width":s,width:s}),r.closest(".subFrmTablWrapper").find(".pli_quantityCtn").css({"min-width":s,width:s})):r.css("min-width",e[t])}))},crmTemplate.bindSubformScrollEvent=function(){$(window).scroll((function(){var e=$L(document).scrollTop(),t=$(".subFrmTablWrapper"),a=$("#createFixedButtonDiv").outerHeight();t.each((function(){var t=$(this).offset().top+$(this).height()+a;if(e+a>$(this).offset().top&&e+a<t)return $(this).addClass("curSubFrmFixed"),void crmTemplate.subFrmLeftRightMask()}));var r=$(".curSubFrmFixed"),l=(a=$("#createFixedButtonDiv").outerHeight(),r.scrollLeft()),i=r.offset(),s=l;$(".subformTabl thead td, .subformTabl tbody tr:first-child td").each((function(){$(this).css("min-width",Math.floor($(this).outerWidth()))})),!0===Crm.userDetails.RTL_ENABLED&&(s=-l),$(".leftFixedSubFrm").each((function(){var t=$(this).offset().top-e;$(this).find(".subFrmTablSerlNoOverlay").css({top:t}),$(this).find(".subFrmTablSerlNoheadOverlay").css({top:t})})),e>=i.top+r.outerHeight()-140?(r.find("thead").removeClass("pFixed").removeAttr("style"),r.find(".subFrmTablSerlNoheadOverlay").removeAttr("style").css("display","none"),r.removeAttr("style"),t.removeClass("curSubFrmFixed")):s>0?e>i.top-a?(!0===Crm.userDetails.RTL_ENABLED?r.find("thead").addClass("pFixed").css({right:l+30,top:a,"z-index":"3",background:"#fff"}):r.find("thead").addClass("pFixed").css({left:i.left-l,top:a,"z-index":"3",background:"#fff"}),r.find(".subFrmTablSerlNoOverlay").css({top:i.top-e}),r.css("padding-top",r.find("thead").outerHeight()),r.find(".subFrmTablSerlNoheadOverlay").css({top:a,display:"block"})):(r.find("thead").removeClass("pFixed").removeAttr("style"),r.find(".subFrmTablSerlNoOverlay").css({top:i.top-e}),r.find(".subFrmTablSerlNoheadOverlay").removeAttr("style").css("display","none"),r.css("padding-top","0")):e>i.top-a?(!0===Crm.userDetails.RTL_ENABLED?r.find("thead").addClass("pFixed").css({right:l+30,top:a,"z-index":"3",background:"#fff"}):r.find("thead").addClass("pFixed").css({left:30,top:a,"z-index":"3",background:"#fff"}),r.find(".subFrmTablSerlNoheadOverlay").css({top:0,display:"block"}),r.css("padding-top",r.find("thead").outerHeight())):(r.find("thead").removeClass("pFixed").removeAttr("style"),r.find(".subFrmTablSerlNoheadOverlay").removeAttr("style").css("display","none"),r.removeAttr("style"),t.removeClass("curSubFrmFixed"))}))},crmTemplate.subFrmLeftRightMask=function(){$(".subFrmSideMask").length<2&&$(".subFrmTablWrapper").append('<div class="subFrmSideMask subFrmSideMaskLeft"></div><div class="subFrmSideMask subFrmSideMaskRght"></div>');var e=$(".curSubFrmFixed").offset().left,t=$(".curSubFrmFixed").width(),a=e+t,r=$("#createFixedButtonDiv").outerHeight();$(".subFrmSideMask").css({top:r}),!0===Crm.userDetails.RTL_ENABLED?$(".subFrmSideMaskRght").css({right:t+30}):$(".subFrmSideMaskRght").css({left:a})},crmTemplate.createFieldRow=function(e,t,a,r,l,i,s){var n=!("Events"!==t||!l||"edit"!==l.currentStatus)||!("Events"!==t||!l||"edit"===l.currentStatus),o=l||("detail"!==Lyte.Router.getRouteInstance().routeName||Crm.renderDVLyteFlow(t)||"undefined"==typeof businessCardJson?l:businessCardJson),d=o&&(2===o.isApproved||3===o.isApproved||"2"===o.isApproved||"3"===o.isApproved);if(!n&&Lyte.Router.getRouteInstance()&&"detail"===Lyte.Router.getRouteInstance().routeName&&d)r.readonly=(8===r.uitype||"8"===r.uitype)&&"SMOWNERID"===r.colname||2!==businessCardJson.hidden.EditFieldsType||businessCardJson.hidden.ApprovalProcessEditFields.contains(r.fieldid)||"false"!==r.readonly?r.readonly:"true";else{var c=(n||Lyte.Router.getRouteInstance()&&"edit"===Lyte.Router.getRouteInstance().routeName)&&d?l&&l.record_modification?l.record_modification:o.hidden?o.hidden.ApprovalProcessEditFields:void 0:void 0;r.readonly=(8!==r.uitype&&"8"!==r.uitype||"SMOWNERID"!==r.colname)&&d?c&&c.length>0&&!c.contains(r.colname)&&"false"===r.readonly?"Who_Id"===r.sysRefName&&c.contains("SEID")?r.readonly:"true":o&&(2===o.isApproved||"2"===o.isApproved)&&Lyte.Router.getRouteInstance()&&"edit"===Lyte.Router.getRouteInstance().routeName&&"RECURRING"===r.colname?"true":r.readonly:r.readonly}if(l||(l={module:t}),!("Tasks"===t&&"SENDNOTIFICATION"===r.colname||"Tasks"===t&&"Who Id"===r.label&&window[t].whoIdModulesArr&&0==window[t].whoIdModulesArr.length)){if("clone"===l.position&&"555"===r.uitype&&(r.defaultvalue.length=0),l.currentField=r,window[t]&&window[t].createEditJson&&(window[t].createEditJson.entityMapJson=window[t].createEditJson.entityMapJson||{},window[t].createEditJson.entityMapJson[r.colname]=r),"116"===r.uitype||"118"===r.uitype)return a;if("209"===r.uitype)return null;if("Events"===t&&r){if("123"==r.uitype&&"edit"==Events.currentStatus){if("RECURRING"===r.colname){var u=r.defaultvalue;Events.recVal=u,Events.isRecEvent=!1,u&&""!==u&&"null"!==u&&(Events.isRecEvent=!0)}return""}if("40"===r.uitype&&"setup"!==Events.currentStatus)return"";if("setup"===l.currentStatus&&"WhatId"==l.currentField.dlabel)return a;if("Events"!==t||"MEETING_VENUE"!==l.currentField.colname||"relatedlist_meetnow"!==Events.createSource&&!Events.scheduleOnlineEvent){if("Events"===t&&"MEETING_PROVIDER"===l.currentField.colname&&("relatedlist_meetnow"===Events.createSource||Events.scheduleOnlineEvent)){p=l.currentField.picklistmap;for(const e of p)if(e.uservalue===Events.meetToolsel){l.currentField.defaultvalue=e.uservalue,e.isDefaultOption=!0;f=l.currentField.val;for(var m of f)m===Events.meetToolsel?((m={}).default="true",m.content=e.uservalue,m.html=e.uservalue):m instanceof Object&&(m=m.content)}else delete e.isDefaultOption}}else{var p=l.currentField.picklistmap;for(const e of p)if("Online"===e.systemvalue){l.currentField.defaultvalue=e.uservalue,e.isDefaultOption=!0;var f=l.currentField.val;for(var m of f)"Online"===m?((m={}).default="true",m.content=e.uservalue,m.html=e.uservalue):m instanceof Object&&(m=m.content)}else"Client location"!==e.systemvalue&&"In-office"!==e.systemvalue||delete e.isDefaultOption}}"Appointments"===t&&l.currentSection&&"2"===l.currentSection.section_id&&"APPOINTMENTDATEANDTIME"!==r.colname&&"EXCHANGERATE"!==r.colname&&"CURRENCYISOCODE"!==r.colname&&"SMOWNERID"!==r.colname&&(r.defaultvalue=null),a=document.createElement("div");var v="";if(l.currentField.suffixIndex&&"Events"!=t&&"Tasks"!=t&&"Calls"!=t&&(v=l.currentField.suffixIndex+"_"),a.id=t+"_fldRow_"+v+l.currentField.colname,a.className=l.currentField.colname+" tabDivCreate","PRICINGDETAILS"===l.currentField.colname&&(a.className+=" noBorderStyle priceBookDetailUpdate"),l.currentField.colname.includes("IMAGEATTACHMENT")&&(a.className+=" iu_imgWrap"),a.setAttribute("cscript-tag","__"+r.sysRefName),-1!==[CrmField.UITYPES.LOOK_UP_ENTITY,CrmField.UITYPES.MULTI_MODULE_LOOK_UP_ENTITY,CrmField.UITYPES.SYSTEM_SINGLE_LOOK_UP_ENTITY,CrmField.UITYPES.OWNER,CrmField.UITYPES.USERLOOKUP,CrmField.UITYPES.PRODUCT_HANDLER,CrmField.UITYPES.MULTISELECT_LOOK_UP,CrmField.UITYPES.CURRENCY,CrmField.UITYPES.ACCOUNT_NAME_LOOKUP,CrmField.UITYPES.SALESORDER_ID,CrmField.UITYPES.CONTACT_ID,CrmField.UITYPES.VENDOR_NAME_LOOKUP,CrmField.UITYPES.CONTACT_LOOKUP,CrmField.UITYPES.POTENTIAL_ID,CrmField.UITYPES.PRODUCT_NAME_LOOKUP,CrmField.UITYPES.CAMPAIGN_NAME_LOOKUP,CrmField.UITYPES.QUOTE_ID,CrmField.UITYPES.CURRENCY_ROUND_OFF,CrmField.UITYPES.CURRENCY_ROUND_DOWN,CrmField.UITYPES.CURRENCY_ROUND_UP].indexOf(parseInt(r.uitype))&&"ROLEID"!==r.colname&&"PROFILEID"!=r.colname&&(Crm.userDetails.CLIENT_ACCOUNT&&Crm.userDetails.moduleVsCriteriaLookup?r.lookupmodule&&r.lookupmodule===Crm.userDetails.CLIENT_TYPE&&Crm.userDetails.moduleVsCriteriaLookup[t]&&-1!==Crm.userDetails.moduleVsCriteriaLookup[t].toString().indexOf(r.fieldid)&&(r.readonly="true",a.className+=" noLookupBg"):!Crm.userDetails.CLIENT_ACCOUNT||"133"!==r.uitype&&"13"!==r.uitype&&"4"!==r.uitype&&"7"!==r.uitype&&"444"!==r.uitype||r.lookupmodule&&r.lookupmodule===Crm.userDetails.CLIENT_TYPE&&(r.readonly="true",a.className+=" noLookupBg"),Crm.userDetails.CLIENT_ACCOUNT&&[8,55,221].contains(r.uitype)?(a.className+=" userLookupNewUI","create"===l.currentStatus&&(M=Crm.userDetails.CLIENT_OWNER_NAME,r.defaultvalue=M,r.defaultid=Crm.userDetails.CLIENT_OWNER_ID),"create"!==l.currentStatus&&(a.className+=" noLookupBg"),r.readonly="true"):r.uitype===CrmField.UITYPES.OWNER+""?(a.className+=" userLookupNewUI","create"===l.currentStatus||"Appointments"===l.module&&"edit"===l.currentStatus&&"SMOWNERID"===r.colname||(a.className+=" noLookupBg")):r.uitype==CrmField.UITYPES.PRODUCT_HANDLER?a.className+=" userLookupNewUI":r.uitype==CrmField.UITYPES.USERLOOKUP&&("processflow"==l.callFrm?a.className+=" userLookupWrapOldUI":a.className+=" userLookupNewUI"),a.className+=" lookupFieldCreate"),"301"!==r.uitype&&"123"!==r.uitype||(a.className+=" noBorderStyle"),"555"===r.uitype&&(a.className+=" noBorderStyleFileUp"),("true"==r.readonly||"8"===r.uitype&&!1===l.changeOwnerPermission)&&("3"!==r.uitype&&"110"!==r.uitype&&"250"!==r.uitype||"Tasks"===t||"Events"===t||"Calls"===t||"Appointments"===t)&&("556"!==r.uitype?a.className+=" readonlyF":a.className+=" imageReadonlyF"),"REPORTINGTOCONTACTID"===r.colname&&"create"===window[t].currentStatus&&(void 0===window[t].createEditJson.fillUpEntityname||"Accounts"!==window[t].createEditJson.relmodule)){a.className+=" noclick",$(a).on("mouseover",(function(){var e=Crm.moduleInfo.Accounts.translatedSingularLabel;renderingUtils.zctt.showtt(I18n.getMsg("crm.contact.hierarchy.Specify_account_name",e))})),$(a).on("mouseout",(function(){renderingUtils.zctt.hidett()}))}l.isBPExec&&"786"===r.uitype&&"CALLSTARTDATETIME"===r.colname&&""===r.defaultvalue&&(r.defaultvalue=new Date);var h=null;"66"!=r.uitype&&(h=crmTemplate.createFieldLabel(l)),l.isBPExec&&("50"===r.uitype?h=$("<div>",{class:"labelTabCreate pL5 newmandatory",id:"Crm_Products_PRODUCTDETAILS_label"}).text(I18n.getMsg("Product Details"))[0]:"51"===r.uitype&&(h=$("<div>",{class:"labelTabCreate pL5 newmandatory",id:"Crm_Products_PRICINGDETAILS_label"}).text(I18n.getMsg("Pricing Details"))[0]));var g=crmTemplate.createFieldContent(l);if("3"!==r.uitype&&"110"!==r.uitype||"Tasks"===t||"Events"===t||"Calls"===t||"Appointments"===t?"250"!==r.uitype||"Tasks"!==l.module&&"Events"!==l.module||(g.className=g.className+"task",$(g).find("crm-richtext-component")[0].component.setData("psScrollClassNeeded",!0)):(g=crmTemplate.createFieldContentForMultiLine(l.currentField),CScriptLib&&$(g).find("crux-text-area-component")[0].setMethods("onValueChange",(function(){var e=$(this.$node);crmTemplate.onChange(e.data("sysrefname"),e.data("fieldid"),e.data("uitype"))}))),11!=r.uitype&&37!=r.uitype&&32!=r.uitype&&27!=r.uitype&&25!=r.uitype&&35!=r.uitype&&21!=r.uitype&&1!=r.uitype&&127!=r.uitype&&33!=r.uitype&&36!=r.uitype&&22!=r.uitype||(a.className="textFld "+a.className),2==r.uitype&&(a.className="sltFld "+a.className),CScriptLib&&"Tasks"!==t&&"Events"!==t){var T=$(g);2==r.uitype||39==r.uitype||26==r.uitype?T.children().children("select").attr("onchange","crmTemplate.onChange('"+l.currentField.sysRefName+"','"+l.currentField.fieldid+"','"+r.uitype+"','"+l.module+"','"+l.currentStatus+"','"+l.currentField.attrObj.id+"');"):8==r.uitype?T.children().children("crm-user-wrapper").attr("onchange","crmTemplate.onChange('"+l.currentField.sysRefName+"','"+l.currentField.fieldid+"','"+r.uitype+"');"):3==r.uitype||110==r.uitype?T.children("textarea").attr("onchange","crmTemplate.onChange('"+l.currentField.sysRefName+"','"+l.currentField.fieldid+"','"+r.uitype+"');"):["133","4","9","13"].includes(r.uitype)?(T.children("input").attr("onblur","crmTemplate.onChange('"+l.currentField.sysRefName+"','"+l.currentField.fieldid+"','"+r.uitype+"');"),T.children("input").attr("data-criteria","")):"445"!==r.uitype&&"444"!==r.uitype&&"30"!==r.uitype&&T.children("input").attr("onchange","crmTemplate.onChange('"+l.currentField.sysRefName+"','"+l.currentField.fieldid+"','"+r.uitype+"');"),crmTemplate.onTypesSupportedFields.has(r.uitype)&&T.find("input").attr("oninput","crmTemplate.onType('"+l.currentField.fieldid+"', this.value);")}if(r.uitype==CrmField.UITYPES.SERVICE_DURATION&&$(g).find("#Crm_Services_SERVICEDURATION").attr("style","display:none"),"Appointments"===t&&r.uitype==CrmField.UITYPES.SERVICE_DURATION&&($(g).find("#serviceDurationDiv").attr("style","display:none"),$(g).find("#Crm_Appointments_APPOINTMENTDURATION").attr({class:"textField serviceDurationELe cP",disabled:"disabled"})),"Appointments"===t&&"APPOINTMENTLOCATION"==r.colname&&$(g).find("#Crm_Appointments_APPOINTMENTLOCATION").attr("onchange","Lyte.registeredMixins['crm-services-appointments-old-mixin'].onAppointmentLocationChange(this)"),"Appointments"===t&&"APPOINTMENTADDRESS"==r.colname)(T=$(g)).children("input").attr({onfocus:"Lyte.registeredMixins['crm-services-appointments-old-mixin'].setAppointmentLocation();",onblur:"Lyte.registeredMixins['crm-services-appointments-old-mixin'].hideAppointmentLocationPop();"}),T.attr("onclick","Lyte.registeredMixins['crm-services-appointments-old-mixin'].setAppointmentLocation();"),T.find("input[type='text']").attr({autocomplete:"off",placeholder:""}),g.appendChild($("<div class='evtLocationDD' id='locationDataDiv' data-close='true'><ul class='m0 p0'></ul></div>")[0]);if("Events"==t&&"setup"==Events.currentStatus){if(h){var C=$("<td>"),b=$("<div>",{class:"lableCls tdW130"});b.html($(h).html()),"true"==r.mandate?b.append(" <sup class='crmNegativeColor'>*</sup>"):b.append(" <sup class='crmNegativeColor'></sup>"),C.append(b),a.appendChild(C[0])}if(g){var _=$("<td>"),y=$("<div>");y.html($(g).html()),_.append(y),a.appendChild(_[0])}var I=$("<td style='padding:0px'>");if(-1==["Subject","Event Title","Start DateTime","End DateTime","Event Owner","All day","Recurring Activity","Participants","Event Status","Remind At","EventStatus"].indexOf(r.label)){var E=$("<div>",{class:"icnSetting tdW28",style:"visibility: hidden; position: relative",issysfld:r.isSystemMandate,mandate:r.mandate});E.mouseenter((function(){showRelOptionsInCreateView(this,r.uitype)})).mouseleave((function(){$(".eventActionsMenu").hide()}));var D=$("<div>",{class:"eventActionsMenu",style:"position:fixed;top:26px;right:0px;padding:0px;display: none ;"});E.append(D),I.append(E)}else I.append($("<div>",{class:"tdW28",style:"height:28px"}));a.appendChild(I[0]);var F="layoutCreate-Drag";-1!=["Event Title","Subject","Venue","All day","Start DateTime","End DateTime"].indexOf(r.label)?F="layoutCreate-Drag-unmove":"786"!==r.uitype&&"36"!==r.uitype&&$(a).find("input").css({width:"85%"});var S=$("<li>"),w="fieldId_"+r.fieldid;S.attr({class:F,id:w});var R=$("<table>",{width:"100%",cellpadding:"0",cellspacing:"0",class:"setupDrag"});S.append(R),"LOCATION"===r.colName&&S.css({"margin-top":"9px"});var A=$("<tbody>");R.append(A),A.append(a),a=S[0]}else{if(h&&a.appendChild(h),"true"===l.currentField.readonly&&"556"!==r.uitype&&"555"!==r.uitype){var L="208"!==r.uitype?"210"===r.uitype&&r.LiteConstant&&"true"===r.LiteConstant?I18n.getMsg("crm.liteuser.profile.notchange"):I18n.getMsg("crm.lable.read.only"):I18n.getMsg("crm.field.layout.edit.change.restriction");l.currentField.restricted&&l.currentField.reasonrestrict&&(L=l.currentField.reasonrestrict),$(a).on("mouseover",(function(){$(event.target).hasClass("tabDivCreate")||renderingUtils.zctt.showtt(L)})),$(a).on("mouseout",(function(e){$("#tooltip-zc").hide(),$(event.target).hasClass("tabDivCreate")||renderingUtils.zctt.hidett()}))}g&&a.appendChild(g),a.appendChild($("<div class='cBoth'></div>")[0]),"Events"===t&&"LOCATION"==r.colname&&g.appendChild($("<div class='evtLocationDD' id='locationDataDiv' data-close='true'><ul class='m0 p0'></ul></div>")[0])}if("Events"==t&&(a=window[t].createFieldRow(e,a,r)),"Events"===t&&("relatedlist_new"==Events.evtCreateFrom||"relatedlist_meetnow"==Events.evtCreateFrom))$("#relmodule").val();if(4==r.uitype&&"CONTACTID"==r.colname&&"Events"===t){var N=r.lookupmodule,k=$(".commonRightPanel").length?$("#id").val():Events.createEditJson.currentField.defaultid,O=!1,M=r.defaultvalue?$ESAPI.encoder().encodeForHTMLAttribute(r.defaultvalue):"";s?(k=s.recordId,M=$ESAPI.encoder().encodeForHTML(s.entityName),(N=s.parentModuleName)&&"Contacts"!==N&&"Leads"!==N&&(k=$("#contId").val())):"relatedlist_new"!==Events.evtCreateFrom&&"relatedlist_meetnow"!==Events.evtCreateFrom||(k=$("#entityId").val(),M=$ESAPI.encoder().encodeForHTML($("#entityName").val()),(N=$("#relmodule").val())&&"Contacts"!=N&&"Leads"!=N&&(k=$("#contId").val())),l.invCnt>0&&(O=N&&-1!=N.indexOf("Leads")?Events.createEditJson.inviteeJson.l[k]:Events.createEditJson.inviteeJson.c[k]);var U="edit"===Events.currentStatus&&(2===Events.createEditJson.isApproved||3===Events.createEditJson.isApproved)&&"detailView"===Events.evtCreateFrom,x=!(!(U&&Events.createEditJson.recordFieldsEditAllowed&&Events.createEditJson.record_modification)||0!==Events.createEditJson.record_modification.length&&!Events.createEditJson.record_modification.contains("PARTICIPANTID"))||!U;I18n.getMsg("crm.event.add.contact",k);O&&!Events.createEditJson.isCalendarSchedule?a.appendChild($("<div id='addpartCheck' data-zcqa='addpartCheck' style='padding:15px 0 5px 170px;border-bottom: 1px solid var(--br_EDF0F4);'><label class='newCustomchkbox-md mT3'><input id='addpartCheckbox' recId='"+k+"' type='checkbox' value='' checked onclick='Events.addRelatedParticipant($(this),\""+k+'","'+N+"\")'/><span class='chkbxIcon'></span><span id='addpartCheckboxTitle' class='crm-small-font-size mL5 beforeAdd vaT pT1 dIB'> Add "+M+" as a participant</span></label></div>")[0]):(k&&"null"!==k||"relatedlist_new"===Events.evtCreateFrom||"relatedlist_meetnow"===Events.evtCreateFrom||"stageView"===Events.evtCreateFrom)&&!Events.createEditJson.isCalendarSchedule&&x?a.appendChild($("<div id='addpartCheck' data-zcqa='addpartCheck' style='padding:15px 0 5px 170px;border-bottom: 1px solid var(--br_EDF0F4);'><label class='newCustomchkbox-md mT3'><input id='addpartCheckbox' recId='"+k+"' type='checkbox' value='' onclick='Events.addRelatedParticipant($(this),\""+k+'","'+N+"\")'/><span class='chkbxIcon'></span><span id='addpartCheckboxTitle' class='crm-small-font-size mL5 beforeAdd vaT pT1 dIB'> Add "+M+" as a participant</span></label></div>")[0]):Events.createEditJson.isCalendarSchedule||a.appendChild($("<div id='addpartCheck' data-zcqa='addpartCheck' style='display:none;padding:15px 0 5px 170px;border-bottom: 1px solid var(--br_EDF0F4);'><label class='newCustomchkbox-md mR5 mT3'><input id='addpartCheckbox' type='checkbox' value=''/><span class='chkbxIcon'></span><span id='addpartCheckboxTitle' class='crm-small-font-size mL5 beforeAdd vaT pT1 dIB'></span></label></div>")[0])}if("LOCATION"===r.colname&&"Events"===t&&"processflow"!==l.callFrm&&!Crm.userDetails.MEETING_BRIDGE_ENABLED){var P=Crm.userDetails.LICENSE_TYPE,H="SupportProfileInternal"===Crm.userDetails.PROFILE_NAME||Crm.userDetails.isSupportAccessExitSessionEnabled,B={};if(null!=l.entityMapJson&&null!=l.meetingConfZuid&&(Events.locationValue=l.entityMapJson.LOCATION.defaultvalue,B=Object.keys(l.meetingConfZuid).length>0?JSON.parse(Events.constructMeetingToolSelectBox(l.meetingConfZuid)):{}),B&&B.length>0&&-1!=["R","E","X","S","Y","P","A","C","Z","U","D"].indexOf(P)&&!H){var V={};if(V.meetingPref=B,V.currentStatus=Events.currentStatus,V.toolName=l.entityMapJson.LOCATION.meetingToolName,V.include_desc=I18n.getMsg("crm.event.meeting.onlinemeeting"),"clone"===Events.currentStatus||"create"===Events.currentStatus||"edit"===Events.currentStatus){var j=Handlebars.templates.crmEventMeeting(V);if((J=document.createDocumentFragment()).appendChild(a),J.appendChild($(j)[0]),"clone"===Events.currentStatus||"edit"===Events.currentStatus&&l.entityMapJson.LOCATION.meetingToolName&&""!==l.entityMapJson.LOCATION.meetingToolName){var Y=J.firstElementChild;if(Y.classList.add("disable-events"),"edit"!==Events.currentStatus||V.toolName){var z=J.getElementById("meetingInclude");$(z).attr("checked",!0),Y.getElementsByTagName("input")[0].value=I18n.getMsg("crm.event.meeting.online.poweredby",Events.displayToolName[V.toolName]),Events.withMeetingTool=!0,Events.meetingToolName=l.entityMapJson.LOCATION.meetingToolName}else $("#CrmEventMeetingInteg").hide(),Y.getElementsByTagName("input")[0].value="",Events.withMeetingTool=!1}a=J,thirdPartyUtils.bindSelect2("#Crm_Events_MeetingSolutions_select"),Events.showonboardingChanges()}}}if("Events"===t&&"MEETING_VENUE"===r.colname){$("#CrmEventMeetingInteg").hide();var W=$("#Crm_Events_MEETING_VENUE_label"),G="none";void 0!==(M=r.default[0])&&"Online"===M.html&&(G="inline-block",Crm.userDetails.LITE.IS_LITE_USER||Events.showonboardingChanges());var q='<i id="meetingInfoIcon" class="svgIcons info_icon infotoolTip mL5 dIB vaM cP customField" data-module="" fldtooltip="'+Events.showOnlineMeetingVenueTooltip()+'" style="display:'+G+';"></i>';W.append($(q)[0])}if("Events"===t&&(Events.totalReqSent=0),"SUBJECT"==r.colname&&"Events"===t){var J;(J=document.createDocumentFragment()).append(a);j=Events.loadHtmlForMeetingLength(Events.meetingToolName);J.append(j[0]),a=J}var K="#Crm_"+t+"_"+v+r.colname+"_label",X="#"+t+"_fldRow_"+r.colname;if(8==r.uitype?"true"==r.readonly&&r.readonly?$(a).find('.labelValCreate div[data-uitype="8"]').addClass("ownerReadonlyProperty"):$(a).on("click",(function(){var e=$(event.target);if(!e.hasClass("tabDivCreate")&&!e.hasClass("labelTabCreate")&&$(this).find("[name='ownerNameLookup']").find(event.srcElement)==[]){var a="Crm_"+t+"_"+v+r.colname;Search.showLookup(a),sE()}})):$(a).find("select").length?$(a).hasClass("readonlyF")||$(a).on("click",(function(e){var a=$(event.target);if(!a.hasClass("tabDivCreate")&&!a.hasClass("labelTabCreate")){var l=renderingUtils.getTargetElem(e);if($(l).is("input")||$(l).is("textarea"))return;var i=r.suffixIndex&&"Tasks"!=t&&"Calls"!=t&&"Events"!=t?NaN+r.suffixIndex:"",s="#Crm_"+t+i+"_"+r.colname;"FIRSTNAME"===r.colname&&(s+="_SALUTATION"),"Appointments"===t&&"SEID"===r.colname&&(s+="_RELATEDTO");var n=$(renderingUtils.getTargetElem(e));if($(n).parent("[class^=chosen]").length||$(n).parent("[class^=select2]").length||$(n).filter("[class^=chosen]").length||$(n).filter("[class^=select2]").length)return;if(0==$(K).find("select").length&&0==$(X).find("select").length&&($("body").trigger("click"),sE()),"SELECT"===$(s).prop("tagName")&&!$(s).prop("disabled")&&($(s).select2("open"),"Calls"==t&&isNewCallView)){var o=$(s).closest(".labelValCreate");o.length&&($(".labelValCreate").removeClass("focusEleField"),o.addClass("focusEleField"))}"Calls"!=t||!isNewCallView||"SEID"!==r.colname&&"CONTACTID"!=r.colname||$(s).focus()}})):$(a).on("click",(function(e){var a=$(e.target);if(!(a[0].id&&"lookupFieldAlertDiv"===a[0].id||a.hasClass("tabDivCreate")||a.hasClass("infotoolTip")||a.hasClass("labelTabCreate"))){var l=r.suffixIndex&&"Tasks"!=t&&"Calls"!=t&&"Events"!=t?"#Crm_"+t+"_"+r.suffixIndex+"_"+r.colname:"#Crm_"+t+"_"+r.colname,i=e.target.tagName;if(/\b(5|4|6|7|9|10|12|13|15|132|133|135|136)\b/.test(r.uitype)&&"IMG"!==i&&"INPUT"!==i)$(l).focus(),$(l).autocomplete("search");else if("81"==r.uitype)setTimeout((function(){$(l).closest(".labelValCreate").find(".customDate .customDatefield:last-child").find("input").focus()}),100);else if("33"==r.uitype&&Crm.userDetails.isPhoneNoNewView)a.closest(".select2").length<=0&&$(l).focus();else{if(("3"===r.uitype||"110"===r.uitype)&&"Tasks"!==t&&"Events"!==t&&"Calls"!==t&&"Appointments"!==t)return;$(l).focus()}}})),"REPORTINGTOCONTACTID"===r.colname&&"true"!=r.readonly&&"create"===window[t].currentStatus&&void 0===window[t].createEditJson.fillUpEntityname&&($(a).find("input").prop("disabled",!0),$(a).find("input").autocomplete("disable")),$(a).find(".newCustSel").each((function(){if(0==$(this).find(".newCustSelVal").length){var e=$(this).find("select option:selected").text();$(this).append("<span class='newCustSelVal'></span>"),$(this).children(".newCustSelVal").html("<span class='pR7 crm-font-regular'>"+e+"</span> <strong class='mT7 dIB tb_downarrow'></strong>"),$(this).change((function(){var e=$(this).find("select option:selected").text();$(this).children(".newCustSelVal").html("<span class='pR7 crm-font-regular'>"+e+"</span> <strong class='mT7 dIB tb_downarrow'></strong>")}))}})),(445===r.uitype||"445"===r.uitype)&&"Users"===r.lookupmodule||444===r.uitype||"444"===r.uitype){var Q=r.attrObj.id,Z=$(g).find("#"+Q),ee=Z.parent();if(r.clonedfrom&&(Z.attr("data-clonedfrom",r.clonedfrom),"CALLMXNCLONESCHEDULER"===Z.data("selectedid"))){ee.addClass("mxnclonedisabled"),ee.find("input").css("opacity","0.4"),ee.find("img").css("opacity","0.4"),$(a).append($("<div/>",{class:$(h).attr("class"),id:"templabel_"+Q}));var te="<div id='mxnCloneMsgDiv'><div class='mB10 mL5'><span class='dIB mR5 vaM crmBlueFilledCaution'></span> <span class='crm-subheading-font-size crm-font-bold vaM dIB crmBaseColor'>"+I18n.getMsg("crm.field.mxn.clone.copyvalues")+"</span></div><div class='crm-base-font-size crmBaseColor mL25'>";""===Z.val()?te+=I18n.getMsg("crm.field.mxn.clone.limitexceed.record.child.msg",["100",Crm.moduleInfo[r.lookupmodule].translatedPluralLabel.toLowerCase(),Crm.moduleInfo[r.lookupmodule].translatedPluralLabel.toLowerCase()]):te+=I18n.getMsg("crm.field.mxn.clone.limitexceed.record.msg",["100",Crm.moduleInfo[r.lookupmodule].translatedPluralLabel.toLowerCase(),Crm.moduleInfo[r.lookupmodule].translatedPluralLabel.toLowerCase()]),te=te+"<br>"+I18n.getMsg("crm.field.mxn.clone.limitexceed.confirm.msg")+"<div class='mT15' style = 'display: flex; align-items: center; justify-content: flex-end'><span class='crm-small-font-size crmBaseColor cP' data-zcqa='removemxnclonevalues' style='    border-bottom: 1px solid #bdc0c3;margin-left:10px;' onclick='crmTemplate.removeMxNCloneValues(\""+Q+"\")' style='font-size:12px' class='smalledit'>"+I18n.getMsg("crm.field.mxn.clone.button.removevalues")+"</span><input type = 'button' data-zcqa='setmxnclonevalues' value ='"+I18n.getMsg("crm.yes.proceed")+"' class='primarybtn bt-smallprimarybtn' onclick = 'crmTemplate.setMxNCloneValues(\""+Q+'","'+Crm.moduleInfo[r.lookupmodule].pluralLabel.toLowerCase()+"\")' style='cursor: pointer;background-color:var(--linkColor);    border: 1px solid var(--linkColor);    border-radius: 5px;padding: 5px 10px;color:white; margin-left:10px'/></div></div></div>",$(a).append($("<div/>",{html:te,id:"temp_"+Q,style:"margin-top: 2px;color: var(--baseColor);vertical-align: bottom;display: inline-block;position: relative;padding: 12px;top: 1px;transition: initial;border-radius: 5px;width: 55% !important;background-color:#F0F4FF;    border: 1px solid #f4f5f6 !important;font-size:12px"}))}}if("Users"===t&&"ROLEID"===r.colname&&a.classList.contains("readonlyF")&&$(a).find(".textfield").addClass("op3"),!i)for(var ae=Crm.validationRuleJSONData[t]?Crm.validationRuleJSONData[t].validation_rules:void 0,re=ae?ae.length:0,le=0;le<re;le++){var ie=ae[le];if(ie.field_validation&&"true"!==r.readonly&&ie.field.id===r.fieldid){var se="CVRExec.fieldVerify('"+t+"','"+ie.field.column_name+"',true);",ne=I18n.getMsg("crm.validation.rule.verify");let e=renderingUtils.createHTML({name:"input",attr:{value:ne,type:"button",class:"newgraybtndd newwhitebtn vr_verifyBtn mB6 pRI",id:"vr_verifyBut",onclick:se,"data-zcqa":"vR_verify_"+ie.field.id}}),r=$L(a);r="Events"===t?r.hasClass("tabDivCreate")?r:r.children().eq(0):r,setTimeout((function(){if(r.parents(".newInputStyleEle,.noNewInputStyleEle").length>0&&(r=r.find(".labelValCreate").eq(0)),r.length){let t=r.find(".vr_err_verify_container");if(t.length>0)t.find(".vr_verifyBtn").remove(),t.prepend(e);else{let t=document.createElement("span");r.append(t),$(t).addClass("dIB vr_err_verify_container wbBreakWord").prepend(e)}r.parents(".noNewInputStyleEle").length>0?commonUtils.setErrVerifyContHeightToParent(r.parent(),!0,!1):commonUtils.setErrVerifyContHeightToParent(r[0],!0,!1)}}))}}return"Events"!==t||"MEETING_PROVIDER"!==r.colname||"true"!==isSandboxAcc&&"F"!==Crm.userDetails.LICENSE_TYPE&&"N"!==Crm.userDetails.LICENSE_TYPE&&"L"!==Crm.userDetails.LICENSE_TYPE||$(a).addClass("hideEnabled"),a}},crmTemplate.createFieldLabel=function(e,t,a){var r=e.currentField,l=e.module,i=r.sysRefName;if(e.modAndView="Calls"==l?isNewCallView?"Calls_NEW":"Calls_OLD":l,(!r.colname||crmConstants.defaultHiddenFields[r.colname]||a&&"116"===r.uitype&&"setup"!==window[l].currentStatus||"207"===r.uitype&&""==r.defaultvalue)&&(r.colname||(r={}),r.emptyColumn=!0),4==r.uitype&&/Calls|Events|Tasks/.test(l)&&!e.isBPExec){if("What_Id"===i){r.whatIdVal=[];var s=window[l].whatIdModulesArr;r.defaultid&&"null"!=r.defaultid&&Crm.userDetails.MODULE_LIST[r.lookupmodule]&&Crm.userDetails.MODULE_LIST[r.lookupmodule].viewable&&Crm.userDetails.MODULE_LIST[r.lookupmodule].visible&&!s.contains(r.lookupmodule)&&s.push(r.lookupmodule);for(var n=0;n<s.length;n++){if(d=Crm.moduleInfo[s[n]]?Crm.moduleInfo[s[n]].translatedSingularLabel:crmConstants.defaultWhatId[l][s[n]]){var o={html:Crm.moduleInfo[s[n]]?d:I18n.getMsg(d),value:s[n]};0!==n||r.defaultid?o.value==r.lookupmodule&&(o.defaultVal="true"):(o.defaultVal="true",r.lookupmodule=s[n]),r.whatIdVal.push(o)}}}if("Who_Id"===i){r.whoIdVal=[],"Tasks"==l?(crmConstants.defaultWhoId[l]=[],null!=window[l].whoIdModulesArr&&(window[l].whoIdModulesArr.includes("Leads")&&(crmConstants.defaultWhoId[l].Leads="Leads"),window[l].whoIdModulesArr.includes("Contacts")&&(crmConstants.defaultWhoId[l].Contacts="Contacts"))):(moduleRecordMapping.Leads.viewable&&moduleRecordMapping.Leads.visible&&(crmConstants.defaultWhoId[l].Leads="Leads"),moduleRecordMapping.Contacts.visible&&moduleRecordMapping.Contacts.visible&&(crmConstants.defaultWhoId[l].Contacts="Contacts"));for(s=objectUtils.getKeys(crmConstants.defaultWhoId[l]),n=0;n<s.length;n++){var d;o={html:d=moduleRecordMapping[s[n]]?1==moduleRecordMapping[s[n]].isCustomized?moduleRecordMapping[s[n]].singular_label:I18n.getMsg(moduleRecordMapping[s[n]].singular_label):I18n.getMsg(crmConstants.defaultWhoId[l][s[n]]),value:s[n]};0===n&&(o.defaultVal="true"),r.whoIdVal.push(o)}}}if(!/\b(11|50|51)\b/.test(r.uitype)||e.isBPExec||"Appointments"==l){crmTemplate.setFieldData(e,t);var c=$(Handlebars.templates.crmCreateFieldLabel(e));return 4==r.uitype&&"Tasks"===l&&e.isBPExec&&c.text(r.displaylabel),window[l].createFieldLabel(r,c),c[0]}},crmTemplate.setFieldData=function(e,t){if("Services"==e.module&&100==e.currentField.uitype&&"AVAILABLE_DAYS"==e.currentField.colname&&null!=Crm.businessJSON){if(Crm.businessJSON.business_days)(z=Crm.businessJSON.business_days.length)>0&&z<7&&(e.currentField.val=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].filter((function(e){return Crm.businessJSON.business_days.includes(e)})))}if(e.currentField.uitype==CrmField.UITYPES.SERVICE_TIMING){""!=e.currentField.defaultvalue&&e.currentField.defaultvalue!=I18n.getMsg("crm.service.servicetiming.business")&&"Same as business time"!=e.currentField.defaultvalue&&e.currentField.defaultvalue!=I18n.getMsg("crm.service.servicetiming.custom")?(e.currentField.custom_time=e.currentField.defaultvalue,e.currentField.defaultvalue=I18n.getMsg("crm.service.servicetiming.custom")):e.currentField.defaultvalue!=I18n.getMsg("crm.service.servicetiming.custom")&&(e.currentField.defaultvalue=I18n.getMsg("crm.service.servicetiming.business"));var a=[{systemvalue:"Same as business time",uservalue:I18n.getMsg("crm.service.servicetiming.business")},{systemvalue:"Custom time",uservalue:I18n.getMsg("crm.service.servicetiming.custom")}];e.currentField.picklistmap=a;var r=[I18n.getMsg("crm.service.servicetiming.business"),I18n.getMsg("crm.service.servicetiming.custom")];e.currentField.val=r}e.currentField.uitype==CrmField.UITYPES.MULTI_DATE_SELECT&&""!=e.currentField.defaultvalue&&(e.currentField.arrDate=e.currentField.defaultvalue),e.currentField.uitype==CrmField.UITYPES.LAYOUT_LOOKUP&&(e.currentField.type="Lookup");var l=e.currentField;"EVENTSTARTDATETIME"==l.colname&&(l.colname="STARTDATETIME"),"EVENTENDDATETIME"==l.colname&&(l.colname="ENDDATETIME");var s=l.type,n=e.module,o=l.label,d=l.sysRefName,c=window[n]&&"setup"===window[n].currentStatus?"_"+window[n].currentStatus:"";""===c&&l.suffixIndex&&"Events"!=n&&"Tasks"!=n&&"Calls"!=n&&(c="_"+l.suffixIndex);var u="Crm_"+n+c+"_"+l.colname,m=!1;""!=t&&null!=t&&"null"!=t?(m=!0,u="Crm_"+n+"_"+t+c+"_"+l.colname,Crm.fieldsObj[n+"_"+t]?Crm.fieldsObj[n+"_"+t].push(u):Crm.fieldsObj[n+"_"+t]=[u],e.elementSufixId&&(u+=e.elementSufixId)):l.colname&&n in Crm.fieldsObj&&(Crm.fieldsObj[n].push(u),"Calls"==n&&isNewCallView&&(Calls.fieldSet||(Calls.fieldSet=new Set),Calls.fieldSet.add(u)));var p=parseInt(l.uitype),f=Crm.getModuleRenderingValue(n,"field",p,"*");f||(f={}),f.style||(f.style={}),f.id=u,f.tabIndex=l.tabIndex,"Call_Duration"===d&&(f.style="width:'';");var v=o;o="true"==l.customfield?l.colname:o;var h,g,T,C=l.defaultvalue?l.defaultvalue:"";301==p&&"true"==trimBoth(C)&&(p=300),"COUNTRY"!=l.colname&&"SHIPPINGCOUNTRY"!=l.colname&&"MAILINGCOUNTRY"!=l.colname&&"BILLINGCOUNTRY"!=l.colname&&"OTHERCOUNTRY"!=l.colname||(l.kpid="countryAutoSuggest",l.params='{"multiSel":"false"}'),"Services"===e.module&&"setup"===e.currentStatus&&"SERVICEDURATION"===l.colname&&(f.style="display:none;"),CScriptLib&&e&&e.currentField&&(h=e.currentField.criteria,T=e.currentField.userSearchCriteria,g=JSON.stringify(e.currentField.userCriteria));var b={"data-currentStatus":e.currentStatus,"data-sysRefName":l.sysRefName,"cscript-tag":l.sysRefName,"data-def-mandate":l.mandate,"data-mandate":l.mandate,"data-content-type":s,"data-uitype":l.uitype,"data-colname":l.colname,"data-name":o,"data-maxlength":l.maxlength,"data-customfield":l.customfield,"data-lookup-module":l.lookupmodule,"data-decimal-length":l.decimalLength,"data-displaylabel":l.displaylabel,"data-old-value":C,"data-dynamic-fields":l.dynamicFields,"data-label":l.label,"data-readonly":l.readonly,"data-selectedRadio":l.selectedRadio,"data-frequency":l.frequency,"data-selDays":l.selDays,"data-monthData1":l.monthData1,"data-monthData2":l.monthData2,"data-monthData3":l.monthData3,"data-startdate":l.startdate,"data-enddate":l.enddate,"data-parentcolname":l.parentcolname,"data-kpid":l.kpid,"data-params":l.params,"data-linkingmodule":l.linkingmodule,"data-selectedid":l.selectedid,"data-fieldid":l.fieldid,"data-formulaType":l.formulaType,"data-picklistmap":l.picklistmap,"data-criteria":h,"data-rounding-option":l.rounding_option,"user-search-criteria":T,"user-criteria":g};if(m&&-1===["LINKINGMODULE_ID","ITEMDESCRIPTION","BOOKID","LINETAX","TOTALAFTERDISCOUNT","DISCOUNT_TYPE","DISCOUNT_PERCENTAGE"].indexOf(l.colname)?b["data-zcqa"]=void 0!==l.rowNum?"_1"===l.rowNum?"Crm_"+l.subformsectionlabel+"_"+l.label+"_1":"Crm_"+l.subformsectionlabel+"_"+l.label+"_"+l.rowNum:v:b["data-zcqa"]=m&&void 0!==l.rowNum?"Crm_"+l.subformsectionlabel+"_"+l.label+"_"+l.rowNum:v,555==p){b["data-sys-name"]=l.systemName;var _=fileupload.getFileUploadOptionList();l.picklistmap=_,l.val=_;var y="true"===e.currentField.issubformfield;y&&e.currentField.defaultvalue.length>0&&"string"!=typeof e.currentField.defaultvalue&&"clone"!==e.position?f.uploadedFileAvilable=!0:!y||0!==e.currentField.defaultvalue.length&&e.currentField.defaultvalue!==I18n.getMsg("crm.tpi.ctiapi.config.choosefile")||(f.uploadedFileAvilable=!1)}else 2!==p&&26!==p||!l.colorcode_enabled||(b["data-colorcode_enabled"]=l.colorcode_enabled,b["data-colorcode"]=l.color_code);l.dependent_lookup_fieldid&&(b["data-refered_from_fieldid"]="lookup_"+l.dependent_lookup_fieldid+"_"+l.refered_from_fieldid),l.subformdisplaylabel&&(b["data-subformdisplaylabel"]=l.subformdisplaylabel),l.subformsectionlabel&&(b["data-subformsectionlabel"]=l.subformsectionlabel),void 0!==l.lineitemProdCode&&(b["data-lineitemProdCode"]=l.lineitemProdCode);if(l.restricted&&(b["data-restricted"]=l.restricted),"EMAILOPTOUT"===l.colname){var I=$("#emailOptOutInfo").attr("data-param");b["data-param"]=I||l.unsubInfo}36!==p&&143!==p&&144!==p&&145!==p&&(116!=p&&117!=p||"currency"!=l.formulaType)||(Crm.userDetails.isSubformNewComponentEnabled&&(Crm.currencyFields[n]=Crm.currencyFields[n]?Crm.currencyFields[n]:[]),Crm.currencyFields[n]&&!Crm.currencyFields[n].includes(u)&&Crm.currencyFields[n].push(u));var E="class";switch(p){case 8:case 55:case 221:Crm.userDetails.CLIENT_ACCOUNT&&("create"===e.currentStatus&&(C=Crm.userDetails.CLIENT_OWNER_NAME,l.defaultvalue=C,l.defaultid=Crm.userDetails.CLIENT_OWNER_ID),l.readonly="true"),(!Crm.userDetails.LITE.IS_LITE_USER||8!==p||"create"!==e.currentStatus)&&(55!==p&&221!==p||l.defaultvalue&&""!==l.defaultvalue)||(C=I18n.getMsg("None"),l.defaultvalue=C,l.defaultid=null),221==p&&l.popup&&(b["data-bodyAppend"]="yes"),55!==p&&""===C&&(C=Crm.userDetails.DISPLAY_NAME,l.defaultvalue=C,l.defaultid=Crm.userDetails.USER_ID),55!==p&&221!==p&&"Appointments"!=n&&(l.readonly="true"!=l.readonly?!e.changeOwnerPermission+"":l.readonly),l.personalAccount=Crm.userDetails.PERSONAL_ACCOUNT,(Crm.userDetails&&Crm.userDetails.PERSONAL_ACCOUNT||"true"===l.readonly)&&(f[E]="","Events"!==n&&(f.style="width:97%")),b["data-id"]=l.defaultid,b["data-oldid"]=l.defaultid,f.title=C,b["zcqa-dropdown"]=b["data-zcqa"],b["zcqa-lookup"]=b["data-zcqa"]+" lookup";break;case 25:case 24:case 202:case 32:case 36:case 37:case 35:case 1:case 21:case 38:case 33:case 34:case 4:case 6:case 7:case 9:case 5:case 10:case 12:case 15:case 52:case 786:case 127:case 99:case 13:case 133:case CrmField.UITYPES.SYSTEM_SINGLE_LOOK_UP_ENTITY:case CrmField.UITYPES.LAYOUT_LOOKUP:case 116:case 117:case 22:case 11:case 14:case 333:case 19:case 62:case 16:case 444:if(133===p&&"PROFILEID"===l.colname){"true"===l.readonly&&(f.disabled=!0,f[E]="searchFormatText");break}if(Crm.userDetails.CLIENT_ACCOUNT&&Crm.userDetails.moduleVsCriteriaLookup&&"edit"!==e.currentStatus?444===p&&Crm.userDetails.isMultiSelectionPopupSupported||!l.lookupmodule||l.lookupmodule!==Crm.userDetails.CLIENT_TYPE||!Crm.userDetails.moduleVsCriteriaLookup[n]||-1===Crm.userDetails.moduleVsCriteriaLookup[n].toString().indexOf(l.fieldid)||((444!==p||444===p&&(C&&-1===!C.indexOf(Crm.userDetails.DISPLAY_NAME)||!C))&&(C=Crm.userDetails.DISPLAY_NAME,l.defaultid=Crm.userDetails.CLIENT_ID.toString()),l.defaultvalue=C,l.readonly="true",b["data-readonly"]="true"):!Crm.userDetails.CLIENT_ACCOUNT||133!=p&&13!=p&&4!=p&&7!=p||"edit"===e.currentStatus||l.lookupmodule&&l.lookupmodule===Crm.userDetails.CLIENT_TYPE&&(C=Crm.userDetails.DISPLAY_NAME,l.defaultvalue=C,l.defaultid=Crm.userDetails.CLIENT_ID.toString(),l.readonly="true",b["data-readonly"]="true"),4==p&&(b["data-oldid"]=l.defaultid),116==p){f.readonly=!0;var D=f.id;if(m&&"TOTAL"===l.colname&&(f.expression=l.expression),t&&D.split("_").length<5&&(D+="_1"),(!t||t&&5==D.split("_").length&&"1"==D.split("_")[4])&&(window[n].formulaObj.formulaFldDomIds.push(D),window[n].formulaObj.formulaArr.push(l.expression),Crm.userDetails.DYNAMIC_FORMULA_ENABLED)){var F=null;l.stop_compute&&(F=l.stop_compute_expression),window[n].formulaObj.formulaConditionExpression[D]=F}window[n].formulaObj.formulaFldVsAssumeDefault[D]=l.assumeDefault,window[n].formulaObj.formulaVsFormulaField[l.expression]||(window[n].formulaObj.formulaVsFormulaField[l.expression]=[]),window[n].formulaObj.formulaVsFormulaField[l.expression].push(D),"datetime"==l.formulaType&&""!==l.defaultvalue?l.defaultvalue=Utils.getDateTimeInUserFormat(new Date(l.defaultvalue),!0,"false"):"date"==l.formulaType&&""!==l.defaultvalue&&(l.defaultvalue=Utils.getDateInUserDatePattern(new Date(l.defaultvalue),!1))}if(117==p){f.readonly=!0;D=f.id;t&&D.split("_").length<5&&(D+="_1"),window[n].formulaObj.aggrArr.push(l.expression),window[n].formulaObj.aggrVsAggrField[l.expression]||(window[n].formulaObj.aggrVsAggrField[l.expression]=[]),window[n].formulaObj.aggrVsAggrField[l.expression].push(D),window[n].formulaObj.aggrFieldVsAggMap[D]=l.expression;var S=l.criteria;if(S&&Lyte.registeredMixins["crm-create-mixin"]){var w=Lyte.registeredMixins["crm-create-mixin"].getAggCrtDetails(S,crmTemplate.subformFldDetails,{},!0).crtExp;window[n].formulaObj.aggrFieldVsaggrCrt[D]=w.replaceAll(",","#&")}}if(/\b(4|6|7|9|10|12|13|15|132|135|136)\b/.test(p)?("Tasks"!==n&&"Calls"!==n&&"Events"!==n&&(f[E]="searchFormatText textField wsNowrap tOE",f.title=l.defaultvalue),f[E]="textField"):"true"===l.readonly&&(f.readonly=!0,f.disabled=!0),62==p&&"Tasks"===n&&"SUBJECT"===l.colname&&(f.autocomplete="off"),"SUBJECT"===l.colname&&"Events"===n&&""===l.defaultvalue&&("meetings"===Crm.getModuleDisplayName()?l.defaultvalue=I18n.getMsg("crm.new.meeting"):l.defaultvalue=I18n.getMsg("crm.events.new",[Events.getModuleName(!0,!0,!0)])),1===p&&"Call_Duration"===d&&(f.id+="_Mins",f.size=2,l.defaultvalue?3==l.defaultvalue.split(":").length?(l.minsVal=""+(60*+l.defaultvalue.split(":")[0]+ +l.defaultvalue.split(":")[1]),l.secVal=""+l.defaultvalue.split(":")[2]):(l.minsVal=""+l.defaultvalue.split(":")[0],l.secVal=""+l.defaultvalue.split(":")[1]):(l.secVal="00",l.minsVal="00")),24==p||202==p||786===p||14===p||333===p){if("REMINDAT"==l.colname)b["data-alert-type"]=l.alertType,b["data-repeat-type"]=l.repeatType,b["data-reminder-date"]=l.reminderDate,b["data-remind-Before"]=l.remindBefore,f.class="element";else if(l.defaultvalue){var R=Utils.getDateInUserDatePattern(new Date(l.defaultvalue));f.value=R,b.oldValue=new Date(l.defaultvalue),b["data-date-obj"]=new Date(l.defaultvalue)}if(f.placeholder=Crm.userDetails.DATE_PATTERN.toLowerCase(),(786==p||14===p||333===p)&&"REMINDAT"!=l.colname){var A,L=!1;if("HH:mm"===Crm.userDetails.TIME_FORMAT&&(L=!0),""==C){var N=new Date;A="Events"===n||"Appointments"==n?Events.getRoundedDateTime(N):N,"CALLSTARTDATETIME"!==l.colname&&N.setMinutes(0),"Native__Backstage__Extn__Event_Start_Date"===l.sysRefName?A.setHours(A.getHours()+1):"Native__Backstage__Extn__Event_End_Date"===l.sysRefName&&A.setHours(A.getHours()+2),"Native__Webinar__Extn__Webinar_Schedule"===l.sysRefName&&A.setHours(A.getHours()+1)}else A=new Date(C);""==C&&"Crm_Events_ENDDATETIME"==u&&(A=new Date(A.valueOf()+60*Crm.calPreferences.EVENTDURATION*1e3)),"Events"!==n&&"Appointments"!=n||"setup"===Events.currentStatus||"false"!==l.customfield||14!==p&&333!==p||(f.value=crmCalendar.convertToUserDatePattern(A.getDate()+" "+A.getMonth()+" "+A.getFullYear())),b["data-date-obj"]=A;var k="",O="40px";L?(k=Utils.formatTimeVal(A.getHours())+":"+Utils.formatTimeVal(A.getMinutes()),"setup"!==e.currentStatus&&(O="5rem")):("setup"!==e.currentStatus&&(O="7rem"),k=(C=Utils.convertTo12HoursFormatTimeObj(A)).hrs+":"+C.mins+" "+I18n.getMsg(C.meridiem.toUpperCase())),l.defaultvalue=f.value?f.value:"",("setup"===Events.currentStatus||"Appointments"===e.module&&"setup"===e.currentStatus)&&(k=""),l.timeVal=k,l.timeAttrObj=objectUtils.cloneObject(f),l.timeAttrObj.value=k,l.timeAttrObj.style="width:"+O+";margin-left:10px",l.timeAttrObj.placeholder=Crm.userDetails.TIME_FORMAT,l.timeAttrObj.id+="_TimeOption",(m||l.isaggrfield)&&(l.timeAttrObj.class=l.timeAttrObj.class+" "+l.timeAttrObj.id),l.timeDataObj=objectUtils.cloneObject(b)}}else 36==p&&l.defaultvalue?f.value=parseFloat(l.defaultvalue):/\b(4|5|6|7|9|10|12|13|15|132|133|135|136)\b/.test(p)&&"ROLEID"!==l.colname&&"PROFILEID"!=l.colname&&(b["data-id"]=l.defaultid,m&&("PRODUCTID"===l.colname?(f[E]="textField productIdFld",void 0!==l.prdDetails&&(f.prdDetails=JSON.stringify(l.prdDetails))):"BOOKID"===l.colname&&void 0!==l.pricingDetails&&(f.pricingDetails=JSON.stringify(l.pricingDetails))));break;case 17:f.name=l.label;break;case 1234:l.val=window[n].eventRemindAtOptions,"Calls"===n?l.val=[{value:"0",html:I18n.getMsg("None")},{value:"5 mins",html:I18n.getMsg("crm.event.remind.mins",[5])},{value:"10 mins",html:I18n.getMsg("crm.event.remind.mins",[10])},{value:"15 mins",html:I18n.getMsg("crm.event.remind.mins",[15])},{value:"30 mins",html:I18n.getMsg("crm.event.remind.mins",[30])},{value:"1 hrs",html:I18n.getMsg("crm.event.remind.hrs",[1])},{value:"2 hrs",html:I18n.getMsg("crm.event.remind.hrs",[2])},{value:"1 days",html:I18n.getMsg("crm.event.remind.day",[1])},{value:"2 days",html:I18n.getMsg("crm.event.remind.days",[2])}]:"Events"===n&&(l.val=[{value:"none",html:I18n.getMsg("None")},{value:"0",html:I18n.getMsg("crm.event.remind.ontime",[Crm.getModuleDisplayName(!0,!1,!0)])},{value:"5 mins",html:I18n.getMsg("crm.event.remind.mins",["5"])},{value:"10 mins",html:I18n.getMsg("crm.event.remind.mins",["10"])},{value:"15 mins",html:I18n.getMsg("crm.event.remind.mins",["15"])},{value:"30 mins",html:I18n.getMsg("crm.event.remind.mins",["30"])},{value:"1 hrs",html:I18n.getMsg("crm.event.remind.hr",["1"])},{value:"2 hrs",html:I18n.getMsg("crm.event.remind.hrs",["2"])},{value:"1 days",html:I18n.getMsg("crm.event.remind.day",["1"])},{value:"2 days",html:I18n.getMsg("crm.event.remind.days",["2"])}]),f.style.widht="135px";break;case 300:case 123:case 41:case 301:var M=!1;("true"==trimBoth(C)||300==p&&"false"!=trimBoth(C))&&(M=!0),M&&(f.checked=M),300!==p&&301!==p||!l.defaultvalue_unmodified||(b["data-defaultvalue_unmodified"]=l.defaultvalue_unmodified),b["data-old-value"]=M+"","true"===l.readonly&&(f.disabled="disabled");var U="edit"===window[n].currentStatus||"clone"===window[n].currentStatus;123==p&&U&&"Tasks"===n?null!=C&&""!=C&&(b["data-recData"]=C,f.checked=!0,e.EditSeries="true"):123==p&&U&&("true"==e.EditSeries?(f.checked=!0,l.readonly="true",f.disabled="disabled",b["data-recData"]=C):f.disabled="disabled");break;case 26:this.dependentFieldsList.contains(f.id)||this.dependentFieldsList.push(f.id),l.val.length||(l.val=[l.val]);var x=l.val,P={},H=[];l.default=[];for(var B=!1,V=0;V<x.length;V++)x[V].content?"-None-"===x[V].content?H.push({html:x[V].content,value:"none"}):H.push({html:x[V].content,value:x[V].pbty+":"+x[V].content,fcCategory:x[V].fccategory,actualFcCategory:x[V].actualFcCategory,stageId:x[V].stageId,fctype:x[V].fctype}):H[V]=x[V],(H[V].value===l.defaultvalue||H[V].html===l.defaultvalue||l.defaultvalue&&H[V].html===Crm.getDealsStageValue(l.defaultvalue))&&(P.html=x[V].content,null==x[V].content&&(x[V].content=x[V].html),P.value=l.defaultvalue.split(":")[0]+":"+x[V].content,H.pop(),H.push({html:x[V].content,value:P.value,fcCategory:x[V].fccategory,actualFcCategory:x[V].actualFcCategory,stageId:x[V].stageId,fctype:x[V].fctype}),P.fccategory=x[V].fccategory,!0===l.colorcode_enabled&&(P.colorcode=x[V].colorCode),P.fctype=x[V].fctype,l.default.push(P),B=!0),!0===l.colorcode_enabled&&(H[V].colorCode=x[V].colorCode,H[V].DisplayValue=x[V].content),H[V].name||(H[V].name=x[V].name);!B&&l.defaultvalue&&(H.push({html:Crm.getDealsStageValue(l.defaultvalue),value:l.defaultvalue}),P.html=Crm.getDealsStageValue(l.defaultvalue),P.value=l.defaultvalue,l.default.push(P)),l.default.length<=0&&(P.value=H[0].value,P.fccategory=H[0].fccategory,P.html=H[0].content,null==H[0].content&&(P.html=H[0].html),!0===l.colorcode_enabled&&(P.colorcode=H[0].colorCode),l.default.push(P)),l.val=H,b["data-values"]=JSON.stringify(l.val);break;case 2:case CrmField.UITYPES.SERVICE_TIMING:case 555:case 27:case 100:case 96:case 28:case 42:case 98:case 39:if(l.default=[],28!=p&&(this.dependentFieldsList.contains(f.id)||this.dependentFieldsList.push(f.id)),104===p&&"REMINDINVITEESAT"===l.colname&&f.style&&(delete f.style,f.tabIndex=23),"true"===l.readonly&&(f.disabled=!0,f[E]="searchFormatText"),42==p&&"remTime"==l.colname){k="",O="40px";L?(k=Utils.formatTimeVal(A.getHours())+":"+Utils.formatTimeVal(A.getMinutes()),"setup"!==e.currentStatus&&(O="35px")):("setup"!==e.currentStatus&&(O="65px"),k=(C=Utils.convertTo12HoursFormatTimeObj(A)).hrs+":"+C.mins+" "+I18n.getMsg(C.meridiem.toUpperCase())),"Tasks"!=n&&(l.defaultvalue=f.value),"setup"===Events.currentStatus&&(k=""),l.timeVal=k,l.timeAttrObj=objectUtils.cloneObject(f),l.timeAttrObj.value=k,l.timeAttrObj.style="width:"+O+";margin-left:10px",l.timeAttrObj.class="textField",l.timeAttrObj.id+="_TimeOption"}100!==p&&p!==CrmField.UITYPES.GLOBAL_TAX||(f.multiple=!0);var j=[];if((x=l.val)instanceof Array||(x=[x]),l.defaultvalue&&"PIPELINE"==l.colname&&e.triggerPipelineChange&&!l.picklistmap.some((function(e){return l.defaultvalue==e.uservalue}))||"Appointments"===n&&e.currentSection&&"2"===e.currentSection.section_id&&2===p?l.val.forEach((function(e){"object"==typeof e&&(P=e.content.split(";"),l.defaultvalue=e.content)})):27!=p&&555!=p&&(l.defaultvalue||100==p||p==CrmField.UITYPES.GLOBAL_TAX||l.isDetailView||"edit"==window[n].currentStatus)?P=l.isDetailView||"edit"==window[n].currentStatus?l.defaultvalue?l.defaultvalue.split("; "):[""]:l.defaultvalue?l.defaultvalue.split("; "):"":(P=l.defaultsalutationValue?l.defaultsalutationValue:"")&&(P=P.split(";")),x){var Y=x.length;if(100==p&&"RECURRING_WEEKLY_DAYS"==l.colname&&"Tasks"==n)for(var z=P.length,W=0;P&&W<z;W++){var G=P[W],q=!1;for(V=0;V<Y;V++){var J=x[V];"object"==typeof x[V]&&(J=x[V].value),J===G&&(q=!0)}q||""==G||x.push(G)}if(555!=p&&"RECURRING_WEEKLY_DAYS"!=l.colname)for(W=0;P&&W<P.length;W++){for(G=P[W],q=!1,V=0;V<Y;V++){J=x[V];"object"==typeof x[V]&&(J=x[V].content?x[V].content:x[V].html),J===G&&(q=!0)}if(!q&&""!=G&&(x.push(G),l.picklistmap)){var K={value:G,uservalue:G};l.colorcode_enabled&&G===l.defaultvalue&&(K={value:G,uservalue:G,colorCode:l.color_code}),l.picklistmap.push(K)}}for(W=0;W<x.length;W++){var X,Q;if("object"==typeof x[W]){var Z="default";100==p&&"RECURRING_WEEKLY_DAYS"==l.colname&&x[W].value&&"Tasks"==n?(j[W]={html:x[W].html,content:x[W].value},X=x[W].value):x[W].html&&x[W].value?(j[W]={html:x[W].html,content:x[W].value},X=x[W].html):x[W].html&&x[W].content?(j[W]={html:x[W].html,content:x[W].content},X=x[W].content):x[W].content?(j[W]={html:x[W].content,content:x[W].content},X=x[W].content):(j[W]=x[W],X=x[W].value),!P&&x[W][Z]&&(j[W][Z]="true","FIRSTNAME"!==l.colname&&(l.defaultvalue=l.defaultvalue?l.defaultvalue:j[W].content),x[W].html||(x[W].html=x[W].content),l.default.push(x[W])),27==p&&(Q=x[W].content)}else if(555==p)Array.isArray(l.picklistmap)?(Q=l.picklistmap[W].systemvalue,j[W]={html:l.picklistmap[W].uservalue,content:Q}):(Q=l.picklistmap.systemvalue,j[W]={html:l.picklistmap.uservalue,content:Q}),X=x[W];else if(Q="-None-"==x[W]?"":x[W],j[W]={html:x[W],content:Q},X=x[W],l.colorcode_enabled){var ee=getPickListColorCode(Q,l.picklistmap);j[W].colorCode=ee}if(P&&P.contains(X)){Z="default";"object"==typeof x[W]?l.default.push(j[W]):l.picklistmap&&l.picklistmap[W]&&l.picklistmap[W].colorCode&&""!==l.picklistmap[W].colorCode?l[Z].push({html:x[W],content:Q,colorcode:l.picklistmap[W].colorCode}):l[Z].push({html:x[W],content:Q}),j[W][Z]="true"}else if(P&&P===X){l[Z="default"].push({html:Q,content:Q}),j[W][Z]="true"}Crm.isStdOptionsField(l.colname)&&l.picklistmap&&(Array.isArray(l.picklistmap)?l.picklistmap[W]&&(j[W].systemvalue=l.picklistmap[W].systemvalue):j[W].systemvalue=l.picklistmap.systemvalue,-1==f[E].indexOf("dataPopulated")&&(f[E]+=" dataPopulated"))}}if(27==p){var te=objectUtils.cloneObject(b);te["data-mandate"]=!1,te["data-content-type"]="salutation",te["data-colname"]="SALUTATION",te["data-name"]="saltName",te.tabIndex=l.tabIndex,this.dependentFieldsList.contains(u+"_SALUTATION")||this.dependentFieldsList.push(u+"_SALUTATION"),Crm.fieldsObj[n].push(u+"_SALUTATION");var ae=l.defaultsalutationValue?l.defaultsalutationValue:"";l.salDataObj=te,te["data-old-value"]=ae,l.salAttrObj={id:u+"_SALUTATION",style:"width:28%",class:"select"},"true"==l.readonly&&(l.salAttrObj.disabled=!0),te["data-values"]=JSON.stringify(x)}if("Events"==n&&98==p){var re=Events.statusDropDownObj;j=re="edit"==window[n].currentStatus?Events.getStatusObj(C,window[n].isEventStarted):re.slice(0,re.length-1)}if(e.dependentFields&&!Crm.isHeadless&&!Crm.isStdOptionsField(l.colname)&&e.dependentFields[l.colname]||(l.val=j),b["data-values"]=JSON.stringify(x),b["data-picklistmap"]=JSON.stringify(l.picklistmap),l.colorcode_enabled&&(b["data-picklist-color"]=l.colorcode_enabled),b["data-old-value"]||"39"!=p)"39"==p&&(window[n].defaultCurrency=b["data-old-value"]);else for(null!=e.PersonalCurrencyISOcode?(b["data-old-value"]=e.PersonalCurrencyISOcode,window[n].defaultCurrency=e.PersonalCurrencyISOcode):(b["data-old-value"]=x[0]&&x[0].content?x[0].content:x[0],window[n].defaultCurrency=b["data-old-value"]),i=0;i<x.length;i++){if(l.val[i].content==e.PersonalCurrencyISOcode&&null!=e.PersonalCurrencyISOcode){l.val[i].default="true",l.default.push(l.val[i]);break}0==i&&(l.val[0].default="false")}break;case 3:case 110:f.cols="5",f[E]="textField","true"===l.readonly&&(f.readonly=!0,f[E]="textField"),"ITEMDESCRIPTION"===l.colname&&m&&(f[E]=f[E]+" prdItemDesc");break;case 210:"true"===l.readonly&&(f.disabled=!0,f[E]="searchFormatText","true"===l.LiteConstant&&(f.LiteConstant=!0));break;case CrmField.UITYPES.MULTI_MODULE_LOOK_UP_ENTITY:var le=objectUtils.cloneObject(b);le["data-mandate"]=!0,le["data-content-type"]="Lookup",le["data-relatedname"]=le["data-name"],le["data-id"]=l.defaultid,le["data-permission-denied-lookup"]=le["data-lookup-module"],le.tabIndex=l.tabIndex,this.dependentFieldsList.contains(u+"_RELATEDTO")||this.dependentFieldsList.push(u+"_RELATEDTO"),Crm.fieldsObj[n].push(u+"_RELATEDTO"),l.relatedToDataObj=le,l.relatedToAttrObj={id:u+"_RELATEDTO",style:"width:28%",class:"select"},le["data-values"]=JSON.stringify(x)}34!=p&&38!=p&&36!=p&&143!=p&&144!=p&&145!=p&&(f.maxlength=l.maxlength),"2"===l.tooltiptype&&445!=l.uitype&&(f.placeholder=l.tooltipcontent),221===p&&m&&(f["field-id"]=u,Crm.isLineItemSubFormModule(l.subformdisplaylabel)&&(f.class=f.class+" lineItemUserLookup w100_per"),b["user-record"]=JSON.stringify({id:b["data-id"],full_name:f.title})),"Lookup"==e.currentField.type&&(""!==l.defaultvalue&&Crm.isInventoryModule(n)&&"PRODUCTID"===l.colname?l.prdDetails&&l.prdDetails.Product_Code&&""!==l.prdDetails.Product_Code&&l.lineitemProdCode?b["data-selectedlookupvalue"]=l.defaultvalue.replace(/(\r\n|\n|\r)/gm," ")+" ("+l.prdDetails.Product_Code+")":b["data-selectedlookupvalue"]=l.defaultvalue.replace(/(\r\n|\n|\r)/gm," "):b["data-selectedlookupvalue"]=l.defaultvalue,b["data-selectedid"]=l.defaultid),m&&(f.class=f.class+" "+u,f.isOprDenied=l.isOprDenied),l.attrObj=f,l.dataObj=b},crmTemplate.createFieldContentForMultiLine=function(e,t){var a="<div class=\"labelValCreate mL45 createMultiLineField\"> <crux-text-area-component cx-prop-from = 'create'";(a+=" cx-prop-maxlength= '"+e.maxlength+"'",a+="id='"+e.attrObj.id+"'",a+="data-fieldid='"+e.fieldid+"'",a+=" class = 'cxBigTextarea' cx-prop-prevent-collapse = 'true' ",a+="data-customfield='"+e.customfield+"'",a+="data-name='"+$ESAPI.encoder().encodeForHTMLAttribute(e.label)+"'",a+="data-uitype='"+e.uitype+"'",a+="data-mandate='"+e.mandate+"'",a+="data-sysrefname='"+e.sysRefName+"'",a+="cscript-tag='"+e.sysRefName+"'",e.refered_from_fieldid)&&(a+="data-refered_from_fieldid='"+("lookup_"+e.dependent_lookup_fieldid+"_"+e.refered_from_fieldid)+"'");return"true"!==e.readonly&&!0!==e.readonly||(a+="cx-prop-disabled='true'",a+="cx-prop-readonly='true'"),"2"===e.tooltiptype&&(a+="cx-prop-placeholder='"+$ESAPI.encoder().encodeForHTMLAttribute(e.tooltipcontent)+"'"),a+="data-displaylabel='"+$ESAPI.encoder().encodeForHTMLAttribute(e.displaylabel)+"'",a+="cx-prop-appearance='box' data-zcqa ='"+$ESAPI.encoder().encodeForHTMLAttribute(e.label)+"'",e.defaultvalue&&(a+="cx-prop-value='"+$ESAPI.encoder().encodeForHTMLAttribute(e.defaultvalue)+"'"),t&&(t>71?t+="px":t="71px",a+="cx-prop-height='"+t+"'"),a+="data-colname='"+e.colname+"' ></crux-text-area-component></div>",$(a)[0]},crmTemplate.createFieldContentForRTF=function(e){var t='<div class="labelValCreate mL45 createMultiLineRTFField"> <crm-richtext-component ';(t+="cx-prop-maxlength= '"+e.maxlength+"'",t+="id='"+e.attrObj.id+"'",t+="data-fieldid='"+e.fieldid+"'",t+="data-customfield='"+e.customfield+"'",t+="data-name='"+$ESAPI.encoder().encodeForHTMLAttribute(e.label)+"'",t+="data-uitype='"+e.uitype+"'",t+="data-mandate='"+e.mandate+"'",t+="data-sysrefname='"+e.sysRefName+"'",t+="data-displaylabel='"+$ESAPI.encoder().encodeForHTMLAttribute(e.displaylabel)+"'",t+="cx-prop-display-label='"+$ESAPI.encoder().encodeForHTMLAttribute(e.displaylabel)+"'",t+="data-zcqa ='"+$ESAPI.encoder().encodeForHTMLAttribute(e.label)+"'","2"===e.tooltiptype&&(t+="cx-prop-placeholder='"+$ESAPI.encoder().encodeForHTMLAttribute(e.tooltipcontent)+"'"),"true"!==e.readonly&&!0!==e.readonly||(t+="cx-prop-readonly='true'"),e.refered_from_fieldid)&&(t+="data-refered_from_fieldid='"+("lookup_"+e.dependent_lookup_fieldid+"_"+e.refered_from_fieldid)+"'");if("Tasks"!==e.module&&"Events"!==e.module||(t+="ps-scroll-class-needed='true'"),e.isDetailView){for(var a=$L("crm-richtext-component"),r=a.length,l=0;l<r;l++){var i=a[l].component;if(i.getData("viewIsMax")){i.setData("viewIsMax",!1),t+="cx-prop-default-maximize='true'";break}}t+="is-rich-text-needed='true'",t+="cx-prop-initial-scroll-needed='true'",t+="standard-view='true'"}return e.defaultvalue&&(t+="cx-prop-value='"+$ESAPI.encoder().encodeForHTMLAttribute(e.defaultvalue)+"'"),t+="data-colname='"+e.colname+"' ></crm-richtext-component></div>",$(t)[0]},crmTemplate.createFieldViewContentForRTF=function(e){var t="<span><crm-richtext-component ";return t+="cx-prop-from = 'view'",t+="cx-prop-display-label='"+$ESAPI.encoder().encodeForHTMLAttribute(e.displaylabel)+"'",e.defaultvalue&&(t+="cx-prop-value='"+$ESAPI.encoder().encodeForHTMLAttribute(e.defaultvalue)+"'"),"true"!==e.readonly&&!0!==e.readonly||(t+="cx-prop-readonly='true'"),t+="cx-prop-view-max-needed='true'",t+="</crm-richtext-component></span>",$(t)[0]},crmTemplate.createFieldContent=function(e,t){var a=e.currentField,r=e.module,l=e.loadingFrom;if(a.colname&&!crmConstants.defaultHiddenFields[a.colname]&&(t||"116"!==a.uitype&&"117"!==a.uitype||"setup"===window[r].currentStatus)||(a.colname||(a={}),a.emptyColumn=!0),Crm.userDetails.isPhoneNoNewView&&"33"==a.uitype&&Crm.loadPhoneFieldComponentJSFiles(),"8"!==a.uitype&&"221"!==a.uitype||(a.isSubordinateListing=!0===Crm.userDetails.permissions.Crm_Implied_List_Subordinate_Users),"301"===a.uitype&&"false"!==a.defaultvalue&&a.defaultvalue&&a.dataObj&&(a.dataObj.checked="true"),"62"==a.uitype){var i=a.val;if(a.val)for(var s=0;s<i.length;s++)"true"==i[s].default&&(""==a.defaultvalue&&(a.defaultvalue=i[s].content),a.val[s]=i[s].content)}if(a.attrObj||a.dataObj||crmTemplate.setFieldData(e,t),"40"==a.uitype&&("edit"==e.currentStatus?crmTemplate.recordCurrencyER=parseFloat(a.defaultvalue).toFixed(9):crmTemplate.recordCurrencyER=0),"8"==a.uitype&&e.tabId){var n=store.peekRecord("module",e.tabId).profiles,o=n.length,d=[],c="(profile:in:",u=[],m=[];for(s=0;s<o;s++)u.push(n[s].id),n[s].name&&m.push(n[s].name.replace(/,/g,"\\,"));var p={comparator:"in",field:"profile.id"};p.value=u,d.push(p);var f=m.join().replace(/\(/g,"\\(");c=c+(f=f.replace(/\)/g,"\\)"))+")",e.usercriteria=encodeURI(JSON.stringify(d)),e.usersearchcriteria=encodeURI(c)}else if(a.uitype===CrmField.UITYPES.MULTI_MODULE_LOOK_UP_ENTITY.toString()&&("edit"===e.currentStatus||"clone"===e.currentStatus)){var v=e.currentField.multiModuleLookup.length,h=v;for(s=0;s<v;s++){var g=store.peekRecord("module",e.currentField.multiModuleLookup[s].id);g&&e.currentField.defaultvalue1===g.plural_label&&h--}h===v&&(e.currentField.pastMultiModuleRecord=!0)}"32"!==a.uitype&&"38"!==a.uitype&&"52"!==a.uitype||!e.currentField.defaultvalue||(e.currentField.defaultvalue=Search.reverseFormatNumber(e.currentField.defaultvalue)),e.DOCS_PICKER_ENABLED=Crm.userDetails.ENABLE_DOCS_PICKER_ATTACHMENTS;var T=$(Handlebars.templates.crmCreateFieldContent(e)),C=T.find("input");if("36"===a.uitype||"143"===a.uitype||"144"===a.uitype||"145"===a.uitype){var b=T.find("input");b.css("width","inherit").addClass("cal_rate_maintain"),b.off("keypress keyup blur").on("keypress keyup blur",(function(e){crmTemplate.calculatorOperation(this,e)}))}else a.uitype!==CrmField.UITYPES.MULTI_MODULE_LOOK_UP_ENTITY.toString()||"edit"!==e.currentStatus&&"clone"!==e.currentStatus||!e.currentField.pastMultiModuleRecord?"Services"!=e.module||"STARTING_DATE"!=a.colname&&"CLOSING_DATE"!=a.colname||T.find("#Crm_Services_"+a.colname).attr("onchange","Lyte.registeredMixins['crm-services-mixin'].validateFromTill();"):(T.find("#Crm_Appointments_APPOINTMENTFOR_RELATEDTO").attr("data-lookup-module",""),T.find("#Crm_Appointments_APPOINTMENTFOR_RELATEDTO_img").attr("data-lookup-module",""));if(commonUtils.cleanWhitespace(T[0]),a.dynamicFields&&this.constructDynamicFields(r,a,T[0]),"Events"===r&&/\b(2|28|42|27|26|98)\b/.test(a.uitype)){var _=$(document.createElement("div")),y=T.find("select");y.length&&"RECURRING_CUSTOM_WEEK_REPEAT_ON"!=a.colname&&(y.removeClass("select"),y.css({width:""}),y.replaceWith(_),_.append(y))}if(T=window[r].createFieldContent(a,T),"Calls"===r&&"SEID"===a.colname&&C.data("lookupModule",T[0].childNodes[0].childNodes.length>0?T[0].childNodes[0].childNodes[0].value:"Accounts"),"Calls"!==r||!e.isTelephonyCall||"FROMNUMBER"!==a.colname&&"TONUMBER"!==a.colname||(a.readonly="true",C.data("readonly",!0)),"Tasks"!==r&&a.isBusHoliday&&$(T[0]).addClass("labelValCretateBh"),"Appointments"!==r||"APPOINTMENTDATEANDTIME"!==a.colname||"calendar"!==Events.createSource||Crm.isAppAction||Lyte.registeredMixins["crm-services-appointments-old-mixin"].setStartDateAndTime(Events.appointmentClickedDate,T),a.colorcode_enabled){i=a.default[0];var I=T.find("select"),E="26"===a.uitype,D=E?a.val:a.picklistmap,F="";if(i){if(i.colorcode)F=a.default[0].colorcode;else{var S=E?a.plainValue:i.content;F=a.defaultcolorcode?a.defaultcolorcode:getPickListColorCode(S,D,E)}I.children("option:selected").attr("data-colorcode",F),I.data("colorcode",F),r!==crmModuleConstants.Events?updateColorCodeForSelObj(I):crmModuleConstants.Events===r&&I.data("colorcode",$ESAPI.encoder().encodeForHTMLAttribute(F))}}if("setup"!==e.currentStatus&&(T.find("[data-fieldType='dateField']").each(crmTemplate.bindEventsToDateField),T.find("[id='Crm_Calls_CALLTYPE']").change((function(){Crm.setDependent(event,r,this,!1)})),T.find("[data-fieldType='timeField']").each(crmTemplate.bindEventsToTimeField),T.find("select").each((function(){28!=a.uitype&&(crmTemplate.dependentFieldsList.contains(this.id)||crmTemplate.dependentFieldsList.push(this.id)),a.val&&a.val[0]&&("-None-"==a.val[0]||"-None-"==a.val[0].html)&&$(this).addClass("selNone"),$(this).change(crmTemplate.modifySelectBox)}))),T.find(".newCustSel").each((function(){if(0==$(this).find(".newCustSelVal").length){var e=$(this).find("select option:selected").text();$(this).append("<span class='newCustSelVal'></span>"),$(this).children(".newCustSelVal").html("<span class='pR7 crm-font-regular'>"+e+"</span> <strong class='mT7 dIB tb_downarrow'></strong>"),$(this).change((function(){var e=$(this).find("select option:selected").text();$(this).children(".newCustSelVal").html("<span class='pR7 crm-font-regular'>"+e+"</span> <strong class='mT7 dIB tb_downarrow'></strong>")}))}})),("PROBABILITY"===a.colname||"STAGE"===a.colname||"AMOUNT"==a.colname)&&"Potentials"===r){var w="";if(e.currentField.suffixIndex&&(w=e.currentField.suffixIndex+"_"),"STAGE"===a.colname){var R=T.find("select");R.change((function(){Crm.calculateExpectedRevenue(w)})),"true"===a.readonly&&R.prop("disabled",!0)}else C.blur((function(){Crm.calculateExpectedRevenue(w)}))}if("Contacts"===r&&"Accounts"===a.lookupmodule&&"ACCOUNTID"===a.colname){var A=C.val();C.blur(A,Crm.toggleReportingTo)}if(T.find("input,select,textarea,.selectElementNew1").focusin(setFocusClass),T.find("input,select,textarea").blur(removeFocusClass),a.uitype==CrmField.UITYPES.SERVICE_DURATION&&T.find("div").focusin(setFocusClass),"62"==a.uitype&&(C.autocomplete({source:a.val,minLength:0,change:function(e,t){$(this).change()}}).data("ui-autocomplete")._renderItem=function(e,t){return $("<li class='ui-menu-item'>").append("<div tabindex='-1' class='ui-menu-item-wrapper'>"+$ESAPI.encoder().encodeForHTML(t.value)+"</div>").appendTo(e)},C.click((function(){if($("#multipleFieldsEditPop").is(":visible")){var e=$("#mouseArea__"+a.colname);e&&e.data("params")&&e.data("params").criteria&&this.setAttribute("data-criteria",e.data("params").criteria)}$(this).autocomplete("search")}))),"27"==a.uitype&&T.find("select").on("change",(function(){var e=T.find("input").attr("id");setTimeout((function(){$("#"+e).focus()}),10)})),"301"==a.uitype&&T.addClass("no-hvr-ln"),"1"===a.uitype&&"ACCOUNTNAME"===a.colname&&"Accounts"===r&&a.externalsource){var L=T.find("#Crm_Accounts_ACCOUNTNAME");L.length>0&&initSkyEyeAutoComplete(L)}if("1"==a.uitype&&"COMPANY"==a.colname&&C.length>0&&!C.data().readonly){var N={};"crmSocialTab"===l&&(N.scrollFocus=!1),crmLookupAutoComplete.initAutoCompletePlugin(C,"searchLookup",N),C.click((function(){$(this).autocomplete("search")}))}if((/\b(5|4|6|7|9|10|12|13|15|132|133|135|136)\b/.test(a.uitype)||Crm.userDetails.isLookupAdvancedSearchEnabledInLineItem&&"50"==a.uitype)&&"Events"!==r&&"crmSocialTab"!==l){function k(){C.length&&C.val().length>0?T.addClass("show-close"):O()}function O(){T.removeClass("show-close")}Crm.userDetails.isLookupAdvancedSearchEnabledInLineItem&&"50"===a.uitype&&(C=T.find("input.ui-autocomplete-input")),C.length>0&&!C.data().readonly&&"setup"!==e.currentStatus&&!t&&(crmLookupAutoComplete.initAutoCompletePlugin(C,"createPageLookup"),C.click((function(){if($("#multipleFieldsEditPop").is(":visible")){var e=$("#mouseArea__"+a.colname);e&&e.data("params")&&e.data("params").criteria&&this.setAttribute("data-criteria",e.data("params").criteria)}$(this).autocomplete("search")}))),C&&C[0]&&C[0].addEventListener("input",(function(){this.value&&C.data().id&&this.value!=C.attr("data-selectedlookupvalue")&&C.attr("data-selectedid")&&C.attr("data-selectedid")!=C.data().id&&C.attr({"data-selectedlookupvalue":this.value,"data-selectedid":C.data().id})})),T.on("mouseover",(function(){k(),function(){var e=C;if(e.length&&e.val().length>0){var t=e[0],a=t.scrollWidth;t.offsetWidth<Math.floor(a)?e.attr("title",e.val()):e.removeAttr("title")}}()})),T.on("mouseout",(function(){O()})),C.keyup(k)}else if(8==a.uitype||221==a.uitype){if(Crm.userDetails.CLIENT_ACCOUNT&&"create"===e.currentStatus)T.find("#ownerNameLookupSpan").text(Crm.userDetails.CLIENT_OWNER_NAME);var M=a.suffixIndex&&""!==a.suffixIndex&&"Events"!=r&&"Tasks"!=r&&"Calls"!=r?"_"+a.suffixIndex:"";T.find("#Crm_"+r+M+"_"+a.colname)}if((445===a.uitype||"445"===a.uitype)&&"Users"===a.lookupmodule||444===a.uitype||"444"===a.uitype){var U=a.attrObj.id,x=$(T).find("#"+U),P=x.parent();if(a.clonedfrom&&(x.attr("data-clonedfrom",a.clonedfrom),"CALLMXNCLONESCHEDULER"===x.data("selectedid")&&T.find("input").attr("data-mandate","true")),445===a.uitype||"445"===a.uitype){var H=$("#temp_"+U);if(!H||0==H.length){var B=$(P);B.find("img").addClass("dN"),B.find("input").addClass("dN"),$("<div/>",{class:"true"==a.readonly?"dIB w100_per chosen-container-multi":"dIB w100_per chosen-container chosen-container-multi",id:"temp_"+U}).prependTo(P),H=B.find("#temp_"+U),$("<ul/>",{class:"chosen-choices",onclick:"Search.focusUserMxNInput(this)"}).appendTo(H);var V=H.find("ul"),j=!1;"true"==a.readonly&&(j=!0),$("<input/>",{class:"fL mT6 pL5 borderNone",onclick:"crmTemplate.showUserLookup(this)",onkeydown:"Search.searchOnKeyDown(this,event,'"+U+"');",disabled:j,placeholder:"2"===a.tooltiptype?a.tooltipcontent:I18n.getMsg("crm.tpi.ctiapi.label.selectsupportrep"),rplaceholder:"2"===a.tooltiptype?a.tooltipcontent:I18n.getMsg("crm.tpi.ctiapi.label.selectsupportrep")}).appendTo(V)}var Y=V.find("input");if(a.selectedid&&a.selectedid.length>0){var z=a.selectedJson;"true"==a.readonly&&Y.addClass("dN")}else Y.attr("placeholder","");var W=$("#mouseArea__"+a.colname);if(W&&W.data("params"))var G=W.data("params").selectedAPIJson;if(G){var q={};q.api_name=a.sysRefName;var J=moduleRecordMapping[r].fields.filterBy(q)[0].multiuserlookup.connectedlookup_apiname,K=G.length;for(s=0;s<K;s++){Search.hideSpan(Q);var X=(te=G[s])[J].name,Q=te[J].id,Z="true"==a.readonly?"":'<a href="javascript:void(0)" class="search-choice-close p0" onclick="Search.removeSingleUser(event,this,\''+U+"_"+Q+"','"+U+"')\"></a>";H.find("ul").find("input").before('<li class="search-choice" data-id="'+Q+'" id="sel_'+U+"_"+Q+'">'+$ESAPI.encoder().encodeForHTML(X)+Z+"</li>").focus()}}else if(z){var ee=z.length;for(s=0;s<ee;s++){Search.hideSpan(Q);var te;X=(te=z[s]).name,Q=te.id,Z="true"==a.readonly?"":'<a href="javascript:void(0)" class="search-choice-close p0" onclick="Search.removeSingleUser(event,this,\''+U+"_"+Q+"','"+U+"')\"></a>";H.find("ul").find("input").before('<li class="search-choice" data-id="'+Q+'" id="sel_'+U+"_"+Q+'">'+$ESAPI.encoder().encodeForHTML(X)+Z+"</li>").focus()}}}}return crmTemplate.triggerImgKeyDwn(T),34!=a.uitype&&38!=a.uitype&&36!=a.uitype&&143!=a.uitype&&144!=a.uitype&&145!=a.uitype||$(T.find("input")[0]).on("keydown",(function(e){controlPercentagefieldValue(this,e)})),"250"===a.uitype?crmTemplate.createFieldContentForRTF(e.currentField):("DateTime"===a.type&&(T[0].className+=" minH34"),T[0])},crmTemplate.triggerImgKeyDwn=function(e){e.find("img").on("keydown",(function(e){if(32==e.keyCode){e.preventDefault();var t=renderingUtils.getTargetElem(e);renderingUtils.triggerEvent("click",$(t))}}))},crmTemplate.createSubformFieldContent=function(e,t,a,r,l){var i=e.currentField,s=e.module,n="555"===i.uitype;n&&"clone"===e.position&&(e.currentField.defaultvalue.length=0),n&&"setup"===e.currentStatus&&(e.currentField.issubformfield="true"===e.currentField.issubformfield?e.currentField.issubformfield:void 0!==e.currentField.subFormTabId?"true":"false");var o=$(Handlebars.templates.crmCreateFieldContent(e)),d=l?n?o:$(t).find("div"):o,c=Crm.isInventoryModule(s)&&"PRODUCTID"===i.colname?d.find(".productIdFld"):d.find("input");if("555"===i.uitype&&"true"===i.readonly&&o.find(".subform_ReadOnly").parent().addClass("readOnlyCursorSubform"),i.isaggrfield&&"true"===i.isaggrfield&&c.data("subFormTabId",a),$("#multipleFieldsEditPop").is(":visible")&&d.addClass("sfFormulaCalcBP"),""!==i.defaultvalue&&Crm.isInventoryModule(s)&&"PRODUCTID"===i.colname&&(i.prdDetails&&i.prdDetails.Product_Code&&""!==i.prdDetails.Product_Code&&i.lineitemProdCode?c.val(i.defaultvalue.replace(/(\r\n|\n|\r)/gm," ")+" ("+i.prdDetails.Product_Code+")"):c.val(i.defaultvalue.replace(/(\r\n|\n|\r)/gm," "))),"setup"!==e.currentStatus){var u=d.find("select");u.each((function(){28!==i.uitype&&(crmTemplate.dependentFieldsList.contains(this.id)||crmTemplate.dependentFieldsList.push(this.id)),$(this).change(crmTemplate.modifySelectBox)})),i.isLocalized&&u.data("isLocalized",i.isLocalized),i.isaggrfield&&"true"===i.isaggrfield&&u.data("subFormTabId",a)}var m=function(){if(d.off("mouseenter focusin"),"LINETAX"!==i.colname){var t="PRODUCTID"===i.colname&&Crm.isLineItemSubFormModule(i.subformdisplaylabel)?d.find(".productIdFld"):d.find("input"),a=d.find("select");switch(i.uitype){case"36":case"143":case"144":case"145":var l=$(d[0]).find(".cal_rate_maintain");switch(l.attr("placeholder",""),i.colname){case"DISCOUNT":l.off("mouseover").on("mouseover",(function(){productDetails.showDiscToolTipForSFLineItem(this)})),l.off("mouseout").on("mouseout",(function(){renderingUtils.zctt.hidett()}));break;case"TAX":l.off("mouseover").on("mouseover",(function(){productDetails.showTaxToolTipForSFLineItem(this)})),l.off("mouseout").on("mouseout",(function(){renderingUtils.zctt.hidett()}))}t.off("keypress keyup blur").on("keypress keyup blur",(function(e){crmTemplate.calculatorOperation(this,e)}));break;case"100":a.on("change",(function(){var e=$(this);setTimeout((function(){var t=e,a=t.closest(".subFrmTablWrapper"),r=a.outerHeight(),l=t.closest(".subFrmLayout"),i=t.closest("td").outerHeight();a.find(".subFrmSnFld").length>0&&l.find(".subFrmTablSerlNoOverlay tbody tr").eq(t.closest("tr").index()).find("td").css("height",i);var s=l.find(".SubFrmScrolIn");s.length>0&&s.css("height",r-20)}),100)}));break;case"301":d.addClass("no-hvr-ln");break;case"133":function n(){t.length&&t.val().length>0?d.addClass("show-close"):o()}function o(){d.removeClass("show-close")}d.on("mouseover",(function(){n(),"true"===i.issubformfield&&"PRODUCTID"!==i.colname&&function(){var e=t;if(e.length&&e.val().length>0){var a=e[0],r=a.scrollWidth,l=Lyte.registeredMixins["crm-browser-version-check"].getBrowserDetails().name;if("IE"===l||"Edge"===l){var i=$("<span>").attr("class","dummyTitleFixIE");i.text(e.val()),$("body").append(i),r=i[0].scrollWidth,i.remove()}a.offsetWidth<Math.floor(r)?e.attr("title",e.val()):e.removeAttr("title")}}()})),d.on("mouseout",(function(){o()})),"true"===i.issubformfield&&"PriceBooks"===i.lookupmodule&&"BOOKID"===i.colname&&"false"===i.customfield&&t.each((function(e,t){"BOOKID"===t.getAttribute("data-colname")&&t.addEventListener("click",(function(){$(this).autocomplete("disable")}))})),t.keyup(n);break;case"38":"QUANTITY"===i.colname&&(t.off("keypress").on("keypress",(function(e){productDetails.checkAlphabatePresence(e,this)})),t.off("blur").on("blur",(function(){productDetails.validateQtyFld(this)})));break;case"47":"LINETAX"===i.colname&&(t.css({display:"none"}),t.attr("taxTypes",""));break;case"117":"SUBTOTAL"===i.colname&&t.attr("temp-value",t.val())}crmTemplate.setSubformFocusBlurEvent(d,event),i.dynamicFields&&this.constructDynamicFields(s,i,d[0]),crmTemplate.triggerImgKeyDwn(d),r&&e.relListId&&(t.data("suffixindex",e.relListId),"DISCOUNT"===t.data("colname")&&Crm.userDetails.isDiscountFieldEnhancementMigrationCompleted&&($("#Crm_"+s+"_"+e.relListId+"_DISCOUNT_TYPE").data("suffixindex",e.relListId),$("#Crm_"+s+"_"+e.relListId+"_DISCOUNT_PERCENTAGE").data("suffixindex",e.relListId)))}};if(d.mouseenter(m),d.focusin(m),"setup"!==e.currentStatus){if(c[0]&&("24"===i.uitype||"202"===i.uitype||"333"===i.uitype)){var p=c[0].id;$(d.find("."+p)).each(crmTemplate.bindEventsToDateField),$(d.find("."+p+"_TimeOption")).each(crmTemplate.bindEventsToTimeField)}!l&&c[0]&&["TAX","DISCOUNT"].indexOf(c[0].getAttribute("data-colname"))>-1&&""===c[0].value&&(c[0].value=0)}if("34"===i.uitype||"38"===i.uitype||"36"===i.uitype||"143"===i.uitype||"144"===i.uitype||"145"===i.uitype)c.on("keydown",(function(e){controlPercentagefieldValue(this,e)}));else if(!0===i.colorcode_enabled&&s!==crmModuleConstants.Events){var f=d.find("select");f.children("option:selected").eq(0).attr("data-colorcode",i.color_code),f.parent().parent().find(".activitesColor").remove(),updateColorCodeForSelObj(f)}d[0]&&n&&l?(t.innerHTML="",t.appendChild(d[0])):d[0]&&!l&&t.appendChild(d[0])},crmTemplate.setSubformFocusBlurEvent=function(e,t){e.find("input,select,textarea,crm-user-wrapper").each((function(e,a){$(a).attr("isOprDenied")?$(a).attr("readonly",!0):($(a).on("focusin",setSubfrmFocusClass),$(a).on("blur",removeSubfrmFocusClass),void 0===t||"focus"!==t.type&&"click"!==t.type||$(a).trigger("focusin"))}))},crmTemplate.modifySelectBox=function(e,t){var a;(e&&void 0!==t&&t.isFormulaChange&&(e.data=t),e)?(t=renderingUtils.getTargetElem(e),(a=$(t)).closest(".labelValCreate").find(".textField").focus().prop("disabled",!1)):(a=$(t)).closest(".labelValCreate").find(".textField").focus().prop("disabled",!1);var r=a.data("module");$L("#multipleFieldsEditPop").length>0&&void 0!==a.data("entitymodule")&&""!==a.data("entitymodule")&&(r=a.data("entitymodule"));var l=a.data("uitype"),i=a.data("colname");if(crmTemplate.stageWonLostPromise=!1,"-None-"==a.val()||""==a.val()?$(this).addClass("selNone"):($(this).removeClass("selNone"),a.parent().removeClass("selectEmptyVal")),"Tasks"==r)if(8==l&&"SMOWNERID"==i)Crm.userDetails.USER_ID!=a.data().id&&$("#Crm_Tasks_SMOWNERID").data().oldValue!=e.target.innerText&&"edit"==window.Tasks.currentStatus||Crm.userDetails.USER_ID!=a.data().id&&("create"==window.Tasks.currentStatus||"clone"==window.Tasks.currentStatus)?($(".Tasks_Notify_Owner").show(),$("#Crm_Tasks_SENDNOTIFICATION").data("ownerChngd",!0)):($(".Tasks_Notify_Owner").hide(),document.getElementById("Crm_Tasks_SENDNOTIFICATION").checked=!1,$("#Crm_Tasks_SENDNOTIFICATION").data("ownerChngd",!1));else if(24!=l||"DUEDATE"!=i||"create"!=window.Tasks.currentStatus&&"edit"!=window.Tasks.currentStatus&&"clone"!=window.Tasks.currentStatus)if(24==l&&"DUEDATE"==i&&"view"==window.Tasks.currentStatus&&returnJson.entityMapJson.RECURRING&&returnJson.entityMapJson.RECURRING.startdate&&returnJson.entityMapJson.RECURRING.enddate){var s=$(e.target);""!=trimBoth(s.val())&&Utils.compareDate(new Date(returnJson.entityMapJson.RECURRING.startdate),new Date(s.data("dateObj")))&&Utils.compareDate(new Date(s.data("dateObj")),new Date(returnJson.entityMapJson.RECURRING.enddate))||crmTasks.changeDueDateFromDvForRecurTask()}else if(2!=l||"STATUS"!=i||"create"!=window.Tasks.currentStatus&&"edit"!=window.Tasks.currentStatus&&"clone"!=window.Tasks.currentStatus)if(2==l&&"STATUS"==i&&"view"==window.Tasks.currentStatus&&e.currentTarget.value==detailView.taskStatusMap.Completed){var n=localStorage.getItem("isDontAskAgainChecked_"+Crm.userDetails.ZUID);if("string"==typeof n&&(n="true"===n),!n){var o=returnJson.Tasks.entityid;closeTask(Crm.getCrmBasePath()+"/closeTask.do?action=CloseTask&taskid="+o+"&id="+o+"&module=Activities",!0)}}else"remTime"==i?crmTasks.updateRemRepeatSelect():"remTimePeriod"==i&&(crmTasks.updateRemTimeSelect(e.currentTarget.value,$("#Crm_Tasks_remTime")),crmTasks.updateRemRepeatSelect());else{p=$("#Crm_Tasks_DUEDATE").data("dateObj"),h=new Date(p);if((m=new Date).setHours(0,0,0,0),$("#Crm_Tasks_STATUS option:selected").val()!=crmTasks.compDispVal&&Utils.compareDate(m,h)||$("#Crm_Tasks_RECURRING").is(":checked"))crmTasks.unfreezeReminder();else{crmTasks.freezeReminder();(T=$("#Crm_Tasks_REMINDAT")).parent().on("mouseenter.duedateinpast",(function(){var e="crm.task.reminder.tooltip1";$("#Crm_Tasks_STATUS option:selected").val()==crmTasks.compDispVal&&(e="crm.task.reminder.tooltip2"),crmui.toolTip_show(this,"left",I18n.getMsg(e))})),T.parent().on("mouseleave.duedateinpast",(function(){crmui.toolTip_hide()})),!$("#Crm_Tasks_REMINDAT").is(":checked")||"create"!=window.Tasks.currentStatus&&"clone"!=window.Tasks.currentStatus||crmTasks.unsetReminder()}"edit"==window.Tasks.currentStatus&&(Crm.userDetails.USER_ID!=$("#Crm_Tasks_SMOWNERID").data().id&&$("#Crm_Tasks_STATUS").data().oldValue!=e.currentTarget.value&&e.currentTarget.value==crmTasks.compDispVal?($(".Tasks_Notify_Owner").show(),$("#Crm_Tasks_SENDNOTIFICATION").data("statusChngd",!0)):e.currentTarget.value!=crmTasks.compDispVal&&($(".Tasks_Notify_Owner").hide(),document.getElementById("Crm_Tasks_SENDNOTIFICATION").checked=!1,$("#Crm_Tasks_SENDNOTIFICATION").data("statusChngd",!1)))}else{var d=$("#Crm_Tasks_RECURRING");if(""!=e.target.value){var c="";if(!Utils.isValidDate(Crm.userDetails.DATE_PATTERN,e.target.value))return"edit"==window.Tasks.currentStatus&&crmTasks.isRecurringSet()&&(crmTasks.showExcludeFromRepeatSeriesAlert=!0,crmTasks.constructBlueBannerMsg()),crmTasks.isReminderSet()&&"period_based"===crmTasks.reminderSummaryData.reminderType&&crmTasks.unsetReminder(),d.prop("disabled",!0),$("#Tasks_fldRow_RemindAt_period").hide(),$("#Tasks_fldRow_remTime").hide(),crmTasks.removeRecurring(),crmTasks.unfreezeReminder(),void commonUtils.showErrorMsg(I18n.getMsg("crm.field.valid.check",$(e.target).data().displaylabel),$(e.target),r);document.getElementById("errorMsg_"+e.target.id)&&($("#errorMsg_"+e.target.id).remove(),$(e.target).closest(".tabDiv,.tabDivCreate").removeClass("errorFieldP")),c=crmCalendar.getDateObjectFromGivenDateString(e.target.value),d.data("readonly")||d.prop("disabled",!1),crmTasks.isRecurringSet()?"create"!=window.Tasks.currentStatus||!$("#Crm_Tasks_RECURRING_END_ON").prop("checked")&&Utils.compareDate(new Date(c),new Date($("#Crm_Tasks_RECURRING_END_DATE").data("dateObj")))?"edit"==window.Tasks.currentStatus&&(Utils.compareDate(new Date(d.attr("data-startDate")),new Date(c))&&Utils.compareDate(new Date(c),new Date(d.attr("data-endDate")))?(crmTasks.showExcludeFromRepeatSeriesAlert=!1,crmTasks.constructBlueBannerMsg()):(crmTasks.showExcludeFromRepeatSeriesAlert=!0,crmTasks.constructBlueBannerMsg())):crmTasks.removeRecurring():($("#Tasks_fldRow_RemindAt_period").show(),$("#Crm_Tasks_RemindAt_Start_Date1_Radio").parents("label").find(".rbHtml").show(),$("#Crm_Tasks_RemindAt_remTime_Radio").parents("label").find(".rbHtml").show()),$("#Tasks_fldRow_remTime").show()}else document.getElementById("errorMsg_"+e.target.id)&&($("#errorMsg_"+e.target.id).remove(),$(e.target).closest(".tabDiv,.tabDivCreate").removeClass("errorFieldP")),"edit"==window.Tasks.currentStatus&&crmTasks.isRecurringSet()&&(crmTasks.showExcludeFromRepeatSeriesAlert=!0,crmTasks.constructBlueBannerMsg()),crmTasks.isReminderSet()&&"period_based"===crmTasks.reminderSummaryData.reminderType&&crmTasks.unsetReminder(),d.prop("disabled",!0),$("#Tasks_fldRow_RemindAt_period").hide(),$("#Tasks_fldRow_remTime").hide(),crmTasks.removeRecurring(),crmTasks.unfreezeReminder();var u=$("#Crm_Tasks_REMINDAT");if(""!==e.target.value&&(e.target.defaultValue!==e.target.value||u.hasClass("errorFieldAdded"))&&"true"!==u[0].getAttribute("readonly")){var m,p=crmCalendar.getDateObjectFromGivenDateString(e.target.value),f=crmTasks.getReminderSummaryData(),v=f.reminderType,h=new Date(p);if((m=new Date).setHours(0,0,0,0),crmTasks.unfreezeReminder(),!crmTasks.isRecurringSet()){var g=!0;if(Utils.compareDate(m,h)&&$("#Crm_Tasks_STATUS option:selected").val()!=crmTasks.compDispVal)crmTasks.unfreezeReminder();else{var T;(T=$("#Crm_Tasks_REMINDAT")).parent().on("mouseenter.duedateinpast",(function(){var e="crm.task.reminder.tooltip1";$("#Crm_Tasks_STATUS option:selected").val()==crmTasks.compDispVal&&(e="crm.task.reminder.tooltip2"),crmui.toolTip_show(this,"left",I18n.getMsg(e))})),T.parent().on("mouseleave.duedateinpast",(function(){crmui.toolTip_hide()})),crmTasks.freezeReminder(),crmTasks.unsetReminder(),g=!1}var C="crm.task.rem.validation1";if(crmTasks.isReminderSet())if("date_based"==v){var b=new Date($("#Crm_Tasks_RemindAt_Start_Date1").data("dateObj"));g=Utils.compareDate(b,h),C="crm.task.rem.validation2"}else{b=null;if("days"==(D=f.remTimeDetail.periodType)){var _=f.remTimeDetail.periodValue;b=new Date(h.getTime()-24*_*3600*1e3)}else if("weeks"==D){_=7*f.remTimeDetail.periodValue;b=new Date(h.getTime()-24*_*3600*1e3)}else if("months"==D){var y=f.remTimeDetail.periodValue;(b=h).setMonth(h.getMonth()-y)}g=Utils.compareDate(m,b),C="crm.task.rem.validation1"}if(g||"edit"!=!window.Tasks.currentStatus){if(!g&&$("#Crm_Tasks_REMINDAT").prop("checked")){$("#Crm_Tasks_REMINDAT").addClass("errorFieldAdded"),$("#Tasks_fldRow_REMINDAT").addClass("errorFieldP");var I='<span class="errMsg errorMsgDesc" style="clear: both; color: rgb(221, 0, 0); font-size: var(--crm-extra-medium-font-size); display: block;">'+I18n.getMsg(C)+"</span>";$("#Tasks_fldRow_REMINDAT > .labelValCreate").append(I)}var E=Utils.getDayDiff(h,m);if(crmTasks.updatePossiblePeriods(E),crmTasks.updateRemPeriodSelect(),"period_based"==v){var D=f.remTimeDetail.periodType,F=f.remTimeDetail.periodValue;$("#Crm_Tasks_remTime").find('option[value="'+F+'"]').prop("selected",!0),$("#Crm_Tasks_remTime_Period").find('option[value="'+D+'"]').prop("selected",!0)}}else crmTasks.unsetReminder();g&&($("#Crm_Tasks_REMINDAT").removeClass("errorFieldAdded"),$("#Tasks_fldRow_REMINDAT").removeClass("errorFieldP"),$("#Tasks_fldRow_REMINDAT > .labelValCreate > .errorMsgDesc").remove())}}}if("Events"!==r||"MEETING_PROVIDER"!==i&&"MEETING_VENUE"!==i||$("#Crm_Events_"+i).attr("onchange","Events.modifyLocationValue()"),28==l&&"RECURRING_FREQUENCY"===i&&window[r].showFrequencyDetails(a,r),26===l){var S=a.val().substring(0,a.val().indexOf(":")),w=$("#Crm_Potentials_PROBABILITY");w.val(S),w.length<1&&$("[id='value_PROBABILITY'],[id='headervalue_PROBABILITY']").text(S);var R=a.find("option:selected"),A=R.attr("data-fctype"),L=R.attr("data-fcCategory");if("crm.tab.module.entity.detail"==Lyte.Router.getRouteInstance().transition.info.route)if(a.hasClass("fromPopup"))"Closed Lost"===A?$("#topBandPopup").find("#closedWon").find("#potnotesdiv").show():$("#topBandPopup").find("#closedWon").find("#potnotesdiv").hide();else if(("Closed Lost"===A||"Closed Won"===A)&&a.hasClass("select2-hidden-accessible")){var N=a.val();if(CScriptLib&&0===$L("#closedWon:visible").length&&0===$L("#multipleFieldsEditPop:visible").length){var k=N.substring(N.indexOf(":")+1);crmTemplate.stageWonLostPromise=!0,CScript.Engine.Global.dispatchIEvent("onBeforeUpdate",a.data("fieldid"),k).then((function(a){a&&(closePotentialFromDV(N),crmTemplate.bluePrintCancel(),Crm.setDependent(e,r,t,!1))}))}else closePotentialFromDV(N),crmTemplate.bluePrintCancel()}setTimeout((function(){var e=$("#Crm_Potentials_FORECASTCATEGORY");if(0===e.length&&(e=$("#Crm_Potentials_FORECAST_CATEGORY")),e.length>0){populatePicklist(e,"",!0);var t=e.data("picklistmap");if(t)for(var a=t.length,r=0;r<a;r++)if(t[r].systemvalue==L){L=t[r].uservalue;break}e.find("option").prop("selected",!1),e.find("option[value='"+L+"']").prop("selected","selected")}}),50)}if(39===l){Crm.updateCurrencyFields(r,a.val(),a.data("oldValue")),a.data("oldValue",a.val());var O=crmTemplate.getElemIdByColname(r,"EXCHANGERATE"),M="";M="edit"==Lyte.Router.getRouteInstance().currentModel.currentStatus&&a.val()==window[r].defaultCurrency?crmTemplate.recordCurrencyER:Crm.userDetails.CURRENCY_DETAILS[a.val()].er,$("#"+O).html(M)}if(42==l&&"RemindAt_period"!=i&&e){var U=$("#Crm_Tasks_Recurring_period");window[r].showPeriodDetails?window[r].showPeriodDetails(t):"Recurring_period"==i&&"custom"==U.find("option:selected").val()?crmTasks.showFrequencyDetails($("#Crm_Tasks_RECURRING")[0]):"Custom_Recurring_period"==i&&crmTemplate.showPeriodDetails(r,$("#Crm_Tasks_Custom_Recurring_period")[0]),"custom"!=U.find("option:selected").val()&&($("#TasksCustomFrequencyDetails").hide(),$("#Crm_Tasks_Custom_Recurring_perioddaily1").hide(),$("#Crm_Tasks_Custom_Recurring_periodweekly1").hide(),$("#Crm_Tasks_Custom_Recurring_periodmonthly1").hide(),$("#Crm_Tasks_Custom_Recurring_periodyearly1").hide(),crmTemplate.hideTaskBusinessHoliday(U.find("option:selected").val()))}else l&&28!=l&&e&&(2==l&&"PriceBooks"==r&&"PRICINGMODEL"==i&&pricingDetails.togglePricingDetails(a.val()),!1===crmTemplate.stageWonLostPromise&&Crm.setDependent(e,r,t,!1));commonUtils.setErrVerifyContHeightToParent(!1,!1,!1)},crmTemplate.bluePrintCancel=function(){setTimeout((function(){$("#saveCancelSpan").find("[id$=cancel]").trigger("click"),$("#closedWon").find("[id$=cancel]").click((function(){if($L("#multipleFieldsEditPop").is(":visible")){var e=$("#multipleFieldsEditPop #Crm_Potentials_STAGE");e.removeAttr("disabled");var t=$("#value_STAGE").eq(0).text()||$("#subvalue_STAGE").eq(0).text();t=t.trim();var a=returnJson.entityMapJson.STAGE.val.filter((function(e){if(e.content===t)return e})),r=t;a.length&&(r=a[0].pbty+":"+t),e.val(r).trigger("change")}}))}),100)},crmTemplate.resetLookupVal=function(e,t){var a=renderingUtils.getTargetElem(e),r=$("#"+a.id.replace("_label_select",""));if($(r).val(""),Crm.moduleInfo[t.value]){var l=Crm.moduleInfo[t.value].singularLabel;$(r).data({lookupModule:t.value,displaylabel:l})}$("#"+r[0].id+"_img");$("#"+r[0].id+"_img").data("lookupModule",t.value)},crmTemplate.modifyCheckBox=function(e,t,a){if(e&&!t){t=renderingUtils.getTargetElem(e);var r=$(r)}else r=$(t);var l,i=r.attr("id"),s=r.prop("checked");if(Crm.isUnsubscribeEnabled){if(!r.is(":checked")&&-1!=i.indexOf("EMAILOPTOUT")&&(l=$(r).eq(0).parent().find("i")).length&&l.hasClass("unsubInfo")){var n=l.attr("data-param"),o=JSON.parse(n);if("Manual"!==o.mode){var d=r.outerWidth(),c=r.offset().top-15,u=r.offset().left;r.prop("checked",!0),$("body").append(Handlebars.templates.OptoutAlertPopup({name:o.recordName,id:i}));var m=$("#unsubscripeEmails"),p=m.outerWidth(),f=renderingUtils.windowWidth-u;renderingUtils.freezeBackground();var v=m.find(".setUpArrowOuter"),h=m.find(".setUpArrowInner");p<f?(v.addClass("setDDPopupLeft").removeClass("setDDPopupRight"),h.addClass("setDDPopupLeftA").removeClass("setDDPopupRigthA"),m.css({top:c,left:u+d+10}).removeClass("dN")):(v.addClass("setDDPopupRight").removeClass("setDDPopupLeft"),h.addClass("setDDPopupRigthA").removeClass("setDDPopupLeftA"),m.css({top:c,left:u-(d+p)}).removeClass("dN"))}}}else if(!r.is(":checked")&&-1!=i.indexOf("EMAILOPTOUT")&&(l=$(r).eq(0).parent().find("#emailOptOutInfo")).length&&l.hasClass("unsubInfo")&&"Consent Form"===l.attr("data-param"))return void $("#"+i).prop("checked",!0);switch(i){case"Crm_Tasks_RECURRING":if(s){crmTemplate.constructRecurringActivity(a,r[0]);var g=$("#TasksrecurringDiv");g.addClass("sliderPop popClose bRadBot3").removeClass("popOpen").removeAttr("width"),g.addClass("pA zi31 popup_shadow").css("width","585px"),crmTasks.openRecurringDiv();thirdPartyUtils.bindSelect2($(".newChosenSel").find("select"),{disable_search_threshold:100})}else crmTemplate.removeRecurringActivity();break;case"Crm_Events_RECURRING":window[a].showRecurringActivity(s,r[0]),thirdPartyUtils.bindSelect2($(".newChosenSel").find("select"));break;case"Crm_Events_ALLDAYEVENT":var T=Crm.calPreferences.DAYSTARTSAT.split(" ")[0].split(":"),C=T[0];if("00"!=T[1]&&(C=C+"."+T[1]),r.prop("checked")){var b;$("#Crm_Events_STARTDATETIME_TimeOption, #Crm_Events_ENDDATETIME_TimeOption").css({visibility:"hidden"}),Events.saveRemindersState(),Events.removeReminders(),Events.retrieveAllDayReminders(),Events.constructMultipleRemindersOptions(Events.eventRemindAtOptions_allday,Crm.calPreferences.ALLDAYEVENTREMINDER),$("#Events_fldRow_REMINDINVITEESAT").hide(),(b=new Date($("#Crm_Events_STARTDATETIME").data("dateObj"))).setHours(0),b.setMinutes(0),b.setSeconds(0),(b=new Date($("#Crm_Events_STARTDATETIME").data("dateObj"))).setHours(23),b.setMinutes(59),b.setSeconds(59)}else{$("#Crm_Events_STARTDATETIME_TimeOption, #Crm_Events_ENDDATETIME_TimeOption").css({visibility:"visible"}),Events.saveAllDayRemindersState(),Events.removeReminders(),Events.retrieveReminders(),$("#Events_fldRow_REMINDINVITEESAT").show(),Events.constructMultipleRemindersOptions(Events.eventRemindAtOptions,Crm.calPreferences.REMINDAT);var _=$("#Crm_Events_STARTDATETIME").data("dateObj");Events.setStartDateAndTime(_),Events.setEndDateAndTime(!0,!1)}Events.checkDuplicateEvent(void 0,!1);break;case"Crm_Events_REMINDAT":crmTemplate.showRemindAt(a,t);break;case"Crm_Tasks_SENDNOTIFICATION":var y=r.prop("checked");$(".tasksNotifyOwnerCheckBox").prop("checked",y)}},crmTemplate.bindEventsToDateField=function(e){var t=$(this),a=t.data("dateObj");a?t.data("dateObj",new Date(a)):t.data("dateObj",new Date),crmTemplate.attachCalendarEvent(this,(function(t){if("Crm_Events_STARTDATETIME"!=t.id&&"Crm_Events_ENDDATETIME"!==t.id||("Crm_Events_ENDDATETIME"===t.id?($(t).data("edited",!0),Events.setEndDateAndTime(!1)):Events.setEndDateAndTime(!0)),$("#"+t.id+"_TimeOption")[0])$(t).data("dateObj");e&&"function"==typeof e&&e()})),t.blur((function(){var e=$(this).data("datepattern")?$(this).data("datepattern"):Crm.userDetails.DATE_PATTERN;if(this.value&&Utils.isValidDate(e,this.value)){var t=crmCalendar.getDateObjectFromGivenDateString(this.value),a=$(this).data("dateObj");a&&(a.setMonth(t.getMonth()),a.setYear(t.getFullYear()),a.setDate(t.getDate()),t=a),$(this).data("dateObj",t)}else if(""===this.value&&("Crm_Events_ENDDATETIME"===this.id||"Crm_Events_STARTDATETIME"===this.id)){var r=Utils.getDateInUserDatePattern($(this).data("dateObj"));$(this).val(r)}var l=$("#"+this.id+"_TimeOption");if(l[0]&&""===l.val()){var i;t=$("#"+this.id).data("dateObj");if(l.hasClass("cVarDateTime"))(i="HH:mm"===Crm.userDetails.TIME_FORMAT?Utils.getTimeStringWithAmPm(t):Utils.convertTo12HoursFormatTimeObj(t))&&l.val(i.hrs+":"+i.mins+" "+I18n.getMsg(i.meridiem.toUpperCase()));else(i=Utils.convertTo12HoursFormatTimeObj(t))&&$(l).val(i.hrs+":"+i.mins+" "+I18n.getMsg(i.meridiem.toUpperCase()))}})),t.click((function(){null==$("#Crm_Events_REPEATTYPE").val()||"none"==$("#Crm_Events_REPEATTYPE").val()||!Events.currentStatus||"create"!=Events.currentStatus&&"clone"!=Events.currentStatus||Events.showRecurringActivity()})),t.keydown((function(e){"Crm_Appointments_APPOINTMENTDATEANDTIME"!=this.id&&"Crm_Appointments_RESCHEDULEDTO"!=this.id||crmTemplate.setDatevalue(this)})),t.keyup((function(e){"Crm_Appointments_APPOINTMENTDATEANDTIME"!=this.id&&"Crm_Appointments_RESCHEDULEDTO"!=this.id||crmTemplate.setDatevalue(this)})),t.change((function(){"Crm_Appointments_APPOINTMENTDATEANDTIME"!=this.id&&"Crm_Appointments_RESCHEDULEDTO"!=this.id||crmTemplate.setDatevalue(this)}))},crmTemplate.setDatevalue=function(e){var t=$(e).data("datepattern")?$(e).data("datepattern"):Crm.userDetails.DATE_PATTERN;if(Utils.isValidDate(t,e.value)){var a=crmCalendar.getDateObjectFromGivenDateString(e.value),r=$(e).data("dateObj");r&&(r.setDate(a.getDate()),r.setMonth(a.getMonth()),r.setYear(a.getFullYear()),a=r),$(e).data("dateObj",a),Lyte.registeredMixins["crm-appointments-mixin"].checkServiceAvailability(e)}},crmTemplate.execSaveAction=function(e,t,a,r){var l;if("Campaigns"===a&&"true"===$("input[name=zohoSurveyCampaign]").val()&&ZSurvey.saveCreateViewDataChanges(),r===t[0]){"Consents"===a&&DataPrivacy.setDurationValues(),l=function(){Crm.saveEntity(e,a,(function(e,t){!e.hasOwnProperty("affected_formula_fields")||"Tasks"!==a&&"Services"!==a||(detailView.affectedData=e.affected_formula_fields),t&&$("#show").html(e),Crm.trackSpotLightAction("MPL - Record Edited",{Module:a})}))}}else r==t[1]||r==t[2]?l=function(){Crm.saveAndNewEntity(e,a)}:r==t[3]?l=function(){checkForGTaskList(this.currentStatus,a,e)}:r===t[4]&&(l=function(){Crm.saveEntity(e,a,(function(e,t){t&&$("#show").html(e)}),void 0,void 0,void 0,void 0,void 0,!0)});if(l)if(Crm.userDetails.CLIENT_PORTAL_TEMPLATE_CUSTOMIZATION&&crmCommonModule&&crmCommonModule.createEditJson&&crmCommonModule.createEditJson.userTypeId){var i=$("#Crm_"+a+"_EMAIL"),s=function(){var e=(i=$("#Crm_"+a+"_EMAIL")).data();i.val(e.oldValue)};if(""===i.val().trim())return crmui.showMsgBand("error",I18n.getMsg("custmr.prtl.email.field.emt"),3e3),void s();if(i&&i.data().oldValue!==i.val().trim()){var n=Lyte.Component.render("lyte-alert",{id:"portalEmailConfirmAlert","lt-prop-show-close-button":"false","lt-prop-wrapper-class":"portalEmailConfirmAlert","lt-prop-top":"0px","lt-prop-type":"confirm","lt-prop-heading":I18n.getMsg("custmr.prtl.email.access.update.heading"),"lt-prop-secondary-message":I18n.getMsg("custmr.prtl.email.access.update.confirm"),"lt-prop-primary-message":I18n.getMsg("custmr.prtl.email.access.update.content"),"lt-prop-button-position":"right"},"#show");n.ltProp("buttons",[{type:"reject",text:I18n.getMsg("crm.button.cancel"),appearance:"default"},{type:"accept",text:I18n.getMsg("custmr.prtl.yes.proceed"),appearance:"primary"}]),n.setMethods({onAccept:l,onReject:s}),n.ltProp("show",!0)}else l()}else l()},crmTemplate.handleButtonClick=function(e,t,a=!1){setTimeout((function(){commonUtils.setErrVerifyContHeightToParent(!1,!1,!1)}));var r=["save","saveAndNew","saveAndTask","saveAndExportToGoogleTask","saveAndAddToProjectsTask"];!t&&e&&(t=renderingUtils.getTargetElem(e));var l=$(t).data("module"),i=t.name;if("saveAndNew"!==i&&"cancel"!==i||!Crm.layoutReqFrom||(Crm.layoutReqFrom=void 0),["saveAndNew","saveAndTask","saveAndExportToGoogleTask"].includes(i)&&Crm.userDetails.isStorageLimitReached)Crm.showStorageExceedPopup();else{var s=$("#cNsubformFileAttachDrop");if(s.length>0&&s.remove(),r.includes(i)){var n=Lyte.Router.getRouteInstance()&&"edit"===Lyte.Router.getRouteInstance().routeName&&2===this.isApproved&&"save"===i;if(CScriptLib&&!a||n){if(n){if(!Crm.validateEntityAndShowErrorMsg(Crm.fieldsObj[l],l,!0,void 0,!1,crmTemplate.record_modification))return;return $(e.target).prop("disabled",!0).siblings("input[type=button]").prop("disabled",!0),Lyte.registeredMixins.approvalprocess.saveRecordWithApprovalResponse(crmTemplate.approval_buttons,void 0,"editFromTasks"),null}crmTemplate.onSave().then((function(t){!0===t&&(renderingUtils.hideFreezeLayer(),crmTemplate.execSaveAction(e,r,l,i))}))}else crmTemplate.execSaveAction(e,r,l,i)}else{if("cancel"===i){fileupload.removedAttachmentIds.length=0,fileupload.uploadedFileObject.length=0,fileupload.subformRemovedAttachmentIds.length=0,fileupload.subformRemovedAttachmentFieldIds.length=0,fileupload.subformRemovedAttachmentRowNumber.length=0;var o=$("#newRelatedListPopUpDiv");if("Tasks"===l&&o)return o.empty(),crmui.hidePopup("newRelatedListPopUpDiv"),renderingUtils.hideFreezeLayer(),null;customViewObject.selectedIds=[]}if(0===i.indexOf("CB_")){var d=$(t).data("params").status,c=$(t).data("params").entityId;"edit"==d?CustomButtonJSObjectInit.execute(i.split("CB_")[1],"cbeditInv",c):CustomButtonJSObjectInit.execute(i.split("CB_")[1])}}"undefined"!=typeof crmLookupBusinessCard&&(crmLookupBusinessCard.result=null),void 0!==l&&"Quotes"===l&&Crm.isCpqActivated()&&void 0!==i&&("save"===i?Crm.client_tracking("CPQ-Quotes-Save button in create/edit page"):"saveAndNew"===i?Crm.client_tracking("CPQ-Quotes-Save and New button in create/edit page"):"cancel"===i&&Crm.client_tracking("CPQ-Quotes-Cancel button in create/edit page"))}},crmTemplate.bindEventsToTimeField=function(e){var t=this,a=!1;"HH:mm"===Crm.userDetails.TIME_FORMAT&&(a=!0);var r=t.getAttribute("id");if("Crm_Events_ENDDATETIME_TimeOption"==r)$("#Crm_Events_ENDDATETIME_TimeOption_List").remove(),$(t).timeEntry({ampmNames:[I18n.getMsg("AM"),I18n.getMsg("PM")],ampmPrefix:" ",timeSteps:[1,1,0],useMouseWheel:!1,spinnerImage:null,show24Hours:a}).keyup($L.debounce((function(){Events.setEndDateAndTime(!1,!0),$("#Crm_Events_ENDDATETIME_TimeOption_List").remove()}),1e3)),$(t).click((function(e){if(hideMenu(e),$("#eventRecurringDiv").is(":visible")||void 0===$("#Crm_Events_REPEATTYPE").val()||"none"===$("#Crm_Events_REPEATTYPE").val()||!Events.currentStatus||"create"!==Events.currentStatus&&"clone"!==Events.currentStatus){if(!$("#Crm_Events_ENDDATETIME_TimeOption_List").length){var t=this,a=new Date($("#Crm_Events_STARTDATETIME").data("dateObj")),r=Utils.getTimeArrayWithGivenInterval(!1,30,a,"timeDiff");r=r.splice(1,6);var l=renderingUtils.constructList(r,void 0,(function(e){var a=parseInt($(e.firstChild).attr("diff")),r=$("#Crm_Events_STARTDATETIME").data("dateObj"),l=new Date(r.valueOf()+60*a*1e3);$("#Crm_Events_ENDDATETIME").data("dateObj",l).data("edited",!0);var i=!1;"HH:mm"===Crm.userDetails.TIME_FORMAT&&(i=!0);var s=$("#Crm_Events_ENDDATETIME_TimeOption");if(i)s.val(Utils.formatTimeVal(l.getHours())+":"+Utils.formatTimeVal(l.getMinutes()));else{var n=Utils.convertTo12HoursFormatTimeObj(l);s.val(n.hrs+":"+n.mins+" "+I18n.getMsg(n.meridiem.toUpperCase()))}Events.setEndDateAndTime(!1,!1,l),$("#Crm_Events_ENDDATETIME").data("edited",!0),$("#Crm_Events_ENDDATETIME_TimeOption_List").remove(),$(t).trigger("create_edit_clone_DomChange")}));$(l).attr({id:this.id+"_List",class:"selectField-time-List eventActionsMenu",onclick:"sE(event)"}),$(t).after(l);var i=$("#Crm_Events_ENDDATETIME_TimeOption").position();$(l).css({left:i.left+10+"px",top:"41px"}).show()}}else Events.showRecurringActivity();return!1}));else if("Crm_Events_STARTDATETIME_TimeOption"==r)$("#Crm_Events_STARTDATETIME_TimeOption_List").remove(),Events.currentStatus&&$(t).click((function(e){if(hideMenu(e),"create"!=Events.currentStatus&&"clone"!=Events.currentStatus||null==$("#Crm_Events_REPEATTYPE").val()||"none"==$("#Crm_Events_REPEATTYPE").val()){if(!$("#Crm_Events_STARTDATETIME_TimeOption_List").length){var t,a=this,r=new Date($("#Crm_Events_STARTDATETIME").data("dateObj")),l="HH:mm"===Crm.userDetails.TIME_FORMAT;if(l)var i=Utils.getTimeStringWithAmPm(r);else i=Utils.convertTo12HoursFormatTimeObj(r);if(i.mins<30?i.mins=0:i.mins="30","Online"===$("#Crm_Events_MEETING_VENUE").val())var s=Utils.getTimeArrayWithGivenInterval(!0,30,void 0,"meridiem");else s=Utils.getTimeArrayWithGivenInterval(!1,30,void 0,"meridiem");$("#Crm_Events_STARTDATETIME_TimeOption").val();var n=renderingUtils.constructList(s,(function(e){var a=e.children().eq(0).attr("hrs"),r=e.children().eq(0).attr("mins"),l=e.children().eq(0).attr("meridiem");parseInt(i.hrs,10)!==parseInt(a,10)||parseInt(i.mins,10)!==parseInt(r,10)||""!==l&&i.meridiem.toLowerCase()!==l.toLowerCase()||(e.addClass("li_on"),t=e)}),(function(e){var t=$(e.firstChild),r=t.attr("hrs"),i=t.attr("mins"),s=t.attr("meridiem");l||(r=Utils.convertTimeTo24HoursFormat(parseInt(r,10),s));var n=$("#Crm_Events_STARTDATETIME").data("dateObj");n.setHours(r),n.setMinutes(i),Events.setStartDateAndTime(n),Events.setEndDateAndTime(!0,!1,n),$(a).trigger("create_edit_clone_DomChange"),renderingUtils.removeDummyBackground(!0),$("#Crm_Events_STARTDATETIME_TimeOption_List").remove()}));$(n).attr({id:this.id+"_List",class:"selectField-time-List eventActionsMenu",onclick:"sE(event)"}),$(n.firstChild).css({height:"200px"}),$(document.body).append(n);var o=$("#Crm_Events_STARTDATETIME_TimeOption").offset(),d=$("#Crm_Events_STARTDATETIME_TimeOption").outerHeight();$(n).css({position:"absolute",left:o.left+"px",top:o.top+d+"px","z-index":350}).show(),n.firstChild.id="Crm_Events_STARTDATETIME_SCROLLDIV"}t&&t[0]?thirdPartyUtils.bindPerfectScroll("#Crm_Events_STARTDATETIME_SCROLLDIV",{start:t[0]}):thirdPartyUtils.bindPerfectScroll("#Crm_Events_STARTDATETIME_SCROLLDIV")}else Events.showRecurringActivity();return!1})),$(t).timeEntry({ampmNames:[I18n.getMsg("AM"),I18n.getMsg("PM")],ampmPrefix:" ",timeSteps:[1,1,0],spinnerImage:null,useMouseWheel:!1,show24Hours:a}).keyup($L.debounce((function(){renderingUtils.removeDummyBackground(!0);var e=Events.setStartDateAndTime();Events.setEndDateAndTime(!0,void 0,e,void 0),$("#Crm_Events_STARTDATETIME_TimeOption_List").remove()}),1e3));else if("Crm_Calls_CALLSTARTDATETIME_TimeOption"==r&&isNewCallView){if($("#"+r+"_List").remove(),!t.value){var l="HH:mm"===Crm.userDetails.TIME_FORMAT;if(s=$("#"+this.id.substr(0,this.id.indexOf("_TimeOption"))).data("dateObj"))if(l)var i=Utils.getTimeStringWithAmPm(s);else i=Utils.convertTo12HoursFormatTimeObj(s);else t.value="";i&&(t.value=i.hrs+":"+i.mins+" "+I18n.getMsg(i.meridiem.toUpperCase()))}$(t).timeEntry({ampmNames:[I18n.getMsg("AM"),I18n.getMsg("PM")],ampmPrefix:" ",timeSteps:[1,1,0],spinnerImage:null,useMouseWheel:!1,show24Hours:a}),$(t).click((function(){var t=$(this),r=this.id,l=$(this).siblings("#"+crmCallsNew.fields.Call_StartDate);$("#"+r+"_List").remove();var i=new Date(l.data("dateObj")),s="HH:mm"===Crm.userDetails.TIME_FORMAT;if(s)var n=Utils.getTimeStringWithAmPm(i);else n=Utils.convertTo12HoursFormatTimeObj(i);n.mins<30?n.mins=0:n.mins=30,Crm.menu.menusInDisplay[r+"_List"]=!0;var o;new CrmDate,l.val().replace(/^\s+/g,"").replace(/\s+$/g,"");crmCallsNew.getCallStartCrmDate().isToday()&&(o=$("#createEditCallPopup #"+crmCallsNew.fields.Call_StartDate).length>0?l.data("timeLimit"):"past");var d,c=Utils.getTimeArrayWithGivenIntervalNew(30,o),u=l.data("bestTimeInfo")?l.data("bestTimeInfo"):{},m=($(this).val(),null),p=!Crm.userDetails.isBTPermissionMigrationRun||Crm.userDetails.permissions.Crm_Implied_View_Result_BestTime;p&&Object.keys(u).length>0&&(m=$("<div>",{class:"bestTimeListFilter cP",style:"display:block",onclick:"crmCallsNew.filterBestTimeClicked(this);sE(event);crmui.hideTooltip();",onmouseover:"crmCallsNew.filterBestTimeHovered(this)",onmouseout:"crmui.hideTooltip()","data-hovermessage":I18n.getMsg("crm.best.time.tooltip.show.best.time"),html:I18n.getMsg("crm.best.time.column.label")}));var f=renderingUtils.constructList(c,(function(e){var t=e.children().eq(0).attr("hrs"),a=e.children().eq(0).attr("mins"),r=e.children().eq(0).attr("meridiem"),l=e.children().eq(0).text();(parseInt(n.hrs,10)!==parseInt(t,10)||parseInt(n.mins,10)!==parseInt(a,10)||""!==r&&n.meridiem.toLowerCase()!==r.toLowerCase()||(e.addClass("li_on"),d=e),p)&&(-1!==Object.keys(u).indexOf(l)&&e.addClass("bestTime "+u[l]))}),(function(i){var n=$(i.firstChild),o=n.attr("hrs"),d=n.attr("mins"),c=n.attr("meridiem");n.text();s||(o=Utils.convertTimeTo24HoursFormat(parseInt(o,10),c));var u=l.data("dateObj");if((u=u||new Date).setHours(o),u.setMinutes(d),a)t.timeEntry({ampmNames:[I18n.getMsg("AM"),I18n.getMsg("PM")],ampmPrefix:" ",timeSteps:[1,1,0],spinnerImage:null,useMouseWheel:!1,show24Hours:"HH:mm"===Crm.userDetails.TIME_FORMAT}),t.val(Utils.formatTimeVal(u.getHours())+":"+Utils.formatTimeVal(u.getMinutes()));else{t.timeEntry({ampmNames:[I18n.getMsg("AM"),I18n.getMsg("PM")],ampmPrefix:" ",timeSteps:[1,1,0],spinnerImage:null,useMouseWheel:!1,show24Hours:"HH:mm"===Crm.userDetails.TIME_FORMAT});var m=Utils.convertTo12HoursFormatTimeObj(u);t.val(m.hrs+":"+m.mins+" "+I18n.getMsg(m.meridiem.toUpperCase()))}if(renderingUtils.triggerEvent("change",t),""===l.val()){var p=l.data("datepattern");l.val(crmCalendar.convertToUserDatePattern(u.getDate()+" "+u.getMonth()+" "+u.getFullYear(),p))}$("#"+r+"_List").remove(),t.trigger("create_edit_clone_DomChange"),renderingUtils.removeDummyBackground(!0),e&&e()})),v=$(f).find("ul");$(f).attr({id:this.id+"_List",class:"selectField-time-List eventActionsMenu",onclick:"sE(event)"}),m?(v.before(m),v.addClass("schCallBestTimeOption"),v.css({"max-height":"200px",width:"180px","padding-top":"30px"})):v.css({"max-height":"200px",width:"180px"}),$(document.body).append(f);var h=$(this).offset(),g=$(this).outerHeight();$(f).css({position:"absolute",left:h.left+"px",top:h.top+g+"px","z-index":1e3,"padding-top":"0px"}).show();var T=this.id+"_SCROLLDIV";return v.attr("id",T),d&&d[0]?thirdPartyUtils.bindPerfectScroll("#"+this.id+"_SCROLLDIV",{start:d[0]}):thirdPartyUtils.bindPerfectScroll("#"+this.id+"_SCROLLDIV"),!1})),$(t).change((function(){renderingUtils.removeDummyBackground(!0),$("#"+this.id+"_TimeOption_List").remove();var t=$("#"+this.id.substr(0,this.id.indexOf("_TimeOption")));dtObj=new Date(t.data("dateObj"));var r=trimBoth($("#"+this.id).val().split(" ")[0]),l=$("#"+this.id).timeEntry("getTime");if(l){var i=Utils.getMeridiem(l).toUpperCase();a?dtObj.setHours(parseInt(r.split(":")[0],10)):dtObj.setHours(Utils.convertTimeTo24HoursFormat(parseInt(r.split(":")[0],10),i)),dtObj.setMinutes(parseInt(r.split(":")[1],10))}if(""===t.val()){var s=t.data("datepattern");t.val(crmCalendar.convertToUserDatePattern(dtObj.getDate()+" "+dtObj.getMonth()+" "+dtObj.getFullYear(),s))}t.data("dateObj",dtObj),$(this).data("dateObj",dtObj),e&&e()}))}else{if($("#"+r+"_List").remove(),!t.value){var s;l="HH:mm"===Crm.userDetails.TIME_FORMAT;if(s=$("#"+this.id.substr(0,this.id.indexOf("_TimeOption"))).data("dateObj"))if(l)i=Utils.getTimeStringWithAmPm(s);else i=Utils.convertTo12HoursFormatTimeObj(s);else t.value="";i&&(t.value=i.hrs+":"+i.mins+" "+I18n.getMsg(i.meridiem.toUpperCase()))}$(t).timeEntry({ampmNames:[I18n.getMsg("AM"),I18n.getMsg("PM")],ampmPrefix:" ",timeSteps:[1,1,0],spinnerImage:null,useMouseWheel:!1,show24Hours:a}).change((function(){renderingUtils.removeDummyBackground(!0),$("#"+this.id+"_TimeOption_List").remove();var t=$("#"+this.id.substr(0,this.id.indexOf("_TimeOption")));dtObj=t.data("dateObj")?new Date(t.data("dateObj")):new Date;var r=trimBoth($("#"+this.id).val().split(" ")[0]),l=$("#"+this.id).timeEntry("getTime");if(l){var i=Utils.getMeridiem(l).toUpperCase(),s=""===r.split(":")[0]?"12":r.split(":")[0],n=""===r.split(":")[1]?"00":r.split(":")[1];a?dtObj.setHours(parseInt(s,10)):dtObj.setHours(Utils.convertTimeTo24HoursFormat(parseInt(s,10),i)),dtObj.setMinutes(parseInt(n,10))}if(""===t.val()){var o=t.data("datepattern");t.val(crmCalendar.convertToUserDatePattern(dtObj.getDate()+" "+dtObj.getMonth()+" "+dtObj.getFullYear(),o))}t.data("dateObj",dtObj),$(this).data("dateObj",dtObj),"Crm_Appointments_APPOINTMENTDATEANDTIME_TimeOption"!=this.id&&"Crm_Appointments_RESCHEDULEDTO_TimeOption"!=this.id||Lyte.registeredMixins["crm-appointments-mixin"].checkServiceAvailability(t),e&&e()})).click((function(){var t=$(this),r=t.offset(),l=t.outerHeight(),i=r.left,s=r.top+l,n=$(".eventActionsMenu");if(t.closest(".newInputStyleEle").length){var o=t.parent();s=(r=o.offset()).top+o.outerHeight()}var d=this.id,c=$("#"+d.substr(0,d.indexOf("_TimeOption")));$("#"+d+"_List").remove();var u=c.data("dateObj")?new Date(c.data("dateObj")):new Date,m="HH:mm"===Crm.userDetails.TIME_FORMAT;if(m)var p=Utils.getTimeStringWithAmPm(u);else p=Utils.convertTo12HoursFormatTimeObj(u);p.mins<30?p.mins=0:p.mins="30",Crm.menu.menusInDisplay[d+"_List"]=!0;var f,v=Utils.getTimeArrayWithGivenInterval(!1,30,void 0,"meridiem"),h=($(this).val(),renderingUtils.constructList(v,(function(e){var t=e.children().eq(0).attr("hrs"),a=e.children().eq(0).attr("mins"),r=e.children().eq(0).attr("meridiem");parseInt(p.hrs,10)!==parseInt(t,10)||parseInt(p.mins,10)!==parseInt(a,10)||""!==r&&p.meridiem.toLowerCase()!==r.toLowerCase()||(e.addClass("li_on"),f=e)}),(function(t){var r=$(t.firstChild),l=r.attr("hrs"),i=r.attr("mins"),s=r.attr("meridiem"),n=$("#"+d.substr(0,d.indexOf("_TimeOption")));m||(l=Utils.convertTimeTo24HoursFormat(parseInt(l,10),s));var o=$(n).data("dateObj");(o=o||new Date).setHours(l),o.setMinutes(i);var c=$("#"+d);if(a)c.val(Utils.formatTimeVal(o.getHours())+":"+Utils.formatTimeVal(o.getMinutes()));else{var u=Utils.convertTo12HoursFormatTimeObj(o);c.val(u.hrs+":"+u.mins+" "+I18n.getMsg(u.meridiem.toUpperCase()))}if(renderingUtils.triggerEvent("change",c),""===n.val()){var p=n.data("datepattern");n.val(crmCalendar.convertToUserDatePattern(o.getDate()+" "+o.getMonth()+" "+o.getFullYear(),p))}$("#"+d+"_List").remove(),c.trigger("create_edit_clone_DomChange"),renderingUtils.removeDummyBackground(!0),e&&e()}))),g=this.id;return $(h).attr({id:g+"_List",class:"selectField-time-List eventActionsMenu",onclick:"sE(event)"}),$(h.firstChild).css({height:"200px"}),"Crm_Appointments_APPOINTMENTDATEANDTIME_TimeOption"==g||"Crm_Appointments_RESCHEDULEDTO_TimeOption"==g||"timechange1_0"==g||"timechange2_0"==g||"timechange1_1"==g||"timechange2_1"==g?$("#show").append(h):$(document.body).append(h),n.hide(),void 0!==d&&(d.startsWith("Crm_Users_USERCF")||d.startsWith("Crm_Calls_CALLSTARTDATETIME"))?$(h).css({position:"absolute",left:i+"px",top:s+"px","z-index":1e3}).show():$(h).css({position:"absolute",left:i+"px",top:s+"px","z-index":350}).show(),h.firstChild.id=this.id+"_SCROLLDIV",f&&f[0]?thirdPartyUtils.bindPerfectScroll("#"+this.id+"_SCROLLDIV",{start:f[0]}):thirdPartyUtils.bindPerfectScroll("#"+this.id+"_SCROLLDIV"),!1}))}!$("#CFSchedulerTable").length>1&&$(t).blur((function(e){if(this&&""===this.value){var r=$(this).data("dateObj");if(r||(r=new Date),a)$(t).val(Utils.formatTimeVal(r.getHours())+":"+Utils.formatTimeVal(r.getMinutes()));else{var l=Utils.convertTo12HoursFormatTimeObj(r);$(t).val(l.hrs+":"+l.mins+" "+I18n.getMsg(l.meridiem.toUpperCase()))}var i=$("#"+this.id.replace("_TimeOption",""));if(""===i.val()){var s=i.data("datepattern");i.val(crmCalendar.convertToUserDatePattern(r.getDate()+" "+r.getMonth()+" "+r.getFullYear(),s))}var n=this.id+"_List";Crm.menu.hideMenu(e,n)}if(e&&e.relatedTarget){n=this.id+"_List";Crm.menu.hideMenu(e,n)}})),t=null},crmTemplate.createvarFieldRow=function(e){var t=$(Handlebars.templates.crmFormFields(e));return t.find("[data-fieldType='dateField']").each(crmTemplate.bindEventsToDateField),t.find("[data-fieldType='timeField']").each(crmTemplate.bindEventsToTimeField),t.find("span[id^='currencySymbol']").text(currencyForVariables(Crm.userDetails.BASE_CURRENCY)),t.find("select").each((function(){thirdPartyUtils.bindSelect2(this)})),t},crmTemplate.isIntegLayout=function(e){if(e&&e.layout_jsonarrayObj&&e.layout_jsonarrayObj.layout_jsonarrayObj){var t=e.layout_jsonarrayObj.layout_jsonarrayObj,a=e.layout_jsonarrayObj.currLayoutId,r=t.filter((function(e){return e.LAYOUTID===a}));return r&&r.length>0&&"12"===r[0].SOURCE}},crmTemplate.handleSenderAddressErrorForZohoCampaigns=function(e){var t,a,r;e.Campaigns?(t=e.Campaigns.section,a=["FL","sysRefName","picklistmap"]):(t=e.sections,a=["fields","api_name","pick_list_values"],r=!0);var l=t.filter((function(e){return"Native__Campaigns__Extn__Zoho_Campaign_Details"===e.name}));if(l&&l.length>0){var i=l[0][a[0]].filter((function(e){return"Native__Campaigns__Extn__Sender_Address"===e[a[1]]}));(i[0][a[2]].length<=1||e.id&&r&&i[0][e.id]&&i[0][e.id][a[2]].length<=1)&&$L("#zCampAlert")[0].ltProp({show:!0})}},crmTemplate.integChangeLayout=function(e,t,a,r){var l=document.getElementById("layoutDetails").querySelector("[value='"+arguments[1]+"']");if(l&&l.getAttribute("isWizard")){renderingUtils.freezeBackground();var i=this;if(crmTemplate.isAnyChangeInForm("createEntityNewForm",e)){var s="stayonPageConfirmBox",n=$("#"+s);mailsetCenter(s),n.find(".leavePage").off("click").click(function(){commonUtils.showHideLoadingDiv(!0),n.hide(),Lyte.Router.getRouteInstance().refresh({refreshTemplate:!0}).data={isWizard:!0,selectedLayoutid:t}}.bind(i)),n.find(".stayPage").off("click").click(function(){var e=$("#defLayoutId").val(),t=$("#layoutDetails");t.find("option[value='"+e+"']").length>0&&t.add("#layoutDetails_f").val(e).change();var a=$("#zCampIntegLayout");if(a.length>0){var r="zCampIntegLayoutOffline";a.find("option[value='"+e+"']").length>0&&(r=e),a.add("#zCampIntegLayout_f").val(r).change()}n.hide(),renderingUtils.removeFreezeLayer()}.bind(i)),n.focus()}else commonUtils.showHideLoadingDiv(!0),Lyte.Router.getRouteInstance().refresh({refreshTemplate:!0}).data={isWizard:!0,selectedLayoutid:t}}else if("zCampIntegLayoutOffline"!=t){if("true"===window.isSandboxAcc){var o=getElemById("zCampIntegLayout");return o&&(o.selectedIndex=0,getElemById("select2-zCampIntegLayout-container").innerText=I18n.getMsg("crm.chat.offline")),void crmui.showMsgBand("error",I18n.getMsg("crm.campaign.integ.sandbox.not.supported",crmTab.getDisplayName("Campaigns",!1).toLowerCase()),3e3)}$(".changeDefLayout").addClass("hide"),crmListView.trackCampaignCreatePage("Campaign_createPage",$("#zCampIntegLayout option:selected").text()),crmTemplate.changeLayout(e,t,a,r)}else{$(".changeDefLayout").removeClass("hide");var d=$("#zCampIntegLayout"),c=$("#zCampIntegLayout_f");"zCampIntegLayoutOffline"!==d.val()&&d.val(t).change(),c.length>0&&"zCampIntegLayoutOffline"!==c.val()&&c.val(t).change();var u=$("#layoutDetails");crmTemplate.changeLayout(e,u.val(),a,r)}},crmTemplate.adddropDownClass=function(){$("#select2-layoutDetails-results").addClass("crm-default-Layoutresults")},crmTemplate.changeLayout=function(e,t,a,r){var l=document.getElementById("layoutDetails").querySelector("[value='"+arguments[1]+"']");if(!l||!l.getAttribute("isWizard")||a&&"clientPortal"===a)if(a&&"clientPortal"===a)if(l&&l.getAttribute("isWizard")){document.getElementById("preHTMLContainer_"+e).innerHTML='<div class="wiz_loading" style="display: block"><div class="wiz_alignCenter"><span class="wiz_loading_gif"></span></div></div>',crmCommonModule.renderWizardPreview(e,t.split(";")[0],t.split(";")[1],r),renderingUtils.removeFreezeLayer()}else crmTemplate.changeLayoutReq(e,t,a,r);else{var i=Lyte.Router.getRouteInstance().transition.data;if(i.layoutId=t,delete i.isRefresh,delete i.isWizard,delete i.selectedLayoutid,renderingUtils.freezeBackground(),crmTemplate.isAnyChangeInForm("createEntityNewForm",e)){o="stayonPageConfirmBox",d=$("#"+o);mailsetCenter(o),d.find(".leavePage").off("click").click((function(){if(commonUtils.showHideLoadingDiv(!0),$("#"+o).hide(),"generate-po"==Lyte.Router.getRouteInstance().routeName){var e=crmCommonModule.createEditJson.idlist;e+=":"+crmCommonModule.createEditJson.selectVendors,e+=":"+crmCommonModule.createEditJson.productLineItems["Vendor Name"],createPOTemplate(e,t),renderingUtils.removeFreezeLayer()}else Lyte.Router.getRouteInstance().setQueryParams({layoutId:t}).data=i})),d.find(".stayPage").off("click").click((function(){var e=$("#defLayoutId").val(),t=$("#layoutDetails");t.find("option[value='"+e+"']").length>0&&t.add("#layoutDetails_f").val(e).change();var a=$("#zCampIntegLayout");if(a.length>0){var r="zCampIntegLayoutOffline";a.find("option[value='"+e+"']").length>0&&(r=e),a.add("#zCampIntegLayout_f").val(r).change()}$("#"+o).hide(),renderingUtils.removeFreezeLayer()})),d.focus()}else commonUtils.showHideLoadingDiv(!0),Lyte.Router.getRouteInstance().setQueryParams({layoutId:t}).data=i}else{renderingUtils.freezeBackground();var s=Lyte.Router.getRouteInstance().transition.data;if(s.isWizard=!0,s.selectedLayoutid=t,s.refreshPage=!1,s.isRefresh=!0,delete s.layoutId,crmTemplate.isAnyChangeInForm("createEntityNewForm",e)){var n=this,o="stayonPageConfirmBox",d=$("#"+o);mailsetCenter(o),d.find(".leavePage").off("click").click(function(){commonUtils.showHideLoadingDiv(!0),d.hide(),Lyte.Router.getRouteInstance().setQueryParams({layoutId:t.split(";")[0],wizardId:t.split(";")[1]}).data=s}.bind(n)),d.find(".stayPage").off("click").click(function(){commonUtils.showHideLoadingDiv(!1);var e=$("#defLayoutId").val(),t=$("#layoutDetails");t.find("option[value='"+e+"']").length>0&&t.add("#layoutDetails_f").val(e).change();var a=$("#zCampIntegLayout");if(a.length>0){var r="zCampIntegLayoutOffline";a.find("option[value='"+e+"']").length>0&&(r=e),a.add("#zCampIntegLayout_f").val(r).change()}d.hide(),renderingUtils.removeFreezeLayer()}.bind(n)),d.focus()}else commonUtils.showHideLoadingDiv(!0),Lyte.Router.getRouteInstance().setQueryParams({layoutId:t.split(";")[0],wizardId:t.split(";")[1]}).data=s}},crmTemplate.changeLayoutReq=function(e,t,a,r){var l,i,s=Crm.getModuleObj(e),n=Crm.getCrmBasePath()+"/Create.do",o=$("#fillUpFieldId").val(),d=$("#fillUpModule").val(),c=$("#listRelationId").val(),u=$("#entityid").val(),m=$("#relmodule").val(),p=$("#fillUpEntityname").val();if(i=d?{module:e,format:"json",layoutId:t,fillUpModule:d,fillUpFieldId:o,listRelationId:c,entityid:u,relmodule:m,entityname:p}:null!=a&&null!=a&&""!=a&&"clientPortal"===a?{module:e,format:"json",layoutId:t,profileId:r}:{module:e,format:"json",layoutId:t},window.location.pathname===Crm.getCrmBasePath()+"/GeneratingPO.do"){n=Crm.getCrmBasePath()+"/CreatePOForProducts.do";i={module:e,layoutId:t,selectVendors:$("#selectVendors").val(),idlist:$("#idlist").val()},l=$("#Crm_PurchaseOrders_VENDORID")?$("#Crm_PurchaseOrders_VENDORID").val():""}var f=new crmRequestPool;return f.followOrder=!0,f.initiate({action:n,type:"GET",data:i,dataType:"json",success:function(t){if(t&&"crm.campaign.integ.sandbox.not.supported"===t.error){$(".changeDefLayout").removeClass("hide");var r=getElemById("zCampIntegLayout");return r&&(r.selectedIndex=0,getElemById("select2-zCampIntegLayout-container").innerText=I18n.getMsg("crm.chat.offline")),commonUtils.showHideLoadingDiv(!1),renderingUtils.removeFreezeLayer(),void crmui.showMsgBand("error",I18n.getMsg("crm.campaign.integ.sandbox.not.supported",crmTab.getDisplayName("Campaigns",!1).toLowerCase()),3e3)}if(t.webinar_trial_expired){var i=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("zohowebinar")],ResourceConstants.CRM),o=networkUtils.returnDependencyFiles(["crm-webinar-common.js","crm-webinar-data-store.js"],ResourceConstants.CRMClient),d=networkUtils.returnDependencyFiles(["crm-webinar-common.css"],ResourceConstants.CRMClient);return Lyte.injectResources(i.concat(o.concat(d)),void 0,(function(){Lyte.Component.render("crm-webinar-trial-expiry-modal",t,"#show")})),void commonUtils.showHideLoadingDiv(!1)}if(t.productLineItems&&(window[e].currentStatus="create"),null!=a&&null!=a&&""!=a&&"clientPortal"===a?s.createTemplate(t,void 0,"layoutPreview"):s.createTemplate(t),crmTemplate.isIntegLayout(t)&&crmTemplate.handleSenderAddressErrorForZohoCampaigns(t),t.productLineItems)if(n===Crm.getCrmBasePath()+"/CreatePOForProducts.do"){if(Crm.userDetails.isLookupAdvancedSearchEnabledInLineItem)(c=t.productLineItems).fieldMeta=t.entityMapJson.PRODUCTDETAILS,productDetails.setValuesForAddedRowForEdit(c,!0);else productDetails.setValuesForAddedRowForEdit(t.productLineItems,!0);$("#Crm_PurchaseOrders_VENDORID").val(l),$("#Crm_PurchaseOrders_VENDORID").data("id",$("#selectVendors").val())}else if(Crm.userDetails.isLookupAdvancedSearchEnabledInLineItem){var c;(c=t.productLineItems).fieldMeta=t.entityMapJson.PRODUCTDETAILS,productDetails.setValuesForAddedRowForEdit(c)}else productDetails.setValuesForAddedRowForEdit(t.productLineItems);if(productDetails.grandTaxChanged=!0,$("#productList").find(".pB20").show(),$("#productList").find(".pB20").find(".wrap").show(),$("#addLinesBtnLwr").hide(),loadClassFns1(),loadClassFns2(),productDetails.fillCurrencySymbolsInLineHeaders(),productDetails.fillCurrSymForGrandVals(),"Contacts"===e){var u=$("#Crm_Contacts_ACCOUNTID");if(u&&0===u.length){var m=$("#Crm_Contacts_REPORTINGTOCONTACTID");if(m&&m.length>0){var p=void 0!==Crm.moduleInfo.Accounts?Crm.moduleInfo.Accounts.translatedSingularLabel:"Account",f=$("#Contacts_fldRow_REPORTINGTOCONTACTID");f.attr("class","REPORTINGTOCONTACTID tabDivCreate noclick");var v=I18n.getMsg("crm.contact.hierarchy.Specify_account_name",I18n.getMsg(p));f.attr("onmouseenter","renderingUtils.zctt.showtt('"+v+"');"),f.attr("onmouseleave","renderingUtils.zctt.hidett();"),m.val(""),m.prop("disabled",!0),m.autocomplete("disable")}}}commonUtils.showHideLoadingDiv(),commonUtils.showHideLoadingDiv(!1),renderingUtils.removeFreezeLayer()},error:function(e){commonUtils.showHideLoadingDiv(!1),renderingUtils.removeFreezeLayer();var t="crm.record.delete.message";-1!=e.responseText.indexOf("FEATURELIMIT_ERROR_403::::FEATURELIMITEXCEEDS")&&(t="crm.newfree.limit.exceed");var a='<div onclick="sE()" class="w500 p20"><div class="fL pL20 w430"><div class="crm-heading-font-size"><h2 style="color:#E20000";>'+I18n.getMsg("crm.delete.error")+'</h2></div><div class="mT10">'+I18n.getMsg(t,[Crm.getCrmBasePath()])+'</div></div><br class="cBoth"><div  class="alignRight mT20"><input type="button" id="popupok" class="newgraybtn" value="'+I18n.getMsg("crm.button.ok")+"\" onclick=\"hide('popupnew');renderingUtils.removeFreezeLayer();document.getElementById('popupnew').style.zIndex=30\"></div></div>";renderingUtils.popUpWithFreeze(a),commonUtils.showHideLoadingDiv()}}),(void 0===Crm.userDetails.LAYOUTRULEAVAILABLE||!0===Crm.userDetails.LAYOUTRULEAVAILABLE&&Crm.userDetails.LRINVOLVEDMODULES.contains(i.module))&&(i.getLayoutRuleJSON=!0,Crm.layoutRuleJSONData={},f.addUp({type:"GET",action:n,data:i,dataType:"json",success:function(e){null!==e&&(CFRExec.init(e,i.module,"edit"),CFRExec.promptIfMandatory=!1,CFRExec.evalRules("edit",!0))},error:function(){commonUtils.showHideLoadingDiv(),Crm.layoutRuleJSONData={}}})),(void 0===Crm.userDetails.VALIDATIONRULEAVAILABLE||!0===Crm.userDetails.VALIDATIONRULEAVAILABLE&&Crm.userDetails.VRINVOLVEDMODULES.contains(i.module))&&Crm.downloadValidationRules(n+"?format=json&module="+e+(i.layoutId?"&layoutId="+i.layoutId:""),e),!1},Handlebars.registerHelper("getLookupImag",(function(e,t){return crmTemplate.createLookUpImage(e,t)})),Handlebars.registerHelper("getClearLookupImage",(function(e){return crmTemplate.createLookUpClearImage(e)})),Handlebars.registerHelper("setRequiredAttributes",(function(e,t,a,r){var l=objectUtils.cloneObject(Crm.getModuleRenderingValue(t,a,r));if("htmlContainer"===a)l.id=l.id+"_"+t;else{var i="setup"===e.currentStatus?"_"+e.currentStatus:"";if("sectionContent"===a||"sectionHeading"===a){var s=e.currentSection.name.replace(/ |'/g,"_");l.id=("sectionContent"===a?"secContent_":"secHead_")+s,"Comments_Information"==s&&/Solutions|Cases/.test(t)&&/create|clone/.test(e.currentStatus)&&(l.style="display:none"),/Tasks|Calls/.test(t)&&"2"==e.currentSection.layout&&(l.style="width:100%")}else"fieldLabel"===a?(l.id="Crm_"+t+i+"_"+e.currentField.colname+"_label","true"==e.currentField.mandate&&""!=e.currentField.displaylabel&&(l.class+=" newmandatory")):l.id="Crm_"+t+i+"_"+e.currentField.colname}var n="";for(var o in l)n+=o+"='"+l[o]+"' ";return n})),Handlebars.registerHelper("getLookupImag",(function(e,t){return crmTemplate.createLookUpImage(e,t)})),Handlebars.registerHelper("getClearLookupImage",(function(e){return crmTemplate.createLookUpClearImage(e)})),Handlebars.registerHelper("getLoadLookupImage",(function(e){return crmTemplate.createLookUpLoadImage(e)})),Handlebars.registerHelper("setRequiredAttributes",(function(e,t,a,r){var l=objectUtils.cloneObject(Crm.getModuleRenderingValue(t,a,r));if("htmlContainer"===a)l.id=l.id+"_"+t;else{var i="setup"===e.currentStatus?"_"+e.currentStatus:"";if(""===i&&e.currentField&&e.currentField.suffixIndex&&"Tasks"!=t&&"Events"!=t&&"Calls"!=t&&(i="_"+e.currentField.suffixIndex),"sectionContent"===a||"sectionHeading"===a){var s=e.currentSection.name.replace(/ |'/g,"_");l.id=("sectionContent"===a?"secContent_":"secHead_")+s,"Comments_Information"==s&&/Solutions|Cases/.test(t)&&/create|clone/.test(e.currentStatus)&&(l.style="display:none"),/Tasks|Calls/.test(t)&&"2"==e.currentSection.layout&&(l.style="width:100%")}else"fieldLabel"===a?(l.id="Crm_"+t+i+"_"+e.currentField.colname+"_label","true"==e.currentField.mandate&&""!=e.currentField.displaylabel&&(!Crm.userDetails.isMandatorySubFormEnabled||"true"!==e.currentField.issubformfield&&void 0===e.currentField.subFormTabId?l.class+=" newmandatory":l.class+=" newSubformMandatory")):l.id="Crm_"+t+i+"_"+e.currentField.colname}var n="";for(var o in l)n+=o+"='"+l[o]+"' ";return n})),Handlebars.registerHelper("setSectionTitle",(function(e,t){return e.enableCopyAddress=!1,"Address Information"==t.name&&crmConstants.enableCopyAddressForModules[e.module]&&(e.enableCopyAddress=!0,crmTemplate.createAddressMenu(e.module)),Handlebars.templates.crmCreateSectionTitle(e)})),Handlebars.registerHelper("constructPricingDetails",(function(e){return $("<div>").append(pricingDetails.create(e.module,!1)).html()})),Handlebars.registerHelper("constructProductDetails",(function(e){if(Crm.userDetails.isLookupAdvancedSearchEnabledInLineItem&&(e.isLookupAdvancedSearchEnabled=!0),e.TAX_MIGRATION_COMPLETED=Crm.userDetails.TAX_MIGRATION_COMPLETED,!e.productLineItemFields&&e.currentField&&e.currentField.productLineItems&&e.currentField.productLineItems.productLineItemFields){for(var t=e.currentField.productLineItems.productLineItemFields,a={},r=0;r<=t.length-1;r++)a[t[r].label]=t[r].displaylabel;e.productLineItemFields=a}return Handlebars.templates.productDetails(e)})),Handlebars.registerHelper("productDetailsRow",(function(e,t,a){return e.module=t,e.rowNumber=a,e.lookupModule="Products",e.TAX_MIGRATION_COMPLETED=Crm.userDetails.TAX_MIGRATION_COMPLETED,e.autoPopulateTax=Crm.userDetails.autoPopulateTax,Handlebars.templates.productDetailsRow(e)})),Handlebars.registerHelper("getHeadingTitle",(function(e,t){if(void 0!==moduleRecordMapping[e.module]){var a="default"==moduleRecordMapping[e.module].generated_type?moduleRecordMapping[e.module].modified_by?moduleRecordMapping[e.module].singular_label:I18n.getMsg([moduleRecordMapping[e.module].singular_label]):moduleRecordMapping[e.module].singular_label;if("Campaigns"===e.module&&e.entityid&&e.isCreateChildCampaign&&"create"===window.Campaigns.currentStatus)var r=I18n.getMsg("crm.module.child.create",a);else if("clientPortal"===e.isFrom&&"Calls"===e.module)r=I18n.getMsg("crm.label.schedule.call");else r=I18n.getMsg("crm.module."+window[e.module].currentStatus,a)}else r=I18n.getMsg("crm.module."+window[e.module].currentStatus,[e.module]);return r})),Handlebars.registerHelper("setBtnDetails",(function(e,t){this.btnList=[{tabIndex:"496",name:"save",html:I18n.getMsg("crm.button.save"),"cscript-tag":"record_save"}];var a=e.module,r=Crm.userDetails.permissions["Crm_Implied_Create_"+a];if("Calls"===e.module&&r)this.btnList.push({tabIndex:"497",name:"saveAndTask","cscript-tag":"record_save_and_newtask",html:I18n.getMsg("crm.button.save&newtask")});else if(r){var l=Lyte.Router.getRouteInstance()?Lyte.Router.getRouteInstance().transition.data:void 0;l&&l.isCreateChildCampaign||this.btnList.push({tabIndex:"497",html:I18n.getMsg("crm.button.save&new"),name:"saveAndNew","cscript-tag":"record_save_and_new"})}"Tasks"===e.module&&Crm.userDetails.ISGAPPS_USER&&this.btnList.push({tabIndex:"498",name:"saveAndExportToGoogleTask",html:I18n.getMsg("crm.button.Gapps.saveToGTask")}),this.btnList.push({tabIndex:"499",html:I18n.getMsg("crm.button.cancel"),name:"cancel","cscript-tag":"record_cancel"})})),crmTemplate.backUpFormVals=function(e){var t=$("[name='"+e+"']");t.data("changedFormVals",{}),t.data("initialFormVals",{}),$("[name='"+e+"']").on("ownerLookupChanged",(function(t){var a=$("[name='"+e+"']").data("changedFormVals"),r=$(renderingUtils.targetElement(t));a[r.attr("id")]=r.text()})),$("[name='"+e+"'] :input").change((function(t,a){var r=$(this),l=r.attr("id");if(("layoutDetails"==l||"zCampIntegLayout"==l)&&$(".set_mw").length>0)return!0;if("create"===a)return!0;var i=r.data();2!==i.uitype&&26!==i.uitype||!0!==i.colorcode_enabled||updateColorCodeForSelObj(r);var s=$(renderingUtils.getTargetElem(t)),n=$("[name='"+e+"']"),o=n.data("changedFormVals");o[s.attr("id")]=commonUtils.getValue(s),n.data("changedFormVals",o)})).each((function(){var e=t.data("initialFormVals"),a=$(arguments[1]);e[a.attr("id")]=commonUtils.getValue(a),t.data("initialFormVals",e)}))},crmTemplate.isAnyChangeInForm=function(e,t){for(var a=$("[name='"+e+"']").data("initialFormVals"),r=$("[name='"+e+"']").data("changedFormVals"),l=objectUtils.getKeys(r),i=0;i<l.length;i++)if(a[l[i]]!=r[l[i]])return!0;var s=$("#totalProductCount");return!!(window.location.pathname!==Crm.getCrmBasePath()+"/GeneratingPO.do"&&Crm.isInventoryModule(t)&&s&&parseInt(s.val())>0)},crmTemplate.tooltiptimeout=void 0,crmTemplate.bindFldTooltip=function(){$(".infotoolTip").on("mouseenter",(function(e){void 0!==crmTemplate.tooltiptimeout&&clearTimeout(crmTemplate.tooltiptimeout),$("#fieldTooltip").hide(),void 0!==$(this).attr("fldtooltip")&&crmTemplate.showFieldTooltip($(this).attr("fldtooltip"),$(this)),$(this).css("visibility","visible").addClass("lastHoveredIcon")})).on("mouseleave",(function(e){clearTimeout(crmTemplate.tooltiptimeout),void 0!==$(this).attr("fldtooltip")&&(crmTemplate.tooltiptimeout=setTimeout((function(){0===$("#fieldTooltip:hover").length&&crmTemplate.hideFieldTooltip()}),200))}))},crmTemplate.showFieldTooltip=function(e,t){var a=$("div#fieldTooltip"),r=t.offset().left,l=t.offset().top;a.css({display:"block"}),a.css("padding",""),a.html(e);var i=l-a.outerHeight()-13;a.css({"word-wrap":"break-word",top:i+5,left:r-8})},crmTemplate.hideFieldTooltip=function(){$("#fieldTooltip").hide(),$(".lastHoveredIcon").not(".infoTTStay").css("visibility","hidden"),$(".lastHoveredIcon").removeClass("lastHoveredIcon")},crmTemplate.addSubFromRow=function(e,t,a,r){crmTemplate.forSubformFormulaNewEpxTriggered||crmTemplate.addRowFormulaTrig(a);var l=$("#subform_"+t),i=l.data("data-max_rows"),s=l.data("data-show-bulkOption"),n=l.find("tbody tr").length;if(n<i){var o=0;o=Crm.userDetails.isMandatorySubFormEnabled&&void 0===l.find("tbody tr:last-child").data("data-rowid")?1:parseInt(l.find("tbody tr:last-child").data("data-rowid"));var d=crmTemplate.getNextSubformRowId(l.data("data-subformid"),o),c=JSON.parse(l.data("data-fields")),u={};u.module=a,u.isClientAccount=u.isClientAccount?u.isClientAccount:Crm.userDetails.CLIENT_ACCOUNT;var m=crmTemplate.createSubFormRow(l.data("data-subformid"),d,c,u,r,a,!0,n+1,l.data("data-subformdisplaylabel"),l.data("data-subformsectionlabel"),!1,"",l.attr("isLineItemSF"));this.subformData[d]={};var p=$(l).find(".tableHeadBg .subFrmSnFld").length;if($(m).addClass("dN"),$(m).find("textarea").css("height","18px"),m=crmTemplate.productLineItemSettingsAddRow(m),$(l).find("tbody").append(m),p>0){var f=n+1;$(l).next(".subFrmTablSerlNoOverlay").find("table tbody").append("<tr class='topband_dv_row' onmouseenter=\"crmTemplate.subFrmDeltIconShow(this, '"+t+"')\" onmouseleave='crmTemplate.subFrmDeltIconHide()'><td class='subFrmSnFld textFld'><div class='labelValCreate mL45'><input class='textField' type='text' readonly='' value='"+f+"'></div></td></tr>")}if(thirdPartyUtils.bindSelect2($(m).find(".newChosenSel select, .mlSelect select")),window[a].formulaObj.executeformulaeWithoutFields(),setTimeout((function(){$(m).removeClass("dN");var e=$("#"+t).find("tr:last"),a=e.find("textarea:first").closest("td").index();e.find("input:first").closest("td").index()<a?e.find("input:first").focus():e.find("textarea:first").focus(),Crm.userDetails.isPinnedColumnEnabled&&$L("#"+m.id).find("td.sbmPinnedPreview").each((function(){CMB.setCssForPreview(this)}))}),100),i<=n+1)s?($(e).attr("lt-prop-disabled",!0).removeAttr("onclick").attr("onmouseenter","crmTemplate.limitReached(this,I18n.getMsg('crm.label.subform.allowedlimit','"+i+"'),'sfrmLimitReached');").attr("onmouseleave","crmTemplate.limitReachedHide('sfrmLimitReached');"),$L("#bulk_subform").attr("lt-Prop-Disabled",!0).attr("onmouseenter","crmTemplate.limitReached(this,I18n.getMsg('crm.label.subform.allowedlimit','"+i+"'),'sfrmLimitReached');").attr("onmouseleave","crmTemplate.limitReachedHide('sfrmLimitReached');")):$(e).addClass("subDisabledBtn").removeAttr("onclick").attr("onmouseenter","crmTemplate.limitReached(this,I18n.getMsg('crm.label.subform.allowedlimit','"+i+"'),'sfrmLimitReached');").attr("onmouseleave","crmTemplate.limitReachedHide('sfrmLimitReached');");else{var v=$("#totalProductCount");0!==v.length&&v.val(parseInt(v.val())+1)}l.closest(".subFrmLayout").hasClass("reorderEnabled")&&l.find("tbody").sortable("enable"),window[a].formulaObj.executeAggrWithoutFields();var h=$("html, body"),g=$L(document).scrollTop(),T=$(e).offset().top,C=$(e).outerHeight();g+$(window).height()<=T+C+65&&h.stop().animate({scrollTop:g+40},500)}l.closest(".subFrmTablWrapper").animate({scrollLeft:0},300),$(l).closest(".subFrmLayout").find(".SubFrmScrolIn").length>0&&(subShadHght=$(l).closest(".subFrmTablWrapper").outerHeight()+19,$(l).closest(".subFrmLayout").find(".SubFrmScrolIn").css("height",subShadHght));for(var b={},_=this.dependentFieldsList.length,y=0;y<_;y++){if(this.dependentFieldsList[y].includes(t))this.dependentFieldsList[y].split("_")[4]===d&&(b[this.dependentFieldsList[y]]=!0)}for(var I in b){var E=$("#"+I)[0];E&&Crm.setDependent(void 0,a,E,"create")}},crmTemplate.limitReached=function(e,t,a){var r=$(e),l=r.offset().top,i=r.offset().left+r.outerWidth()+10,s=r.offset().left-200,n=$("#"+a);n.find("span").html(t);var o=$("crm-canvas-quicksavepopup")[0],d=o&&o.component.getData("showPopup")?10003:29;Crm.userDetails.RTL_ENABLED?(n.addClass("t-rtl"),n.css({top:l,left:s,"z-index":d}).removeClass("dN")):(n.removeClass("t-rtl"),n.css({top:l,left:i,"z-index":d}).removeClass("dN"))},crmTemplate.limitReachedHide=function(e){$("#"+e).addClass("dN")},crmTemplate.getNextSubformRowId=function(e,t){return 0!=$("#"+e+"_"+t).length?crmTemplate.getNextSubformRowId(e,t+1):t},crmTemplate.updateSubFormSerialNumber=function(e,t){for(var a=$("[id^='Crm_"+e+"_"+t+("setup"===window[e].currentStatus?"_setup":"")+"_SERIAL_NUMBER']"),r=0;r<a.length;r++){$(a[r]).val(r+1)}},crmTemplate.serialNumberHeightAdjustForSubform=function(e){var t=$("."+e),a=t.closest("td"),r=a.index(),l=a.outerWidth(),i=t.closest(".subFrmLayout"),s=i.find(".SubFrmScrolIn"),n=t.closest(".subFrmTablWrapper"),o=n.outerHeight();setTimeout((function(){var e=a.outerHeight()-9;t.closest(".subformTabl").find(".tableHeadBg td").eq(r).css("min-width",l),n.find(".subFrmSnFld").length>0&&i.find(".subFrmTablSerlNoOverlay tbody tr").eq(t.closest("tr").index()).find("td .labelValCreate").css("height",e),s.length>0&&s.css("height",o-20)}),200)},crmTemplate.subFrmDeltIconShow=function(e,t){var a=$("#subfrmDelWrap"),r=$(e).index(),l=$(e).outerHeight(),i=$(e).closest(".subFrmTablWrapper").offset().left-25,s=$(e).offset().top;!0===Crm.userDetails.RTL_ENABLED?a.attr("data-subFormTabId",t).attr("data-subfCur-row",r).css({height:l,right:0,top:s,zIndex:"undefined"!=typeof crmui?crmui.zIndex:"99"}).show():a.attr("data-subFormTabId",t).attr("data-subfCur-row",r).css({height:l,left:i,top:s,zIndex:"undefined"!=typeof crmui?crmui.zIndex:"99"}).show(),a.removeClass("lastRowDelete")},crmTemplate.subFrmDeltIconHide=function(){$(".subformTabl tr").removeClass("subFrmCurDelRow"),$("#subfrmDelWrap").hide()},crmTemplate.subFrmDeltRowRemove=function(){var e=$("#subform_"+$("#subfrmDelWrap").attr("data-subFormTabId")),t=e.find("tr").eq(parseInt($("#subfrmDelWrap").attr("data-subfCur-row"))+1),a=t.siblings("tr").length,r=$("#subfrmDelWrap");r.removeClass("lastRowDelete");var l=e.data("data-parentmodule"),i=e.closest(".subFrmLayout"),s=e.find("tr").eq(parseInt(r.attr("data-subfCur-row"))+1);if(t.find(".fileuploaddrop .closeIcon").each((function(e,t){var a=$(t),r=a.attr("onclick");if(void 0!==r)new Function(r)();else{var l=a.find(".attachDropMenuRow");l.length>0&&new Function(l.attr("onclick"))()}})),$(i).find(".SubFrmScrolIn").length>0){var n=$(i).find(".SubFrmScrolIn").height()-$(s).outerHeight();$(i).find(".SubFrmScrolIn").css("height",n)}a>0&&a+1!=t.index()+1?(delete this.subformData[parseInt(t.index()+1)],s.remove()):a>0&&a+1==t.index()+1?(delete this.subformData[parseInt(t.index()+1)],s.remove(),r.addClass("lastRowDelete")):Crm.userDetails.isMandatorySubFormEnabled&&0===a&&"false"===e[0].getAttribute("subform-mandatory")?(delete this.subformData[parseInt(t.index()+1)],s.remove()):(this.subformData[parseInt(t.index()+1)]={},crmTemplate.resetSubformFields(s),r.addClass("lastRowDelete"));var o=$("#totalProductCount");if(0!==o.length){var d=parseInt(o.val());d>1&&o.val(d-1)}var c=e.data("data-max_rows"),u=e.data("data-show-bulkOption"),m=e.find("tbody tr").length;l=e.data("data-parentmodule");u&&c>m?(i.find("#subFrmaddRowBtn").attr("lt-prop-disabled",!1).attr("onclick","crmTemplate.addSubFromRow(this, '"+r.attr("data-subFormTabId")+"','"+l+"','1')").removeAttr("onmouseenter onmouseleave"),$L("#bulk_subform").attr("lt-prop-disabled",!1).removeAttr("onmouseenter onmouseleave")):i.find(".subDisabledBtn").length>0&&c>m&&i.find("#subFrmaddRowBtn").removeClass("subDisabledBtn").attr("onclick","crmTemplate.addSubFromRow(this, '"+$("#subfrmDelWrap").attr("data-subFormTabId")+"','"+l+"','1')").removeAttr("onmouseenter onmouseleave"),i.find(".subFrmTablSerlNoheadOverlay").length>0&&(i.find(".subFrmTablSerlNoOverlay tbody").html(""),i.find(".subformTabl tbody tr").each((function(){i.find(".subFrmTablSerlNoOverlay tbody").append("<tr class='topband_dv_row' onmouseenter=\"crmTemplate.subFrmDeltIconShow(this, '"+$("#subfrmDelWrap").attr("data-subFormTabId")+"')\" onmouseleave='crmTemplate.subFrmDeltIconHide()'><td class='subFrmSnFld textFld' style='height: "+$(this).find("td:first-child").outerHeight()+"px'><div class='labelValCreate mL45'><input class='textField' type='text' readonly value='"+($(this).index()+1)+"' /></div></td></tr>")}))),e.closest(".subFrmLayout").hasClass("reorderEnabled")&&1==t&&e.find("tbody").sortable("disable"),crmTemplate.updateSubFormSerialNumber(l,e.data("dataSubformid")),window[l].formulaObj.executeformulaeWithoutFields(),window[l].formulaObj.executeAggrWithoutFields()},crmTemplate.resetSubformRows=function(e){var t=$("#subform_"+e),a=t.data("data-parentmodule"),r=t.closest(".subFrmLayout"),l=t.find("tbody tr:gt(0)"),i=l.length,s=t.find("tbody tr:first"),n=s.eq(0),o=r.find(".SubFrmScrolIn");if(o.length>0){var d=o.height()-i*t.find("tbody tr:last").outerHeight();o.css("height",d)}l.remove(),crmTemplate.resetSubformFields(n);var c=$("#totalProductCount");0!==c.length&&c.val(1);var u=t.data("data-max_rows"),m=s.length;a=t.data("data-parentmodule");r.find(".subDisabledBtn").length>0&&u>m&&r.find("#subFrmaddRowBtn").removeClass("subDisabledBtn").attr("onclick","crmTemplate.addSubFromRow(this, '"+$("#subfrmDelWrap").attr("data-subFormTabId")+"','"+a+"','1')").removeAttr("onmouseenter onmouseleave"),r.find(".subFrmTablSerlNoheadOverlay").length>0&&(r.find(".subFrmTablSerlNoOverlay tbody").html(""),r.find(".subformTabl tbody tr").each((function(){r.find(".subFrmTablSerlNoOverlay tbody").append("<tr class='topband_dv_row' onmouseenter=\"crmTemplate.subFrmDeltIconShow(this, '"+$("#subfrmDelWrap").attr("data-subFormTabId")+"')\" onmouseleave='crmTemplate.subFrmDeltIconHide()'><td class='subFrmSnFld textFld' style='height: "+$(this).find("td:first-child").outerHeight()+"px'><div class='labelValCreate mL45'><input class='textField' type='text' readonly value='"+($(this).index()+1)+"' /></div></td></tr>")}))),r.hasClass("reorderEnabled")&&t.find("tbody").sortable("disable"),crmTemplate.updateSubFormSerialNumber(a,t.data("dataSubformid")),window[a].formulaObj.executeformulaeWithoutFields(),window[a].formulaObj.executeAggrWithoutFields()},crmTemplate.resetSubformFields=function(e){var t=e.find("select:not([multiple])");t.select2("destroy"),e.data("data-linkingmodule_id",""),e.find("input").val("").data("id",""),e.find("textarea").val("");var a=e.find("select[multiple]");a.select2("val","");var r=e.find("crm-user-wrapper");r.length>0&&r[0].removeSelection();var l=e.find("input:checkbox"),i=e.find("#cNSubformFileUpload");if(i.length>0){var s=i.find(".fileUploadLabel"),n=s.data("fieldid"),o=s.attr("id"),d=o.substring(o.lastIndexOf("_"));$("#attachSize_"+n+d).val(""),$("#attachCount_"+n+d).val("0"),s.val(I18n.getMsg("crm.tpi.ctiapi.config.choosefile"))}for(var c=t.length,u=0;u<c;u++){for(var m="",p=(C=(T=t.eq(u)).data("picklistmap")).length,f=0;f<p;f++){if((b=C[f]).isDefaultOption){m=b.uservalue;break}}if(populatePicklist(T,"",!0),""!==m?T.val(m):T.find("option:first").prop("selected",!0),""===T.val()&&!0===T.data("colorcode_enabled")){var v="selectColorComponent-"+T.attr("id"),h=$("#"+v);h.length>0&&h.remove()}T.addClass("selNone"),thirdPartyUtils.bindSelect2(T)}var g=a.length;for(u=0;u<g;u++){var T,C;for(m=[],p=(C=(T=a.eq(u)).data("picklistmap")).length,f=0;f<p;f++){var b;(b=C[f]).isDefaultOption&&m.push(b.uservalue)}populatePicklist(T,"",!0),m.length>0&&T.val(m)}var _=l.length;for(u=0;u<_;u++){var y=l.eq(u);y.data("defaultvalue_unmodified")?y.prop("checked",!0):y.prop("checked",!1)}},crmTemplate.appendSubFrmSnOverLay=function(){for(var e=$(".subFrmTablWrapper"),t=e.length,a=0;a<t;a++){var r=e.eq(a),l=r.find(".subformTabl");if(l.find(".tableHeadBg .subFrmSnFld").length>0)for(var i=l.data("data-subformid"),s=l.find("tbody tr").length,n=0;n<s;n++)r.find(".subFrmTablSerlNoOverlay tbody").append("<tr class='topband_dv_row' onmouseenter=\"crmTemplate.subFrmDeltIconShow(this,'"+i+"')\" onmouseleave='crmTemplate.subFrmDeltIconHide()'><td class='subFrmSnFld textFld'><div class='labelValCreate mL45'><input class='textField' type='text' readonly value='"+(n+1)+"' /></div></td></tr>")}},crmTemplate.createSubForm=function(e,t,a,r,l,i){t||(t={module:e});var s=r.subFormTabId;i=i;crmTemplate.forSubformFormulaNewEpxTriggered=!1;var n=r.layout,o=document.createElement("table"),d=r.isLineItemSF,c=!1;if(Crm.userDetails.isMandatorySubFormEnabled){for(var u=r.FL.length,m=0;m<u;m++)"500"===r.FL[m].uitype&&(c=r.FL[m].mandate);for(var p=t[e].subforms.section,f=p.length,v=0;v<f;v++)p[v].subFormTabId===s&&void 0!==p[v].mandatorySubform&&p[v].mandatorySubform&&(c=!0)}$(o).attr({"sub-data":a,isLineItemSF:d,"subform-mandatory":c}).data("data-columnname",l).attr("id","subform_"+s).attr("cellpadding","0").attr("cellspacing","0").addClass("invoiceTable subformTabl"),$(o).data("data-subformid",s).data("data-parentmodule",e),t.relListId&&$(o).attr("relListId",t.relListId);var h=document.createElement("tr");$(h).prepend('<th class="subFrmDragIconWrap">&nbsp;</th>').addClass("tableHeadBg");var g=document.createElement("thead");g.appendChild(h);for(var T,C=t[e].subforms.section,b=0;b<C.length;b++)if(C[b].subFormTabId==s){T=C[b];break}void 0===T&&(T=C);var _=T.FL,y=T.subFormName,I=T.displaylabel;if(_){var E;t.elementSufixId="",crmTemplate.checkAndAddSubformTabId(e,s),T.tooltip&&(E=T.tooltip);var D=(!Crm.userDetails.isStaticSubFormEnabled||"static"!==T.type)&&T.reorder;Crm.userDetails.SUBFORM_PERMISSIONS&&i&&!i.edit&&(D=!1);var F,S=T.maxRows,w=!!T.bulk_addition&&!(!T.bulk_addition.field_id||"None"===T.bulk_addition.field_id);if(w||(w=!!T.isBulkOptSelected),$(o).data("data-max_rows",S),$(o).data("data-toolTip",E),$(o).data("datasubformreorder",D.toString()),$(o).data("data-subformdisplaylabel",y),$(o).data("data-subformsectionlabel",I),$(o).data("data-show-bulkOption",w),void 0===_.length?(_=[[_]],T.FL=_):null==_[0].length&&(_=[_],T.FL=_),d){productDetails.invModuleVsLineItemSfTabId[e]=s;var R=document.createElement("input");R.setAttribute("id","totalProductCount"),R.value=_.length,$(R).css({display:"none"}),o.append(R)}var A=document.createElement("tbody");crmTemplate.subformData=[];for(var L=$("#multipleFieldsEditPop").is(":visible"),N=0;N<_.length;N++){var k=_[N],O=crmTemplate.getFieldTypes(k,e),M=O?O.length:0,U=N+1;crmTemplate.subformData[U]={};for(var x=0;x<M;x++)if(!0!==O[x]&&-1===["LINKINGMODULE_ID","ITEMDESCRIPTION","BOOKID","LINETAX","TOTALAFTERDISCOUNT","DISCOUNT_TYPE","DISCOUNT_PERCENTAGE"].indexOf(O[x].colname)){var P=O[x];crmTemplate.subformData[U][P.displaylabel]=P.defaultvalue}if(0==N){t.elementSufixId="_1",$(o).data("data-fields",JSON.stringify(O));var H=-1,B=["LINKINGMODULE_ID","ITEMDESCRIPTION","BOOKID","LINETAX","TOTALAFTERDISCOUNT","DISCOUNT_TYPE","DISCOUNT_PERCENTAGE"];L&&B.push("SMCREATORID");for(x=0;O&&x<O.length;x++)if(!0!==O[x]&&-1===B.indexOf(O[x].colname)){t.currentField=O[x];P=t.currentField;var V=t.currentField.type.toLowerCase();116===P.uitype&&(V=P.formulaType),(P={}).subFormName=T.subFormName;var j=V.toLowerCase();switch(V){case"text":case"email":case"phone":case"website":case"textarea":case"autonumber":case"lookup":V="text",j="text";break;case"multiselectpicklist":V="multiselectpicklist",j="multi-picklist";break;case"currency":case"double":case"integer":case"bigint":case"decimal":V="number",j="number";break;case"datetime":V="datetime",j="datetime";break;case"date":V="date",j="date";break;case"boolean":V="boolean",j="boolean";break;case"userlookup":V="userlookup",j="userlookup";break;case"picklist":V="picklist",j="picklist"}P.type=j,P.data_type=V,P.field_label=t.currentField.displaylabel,crmTemplate.subformFldDetails[t.currentField.sysRefName]=P,t.currentField.rowNum=1,t.currentField.subFormTabId=s,t.currentField.subformdisplaylabel=y,t.currentField.subformsectionlabel=I,window[e].formulaObj.subFormVssubFormFields[s]=s+"_"+t.currentField.colname;var Y=document.createElement("th"),z=crmTemplate.getCssClass(O[x],Y);switch(Y.className=z,O[x].colname){case"PRODUCTID":H=x,Y.className=Y.className+" pli_productName";break;case"TOTAL":Y.className=Y.className+" pli_amount";break;case"NETTOTAL":Y.className=Y.className+" pli_total";break;case"QUANTITY":Y.className=Y.className+" pli_quantity"}Crm.userDetails.isAdjustFieldWidthEnabled&&(t.currentField.fieldLableIsLyetText=!0),Y.appendChild(crmTemplate.createFieldLabel(t,s));var W=O[x].uitype;if(116==W&&"currency"==O[x].formulaType||36==W||143==W||144==W||145==W){var G,q=$(Y).find(".sfHeaderCurrency");G=window[e].currencyDetails&&window[e].defaultCurrency?window[e].currencyDetails[window[e].defaultCurrency].symbol:window[e].currencyDetails&&window[e].currencyDetails[Crm.userDetails.BASE_CURRENCY]?window[e].currencyDetails[Crm.userDetails.BASE_CURRENCY].symbol:Crm.userDetails.CURRENCY_DETAILS&&Crm.userDetails.BASE_CURRENCY?Crm.userDetails.CURRENCY_DETAILS[Crm.userDetails.BASE_CURRENCY].symbol:Crm.userDetails.defaultOrgCurrency?Crm.userDetails.defaultOrgCurrency:"",q.text("("+G+")").attr("id","currencySymbol_"+t.currentField.attrObj.id)}var J=$L("#"+t.currentField.fieldid);if("ProcessFlow"!==t.isFrom){t.currentField.subform_properties&&(t.currentField.pinned_column=t.currentField.subform_properties.pinned_column,t.currentField.custom_width=t.currentField.subform_properties.custom_width);var K,X=$L(Y);if(Crm.userDetails.isAdjustFieldWidthEnabled)K=!(-1!==window.location.href.indexOf("portal"))&&J&&J[0]?J[0].offsetWidth:t.currentField.custom_width?t.currentField.custom_width+"px":"SERIAL_NUMBER"===t.currentField.colname?"85px":crmCommonModule.setWidthBasedOnFieldType(Number(t.currentField.uitype))+"px",Y.style.setProperty("min-width",K,"important"),X.attr("data-width",K),X.css({width:K,"max-width":K});if(Crm.userDetails.isPinnedColumnEnabled&&(t.currentField.pinned_column||"SERIAL_NUMBER"===t.currentField.colname))if(X.addClass("sbmPinnedPreview"),-1!==window.location.href.indexOf("portal")){var Q=$L(h).find(".sbmPinnedPreview").eq(-1),Z=0;0!==Q.length&&K?Z=parseInt(Q[0].style.minWidth)+parseInt(Q[0].style.left):"static"===T.type||$L(h).hasClass("subFrmDragIconWrap")||(Z=10),X.css("left",Z)}}h.appendChild(Y)}if(-1!==H){var ee=JSON.parse($(o).data("data-fields"));delete ee[H].prdDetails,$(o).data("data-fields",JSON.stringify(ee))}t.elementSufixId=""}if(Crm.userDetails.isStaticSubFormEnabled&&"static"===T.type)for(var te=T.staticRows?T.staticRows:T.maxRows,ae=0;ae<te;ae++){var re;(re=F?crmTemplate.createSubFormRow(s,ae,O,t,n,e,!1,ae+1,y,I,!0,F,d,T):crmTemplate.createSubFormRow(s,ae,O,t,n,e,!1,ae+1,y,I,!0,"",d,T)).removeAttribute("onmouseenter"),re.removeAttribute("onmouseleave"),F=re.cloneNode(!0),$(o).data("data-type","static"),A.appendChild(re)}else Crm.userDetails.SUBFORM_PERMISSIONS&&i?F&&i&&i.create?F=(re=crmTemplate.createSubFormRow(s,U,O,t,n,e,!1,N+1,y,I,!0,F,d)).cloneNode(!0):i&&i.create&&(F=(re=crmTemplate.createSubFormRow(s,U,O,t,n,e,!1,N+1,y,I,!0,"",d)).cloneNode(!0)):(F=F?(re=crmTemplate.createSubFormRow(s,U,O,t,n,e,!1,N+1,y,I,!0,F,d)).cloneNode(!0):(re=crmTemplate.createSubFormRow(s,U,O,t,n,e,!1,N+1,y,I,!0,"",d)).cloneNode(!0),A.appendChild(re));if(d){var le=$(re).find(".Crm_"+e+"_"+s+"_LISTPRICE_"+U),ie=$(re).find(".Crm_"+e+"_"+s+"_BOOKID_"+U),se=$(re).find("#"+ie.attr("id")+"_img"),ne=se.closest("span");se.addClass("mL0"),ne.removeClass("top_30"),ne.insertAfter(le)}Crm.userDetails.SUBFORM_PERMISSIONS&&i&&i.create&&A.appendChild(re)}if(o.appendChild(g),o.appendChild(A),"ProcessFlow"!==t.isFrom){var oe=$L(A).find("tr.topband_dv_row");if(Crm.userDetails.isAdjustFieldWidthEnabled){var de=$L(g).find("th");oe.each((function(){$L(this).find("td").each((function(e,t){if(de[e]&&de[e].style){var a=""===de[e].style.minWidth?0:parseInt(de[e].style.minWidth);a=isNaN(a)?0:a,t.style.setProperty("min-width",a,"important"),$L(t).css({width:a,"max-width":a})}}))}))}if(Crm.userDetails.isPinnedColumnEnabled){var ce=$L(g).find("th.subFrmDragIconWrap");"static"===T.type?ce[0].remove():void 0!==ce&&ce.addClass("sbmPinnedPreview");var ue=$L(g).find("th.sbmPinnedPreview").length;oe.each((function(e,t){var a=$L(t).find("td.subFrmDragIconWrap");"static"===T.type?a[0].remove():void 0!==a&&a.addClass("sbmPinnedPreview"),$L(t).find("td").each((function(e,t){if(ue>e){var a=t.previousElementSibling;(t=$L(t)).addClass("sbmPinnedPreview");var r=0;a&&!$L(a).hasClass("subFrmDragIconWrap")?r=(isNaN(parseInt(a.style.width))?0:parseInt(a.style.width))+parseInt(a.style.left):"static"===T.type||t.hasClass("subFrmDragIconWrap")||(r=10),t.css("left",r)}}))}))}}$(o).find(".tableHeadBg td").length<=6&&$(o).addClass("fewColumnSubform");var me=0;return $L(o).find("th").each((function(e,t){e&&(me+=Number($L(t).attr("data-width")))})),$L(o).css("width",me),o}return!1},crmTemplate.createSubFormRow=function(e,t,a,r,l,i,s,n,o,d,c,u,m,p){var f=!0;u||(f=!1,u=document.createElement("tr"),Crm.userDetails.isPinnedColumnEnabled?$(u).prepend('<td class="subFrmDragIconWrap sbmPinnedPreview"><div class="subFrmDragIcon svgIcons mT8" data-zcqa="Crm_'+d+"_reorder_"+t+'"></div></td>').addClass(m?"topband_dv_row ui-state-default lineItemSubFrmRow":"topband_dv_row ui-state-default").attr("onmouseenter","crmTemplate.subFrmDeltIconShow(this, '"+e+"')").attr("onmouseleave","crmTemplate.subFrmDeltIconHide()"):$(u).prepend('<td class="subFrmDragIconWrap"><div class="subFrmDragIcon svgIcons mT8" data-zcqa="Crm_'+d+"_reorder_"+t+'"></div></td>').addClass(m?"topband_dv_row ui-state-default lineItemSubFrmRow":"topband_dv_row ui-state-default").attr("onmouseenter","crmTemplate.subFrmDeltIconShow(this, '"+e+"')").attr("onmouseleave","crmTemplate.subFrmDeltIconHide()")),$(u).data("data-rowid",t),t="_"+t,$(u).attr("id",e+t);for(var v=[],h=0,g=$("#multipleFieldsEditPop").is(":visible"),T=0;a&&T<a.length;T++)if(1!=a[T]){var C=a[T];if("SMCREATORID"===C.colname&&g)continue;if("LINKINGMODULE_ID"===C.colname){s||$(u).data("data-linkingmodule_id",C.defaultvalue);continue}if(Crm.userDetails.isStaticSubFormEnabled&&C.static_field){var b=C.static_value[n-1],_={default:!0};_.content=_.html=b,C.default=[],C.default.push(_)}if(s&&(C.defaultvalue_unmodified?C.defaultvalue=C.defaultvalue_unmodified:(C.defaultvalue="",C.defaultid=""),C.val))for(var y=0;y<C.val.length;y++)"true"==C.val[y].default&&(C.defaultvalue=C.val[y].content);if(C.rowNum=t,"SERIAL_NUMBER"!==C.colname||C.defaultvalue||(C.defaultvalue=n),C.subformdisplaylabel=o,C.subformsectionlabel=d,r.currentField=C,r.elementSufixId=t,r.currentField.subFormTabId=e,r.currentStatus=window[i].currentStatus,C.attrObj&&!c&&(r.currentField.attrObj.id=C.attrObj.id+t,333==C.uitype&&(r.currentField.timeAttrObj.id=C.attrObj.id+"_TimeOption")),("2"===C.uitype||"26"===C.uitype)&&!0===C.colorcode_enabled){var I,E;void 0!==C.default&&C.default.length>0?E=(I=C.default[0]).content:(I=C,E=C.defaultvalue);var D="";I&&(I.colorcode?D=C.default[0].colorcode:(D=C.defaultcolorcode?C.defaultcolorcode:getPickListColorCode(E,C.picklistmap),I.colorcode=D),C.color_code=D)}var F,S=r.currentField;if(S.subFormName=r.subFormName,S.attrObj||S.dataObj||crmTemplate.setFieldData(r,e),S=r.currentField,f){S.isSubformSplHandling=!0;var w=S.attrObj.id;if(w=w.substr(0,w.lastIndexOf("_")+1)+(n-1),null==(M=u.querySelector('[sf-lyte-dom-id="'+w+'"]'))&&(M=u.getElementsByClassName(w)[0],Crm.userDetails.isStaticSubFormEnabled&&!M&&p&&"static"===p.type&&null===(M=u.getElementsByClassName(w.substr(0,w.lastIndexOf("_")+1)+1)[0])&&"33"===S.uitype&&(M=u.getElementsByTagName("crm-phone-field")[0])),Crm.userDetails.isStaticSubFormEnabled&&null==M)continue;crmTemplate.fillDataOrAttrVals(M,S.uitype,S.attrObj,"attrobj"),crmTemplate.fillDataOrAttrVals(M,S.uitype,S.dataObj,"dataobj"),crmTemplate.setFieldSpecDomAttr(M,S,n),F=$(M).closest("td")[0],F=crmTemplate.createSubFormFieldRow(l,i,F,r,e)}else F=crmTemplate.createSubFormFieldRow(l,i,"",r,e);if("SERIAL_NUMBER"===r.currentField.colname){var R=$(F).find('[data-colname="SERIAL_NUMBER"]');R.attr({readonly:!0,disabled:!0}),Crm.userDetails.isStaticSubFormEnabled&&(R[0].value=n)}C.criteria&&""!==C.criteria&&$(F).find("[cscript-tag]").siblings().find("[data-cid='showLookup']").attr("data-critria",C.criteria);var A,L=$L("#"+S.fieldid);if(C.subform_properties&&0!==L.length&&(C.pinned_column=C.subform_properties.pinned_column,C.custom_width=L.width()),Crm.userDetails.isPinnedColumnEnabled&&(C.pinned_column||"SERIAL_NUMBER"===C.colname)&&$L(F).addClass("sbmPinnedPreview"),Crm.userDetails.isAdjustFieldWidthEnabled)A=-1!==window.location.href.indexOf("portal")||0===L.length?r.currentField.custom_width?r.currentField.custom_width+"px":"SERIAL_NUMBER"===r.currentField.colname?"85px":crmCommonModule.setWidthBasedOnFieldType(Number(r.currentField.uitype))+"px":L[0].offsetWidth,F.style.setProperty("min-width",A,"important"),$L(F).css({width:A,"max-width":A});if("ITEMDESCRIPTION"===r.currentField.colname||"BOOKID"===r.currentField.colname){var N={};N.fldElm=$(F).find("div")[0],"ITEMDESCRIPTION"===r.currentField.colname&&$(F).find(".prdItemDesc").attr("placeholder",I18n.getMsg("Description")),N.dependent_fieldcol="BOOKID"===r.currentField.colname?"LISTPRICE":"PRODUCTID",v[h]=N,h++}else f||u.appendChild(F)}if(!f){for(y=0;y<h;y++){var k=document.createElement("span"),O=document.createElement("hr");$(O).css({"border-color":"var(--br_EDF0F4)",width:"180px"}),k.append(O);var M,U=(M=$(u).find('[data-colname="'+v[y].dependent_fieldcol+'"]')).closest("td").get(0);void 0!==U&&("PRODUCTID"===v[y].dependent_fieldcol&&U.append(k),U.append(v[y].fldElm))}productDetails.bindPBIconShowOrHideSFLineItem($(u))}return u},crmTemplate.addRowFormulaTrig=function(e){window[e].formulaObj.executeForNewFormulaExpr(),crmTemplate.forSubformFormulaNewEpxTriggered=!0},crmTemplate.fillDataOrAttrVals=function(e,t,a,r){if(e.getAttribute("sf-lyte-dom-id"))e.setData(r,Handlebars.helpers.convertObjToString(a)),"dataobj"===r?(e.setData("previousValue",a["data-old-value"]),e.setData("presentValue",a["data-old-value"])):e.setAttribute("sf-lyte-dom-id",a.id);else for(var l in a){var i=a[l];void 0!==i&&(e.setAttribute(l,i),"data-old-value"===l&&["2","100","24","202","333","116"].indexOf(t)<=-1&&(["TAX","DISCOUNT"].indexOf(e.getAttribute("data-colname"))>-1&&""===i?(e.value=0,e.setAttribute("value",0)):(e.value=i,e.setAttribute("value",i))))}},crmTemplate.setFieldSpecDomAttr=function(e,t,a){switch(t.uitype){case"100":case"2":e.innerHTML=Handlebars.templates.crmCreateFieldContent(t);break;case"133":if(null===(r=e.nextSibling))return;if((l=r.parentNode.getElementsByTagName("img")).length>0)i=(i=l[0].getAttribute("data-label")).substring(0,i.lastIndexOf("_")+1)+a,l[0].setAttribute("data-label",i),l[0].id=i+"_img",l[1].id=i+"_img",l[2].id=i+"_loadimg";"BOOKID"===t.colname&&(e.setAttribute("readonly","true"),e.style.display="none");break;case"221":var r,l,i;if(null===(r=e.nextSibling))return;if((l=r.parentNode.getElementsByTagName("img")).length>0)i=(i=l[0].getAttribute("data-label")).substring(0,i.lastIndexOf("_")+1)+a,l[0].setAttribute("data-label",i),l[0].id=i+"_img",l[1].id=i+"_loadimg";e.parentNode.id="cruxcomponent_"+t.attrObj.id;break;case"301":e.checked="true"===e.value;break;case"333":var s=e.parentElement.getElementsByTagName("input")[1];crmTemplate.fillDataOrAttrVals(s,t.uitype,t.timeAttrObj),crmTemplate.fillDataOrAttrVals(s,t.uitype,t.timeDataObj);case"24":case"202":e.getAttribute("data-old-value")||(e.setAttribute("value",""),e.setAttribute("oldvalue",""));break;case"116":e.setAttribute("value",t.defaultvalue)}},crmTemplate.createSubFormAggr=function(e,t,a,r,l){if(0!=e.length){subFormTabId=r.subFormTabId,layout=r.layout;var i=document.createElement("table");$(i).attr("class",1==r.gentype&&Crm.isInventoryModule(a)?"aggFldTabl lineItemAggFldTabl fR mT10 crm-font-bold":"aggFldTabl fR mT10 crm-font-bold").attr("cellspacing","0");for(var s=0;s<e.length;s++){var n=e[s];if(500!=n.uitype){t.currentField=n;var o=document.createElement("tr"),d=document.createElement("td");$(d).addClass("alignRight p5 pT10 pB7 pR15"),d.appendChild(crmTemplate.createFieldLabel(t)),o.appendChild(d);var c=crmTemplate.createSubFormFieldRow(layout,a,"",t,subFormTabId,!0);if("TAX"===t.currentField.colname){var u=document.createElement("input");u.setAttribute("class","recordTaxDet"),u.setAttribute("id","recordTaxDet"),u.setAttribute("type","hidden"),c.append(u)}if("DISCOUNT_TYPE"!==n.colname&&"DISCOUNT_PERCENTAGE"!==n.colname||$(o).hide(),$(c).addClass("alignRight crm-small-font-size pL15 pB0"),"117"!==n.uitype&&"116"!==n.uitype||$(o).addClass("aggReadOnlyFld"),$(o).attr("id",a+"_fldRow_"+n.colname),o.appendChild(c),-1!==["117","116"].indexOf(n.uitype)&&"currency"===t.currentField.formulaType||"36"===n.uitype){var m;m=window[a].currencyDetails&&window[a].defaultCurrency?window[a].currencyDetails[window[a].defaultCurrency].symbol:window[a].currencyDetails&&window[a].currencyDetails[Crm.userDetails.BASE_CURRENCY]?window[a].currencyDetails[Crm.userDetails.BASE_CURRENCY].symbol:Crm.userDetails.CURRENCY_DETAILS&&Crm.userDetails.BASE_CURRENCY?Crm.userDetails.CURRENCY_DETAILS[Crm.userDetails.BASE_CURRENCY].symbol:Crm.userDetails.defaultOrgCurrency?Crm.userDetails.defaultOrgCurrency:"";var p,f=$(o);(p=l?f.find("#currencySymbol_Crm_"+a+"_"+n.suffixIndex+"_"+n.colname):f.find("#currencySymbol_Crm_"+a+"_"+n.colname)).length&&(p.text("("+m+") "),l?f.find("#Crm_"+a+"_"+n.suffixIndex+"_"+n.colname+"_label")[0].appendChild(p[0]):f.find("#Crm_"+a+"_"+n.colname+"_label")[0].appendChild(p[0]))}if("117"===n.uitype){var v=$(c).find("input").eq(0),h=v.val();v.val(h.replace(/,/g,""))}i.appendChild(o)}}return i}},crmTemplate.getCssClass=function(e,t){var a="";return"3"===e.uitype||"110"===e.uitype?a="subFrmMulLinFld descFld ":"36"===e.uitype||"143"===e.uitype||"144"===e.uitype||"145"===e.uitype||"117"===e.uitype?a="subFrmCurncyFld descFld ":"32"===e.uitype?a="subFrmNumbFld textFld ":"24"===e.uitype||"202"===e.uitype?a="subFrmDateFld textFld ":"2"===e.uitype?a="subFrmSelFld textFld ":"133"===e.uitype?a="subFrmLookupFld textFld ":"333"===e.uitype?a="subFrmDateAndTimeFld textFld ":"38"===e.uitype?a="subFrmPrecentFld textFld":"116"===e.uitype?a="subFrmFormulaFld textFld":"34"===e.uitype?a="subFrmDecimalFld textFld":"52"===e.uitype?a="SERIAL_NUMBER"===e.colname?"subFrmSnFld textFld":"subFrmLongIntFld textFld":"100"===e.uitype?a="subFrmMulSelFld textFld ":"301"===e.uitype&&(a="subFrmCheckBFld textFld "),"11"===e.uitype||"37"===e.uitype||"27"===e.uitype||"25"===e.uitype||"35"===e.uitype||"21"===e.uitype||"1"===e.uitype||"127"===e.uitype||"33"===e.uitype||"22"===e.uitype?a="subFrmTxtFld textFld "+t.className:"47"===e.uitype?a="subFrmLineTaxFld textFld "+t.className:"555"===e.uitype?a="subFrmFileUploadFld"+t.className:"221"===e.uitype?a="subFrmUserLookupFld textFld ":a+=t.className,a},crmTemplate.getFieldTypes=function(e,t,a){for(var r=[],l=0;l<e.length;l++)("208"!==e[l].uitype||"208"===e[l].uitype&&"create"!==window[t].currentStatus)&&r.push(e[l]);return r},crmTemplate.createSubFormFieldRow=function(e,t,a,r,l,i){var s=r.currentField;window[t]&&window[t].createEditJson&&(window[t].createEditJson.entityMapJson=window[t].createEditJson.entityMapJson||{},window[t].createEditJson.entityMapJson[i?s.colname:l+"_"+s.colname]=s);var n=!0;if(!a){n=!1,a=document.createElement("td");var o=crmTemplate.getCssClass(s,a);switch(a.className=o,s.colname){case"PRODUCTID":a.className=a.className+" pli_productNameCtn";break;case"TOTAL":a.className=a.className+" pli_amountCtn";break;case"NETTOTAL":a.className=a.className+" pli_totalCtn";break;case"QUANTITY":a.className=a.className+" pli_quantityCtn"}}if("true"===s.readonly&&"SERIAL_NUMBER"!==s.colname&&s.uitype!==CrmField.UITYPES.FILE_UPLOAD){$(a).on("mouseover",(function(){renderingUtils.zctt.showtt(I18n.getMsg("crm.lable.read.only"))})),$(a).on("mouseout",(function(){$("#tooltip-zc").hide(),renderingUtils.zctt.hidett()}))}crmTemplate.createSubformFieldContent(r,a,l,i,n);var d="#Crm_"+t+"_"+s.colname+"_label";8==s.uitype?"true"==s.readonly&&s.readonly||$(a).on("click",(function(){if($(this).find("[name='ownerNameLookup']").find(event.srcElement)==[]){var e="Crm_"+t+"_"+s.colname;Search.showLookup(e),sE()}})):$(a).find("select").length?$(a).hasClass("readonlyF")||$(a).on("click",(function(e){var a=renderingUtils.getTargetElem(e);if(!$(a).is("input")&&!$(a).is("textarea")){var r=s.attrObj?"#"+s.attrObj.id:"#Crm_"+t+"_"+s.colname;"FIRSTNAME"===s.colname&&(r+="_SALUTATION");var l=$(renderingUtils.getTargetElem(e));$(l).parent("[class^=chosen]").length||$(l).parent("[class^=select2]").length||$(l).filter("[class^=chosen]").length||$(l).filter("[class^=select2]").length||(0==$(d).find("select").length&&($("body").trigger("click"),sE()),$(r).select2("open"))}})):$(a).on("click",(function(){var e="#Crm_"+t+"_"+s.colname;r.elementSufixId&&(e+=r.elementSufixId),$(a).find(e).focus()})),$(a).find(".newCustSel").each((function(){if(0==$(this).find(".newCustSelVal").length){var e=$(this).find("select option:selected").text();$(this).append("<span class='newCustSelVal'></span>"),$(this).children(".newCustSelVal").html("<span class='pR7 crm-font-regular'>"+e+"</span> <strong class='mT7 dIB tb_downarrow'></strong>"),$(this).change((function(){var e=$(this),t=e.find("select option:selected").text();e.children(".newCustSelVal").html("<span class='pR7 crm-font-regular'>"+t+"</span> <strong class='mT7 dIB tb_downarrow'></strong>")}))}}));var c=s.subformdisplaylabel,u="PRODUCTID"===s.colname&&Crm.isLineItemSubFormModule(c)?$(a).find(".productIdFld"):$(a).find("input");if(u.length>0&&u.each((function(e,t){commonUtils.cleanWhitespace(t)})),Crm.isLineItemSubFormModule(c)||i&&Crm.isInventoryModule(t))switch(s.colname){case"DISCOUNT":case"TAX":u.css("width","inherit").addClass("cal_rate_maintain");var m=$(a).find(".cal_rate_maintain");m.attr({placeholder:"",readonly:"readonly"}),m.css({display:"inline-block"});case"LISTPRICE":$(a).addClass("lineIconWidth");break;case"TOTALAFTERDISCOUNT":u.off("change").on("change",(function(){var e=$(this),t=e.closest("tr"),a=t.data("data-rowid"),r=e.val();r=parseFloat(""===r?0:r);var l=$(productDetails.sfFldIdSuffix+"TAX_"+a),i=($(productDetails.sfFldIdSuffix+"NETTOTAL_"+a),""===l.val()?0:l.val()),s=l.attr("percentage");s=parseFloat(void 0===s||0===s.length||isNaN(s)?0:s);var n=e.attr("temp-value");parseFloat(void 0!==n&&n.length>0?n:0)!==r&&(i=s*r/100),i=void 0===i?0:i,i=productDetails.getRoundOff(l,parseFloat(i)),l.val(i.toString()).trigger("change"),l.val(i.toString()),e.attr("temp-value",r),productDetails.taxCalcTriggerSFLineItem(t)}));case"DISCOUNT_PERCENTAGE":case"DISCOUNT_TYPE":case"LINETAX":a.style.display="none";break;case"TOTAL":u.off("change").on("change",(function(){var e=$(this),t=e.closest("tr"),a=t.data("data-rowid"),r=e.val();r=parseFloat(""===r?0:r);var l=$(productDetails.sfFldIdSuffix+"DISCOUNT_"+a);if(Crm.userDetails.isDiscountFieldEnhancementMigrationCompleted)var i=$(productDetails.sfFldIdSuffix+"DISCOUNT_TYPE_"+a),s=$(productDetails.sfFldIdSuffix+"DISCOUNT_PERCENTAGE_"+a);var n=$(productDetails.sfFldIdSuffix+"TOTALAFTERDISCOUNT_"+a),o=""===l.val()?0:l.val(),d=Crm.userDetails.isDiscountFieldEnhancementMigrationCompleted?s.val():l.attr("percentage");d=parseFloat(void 0===d||0===d.length||isNaN(d)?0:d);var c=e.attr("temp-value"),u=parseFloat(void 0===c||0===c.length||isNaN(c)?0:c),m=Crm.userDetails.isDiscountFieldEnhancementMigrationCompleted?"Direct Price"!==productDetails.getDiscountTypeSystemValueForUserValue(i):"dirPrice"!==l.attr("discType");if(u!==r&&m&&(o=d*r/100),o=void 0===o?0:o,l.val(parseFloat(productDetails.getRoundOff(l,parseFloat(o))).toString()).trigger("change"),n.val(productDetails.getRoundOff(n,parseFloat(r)-parseFloat(o)).toString()),e.attr("temp-value",r),n.length<1){var p=$(productDetails.sfFldIdSuffix+"TAX_"+a),f=""===p.val()?0:p.val(),v=p.attr("percentage");v=parseFloat(void 0===v||0===v.length||isNaN(v)?0:v),u!==r&&(f=v*r/100),f=void 0===f?0:f,f=productDetails.getRoundOff(p,parseFloat(f)),p.val(f.toString()).trigger("change"),p.val(f.toString())}productDetails.taxCalcTriggerSFLineItem(t),u!==r&&window[productDetails.module].formulaObj.handlePriceBookLineItemUpdate(a)}));break;case"BOOKID":$(a).find("img").addClass("hide"),u.each((function(e,t){"BOOKID"===t.getAttribute("data-colname")&&(t.setAttribute("readonly","true"),t.style.display="none")}));break;case"PRODUCTID":u.addClass("textField"),u.on("mouseover",(function(){productDetails.showPrdToolTipSFLineItem(this)})),u.on("mouseout",(function(){renderingUtils.zctt.hidett()}))}return window[t].formulaObj.fieldVsFormulaMap["${"+s.subformdisplaylabel+"."+s.label+"}"]&&$(a).find("select,input,textarea").on("change",{self:window[t].formulaObj},window[t].formulaObj.executeRespectiveFormula),window[t].formulaObj.fieldVsAggrMap["${"+s.subformdisplaylabel+"."+s.label+"}"]&&$(a).find("input").on("change",{self:window[t].formulaObj},window[t].formulaObj.executeRespectiveAggr),a},crmTemplate.checkAndAddSubformTabId=function(e,t){if(void 0!==Crm.userDetails.MODULE_LIST[e])if(crmTab.tabVsSubTabs){var a=crmTab.tabVsSubTabs[e];if(a&&a!=t){var r=!1;for(i=0;i<a.length;i++)a[i]==t&&(r=!0);r||a.push(t)}else crmTab.tabVsSubTabs[e]=[t]}else{var l={module:[t]};crmTab.tabVsSubTabs=l}},crmTemplate.calculatorOperation=function(e,t,a){var r=$(e),l=r.parent().find(".resultValue"),i=t.which?t.which:t.keyCode,s=r.val(),n=!1;if((event.ctrlKey||event.metaKey)&&(n=!0),"keypress"===t.type){if(!([43,45,42,47,13,40,41,46,8,9,97,118,99].indexOf(i)>-1||i>=48&&i<=57))return t.preventDefault(),!1;if(13===i)return r.trigger("blur"),t.preventDefault(),!1;if(-1!==[97,99,118].indexOf(i)&&!n)return t.preventDefault(),!1}else if("keyup"===t.type){if(crmTemplate.calculationProcessArea(r),a&&!(s.split(".").length<=2&&"."===t.key||s.split(".").length>0&&"0"===t.key)){if(s=crmTemplate.memberDataStoreLI,""!==l.attr("data-valueRes"))(o=l.attr("data-valueRes"))&&s&&(!0===crmTemplate.setPreviousValueToContainer&&r.attr("data-finalValue",s+" = "+o),r.val(o),l.attr("data-valueRes","").addClass("vH"));else crmTemplate.calculatorProcessingOrder=[];crmTemplate.memberDataStoreLI=""}}else if(!a&&"blur"===t.type){var o;if(s=crmTemplate.memberDataStoreLI,""!==l.attr("data-valueRes"))(o=l.attr("data-valueRes"))&&s&&(!0===crmTemplate.setPreviousValueToContainer&&r.attr("data-finalValue",s+" = "+o),r.val(o),r.trigger("change"),CScriptLib&&(CScript.Engine.Global.dispatchEvent("onChange",void 0,r.attr("data-sysrefname")),CScript.Engine.Global.dispatchEvent("onChange",r.attr("data-fieldid"),o)),l.attr("data-valueRes","").addClass("vH"));else crmTemplate.calculatorProcessingOrder=[];crmTemplate.memberDataStoreLI=""}},crmTemplate.calculationProcessArea=function(e){var t=e,a=t.parent().find(".resultValue"),r=t.val(),l=t.attr("data-decimal-length"),i=r=r.replace(/ /g,""),s="";if(-1===i.indexOf(","))if(""===i||i.match(/[a-z]/i))crmTemplate.memberDataStoreLI="",a.addClass("vH"),a.attr("data-valueRes",s);else{var n=crmTemplate.checkBrackets(i);if(/^(\+|\*|\/)/.test(i)&&(i=i.substr(1)),""===r&&a.text(s),""!==i){var o=/^((?!([+\-*/.]{2,})).)*$/.test(i);if(o){if("0"==i)s="0";else if(!0===n){if(-1===i.indexOf("()")){var d=i.length-1;if(crmTemplate.checkCorrectInputEle(i))crmTemplate.checkDotCorrectInput(i)&&(-1===["+","-","*","/","."].indexOf(i[d])||"."!==(i=i.slice(0,-1)))&&(i=crmTemplate.clearLeadingZero(i),(s=new Function("return "+i)())%1!=0&&(s=void 0!==l?Number(Math.round(s+"e"+l)+"e-"+l):Math.round(100*s)/100)),crmTemplate.setPreviousValueToContainer=!0,crmTemplate.memberDataStoreLI=i}}else s=a.text();""===t.val()&&(s="",a.addClass("vH")),a.text(s),a.attr("data-valueRes",s)}!0===/[+\-*/(]/.test(r)&&n&&!0===o&&"+"!==i&&""!==i&&""!==s?a.removeClass("vH"):a.addClass("vH")}else crmTemplate.memberDataStoreLI="",a.addClass("vH")}else crmTemplate.memberDataStoreLI=""},crmTemplate.clearLeadingZero=function(e){for(var t,a=/[\d\.]+/gm;null!==(t=a.exec(e));)-1==(t=t.toString()).indexOf(".")&&null!=t.match(/(^0{1,}(?!($|\.)))/g)&&(e=e.replace(t,t.replace(/(^0{1,}(?!($|\.)))/g,"")));return e},crmTemplate.checkDotCorrectInput=function(e){for(var t=e.split(/[+\-*/,]+/),a=t.length,r=0;r<a;r++){if(t[r].split(".").length>2)return!1}return!0},crmTemplate.checkCorrectInputEle=function(e){for(var t=e.split(""),a=/\d/,r=["(",")"],l=["+","-","*","/"],i=["/","*"],s=t.length,n=0;n<s;n++){var o=t[n];if(-1!==r.indexOf(o)){var d=n-1,c=n+1;if("("===o){if(void 0!==t[d]&&(a.test(t[d])||")"===t[d]||"."===t[d]))return!1;if(void 0!==t[c]&&-1!==i.indexOf(t[c]))return!1}else if(")"===o){if(void 0!==t[c]&&(a.test(t[c])||"."===t[c]||"("===t[d]))return!1;if(void 0!==t[d]&&(-1!==l.indexOf(t[d])||"."===t[d]))return!1}}}return!0},crmTemplate.checkBrackets=function(e){var t=0;for(var a in e)if("("==e[a]?t++:")"==e[a]&&t--,t<0)return!1;return!(t>0)},crmTemplate.setMxNCloneValues=function(e,t){var a=$("#"+e);$("#temp_"+e).html("<div><span style='top: 15px;' class='vaM  dIB crmGreenFilledTick pA '/><span class='crm-base-font-size pL25 dIB crmBaseColor'>"+I18n.getMsg("crm.field.mxn.clone.scheduler.confirm.msg",t)+"</span></div>"),a.data("mandate","false")},crmTemplate.removeMxNCloneValues=function(e){var t=$("#"+e);t.data("selectedid","").data("mandate","false"),t.parent().find("img").css("opacity",""),t.parent().find("input").css("opacity",""),t.val(""),$("#temp_"+e).remove(),$("#templabel_"+e).remove(),$(evt).parent().removeClass("mxnclonedisabled")},crmTemplate.showCalculatorInfo=function(e){var t=$(e).parents(".labelValCreate").find(".textField"),a=$(".calculaterInfo .calculatedValue");0===t.length&&(t=$(e).closest("td").find(".textField"));var r=t.attr("data-finalValue"),l=t,i=$(e).parents("td.labelVal, .labelValCreate,.detailViewContainer .labelValTwo, td"),s=i.offset(),n=s.left,o=i.outerWidth(),d=s.top+i.outerHeight(),c=$(".calculaterInfo"),u=c.outerHeight()+10,m=c.outerWidth();if(crmTemplate.checkDropDown(i,u,d)?(d=d-c.outerHeight()-i.outerHeight(),c.removeClass("arrowMoveright arrowMoveLeft").addClass("arrowMoveBottom")):c.removeClass("arrowMoveBottom arrowMoveLeft").addClass("arrowMoveright"),r&&""!==t.val()){var p=r.split("="),f=p[0];a.html('<div class=""><a href="javascript:;" id="calc_link">'+f.trim()+" = "+p[1].trim()+"</a></div>"),$("#calc_link").click((function(){crmTemplate.getCalcFinalValueTo(l,f)}))}else a.html('<div class="crmBaseColor crm-small-font-size">'+I18n.getMsg("crm.createfield.calcinfo.new")+"</div>");Crm.userDetails.RTL_ENABLED?c.removeClass("arrowMoveright").addClass("arrowMoveLeft"):n=n+o-m,c.css({top:d,left:n,display:"block"})},crmTemplate.getCalcFinalValueTo=function(e,t){e.val(t.trim()).focus(),crmTemplate.calculationProcessArea(e)},crmTemplate.checkDropDown=function(e,t){return e>renderingUtils.windowHeight-t+$L(window).scrollTop()},crmTemplate.applyFocusElementTD=function(e){(e=$(e)).closest("td").addClass("wf_setFocus")},crmTemplate.removeFocusElementTD=function(e){(e=$(e)).closest("td").removeClass("wf_setFocus")},crmTemplate.applyFocusInputBox=function(e,t){e=$(e);"focus"===t.type?(e.closest(".focusEleFielEnable").addClass("focusEleFieldNewUI"),sE(t)):e.closest(".focusEleFielEnable").removeClass("focusEleFieldNewUI")},crmTemplate.unsubsProceed=function(e){var t=$(e).data("id");$(".multipleFieldsEditPop").is(":visible")||renderingUtils.removeFreezeLayer(),$("#"+t).prop("checked",!1),$("#unsubscripeEmails").remove()},crmTemplate.unsubsCancel=function(e){var t=$(e).data("id");$(".multipleFieldsEditPop").is(":visible")||renderingUtils.removeFreezeLayer(),$("#"+t).prop("checked",!0),$("#unsubscripeEmails").remove()},crmTemplate.setRelatedTo=function(e){var t=$(e).children("option:selected").val(),a=$(e).closest(".lookupWithprefix").find(".lookup_hIconO");if(t){var r=$("#Crm_Appointments_SEID_RELATEDTO"),l=$("#Crm_Appointments_SEID_RELATEDTO_img"),i=$("#Crm_Appointments_SEID option"),s=$("#Crm_Appointments_SEID");r[0]&&(r[0].value="",r.data().lookupModule=t,l.data().lookupModule=t,"Contacts"===t?l.removeClass("newSearchIcon lookup").addClass("Contacts-small"):t.startsWith("CustomModule")&&l.removeClass("Contacts-small").addClass("newSearchIcon lookup"))}s.on("select2:close",(function(){setTimeout((function(){r.focus(),i.attr("data-modulename-disabled","")}),50)})),"Contacts"==t?(a.removeClass("Accounts-small"),a.addClass("Contacts-small")):"Accounts"==t&&(a.removeClass("Contacts-small"),a.addClass("Accounts-small"))};var fileupload={module:"",fieldID:"",uploadedFileObject:[],masterRecordId:"",attachMap:{},masterAttachIdList:{},masterAttachedCountList:{},masterAttachedSizeList:{},mergeCountVariable:0,removedAttachmentIds:[],subformRemovedAttachmentIds:[],subformRemovedAttachmentFieldIds:[],subformRemovedAttachmentRowNumber:[],createObj:{},editObj:{},fromFileUploadField:!1,isDraftRecord:"",uploadIdVsEncryptedId:{},draftRecord:{},draftDatas:{},uploadDeleteObject:{},rowNum:"",subformApiName:"",isSubformField:!1,createAttachElement:function(e,t,a){var r,l=0,i=null,s=[],n=$L("#AjaxEditComponent"),o=document.querySelector(".currentFileUploadField");null!==o&&fileupload.isSubformField&&(fileupload.rowNum="_"+(o.parentElement.component.data.indexVal+1));if(a){var d=$("crm-canvas-form"),c=$(".dummyfileupload");if(d.length&&c.length){var u=d[0].component.data.record,m=c[0].component.data.cxPropField;m.api_name;var p,f,v=u[m.api_name]?Array.from(u[m.api_name]):[];if(e.fromFileUpload){f=e.fromFileUpload.length;for(var h=0;h<f;h++)p=e.fromFileUpload[h].encryptedUploadId,v.push({file_id:p})}else if(e.uploadedDetails){f=e.uploadedDetails.length;for(h=0;h<f;h++)p=e.uploadedDetails[h].encryptedUploadId,v.push({file_id:p})}if("FieldAttachmentsTeamDrive"===t&&e.resources&&e.resources.length){f=e.resources.length;for(h=0;h<f;h++)p=e.resources[h].encryptedUploadId,v.push({file_id:p})}u.$.set(m.api_name,v)}c[0]&&c[0].classList.remove("dummyfileupload")}fileupload.isSubformField?(fileupload.rowNum=fileupload.rowNum?fileupload.rowNum:"",fileupload.subformApiName=fileupload.subformApiName?fileupload.subformApiName+"_":""):(fileupload.rowNum="",fileupload.subformApiName="");var g=e.fieldId+(fileupload.rowNum?fileupload.rowNum:"");if(Lyte.registeredMixins["crm-uploadfields-mixin"].setUploadDetailInRecordCrux(e),"DESKTOPATTACHMENTS"===t){i=e.fieldId;for(var T=0,C=JSON.stringify(e),b=JSON.parse(C),_=(G="object"==typeof b.uploadedDetails?b.uploadedDetails:JSON.parse(b.uploadedDetails)).length,y=0;y<_;y++){var I="",E=G[y].uploadid,D=G[y].encryptedUploadId,F="object"==typeof G[y].uploadeddetails?G[y].uploadeddetails:JSON.parse(G[y].uploadeddetails),S=fileupload.formatBytes(F["content-length"],2),w=(te=F.filename.split("."))[te.length-1],R='<span class="mL5 mR25 op5 vaM zcicn-cssIcons zcicncss-download zcicncss16 cP cNdownloadOption"><a id="downloadlink" class="p0 m0 w100_per h100_per dIB" href="'+G[y].download_Url+'" style="cursor: pointer"></a></span>';w=w.toLowerCase();var A="fileupload.removeFileCreate('"+F.resourceId+"','','create','"+E+"','"+i+"','"+fileupload.isSubformField+"','"+fileupload.rowNum+"')";if(a)var L='<a class="crm-font-regular oH tOE wsNowrap vaBottom dIB zcnoprop PreviewImage cPP" rel="noopener noreferrer" target="_blank" href="'+G[y].preview_Url+'">'+$ESAPI.encoder().encodeForHTML(F.filename)+"</a>";else L='<a class="PreviewImage oH tOE wsNowrap vaBottom dIB uploadText cP" rel="noopener noreferrer" target="_blank" href="'+G[y].preview_Url+'">'+$ESAPI.encoder().encodeForHTML(F.filename)+"</a>";var N="fileIconDefault";N=showImageType(w),I+=a?'<li id ="upload_'+E+'"  class="oH p0 m0 mT5 fileUploadLi"> <div class="dIF zcanvas_fileupload_name fg1"> <span class="mR5 fShrink0 zcanvas_fileupload_icon '+N+' svgIconsImg"></span> <span class="dIF crm-small-font-size crmNotFoundColor pR uploadTextSpan">'+L+'</span> </div><div class="dIF jcFlextEnd pR mL20 fShrink0"> <span class="dIB crm-extra-small-font-size crmParagraphColor pR25" id="fileSize_'+E+'">'+S+"</span>"+R+'<div class="top2 right0 svgIconBoxFileUpload pA cP dIB"><span class="cP closeIcon dN" onclick="'+A+'"></span><span class="cNsuccessLogo svgIcons dIB"></span></div></div>':'<li id="upload_'+E+'" class="oH fileUploadLi p0 m0 mT5"> <div class="dIB fL"> <span class="dIB vaT mR5 mT1 '+N+' svgIconsImg"></span> <span class="dIB crm-small-font-size crmNotFoundColor pR uploadTextSpan">'+L+'<span></span></span> </div><div class="dIB fR pR mL20"> <span class="dIB crm-extra-small-font-size color_ccc" id="fileSize_'+E+'">'+S+"</span>"+R+'<div class="pA svgIconBoxFileUpload top2 right0 cP dIB"><span class="cP closeIcon dN" onclick="'+A+'"></span><span class="cNsuccessLogo svgIcons dIB"></span></div></div>',this.uploadedFileObject.push({fieldId:i,fileName:F.filename,fileID:F.resourceId,fromService:"DesktopAttachments",linkToDocs:!1,fromGoogleDocs:!1,uploadId:E,fileSize:F["content-length"],encryptedUploadId:D,isSubformField:fileupload.isSubformField,download_Url:G[y].download_Url,preview_Url:G[y].preview_Url,is_Preview_Available:G[y].is_Preview_Available,mode:G[y].mode,extn:G[y].extn,link_Docs:G[y].link_Docs,readableFileSize:S,rowNum:fileupload.rowNum.substring(fileupload.rowNum.indexOf("_")+1)}),void 0===this.uploadDeleteObject[g]?(s.push({file_id:D}),this.uploadDeleteObject[g]=s):this.uploadDeleteObject[g].push({file_id:D}),this.uploadIdVsEncryptedId[D]=E,l=parseInt(l)+parseInt(F["content-length"]),T++,$("#cNFileUploadedListView_"+g).removeClass("dN");var k="#cNFileUploadedListView_"+g+" ul";$(k).append(I)}var O=$("#attachSize_"+g),M=$("#attachCount_"+g);""==(ne=O.val())&&(ne=0),l=parseInt(ne)+parseInt(l);var U=M.val(),x=parseInt(U)+parseInt(T);M.val(x),(x>=(de=(oe=$("[data-fieldid="+i+"]")).attr("data-maxlength"))||l>=20971520)&&(fileupload.isSubformField?(crmTemplate.serialNumberHeightAdjustForSubform(fileupload.elementClass),$("."+fileupload.elementClass).addClass("disabled")):$("[data-fieldid="+i+"]").addClass("disabled")),O.val(l)}else if("FieldAttachmentsTeamDrive"===t){i=e.fieldId;var P=e.resources,H=P.length,B=$("#attachCount_"+g);U=B.val(),x=parseInt(U)+parseInt(H);if(!(de=(oe=$("[data-fieldid="+i+"]")).attr("data-maxlength"))&&"crm.tab.module.entity.canvas"===Lyte.Router.getRouteInstance().transition.info.route&&n.length>0)de=(he=n.find("crm-file-upload")[0].component).data.cxPropField.length;if(x>de)return B.val(U),renderingUtils.showCustomAlert(I18n.getMsg("crm.attachment.fileUploadField.Maxcount.check")),!1;for(T=0,y=0;y<H;y++){var V=e.fieldId,j=(E="teamdriveFieldId",D=P[y].encryptedUploadId,A="fileupload.removeFileCreate('"+P[y].link+"','','create','"+E+"','"+V+"','"+fileupload.isSubformField+"','"+fileupload.rowNum+"')",I="",$ESAPI.encoder().encodeForHTML(P[y].fileName));if(a)L='<a class="crm-font-regular oH tOE wsNowrap vaBottom dIB zcnoprop PreviewImage cP" title="'+j+'" href="'+P[y].link+'" rel="noopener noreferrer" target="_blank" >'+j+"</a>";else L='<a class="PreviewImage oH tOE wsNowrap vaBottom dIB uploadText cP" title="'+j+'" href="'+P[y].link+'" rel="noopener noreferrer" target="_blank" >'+j+"</a>";var Y='<span class="cNsuccessLogo svgIcons dIB"></span>';N="svgIcons ico-teamDrive";I+=a?'<li id ="upload_'+E+'"  class="oH p0 m0 mT5 fileUploadLi"> <div class="dIF zcanvas_fileupload_name fg1"> <span class="mR5 fShrink0 zcanvas_fileupload_icon '+N+' svgIconsImg"></span> <span class="dIF crm-small-font-size crmNotFoundColor pR uploadTextSpan">'+L+'</span> </div><div class="dIF jcFlextEnd pR mL20 fShrink0"> <div class="top2 right0 svgIconBoxFileUpload pA cP dIB"><span class="cP closeIcon dN" onclick="'+A+'"></span>'+Y+"</div></div>":'<li id ="upload_'+E+'"  class="oH p0 m0 mT5 fileUploadLi"> <div class="dIB fL"> <span class="dIB vaT mR5 mT1 '+N+' svgIconsImg"></span> <span class="dIB crm-small-font-size crmNotFoundColor pR uploadTextSpan">'+L+'<span></span></span> </div><div class="dIB fR pR mL20"><div class="top2 right0 svgIconBoxFileUpload pA cP dIB"><span class="cP closeIcon dN" onclick="'+A+'"></span>'+Y+"</div></div>",this.uploadedFileObject.push({fieldId:V,fileName:P[y].fileName,fileID:P[y].link,fromService:"teamdrive",linkToDocs:!1,fromGoogleDocs:!1,uploadId:E,fileSize:"0",encryptedUploadId:D,isSubformField:fileupload.isSubformField,rowNum:fileupload.rowNum.substring(fileupload.rowNum.indexOf("_")+1)}),void 0===this.uploadDeleteObject[g]?(s.push({file_id:P[y].encryptedUploadId}),this.uploadDeleteObject[g]=s):this.uploadDeleteObject[g].push({file_id:P[y].encryptedUploadId}),this.uploadIdVsEncryptedId[D]=E,T++,$("#cNFileUploadedListView_"+g).removeClass("dN"),$("#cNFileUploadedListView_"+g+" ul").append(I)}Crm.trackSpotLightAction("Workdrive Files Attached",{Place:"file upload field",Count:T});var z=$("#attachSize_"+g);""==(ne=z.val())&&(ne=0),l=parseInt(ne)+parseInt(l),B.val(x),(x>=de||l>=20971520)&&(fileupload.isSubformField?(crmTemplate.serialNumberHeightAdjustForSubform(fileupload.elementClass),$("."+fileupload.elementClass).addClass("disabled")):oe.addClass("disabled")),z.val(l)}else{i=null,T=0;var W=e.fromFileUpload.length;for(h=0;h<W;h++){var G,q=JSON.stringify(e.fromFileUpload[h]),J=(E=(G=JSON.parse(q)).uploadid,D=G.encryptedUploadId,"object"==typeof G.uploadedValues?G.uploadedValues:JSON.parse(G.uploadedValues)),K=J.resourceId;g=(i=J.FieldId)+(fileupload.rowNum?fileupload.rowNum:"");var X=$("#cNFileUploadedListView_"+i+fileupload.rowNum).parent().parent(),Q=X.parent(),Z="cNdropFilesId"===X.attr("id")?X:Q,ee=Z.find(".errorMsgDesc");0!=ee.length&&(ee.remove(),Z.parent().removeClass("errorFieldP"),r=!0);var te,ae=Q,re="cNdropFilesId"===ae.attr("id")?ae.next().next():X.next().next().next(),le=re.next();if(re.hasClass("errorMsgDesc")){re.remove();var ie=(Q=ae.parent()).parent();Q.hasClass("errorFieldP")?(Q.removeClass("errorFieldP form_err_fld"),r=!0):ie.hasClass("errorFieldP")&&(ie.removeClass("errorFieldP form_err_fld"),r=!0)}else if(le.hasClass("errorMsgDesc")){le.remove(),(Q=ae.parent()).hasClass("errorFieldP")&&(Q.removeClass("errorFieldP form_err_fld"),r=!0)}else if(X.next().hasClass("errorMsgDesc")&&(!Lyte.registeredMixins["crm-create-init-mixin"].checkLyteConvertionSupport(fileupload.module)||"true"===fileupload.isSubformField.toString())){X.next().remove();var se=X.parents().find(".noBorderStyleFileUp");se.hasClass("errorFieldP")&&(se.removeClass("errorFieldP form_err_fld"),r=!0)}w=(w=(te=J.fileName.split("."))[te.length-1]).toLowerCase();A="fileupload.removeFileCreate('"+K+"','','create','"+E+"','"+i+"','"+fileupload.isSubformField+"','"+fileupload.rowNum+"')",I="";if(a)L='<a class="crm-font-regular oH tOE wsNowrap vaBottom dIB zcnoprop PreviewImage cP" rel="noopener noreferrer" target="_blank" href="'+J.preview_Url+'">'+J.fileName+"</a>";else L='<a class="PreviewImage oH tOE wsNowrap vaBottom dIB uploadText cP" rel="noopener noreferrer" target="_blank" href="'+J.preview_Url+'">'+J.fileName+"</a>";R='<span class="mL5 mR25 op5 vaM zcicn-cssIcons zcicncss-download zcicncss16 cP cNdownloadOption"><a id="downloadlink" class="p0 m0 w100_per h100_per dIB" href="'+J.download_Url+'" style="cursor: pointer"></a></span>',Y='<span class="cNsuccessLogo svgIcons dIB"></span>',S=fileupload.formatBytes(J.streamsize,2),N="fileIconDefault";N=showImageType(w),I+=a?'<li id ="upload_'+E+'"  class="oH p0 m0 mT5 fileUploadLi"> <div class="dIF zcanvas_fileupload_name fg1"> <span class="mR5 fShrink0 zcanvas_fileupload_icon '+N+' svgIconsImg"></span> <span class="dIF crm-small-font-size crmNotFoundColor pR uploadTextSpan">'+L+'</span> </div><div class="dIF jcFlextEnd pR mL20 fShrink0"> <span class="dIB crm-extra-small-font-size crmParagraphColor pR25" id="fileSize_'+E+'">'+J.readableFileSize+"</span>"+R+'<div class="top2 right0 svgIconBoxFileUpload pA cP dIB"><span class="cP closeIcon dN" onclick="'+A+'"></span>'+Y+"</div></div>":'<li id ="upload_'+E+'"  class="oH p0 m0 mT5 fileUploadLi"> <div class="dIB fL"> <span class="dIB vaT mR5 mT1 '+N+' svgIconsImg"></span> <span class="dIB crm-small-font-size crmNotFoundColor pR uploadTextSpan">'+L+'<span></span></span></div><div class="dIB fR pR mL20"> <span class="dIB crm-extra-small-font-size crmParagraphColor" id="fileSize_'+E+'">'+J.readableFileSize+"</span>"+R+'<div class="top2 right0 svgIconBoxFileUpload pA cP dIB"><span class="cP closeIcon dN" onclick="'+A+'"></span>'+Y+"</div></div>","OldFlow"===t?this.uploadedFileObject.push({fieldId:i,fileName:J.fileName,fileID:K,fromService:"DesktopAttachments",linkToDocs:!1,fromGoogleDocs:!1,uploadId:E,fileSize:J.streamsize,stream:J.stream,OldFlow:!0,encryptedUploadId:D,isSubformField:fileupload.isSubformField,preview_Url:J.preview_Url,link_Docs:J.link_Docs,download_Url:J.download_Url,readableFileSize:J.readableFileSize,rowNum:fileupload.rowNum.substring(fileupload.rowNum.indexOf("_")+1)}):"CloudPicker"===J.fromService?this.uploadedFileObject.push({fieldId:i,fileName:J.fileName,fileID:K,userId:J.userId,fromService:J.fromService,linkToDocs:J.linkToDocs,fromGoogleDocs:J.fromGoogleDocs,uploadId:E,fileSize:J.streamsize,readableFileSize:J.readableFileSize,$type:J.$type,$file_path:J.$file_path,$cloud_account_id:J.$cloud_account_id,encryptedUploadId:D,preview_Url:J.preview_Url,download_Url:J.download_Url,link_Docs:J.link_Docs,isSubformField:fileupload.isSubformField,rowNum:fileupload.rowNum.substring(fileupload.rowNum.indexOf("_")+1)}):this.uploadedFileObject.push({fieldId:i,fileName:J.fileName,fileID:K,userId:J.userId,fromService:J.fromService,linkToDocs:J.linkToDocs,fromGoogleDocs:J.fromGoogleDocs,uploadId:E,fileSize:J.streamsize,readableFileSize:J.readableFileSize,encryptedUploadId:D,preview_Url:J.preview_Url,download_Url:J.download_Url,link_Docs:J.link_Docs,isSubformField:fileupload.isSubformField,rowNum:fileupload.rowNum.substring(fileupload.rowNum.indexOf("_")+1)}),void 0===this.uploadDeleteObject[g]?(s.push({file_id:D}),this.uploadDeleteObject[g]=s):this.uploadDeleteObject[g].push({file_id:D}),this.uploadIdVsEncryptedId[D]=E,l+=parseInt(J.streamsize),T++,$("#cNFileUploadedListView_"+g).removeClass("dN");k="#cNFileUploadedListView_"+g+" ul";$(k).append(I)}var ne;""==(ne=$("#attachSize_"+g).val())&&(ne=0),l=parseInt(ne)+parseInt(l);var oe,de,ce=$("#attachSize_"+i+fileupload.rowNum),ue=$("#attachCount_"+i+fileupload.rowNum);U=ue.val();((x=parseInt(U)+parseInt(T))>=(de=(oe=$("[data-fieldid="+i+"]")).attr("data-maxlength"))||l>=20971520)&&(fileupload.isSubformField?(crmTemplate.serialNumberHeightAdjustForSubform(fileupload.elementClass),$("."+fileupload.elementClass).addClass("disabled")):$("[data-fieldid="+i+"]").addClass("disabled")),ue.val(x),ce.val(l)}var me=$L("#cNFileUploadedListView_"+i+fileupload.rowNum);if(me.length){var pe=fileupload.isSubformField?me.parents("crm-create-subformfields"):me.parents("crm-create-fields");if(pe.length&&(pe[0].component.executeMethod("setUploadDetails"),r)){var fe=pe[0].querySelector(".errorFieldP");fe&&fe.classList.remove("errorFieldP")}}if(!1===fileupload.uploadedSuccessfully){fileupload.uploadedSuccessfully=!0;var ve=document.querySelector(".lyteUserPopup");ve&&ve.component.updateUserFileUploadField(e,t)}if("crm.tab.module.entity.canvas"===Lyte.Router.getRouteInstance().transition.info.route&&n.length>0){var he,ge=n.find("crm-file-upload")[0];if((he=ge?ge.component:void 0)&&"fileupload"===he.data.cxPropField.data_type){var Te=he.getFileUploadCnt();1!==(Ce=he.getData("cxPropField").length)&&5!==Ce||Te?he.setData("disabled",!1):he.setData("disabled",!0)}}if(a&&((he=c[0]?c[0].component:void 0)&&"fileupload"===he.data.cxPropField.data_type)){var Ce;Te=he.getFileUploadCnt();1!==(Ce=he.getData("cxPropField").length)&&5!==Ce||Te?(he.setData("disabled",!1),c.closest(".zcanvas-field").removeClass("zc_disabledstate")):(he.setData("disabled",!0),c.closest(".zcanvas-field").addClass("zc_disabledstate"),c.find(".cxElementsDisabledIcon").removeClass("cxElementsDisabledIcon"))}},getFileUploadOptionList:function(){var e=[],t=Crm.userDetails.isWorkdriveConfigured;e.push({uservalue:I18n.getMsg("crm.attach.upload.file"),systemvalue:"Upload File"}),featuresAvailable.Attach_Zoho_Docs&&featuresAvailable.Zoho_Docs_Intergration&&!t&&e.push({uservalue:I18n.getMsg("crm.title.show.documents"),systemvalue:"Documents"}),"skyDesk"!==RebrandLinkUtil.properties.DeploymentLocation&&featuresAvailable.Attach_TeamDrive&&e.push({uservalue:I18n.getMsg("crm.label.teamdrive"),systemvalue:"TeamDrive"});var a=Crm.userDetails.ENABLE_DOCS_PICKER_ATTACHMENTS;return featuresAvailable.Attach_Zoho_Docs&&a&&e.push({uservalue:I18n.getMsg("crm.label.addons.zdocs",Crm.brandName),systemvalue:"Zoho Docs"}),"true"===RebrandLinkUtil.properties.CLOUD_PICKER_ENABLED&&featuresAvailable.Attach_Google_Docs&&e.push({uservalue:I18n.getMsg("crm.attach.cloud.picker"),systemvalue:"Cloud Picker"}),e},bindFileUploaderForFileUploadField:function(e){$(e.save).prop("disabled",!0),$(e.clickable).FileUploader({previewsContainer:e.container,createImageThumbnails:!1,needWMSFallback:!0,needVirusFilter:!0,clickable:e.clickable,previewTemplate:e.previewtemplate,needMultipleSelection:e.needMultipleSelection,uploadMethod:e.uploadmethod,maxFiles:e.uploadlimit,notificationLimit:5e3,maxFilesize:e.uploadsizelimit,totalFilesize:e.uploadsizelimit,flexSize:e.uploadsizeflex,parallelUploads:e.parallelupload,progressRatio:e.progressratio,fileSizeBase:e.filesizebase,save:e.save,cancel:e.cancel,init:function(){var t=this;t.on("proceed",(function(t){t.preventDefault(),t.stopPropagation();var a,r=new FormData(document[e.mainform]);this.getIdsAsFormData("uploadId","uploadIds",r),commonUtils.showHideLoadingDiv(!0),$.ajax({url:document[e.mainform].action,type:"POST",data:r,contentType:!1,processData:!1,success:(a=this,function(e){var t=$(".zc_fileup_alert");t.addClass("dNImp"),commonUtils.showHideLoadingDiv();var r=Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxFileUploadCreateComponents(fileupload.cxPropId)[0].component;r.setData("cxPropErrorMessage","");var l=!!Lyte.Router.getRouteInstance().getQueryParams().wizardId&&$L("crm-canvas-form").length,i=Lyte.Router.getRouteInstance().transition.info.route,s="crm.tab.module.create.canvas"===i||"crm.tab.module.entity.edit.canvas"===i||"crm.tab.module.entity.clone.canvas"===i||l;if(s&&(t.removeClass("cruxErrMsg"),t.closest(".zcanvas-field").removeClass("zc_errorstate")),null!=e.fieldId&&""!=e.fieldId)s?fileupload.createAttachElement(e,"DESKTOPATTACHMENTS",s):fileupload.createAttachElement(e,"DESKTOPATTACHMENTS",void 0);else if("crm.attachment.size.check"==e.trim()){let e=fileupload.maximum_allowed_size?fileupload.maximum_allowed_size:crmConstants.FileUploader.fileUploadFieldAttachments.uploadSizeLimit;renderingUtils.showCustomAlert(I18n.getMsg("crm.FileuploadField.size.newlimitstmt",e),"")}else if("crm.attachment.fileUploadField.Maxcount.check"==e.trim())renderingUtils.showCustomAlert(I18n.getMsg("crm.attachment.fileUploadField.Maxcount.check"),"");else if("crm.attachment.fileUploadField.Mincount.check"==e.trim())renderingUtils.showCustomAlert(I18n.getMsg("crm.attachment.fileUploadField.Mincount.check"),"");else if("crm.attachment.name.check"==e.trim())renderingUtils.showCustomAlert(I18n.getMsg("crm.attachment.name.check"),"");else{var n=JSON.parse(e);switch(n.message){case"crm.FileuploadField.size.limitstmt":case"crm.FileuploadField.size.newlimitstmt":case"crm.attachment.fileUploadField.Maxcount.check":case"crm.attachment.fileUploadField.Mincount.check":renderingUtils.removeFreezeLayer();let e=fileupload.maximum_allowed_size?fileupload.maximum_allowed_size:crmConstants.FileUploader.fileUploadFieldAttachments.uploadSizeLimit;r&&(r.setData("cxPropErrorMessage",parent.I18n.getMsg(n.message,e)),s&&("crm.FileuploadField.size.limitstmt"===n.message||"crm.FileuploadField.size.newlimitstmt"===n.message?$L(r.$node).closest(".zcanvas-field").removeClass("zc_mandatorystate zc_disabledstate").addClass("zc_errorstate"):$L(r.$node).closest(".zcanvas-field").addClass("zc_errorstate")))}}$(a.options.cancel).click()}),error:function(e){return function(){$(e.options.cancel).hide(),crmui.showMsgBand(e.options.messageType.error,I18n.getMsg("crm.fileuploader.message.uploadfailedretry"),"infinity"),$(e.options.cancel).click()}}(this)}),$(this.options.save).prop("disabled",!0)})),t.on("error",(function(e){if(e.previewElement){if(e.virus){var t=$(e.previewElement).find(".virusAlert");t.css("display","inline-block");var a=t.parent()[0];a.addEventListener("mouseenter",(function(){crmui.showTooltip(I18n.getMsg("crm.fileuploader.ToolTip.virusdetected"))})),a.addEventListener("mouseleave",(function(){crmui.hideTooltip()}))}var r=e.previewElement.querySelector("[data-dz-errormessage]");r&&r.innerHTML.length>20&&$(r).attr("title",r.innerHTML)}})),t.on("customizepreviewtemplate",(function(e){if(e.previewElement){var t=e.previewElement.querySelector("[data-dz-name]"),a=e.name;a&&a.length>20&&$(t).attr("title",a);var r="";a&&""!==a&&-1!==a.lastIndexOf(".")&&(r=a.slice(a.lastIndexOf(".")+1)),(t=e.previewElement.querySelector(".dz-filename"))&&$(t).prepend(FileUploader.createElement('<span class="mR15 '+getExtensionGroup(r)+'-icon"></span>')),(t=e.previewElement.querySelector("[data-dz-size]"))&&(t.textContent="("+this.options.getFileSize(e.size)+")")}})),t.on("terminate",(function(){hideAnimatePopup(e.popupname),setTimeout((function(){$("#attachPopup").remove()}),100)}))},uploadBean:{crmHandback:{fieldId:e.fieldId,module:e.module,action:e.action},user:{zgid:e.zgid},uploadTo:e.resourcetype,folderId:e.workspace}})},formatBytes:function(e,t){if(0==e)return"0 Bytes";var a=t||2,r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(a))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}};crmTemplate.createRecordNotFoundAlertDiv=function(e,t){return renderingUtils.createHTML({name:"div",attr:{id:"NotFoundAlertDiv",class:"w100_per pT30"},child:[{name:"div",attr:{style:"margin:35px auto; display:table; vertical-align:top;"},child:[{name:"div",attr:{class:"kso_CautionLeft",style:"width:20%; float:left; margin-top:5px;"},child:[{name:"img",attr:{src:networkUtils.getImageUrl("cautionImg.jpg",ResourceConstants.CRM)}}]},{name:"div",attr:{class:"kso_CautionRight",style:"width:80%; float:left;"},child:[{name:"h2",attr:{class:"kso_CautionTitle crm-heading-font-size",style:"color:var(--redLightColor);"},child:[{name:"text",content:e}]},{name:"div",attr:{class:"mT10 crm-small-font-size crmNotFoundColor"},child:[{name:"text",content:t}]}]}]}]})},crmTemplate.getElementsByTagName=function(e,t,a){var r=(t=t||document).childNodes;if(e=e.toLowerCase(),!a)a=[];for(var l=r.length,i=this.getElementsByTagName,s=0;s<l;s++){var n=r[s];(3===n.nodeType&&"#text"===e||n.nodeName.toLowerCase()===e)&&a.push(n),n.hasChildNodes()&&a.concat(i(e,n,a))}return a};