Lyte.Mixin.register("crm-zdesk-rl-utils",{ticketActionDisplay:function(){$L("#selectedTicketCount").text(deskInteg.getSelectedRowCount()),0==deskInteg.getSelectedRowCount()?($L(".ticket_noselect").show(),$L(".ticket_select").hide()):($L(".ticket_noselect").hide(),$L(".ticket_select").show())},getCurrentTicketPage:function(){var t=document.querySelector("crm-zdeskbody-rl").component.data.pageNum,e=parseInt(t);return isNaN(e)?0:e},changeIframeTicket:function(t){var e=t.encryptedId,a=t.departmentId,i=deskInteg.getUrlForTicketDetailView(e,a);this.setData("iframeURL",i),deskInteg.setDetailTicketId(t.id),Crm.trackSpotLightAction("ZDesk - Ticket Detail View")}}),store.registerModel("zdesk_rl",{name:Lyte.attr("string",{primaryKey:!0}),ACTIONS:Lyte.attr("array"),heading:Lyte.attr("array"),body:Lyte.attr("array"),customButton:Lyte.attr("boolean"),filtersAvailable:Lyte.attr("boolean"),fromIndex:Lyte.attr("number"),isCustLookUp:Lyte.attr("boolean"),isCustomModule:Lyte.attr("boolean"),isCustomRel:Lyte.attr("boolean"),isShowColumns:Lyte.attr("boolean"),isStandardLookup:Lyte.attr("boolean"),label:Lyte.attr("string"),listRelationId:Lyte.attr("string"),module:Lyte.attr("string"),sortOrderString:Lyte.attr("string"),toIndex:Lyte.attr("number")}),store.registerAdapter("zdesk_rl",{namespace:"crm",buildURL:function(t,e,a,i,o){return o.replace("zdesk_rl","NewRelatedList.do")}}),store.registerSerializer("zdesk_rl",{normalizeResponse:function(t,e,a){var i=document.getElementsByTagName("crm-zdesk-rl-body")[0].component,o=i.getData("related_list_id"),s=i.getData("module"),n={};return n.zdesk_rl=a[s][o],n},payloadKey:function(t){return t}}),store.registerModel("zdesk_integ_rl",{portalName:Lyte.attr("string",{primaryKey:!0})}),store.registerAdapter("zdesk_integ_rl",{namespace:"crm",buildURL:function(t,e,a,i,o){return o.replace("zdesk_integ_rl","deskIntegration.do")}}),store.registerSerializer("zdesk_integ_rl",{normalizeResponse:function(t,e,a){var i={};return i.zdesk_integ_rl=a,i},payloadKey:function(t){return t}}),Lyte.Component.register("crm-zdesk-rl-body",{_template:'<template tag-name="crm-zdesk-rl-body"> <div id="deskIntegDiv"> <template is="if" value="{{deskError}}"><template case="true"> <lyte-table cellspacing="0" cellpadding="0" class="norec pR30 w100_per"> <lyte-table-structure> <lyte-tbody> <lyte-tr> <lyte-td class="vaT"> <div class="pR30">{{getI18n(\'deskErrorMessage\')}}</div> </lyte-td> </lyte-tr> </lyte-tbody> </lyte-table-structure> </lyte-table> </template><template case="false"> <template is="if" value="{{showIframeUrl}}"><template case="true"> <crm-zdesk-iframe iframeurl="{{iframeURL}}" show="{{lbind(iframeshow)}}"></crm-zdesk-iframe> </template></template> <lyte-modal lt-prop-height="620px" lt-prop-show="{{lbind(ticketcreationshow)}}" lt-prop-show-close-button="false" lt-prop-width="1250px"> <template is="registerYield" yield-name="modal"> <lyte-modal-content class="p0" style="max-height: 620px"> <div class="fR deskIframeCloseCont pA"> <span class="zcicncss-close zcicn-cssIcons cP mL6 mR5 mT5 dIB" onclick="{{action(\'hideCreateTicketPopup\')}}"></span> </div> <div class="cBoth"></div> <span id="loadMsg"> </span> <iframe onload="{{action(\'setStyle\')}}" class="oA" id="createTicketIframe" frameborder="0" src="{{ticketcreationurl}}" style="width: 1250px; height: 590px;overflow:visible"> </iframe> </lyte-modal-content> </template> </lyte-modal> <div class="{{if(deskRelatedListMenuShow,\'mB10\',\'dN\')}}" id="deskRelatedListMenu"> <div class="{{if(deskTicketsSummaryShow,\'mB20\',\'\')}}"> <div id="deskTicketsSummary" class="{{if(deskTicketsSummaryShow,\'pR20 pB20 pL0 deskStatsSummary pR if(isRlLyteNew, \'pT20\' , \'pT15 br_bottom_border3\')\',\'dN\')}}"> <lyte-table lt-prop-yield="true" class="w100_per deskRelStatTable {{if(isRlLyteNew,\' \',\'noBorderTable\')}}" cellpadding="0" cellspacing="0"> <lyte-table-structure> <lyte-tbody> <lyte-tr> <lyte-td class="statTd"> <p class="statDesc">{{getI18n(\'crm.zdesk.stats.overall\')}}</p> <p class="statVal">{{totalTickets}}</p> </lyte-td> <lyte-td class="statTd"> <p class="statDesc">{{getI18n(\'crm.zdesk.stats.overdue\')}}</p> <p id="overdueTickets" class="statVal">{{overdueTickets}}</p> </lyte-td> <lyte-td class="statTd"> <p class="statDesc">{{getI18n(\'crm.zdesk.stats.response\')}}</p> <p id="avgResTime" class="statVal dIB" lt-prop-title="{{getI18n(\'crm.zdesk.stats.msg\')}}"> <span class="dIB">{{avgResTimeSpan}}</span><span class="statSubtleText mL5">{{getI18n(\'crm.workflow.scheduler.hours\')}}</span> </p> </lyte-td> <lyte-td class="statTd"> <p class="statDesc">{{getI18n(\'crm.zdesk.stats.resolution\')}}</p> <p class="statVal dIB" lt-prop-title="{{getI18n(\'crm.zdesk.stats.msg\')}}"> <span class="dIB">{{avgSolTimeSpan}}</span><span class="statSubtleText mL5">{{getI18n(\'crm.workflow.scheduler.hours\')}}</span> </p> </lyte-td> <lyte-td class="statTd"> <p class="statDesc">{{getI18n(\'crm.zdesk.stats.happiness\')}}</p> <p class="statVal"> <span class="{{if(cusHapRateShow,\'vaM\',\'dN\')}}">{{cusHapRateValue}}</span> <span id="happiness_smiley" class="{{Smileytype}}"></span> <span id="no_happinessrating" class="{{if(noHapShow,\'crmNotFoundColor crm-base-font-size\',\'dN\')}}">{{getI18n(\'crm.zdesk.noratings\')}}</span> </p> </lyte-td> </lyte-tr> </lyte-tbody> </lyte-table-structure> </lyte-table> </div> </div> <div class="pT5 fL"> <div class="{{if(ticketSelectShow,\'dIB ticket_select\',\'dN\')}}"> <div class="dIB"> <span id="selectedTicketCount" class="crm-font-bold crm-small-font-size">{{selectedRowCount}}</span> <span class="crmNotFoundColor crm-small-font-size">{{getI18n(\'crm.zdesk.ticketselect\')}}</span> </div> <span class="cP mL10 crm-small-font-size deskhyperlink crmLinkHover" onclick="{{action(\'clearSelect\',)}}">{{getI18n(\'crm.zdesk.clear\')}}</span> </div> <div class="{{if(deskTicketFilterShow,\'ticket_noselect\',\'dN\')}}" id="deskTicketFilter"> <lyte-dropdown id="ticketFilterSelect" data-zcqa="desk_ticketfilter" on-option-selected="{{method(\'getDeskTickets\',0,undefined,undefined,undefined,true)}}" class="crmSmallDropdown"> <template is="registerYield" yield-name="yield"> <lyte-drop-box> <lyte-drop-body> <lyte-drop-item data-value="All">{{getI18n(\'crm.zdesk.allticket\')}}</lyte-drop-item> <template is="if" value="{{supportObj.potentialModule}}"><template case="true"> <lyte-drop-item data-value="Potentials">{{getI18n(\'crm.zdesk.potentialticket\',supportObj.potentialSingular)}} </lyte-drop-item> </template></template> <template is="for" items="{{supportObj.ticketTypes}}" item="itemc" index="indexc"> <lyte-drop-item data-value="{{itemc.value}}">{{getI18n(\'crm.zdesk.potentialticket\',itemc.value)}}</lyte-drop-item> </template> <lyte-drop-item data-value="Overdue">{{getI18n(\'crm.zdesk.overdueticket\')}}</lyte-drop-item> <lyte-drop-item data-value="High">{{getI18n(\'crm.zdesk.highticket\')}}</lyte-drop-item> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </div> <div data-zcqa="ticketOperations" class="{{if(ticketSelectShow,\'dIB ticket_select\',\'dN\')}}"> <template is="if" value="{{portalUser}}"><template case="true"> <lyte-button class=" dIB" data-zcqa="desk_updateticket" onclick="{{action(\'showTktFldUpdPop\',ticketHeadings)}}" lt-prop-value="{{getI18n(\'crm.zdesk.updatefield\')}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.zdesk.updatefield\')}} </template> </lyte-button> <lyte-button class="dIB" data-zcqa="desk_closeticket" onclick="{{action(\'updateFields\',\'status\',\'Closed\')}}" lt-prop-value="{{getI18n(\'crm.button.close\')}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.button.close\')}} </template> </lyte-button> </template><template case="false"> <div class="dIB ticketDisabledButton" onmouseenter="{{action(\'showToolTip\',getI18n(\'crm.zdesk.user.needportal.brandchange\',getIntegrationName(\'ZOHO_DESK\')),\'false\',\'left\')}}" onmouseleave="{{action(\'hideSubjectTooltip\')}}"> <lyte-button class="dIB eventNone" lt-prop-value="{{getI18n(\'crm.zdesk.updatefield\')}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.zdesk.updatefield\')}} </template> </lyte-button> <lyte-button class="dIB eventNone" lt-prop-value="{{getI18n(\'crm.button.close\')}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.button.close\')}} </template> </lyte-button> </div> </template></template> <template is="if" value="{{supportObj.potentialModule}}"><template case="true"> <lyte-button lt-prop-class="{{if(linkToThisPotentialShow,\'\',\'dN\')}}" lt-prop-id="linkToThisPotential" data-zcqa="desk_linkthispotential" onclick="{{action(\'linkToPotential\')}}" lt-prop-value="{{getI18n(\'crm.zdesk.thispotential\',supportObj.potentialSingular)}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.zdesk.thispotential\',supportObj.potentialSingular)}} </template> </lyte-button> </template><template case="false"> <template is="if" value="{{supportObj.showPotential}}"><template case="true"> <lyte-button class=" dIB" lt-prop-id="linkToPotential" data-zcqa="desk_linkpotential" onclick="{{action(\'populatePotentialPopup\')}}" lt-prop-value="{{getI18n(\'crm.zdesk.linkpotential\',supportObj.potentialLabel)}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.zdesk.linkpotential\',supportObj.potentialLabel)}} </template> </lyte-button> </template></template> </template></template> <template is="if" value="{{supportObj.showPotential}}"><template case="true"> <template is="if" value="{{isRlLyteNew}}"><template case="true"> <lyte-button id="managePortalEvents"> <template is="registerYield" yield-name="text"> <crmutil-icon icon-name="more-hr" icon-class="zcicn-more-hr crmBaseIcon pT6"></crmutil-icon> </template> </lyte-button> <lyte-menu lt-prop-yield="true" lt-prop-query="lyte-button#managePortalEvents" lt-prop-position="downAlignRight" lt-prop-freeze="false"> <template is="registerYield" yield-name="yield"> <lyte-menu-body class="pT10 pB10 pR0 pB0 borderNone"> <template is="if" value="{{supportObj.portalUser}}"><template case="true"> <lyte-menu-item class="desk_deleteticket" data-zcqa="desk_deleteticket" onclick="{{action(\'showAnimatePopup\',\'deleteDeskTicketConfirmation\')}}"> <lyte-menu-label id="tktDelBtn" class="dIB w100_per">{{getI18n(\'crm.button.delete\')}}</lyte-menu-label> </lyte-menu-item> </template><template case="false"> <lyte-menu-item class="dIB ticketDisabledButton" onmouseenter="{{action(\'showToolTip\',getI18n(\'crm.zdesk.user.needportal.brandchange\',getIntegrationName(\'ZOHO_DESK\')),\'false\',\'center\')}}" onmouseleave="{{action(\'wftoolTipHide\')}}"> <lyte-menu-label class="dIB eventNone crmLinkColor cP w100_per" id="tktDelBtn">{{getI18n(\'crm.button.delete\')}}</lyte-menu-label> </lyte-menu-item> </template></template> <lyte-menu-item id="linkToPotential" data-zcqa="desk_unlink" onclick="{{action(\'unlinkTickets\')}}"> <lyte-menu-label class="dIB w100_per">{{getI18n(\'crm.zdesk.unlink\',supportObj.potentialLabel)}}</lyte-menu-label> </lyte-menu-item> </lyte-menu-body> </template> </lyte-menu> </template><template case="false"> <div class="dIB"> <div class="pR"> <span class="newbutton mL5 newwhitebtn moredot_h2_35 moredotparentBtn" onclick="{{action(\'showPortalEvent\',event,this)}}"></span> <div class="ddM mL5" data-close="true" style="top: 35px; z-index: 10; display: none;"> <ul> <li> <template is="if" value="{{supportObj.portalUser}}"><template case="true"> <span class="dIB deskhyperlink" id="tktDelBtn" data-zcqa="desk_deleteticket" onclick="{{action(\'showAnimatePopup\',\'deleteDeskTicketConfirmation\')}}">{{getI18n(\'crm.button.delete\')}}</span> </template><template case="false"> <div class="dIB ticketDisabledButton" onmouseenter="{{action(\'showToolTip\',getI18n(\'crm.zdesk.user.needportal.brandchange\',getIntegrationName(\'ZOHO_DESK\')),\'false\',\'center\')}}" onmouseleave="{{action(\'wftoolTipHide\')}}"> <span class="dIB eventNone deskhyperlink" id="tktDelBtn">{{getI18n(\'crm.button.delete\')}}</span> </div> </template></template> </li> <li> <span class="dIB deskhyperlink" id="linkToPotential" data-zcqa="desk_unlink" onclick="{{action(\'unlinkTickets\')}}">{{getI18n(\'crm.zdesk.unlink\',supportObj.potentialLabel)}}</span> </li> </ul> </div> </div> </div> </template></template> </template><template case="false"> <template is="if" value="{{portalUser}}"><template case="true"> <lyte-button lt-prop-id="tktDelBtn" lt-prop-data-zcqa="desk_ticketdelete" onclick="{{action(\'showAnimatePopup\',\'deleteDeskTicketConfirmation\')}}" lt-prop-value="{{getI18n(\'crm.button.delete\')}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.button.delete\')}} </template> </lyte-button> </template><template case="false"> <div class="dIB ticketDisabledButton" onmouseenter="{{action(\'showToolTip\',getI18n(\'crm.zdesk.user.needportal.brandchange\',getIntegrationName(\'ZOHO_DESK\')),\'false\',\'left\')}}" onmouseleave="{{action(\'hideSubjectTooltip\')}}"> <lyte-button lt-prop-id="tktDelBtn" lt-prop-value="{{getI18n(\'crm.button.delete\')}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.button.delete\')}} </template> </lyte-button> </div> </template></template> </template></template> </div> </div> <div class="fR pR pT5 flexAlignCenter"> <template is="if" value="{{ticketStats}}"><template case="true"> <template is="if" value="{{isRlLyteNew}}"><template case="true"><lyte-button id="ticketStatLink" data-zcqa="desk_togglestats" class="{{if(ticketsStatsLinkShow,\'cP dIB vaM ticket_noselect\',\'dNImp\')}}" onclick="{{action(\'toggleStats\')}}" lt-prop-appearance="primary" lt-prop-class="outlineprimary ghostoutlineblue" lt-prop-size="small"><template is="registerYield" yield-name="text">{{ticketStatsLinkText}}</template></lyte-button></template><template case="false"><span id="ticketStatLink" data-zcqa="desk_togglestats" class="{{if(ticketsStatsLinkShow,\'cP dIB vaM ticket_noselect showHideStatLink deskhyperlink crmLinkHover\',\'dNImp\')}}" onclick="{{action(\'toggleStats\')}}">{{ticketStatsLinkText}}</span></template></template> </template></template> <template is="if" value="{{portalUser}}"><template case="true"> <template is="if" value="{{isRlLyteNew}}"><template case="true"><lyte-button id="newTicketLink" data-zcqa="desk_createticket" onclick="{{action(\'showCreateTicketPopup\')}}" lt-prop-appearance="primary" lt-prop-class="outlineprimary" lt-prop-size="small" class="{{if(newticketlinkshow,\'dIB ticket_noselect\',\'dNImp\')}}"><template is="registerYield" yield-name="text">{{getI18n(\'crm.zdesk.newticket\')}} </template></lyte-button></template><template case="false"><span id="newTicketLink" data-zcqa="desk_createticket" class="{{if(newticketlinkshow,\'cP dIB vaM ticket_noselect createlink crm-rl-write-action deskhyperlink crmLinkHover\',\'dNImp\')}}" onclick="{{action(\'showCreateTicketPopup\')}}"> {{getI18n(\'crm.zdesk.newticket\')}}</span></template></template> </template></template> <template is="if" value="{{expHandlers(expHandlers(loadCruxColumn,\'&amp;&amp;\',expHandlers(data.length,\'>\',0)),\'||\',cruxcolumShowfromfilter)}}"><template case="true"> <template is="if" value="{{isRlLyteNew}}"><template case="true"><div id="showColumn" class="{{if(showColumnShow,\' icon-hover-effects column-add-icon icon-hover-gray-bg-nb pR mR4\',\'dN\')}}" data-zcqa="desk_colchange" onclick="{{action(\'cruxcolumnshow\',this)}}"><span class="zcicncss-column-add zcicn-cssIcons zcicn_black_mask scale9 zi2"></span></div></template><template case="false"><div id="showColumn" class="{{if(showColumnShow,\'newRlEdit dIB vaM ticket_noselect\',\'dN\')}}" data-zcqa="desk_colchange" style="visibility: visible;" onclick="{{action(\'cruxcolumnshow\',this)}}"></div></template></template> <lyte-popover lt-prop-origin-elem="#showColumn" id="chooseColumnsFilterDD" lt-prop-max-height="90%" lt-prop-type="box" lt-prop-freeze="false" lt-prop-content-padding="20px 0 10px" lt-prop-show="{{showCruxColumn}}" lt-prop-scrollable="true" lt-prop-close-on-escape="false" lt-prop-draggable="false" lt-prop-show-close-button="false"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <crux-column-list cx-prop-max-select-column="100" lt-prop-wrapper-class="cxColumnListOnPopup" cx-prop-fields="{{allFields}}" cx-prop-selected-fields="{{selectedFields}}" cx-prop-mandatory="mandatory" on-before-unchecked="{{method(\'uncheckMandatory\')}}" on-before-drop-item="{{method(\'unSortMandatory\')}}" style="position:relative;"></crux-column-list> </lyte-popover-content> <lyte-popover-footer> <lyte-button data-zcqa="columnFilterSaveButton" lt-prop-appearance="primary" onclick="{{action(\'saveColModify\')}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.button.save\')}} </template> </lyte-button> <lyte-button data-zcqa="columnFilterCancelButton" onclick="{{action(\'cancelChooseColumns\')}}"> <template is="registerYield" yield-name="text"> {{getI18n(\'crm.button.cancel\')}} </template> </lyte-button> </lyte-popover-footer> </template> </lyte-popover> </template></template> </div> <div class="cBoth"></div> </div> <lyte-modal id="deleteDeskTicketConfirmation" lt-prop-show="false" lt-prop-show-close-button="false" lt-prop-close-on-escape="false" lt-prop-wrapper-class="deskIntegmodal"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <div class="crm-font-bold crm-heading-font-size crmHeadingColor">{{getI18n(\'crm.zdesk.delete.ticket\')}}</div> </lyte-modal-header> <lyte-modal-footer class="center"> <lyte-button lt-prop-name="cancel" lt-prop-value="{{getI18n(\'crm.label.no\')}}" onclick="{{action(\'hideAnimatePopup\',\'deleteDeskTicketConfirmation\')}}"> <template is="registerYield" yield-name="text">{{getI18n(\'crm.label.no\')}}</template> </lyte-button> <lyte-button lt-prop-appearance="failure" data-zcqa="desk_deleleticketconfirm" lt-prop-value="{{getI18n(\'crm.label.delete\')}}" onclick="{{action(\'deleteTickets\')}}"> <template is="registerYield" yield-name="text">{{getI18n(\'crm.label.delete\')}}</template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> <lyte-modal id="tktFldPop" lt-prop-show="{{lbind(ticketFieldUpdatePopupShow)}}" lt-prop-width="600px" lt-prop-show-close-button="false" lt-prop-close-on-escape="false" lt-prop-wrapper-class="deskIntegmodal"> <template is="registerYield" yield-name="modal"> <lyte-modal-content> <p class="tktFldPopHead crm-font-bold">{{getI18n(\'crm.label.updateField\')}}</p> <div class="pL30 pR30"> <div class="tabDivCreate"> <div class="labelTabCreate pL5 pR fL">{{getI18n(\'crm.zdesk.update.sel\')}}</div> <div class="labelValCreate fL"> <div class="createSelect newChosenSel"> <lyte-dropdown id="updateFieldName" data-zcqa="desk_fieldselect" on-option-selected="{{method(\'updateNewValueField\')}}" on-hide="{{method(\'clearSelectEntry\')}}" lt-prop-disabled-list="{{fieldtodisable}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box class="crmBoxDropbox zdeskFieldSearch"> <template is="if" value="{{expHandlers(updateableFields.length,\'>=\',10)}}"><template case="true"> <lyte-drop-header> <lyte-search id="dropdownSearch" style="width:100%" lt-prop-query-selector="{&quot;scope&quot;: &quot;.zdeskFieldSearch&quot;,&quot;search&quot;:&quot;lyte-drop-item&quot;}" on-search="{{method(\'onSearch\')}}"></lyte-search> </lyte-drop-header> </template></template> <lyte-drop-body> <template is="for" items="{{updateableFields}}" item="item" index="index"> <lyte-drop-item data-value="{{item.name}}">{{item.i18NLabel}}</lyte-drop-item> </template> </lyte-drop-body> <div class="crmZdesk_dropInStyle" style="display:{{noResult}};">{{getI18n(\'crm.label.no.options.found\')}}</div> </lyte-drop-box> </template> </lyte-dropdown> </div> </div> <div class="cBoth"></div> </div> <div class="tabDivCreate"> <div id="deskupdateFieldMsg" class="labelTabCreate pL5 pR fL">{{deskupdateFieldMsgText}}</div> <div class="labelValCreate fL"> <div class="{{if(fieldUpdSelectOptionShow,\'createSelect newChosenSel\',\'dN\')}}" id="fieldUpdSelectOption"> <lyte-dropdown id="fieldUpdSelect" lt-prop-options="{{fieldUpSelectData}}" lt-prop-user-value="name" lt-prop-system-value="value" data-zcqa="desk_picklistfield"> </lyte-dropdown> </div> <div id="fieldUpdTextOption" class="{{if(fieldUpdTextOptionShow,\'\',\'dN\')}}"> <div id="plainText" class="{{if(plainTextShow,\'\',\'dN\')}}" data-zcqa="desk_textfield"> <lyte-input class="contact_zohoDeskInputBorder" lt-prop-type="{{lbind(fieldObjType)}}" lt-prop-class="textField" lt-prop-maxlength="{{lbind(fieldObjMaxLength)}}" lt-prop-value="{{lbind(textInputValue)}}"></lyte-input> </div> <div id="dateText" class="{{if(dateTextShow,\'\',\'dN\')}}"> <lyte-input lt-prop-type="date" lt-prop-id="deskDate" lt-prop-format="{{supportObj.datePattern}}" lt-prop-number-of-rows="6" lt-prop-start-week-day="1" lt-prop-tab-index="0" lt-prop-pattern=".+" lt-prop-update-delay="250" lt-prop-callback-delay="0" lt-prop-placeholder="{{supportObj.datePattern}}" lt-prop-style="width: 100px;" lt-prop-month-header-format="MMM YYYY" lt-prop-value="{{lbind(dateInputValue)}}"> </lyte-input> <template is="if" value="{{defaultTimePatternShow}}"><template case="true"> <lyte-input lt-prop-type="time" lt-prop-time-format="12" lt-prop-wheel="true" lt-prop-hour-interval="1" lt-prop-minute-interval="30" lt-prop-tab-index="0" lt-prop-pattern=".+" lt-prop-update-delay="250" lt-prop-callback-delay="0" lt-prop-placeholder="hh:mm" lt-prop-default-time="12:00 AM" lt-prop-dropdown="true" lt-prop-start-time="12:00 AM" lt-prop-end-time="11:30 PM" lt-prop-id="deskTime" lt-prop-style="width: 100px;" lt-prop-value="{{lbind(timeInputValue)}}"> </lyte-input> </template><template case="false"> <lyte-input lt-prop-type="time" lt-prop-time-format="24" lt-prop-wheel="true" lt-prop-hour-interval="1" lt-prop-minute-interval="30" lt-prop-tab-index="0" lt-prop-pattern=".+" lt-prop-update-delay="250" lt-prop-callback-delay="0" lt-prop-placeholder="hh:mm" lt-prop-default-time="00:00" lt-prop-dropdown="true" lt-prop-start-time="00:00" lt-prop-end-time="23:30" lt-prop-style="width: 100px;" lt-prop-value="{{lbind(newTimeInputValue)}}"> </lyte-input> </template></template> <div class="cBoth"></div> </div> <span class="{{if(errorFieldShow,\'errMsg errorMsgDesc\',\'dNImp\')}}" id="errorMsg_TicketField" style="clear: both; color: rgb(221, 0, 0); font-size: 11px; display: block;">{{errorFieldMsg}}</span> </div> </div> <div class="cBoth"></div> </div> </div> <div class="p20 alignRight"> <input type="button" class="newwhitebtn mR20" value="{{getI18n(\'crm.button.cancel\')}}" data-zcqa="desk_updatecancel" onclick="{{action(\'closeTicketUpdatePop\')}}"> <input type="button" data-zcqa="desk_ticketupdate" class="primarybtn" value="{{getI18n(\'crm.button.update\')}}" onclick="{{action(\'updateFields\',undefined,undefined)}}"> </div> </lyte-modal-content> </template> </lyte-modal> <lyte-modal on-before-close="{{method(\'deskTicketClose\')}}" lt-prop-width="80%" lt-prop-height="590px !important" lt-prop-transition="{&quot;animation&quot;:&quot;slideFromTop&quot;,&quot;duration&quot;:&quot;0.5&quot;}" lt-prop-show-close-button="false" lt-prop-close-on-escape="false" lt-prop-dimmer="{&quot;opacity&quot;:&quot;0.7&quot;}"> <template is="registerYield" yield-name="modal"> <span class="pA gray-round-bg cP" style="top: 26px; width: 42px; height: 42px;" onclick="{{action(\'closeModal\',this)}}"> </span> <lyte-modal-content class="h100_per p0" style="overflow-x: scroll !important"> <iframe src="about:blank" class="borderNone" style="width:100%;height:100%; min-width:1250px;"></iframe> </lyte-modal-content> </template> </lyte-modal> <div id="ticketsDropDiv" class="maxW100per oA"> <table id="ticketsTable" cellpadding="0" cellspacing="0" class="w100_per pR"> <thead> <tr id="desk_tickets_thead_row" class="{{if(deskTheadRowShow,\'relList_headrow\',\'dN\')}}"> <th class="relList_headele"> <label class="vH"> <span class="customCheckBox"></span> </label> </th> <td is="for" lyte-for="true" items="{{ticketHeadings}}" item="item" index="index" depth="3"></td> </tr> </thead> <tbody id="desk_tickets_tbody"> <tr is="if" lyte-if="true" value="{{expHandlers(data.length,\'>\',0)}}"></tr> </tbody> </table> </div> <template is="if" value="{{showNavigation}}"><template case="true"> <lyte-navigator on-next="{{method(\'next\',undefined)}}" on-previous="{{method(\'prev\',undefined)}}" lt-prop-middle-text="to" lt-prop-yeild="false" lt-prop-value="{{fromIndex}}" lt-prop-perpage="7" lt-prop-more-records="{{showNextNav}}" lt-prop-records="{{toIndex}}"> </lyte-navigator> </template></template> </template></template> <lyte-popover lt-prop-content-padding="5px" lt-prop-type="box" lt-prop-origin-elem="{{lbind(popoverbind)}}" lt-prop-height="auto" lt-prop-duration="400" lt-prop-freeze="false" lt-prop-show-close-button="false" lt-prop-placement="bottom" lt-prop-width="auto" lt-prop-show="{{lbind(agentpopovershow)}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <div class="pR"> <div class="up_space pA"> <img id="agentImg" class="up_size fL" src="{{imgsrc}}" alt="CrmContact" style="width:60px"> </div> <div class="userbc_info"> <div class="crm-font-bold crm-base-font-size pT10 pB5 userinfoMax"> <span id="bcAgentName" class="dIB" style="max-width: 350px;">{{bcAgentInfoText}} </span> </div> <a class="emailicon lh24 crmBaseColor dB" href="{{lbind(agentEmailHref)}}">{{agentEmailText}}</a> </div> <div class="aligncenter"></div> </div> </lyte-popover-content> </template> </lyte-popover> </div> </template>',_dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,1,1,1,1,0]},{type:"componentDynamic",position:[1,1,1,1,1]},{type:"componentDynamic",position:[1,1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"attr",position:[1,7]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5]},{type:"attr",position:[5,1]},{type:"attr",position:[5,1,1]},{type:"attr",position:[5,1,1,1]},{type:"text",position:[5,1,1,1,1,1,1,1,1,0]},{type:"text",position:[5,1,1,1,1,1,1,1,3,0]},{type:"componentDynamic",position:[5,1,1,1,1,1,1,1]},{type:"text",position:[5,1,1,1,1,1,1,3,1,0]},{type:"text",position:[5,1,1,1,1,1,1,3,3,0]},{type:"componentDynamic",position:[5,1,1,1,1,1,1,3]},{type:"text",position:[5,1,1,1,1,1,1,5,1,0]},{type:"attr",position:[5,1,1,1,1,1,1,5,3]},{type:"text",position:[5,1,1,1,1,1,1,5,3,1,0]},{type:"text",position:[5,1,1,1,1,1,1,5,3,2,0]},{type:"componentDynamic",position:[5,1,1,1,1,1,1,5]},{type:"text",position:[5,1,1,1,1,1,1,7,1,0]},{type:"attr",position:[5,1,1,1,1,1,1,7,3]},{type:"text",position:[5,1,1,1,1,1,1,7,3,1,0]},{type:"text",position:[5,1,1,1,1,1,1,7,3,2,0]},{type:"componentDynamic",position:[5,1,1,1,1,1,1,7]},{type:"text",position:[5,1,1,1,1,1,1,9,1,0]},{type:"attr",position:[5,1,1,1,1,1,1,9,3,1]},{type:"text",position:[5,1,1,1,1,1,1,9,3,1,0]},{type:"attr",position:[5,1,1,1,1,1,1,9,3,3]},{type:"attr",position:[5,1,1,1,1,1,1,9,3,5]},{type:"text",position:[5,1,1,1,1,1,1,9,3,5,0]},{type:"componentDynamic",position:[5,1,1,1,1,1,1,9]},{type:"componentDynamic",position:[5,1,1,1,1,1,1]},{type:"componentDynamic",position:[5,1,1,1,1,1]},{type:"componentDynamic",position:[5,1,1,1,1]},{type:"componentDynamic",position:[5,1,1,1]},{type:"attr",position:[5,3,1]},{type:"text",position:[5,3,1,1,1,0]},{type:"text",position:[5,3,1,1,3,0]},{type:"attr",position:[5,3,1,3]},{type:"text",position:[5,3,1,3,0]},{type:"attr",position:[5,3,3]},{type:"attr",position:[5,3,3,1]},{type:"registerYield",position:[5,3,3,1,1],dynamicNodes:[{type:"text",position:[1,1,1,0]},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,1,5]},{type:"for",position:[1,1,5],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"text",position:[1,1,7,0]},{type:"componentDynamic",position:[1,1,7]},{type:"text",position:[1,1,9,0]},{type:"componentDynamic",position:[1,1,9]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[5,3,3,1]},{type:"attr",position:[5,3,5]},{type:"attr",position:[5,3,5,1]},{type:"if",position:[5,3,5,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"registerYield",position:[1,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1,3]}]}},default:{}},{type:"attr",position:[5,3,5,3]},{type:"if",position:[5,3,5,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[5,3,5,5]},{type:"if",position:[5,3,5,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"text",position:[1,3,1,0]},{type:"componentDynamic",position:[1,3,1]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"attr",position:[1,1,3,1,1,1]},{type:"if",position:[1,1,3,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,0]}]}},default:{}},{type:"attr",position:[1,1,3,1,3,1]},{type:"text",position:[1,1,3,1,3,1,0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}},default:{}},{type:"attr",position:[5,5,1]},{type:"if",position:[5,5,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"registerYield",position:[0,0],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"text",position:[0,0]}]}},default:{}}]}},default:{}},{type:"attr",position:[5,5,3]},{type:"if",position:[5,5,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"registerYield",position:[0,0],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"text",position:[0,1]}]}},default:{}}]}},default:{}},{type:"attr",position:[5,5,5]},{type:"if",position:[5,5,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"registerYield",position:[3,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3,1]},{type:"attr",position:[3,3]},{type:"registerYield",position:[3,3,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[3,3]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[3]}]}},default:{}},{type:"registerYield",position:[7,1],dynamicNodes:[{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"registerYield",position:[3,1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[3,1]},{type:"attr",position:[3,3]},{type:"registerYield",position:[3,3,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[3,3]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[7]},{type:"attr",position:[9]},{type:"registerYield",position:[9,1],dynamicNodes:[{type:"text",position:[1,1,0]},{type:"text",position:[1,3,1,1,0]},{type:"attr",position:[1,3,1,3,1,1]},{type:"registerYield",position:[1,3,1,3,1,1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'display:'","noResult","';'"]}}}},{type:"text",position:[1,5,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,3,1,3,1,1]},{type:"text",position:[1,3,3,1,0]},{type:"attr",position:[1,3,3,3,1]},{type:"attr",position:[1,3,3,3,1,1]},{type:"componentDynamic",position:[1,3,3,3,1,1]},{type:"attr",position:[1,3,3,3,3]},{type:"attr",position:[1,3,3,3,3,1]},{type:"attr",position:[1,3,3,3,3,1,1]},{type:"componentDynamic",position:[1,3,3,3,3,1,1]},{type:"attr",position:[1,3,3,3,3,3]},{type:"attr",position:[1,3,3,3,3,3,1]},{type:"componentDynamic",position:[1,3,3,3,3,3,1]},{type:"attr",position:[1,3,3,3,3,3,3]},{type:"if",position:[1,3,3,3,3,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3,3,3,3,5]},{type:"text",position:[1,3,3,3,3,5,0]},{type:"attr",position:[1,5,1]},{type:"attr",position:[1,5,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[9]},{type:"attr",position:[11]},{type:"registerYield",position:[11,1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[11]},{type:"attr",position:[13,1,1,1]},{type:"attr",position:[13,1,1,1,3]},{type:"for",position:[13,1,1,1,3],dynamicNodes:[{type:"text",position:[1,1]}],actualTemplate:'<template is="for" items="{{ticketHeadings}}" item="item" index="index" depth="3"><table><tbody><tr> <th class="relList_headele"> {{item.i18NLabel}} </th> </tr></tbody></table></template>',tagName:"TR"},{type:"attr",position:[13,1,3,1]},{type:"if",position:[13,1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1,1]},{type:"attr",position:[1,1,1,1,1,1,1]},{type:"attr",position:[1,1,1,1,3,1,1,1,1]},{type:"componentDynamic",position:[1,1,1,1,3,1,1,1,1]},{type:"attr",position:[1,3]},{type:"for",position:[1,3],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1,1,1]},{type:"attr",position:[1,1,1,3]},{type:"if",position:[1,1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[1,1,5]},{type:"text",position:[1,1,5,0]},{type:"text",position:[1,1,9,1,0]},{type:"attr",position:[1,3,3]},{type:"text",position:[1,3,3,1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"text",position:[1,3,1,0]},{type:"text",position:[1,3,1,2]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"attr",position:[1,3]},{type:"text",position:[1,3,1,0]}]}},default:{},actualTemplate:'<template is="if" value="{{itema.team}}"><template case="true" depth="3"><table><tbody><tr> <td class="relList_dataele assigneeTd" data-params="{{itema.team}}"> <div class="dIB vaM mR10"> <img alt="Team Image" class="circle_30" src="{{expHandlers(itema.team.logoUrl,\'?:\',itema.team.logoUrl,getCrmClientImageUrl(\'desk_integration/group_avathar.svg\'))}}"> </div> <div id="team_ticket_{{itema.id}}" class="dIB vaM cP"> <span class="assigneeName">{{itema.team.name}}</span> </div> </td> </tr></tbody></table></template></template>'}]}},default:{},actualTemplate:'<template is="if" value="{{itema.agent}}"><template case="true" depth="3"><table><tbody><tr> <td class="relList_dataele assigneeTd" data-params="{{itema.agent}}"> <div class="dIB vaM mR10 pR"> <img alt="CRM Contact" class="circle_30" src="{{if(itema.agent.zuid,expHandlers(expHandlers(expHandlers(contactServerUrl,\'+\',\'/file?ID=\'),\'+\',itema.agent.zuid),\'+\',\'&amp;fs=thumb\'),null)}}"> <template is="if" value="{{itema.team}}"><template case="true"> <div class="flexAlignCenter jcCenter pA w22 h22 relList_secPflWrap br50per pT2 pL1 pR1"> <img alt="secondary profile" src="{{getCrmClientImageUrl(\'desk_integration/Union.svg\')}}" class="h22 w22 zi1"> <template is="if" value="{{itema.team.logoUrl}}"><template case="true"> <img src="{{itema.team.logoUrl}}" alt="Team logo" class="pA br50per mB2 w15 h15"> </template><template case="false"> <span class="pA crm-extra-small-font-size relList_pflText crm-font-bold">{{itema.teamsurname}}</span> </template></template> </div> </template></template> </div> <div id="ticket_agent_{{itema.id}}" class="dIB vaM cP" onmouseenter="{{action(\'showHideAgentInfoBC\',true,itema)}}" onmouseleave="{{action(\'showHideAgentInfoBC\',false,itema)}}"> <span class="assigneeName">{{itema.agent.firstName}} {{itema.agent.lastName}}</span> </div> </td> </tr></tbody></table></template><template case="false" depth="3"><table><tbody><tr><td is="if" lyte-if="true" value="{{itema.team}}"></td></tr></tbody></table></template></template>'}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,1]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{},actualTemplate:'<template is="if" value="{{itemb.isDateField}}"><template case="true" depth="3"><table><tbody><tr> <td class="relList_dataele"> <span class="cDefault" onmouseover="{{action(\'showToolTipOnClick\',getTimeInUserTZ(itema.customFields[itemb.name],itemb.name,true),this)}}" onmouseout="{{action(\'hideToolTipOnClick\')}}"> {{getTimeInUserTZ(itema.customFields[itemb.name],itemb.name,false)}} </span> </td> </tr></tbody></table></template><template case="false" depth="3"><table><tbody><tr> <td class="relList_dataele">{{itema.customFields[itemb.name]}}</td> </tr></tbody></table></template></template>'}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"if",position:[1,0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"if",position:[1,0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[]}},default:{},actualTemplate:'<template is="if" value="{{itemb.name !=null &amp;&amp; itema[itemb.name] != null}}"><template case="true" depth="3"><table><tbody><tr> <td class="relList_dataele" data-zcqa="ticket_{{itemb.name}}" id="ticket_{{itemb.name}}">{{itema[itemb.name]}}</td> </tr></tbody></table></template><template case="false" depth="3"><table><tbody><tr> <td class="relList_dataele"></td> </tr></tbody></table></template></template>'}]}},default:{},actualTemplate:'<template is="if" value="{{itemb.name==\'status\'}}"><template case="true" depth="3"><table><tbody><tr> <td class="relList_dataele" data-zcqa="ticket_{{itemb.name}}" id="ticket_{{itemb.name}}">{{itema.status}}</td> </tr></tbody></table></template><template case="false" depth="3"><table><tbody><tr><td is="if" lyte-if="true" value="{{expHandlers(expHandlers(itemb.name,\'!=\',null),\'&amp;&amp;\',expHandlers(itema[itemb.name],\'!=\',null))}}"></td></tr></tbody></table></template></template>'}]}},default:{},actualTemplate:'<template is="if" value="{{itemb.name==\'status\' &amp;&amp; (itema.status === \'Escalated\' || itema.status === \'Closed\')}}"><template case="true" depth="3"><table><tbody><tr> <td class="relList_dataele status_{{itema.status}}" data-zcqa="ticket_{{itemb.name}}" id="ticket_{{itemb.name}}">{{itema.status}}</td> </tr></tbody></table></template><template case="false" depth="3"><table><tbody><tr><td is="if" lyte-if="true" value="{{expHandlers(itemb.name,\'==\',\'status\')}}"></td></tr></tbody></table></template></template>'}]}},default:{},actualTemplate:'<template is="if" value="{{itemb.crmPotential}}"><template case="true" depth="3"><table><tbody><tr> <td data-zcqa="deskPotentialtd" class="relList_dataele"><template is="if" value="{{ticketPotentials[itema.id]}}"><template case="true"> <link-to lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;Potentials&quot;,&quot;{{ticketPotentials[itema.id].potentialId}}&quot;]" lt-prop-target="blank">{{ticketPotentials[itema.id].potential}} </link-to> </template></template> </td> </tr></tbody></table></template><template case="false" depth="3"><table><tbody><tr><td is="if" lyte-if="true" value="{{expHandlers(expHandlers(itemb.name,\'==\',\'status\'),\'&amp;&amp;\',expHandlers(expHandlers(itema.status,\'===\',\'Escalated\'),\'||\',expHandlers(itema.status,\'===\',\'Closed\')))}}"></td></tr></tbody></table></template></template>'}]}},default:{},actualTemplate:'<template is="if" value="{{itemb.crmContact}}"><template case="true" depth="3"><table><tbody><tr> <td class="relList_dataele"><template is="if" value="{{emailContacts[itema.email]}}"><template case="true"> <link-to lt-prop-route="crm.tab.module.entity" lt-prop-dp="[&quot;Contacts&quot;,&quot;{{emailContacts[itema.email].contactId}}&quot;]" lt-prop-target="blank">{{emailContacts[itema.email].contact}} </link-to> </template></template> </td> </tr></tbody></table></template><template case="false" depth="3"><table><tbody><tr><td is="if" lyte-if="true" value="{{itemb.crmPotential}}"></td></tr></tbody></table></template></template>'}]}},default:{},actualTemplate:'<template is="if" value="{{itemb.isDateField}}"><template case="true" depth="3"><table><tbody><tr> <td class="relList_dataele"> <span class="cDefault" onmouseover="{{action(\'showToolTipOnClick\',getTimeInUserTZ(itema[itemb.name],itemb.name,true),this)}}" onmouseout="{{action(\'hideToolTipOnClick\')}}"> {{getTimeInUserTZ(itema[itemb.name],itemb.name,false)}} </span> </td> </tr></tbody></table></template><template case="false" depth="3"><table><tbody><tr><td is="if" lyte-if="true" value="{{itemb.crmContact}}"></td></tr></tbody></table></template></template>'}]}},default:{},actualTemplate:'<template is="if" value="{{itemb.isCustomField}}"><template case="true" depth="3"><table><tbody><tr> <td is="if" lyte-if="true" value="{{itemb.isDateField}}"></td> </tr></tbody></table></template><template case="false" depth="3"><table><tbody><tr><td is="if" lyte-if="true" value="{{itemb.isDateField}}"></td></tr></tbody></table></template></template>'}]}},default:{},actualTemplate:'<template is="if" value="{{itemb.assigneeDetail}}"><template case="true" depth="3"><table><tbody><tr> <td is="if" lyte-if="true" value="{{itema.agent}}"></td> </tr></tbody></table></template><template case="false" depth="3"><table><tbody><tr><td is="if" lyte-if="true" value="{{itemb.isCustomField}}"></td></tr></tbody></table></template></template>'}]}},default:{},actualTemplate:'<template is="if" value="{{itemb.mainTicketDetail}}"><template case="true" depth="3"><table><tbody><tr> <td class="relList_dataele mainTicketDetail cP" data-caseid="{{itema.encryptedId}}" onclick="{{action(\'showDeskPopUp\',itema)}}"> <div class="dIB mL5"> <div class="mB5"> <span data-zcqa="ticket_id" class="dIB vaM crm-font-bold">#{{itema.ticketNumber}}</span> <template is="if" value="{{isOverdueFlag(itema.status,itema.dueDate)}}"><template case="true"> <span class="h_duedate h_overdue mL10" onmouseover="{{action(\'showDueDateTooltip\',itema.status,itema.dueDate,this)}}" onmouseout="{{action(\'hideDueDateToolTip\')}}">{{isOverDue(itema.status,itema.dueDate)}}</span> </template></template> </div> <template is="if" value="{{ticketPotentials[itema.id]}}"><template case="true"> <div class="linkToPotImg mT1 dIB vaM {{ticketPotentials[itema.id]}}"> <span class="Potentials-small mR5 vaM mL0"></span> </div> </template></template> <p class="crm-small-font-size tOE oH crm-font-regular dIB vaM" style="max-width: 300px;" onmouseenter="{{action(\'showSubjectTooltip\',itema.subject,this)}}" onmouseleave="{{action(\'hideTooltip\',this)}}">{{itema.subject}}</p> <div class="dIB vaM mL10"> <div class="conversationThreadIcon op03"></div> </div> <div class="dIB pR mR5"> <span class="dIB pA ticketThreadCount aligncenter">{{itema.threadCount}}</span> </div> </div> <div class="dIB fR vaM"> <div class="commentIcon mT13 cP op5"></div> <div class="pR mR30 {{if(ifEquals(itema.commentCount,\'0\'),\'vH\',\'\')}}"> <span class="dIB pA bg_white commentCountCircle aligncenter">{{itema.commentCount}}</span> </div> </div> <div class="cBoth"></div> </td> </tr></tbody></table></template><template case="false" depth="3"><table><tbody><tr><td is="if" lyte-if="true" value="{{itemb.assigneeDetail}}"></td></tr></tbody></table></template></template>'}],actualTemplate:'<template is="for" items="{{ticketKeys}}" item="itemb" index="indexb" depth="3"><table><tbody><tr> <td is="if" lyte-if="true" value="{{itemb.mainTicketDetail}}"></td> </tr></tbody></table></template>',tagName:"TR"}],actualTemplate:'<template is="for" items="{{data}}" item="itema" index="indexa" depth="2"><table><tbody> <tr class="relList_datarow topband_dv_row" id="ticket_{{itema.id}}" data-dept="{{itema.departmentId}}"> <td class="relList_dataele firstCol"> <div class="flipContainer"> <div id="flipCard_{{itema.id}}" class="{{if(flipCardShow,\'flipCard flipped\',\'flipCard\')}}"> <div class="flipFront flipper"> <div class="ticketSourceIconCont"> <div class="ticketSourceIcon {{itema.channel}}_Icon"></div> </div> </div> <div class="flipBack flipper"> <div class="deskRelCkBoxCont"> <div class="mAuto"> <label> <lyte-checkbox id="checkbox_{{itema.id}}" on-checked="{{method(\'onCheckedUpdateRowSelection\',itema.id)}}" on-unchecked="{{method(\'onUnCheckedUpdateRowSelection\',itema.id)}}" lt-prop-checked="false"></lyte-checkbox> <span class="span_ckbox"></span> </label> </div> </div> </div> </div> </div> </td> <td is="for" lyte-for="true" items="{{ticketKeys}}" item="itemb" index="indexb" depth="3"></td> </tr> </tbody></table></template>',tagName:"TBODY"}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,1,0,0]},{type:"attr",position:[1,1,1,2]},{type:"if",position:[1,1,1,2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,0],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"text",position:[1,1,1,0]}]}},default:{},actualTemplate:'<template is="if" value="{{ticketError}}"><template case="true" depth="2"><table><tbody> <tr> <td colspan="15"> <div class="norec pR30 fontsmooth"><span class="mR8 dIB">{{getI18n(ticketError)}}</span> <template is="if" value="{{portalUser}}"><template case="true"> <lyte-button lt-prop-appearance="primary" lt-prop-class="outlineprimary" lt-prop-size="small" data-zcqa="noTicket_newTicketLink1" class="{{if(noTicketnewTicketLinkShow,\'crm-rl-write-action\',\'dN\')}}" onclick="{{action(\'showCreateTicketPopup\')}}"><template is="registerYield" yield-name="text">{{getI18n(\'crm.zdesk.newticket\')}}</template></lyte-button> </template></template> </div> </td> </tr> </tbody></table></template><template case="false" depth="2"><table><tbody> <tr> <td colspan="15"> <div class="norec pR30">{{fetchingTicketsText}}</div> </td> </tr> </tbody></table></template></template>'}]}},default:{},actualTemplate:'<template is="if" value="{{data.length>0}}"><template case="true" depth="2"><table><tbody> <tr is="for" lyte-for="true" items="{{data}}" item="itema" index="indexa" depth="2"></tr> </tbody></table></template><template case="false" depth="2"><table><tbody><tr is="if" lyte-if="true" value="{{ticketError}}"></tr></tbody></table></template></template>'},{type:"attr",position:[15]},{type:"if",position:[15],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"registerYield",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1,1,1,1]},{type:"text",position:[1,1,3,1,1,0]},{type:"attr",position:[1,1,3,3]},{type:"text",position:[1,1,3,3,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,3]}],_observedAttributes:["module","entityId","related_list_id","loading","rlData","showNavigation","showPrevNav","showNextNav","fromIndex","toIndex","pageNum","ticketHeadings","ticketKeys","ticketFields","ticketStats","data","deskError","deskErrorMessage","ticketPotentials","contactServerUrl","emailContacts","portalUser","datePattern","defaultTimePatternShow","supportObj","email","allFields","selectedFields","ticketError","entity_id","rendered_from","showIframeUrl","iframeshow","imgsrc","detailTicketId","selectRowId","currentUser","selectedRowCount","module_emailColumns","flipCardShow","deskTicketsSummaryShow","updateableFields","emails","selectedFields","loadCruxColumn","ticketcreationshow","ticketcreationurl","desk_contactname","desk_accountname","desk_contactemail","desk_contactphone","desk_productName","desk_encryptedContactId","desk_encryptedProductId","desk_encryptedAccountId","url_desk","url_potentials","url_field_properties","deskUrl","crmsupportzgid","crmUrl","fieldProps","showCruxColumn","rowCountVis","agents","deptAgents","linkToThisPotentialShow","ticketFieldUpdatePopupShow","newticketlinkshow","deskTicketFilterShow","ticketsStatsLinkShow","showColumnShow","ticketSelectShow","totalTickets","overdueTickets","avgSolTimeSpan","avgResTimeSpan","ticketStatsLinkText","fieldUpdSelectOptionShow","fieldUpdTextOptionShow","plainTextShow","dateTextShow","leftPanelCount","fieldObjType","fieldObjMaxLength","deskupdateFieldMsgText","deskRelatedListMenuShow","deskTheadRowShow","noTicketnewTicketLinkShow","fieldUpSelectData","textInputValue","dateInputValue","timeInputValue","newTimeInputValue","cusHapRateValue","cusHapRateShow","Smileytype","noHapShow","errorFieldShow","errorFieldMsg","bcAgentInfoText","agentEmailText","agentEmailHref","popoverbind","agentpopovershow","portalName","scrollenable","fetchingTicketsText","noResult","ticketDetailPrevShow","ticketDetailNextShow","cruxcolumShowfromfilter","fieldtodisable","ticketFilterSelectClass","encryptedZuid","isRlLyteNew"],data:function(){return{module:Lyte.attr("string"),entityId:Lyte.attr("string"),related_list_id:Lyte.attr("string"),loading:Lyte.attr("boolean",{default:!0}),rlData:Lyte.attr("object"),showNavigation:Lyte.attr("boolean",{default:!1}),showPrevNav:Lyte.attr("boolean",{default:!1}),showNextNav:Lyte.attr("boolean",{default:!1}),fromIndex:Lyte.attr("number",{default:1}),toIndex:Lyte.attr("number",{default:7}),pageNum:Lyte.attr("number",{default:0}),ticketHeadings:Lyte.attr("array",[]),ticketKeys:Lyte.attr("array"),ticketFields:Lyte.attr("array"),ticketStats:Lyte.attr("object"),data:Lyte.attr("array"),deskError:Lyte.attr("boolean",{default:!1}),deskErrorMessage:Lyte.attr("string",{default:"No Error"}),ticketPotentials:Lyte.attr("object"),contactServerUrl:Lyte.attr("string",{default:null}),emailContacts:Lyte.attr("object"),portalUser:Lyte.attr("boolean",{default:!1}),datePattern:Lyte.attr("string",{default:"MM/dd/yyyy"}),defaultTimePatternShow:Lyte.attr("boolean",{default:!1}),supportObj:Lyte.attr("object"),email:Lyte.attr("array"),allFields:Lyte.attr("array"),selectedFields:Lyte.attr("array"),ticketError:Lyte.attr("string"),entity_id:Lyte.attr("string"),rendered_from:Lyte.attr("string"),showIframeUrl:Lyte.attr("boolean",{default:!1}),iframeshow:Lyte.attr("boolean",{default:!0}),imgsrc:Lyte.attr("string"),detailTicketId:Lyte.attr("string",{default:""}),selectRowId:Lyte.attr("array",[]),currentUser:Lyte.attr("object",{default:{}}),selectedRowCount:Lyte.attr("number",{default:0}),module_emailColumns:Lyte.attr("array",{default:["EMAIL","ADDN_EMAIL"]}),flipCardShow:Lyte.attr("boolean",{default:!1}),deskTicketsSummaryShow:Lyte.attr("boolean",{default:!1}),updateableFields:Lyte.attr("array"),emails:Lyte.attr("array"),selectedFields:Lyte.attr("array"),loadCruxColumn:Lyte.attr("boolean",!1),ticketcreationshow:Lyte.attr("boolean",!1),ticketcreationurl:Lyte.attr("string"),desk_contactname:Lyte.attr("string",{default:null}),desk_accountname:Lyte.attr("string",{default:null}),desk_contactemail:Lyte.attr("string",{default:null}),desk_contactphone:Lyte.attr("string",{default:null}),desk_productName:Lyte.attr("string",{default:null}),desk_encryptedContactId:Lyte.attr("string",{default:null}),desk_encryptedProductId:Lyte.attr("string",{default:null}),desk_encryptedAccountId:Lyte.attr("string",{default:null}),url_desk:Lyte.attr("string",{default:Crm.getCrmBasePath()+"/deskIntegration.do"}),url_potentials:Lyte.attr("string",{default:Crm.getCrmBasePath()+"/Search.do?searchmodule=Potentials"}),url_field_properties:Lyte.attr("string",{default:null}),deskUrl:Lyte.attr("string",{default:""}),crmsupportzgid:Lyte.attr("string",{default:""}),crmUrl:Lyte.attr("string",{default:""}),fieldProps:Lyte.attr("object",{}),showCruxColumn:Lyte.attr("boolean",{default:!1}),rowCountVis:Lyte.attr("number",{default:7}),agents:Lyte.attr("object"),deptAgents:Lyte.attr("object"),linkToThisPotentialShow:Lyte.attr("boolean",{default:!1}),ticketFieldUpdatePopupShow:Lyte.attr("boolean",{default:!1}),newticketlinkshow:Lyte.attr("boolean",{default:!1}),deskTicketFilterShow:Lyte.attr("boolean",{default:!1}),ticketsStatsLinkShow:Lyte.attr("boolean",{default:!1}),showColumnShow:Lyte.attr("boolean",{default:!0}),ticketSelectShow:Lyte.attr("boolean",{default:!1}),totalTickets:Lyte.attr("string",{default:"0"}),overdueTickets:Lyte.attr("string",{default:"0"}),avgSolTimeSpan:Lyte.attr("string",{default:"00:00"}),avgResTimeSpan:Lyte.attr("string",{default:"00:00"}),ticketStatsLinkText:Lyte.attr("string"),fieldUpdSelectOptionShow:Lyte.attr("boolean",{default:!0}),fieldUpdTextOptionShow:Lyte.attr("boolean",{default:!1}),plainTextShow:Lyte.attr("boolean",{default:!1}),dateTextShow:Lyte.attr("boolean",{default:!0}),leftPanelCount:Lyte.attr("string",{default:"0"}),fieldObjType:Lyte.attr("string",{default:"text"}),fieldObjMaxLength:Lyte.attr("string",{default:"200"}),deskupdateFieldMsgText:Lyte.attr("string"),deskRelatedListMenuShow:Lyte.attr("boolean",{default:!1}),deskTheadRowShow:Lyte.attr("boolean",{default:!1}),noTicketnewTicketLinkShow:Lyte.attr("boolean",{default:!1}),fieldUpSelectData:Lyte.attr("array",[]),textInputValue:Lyte.attr("string",{default:""}),dateInputValue:Lyte.attr("string"),timeInputValue:Lyte.attr("string"),newTimeInputValue:Lyte.attr("string"),cusHapRateValue:Lyte.attr("string",{default:"0%"}),cusHapRateShow:Lyte.attr("boolean",{default:!1}),Smileytype:Lyte.attr("string"),noHapShow:Lyte.attr("boolean",{default:!0}),errorFieldShow:Lyte.attr("boolean",{default:!1}),errorFieldMsg:Lyte.attr("string"),bcAgentInfoText:Lyte.attr("string"),agentEmailText:Lyte.attr("string"),agentEmailHref:Lyte.attr("string"),popoverbind:Lyte.attr("string"),agentpopovershow:Lyte.attr("boolean",{default:!1}),portalName:Lyte.attr("string"),scrollenable:Lyte.attr("boolean",{default:!1}),fetchingTicketsText:Lyte.attr("string",{default:I18n.getMsg("crm.zdesk.fetchingtickets")}),noResult:Lyte.attr("string",{default:"none"}),ticketDetailPrevShow:Lyte.attr("boolean",{default:!1}),ticketDetailNextShow:Lyte.attr("boolean",{default:!1}),cruxcolumShowfromfilter:Lyte.attr("boolean",{default:!1}),fieldtodisable:Lyte.attr("array",[]),ticketFilterSelectClass:Lyte.attr("string",{default:""}),encryptedZuid:Lyte.attr("string",{default:Crm.userDetails.ZUID}),isRlLyteNew:Lyte.attr("boolean",{default:Crm.userDetails.isRelatedListLyteEnabled})}},init:function(){Lyte.injectResources([networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("zdeskrelatedlist")],ResourceConstants.CRM)],void 0,void 0);var t=this,e=!0,a=document.querySelector("#ticketFilterSelect"),i="All",o={module:t.getData("module"),moduleId:t.getData("entity_id"),entId:t.getData("entity_id"),deskstats:"true",action:"getEntityTickets"};this.setData("module",this.getData("module")),this.setData("entityId",this.getData("entity_id")),this.setData("related_list_id",this.getData("related_list_id")),this.setData("deskTicketFilterShow",!1),this.setData("newticketlinkshow",!1),this.setData("deskRelatedListMenuShow",!1),this.setData("deskTheadRowShow",!1),store.findAll("zdesk_integ_rl",o,!1,!1).then((function(o){o=o.zdesk_integ_rl;var s=$("[id='addNewIcP_Zoho Desk']");if(validationUtils.isNotEmpty(o)){var n=o.SupportObj;if(!n)return void t.setData("fetchingTicketsText",I18n.getMsg("crm.zdesk.contactadmin"));t.setData("fetchingTicketsText",I18n.getMsg("crm.zdesk.fetchingtickets")),n.datePattern?t.setData("ticketStatsLinkText",I18n.getMsg("crm.zdesk.hidestats")):t.setData("ticketStatsLinkText",I18n.getMsg("crm.zdesk.showstats"));var l=n.portalUser,r=n.datePattern,d=document.querySelector("crm-zdesk-rl-label");t.initializeData(),t.setData("portalUser",l),t.setData("datePattern",r),"hh:mm a"===Crm.userDetails.TIME_FORMAT&&t.setData("defaultTimePatternShow",!0),t.updateDetailsForRL(n);if(n.potentialModule&&n.potentialTickets>0&&"Potentials",t.setData("portalName",o.portalName),t.setData("supportObj",n),t.setData("crmsupportzgid",o.crmsupportzgid),t.executeMethod("populateIntegDetails",o),o.hasOwnProperty("emails")&&(t.setData("email",o.emails),"crm.zdesk.notickets"===o.ticketError&&t.displayDeskWindow()&&(t.setData("noTicketnewTicketLinkShow",!0),s.removeClass("dN"),d&&d.component&&d.component.setData("refreshIconShow",!0))),o.hasOwnProperty("deskError")){t.setData("deskError",o.hasOwnProperty("deskError"));var p=o.deskError;t.setData("deskErrorMessage",p),t.setData("deskTicketFilterShow",!1),t.setData("deskTheadRowShow",!1),t.setData("newticketlinkshow",!1),t.setData("deskRelatedListMenuShow",!1)}else o.hasOwnProperty("ticketError")&&"crm.zdesk.notickets"===o.ticketError?(e=!1,t.setData("ticketError",o.ticketError),t.setData("data",[]),t.setData("deskTicketFilterShow",!1),t.setData("deskTheadRowShow",!1),t.setData("newticketlinkshow",!1),t.setData("deskRelatedListMenuShow",!1)):o.hasOwnProperty("tickets")&&d&&d.component.setData("refreshIconShow",!0);if(t.getData("portalUser")?s.removeClass("dN"):s.addClass("dN"),t.setDeskTicketData(o),e&&(null!==a&&(i=a.ltProp("selected")),n.potentialModule&&n.potentialTickets>0?(document.querySelector("#ticketFilterSelect").ltProp("selected","Potentials"),t.setData("linkToThisPotentialShow",!1)):n.potentialModule&&"Potentials"!=i&&t.setData("linkToThisPotentialShow",!0)),o.hasOwnProperty("ticketStats")&&null!==o.ticketStats)if("Products"===t.getData("module")){var c=o.ticketStats.encryptedProductId;t.setData("desk_encryptedProductId",c),"crm.zdesk.notickets"===o.ticketError&&t.displayDeskWindow()&&(t.setData("noTicketnewTicketLinkShow",!0),s.removeClass("dN"),d&&d.component.setData("refreshIconShow",!0))}else if("Contacts"===t.getData("module")&&!o.hasOwnProperty("emails")&&o.ticketStats.encryptedContactId){var m=o.ticketStats.encryptedContactId;t.setData("desk_encryptedContactId",m),"crm.zdesk.notickets"===o.ticketError&&t.displayDeskWindow()&&(t.setData("noTicketnewTicketLinkShow",!0),s.removeClass("dN"),d&&d.component.setData("refreshIconShow",!0)),t.setData("ticketStats",u),t.summarizeTickets(o)}else{var u=o.ticketStats;t.setData("ticketStats",u),t.summarizeTickets(o)}}else t.setData("ticketError","No records found"),$("#newleft_"+t.getData("related_list_id")).find("span.numCountn").removeClass("numCountVal").text(" "),s.addClass("dN")}))},didConnect:function(){Crm.userDetails.detailView_newUI&&$L("#ticketsDropDiv").scroll({preventVertical:!0})},linkToPotentialFunc:function(t){if(t&&t.id&&(t=t.id),Crm.trackSpotLightAction("ZDesk - Ticket Link Potential"),!t){if("Potentials"!==this.getData("module"))return;t=this.getData("entityId")}renderingUtils.freezeBackground();var e=this.getData("selectRowId"),a={potentialId:t,ticketIds:JSON.stringify(e),action:"linkToPotential"},i=this;store.createRecord("dummy"),commonUtils.showHideLoadingDiv(!0),store.create("dummy",void 0,{url:this.getData("url_desk"),method:"POST"},a).then((function(t){commonUtils.showHideLoadingDiv();var e=t.dummy;if("success"===e.status){var a=e.linkedTickets,o=a.length,s={},n={};n.potentialId=e.potentialId,n.potential=e.potentialName;var l=i.data.ticketPotentials;if(Object.keys(i.data.ticketPotentials).length>0){s=l;for(var r=0;r<o;r++)Lyte.objectUtils(l,"add",a[r],n),$("#ticket_"+a[r]).addClass("deskBgAnim")}else{for(r=0;r<o;r++)s[a[r]]=n,$("#ticket_"+a[r]).addClass("deskBgAnim");i.setData("ticketPotentials",s)}i.executeMethod("getDeskTickets",i.getCurrentTicketPage(),void 0,void 0,void 0,void 0),i.actions.clearSelect.call(i);setTimeout((function(){i.executeMethod("removeAnimClass",a)}),2e3),crmui.showMsgBand("success",I18n.getMsg(e.message),3e3)}else crmui.showMsgBand("error",I18n.getMsg(e.message),3e3);renderingUtils.removeFreezeLayer()}))},actions:{showDeskPopUp:function(t){this.setData("showIframeUrl",!1),this.executeMethod("loadCurrentUserInfo",t),Crm.userDetails.isRelatedListLyteEnabled?this.executeMethod("handleScroll",!0):deskInteg.handleScroll(!0)},showSubjectTooltip:function(t,e){e.scrollWidth>e.offsetWidth&&crmui.toolTip_show(e,"left",t)},hideTooltip:function(){crmui.toolTip_hide()},showDueDateTooltip:function(t,e,a){if("Closed"!==t&&e){var i=new Date(e),o=(new Date).getTime()-i.getTime();if(o>0){var s,n=o/36e5,l="";if((n=Math.floor(n))>24){var r=n/24;n%=24,l=(r=Math.floor(r))+" Days "}s="Late by "+(l=l+n+" Hours"),crmui.showTooltip(s,!1,"left",a)}}},hideDueDateToolTip:function(){crmui.hideTooltip()},showHideAgentInfoBC:function(t,e){if(t){var a=e.agent;this.setData("popoverbind","#ticket_agent_"+e.id),this.setData("agentEmailText",a.emailId),this.setData("agentEmailHref","mailto:"+a.emailId);var i=this.getData("contactServerUrl")+"/file?ID="+a.zuid+"&fs=thumb";this.setData("imgsrc",i),this.setData("bcAgentInfoText",a.firstName+" "+a.lastName),this.setData("agentpopovershow",!0)}else this.setData("agentpopovershow",!1)},cruxcolumnshow:function(){$L("#chooseColumnsFilterDD")[0].ltProp("show",!0),this.setData("showCruxColumn",!0)},clearSelect:function(t){this.setData("flipCardShow",!1);var e=this.getData("selectRowId");this.setData("selectRowId",[]),this.setSelectedRowCount("zero"),this.ticketActionDisplay(t),e.forEach((function(t){var e=document.getElementById("checkbox_"+t);e&&e.ltProp("checked",!1)}))},showTktFldUpdPop:function(t){var e=this.getData("updateableFields"),a=this;if(a.setData("fieldtodisable",[]),e){var i=document.querySelector("#updateFieldName");if(a.getData("fieldProps")){for(var o=[],s=t.length,n=0;n<s;n++){var l=t[n],r=a.getData("fieldProps");r[l.name]&&o.push(r[l.name])}a.setData("updateableFields",o);var d=a.getData("updateableFields");0===d.filter((function(t){return t.name===i})).length&&(i.ltProp("selected",d[0].name),a.setData("fieldUpdSelectOptionShow",!1),a.setData("fieldObjType",d[0].type),a.setData("maxlength",d[0].maxLength),a.setData("dateTextShow",!1),a.setData("plainTextShow",!0),a.setData("fieldUpdTextOptionShow",!0),a.setData("textInputValue",""),a.setData("deskupdateFieldMsgText",I18n.getMsg("crm.zdesk.update.enter",d[0].i18NLabel)))}if(a.setData("ticketFieldUpdatePopupShow",!0),a.getData("selectedRowCount")>1){if("assigneeId"==i.ltProp("selected")){o=a.getData("updateableFields");i.ltProp("selected",o[0].name),a.setData("fieldUpdSelectOptionShow",!1),a.setData("fieldObjType",o[0].type),a.setData("maxlength",o[0].maxLength),a.setData("dateTextShow",!1),a.setData("plainTextShow",!0),a.setData("fieldUpdTextOptionShow",!0),a.setData("deskupdateFieldMsgText",I18n.getMsg("crm.zdesk.update.enter",o[0].i18NLabel))}var p=t.filter((function(t){return"assigneeId"===t.name}));p.length>0&&Lyte.arrayUtils(a.getData("fieldtodisable"),"push",p[0].name)}}else this.loadFieldProperties((function(){for(var e=[],i=t.length,o=0;o<i;o++){var s=t[o],n=a.getData("fieldProps");n[s.name]&&e.push(n[s.name])}if(a.setData("ticketFieldUpdatePopupShow",!0),a.setData("updateableFields",e),a.getData("selectedRowCount")>1){var l=t.filter((function(t){return"assigneeId"===t.name}));l.length>0&&Lyte.arrayUtils(a.getData("fieldtodisable"),"push",l[0].name)}document.querySelector("#updateFieldName").ltProp("selected",e[0].name),a.setData("fieldUpdSelectOptionShow",!1);var r=e[0].type,d=e[0].maxLength;a.setData("fieldObjType",r),a.setData("maxlength",d),a.setData("dateTextShow",!1),a.setData("plainTextShow",!0),a.setData("fieldUpdTextOptionShow",!0),a.setData("deskupdateFieldMsgText",I18n.getMsg("crm.zdesk.update.enter",e[0].i18NLabel))}));Crm.trackSpotLightAction("ZDesk - Update Ticket Popup ")},updateFields:function(t,e){var a=this.getData("module"),i=this.getData("entity_id");Crm.trackSpotLightAction("ZDesk - Ticket Update");var o={isCustomField:!1};if(!t){t=document.querySelector("#updateFieldName").ltProp("selected"),o=this.getData("fieldProps")[t];var s=!0;switch(e=this.getData("textInputValue"),o.type){case"Phone":case"Number":s=validationUtils.isValidInteger(e);break;case"Email":s=validationUtils.isValidEmail(e);break;case"Text":s=""!==e&&e.length<=o.maxLength;break;case"LookUp":case"Picklist":e=document.querySelector("#fieldUpdSelect").ltProp("selected");break;case"DateTime":var n,l=this.getData("dateInputValue");e=l+" "+(n="hh:mm a"===Crm.userDetails.TIME_FORMAT?this.getData("timeInputValue"):this.getData("newTimeInputValue")),s=l&&n}if(!s)return this.setData("errorFieldMsg",I18n.getMsg("crm.field.valid.check",o.i18NLabel)),void this.setData("errorFieldShow",!0)}var r={fieldName:t,fieldValue:e,isCustomField:o.isCustomField,fieldType:o.type};r.ids=this.getData("selectRowId");var d={ticketType:this.getCurrentTicketType(a),module:a,moduleId:i,action:"updateTickets"};d.pageToken=this.getCurrentTicketPage();var p=this.getKeyValueForTicketCriteria();d[p.key]=p.value,d.ticketJson=JSON.stringify(r);var c=this,m=this.getData("data").length,u=r.ids;store.createRecord("dummy"),commonUtils.showHideLoadingDiv(!0),store.create("dummy",void 0,{url:this.getData("url_desk"),method:"POST"},d).then((function(t){commonUtils.showHideLoadingDiv();var e=t.dummy;c.setData("data",e.tickets),e.ticketError&&c.setData("ticketError",e.ticketError),c.setData("ticketPotentials",e.ticketPotentials),c.setData("ticketKeys",e.ticketKeys),c.setData("showNavigation",!1),e.hasOwnProperty("page")&&c.executeMethod("setLyteNavigatorValues",e),c.actions.closeTicketUpdatePop.call(c),c.actions.clearSelect.call(c,m),c.setData("rowCountVis",e.tickets?e.tickets.length:0);for(var a=u.length,i=0;i<a;i++)$("#ticket_"+u[i]).addClass("deskBgAnim");setTimeout((function(){c.executeMethod.removeAnimClass(u)}),2e3)}),(function(){c.actions.closeTicketUpdatePop.call(c)}))},populatePotentialPopup:function(){var t=this.getData("module"),e=this.getData("entity_id"),a=[],i=this.getData("url_potentials");("Accounts"===t?(i=i+"&accountId="+e,a=[{api_name:"Account_Name",comparator:"equals",value:e}]):"Contacts"===t&&(a=[{api_name:"Contact_Name",comparator:"equals",value:e}],i=i+"&productId="+e),i+="&newModel=true",i+="&fromzdesk=true",Crm.userDetails.isLookupAdvancedSearchEnabled)?Lyte.Component.render("crux-lookup-filter-modal",{modId:moduleRecordMapping.Potentials.id,cxPropDefaultCriteria:a},"#linkToPotential").setMethods({onValueChange:this.linkToPotentialFunc.bind(this)}):commonUtils.openCustomLookup(i,void 0,"topBandPopup",renderingUtils.windowWidth-300,void 0,void 0,void 0,!0)},saveColModify:function(){var t=this.getData("module"),e=this.getData("entity_id");Crm.trackSpotLightAction("ZDesk - Ticket Columns Update");var a=$L("crux-column-list")[0].component.getSelectedFields(),i=[];a.forEach((function(t){i.push(t.name)}));var o={ticketType:this.getCurrentTicketType(t),module:t,moduleId:e,deskstats:!0,action:"updateTicketFields"};o.pageToken=this.getCurrentTicketPage(),o.fields=JSON.stringify(i);var s=this.getKeyValueForTicketCriteria(),n=this;o[s.key]=s.value,store.createRecord("dummy"),commonUtils.showHideLoadingDiv(!0),store.create("dummy",void 0,{url:this.getData("url_desk"),method:"POST"},o).then((function(t){commonUtils.showHideLoadingDiv();var e=t.dummy;n.setData("data",e.tickets),e.ticketError&&n.setData("ticketError",e.ticketError),e.hasOwnProperty("ticketPotentials")&&n.setData("ticketPotentials",e.ticketPotentials),n.setData("ticketKeys",e.ticketKeys),n.setData("ticketHeadings",e.ticketHeadings),e.hasOwnProperty("ticketStats")&&n.setData("ticketStats",e.ticketStats),n.setData("ticketFields",e.ticketFields),n.setData("rowCountVis",e.tickets?e.tickets.length:0),n.setData("showCruxColumn",!1)}))},cancelChooseColumns:function(){this.setData("showCruxColumn",!1)},deleteTickets:function(){var t=this.getData("module"),e=this.getData("entity_id");Crm.trackSpotLightAction("ZDesk - Ticket Delete");var a={ticketType:this.getCurrentTicketType(t),module:t,moduleId:e,action:"deleteTickets"};this.setData("noTicketnewTicketLinkShow",!1),a.pageToken=this.getCurrentTicketPage();var i=this.getKeyValueForTicketCriteria();a[i.key]=i.value;var o=this,s=this.getData("data").length,n={ids:this.getData("selectRowId")};a.ticketJson=JSON.stringify(n),commonUtils.showHideLoadingDiv(!0),store.createRecord("dummy"),store.create("dummy",void 0,{url:this.getData("url_desk"),method:"POST"},a).then((function(t){commonUtils.showHideLoadingDiv();var e=t.dummy;o.actions.hideAnimatePopup("deleteDeskTicketConfirmation"),o.setData("data",e.tickets),e.ticketError&&o.setData("ticketError",e.ticketError),o.setData("showNavigation",!1),e.hasOwnProperty("ticketPotentials")&&o.setData("ticketPotentials",e.ticketPotentials),e.hasOwnProperty("page")&&o.executeMethod("setLyteNavigatorValues",e),o.setData("ticketKeys",e.ticketKeys),e.ticketError&&o.setData("ticketError",e.ticketError),o.setData("rowCountVis",e.tickets?e.tickets.length:0),o.actions.clearSelect.call(o,s)}),(function(){o.actions.hideAnimatePopup("deleteDeskTicketConfirmation")}))},showCreateTicketPopup:function(){var t,e=!1,a=this.getData("deskUrl"),i=this.getData("portalName"),o=this.getData("crmUrl"),s=this.getData("module");"undefined"!=typeof CrmPlusLib&&CrmPlusLib.isLoadedInCrmplusFrame&&CrmPlusLib.getFrameOriginForURL&&(o=CrmPlusLib.getFrameOriginForURL()+","+o),this.getData("portalUser")&&Crm.userDetails.zDeskIntegration&&Crm.userDetails.zDeskIntegration.portalName&&Crm.userDetails.zDeskIntegration.ticketModName?(e=!0,t=(t="//"+a+"/agent/"+Crm.userDetails.zDeskIntegration.portalName+"/all/"+Crm.userDetails.zDeskIntegration.ticketModName)+"/new?frameorigin="+encodeURIComponent(o)+"&fromService=zohocrm#set?subject="):(e=!1,t="//"+a+"/support/"+i+"/ShowHomePage.do?frameorigin="+encodeURIComponent(o),t+="&isDeskAddOnRequest=true#Cases/new?isDeskAddOnRequest=true");var n,l,r="Potentials"===s,d=moduleRecordMapping[s].id,p=Lyte.Router.getRouteInstance().routeName,c=this.getData("desk_contactemail"),m=this.getData("desk_contactname"),u=this.getData("desk_productname"),y=this.getData("desk_accountname"),h=this.getData("desk_encryptedContactId"),k=this.getData("desk_encryptedAccountId"),g=this.getData("desk_encryptedProductId"),f=this.getData("desk_contactphone");if(l="canvas"===p&&store.peekAll(d)[0].hasOwnProperty("Last_Name")?store.peekAll(d)[0].Last_Name:$L("#subvalue_LASTNAME").text(),"canvas"===p&&r?n=store.peekAll(d)[0].Contact_Name.name:"canvas"!==p&&r&&(n=$L("#associatedContName").val()),Crm.trackSpotLightAction("ZDesk - Create Ticket",{Module:s}),!c)if(r){var D=$("#associatedContEmail").val();this.setData("desk_contactemail",D&&validationUtils.isValidEmail(D)?D:c)}else{var v=this.getKeyValueForTicketCriteria();"email"===v.key&&this.setData("desk_contactemail",v.value.split(",")[0])}if(!m&&"Accounts"!==s&&(this.setData("desk_contactname",r?n:l),!this.getData("desk_contactname"))){var w=$L("#entityName").val();this.setData("desk_contactname",w)}"Products"===s&&"canvas"!==p&&this.setData("desk_productname",$("#subvalue_PRODUCTNAME").text()),y||"canvas"!==p?y||(Crm.userDetails.isRelatedListLyteEnabled?this.setData("desk_accountname","Accounts"===this.getData("module")?$L("#subvalue_ACCOUNTNAME").text():$L("#subvalue_ACCOUNTID").text()):this.setData("desk_accountname","Accounts"===crmRelatedList.Module?$("#subvalue_ACCOUNTNAME").text():$("#subvalue_ACCOUNTID").text())):this.setData("desk_accountname","Accounts"===s?store.peekAll(d)[0].Account_Name:""),m=this.getData("desk_contactname"),u=this.getData("desk_productname"),c=this.getData("desk_contactemail"),y=this.getData("desk_accountname"),e||(m&&(t=t+"&"+encodeURIComponent("property(Contact Name)")+"="+encodeURIComponent(m)),u&&(t=t+"&"+encodeURIComponent("property(Product Name)")+"="+encodeURIComponent(u)),y&&(t=t+"&"+encodeURIComponent("property(Account Name)")+"="+encodeURIComponent(y))),h&&(t=e?t+"&"+encodeURIComponent("contactId")+"="+h:t+"&"+encodeURIComponent("property(whoName:Contact Name)")+"="+h),k&&(t=e?t+"&"+encodeURIComponent("accountId")+"="+k:t+"&"+encodeURIComponent("property(actName:Account Name)")+"="+k),g&&(t=e?t+"&"+encodeURIComponent("productId")+"="+g:t+"&"+encodeURIComponent("property(prodName:Product Name)")+"="+g),c&&(t=e?t+"&"+encodeURIComponent("email")+"="+encodeURIComponent(c):t+"&"+encodeURIComponent("property(Email)")+"="+encodeURIComponent(c)),f&&(t=e?t+"&"+encodeURIComponent("phone")+"="+encodeURIComponent(f):t+"&"+encodeURIComponent("property(Phone)")+"="+encodeURIComponent(f)),this.setData("ticketcreationurl",t),this.setData("ticketcreationshow",!0),Crm.userDetails.isRelatedListLyteEnabled?this.executeMethod("handleScroll",!0):deskInteg.handleScroll(!0)},hideCreateTicketPopup:function(){this.setData("ticketcreationurl"," "),this.setData("ticketcreationshow",!1),this.getData("newticketlinkshow")?this.executeMethod("getDeskTickets",this.getCurrentTicketPage(),!0,void 0,void 0,!0):this.executeMethod("getDeskTickets",this.getCurrentTicketPage(),!0,void 0,void 0,void 0),Crm.userDetails.isRelatedListLyteEnabled?this.executeMethod("handleScroll",!0):deskInteg.handleScroll(!1)},hideSubjectTooltip:function(){crmui.toolTip_hide()},showToolTip:function(t,e,a){crmui.showTooltip(t,e,a)},closeTicketUpdatePop:function(){this.setData("errorFieldShow",!1),document.querySelector("#tktFldPop").setData("ltPropShow",!1)},toggleStats:function(){var t=this.getData("deskTicketsSummaryShow"),e={viewStats:t,action:"manageStats"};t?($L("#deskTicketsSummary").slideUp(),this.setData("deskTicketsSummaryShow",!1),this.setData("ticketStatsLinkText",I18n.getMsg("crm.zdesk.showstats"))):($L("#deskTicketsSummary").slideDown(),this.setData("deskTicketsSummaryShow",!0),this.setData("ticketStatsLinkText",I18n.getMsg("crm.zdesk.hidestats"))),store.createRecord("dummy"),store.create("dummy",void 0,{url:this.getData("url_desk"),method:"POST"},e)},showAnimatePopup:function(t){var e=document.getElementById(t);e.setData("ltPropShow",!0),e.setData("ltPropOffset",{top:"0px",left:"center"})},hideAnimatePopup:function(t){document.getElementById(t).setData("ltPropShow",!1)},linkToPotential:function(t){this.linkToPotentialFunc(t)},unlinkTickets:function(){var t={potentialId:0,action:"linkToPotential"},e=this.getData("selectRowId");t.ticketIds=JSON.stringify(e);var a=e,i=e.length,o=this;store.createRecord("dummy"),commonUtils.showHideLoadingDiv(!0),store.create("dummy",void 0,{url:this.getData("url_desk"),method:"POST"},t).then((function(t){commonUtils.showHideLoadingDiv();var e=t.dummy;if("success"===e.status){if("Potentials"==o.getCurrentTicketType(o.getData("module")))o.executeMethod("getDeskTickets",o.getCurrentTicketPage(),void 0,void 0,void 0,void 0);else{for(var s=o.data.ticketPotentials,n=0;n<i;n++)Lyte.objectUtils(s,"delete",a[n]),$("#ticket_"+a[n]).addClass("deskBgAnim");setTimeout((function(){o.executeMethod.removeAnimClass(a)}),2e3)}o.actions.clearSelect.call(o),crmui.showMsgBand("success",I18n.getMsg(e.message),3e3)}else crmui.showMsgBand("error",I18n.getMsg(e.message),3e3)}),(function(){crmui.showMsgBand("error",I18n.getMsg("crm.zdesk.err.unlink"),3e3)}))},showPortalEvent:function(t,e){event&&(event.cancelBubble=!0,event.stopPropagation&&event.stopPropagation()),$L(e).next().show()},showToolTipOnClick:function(t,e){crmui.showTooltip(t,!1,"center",e)},hideToolTipOnClick:function(){crmui.hideTooltip()},setStyle:function(){document.getElementById("loadMsg").style.display="none"}},methods:{onSearch:function(t){this.setData("noResult",0===t.length?"block":"none")},handleScroll:function(t){var e=$L("#dvinner");if(t)$L("#scrollTopDiv").hide(),e.css("overflow","hidden");else{var a=e.scrollTop();e.css("overflow","auto"),e.scrollTop(a-1)}},clearSelectEntry:function(){var t=document.getElementById("dropdownSearch");t&&t.setValue("")},removeAnimClass:function(t){for(var e=t.length,a=0;a<e;a++)$("#ticket_"+t[a]).removeClass("deskBgAnim")},onCheckedUpdateRowSelection:function(t){-1==this.getData("selectRowId").indexOf(t)&&(Lyte.arrayUtils(this.getData("selectRowId"),"push",t),this.setSelectedRowCount("increment"));var e=$("#flipCard_"+t);e.removeClass("flipCard"),e.addClass("flipCard flipped"),this.ticketActionDisplay()},onUnCheckedUpdateRowSelection:function(t){var e=this.getData("selectRowId").indexOf(t);Lyte.arrayUtils(this.getData("selectRowId"),"splice",e,1),this.setSelectedRowCount("decrement");var a=$("#flipCard_"+t);a.removeClass("flipCard flipped"),a.addClass("flipCard"),this.ticketActionDisplay()},next:function(t){var e=this.getData("pageNum");e+=1,this.executeMethod("getDeskTickets",e,void 0,t,void 0,void 0)},prev:function(t){var e=this.getData("pageNum");e-=1,t?this.executeMethod("getDeskTickets",e,void 0,t,!0,void 0):this.executeMethod("getDeskTickets",e,void 0,t,void 0,void 0)},loadCurrentUserInfo:function(t){var e=this.getData("currentUser"),a=this,i=this.getData("url_desk");commonUtils.showHideLoadingDiv(!0),this.getData("portalUser")&&validationUtils.isEmpty(e)?store.findAll("dummy",{action:"getMyDeskInfo"},void 0,!1,{url:i}).then((function(e){commonUtils.showHideLoadingDiv(),a.setData("currentUser",e),Crm.userDetails.zDeskIntegration.portalName=e.portalName,Crm.userDetails.zDeskIntegration.ticketModName=e.ticketModName,a.changeIframeTicket(t),a.setData("showIframeUrl",!0),a.setData("iframeshow",!0),a.getData("ticketDetailPrevShow")?$("#ticketDetailPrev").show():$("#ticketDetailPrev").hide(),a.getData("ticketDetailNextShow")?$("#ticketDetailNext").show():$("#ticketDetailNext").hide(),window.addEventListener("message",(function(t){t.origin==location.protocol+"//"+a.getData("deskUrl")&&(Crm.trackSpotLightAction("ZDesk - Ticket Comment"),t.source.postMessage(e.encryptedZuid,t.origin))}),!1)})):(a.changeIframeTicket(t),a.setData("showIframeUrl",!0),a.setData("iframeshow",!0),a.getData("ticketDetailPrevShow")?$("#ticketDetailPrev").show():$("#ticketDetailPrev").hide(),a.getData("ticketDetailNextShow")?$("#ticketDetailNext").show():$("#ticketDetailNext").hide(),store.findAll("dummy",{action:"getMyDeskInfo"},void 0,!1,{url:i}).then((function(t){commonUtils.showHideLoadingDiv(),a.setData("encryptedZuid",t.encryptedZuid)})),window.addEventListener("message",(function(t){t.origin==location.protocol+"//"+a.getData("deskUrl")&&(Crm.trackSpotLightAction("ZDesk - Ticket Comment"),t.source.postMessage(a.getData("encryptedZuid"),t.origin))}),!1))},updateTicketStats:function(t){if(t){var e=t.customerHappiness;if(this.setData("totalTickets",t.totalTickets),this.setData("overdueTickets",t.overdueTickets),this.setData("avgSolTimeSpan",t.resolutionTime),this.setData("avgResTimeSpan",t.responseTime),this.setData("deskTicketsSummaryShow",!0),e){var a=parseInt(e.okCount)+parseInt(e.goodCount)+parseInt(e.badCount);if(a>0){var i=parseInt(e.goodCount)/a*100;i=this.executeMethod("roundOff",i,0),this.setData("cusHapRateShow",!0),this.setData("cusHapRateValue",i+"%"),i>70?this.setData("Smileytype","happySmiley"):i>35?this.setData("Smileytype","confusedSmiley"):this.setData("Smileytype","sadSmiley"),this.setData("noHapShow",!1)}}}else this.setData("totalTickets","0"),this.setData("overdueTickets","0"),this.setData("avgSolTimeSpan","00:00"),this.setData("avgResTimeSpan","00:00"),this.setData("deskTicketsSummaryShow",!1),this.setData("cusHapRateShow",!1),this.setData("noHapShow",!0)},updateNewValueField:function(){var t=document.querySelector("#updateFieldName").ltProp("selected"),e=this.getData("fieldProps")[t];this.setData("errorFieldShow",!1);var a="crm.zdesk.update.choose";if("assigneeId"===e.name)this.showAgentsForDepartment();else if("Picklist"===e.type||"Boolean"===e.type){this.setData("fieldUpSelectData",[]);var i={};"Boolean"!==e.type||e.allowedValues||(e.allowedValues.push({value:!0}),e.allowedValues.push({value:!1}));for(var o=e.allowedValues.length,s=0;s<o;s++){i={};var n=e.allowedValues[s].value;i={name:n,value:n},Lyte.arrayUtils(this.getData("fieldUpSelectData"),"push",i)}document.querySelector("#fieldUpdSelect").ltProp("selected",this.getData("fieldUpSelectData")[0].value),this.setData("fieldUpdTextOptionShow",!1),this.setData("fieldUpdSelectOptionShow",!0)}else"DateTime"===e.type?(this.setData("fieldUpdSelectOptionShow",!1),this.setData("plainTextShow",!1),this.setData("dateTextShow",!0),this.setData("fieldUpdTextOptionShow",!0)):("Phone"===e.type?this.setData("fieldObjType","Number"):this.setData("fieldObjType",e.type),this.setData("fieldObjMaxLength",e.maxLength),this.setData("fieldUpdSelectOptionShow",!1),this.setData("dateTextShow",!1),this.setData("plainTextShow",!0),this.setData("fieldUpdTextOptionShow",!0),a="crm.zdesk.update.enter");this.setData("deskupdateFieldMsgText",I18n.getMsg(a,e.i18NLabel))},uncheckMandatory:function(t){if(t.mandatory)return!1},unSortMandatory:function(t,e){return!e.mandatory},getDeskTickets:function(t,e,a,i,o){var s=this.getData("module");Crm.trackSpotLightAction("ZDesk - Ticket Fetch");var n={pageToken:t,ticketType:this.getCurrentTicketType(s),module:s,action:"getTickets"},l=this.getKeyValueForTicketCriteria();n[l.key]=l.value;var r=this;store.createRecord("dummy"),commonUtils.showHideLoadingDiv(!0),store.create("dummy",void 0,{url:this.getData("url_desk"),method:"POST"},n).then((function(t){commonUtils.showHideLoadingDiv();var s=t.dummy;if(r.setData("showNavigation",!1),r.setDeskTicketData(s),r.getData("newticketlinkshow")&&r.setData("noTicketnewTicketLinkShow",!1),s.ticketError&&(r.setData("ticketError",s.ticketError),r.setData("data",[])),o&&(r.setData("newticketlinkshow",!0),r.setData("noTicketnewTicketLinkShow",!1),r.setData("showColumnShow",!0),r.setData("cruxcolumShowfromfilter",!0)),a){var n=$L("crm-zdesk-iframe")[0].component;i?n.executeMethod("reloadTickets",!0):n.executeMethod("reloadTickets",!1)}if(e){var l=document.querySelector("#ticketFilterSelect"),d=null,p=$L("crm-zdesk-rl-label")[0];null!==l&&(d=l.ltProp("selected")),r.getData("rowCountVis")>0||null!==d&&"All"!==d?r.setData("deskRelatedListMenuShow",!0):(r.setData("deskRelatedListMenuShow",!1),r.setData("deskTheadRowShow",!1),"crm.zdesk.notickets"===s.ticketError&&r.displayDeskWindow()&&(r.setData("ticketError",s.ticketError),r.setData("noTicketnewTicketLinkShow",!0),p&&p.component.setData("refreshIconShow",!0),r.getData("portalUser")&&$("[id='addNewIcP_Zoho Desk']").removeClass("dN")))}var c=document.getElementsByTagName("crm-zdesk-rl-body")[0];c&&c.component&&c.component.getData("selectRowId").forEach((function(t){var e=document.getElementById("checkbox_"+t);e&&e.ltProp("checked",!0)}))}))},populateIntegDetails:function(){var t=RebrandLinkUtil.getProperty("ZSUPPORTURL");"https:"===location.protocol&&(t=(t=t.replace("9090","9443")).replace("8080","8443")),this.setData("deskUrl",t);var e=Crm.userDetails.isCrmPlusDomain?window.location.host:document.domain.includes("zcrm.zoho")?RebrandLinkUtil.getProperty("ZCRMURL"):RebrandLinkUtil.getProperty("CRMURL");this.setData("crmUrl",RebrandLinkUtil.getProperty("URLPROTOCOL")+"://"+e)},setLyteNavigatorValues:function(t){let e={};var a=this.getData("related_list_id"),i=t.page,o=i.from-1,s=0;this.setData("fromIndex",o),this.setData("toIndex",i.to),this.setData("pageNum",i.pageNum),this.setData("leftPanelCount","0"),this.setData("rlCount","0");var n=$L("crm-zdesk-rl-label")[0];if(0===i.pageNum&&i.hasOwnProperty("next")&&this.setData("showNavigation",!0),i.pageNum>0&&this.setData("showNavigation",!0),i.hasOwnProperty("next")&&"true"===i.next||i.pageNum>0?(this.setData("showNextNav",!1),i.pageNum>0?(this.setData("showPrevNav",!0),t.hasOwnProperty("tickets")&&(s=7*i.pageNum+t.tickets.length,this.setData("leftPanelCount",s))):(this.setData("showPrevNav",!1),t.hasOwnProperty("tickets")&&(s=t.tickets.length,this.setData("leftPanelCount",s))),i.hasOwnProperty("next")&&"true"===i.next&&(this.setData("leftPanelCount",this.getData("leftPanelCount")+"+"),this.setData("showNextNav",!0))):0===i.pageNum&&t.tickets&&t.tickets.length>0&&(s=t.tickets.length,this.setData("leftPanelCount",s)),"canvas"===Lyte.Router.getRouteInstance().routeName&&Crm.userDetails.isRLCountSupportedForCanvas){var l={},r=this.getData("related_list_id"),d=this.getData("leftPanelCount");l[r]=parseInt(d),Lyte.registeredMixins["crm-detailcanvas-utils"].handleCountforRL(l)}else"0"!==this.getData("leftPanelCount")?(n&&n.component.setData("rlCount",this.getData("leftPanelCount")),$("#newleft_"+this.getData("related_list_id")).find("span.numCountn").addClass("numCountVal").text(this.getData("leftPanelCount"))):t.tickets&&t.tickets.length>0?(n&&n.component.setData("rlCount",t.tickets.length),$("#newleft_"+this.getData("related_list_id")).find("span.numCountn").addClass("numCountVal").text(t.tickets.length)):(n&&n.component.setData("rlCount","0"),$("#newleft_"+this.getData("related_list_id")).find("span.numCountn").removeClass("numCountVal").text(" "));e.count=0!==s?s:"",e.page=parseInt(i.pageNum),e.more_records=i.next,e.id=a,Lyte.triggerEvent("relatedListCountDetail",e)},roundOff:function(t,e){return Number(Math.round(t+"e"+e)+"e-"+e)}},summarizeTickets:function(t,e,a,i,o,s){var n=t.ticketStats;if(!n)return this.setData("ticketsStatsLinkShow",!1),this.setData("deskTicketsSummaryShow",!1),void Lyte.objectUtils(this.getData("supportObj"),"add","showStats",!1);this.setData("ticketsStatsLinkShow",!0),this.executeMethod("updateTicketStats",n),e&&(a||"0"===i||o&&s===I18n.getMsg("crm.zdesk.showstats")&&this.setData("deskTicketsSummaryShow",!1)),this.setData("desk_encryptedContactId",n.encryptedContactId),this.setData("desk_encryptedAccountId",n.encryptedAccountId);var l=n.contactId;if(t.tickets&&l)for(var r=t.tickets.length,d=0;d<r;d++){var p=t.tickets[d];if(p.contactId===l){var c=p.contact;if(c){this.setData("desk_contactname",c.lastName);var m=this.getData("desk_contactname");m&&c.firstName&&this.setData("desk_contactname",c.firstName+" "+m),this.setData("desk_contactemail",c.email),this.setData("desk_contactphone",c.phone),this.setData("desk_accountname",c.account?c.account.accountName:void 0);break}}}n.totalTickets<1&&(this.setData("ticketsStatsLinkShow",!1),this.setData("deskTicketsSummaryShow",!1))},getCurrentTicketType:function(t){var e=document.querySelector("#ticketFilterSelect"),a="All";return null!==e&&(a=e.ltProp("selected")),"Potentials"===t&&("Potentials"===a?this.setData("linkToThisPotentialShow",!1):this.setData("linkToThisPotentialShow",!0)),a},setDeskTicketData:function(t){var e=!1;if(this.setData("newticketlinkshow",!1),t.hasOwnProperty("ticketPotentials")&&this.setData("ticketPotentials",t.ticketPotentials),t.ticketError&&this.setData("ticketError",t.ticketError),t.hasOwnProperty("tickets")&&t.tickets.length>0&&(this.setData("deskTicketFilterShow",!0),this.setData("newticketlinkshow",!0),this.setData("deskRelatedListMenuShow",!0),this.setData("rowCountVis",t.tickets?t.tickets.length:0),this.setData("data",t.tickets),e=!0),t.hasOwnProperty("contactServerUrl")&&this.setData("contactServerUrl",t.contactServerUrl),t.hasOwnProperty("ticketHeadings")&&(this.setData("ticketHeadings",t.ticketHeadings),Crm.userDetails.IS_ADMIN&&this.setData("loadCruxColumn",!0)),e&&this.getData("ticketHeadings").length>0&&this.setData("deskTheadRowShow",!0),t.hasOwnProperty("ticketKeys")&&this.setData("ticketKeys",t.ticketKeys),t.hasOwnProperty("ticketFields")){var a={},i=[],o=[],s=t.ticketFields;this.setData("ticketFields",s);for(var n=s.length,l=0;l<n;l++){var r=s[l];(a={}).api_name=r.i18NLabel,void 0===r.id?a.id=Math.floor(1e10*Math.random()).toString():a.id=r.id,a.field_label=r.i18NLabel,a.name=r.name,r.isDisabledinCRM&&(a.mandatory=!0),r.isVisibleinCRM&&o.push(a),i.push(a)}this.setData("allFields",i),this.setData("selectedFields",o)}if(t.hasOwnProperty("emailContacts")){var d=t.emailContacts;this.setData("emailContacts",d)}t.hasOwnProperty("page")&&this.executeMethod("setLyteNavigatorValues",t)},showAgentsForDepartment:function(){var t,e=this.getData("selectRowId"),a=e.length,i=this.getData("data"),o=e[0];t=i.filter((function(t){return t.id===o}))[0].departmentId;var s=this;this.getAgentsDepartments(t,(function(t){var e=s.getData("deptAgents")[t];a=e.length,s.setData("fieldUpSelectData",[]);var i={name:"Unassigned",value:"Unassigned"};Lyte.arrayUtils(s.getData("fieldUpSelectData"),"push",i);for(var o=s.getData("agents"),n=0;n<a;n++){i={};var l=o[e[n]];if(l)i={name:l.firstName?l.firstName+" "+l.lastName:l.lastName,value:l.id+""},Lyte.arrayUtils(s.getData("fieldUpSelectData"),"push",i)}document.querySelector("#fieldUpdSelect").ltProp("selected",s.getData("fieldUpSelectData")[0].value),s.setData("fieldUpdTextOptionShow",!1),s.setData("fieldUpdSelectOptionShow",!0)}))},getAgentsDepartments:function(t,e){if(this.getData("deptAgents")[t])e&&e(t);else{var a={departmentId:t,action:"getAgents"},i=this;commonUtils.showHideLoadingDiv(!0),store.findAll("dummy",a,!1,!1,{url:this.getData("url_desk")}).then((function(a){commonUtils.showHideLoadingDiv();var o=a,s={};s[o.departmentId]=o.departmentAgents,i.setData("deptAgents",s);for(var n=o.departmentAgents.length,l={},r=0;r<n;r++){var d=o.departmentAgents[r];l[d]=o.agents[d]}i.setData("agents",l),e&&e(t)}))}},ticketActionDisplay:function(t){0===this.getData("selectedRowCount")?(this.setData("ticketSelectShow",!1),this.getData("deskTicketsSummaryShow")&&this.setData("ticketsStatsLinkShow",!0),(t&&t>0||this.getData("data")&&this.getData("data").length>0)&&(this.setData("deskTicketFilterShow",!0),this.setData("showColumnShow",!0),this.setData("newticketlinkshow",!0))):(this.setData("deskTicketFilterShow",!1),this.setData("ticketsStatsLinkShow",!1),this.setData("showColumnShow",!1),this.setData("newticketlinkshow",!1),this.setData("ticketSelectShow",!0))},getCurrentTicketPage:function(){var t=this.getData("pageNum"),e=parseInt(t);return isNaN(e)?0:e},changeIframeTicket:function(t){var e=$("#ticket_"+t.id),a=$("#desk_tickets_tbody tr").index(e),i=t.encryptedId,o=t.departmentId,s=this.getUrlForTicketDetailView(i,o),n=this.getData("data").length;this.setData("iframeURL",s),this.setData("detailTicketId",t.id);var l=this.getCurrentTicketPage();0==a&&l<1?(this.setData("ticketDetailPrevShow",!1),$("#ticketDetailPrev").hide()):($("#ticketDetailPrev").show(),this.setData("ticketDetailPrevShow",!0)),a<n-1||this.getData("showNavigation")&&this.getData("showNextNav")?(this.setData("ticketDetailNextShow",!0),$("#ticketDetailNext").show()):(this.setData("ticketDetailNextShow",!1),$("#ticketDetailNext").hide()),Crm.trackSpotLightAction("ZDesk - Ticket Detail View")},getKeyValueForTicketCriteria:function(){var t=this.getData("module"),e=this.getData("entity_id"),a=this.getData("email"),i={},o="",s=null,n=this.getData("module_emailColumns");if("Accounts"===t||"Potentials"===t||"Products"===t)s=e;else if(n)if(a)for(var l=a.length,r=0;r<l;r++){var d=a[r];(d=d?d.trim():d)&&validationUtils.isValidEmail(d)&&(o=o?o+","+d:d)}else"Contacts"!==t||a||(s=e);return o.length>0?(i.key="email",i.value=o):s&&(i.key="moduleId",i.value=s),i},updateDetailsForRL:function(t){t&&t.datePattern&&(this.setData("datePattern",t.datePattern),this.setData("portalUser",t.portalUser)),this.displayDeskWindow()||this.setData("newticketlinkshow",!1),this.setData("module_emailColumns",t&&t.module_emailColumns?t.module_emailColumns:["EMAIL","ADDN_EMAIL"])},displayDeskWindow:function(t){var e=this.getData("portalUser"),a=this.getData("currentUser");return t&&e?!(!a||!a.associatedDepartmentIds)&&a.associatedDepartmentIds.indexOf(t)>-1:e},getUrlForTicketDetailView:function(t,e){var a=this.getData("portalName"),i=this.getData("deskUrl"),o=this.getData("crmUrl");"undefined"!=typeof CrmPlusLib&&CrmPlusLib.isLoadedInCrmplusFrame&&CrmPlusLib.getFrameOriginForURL&&(o=CrmPlusLib.getFrameOriginForURL()+","+o);var s=this.getData("crmsupportzgid"),n="//"+i+"/support/"+a+"/";return n=this.displayDeskWindow(e)?Crm.userDetails.zDeskIntegration&&Crm.userDetails.zDeskIntegration.portalName&&Crm.userDetails.zDeskIntegration.ticketModName?(n="//"+i+"/agent/"+Crm.userDetails.zDeskIntegration.portalName+"/all/"+Crm.userDetails.zDeskIntegration.ticketModName)+"/details/"+encodeURIComponent(t)+"?frameorigin="+encodeURIComponent(o)+"&fromService=zohocrm":n+"ShowHomePage.do?frameorigin="+encodeURIComponent(o)+"&isDeskAddOnRequest=true#Cases/dv/"+encodeURIComponent(t)+"?isDeskAddOnRequest=true":n+"ShowEntityInfo.do?frameorigin="+encodeURIComponent(o)+"&module=Cases&id="+encodeURIComponent(t)+"&isCrmCall=true&crmsupportzgid="+encodeURIComponent(s)+"&showThreads=true"},initializeData:function(){this.setData("selectRowId",[]),this.setData("selectedRowCount",0),this.setData("detailTicketId",""),this.setData("rowCountVis",7),this.setData("agents",{}),this.setData("deptAgents",{}),this.setData("datePattern",void 0),this.setData("desk_accountname",void 0),this.setData("desk_contactname",void 0),this.setData("desk_contactemail",void 0),this.setData("desk_contactphone",void 0),this.setData("desk_productName",void 0),this.setData("desk_encryptedContactId",void 0),this.setData("desk_encryptedAccountId",void 0),this.setData("desk_encryptedProductId",void 0),this.setData("ticketHeadings",void 0)},setSelectedRowCount:function(t){var e=this.getData("selectedRowCount");"increment"===t?e++:"decrement"===t&&0!==e?e--:(t="zero")&&(e=0),this.setData("selectedRowCount",e)},loadFieldProperties:function(t){var e=this.getData("fieldProps");if(e)t&&t();else{var a=this.getData("url_desk"),i=this;commonUtils.showHideLoadingDiv(!0),store.findAll("dummy",{action:"getFieldProperties"},!1,!1,{url:a}).then((function(a){commonUtils.showHideLoadingDiv(),e={};for(var o=a.field_properties,s=o&&Array.isArray(o)?o.length:0,n=0;n<s;n++){var l=o[n];e[l.name]=l}i.setData("fieldProps",e),t&&t()}))}}}),Lyte.Component.registerHelper("isOverdueFlag",(function(t,e){if("Closed"===t)return!1;if(null!==e){var a=new Date(e);if((new Date).getTime()-a.getTime()>0)return!0}return!1})),Lyte.Component.registerHelper("getTimeInUserTZ",(function(t,e,a){var i;if(!t||t.length<1)return null;var o=new Date(t),s=o.getTime()+6e4*o.getTimezoneOffset(),n=new Date(s-6e4*Utils.getTimezoneOffset());if("dueDate"===e||"createdTime"===e){var l=new Date,r=l.getTime()+6e4*l.getTimezoneOffset(),d=new Date(r-6e4*Utils.getTimezoneOffset());if(d.getFullYear()===n.getFullYear()&&d.getMonth()===n.getMonth())switch(d.getDate()-n.getDate()){case 0:i="Today";break;case 1:i="Yesterday";break;case-1:i="Tomorrow"}}return a?Utils.getDateTimeInUserFormat(n,!0):i||Utils.getDateInUserDatePattern(n,!0)})),Lyte.Component.registerHelper("isOverDue",(function(t,e){if("Closed"!==t&&e){var a=new Date(e),i=(new Date).getTime()-a.getTime();if(i>0){var o=[],s=i/36e5,n="";if((s=Math.floor(s))>24){var l=s/24;s%=24,n=(l=Math.floor(l))+" Days ",o.push(n)}return n=n+s+" Hours",0===o.length&&o.push(n),o}}})),Lyte.Component.register("crm-zdesk-rl",{_template:'<template tag-name="crm-zdesk-rl"> <crm-zdesk-rl-label type="{{type}}" entity_id="{{entity_id}}" module="{{module}}" related_list_id="{{related_list_id}}" display_label="{{display_label}}"></crm-zdesk-rl-label> <crm-zdesk-rl-body rendered_from="non_canvas" entity_id="{{entity_id}}" module="{{module}}" related_list_id="{{related_list_id}}"></crm-zdesk-rl-body> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"componentDynamic",position:[3]}],_observedAttributes:["module","entity_id","related_list_id","display_label"],data:function(){return{module:Lyte.attr("string"),entity_id:Lyte.attr("string"),related_list_id:Lyte.attr("string"),display_label:Lyte.attr("string")}}}),Lyte.Component.register("crm-zdesk-iframe",{_template:'<template tag-name="crm-zdesk-iframe"> <lyte-modal lt-prop-height="625px" lt-prop-show="{{show}}" lt-prop-show-close-button="false" lt-prop-width="1265px"> <template is="registerYield" yield-name="modal"> <lyte-modal-content class="p0"> <div id="ticketDetailPrev" class="pFixed deskNavCircle leftNavCont" onclick="{{action(\'showTicketDetail\',expHandlers(1,\'-\'))}}"> <span class="previous dIB vaM"></span> </div> <div class="cBoth"> <div id="ticketDetailNext" class="pFixed deskNavCircle rightNavCont" onclick="{{action(\'showTicketDetail\',1)}}"> <span class="next dIB vaM"></span> </div> </div> <div class="fR deskIframeCloseCont pA"> <div class="svgIcons ico-close-small2 cP mL6 mR5 mT5 dIB" onclick="{{action(\'closeDeskPopup\')}}"></div> </div> <iframe id="deskIframe" frameborder="0" src="{{iframeurl}}" style="overflow:auto;width: 1250px; height: 620px;"></iframe> </lyte-modal-content> </template> </lyte-modal> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"attr",position:[1,5,1]},{type:"attr",position:[1,7]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["iframeurl","show"],data:function(){return{iframeurl:Lyte.attr("string"),show:Lyte.attr("boolean",{default:!0})}},init:function(){this.setData("show",!0)},actions:{closeDeskPopup:function(){var t=$L("crm-zdesk-rl-body")[0].component;this.setData("show",!1),window.removeEventListener("message",(function(e){e.origin==location.protocol+"//"+t.getData("deskUrl")&&(Crm.trackSpotLightAction("ZDesk - Ticket Comment"),e.source.postMessage(Crm.userDetails.ZUID,e.origin))}),!1),Crm.userDetails.isRelatedListLyteEnabled?t.executeMethod("handleScroll",!1):deskInteg.handleScroll(!1)},showTicketDetail:function(t){Crm.trackSpotLightAction("ZDesk - Ticket Detail Quick Navigation");var e=$L("crm-zdesk-rl-body")[0].component,a=e.getData("detailTicketId"),i=null;if(1==t?i=$("#ticket_"+a).next():-1==t&&(i=$("#ticket_"+a).prev()),i){var o=e.getData("data");if(1==i.length){var s=i.attr("id").replace("ticket_",""),n=o.filter((function(t){return t.id===s}));e.changeIframeTicket(n[0])}else 1==t?e.executeMethod("next",!0):e.executeMethod("prev",!0)}}},methods:{reloadTickets:function(t){var e=$L("crm-zdesk-rl-body")[0].component,a=$L("crm-zdesk-iframe")[0].component,i=e.getData("data"),o=$("#desk_tickets_tbody tr"),s=(t?o.last():o.eq(0)).attr("id");if(s){var n=s.replace("ticket_",""),l=i.filter((function(t){return t.id===n}));e.changeIframeTicket(l[0])}else a.actions.closeDeskPopup.call()}}});
