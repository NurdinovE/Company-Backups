Lyte.Component.registerHelper("getEdvDateNTime",(function(e){return CrmDateUtils.convertDateToUserPattern(e,null,!0)+" "+Lyte.Component.registeredHelpers.getTime(e)})),Lyte.Component.registerHelper("borderHelper",(function(e){return"received"===e?"zia_br_right_border1":""})),Lyte.Component.registerHelper("isMailMagnetListEmpty",(function(e){let t=!1;return e&&e.forEach((e=>{e&&!e.read&&(t=!0)})),t})),Lyte.Component.registerHelper("isSentMail",(function(e){var t=Crm.userDetails.isEnrichDataEnabled||$L("crm-emailconversation-view")[0].component.data.isDataEnrichmentAvailable;return e&&void 0===e.sentOrReceived?e.status&&"Received"===e.status[0].type&&t?"zia_br_right_border1":"":e&&"Sent"!==e.sentOrReceived&&t?"zia_br_right_border1":""})),Lyte.Component.registerHelper("getLanguageId",(function(e){return"English"===e?"":" - "+e})),Lyte.Component.registerHelper("handleNav",(function(e,t,n,r,i){let a="";return e?(a="eNavDisabled",a):($(r).removeClass("peNone disable eNavDisabled"),(i&&t||!i&&n)&&(a="peNone disable"),a)})),Lyte.Component.registerHelper("hasAttachmentCreatePermission",(function(e,t){if(t&&"draft"===t)return!1;var n=Lyte.Component.registeredHelpers.getModuleNameByApiName(e);return"team_based"===moduleRecordMapping[n].access_type?Crm.userDetails.permissions.Crm_Implied_Create_Attachments+"_"+n:Crm.userDetails.permissions.Crm_Implied_Create_Attachments})),Lyte.Component.registerHelper("getTime",(function(e){var t=new CrmDate(e),n=Crm.userDetails.TIME_FORMAT,r=t.userHourIn24hrFmt,i=t.userDisplayMinute<10?"0"+t.userDisplayMinute:t.userDisplayMinute;return"HH:mm"===n?r+":"+i:(0==r?12:r>12?r-12:r)+":"+i+(r>=12?" "+I18n.getMsg("PM"):" "+I18n.getMsg("AM"))})),Lyte.Component.registerHelper("hasAttachments",(function(e){return!(!e||void 0===e.attachments||Array.isArray(e.attachments)&&0===e.attachments.length)})),Lyte.Component.registerHelper("showMailCount",(function(e){return e.length>1})),Lyte.Component.registerHelper("getMailStatus",(function(e,t){return(!e||e.toLowerCase()!==t||"draft"!==t||!Crm.userDetails.LITE.IS_LITE_USER)&&(e&&e.toLowerCase()===t)})),Lyte.Component.registerHelper("getDisplayEmail",(function(e,t,n,r,i){let a=t;return e?(a=e+"<"+a+">",r&&n!==r[i].length-1&&(a+=","),a):a})),Lyte.Component.registerHelper("setMinHeight",(function(e,t){e=$L(".edvModalHeader")[0].offsetHeight+$L("#wmstoolbar")[0].offsetHeight+30;return t.style.minHeight=e,""})),Lyte.Component.registerHelper("getUserNameOrEmail",(function(e,t,n){let r=e.from.user_name,i=e.from.email,a=t.moduleId;return r||"mailMagnet"!==n||(r=$("#mailMagnet_"+a).attr("lt-prop-value")),r||i})),Lyte.Component.registerHelper("dummy",(function(){return"svgIcons"})),Lyte.Component.registerHelper("bytesToSize",(function(e,t=0){let n=parseFloat(e);if(0===n)return"0 B";let r=t<0?0:t,i=Math.floor(Math.log(n)/Math.log(1024));return parseFloat((n/Math.pow(1024,i)).toFixed(r))+" "+["B","KB","MB"][i]})),Lyte.Component.registerHelper("hasKey",(function(e,t){return e&&t in e&&e[t]&&"null"!==e[t]&&("sentiment"!==t||"Neutral"!==e[t])})),Lyte.Component.registerHelper("hasIntent",(function(e){return Crm.userDetails.intentEnabled&&e.intent&&void 0!==e.intent&&""!==e.intent})),Lyte.Component.registerHelper("hasSentiment",(function(e){return Crm.userDetails.emailsentimentEnabled&&e.sentiment_info&&"Neutral"!==e.sentiment_info&&"Consecutive Negative"!==e.sentiment_info})),Lyte.Component.registerHelper("hasEmotion",(function(e){return Crm.userDetails.isEmotionsEnabled&&e.emotion})),Lyte.Component.registerHelper("hasRecepients",(function(e,t){return!(void 0===e[t]||Array.isArray(e[t])&&0===e[t].length)})),Lyte.Component.registerHelper("countRecepients",(function(e){let t=0;return t+=void 0!==e.to&&Array.isArray(e.to)?e.to.length:0,t+=void 0!==e.cc&&Array.isArray(e.cc)?e.cc.length:0,t+=void 0!==e.bcc&&Array.isArray(e.bcc)?e.bcc.length:0,t})),Lyte.Component.registerHelper("countToRecepients",(function(e){let t=0;return t+=void 0!==e.to&&Array.isArray(e.to)?e.to.length:0,t})),Lyte.Component.registerHelper("getMailStatusIconName",(function(e,t){let n="mail-sent";if(e.status){let r=e.status[0].type.toLowerCase();"received"===r||"mailMagnet"===t?n="mail-received":"scheduled"===r?n="mail-scheduled":"failed"===r&&(n="mail-info")}else{0!==$("#rLEmailSub_"+e.message_id).closest(".topband_dv_row").find("span.erl-mail-incoming").length&&(n="mail-received")}return n})),Lyte.Component.registerHelper("getMailStatusIconClass",(function(e,t){let n="zcicn-mail-sent zcicn-color-green-mixed zcicn16 crmBaseIcon ";if(e.status){let r=e.status[0].type.toLowerCase();"received"===r||"mailMagnet"===t?n="zcicn-mail-received zcicn-color-blue-mixed crmBaseIcon":"scheduled"===r?n="zcicn-mail-scheduled zcicn-color-yellow-mixed crmBaseIcon":"failed"===r&&(n="zcicn-mail-info zcicn-color-red-mixed crmBaseIcon")}else{0!==$("#rLEmailSub_"+e.message_id).closest(".topband_dv_row").find("span.erl-mail-incoming").length&&(n="zcicn-mail-received zcicn-color-blue-mixed crmBaseIcon")}return n})),Lyte.Component.registerHelper("getIconName",(function(e){let t="";if(e)switch(e.substr(e.lastIndexOf(".")+1).toLowerCase()){case"jpg":case"gif":case"png":case"jpeg":case"bmp":t="attachment-image";break;case"pdf":t="attachment-pdf";break;case"docx":case"doc":t="attachment-document";break;case"ppt":case"pptx":t="attachment-chart";break;case"xlsx":case"xls":t="attachment-sheet";break;case"html":case"xml":case"xhtml":default:t="attachment-noformat";break;case"zip":case"rar":case"7z":case"zipx":t="attachment-zip";break;case"3gp":case"mp4":case"avi":case"flv":case"mpeg":case"wmv":t="attachment-video";break;case"mp3":case"wav":case"wma":t="attachment-audio";break;case"txt":t="attachment-text"}return t})),Lyte.Component.registerHelper("getIconClass",(function(e){let t="";if(e)switch(e.substr(e.lastIndexOf(".")+1).toLowerCase()){case"jpg":case"gif":case"png":case"jpeg":case"bmp":t="zcicn-attachment-image";break;case"pdf":t="zcicn-attachment-pdf";break;case"docx":case"doc":t="zcicn-attachment-document";break;case"ppt":case"pptx":t="zcicn-attachment-chart";break;case"xlsx":case"xls":t="zcicn-attachment-sheet";break;case"html":case"xml":case"xhtml":default:t="zcicn-attachment-noformat";break;case"zip":case"rar":case"7z":case"zipx":t="zcicn-attachment-zip";break;case"3gp":case"mp4":case"avi":case"flv":case"mpeg":case"wmv":t="zcicn-attachment-video";break;case"mp3":case"wav":case"wma":t="zcicn-attachment-audio";break;case"txt":t="zcicn-attachment-text"}return t})),Lyte.Component.registerHelper("getTimeInMillis",(function(e){return $L.moment(e).toDate().getTime()})),Lyte.Component.registerHelper("addClassForIndex",(function(e){return e?"lyteAccordionActive edvActive":""})),Lyte.Component.registerHelper("getDealLink",(function(e,t){return t||(t="Potentials"),crmBasePath+"/EntityInfo.do?id="+e+"&module="+t})),Lyte.Component.registerHelper("hasActivity",(function(e){if(e&&e.activity_info&&e.activity_info.activities){var t=e.activity_info.activities,n=e.activity_info.activities.length;e.activityCreated=!1,e.viewactivitylabel=I18n.getMsg("crm.email.zia.activityv2.suggestions.available");for(var r=0,i=0;i<n;i++)t[i].hasOwnProperty("linked_record")&&t[i].linked_record&&r++;return Number(r)===n&&(e.activityCreated=!0,e.viewactivitylabel=I18n.getMsg("crm.zia.activity.view.activity2"),1===n&&(e.viewactivitylabel=I18n.getMsg("crm.zia.activity.view.activity"))),!0}return e&&Crm.userDetails.isEmailsAIClickableSupport?(e.viewactivitylabel=I18n.getMsg("crm.label.zia.email.clickable"),!0):(e&&(e.activityCreated=!1),!1)})),Lyte.Component.registerHelper("hasEmailsAIDropDown",(function(e,t){var n=!1;if(t){let e=this.getData("moduleInfo");t.showActivity=!1,t.showHelpZia=!1,t.showEnrichment=!1,Lyte.Component.registeredHelpers.hasEnrichment(t,e)&&(t.showEnrichment=!0,t.showHelpZia=!0,n=!0),Lyte.Component.registeredHelpers.hasActivity(t)&&(t.showActivity=!0,t.showHelpZia=!0,n=!0)}return n})),Lyte.Component.registerHelper("hasEnrichment",(function(e,t){let n=!1;if(t){let r="Crm_Implied_Edit_"+(t.moduleName||$L("#module").val()),i=!1;if(e&&e.status&&"received"===e.status[0].type.toLowerCase())i=!0;else if(e&&e.message_id){0!==$("#rLEmailSub_"+e.message_id).closest(".topband_dv_row").find("span.erl-mail-incoming").length&&(i=!0)}(Crm.userDetails.isEmailsAIClickableSupport&&i||i&&Crm.userDetails.isZiaInEmailEnabled&&Crm.userDetails.permissions[r]&&(Crm.userDetails.permissions.Crm_Implied_Manage_Data_Enrichment||Crm.userDetails.permissions.Crm_Implied_View_Data_Enrichment))&&(n=!0),"deleted"===t.recordState&&(n=!1)}return n&&(!crmCommonModule.isApproved||"7"!==crmCommonModule.isApproved&&"8"!==crmCommonModule.isApproved)})),Lyte.Component.registerHelper("getBorder",(function(e){let t="";return e.emotion&&Crm.userDetails.isHelpZiaEnabled&&(t="activityBorder crm-base-font-size pR9"),t})),Lyte.Component.registerHelper("getSentimentIconUtilClass",(function(e){let t="";switch(e){case"Positive":t="zcicn-emoji-smile zcicn16 zcicn-green-bg-filled";break;case"Negative":t="zcicn-emoji-anger zcicn16 zcicn-red-bg-filled";break;case"Neutral":t="zcicn-emoji-cool zcicn16 zcicn-blue-bg-filled ";break;case"Sad":t="zcicn-emoji-sad zcicn16 zcicn-yellow-bg-filled"}return t})),Lyte.Component.registerHelper("getSentimentIconUtilName",(function(e){let t="";switch(e){case"Positive":t="emoji-smile";break;case"Negative":t="emoji-anger";break;case"Neutral":t="emoji-cool";break;case"Sad":t="emoji-sad"}return t})),Lyte.Component.registerHelper("getEmotionIcon",(function(e){let t="";switch(Crm.client_tracking("Email emotion",{type:e}),e){case"Happy":case"Enthusiasm":case"Gratitude":case"Trust":t="edvSentimentPositive";break;case"Discontentment":case"Frustration":case"Confusion":t="edvSentimentNegative";break;case"Neutral":t="edvSentimentNeutral"}return t})),Lyte.Component.registerHelper("showReplyForwardOptions",(function(e,t){let n=!0;if(e){let r=e[0].type.toUpperCase();"SCHEDULED"!==r&&"FAILED"!==r&&"deleted"!==t||(n=!1)}return n})),Lyte.Component.registerHelper("getBoldClass",(function(e){return!1===e?"crm-font-bold":""})),Lyte.Component.registerHelper("hasContent",(function(e,t){return e!==t})),Lyte.Component.registerHelper("isMailMagnetOpen",(function(e){return"mailMagnet"===e})),Lyte.Component.registerHelper("getAttachments",(function(e){return e.attachments})),Lyte.Component.registerHelper("getCustomButtons",(function(e,t){let n=$("crm-related-list-view-header").attr("layout-id"),r=[];if(e&&"relatedList"!==e)return r;const i=Lyte.registeredMixins["crm-view-utils"];let a=store.peekAll("custom_button"),o=Object.keys(moduleApiMapping).find((e=>moduleApiMapping[e]===t))||t;return r=i.filterButtonData(a,{position:"related_list",relatedListApiName:"Emails",moduleName:o,layoutId:n}),r})),Lyte.Component.registerHelper("getFirstCustomButtons",(function(e,t){let n=[];if(e&&"relatedList"!==e)return n;let r=store.peekAll("custom_button"),i=$("crm-related-list-view-header").attr("layout-id");const a=Lyte.registeredMixins["crm-view-utils"];let o=Object.keys(moduleApiMapping).find((e=>moduleApiMapping[e]===t))||t;return n=a.filterButtonData(r,{position:"related_list",relatedListApiName:"Emails",moduleName:o,layoutId:i}),n.length>1&&(n=[n[0]],n.push({})),n})),Lyte.Component.registerHelper("addClassForCustomButton",(function(e){let t=[],n=store.peekAll("custom_button"),r=$("crm-related-list-view-header").attr("layout-id");const i=Lyte.registeredMixins["crm-view-utils"];let a=Object.keys(moduleApiMapping).find((t=>moduleApiMapping[t]===e))||e;return t=i.filterButtonData(n,{position:"related_list",relatedListApiName:"Emails",moduleName:a,layoutId:r}),t.length>1})),Lyte.Component.registerHelper("getCompanyOrAccount",(function(e){return e.Account_Name?e.Account_Name:e.Company})),Lyte.Component.registerHelper("getMailMagnetDateNTime",(function(e){var t=new CrmDate(e),n=Lyte.Component.registeredHelpers.getTime(e),r=t.userDisplayYear,i=new CrmDate;let a=$L.moment(e,"YYYY-MM-DDTHH:mm:ssZ").timezone(Crm.userDetails.USER_TIME_ZONE).format(Crm.userDetails.DATE_PATTERN.toUpperCase());return i.userDisplayDate===t.userDisplayDate&&i.userDisplayMonthName===t.userDisplayMonthName&&r===t.userDisplayYear?n:a+" "+n})),Lyte.Component.registerHelper("getMailMagnetUnreadClass",(function(e,t,n,r){let i="";return!e||e.read||t.includes(n)||(i=r),i})),Lyte.Component.registerHelper("getMailMagnetImageUrl",(function(e,t){let n=networkUtils.getImageUrl("nophoto.png",ResourceConstants.CRM);return e&&e.Record_Image&&(n=t?"/crm/org"+crmZgid+"/EntityImageAttach.do?action_module="+t.moduleName+"&entityId="+t.moduleId+"&actionName=readImage&fileId="+e.Record_Image:"/crm/org"+crmZgid+"/EntityImageAttach.do?action_module="+e.record.module.name+"&entityId="+e.record.id+"&actionName=readImage&fileId="+e.Record_Image),n})),Lyte.Component.registerHelper("isUnreadMailMagnet",(function(e){return e&&!e.read})),Lyte.Component.registerHelper("getOpenedClassMailMagnet",(function(e,t){let n="";return e&&e.message_id===t&&(n="etmmActiveMail"),n})),Lyte.Component.registerHelper("showAssoPotentialId",(function(e){let t=e.message_id;return 0===$("#"+t).length})),Lyte.Component.registerHelper("islinkedToDeal",(function(e){return e&&"id"in e})),Lyte.Component.registerHelper("getDisplayNameOrEmail",(function(e,t){return e?e.replaceAll('"',""):t?t.replaceAll('"',""):""})),Lyte.Component.registerHelper("getAttachmentText",(function(e){return 1===e.length?"1 "+I18n.getMsg("crm.email.threadview.attachment"):e.length+" "+I18n.getMsg("Attachments")})),Lyte.Component.registerHelper("getAttachmentTextForConversation",(function(e){return 1===e.length?I18n.getMsg("crm.email.threadview.attachment"):I18n.getMsg("Attachments")})),Lyte.Component.registerHelper("getDealTranslatedSingularLabel",(function(){return Crm.moduleInfo.Potentials.translatedSingularLabel})),Lyte.Component.registerHelper("onEscapeClose",(function(e){return"mailMagnet"!==e})),Lyte.Component.registerHelper("hasSendMailPermission",(function(e,t,n){let r=$("#module").val();var i=!0,a=Crm.userDetails.isEmailsForModuleEnabled;return a&&"relatedList"===e&&"Calls"!==r&&"Tasks"!==r&&"Events"!==r?t=r:a||"relatedList"!==e||"Calls"===r||"Tasks"===r||"Events"===r||"Accounts"===r||(t=r),n&&"read_write"!==n&&"full_access"!==n&&(i=!1),Crm.userDetails.permissions["Crm_Implied_Send_Mail_"+t]&&Crm.userDetails.isEmailConfigurationActive&&i})),Lyte.Component.registerHelper("hasPrintMailPermission",(function(e,t,n){let r=$("#module").val();return(!n||"read_only"!==n)&&("relatedList"===e&&"Calls"!==r&&"Tasks"!==r&&"Events"!==r&&(t=r),"draft"!==e&&Crm.userDetails.permissions["Crm_Implied_Print_View_"+t])})),Lyte.Component.registerHelper("appendAsShadowDOM",(function(e,t,n){const r=$(e).closest(n)[0];var i,a=document.createElement("span");r.shadowRoot?(i=r.shadowRoot).querySelector("span").remove():i=r.attachShadow({mode:"open"}),a.innerHTML=t;var o=document.createElement("style");o.innerHTML=".competitormentionlink,.competitormentionlinkneutral{background-color:#efc06a;font-size:inherit}.competitormentionlinkpositive{background-color:#8dd8b7;font-size:inherit}.competitormentionlinknegative{background-color:#ffadac;font-size:inherit}.br5{border-radius:5px}.p3{padding:3px}",a.appendChild(o),i.appendChild(a)})),Lyte.Component.registerHelper("hasDownloadAttachPermission",(function(e){return!e||"draft"!==e})),Lyte.Component.registerHelper("hasEmailWritePermission",(function(e){return!(!e||"read_only"===e)})),Lyte.Component.registerHelper("checkSelectedModuleInRL",(function(){var e=$L("crm-email-rl-filter"),t=e.length>0?e.get(0).component:void 0;if(t){var n=t.getData("moduleSelected");if(n&&"CASES_ALL"!==n)return n}}));
