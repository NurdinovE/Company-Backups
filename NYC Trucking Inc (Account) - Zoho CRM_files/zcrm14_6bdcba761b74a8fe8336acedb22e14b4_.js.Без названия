var httphandle=getHTTPObject(),globalfieldlabel="",globalvaluespanid="",globallabelspanid="",globalsubvaluespanid="",globaltextboxpanid="",globaltextareapanid="",globaluitype=void 0,comboCount=1,itsonview=!1,sortOrderString="null",temp="null",tkveventajax=!1,selectfieldtoupdate="",updatedsuccesfully="",cancelButton="",saveButton="",OR="",searchResultObj={},creator_scroll_div_width=0,itsonedit="false",jsonFields={},concentrixResponse="",isAdwordsMetrixRecordsFetched=!1,singularModule="",valueBeforeAjaxEdit="",idBeforeAjaxEdit="",recordid1="";function Callonclickofbutton(e,t,a,i,r,l,s,o,n,d,c,u,m,p,g,f,v){_cruxUtils.removeCustomMessage(),$L("#fieldVerified").empty(),commonUtils.setErrVerifyContHeightToParent(!1,!1,!1);var C=e;if(Lyte.registeredMixins["crm-entity-utils"].trackRecordEditSaveData("ajaxSave"),!v&&businessCardJson&&businessCardJson.userTypeId){var h=function(){Callonclickofbutton(e,t,a,i,r,l,s,o,n,d,c,u,m,p,g,f,!0)};let v=e=>{let a=store.peekRecord("field",e.invitation_field.id);if(t==="Crm_"+l+"_"+a.column_name){var i=$("#Crm_"+l+"_"+a.column_name);let e=i.data().oldValue,t=i.val().trim(),o=null;33===a.ui_type&&Crm.userDetails.isPhoneNoNewView&&(o=i.closest("crm-phone-field")[0].component,e=o.getData("previousValue"),t=o.getValue());var r=function(){33===a.ui_type&&Crm.userDetails.isPhoneNoNewView?(o.setData("presentValue",""),o.setData("presentValue",e)):i.val(e)};if(""===t)return _cruxUtils.showCustomMessage({params:{ltPropMessage:I18n.getMsg("custmr.prtl.inv.field.emt",a.display_label),ltPropType:"error",ltPropDuration:3e3}}),void r();if(t!==e){var s=networkUtils.returnDependencyFiles(["zohocrm_clientPortalMiscFuncs.js"],ResourceConstants.CRM);return void Lyte.injectResources({parent:s},void 0,(function(){CPMF.showInvitaitonFieldEditMessagePopUp(c,businessCardJson.userTypeId,h,r)}))}h()}else h()},C=store.peekRecord("user_type",businessCardJson.userTypeId);return C?void v(C):void store.findAll("user_type",{include_inner_details:"invitation_field"}).then((e=>{v(e.find((e=>e.id===businessCardJson.userTypeId)))}),(e=>{"NO_PERMISSION"==(e=JSON.parse(e.response)).code&&_cruxUtils.showCustomMessage({params:{ltPropMessage:I18n.getMsg("custmr.prtl.perm.den.inv.fld.edit"),ltPropType:"error",ltPropDuration:4e3}})}))}var b=null,y=null,I=null,E=(M="Calls"===l&&isNewCallView?$("#fullInfoDiv"):$(document)).find("#mouseArea__"+r).data("params"),w=e;e="Campaigns"===l||"Bundles"===l?"/crm/v2.2/":e;e=o+""=="221"||E.filterQueryId?"/crm/v2.2/":e,e=o+""=="445"||E.filterQueryId?"/crm/v2.2/":e,-1===(e=o+""=="444"||E.filterQueryId?"/crm/v2.2/":e).indexOf("/crm/v2/")&&-1===e.indexOf("/crm/v2.1/")&&-1===e.indexOf("/crm/v2.2/")||crmTab.deleteFromCache(l),detailView.fadeOutHighLight();var T=$(".highlightFieldUpdate");if(T.length>0){var L=$("#leftPanel");L&&L.removeClass("highlightFieldUpdate")}var O=$("#fullInfoDiv"),M="Calls"===l&&isNewCallView&&"CONTACTID"!==r&&"SEID"!==r&&"SUBJECT"!==r&&"CTIVOICEURL"!==r&&"FROMNUMBER"!==r&&"TONUMBER"!==r?O:$(document),D=((E=$("#mouseArea__"+r).data("params")).module,p=E.fieldid,o=E.uitype,$("#subvalue_yesId"));if(D.length>0){var A=D.attr("idval"),S="<span id=yes_"+A+' width="13px" height="12px" class="yes nohyphon"></span>',R="#detailViewButtonLayerDummyTableRow #headervalue_"+A+" .busniess_card_Hover",U=$(R+" #subvalue_yesId");U.length>0&&(U.remove(),$(R).append(S));var N="#detailViewButtonLayerMainTableRow #headervalue_"+A+"busniess_card_Hover",P=$(N+" #subvalue_yesId");P.length>0&&(P.remove(),P.append(S)),$("#value_"+A+" #subvalue_yesId").remove(),$("#value_"+A).append(S)}e=e+moduleApiMapping[l]+"/"+c;var x="Calls"==l&&isNewCallView?M.find("#Crm_"+l+"_"+r)[0]:document.getElementById("Crm_"+l+"_"+r);x&&"SELECT"===x.tagName&&$(x).select2("close");var V,k="",F="";if(httphandle){if(786===parseInt(o)||14===parseInt(o)||333===parseInt(o)){var B=M.find("#Crm_"+l+"_"+r+"_TimeOption"),j=-1!=t.indexOf("*")?t.substring(0,t.indexOf("*")):t;if(0!=x.value.trim().length){var H=B.val().split(" ")[0],J=H.split(":"),G=""!=H?Utils.getMeridiem(B.timeEntry("getTime")).toUpperCase():"AM",z=""!=H?J[0]:"00",q=""!=H?J[1]:"00";k=x.value.trim()+" "+z+":"+q+" "+G.toUpperCase()}}else if(100===parseInt(o)||96===parseInt(o))for(var W=0,Y=x.length,Q=0;Q<Y;Q++)1==x.options[Q].selected?(k=0==W?x.options[Q].value:k+"; "+x.options[Q].value,W++):0==W&&(k="");else if(300===parseInt(o)||301===parseInt(o))k=getObj(globaltextboxpanid).checked,"false"===(k+="")&&$(".unsubInfo").hide();else if(98===parseInt(o))k=M.find("#textarea_STATUS").find("select").val();else if(555===parseInt(o))fileupload.removedAttachmentIds.length>0&&(fileupload.editObj.removedAttachmentIds=fileupload.removedAttachmentIds),fileupload.uploadedFileObject.length>0&&(fileupload.editObj.uploadedFileObject=fileupload.uploadedFileObject),k=JSON.stringify(fileupload.editObj);else if(556===parseInt(o)){var X=$L("#"+t);V=X.children()[0].component;var Z=Lyte.registeredMixins["crm-uploadfields-mixin"].validateImageUploadField(V);Z?$L("#Crm_"+l+"_"+r).closest(".tabdiv").removeClass("errorFieldP"):$L("#Crm_"+l+"_"+r).closest(".tabdiv").addClass("errorFieldP"),k="{}";var K=Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents("vlabel_"+r,"view").data.cxPropValue,ee=V.getData("images");K.length===ee.length&&_.isEqual(K,ee)||(k=ee),detailView.isImageModified[V.getData("cxPropId")]=!1,Lyte.registeredMixins["crm-uploadfields-mixin"].isInEditMode(!1)}else if(444===parseInt(o)){X=Crm.userDetails.isMultiSelectionPopupSupported?$L("#"+t):M.find("#"+t),k=(k=X.data("id"))&&"null"!=k?k.split(",").length:X.data("selectedid")}else if(221===parseInt(o)){X=M.find("#"+t);k=X.data("id"),F=void 0===X[0].component.data.userName?"":X[0].component.data.userName}else if(parseInt(o)===CrmField.UITYPES.SERVICE_DURATION){if("string"==typeof(k=M.find("#"+t).val().trim())&&(k=k.trim()),!Lyte.registeredMixins["crm-services-appointments-old-mixin"].getServiceTimingOldFlow("Services",!1,!0))return renderingUtils.showCustomAlert(I18n.getMsg("crm.service.dur.less.avail",moduleRecordMapping.Services.singular_label),"",!1),!1}else if(3===parseInt(o)||110===parseInt(o)){var te=M.find("#"+t);k=te[0].component.getValue(),detailView.multilineRender[r]=te.find("textarea")[0].offsetHeight-1}else if(250===parseInt(o)){if("Tasks"===l||"Events"===l){var ae=$L("#dvinner");Crm.userDetails.isCanvasActivitySupportEnabled?(ae.scroll(),$L("crm-richtext-component.preventWheel").removeClass("preventWheel")):thirdPartyUtils.bindPerfectScroll(ae)}k=M.find("#"+t)[0].component.getValue()}else{"string"==typeof(k=M.find("#"+t).val().trim())&&(k=k.trim(),E.isEncField&&void 0!==E.encrypt_case&&("lowercase"===E.encrypt_case?k=k.toLowerCase():"uppercase"===E.encrypt_case&&(k=k.toUpperCase())));var ie={Leads:"LASTNAME",Accounts:"ACCOUNTNAME",Contacts:"LASTNAME",Potentials:"POTENTIALNAME",Campaigns:"CAMPAIGNNAME",Cases:"CASESUBJECT",Solutions:"SOLUTIONTITLE",Products:"PRODUCTNAME",Bundles:"BUNDLENAME",Vendors:"VENDORNAME",PriceBooks:"BOOKNAME",Quotes:"QUOTESUBJECT",SalesOrders:"SALESORDERSUBJECT",PurchaseOrders:"PURCHASEORDERSUBJECT",Invoices:"INVOICESUBJECT",Tasks:"SUBJECT",Events:"SUBJECT",Calls:"SUBJECT",Activities:"SUBJECT"},re=M.find("#rItemDataDiv");""!=re.html()&&ie[l]==r&&re.find("a").first().find("div").text(k)}if("38"==o&&0!=(k+="").length){var le=k.split(".");0==le[0].length&&(k=0+k),k=k.includes(".")&&0===le[1].length||0===parseInt(le[1])?le[0]:k}if(k&&"CODE"===d||"ZIPCODE"===d||"MAILINGZIP"===d||"OTHERZIP"===d){var se=/[~`#%^&*()+={}[\]|\;"<>\\]/g,oe=k.replace(se,"");k=oe}var ne=Crm.validateEntityAndShowErrorMsg(["Crm_"+l+"_"+r],l,!0);if(ne?$("#Crm_"+l+"_"+r).closest(".tabdiv").removeClass("errorFieldP"):$("#Crm_"+l+"_"+r).closest(".tabdiv").addClass("errorFieldP"),commonUtils.setErrVerifyContHeightToParent(!1,!1,!1),!ne)return void(786===parseInt(o)||14===parseInt(o)||333===parseInt(o)?M.find("#"+j).length&&M.find("#"+j).focus():250===parseInt(o)?M.find("#"+t).find(".rtfParentWrap")[0].focus():M.find("#"+t).focus());parseInt(o)===CrmFieldConstants.PHONE&&(k=commonUtils.getValue(M.find("#"+t)),"string"==typeof value&&(k=k.trim())),itsonview=!1;var de=$(".neweditIconSvg");de.hide(),setTimeout((function(){de.show()}),5e3),""!=k&&k instanceof String&&(k=k.trim()+""),32===parseInt(o)&&(k=k.replace(/\+/g,"")),!k||1!=o&&11!=o&&27!=o&&127!=o&&62!=o||(k=renderingUtils.removeMultiSpacestoSingleSpace(k));var ce=E.label;"ACCOUNTID"==r&&"Accounts"!=l?ce="Account Name":"CONTACTID"==r&&"Contacts"!=l&&(ce="Contact Name");var ue=null,me=k,pe=valueBeforeAjaxEdit;if(/\b(5|4|6|7|9|10|12|13|15|133|136)\b/.test(o)&&(ue=M.find("#"+globaltextboxpanid).data("id")?M.find("#"+globaltextboxpanid).data("id")+"":"",k||(ue=""),me=""===ue?k:ue,pe=idBeforeAjaxEdit),"Account Name"==ce&&"Accounts"!=l&&(ue=M.find("#"+globaltextboxpanid).data("id")?M.find("#"+globaltextboxpanid).data("id")+"":""),25===parseInt(o)&&("Leads"===l||"Contacts"===l)){var ge=M.find("#subvalue_"+r).text();null!=ge&&isValidEmail(ge)||(ge="")}if(25===parseInt(o)&&("Leads"===l||"Contacts"===l||"Vendors"===l||l.startsWith("CustomModule"))){setInfoIconNearEmailFeild(detailView.pmEmailRes,detailView.secEmailRes,detailView.pmEmailBounceType,detailView.secEmailBounceType,detailView.pmEmailBounceCategory,detailView.secEmailBounceCategory,detailView.pmEmailUnblockCount,detailView.secEmailUnblockCount);var fe=Lyte.registeredMixins["email-sharing-alert"];if(fe&&fe.showCustomEmailSharingAlert(r)){var ve=arguments;return ve[0]=C,void fe.checkCustomSharingEnabledForRecord($("#id").val(),this,Callonclickofbutton,ve)}}Crm.oldVR&&delete Crm.oldVR,Crm.VR&&delete Crm.VR,Crm.VR={},Crm.oldVR={},Crm.oldVR.ajaxEditFieldLabel=r,Crm.VR.ajaxEditFieldLabel=r,Crm.VR.entityDetails={},Crm.VR.entityDetails.entityMapJson=returnJson.entityMapJson?objectUtils.cloneObject(returnJson.entityMapJson):returnJson.entityMapJson,Crm.VR.ajaxEditFieldLabelValue=Crm.requestParamWithColname[r];var Ce=!1;"Events"==l&&(Ce=!0,Crm.VR.fieldsInPopup=[Crm.VR.ajaxEditFieldLabel]);let v=store.peekRecord("field",E.fieldid),h=v&&v.lookup&&v.lookup.revalidate_filter_during_edit;if(444===parseInt(o)&&""==trimBoth(k)||221===parseInt(o)&&trimBoth(k)===trimBoth(idBeforeAjaxEdit)||trimBoth(k)===trimBoth(valueBeforeAjaxEdit)&&trimBoth(me)===trimBoth(pe)&&!h||(555===parseInt(o)||556===parseInt(o))&&("{}"===k||!k)){if(556===parseInt(o)&&!Z)return;return commonUtils.showHideLoadingDiv(),M.find("#"+a).show(),250!==parseInt(o)&&detailView.afterRenderMultilineField($("#subvalue_"+r),r),void $("#"+commonUtils.escapeSingleQuote(globaltextareapanid)+"_cancel").click()}if((void 0===Crm.userDetails.LAYOUTRULEAVAILABLE||!0===Crm.userDetails.LAYOUTRULEAVAILABLE&&Crm.userDetails.LRINVOLVEDMODULES.contains(l)&&"ISJOBSHEETREQUIRED"!==r)&&CFRExec&&CFRExec.evalAjaxEditForLayoutRule(l,r,null!==ue?ue+"#"+k:k,!0,"ajaxEdit"))return;new Promise((function(e){e(CVRExec.evalRules("view",l,r,!0,Ce))})).then((function(v){if(!v)return commonUtils.showHideLoadingDiv(),de.show(),void(itsonview=!0);var C={},h={},_=[],T=$("#mouseArea__"+r),L=T.data("params"),O=T.data("params").sysRefName;if(!["Forecasts","Emails","Visits","Activities","Tasks","Events","Calls","Services","Appointments"].includes(l)&&"556"===T.data("params").uitype){var D={param_url:w,getValue:t,showAfter:a,hideAfter:i,fieldLabel:r,module:l,subid:s,uitype:o,tableName:n,columnName:d,entityID:c,isZtiEnabled:u,istkv:m,fieldId:p,isCallAllowed:g},A=Lyte.registeredMixins["crm-vision-create"].ajaxEditShowSRFBpopup(detailView,D);if(A)return}O=-1!=O.indexOf(".")?O.replace(".","__"):O;var S=new RegExp("CustomModule\\d+_Name");if("STATUS"===d&&"Tasks"===l&&detailView.taskStatusMap.Completed===k){var R=localStorage.getItem("isDontAskAgainChecked_"+Crm.userDetails.ZUID);if("string"==typeof R&&(R="true"===R),!R){$("#showDontAskOption").prop("checked")&&localStorage.setItem("isDontAskAgainChecked_"+Crm.userDetails.ZUID,!0);var U=$("#notifyOwnerOption").prop("checked");h.Send_Notification_Email=U}}"Potentials"!==l||"FORECASTCATEGORY"!==d&&"FORECAST_CATEGORY"!==d||(e="/crm/v2.1/"+moduleApiMapping[l]+"/"+c);var N=new crmRequestPool,P={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken};clientPortalName&&(P["X-CRMPORTAL"]=window.clientPortalName);var j=$("#Crm_"+l+"_"+r);if(301===parseInt(o)||300===parseInt(o))h[O]="true"===k;else if(24===parseInt(o)||202===parseInt(o))if(""===k)h[O]=k;else{if(!apiDateFormat(k))return commonUtils.showErrorMsg(I18n.getMsg("crm.field.valid.check",[j.data("label")]),j),void(itsonview=!0);h[O]=apiDateFormat(k)}else if(786===parseInt(o)||14===parseInt(o)||333===parseInt(o))if(""===k)h[O]=k;else{if(""===apiDateTimeFormat(k))return commonUtils.showErrorMsg(I18n.getMsg("crm.field.valid.check",[j.data("label")]),j),void(itsonview=!0);h[O]=apiDateTimeFormat(k)}else if(/\b(5|4|6|7|9|10|12|13|15|133)\b/.test(o)){if("Calls"===l&&isNewCallView)if("CONTACTID"===globalfieldlabel&&"Contacts"!==j.data("lookupModule"))O="What_Id",h.$se_module="Leads",h.Who_Id=null;else if("SEID"===globalfieldlabel){var H=j.data("lookupModule");h.$se_module=moduleApiMapping[H]}h[O]={},h[O].name=k,""!==ue?h[O].id=ue:ue="",""===k&&""===ue&&(h[O].id=ue,h[O]=""),("Accounts"===j.data("lookupModule")&&j.data("colname")&&-1===j.data("colname").indexOf("CF")||"Bundles"===j.data("lookupModule"))&&(e="/crm/v2.2/"+moduleApiMapping[l]+"/"+c),I=O}else if(221===parseInt(o))h[O]={},""!==k&&(h[O].name=F,h[O].id=k);else if(100===parseInt(o)||96===parseInt(o)){for(var J=k.split("; "),G=[],z=J.length,q=0;q<z;q++)"Bundles"===l&&"Tax"===O?G.push({id:null,value:J[q]}):G.push(J[q]);""===k&&(G=""),h[O]=G}else if(26===parseInt(o)){var W=k.indexOf(":");h[O]=k.substring(W+1)}else if(555===parseInt(o)){var Y="label_"+d,Q=Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxFileUploadCreateComponents(Y)[0].component;if(!Q.validate())return;var Z=Q.getValue();h[O]=Z}else if(556===parseInt(o)){Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents("label_"+r,"create");for(var K=Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents("vlabel_"+r,"view").getValue().map((function(e){return e.id})),ee=V.getValue(),te=ee.map((function(e){return e.id})),ae=K.filter((e=>!te.includes(e))),ie=ae.length,re=0;re<ie;re++)ee.push({id:ae[re],_delete:null});h[O]=ee}else if(1===parseInt(o)&&S.test(O))h.Name=k;else if(445===parseInt(o)||444===parseInt(o)){var le=[],se=$("#mouseArea__"+r).data("params").selectedAPIJson;444===parseInt(o)&&(se=[],-1!=k.indexOf("all")&&(le[0]={},le[0]._delete="all",k=""));var oe=k.split("-"),ne=oe[0].split(","),ce=ne.length;(be={}).api_name=O;var me,pe=moduleRecordMapping[l].fields.filterBy(be)[0];if(me=444===parseInt(o)?pe.multiselectlookup.connectedlookup_apiname:pe.multiuserlookup.connectedlookup_apiname,444===parseInt(o)&&pe&&"MXNDUMMYCOLUMNBUNDLE"===pe.column_name&&k&&X.data()&&X.data().bundleMxnProductIdVsQty&&X.data().lVsp&&X.data().finalResponse){var ge=JSON.parse(X.data().lVsp),fe=Object.keys(ge),ve=(H=X.data().lookupModule,ce=fe.length,X.data().finalResponse);if(ve&&ve.length&&ve.length<1)return void $L("#"+commonUtils.escapeSingleQuote(globaltextareapanid)+"_cancel").click();le=ve}else{var Ce=0,he=se.length;if(""!=oe[0])for(q=0;q<ce;q++){var be;(be={}).id=ne[q];for(var ye=!1,Ie=0;Ie<he;Ie++)if(se[Ie][me].id===ne[q]){ye=!0;break}ye||(le[Ce]={},le[Ce][me]=be,Ce++)}if(2===oe.length&&""!==oe[1]){ce=(ne=oe[1].split(",")).length;for(q=0;q<ce;q++){let e={},t=multiLookupsView.LinkingRecordIds;t&&(e.id=t[ne[q]]);for(ye=!1,Ie=0;Ie<he;Ie++)if(se[Ie][me].id===ne[q]){le[Ce]={},le[Ce].id=se[Ie].id,le[Ce]._delete="null",Ce++,ye=!0;break}ye||!Crm.userDetails.isMultiSelectionPopupSupported&&(Crm.userDetails.isMultiSelectionPopupSupported||void 0===e.id)||(le[Ce]={},Crm.userDetails.isMultiSelectionPopupSupported?le[Ce].id=ne[q]:le[Ce]=e,le[Ce]._delete="null",Ce++)}}}h[O]=le}else h[O]=k;_.push(h),C.data=_,2!==detailView.isApproved?(f&&(C.escape_blocklist=!0),C.formruleValue=CFRExec.getFormRuleDataParams(),e+="?affected_data=true","Quotes"===l&&Crm.isCpqActivated()&&(C.cpq=["product_configurator","pricing_rule"]),commonUtils.showHideLoadingDiv(!0),N.initiate({action:e,type:"PUT",data:JSON.stringify(C),headers:P,contentType:"application/json",success:function(n){if(t.includes("ATTACHMENTID")&&$L("#"+t).closest(".uitype_555").removeClass("fileUploadMenuOpened"),$(".imageUploadDetailPage").removeClass("eventNone"),de.show(),"STAGE"===d){var m=k.split(":");returnJson.entityMapJson.STAGE.val.forEach((function(e){e.name===m[1]&&n.data[0].details.affected_data&&(e.pbty=n.data[0].details.affected_data[0].Probability)}))}if("STATUS"!==d&&"DUEDATE"!==d&&"SUBJECT"!==d||$$rightPanel.detailRightPanel(!0,"info",!0),"MXNDUMMYCOLUMNBUNDLE"===d){var p=$L("#"+t).data(),f=document.querySelector("[id='headervalue_UNIQUE_ITEM_COUNT']"),v=document.querySelector("[id='value_UNIQUE_ITEM_COUNT']"),C=document.querySelector("[id='value_TOTAL_ITEM_COUNT']");if(f&&v&&C){var h=isNaN(parseFloat(C.textContent))?0:parseFloat(C.textContent),_=isNaN(parseFloat(f.textContent))?0:parseFloat(f.textContent),w=e=>parseFloat(e.toFixed(7)),O=n&&n.data?n.data.first():n;if(O&&O.details)if(ce=O.details.affected_data?O.details.affected_data.first():null){var D=ce.Unique_Item_Count?ce.Unique_Item_Count:_;f.textContent=D,v.textContent=D}C.textContent=p.total_item_count?w(h+p.total_item_count):w(h)}var A=p.relatedListId;document.getElementById("ract_"+A).classList.remove("disabled","eventNone")}if(n.data&&"error"===n.data[0].status&&"the id given seems to be invalid"===n.data[0].message)renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error"));else{if("REPORTINGTO_COUNT_EXCEEDED"==n.STATUS){var S="<span id='errorMsg_Crm_Contacts_REPORTINGTOCONTACTID' class='errMsg errorMsgDesc'>"+n.INFO+"</span>";return $("#mouseArea__REPORTINGTOCONTACTID").addClass("errorFieldP"),$("#mouseArea__REPORTINGTOCONTACTID").find("#textarea_REPORTINGTOCONTACTID").append(S),void commonUtils.showHideLoadingDiv()}if("ACCOUNT_PERMISSION_DENIED"==n.STATUS){S="<span id='errorMsg_Crm_Contacts_ACCOUNTID' class='errMsg errorMsgDesc'>"+n.INFO+"</span>";return $("#mouseArea__ACCOUNTID").addClass("errorFieldP"),$("#value_ACCOUNTID").append(S),void commonUtils.showHideLoadingDiv()}if("IMAGELIMITEXCEEDED"==n.STATUS)return crmui.showMsgBand("error",n.INFO,3e3),void commonUtils.showHideLoadingDiv();crmCalendar.close(),"32"!==o&&"38"!==o&&"52"!==o||null!==n.separator&&!0===n.separator&&(n.outputValue=n.formattedValue);var R=n;if(M.find("#errorMsg_textbox_"+r).remove(),M.find("#textbox_"+r).removeClass("errorHighlight"),"DESCRIPTION"==r&&"Events"==$("#module").val()&&M.find("#mouseArea__"+globalfieldlabel).removeClass("dB").addClass("dIB"),"object"==typeof R&&"true"===R.isRemovedFromExternalSource&&$(".businessInfoBtn").hide(),"object"==typeof R&&"duplicate data"===R.data[0].message)return"MSG"===R.TYPE?void commonUtils.checkErrorMsg(n,void 0,e,void 0,l):void displayUniqueFieldDuplicateError(R,r,l);if(R&&R.message&&R.message.indexOf("validation rule execution failed")>-1){if("error"==R.status){if(R.validation_rule_error_fields)for(var U=R.validation_rule_error_fields,N=U.length,V={},j={},H=0;H<N;H++)V=U[H],j=$("#"+CVRExec.getElemId("edit",V.column_name,l)),commonUtils.showErrorMsg(V.alert,j,l),$(j).focus();return}}else{if(R&&R.data[0].status&&"error"===R.data[0].status&&R.data[0].message)return Crm.showAlertMsg(R.data[0].message),void commonUtils.showHideLoadingDiv();if(R&&R.STATUS&&"ZIAFAILURE"===R.STATUS&&R.INFO){var J=Crm.getVisionMyJobsDependency();Lyte.injectResources(J,void 0,(function(){!function(){var e=$("crm-zia-vision-error-popup");0!=e.length&&e.remove();if(Crm.client_tracking("Zia Vision Entity Validation Failure",{type:R.INFO.message}),"do_not_create"===R.INFO.message||"create_without_image"===R.INFO.message)Lyte.Component.render("crm-zia-vision-error-popup",{action:R.INFO.message},"#zia-vision-popup"),$L("#visionModal")[0].ltProp("show",!0)}()}))}else if($L(".lnPhoto_ziaVision").length>0&&!R.hasVisionApproval)Lyte.Router.getRouteInstance().refresh();else if(R.hasVisionApproval){var G=$L(".photoUploadSec");if(returnJson){var z="#"+returnJson.relListLabelsJson.module+"_"+returnJson.relListLabelsJson.entityid+"_photo";$(z)&&deleteEntityImage(z,returnJson.relListLabelsJson.module,!1),G.attr("onclick","detailView.renderVisionErrorPopUp('"+R.failureType+"','"+returnJson.relListLabelsJson.module+"','"+returnJson.relListLabelsJson.entityid+"','"+R.visionId+"','"+R.approvalId+"')"),$L(".lnPhoto_ziaVision")||detailView.renderVisionErrorPopUp(R.failureType,returnJson.relListLabelsJson.module,returnJson.relListLabelsJson.entityid,R.visionId,R.approvalId)}Crm.client_tracking("Zia Vision Entity Validation Failure",{type:R.failureType}),$L(".lnPhoto").addClass("lnPhoto_ziaVision"),G.addClass("cP")}}$("#unique").length&&(document.getElementById("unique").style.display="none");var q=$("#accountId");if(q.length>0&&"view"===window[l].currentStatus&&"Crm_Potentials_ACCOUNTID"===t&&q.val(c),o+""=="445"){var W=$("#mouseArea__"+r).data("params").sysRefName;getMultiuserLookupValues(l,c,W,d,!0)}if(o+""=="444"){var Y={};Y.api_name=T.data("params").sysRefName;var Q=moduleRecordMapping[l].fields.filterBy(Y)[0];if(Crm.userDetails.isRelatedListLyteEnabled)Lyte.registeredMixins["crm-related-list-utils"].addRelatedListsToDom(Q.multiselectlookup.id),Lyte.triggerEvent("relatedList",{id:Q.multiselectlookup.id,scroll:!1});else{var X={};X.actModule=l,X.module=l,X.id=c,X.actId=c,X.isSortRequest=!1,X.rid=Q.multiselectlookup.id,crmRelatedList.ajaxReq(X)}}delete CFRExec.fieldVsValue,delete CFRExec.manateFldVsValue,M.find("#textarea_"+r).hide();var Z=!1,K=!1,ee=!1,te="",ae="",ie="",re=null,le="",se="",oe="",ne="",ce="",me="",pe="",ge="",fe="",ve=featuresAvailable.MultiCurrency,Ce=Crm.userDetails,he=returnJson.entityMapJson.CURRENCYISOCODE?returnJson.entityMapJson.CURRENCYISOCODE.defaultvalue:Ce.BASE_CURRENCY?Ce.BASE_CURRENCY:void 0,be="";if("string"==typeof R)te=(be=R.split("AJAX::::"))[1].trim(),ae=be[2],("Cases"!==l&&"Solutions"!==l||"ADDCOMMENT"!==r)&&(ae=revertSplChrs(ae)),re=be[3].trim(),ne=be[4].trim(),se=be[5].trim(),uiFormulaVals=be[7].trim(),le=be[8].trim(),be[9].trim(),be[12].trim(),be[13].trim(),oe=be[14].trim();else if(be="",R.isRemovedFromExternalSource="Accounts"===l&&"ACCOUNTNAME"===d,R){if(te="success"===(be=R).data[0].status,"TWITTER"===d){if("error"===be.data[0].status){var ye=r.replace(/ /g,"\\ ");return commonUtils.showErrorMsg(I18n.getMsg("crm.tw.err.twHandleName.patterenCheck"),$("#Crm_"+l+"_"+ye)),void $("#textarea_TWITTER").show()}var Ie=k;ae=Ie;var _e=networkUtils.returnDependencyFiles(["crm-social-common-mixins.js","social_related_list_store.js","crm-social-related-list-common.js","crm-social-integ-outer-template.js"],ResourceConstants.CRMClient);Lyte.injectResources(_e,void 0,(function(){Lyte.registeredMixins["crm-social-integration"].reloadTwitter(Ie)}))}else if(/\b(5|4|6|7|9|10|12|13|15|133)\b/.test(o))ae=""===ue&&""!==k?k+"|||"+be.data[0].details[I].id:k+"|||"+ue;else if(221===parseInt(o))ae=F;else if(32===parseInt(o))ae=/^(0)\1{0,}$/.test(k)?"0":k.replace(/^0+/,"");else if(556===parseInt(o))ae=JSON.stringify(k);else if(1!=/^[0-9]*$/.test(k)||33!==parseInt(o)&&35!==parseInt(o)||null==Crm.userDetails.COUNTRY_LOCALE||"en_US"!=Crm.userDetails.COUNTRY_LOCALE)if(445===parseInt(o)){var Ee=$("#temp_"+t).find("li"),we=Ee.length,Te=$("#Crm_"+l+"_"+r).data("selectedid");returnJson.currentField.selectedid=Te.split("-")[0];for(var Le="",Oe=0;Oe<we;Oe++){var Me=Ee[Oe].textContent;0===Oe?Le+=Me:Le=Le+", "+Me}ae=Le}else ae=444===parseInt(o)?"":k;else{ae=10==(Gt=k).length?"("+Gt.substring(0,3)+") "+Gt.substring(3,6)+"-"+Gt.substring(6,10):9==Gt.length?"("+Gt.substring(0,5)+")-"+Gt.substring(5,9):Gt}("Cases"!==l&&"Solutions"!==l||"ADDCOMMENT"!==r)&&250!==parseInt(o)&&(ie=ae,ae=revertSplChrs(ae)),re=!0;var De=(pe=be.data[0].details).Modified_By.name,Ae=pe.Modified_By.id,Se=pe.Modified_Time;Se=new Date(Se.substring(0,Se.length-6)),Se=Utils.convertDateToGivenPattern("D, d M yy",Se)+" "+Utils.getTimeInUserFormat(Se,!0),se="<span purpose='showUserBC' data-params='{\"userId\":\""+Ae+"\"}' >"+$ESAPI.encoder().encodeForHTML(De)+"</span><br><span class='crm-small-font-size fontSmooth crmNotFoundColor crm-font-regular'>"+Se+"</span>",36!==parseInt(o)&&143!==parseInt(o)&&144!==parseInt(o)&&145!==parseInt(o)||(null!==k&&""===k&&(k="10000000000000000"!==k?k.toString():"9999999999999999"),le=k),(ce=null!==pe.affected_data&&pe.affected_data[0])&&"$process_flow"in ce&&(K=ce.$process_flow,delete ce.$process_flow),ce&&"$approved"in ce&&(ee=ce.$approved,delete ce.$approved),ce&&"Expected_Revenue"in ce&&ce.Expected_Revenue}if(ce=null!==be.data[0].details.affected_data&&be.data[0].details.affected_data[0],"Tasks"===l&&"DUEDATE"===r){var Re="",Ue="REMINDAT",Ne=$("#mouseArea__"+Ue),Pe=$("#value_"+Ue),xe=$("#subvalue_"+Ue),Ve=$("#headervalue_"+Ue);if(void 0!==ce.Remind_At){var $e=$L.moment(ce.Remind_At.valueOf()).toDate();$e.setMinutes($e.getMinutes()-Utils.getTimezoneOffset()),delete ce.Remind_At;var ke=Utils.convertDateToUserPattern($e),Fe=Utils.convertDateToUserPattern(returnJson.entityMapJson.REMINDAT.reminderDate);Re=returnJson.entityMapJson.REMINDAT.reminderTime.replace(Fe,ke)}Pe.html(Re),xe.html(Re),Ve.html(Re)}if("Calls"===l&&"SUBJECT"===r&&((Ve=$("#headervalue_SUBJECT")).html(ae),$("#headertextarea_SUBJECT").hide()),ce.Overall_Sales_Duration&&ce.Sales_Cycle_Duration&&(ge=ce.Sales_Cycle_Duration,fe=ce.Overall_Sales_Duration),ce.$converted&&(Z=!0,detailView.isRecordConverted=!0,delete ce.$converted),ce||555===parseInt(o)){ce&&delete ce.id;var Be=returnJson.entityMapJson,je="",He="",Je={};for(var Ge in Be){var ze=Be[Ge].uitype,qe=(Ue=Be[Ge].colname,ce[Be[Ge].sysRefName]);if("CLOSEDTIME"===Ue&&""!=qe){var We=new Date(pe.Modified_Time);Utils.convertToUserTimezone(We),qe=Utils.getDateTimeInUserFormat(We,!0,!0)}if(555===parseInt(ze)&&Be[Ge].sysRefName in pe)me=qe=pe[Be[Ge].sysRefName],delete pe[Be[Ge].sysRefName];else if(ce&&Be[Ge].sysRefName in ce){Ne=$("#mouseArea__"+Ue),Pe=$("#value_"+Ue),xe=$("#subvalue_"+Ue),Ve=$("#headervalue_"+Ue);if(36!==parseInt(ze)&&143!==parseInt(ze)&&145!==parseInt(ze)&&144!==parseInt(ze)||(qe=ve&&void 0!==Crm.userDetails.CURRENCY_DETAILS[he]?returnJson.entityMapJson.EXCHANGERATE&&returnJson.entityMapJson.EXCHANGERATE.defaultvalue?currencyUtils.returnValueInDefaultCurrency(he,qe,Crm.userDetails.CURRENCY_DETAILS[he].decimals,parseFloat(returnJson.entityMapJson.EXCHANGERATE.defaultvalue)):currencyUtils.returnValueInDefaultCurrency(he,qe,Crm.userDetails.CURRENCY_DETAILS[he].decimals):currencyUtils.returnValueInDefaultCurrency(he,qe)),Pe.length>0||xe.length>0){var Ye=!1;if(null!==Ne&&"string"===Ne.data("params").formulaType&&(qe=$ESAPI.encoder().encodeForHTML(qe)),null!==Ne&&"2"===Ne.data("params").uitype){var Qe=$("span#subvalue_"+Ue);if(Qe.html(qe),Qe.hasClass("colorAppliedPicklist")){var Xe=returnJson.entityMapJson[Ue].picklistmap;if(Xe){var Ze=Xe.filter((function(e){return e.uservalue===qe}));void 0!==Ze&&Ze.length>0&&Ze[0].colorCode&&Qe.attr({class:"colorAppliedPicklist",style:getPLStyleObj(Ze[0].colorCode)})}}}else{if(Ye=!0,"Calls"===l&&isNewCallView&&"CONTACTID"!==r&&"SEID"!==r&&Ve.html(qe),"Campaigns"==l&&"ACTUALCOST"==Ue)(da=$("#stripValue_ACTUALCOST")).html(),da.html(qe)}if(null!==Ne&&"date"===Ne.data("params").formulaType&&""!==qe){We=Utils.convertFrom8601DateFormat(qe);Utils.convertToUserTimezone(We);var Ke=Utils.getDateInUserDatePattern(We,!0);qe=Ke,Ye=!0}else if(null!==Ne&&"datetime"===Ne.data("params").formulaType&&""!==qe){var et=Utils.getUserDateTimeFormatFromServerFormat(qe);qe=et,Ye=!0}else if(null!==Ne&&""!==qe&&"number"===Ne.data("params").formulaType){if(qe=qe.toString(),!0===Ne.data("params").separator){"ar-SA"!==(Ma=Crm.userDetails.COUNTRY_LOCALE.replace("_","-"))&&"es-PR"!==Ma&&"bn-BD"!==Ma&&"ar-AE"!==Ma&&"ar-KW"!==Ma&&"ar-QA"!==Ma||(Ma="en-US");var tt=Intl.NumberFormat(Ma,{maximumFractionDigits:Ne.data("params").decimalLength}).format(qe),at=new Intl.NumberFormat(Ma).format(11111).replace(/1/g,""),it=new Intl.NumberFormat(Ma).format(1.1).replace(/1/g,""),rt=tt.split(at).join(Crm.userDetails.numberSeparators.group);if(1===Search.countCharacters(it,tt)){var lt=it+"([^"+it+"]*)$",st=new RegExp(lt);rt=rt.replace(st,Crm.userDetails.numberSeparators.decimal+"$1")}qe=rt}Ye=!0}else null!==Ne&&"boolean"===Ne.data("params").formulaType?(qe=qe.toString(),Ye=!0):null!==Ne&&"currency"===Ne.data("params").formulaType&&(""!==qe&&(qe=ve&&void 0!==Crm.userDetails.CURRENCY_DETAILS[he]?currencyUtils.returnValueInDefaultCurrency(he,qe,Crm.userDetails.CURRENCY_DETAILS[he].decimals):currencyUtils.returnValueInDefaultCurrency(he,qe,Ne.data("params").decimalLength)),Ye=!0);Ye&&($("span#subvalue_"+Ue).html(qe),"EXPECTEDREVENUE"==Ue&&$("#value_"+Ue).html(qe)),"FORECASTCATEGORY"!==Ue&&"FORECAST_CATEGORY"!==Ue&&"REASON_FOR_LOSS"!==Ue||(Ne.data("params").defaultvalue=qe),116===parseInt(ze)&&(je+="#value_"+Ue+",",He+="#header_"+Ue+",")}"true"===Be[Ge].isaggrfield&&Crm.userDetails.isSubformNewComponentEnabled&&(Je[Be[Ge].sysRefName]=qe),delete ce[Ge.sysRefName]}if(0===!ce.length)break}objectUtils.getLength(Je)>0&&(Je.id=be.data[0].details.id,store.pushPayload(moduleRecordMapping[l].id,Je),document.querySelectorAll("crux-subform").forEach((function(e){e.highlightAggregateField(Object.keys(Je))})))}if(ee)reloadCurrentEntityView(detailView.entityId,detailView.currentModule,void 0,ee);else{if(K&&detailView.currentModule&&detailView.entityId){if(!($("#pb_processButtonLayerInner").length>0))return void 0!==detailView.affectedData&&void 0!==n.data[0].details.affected_data&&(detailView.affectedData=n.data[0].details.affected_data,detailView.affectedData[1]="OtherThanGlobalAndFieldEdit"),void reloadCurrentEntityView(detailView.entityId,detailView.currentModule);Handlebars.templates.ProcessPreviewPop?Lyte.injectResources([networkUtils.returnDependencyFiles(["zohocrm_ProcessFlow.js"],ResourceConstants.CRM)],void 0,(function(){ProcessFlow.refreshButtonLayer(detailView.currentModule,detailView.entityId,detailView.orchestrationDetailsArray,detailView.pathfinderDetailsArray)})):Lyte.injectResources([networkUtils.returnDependencyFiles(["transitionButtonLayer.js","processPreviewPop.js","zohocrm_ProcessFlow.js"],ResourceConstants.CRM)[0]],void 0,(function(){ProcessFlow.refreshButtonLayer(detailView.currentModule,detailView.entityId,detailView.orchestrationDetailsArray,detailView.pathfinderDetailsArray)}))}if(786===parseInt(o)||14===parseInt(o)||333===parseInt(o)){var ot=null,nt=B.val().split(" "),dt=nt[0].split(":"),ct=""!=nt?Utils.getMeridiem(B.timeEntry("getTime")).toUpperCase():"AM",ut=""!=nt?parseInt(dt[0]):"HH:mm"===Crm.userDetails.TIME_FORMAT?0:12,mt=""!=nt?dt[1]:"00";"HH:mm"!==Crm.userDetails.TIME_FORMAT&&(ut=Utils.convertTimeTo24HoursFormat(ut,ct)),ot=x.value?Utils.getDateObject(x.value,{hrs:ut,mins:mt}):"",detailView.replaceDataParams(r,ot+""),ae=ot&&""!==ot?Utils.getDateTimeInUserFormat(ot,!0):""}var pt;if(te){if(!Z){if(556==o){var gt=[];if(void 0!==pe[Vt=T.data("params").sysRefName]){gt=Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents("label_"+r,"create").getData("images");var ft=Lyte.registeredMixins["crm-uploadfields-mixin"].constructImageDataFromServer(pe[Vt],l,$L("#id").val(),T.data("params").fieldid);1===(gt=Lyte.registeredMixins["crm-uploadfields-mixin"].constructImageSrcWithExistingData(ft,gt)).length&&(gt=Lyte.registeredMixins["crm-uploadfields-mixin"].constructImageDataByState(gt,pe[Vt]))}var vt=Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents("vlabel_"+r,"view");return vt.setData("cxPropValue",gt),vt.setData("cxPropValidationTooltip",Lyte.registeredMixins["crm-uploadfields-mixin"].setTooltipValue(gt)),$L("#value_"+r).css("display",""),void refreshFollowDiv()}var Ct="";if(b=document.getElementById(a),-1==$("#"+a).attr("id").indexOf("header")?(Ct="header"+a,y=$("#"+Ct).length?getObj(Ct):b):(Ct=a.replace("header",""),y=getObj(Ct)),25===parseInt(o)){var ht="";ht=' <a class="crmLinkColor cP accessibility-route-elem" href="mailto:'+k+'" id="'+s+'"/>'+ae+"</a>",$(b).empty(),b.innerHTML=ht,ht=changeSubValueId(ht,[b,y]),$(y).empty(),y.innerHTML=ht;var bt=new RegExp("CustomModule\\d+"),yt=document.querySelector("#mailType");if(("Leads"===l||"Contacts"===l||"Vendors"===l||bt.test(l))&&yt){if("ZMAIL"===yt.value&&document.querySelector("#relatedPageContent")){if(document.querySelector("#zmailEmail")){var It="";if("EMAIL"===r)""!==k&&(It=k),(_t=getObj("subvalue_ADDN_EMAIL"))&&null!==_t.href&&"mailto:"!==_t.href&&(It=""!==It?It+","+getObj("subvalue_ADDN_EMAIL").href.replace("mailto:",""):getObj("subvalue_ADDN_EMAIL").href.replace("mailto:",""));else if("ADDN_EMAIL"===r){var _t;""!==k&&(It=k),(_t=getObj("subvalue_EMAIL"))&&null!==_t.href&&"mailto:"!==_t.href&&(It=""!==It?getObj("subvalue_EMAIL").href.replace("mailto:","")+","+It:getObj("subvalue_EMAIL").href.replace("mailto:",""))}getObj("zmailEmail").value=It,""!==It&&(getObj("mailConfigType").value=It)}"undefined"!=typeof crmSocialInteraction&&crmSocialInteraction.fetchSocialRelatedList(),Crm.userDetails.isRelatedListLyteEnabled?Lyte.registeredMixins["crm-related-list-utils"].fetchCustomRelatedList():fetchCustomRelatedList(),ZInvoice.loadRelatedList(),Crm.userDetails.isEmailsForModuleEnabled||loadMailListForRL(l)}document.querySelector("#entIdForZMail")&&Crm.userDetails.isEmailsForModuleEnabled&&(Crm.userDetails.isRelatedListLyteEnabled?Lyte.triggerEvent("relatedList",{pname:"EMAILSPERSONALITY"}):reloadPersonality("emailspersonality"))}detailView.replaceDataParams(r,ae)}else if(555===parseInt(o)){var Et=T.data("params").colname,wt=$("#subvalue1_"+Et);if(wt.empty(),""===me){var Tt=T.data("params").defaultvalue,Lt=fileupload.removedAttachmentIds.length;for(Oe=0;Oe<Lt;Oe++)for(var Ot=Tt.length,Mt=0;Mt<Ot;Mt++)if(Tt[Mt].attachment_Id===fileupload.removedAttachmentIds[Oe]){Tt.splice(Mt,1);break}me=Tt}ae=me;var Dt=me.length;for(Mt=0;Mt<Dt;Mt++){var At=me[Mt].attachment_Id,St='<a class="oH tOE wsNowrap vaBottom dIB cP maxW240">'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+"</a>";if(0==me[Mt].link_Docs)if(me[Mt].is_Preview_Available)if("pdf"==me[Mt].extn){var Rt="javascript:openSheetForExport('"+me[Mt].preview_Url+"','pdfViewPlugin');sE(event);";St='<a id="fileUploadField_'+At+'" class="oH tOE wsNowrap vaBottom dIB pT0 maxW180 cP" title="'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+'" onClick="'+Rt+'">'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+"</a>"}else if(""!=me[Mt].mode){Rt="javascript:openSheetForExport('"+me[Mt].preview_Url+"');sE(event);";St='<a id="fileUploadField_'+At+'" class="oH tOE wsNowrap vaBottom dIB pT0 maxW180 cP" title="'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+'" onClick="'+Rt+'">'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+"</a>"}else"png"==me[Mt].extn&&(St='<a id="fileUploadField_'+At+'" class="oH tOE wsNowrap vaBottom dIB pT0 maxW180 cP" title="'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+'" onClick="showImagePreview(this);" href="'+me[Mt].preview_Url+'" class="cboxElement" name="cboxElement">'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+"</a>");else St='<a id="fileUploadField_'+At+'" class="oH tOE wsNowrap vaBottom dIB" style="max-width: 180px;cursor: pointer;" title="'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+'" href="'+me[Mt].preview_Url+'">'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+"</a>";else if(1==me[Mt].link_Docs){Rt=Crm.userDetails.isRelatedListLyteEnabled?"Lyte.registeredMixins['crm-related-list-utils'].triggerLinkDocsView('"+me[Mt].preview_Url+"','"+me[Mt].extn+"','"+At+"','fileupload');sE(event);":"triggerLinkDocsView('"+me[Mt].preview_Url+"','"+me[Mt].extn+"','"+At+"','fileupload');sE(event);";St='<a id="fileUploadField_'+At+'" class="oH tOE wsNowrap vaBottom dIB" style="max-width: 180px;cursor: pointer;" title="'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+'" onClick="'+Rt+'">'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+"</a>"}else if(3==me[Mt].link_Docs){Rt=Crm.userDetails.isRelatedListLyteEnabled?"Lyte.registeredMixins['crm-related-list-utils'].triggerLinkDocsView('"+me[Mt].preview_Url+"','"+me[Mt].extn+"','"+At+"','fileupload');sE(event);":"triggerLinkDocsView('"+me[Mt].preview_Url+"','"+me[Mt].extn+"','"+At+"','fileupload');sE(event);";St='<a id="fileUploadField_'+At+'" class="oH tOE wsNowrap vaBottom dIB" style="max-width: 180px;cursor: pointer;" rel="noopener noreferrer" target="_blank" title="'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+'" href="'+me[Mt].preview_Url+'">'+$ESAPI.encoder().encodeForHTMLAttribute(me[Mt].file_Name)+"</a>"}var Ut='<span class="dIB crm-small-font-size crmNotFoundColor pR" style="max-width: 250px;">'+St+'</span><span class="mL5 op5 vaM zcicn-cssIcons zcicn_grey_mask zcicncss-download zcicncss16 cP cNdownloadOption"><a id="downloadlink" class="attachDropMenuRow cP" href="'+me[Mt].download_Url+'"></a></span>',Nt='<li id ="upload_'+At+'" class="oH p0 m0 mT5 fileUploadLi" data-type="edit"><div class="dIB fL pR"><span class="dIB vaT mR5 mT1 fileIconDefault svgIconsImg"></span>'+Ut+"<div></li>";3==me[Mt].link_Docs&&(Nt='<li id ="upload_'+At+'" class="oH p0 m0 mT5 fileUploadLi" data-type="edit"><div class="dIB fL pR"><span class="dIB vaT mR5 mT1 svgIcons ico-teamDrive"></span>'+(Ut='<span class="dIB crm-small-font-size crmNotFoundColor pR" style="max-width: 250px;">'+St+"</span></span>")+"<div></li>"),wt.append(Nt);var Pt=$("#upload_"+At).find(".fileIconDefault"),xt=showImageType(me[Mt].extn);Pt.addClass(xt)}var Vt="label_"+d,$t=Lyte.registeredMixins["crm-uploadfields-mixin"],kt=$t.getFileDataInCruxFormat(me);$t.getCruxFileUploadViewComponents(Vt)[0].component.setData("cxPropValue",kt);var Ft=$t.getCruxFileUploadViewComponents(Vt)[0].parentElement.parentElement;0===kt.length?$L(Ft).removeClass("fu_viewNonEmpty"):kt.length>0&&$L(Ft).addClass("fu_viewNonEmpty"),$("#"+a).css({display:"inline-block"}),(Da=T.data("params")).defaultvalue=ae}else if(300===parseInt(o)||301===parseInt(o)){var Bt="yes_"+r,jt="no_"+r,Ht="",Jt="";"true"==ae?(Ht=$("[id='"+Bt+"']"),Jt=$("[id='"+jt+"']")):(Ht=$("[id='"+jt+"']"),Jt=$("[id='"+Bt+"']"),"EMAILOPTOUT"===r&&($("#fullInfoDiv i.unsubscribeInfo").remove(),$("#bcWraperDiv i.unsubscribeInfo").remove())),Ht.length?($.each(Ht,(function(e,t){t.style.display="inline-block"})),$.each(Jt,(function(e,t){t.style.display="none"}))):(Ht.style.display="inline-block",Jt.style.display="none"),detailView.replaceDataParams(r,ae)}else if(21!==parseInt(o)&&22!==parseInt(o)||"Calls"===l&&"CTIVOICEURL"===r)if(33===parseInt(o)){var Gt=k;$(b).empty(),$(y).empty();ht="";if("PHONE"===d){var zt=$("#zpbCallAllowedField"),qt=$("#ctiCallAllowedField");zt.length&&zt.attr("onClick","crmCallsNew.initiateCallViaZPB('"+$ESAPI.encoder().encodeForJavaScript(Gt)+"', '"+c+"', '"+l+"',  '"+$ESAPI.encoder().encodeForJavaScript(detailView.changedBCJson.hidden.entityName)+"')"),qt.length&&qt.attr("onClick","ctiApiNotifier.click2Call('"+$ESAPI.encoder().encodeForJavaScript(Gt)+"', '"+Crm.userDetails.ZGID+"','"+Crm.userDetails.USER_ID+"', '"+c+"','', '"+l+"',  '"+$ESAPI.encoder().encodeForJavaScript(detailView.changedBCJson.hidden.entityName)+"')")}if("Calls"!==l||"TONUMBER"!==d&&"FROMNUMBER"!==d||Calls.updateUnknownNumber(ae,d,detailView.entityId),k=0==(k=replace4Skype(k)).indexOf("+")?k.substring(1):k,"false"===g||!1===g){if((Wt=document.createElement("SPAN")).id=s,Wt.setAttribute("id",s),Wt.setAttribute("class","phoneRtl"),Wt.innerHTML=ae,b.appendChild(Wt),b.id!=y.id)(Yt=document.createElement("SPAN")).id=s,Yt.setAttribute("class","phoneRtl"),Yt.setAttribute("id",s.replace("subvalue_","subvalue1_")),Yt.innerHTML=ae,y.appendChild(Yt)}else if(!k||1!=u&&"true"!=u){var Wt,Yt;if((Wt=document.createElement("SPAN")).id=s,Wt.setAttribute("id",s),Wt.setAttribute("class","phoneRtl"),Wt.innerHTML=ae,b.appendChild(Wt),b.id!=y.id)(Yt=document.createElement("SPAN")).id=s,Yt.setAttribute("class","phoneRtl"),Yt.setAttribute("id",s.replace("subvalue_","subvalue1_")),Yt.innerHTML=ae,y.appendChild(Yt);if(k)if(Crm.userDetails.ZPBENABLED){var Qt=$("#id").val(),Xt='asyncFn(crmCallsNew.getClick2CallPromise,"'+Qt+'","'+l+'","'+$ESAPI.encoder().encodeForJavaScript($("#entityName").val())+"\",'',\""+$ESAPI.encoder().encodeForJavaScript(ae)+'","'+d+'")';ht="<zpb-phone number="+$ESAPI.encoder().encodeForHTMLAttribute(ae)+" module="+l+" recordid='"+Qt+"' callbackparamfn='"+Xt+"'></zpb-phone>"}else ht="<a class='pH2 fL ' title='"+I18n.getMsg("crm.phoneNo.Link.Title")+"' href='skype:+"+k+"?call' id='zti_"+s+"'></a>";else ht="","Calls"===l&&(ht='<span class="callFormatLtr"></span>')}else ht="<span class='fL'>"+ae+"</span><a href='javascript:;' class='calliconOuter' onmouseover=\"CTIAPI.showCallButtonlabel(this)\" onmouseout=\"CTIAPI.hideCallButtonlabel(this)\" onclick=\"ctiApiNotifier.click2Call('"+$ESAPI.encoder().encodeForJavaScript(ae)+"','"+Crm.userDetails.ZGID+"','"+Crm.userDetails.USER_ID+"','"+recordid1+"','','"+l+"','"+$ESAPI.encoder().encodeForJavaScript($("#entityName").val())+"')\" ><i class='callIcon'></i><span id='calllabel1' style='display:none;'>"+I18n.getMsg("Call")+"</span></a>",ht+='<input type="hidden" name="isTelephonyEnabled" id="isTelephonyEnabled" value="S"/>',ht+='<input type="hidden" name="telephonyzgid" id="telephonyzgid" value="'+Crm.userDetails.ZGID+'"/>',ht+='<input type="hidden" name="telephonyuserid" id="telephonyuserid" value="'+Crm.userDetails.USER_ID+'"/>',ht+='<input type="hidden" name="recordid" id="recordid" value="'+recordid1+'"/>';b.innerHTML=ht+b.innerHTML,ht=changeSubValueId(ht,[b,y]),b.id!=y.id&&(y.innerHTML+=ht),detailView.replaceDataParams(r,Gt)}else if(35===parseInt(o)){ht='<span class="phoneRtl" id="'+s+'"/>'+ae+"</span>";$(b).empty(),b.innerHTML=ht,ht=changeSubValueId(ht,[b,y]),$(y).empty(),y.innerHTML=ht,detailView.replaceDataParams(r,k)}else if(37===parseInt(o)){ht="";ht=""!=k?'<a class="phoneRtl" href="skype:'+$ESAPI.encoder().encodeForHTML(k)+'" id="'+s+'">'+ae+'<span class="skype dIB fr mL5 vaM" onclick="sE(event)"></span></a>':'<a class="phoneRtl" href="skype:'+$ESAPI.encoder().encodeForHTML(k)+'" id="'+s+'"/>'+ae+"</a>",$(b).empty(),b.innerHTML=ht,ht=changeSubValueId(ht,[b,y]),$(y).empty(),y.innerHTML=ht,detailView.replaceDataParams(r,ae)}else if(4===parseInt(o)||6===parseInt(o)||7===parseInt(o)||9===parseInt(o)||10===parseInt(o)||12===parseInt(o)||13===parseInt(o)||15===parseInt(o)||5===parseInt(o)||133===parseInt(o)){var Zt=ae.split("|||"),Kt=$(x).data("lookupModule"),ea=Zt[0],ta=Zt[1],aa="<a class='link accessibility-route-elem' id='"+s+"' onclick=\"Crm.trackSpotLightAction('Lookup Click',{'Module':'"+Kt+'\'});" onmouseenter="crmLookupBusinessCard.showLookupDetails(this)" onmouseout="crmui.hideTooltip()" data-zcqa=\'detailView\' data-cid=\'detailView\' data-params=\'{"module":"'+Kt+'","id":"'+ta+'"}\' href="'+Crm.getCrmBasePath()+"/EntityInfo.do?module="+Kt+"&amp;id="+ta+'">'+ea+"</a>";if("Calls"===l&&isNewCallView&&("CONTACTID"===r||"SEID"===r))return Calls.updateCardsDataAjax(detailView.entityId,Kt,ta,ea),void reloadCurrentEntityView(detailView.entityId,detailView.currentModule);$(b).empty(),b.innerHTML=aa,aa=changeSubValueId(aa,[b,y]),$(y).empty(),y.innerHTML=aa,"Accounts"===Kt&&q&&q.val(ta),"Accounts"===Kt&&getElemById("accountId")&&getElemById("accountName")&&(getElemById("accountId").value=accountID,getElemById("accountName").value=accountName);var ia={defaultvalue:replaceSplChrs(ea),defaultid:ta};if(detailView.replaceDataParams(r,ia),crmConstants.reloadSalesNavigator=!0,"Accounts"!==Kt||"SalesOrders"!==l&&"Invoices"!==l&&"Quotes"!==l||detailView.loadRelatedDetails(l,c,"Accounts"),crmConstants.reloadSalesNavigator=!0,"Accounts"===Kt&&"Contacts"===l){var ra=$("#value_REPORTINGTOCONTACTID");ra.length>0&&(ra.empty(),ra.innerHTML=""),$("#headervalue_REPORTINGTOCONTACTID").html("")}if("Potentials"===l&&Crm.userDetails.CONTACT_ROLES_EMAILS_RL&&null!=$L("crm-rl-users-list")[0])$L("crm-rl-users-list")[0].component.methods.refreshContactRoles(ta);133===parseInt(o)&&"Cases"===l&&Crm.userDetails.isEmailsForCasesModuleEnabled&&reloadPersonality("emailspersonality")}else if(98===parseInt(o)){var la=$("#textarea_STATUS").find("select")[0];b.setAttribute("statusvalue",la[la.selectedIndex].value),b.innerHTML=la[la.selectedIndex].text,reloadCurrentEntityView(),detailView.replaceDataParams(r,la[la.selectedIndex].text)}else if(36===parseInt(o)||143===parseInt(o)||145===parseInt(o)||144===parseInt(o)){var sa,oa=$("#mouseArea__"+r).data("params");if(0!==oa.rounding_option)try{oa&&!isNaN(oa.rounding_precision)&&(sa=parseInt(oa.rounding_precision),le=currencyUtils.applyRounding(k,o,sa,oa.rounding_option),$(b).empty().data("value",le))}catch(e){$(b).empty().data("value",k)}else $(b).empty().data("value",k);var na="";null!==k&&""!==k&&(na=ve&&void 0!==Crm.userDetails.CURRENCY_DETAILS[he]?returnJson.entityMapJson.EXCHANGERATE&&returnJson.entityMapJson.EXCHANGERATE.defaultvalue?currencyUtils.returnValueInDefaultCurrency(he,k,Crm.userDetails.CURRENCY_DETAILS[he].decimals,parseFloat(returnJson.entityMapJson.EXCHANGERATE.defaultvalue),o,sa,void 0,oa.rounding_option):currencyUtils.returnValueInDefaultCurrency(he,k,Crm.userDetails.CURRENCY_DETAILS[he].decimals,void 0,o,sa,void 0,oa.rounding_option):currencyUtils.returnValueInDefaultCurrency(he,k,oa?oa.decimalLength:void 0,void 0,o,sa,void 0,oa.rounding_option)),pt=k,b.innerHTML=na,$(y).empty(),y.innerHTML=na;var da,ca=getObj("actualValue_"+r),ua=$("#value_"+r);if(ua.data("value")&&ua.data("value",le),ca&&(ca.value=le),"Campaigns"==l&&"ACTUALCOST"==r)(da=$("#stripValue_ACTUALCOST")).html(),da.html(na);else"Potentials"===l&&"AMOUNT"===E.colname&&Crm.calculateExpectedRevenue();ia={defaultvalue:le,plainValue:le};detailView.replaceDataParams(r,ia)}else if(3===parseInt(o)||110===parseInt(o)){if(("Cases"===l||"Solutions"===l)&&"ADDCOMMENT"===r){na="<div class='commentSection'><pre class='value commentText crm-font-regular' style='width: 540px;overflow:hidden;word-wrap: break-word;' wrap='soft'>"+$ESAPI.encoder().encodeForHTML(k)+"</pre><div class='label commentDesc crm-small-font-size fontSmooth crmNotFoundColor crm-font-regular' align='right'> "+$ESAPI.encoder().encodeForHTML(De)+" On "+Se+"</div></div>";ae=populateCommentSection(na)}"Events"!==l&&(b&&y&&b.id==y.id?y=$("#subvalue_"+r).length>0?$("#subvalue_"+r)[0]:y:-1!==b.id.indexOf("header")&&(y=b)),b=$("[id='subvalue_"+r+"']");var ma=ae;ma=renderingUtils.highlightUrlInText(ma),b.next("a").remove(),b.addClass("DV_textAreaLineClamp"),$(b).html(ma),setTimeout((function(){detailView.afterRenderMultilineField(b,r)}),50),detailView.replaceDataParams(r,ae)}else if(250===parseInt(o)){b.querySelector("crm-richtext-component").component.setData("cxPropValue",ae),y.querySelector("crm-richtext-component").component.setData("cxPropValue",ae);ia={defaultvalue:ae};detailView.replaceDataParams(r,ia)}else if(26===parseInt(o)){tt="";if(1==(Zt=ae.split(":")).length)tt+=Zt[0];else{var pa=Zt.length;for(Oe=1;Oe<pa;Oe++)Oe==pa-1?tt+=Zt[Oe]:tt=tt+Zt[Oe]+":"}var ga=tt;if(L&&L.colorcode_enabled){var fa=getPickListColorCode(tt,L.val,!0);L.color_code=fa;var va=getPLStyleObj(fa);ga="<span id='subvalue_STAGE' data-zcqa='colorcode_"+r+"_"+c+"' class='colorAppliedPicklist' style='"+va+"'>"+tt+"</span>"}if($(b).empty(),b.innerHTML=ga,$(y).empty(),y.innerHTML=ga,-1!==replaceSplChrs(ae).indexOf("\\")?$("#stageContain").find('li[data-value="'+replaceSplChrs(ae).replace(/\\/,"\\\\")+'"]').trigger("click"):$("#stageContain").find('li[data-value="'+replaceSplChrs(ae)+'"]').trigger("click"),$("#potclosedv").val(replaceSplChrs(ae)).trigger("change.select2"),getObj("relatedPageContent"))if(Crm.userDetails.isRelatedListLyteEnabled)Lyte.triggerEvent("relatedList",{module:"DealHistory"});else{var Ca="",ha="potstagehistpersonality",ba=(ni=crmRelatedList.personalityArr.split("||")).length;for(Oe=0;Oe<ba;Oe++){if((Ba=ni[Oe].split("_"))[0]===ha){ha=Ba[0],Ca=Ba[1];break}}if(void 0!==Ca){var ya=Crm.getCrmBasePath()+"/NewRelatedList.do?action=getData&module="+getObj("module").value+"&id="+getObj("id").value+"&cvid="+getObj("cvid").value+"&pname="+ha.toLocaleUpperCase();mR(ya,(function(e){crmRelatedList.load(crmRelatedList.Module,crmRelatedList.EntityId,e)}))}}ia={defaultvalue:tt,plainValue:tt};detailView.replaceDataParams(r,ia),Crm.userDetails.detailView_newUI&&Lyte.injectResources(networkUtils.returnDependencyFiles(["crm-detail-view-utils.js"],ResourceConstants.CRMClient),void 0,(function(){Lyte.registeredMixins["crm-detail-view-utils"].renderStageComponent()}))}else if(786!==parseInt(o)&&333!==parseInt(o)||!ae)if(221===parseInt(o)){var Ia=ae;ae&&(Ia='<span purpose="showUserBC" data-params=\'{"userId":"'+k+'"}\' id="ownerName_id" data-zcqa="value_'+r+'">'+ae+"</span>"),$(b).html(Ia),$(y).html(Ia);ia={defaultid:k,defaultvalue:ae};detailView.replaceDataParams(r,ia)}else{if("Events"!==l){b&&y&&b.id==y.id?y=$("#subvalue_"+r).length>0?$("#subvalue_"+r)[0]:y:-1!==b.id.indexOf("header")&&(y=b);var _a=$("span#subvalue_"+r);b=_a.length>0?_a:b}var Ea=getObj("entity_name"),wa=l.slice(0,l.length-1),Ta=$("#rItemDataSubDiv").find("#recentItemImg_"+c).find("div");a=="value_"+wa+" Name"?Ea&&(Ea.value=ae):wa&&a=="value_"+wa.toUpperCase()+"NAME"&&($("#entityName").val(ae),Ta.html(ae)),$("#titlecard_"+d).length&&$("#entityName").val(ae);var La=$(b);if(La.empty(),La.parents("td").removeClass("selectBoxSelect2"),o==CrmField.UITYPES.SERVICE_DURATION){var Oa=Handlebars.helpers.setServiceDuration(ae);La.html(Oa)}else{if(("32"===o||"38"===o||"52"===o)&&""!==ae&&!0===E.separator){var Ma;"ar-SA"!==(Ma=Crm.userDetails.COUNTRY_LOCALE.replace("_","-"))&&"es-PR"!==Ma&&"bn-BD"!==Ma&&"ar-AE"!==Ma&&"ar-KW"!==Ma&&"ar-QA"!==Ma||(Ma="en-US"),tt="38"===o?Intl.NumberFormat(Ma,{maximumFractionDigits:E.decimalLength}).format(ae):ae.length>16?Search.formatBigNumber(ae,Ma):Intl.NumberFormat(Ma).format(ae);at=new Intl.NumberFormat(Ma).format(11111).replace(/1/g,""),it=new Intl.NumberFormat(Ma).format(1.1).replace(/1/g,""),rt=tt.split(at).join(Crm.userDetails.numberSeparators.group);if(1===Search.countCharacters(it,tt)){lt=it+"([^"+it+"]*)$",st=new RegExp(lt);rt=rt.replace(st,Crm.userDetails.numberSeparators.decimal+"$1")}ae=rt}La.html(ae),1==o&&(ae=ie)}var Da,Aa="true"===$("#iskanbanview").val();if("Events"!==l||2!==o&&"2"!==o){if(2===parseInt(o)&&L&&L.colorcode_enabled){fa=getPickListColorCode(ae,L.picklistmap);L.color_code=fa;va=getPLStyleObj(fa);$(b).attr("style",va),"-None-"===ae||""===ae?$(b).addClass("colorAppliedPKNone"):$(b).removeClass("colorAppliedPKNone")}}else if((Da=T.data("params"))&&Da.dataObj&&Da.dataObj["data-picklist-color"]){var Sa=$("#selectColorComponent"),Ra=$("#detailViewButtonLayerMainTable"),Ua=$("#detailView_"+detailView.entityId);if(Aa&&(Ua=$("#kanban_"+detailView.entityId)),Sa.length>0){Crm.userDetails.RTL_ENABLED?Sa.css({right:"calc(40% + 4px)",top:"12px"}):Sa.css({left:"calc(40% + 5px)",top:"12px"});var Na=Sa.css("background-color");Sa.insertBefore($(b)),(Pa=Ra.find(".activitesColor"))&&Pa.length>0?Pa.css("background-color",Na):$("#eventNameDiv").append('<span class="activitesColor eventColor_dv" data-zcqa="eventTemplecolor" style="background: '+Events.rgbtohex(Na)+'"></span>'),(xa=Ua.find(".activitesColor")).length>0?xa.css("background-color",Na):Aa?Ua.append('<span class="activitesColor" data-zcqa="relcvColor_'+detailView.entityId+'" style="background: '+Events.rgbtohex(Na)+'"></span>'):$("#cvlist_"+c).find("a").append('<span class="activitesColor" data-zcqa="relcvColor_'+detailView.entityId+'" style="background: '+Events.rgbtohex(Na)+'"></span>')}else{var Pa,xa;(Pa=Ra.find(".activitesColor"))&&Pa.length>0&&Pa.remove(),(xa=Ua.find(".activitesColor"))&&xa.length>0&&xa.remove()}}if("CLOSINGDATE"==r){var Va=ka||ae;$("#value_CLOSINGDATE").text(Va),$("#headervalue_CLOSINGDATE").text(Va),setTimeout((function(){Lyte.injectResources(networkUtils.returnDependencyFiles(["crm-detail-view-utils.js"],ResourceConstants.CRMClient),void 0,(function(){Lyte.registeredMixins["crm-detail-view-utils"].renderStageComponent()}))}),50)}if(Aa||"Calls"!==l&&"Tasks"!==l||"STATUS"!==r&&"PRIORITY"!==r&&"SUBJECT"!==r){if("Tasks"===l&&"DUEDATE"===r){var $a=getFormattedDate(ae);Aa||$("#cvlist_"+c).find('span[id="lp_Due Date"]').text($a)}}else{$("#cvlist_"+c).find("#lp_"+{STATUS:"Status",PRIORITY:"Priority",SUBJECT:"Subject"}[r]).text(ae).attr("title",ae),"STATUS"===r?detailView.taskStatusMap.Completed==ae?($("#completedTask").show().find("div").show(),$("#closeTaskTr").hide()):($("#completedTask").hide(),$("#completedValue:visible").hide(),$("#closeTaskTr").show()):"SUBJECT"===r&&Ta.html(ae)}if(Aa&&("CALLTYPE"===r||"LOCATION"===r||"PRIORITY"===r||"STATUS"===r||"DUEDATE"===r||"ENDDATETIME"===r||"STARTDATETIME"===r||"SUBJECT"===r)){"DUEDATE"===r?taskDetailsview.updaterecord(c,r,ae,$a):Aa&&"ENDDATETIME"===r||"STARTDATETIME"===r?(taskDetailsview.formatdatetime(stime,etime,c),"ENDDATETIME"!==r&&"STARTDATETIME"!==r&&(La.empty(),$(b).empty(),b.innerHTML=ae),tkveventajax=!0):taskDetailsview.updaterecord(c,r,ae);var ka=ae;document.getElementById("value_"+r)&&(document.getElementById("value_"+r).innerText=ka)}var Fa=ae;24!==parseInt(o)&&202!==parseInt(o)||""===Fa||(Fa=crmCalendar.getDateObjectFromGivenDateString(Fa)+""),"COMPANY"===r&&(crmConstants.reloadSalesNavigator=!0),"1"===o&&(Fa=revertSplChrs(Fa)),detailView.replaceDataParams(r,Fa)}else $(b).html(ae),$(y).html(ae);else{var ht="";let e=$ESAPI.encoder().encodeForHTMLAttribute(k);if(21===parseInt(o)){var Ba="https";ht=0==k.toLowerCase().indexOf("http")?' <a class="crmLinkColor cP accessibility-route-elem" href="'+e+'" target="_blank" rel="noopener noreferrer" id="'+s+'"/>'+ae+"</a>":' <a class="crmLinkColor cP accessibility-route-elem" href="'+Ba+"://"+e+'" target="_blank"  id="'+s+'"/>'+ae+"</a>"}else if(k.trim().length>0){var ja={screen_name:k,mode:"get_twitter_name"};(new crmRequestPool).initiate({action:Crm.getCrmBasePath()+"/socialIntegration.do",data:ja,success:function(e){ht=null!=e&&"null"!=e&&e.trim().length>0?'<a class="link accessibility-route-elem" href="'+RebrandLinkUtil.getProperty("TW_URL")+"/"+e+'" target="_blank" id="'+s+'">'+ae+"</a>":' <span id="'+s+'">'+ae+"</span>",$(b).empty(),b.innerHTML=ht,ht=changeSubValueId(ht,[b,y]),$(y).empty(),y.innerHTML=ht,detailView.replaceDataParams(r,ae)}})}else ht=' <span id="'+s+'">'+ae+"</span>";$(b).empty(),b.innerHTML=ht,ht=changeSubValueId(ht,[b,y]),$(y).empty(),y.innerHTML=ht,detailView.replaceDataParams(r,ae)}var Ha=Crm.lyteHeaderNeeded(l)?$("#dv-button-layer").find("crm-detailview-header")[0].component:void 0;if(Ha&&r&&returnJson.entityMapJson[r]){var Ja=Ha.getData("record");if(4===parseInt(o)||6===parseInt(o)||7===parseInt(o)||9===parseInt(o)||10===parseInt(o)||12===parseInt(o)||13===parseInt(o)||15===parseInt(o)||5===parseInt(o)||133===parseInt(o)){ea=(Zt=ae.split("|||"))[0],ta=Zt[1];Ja.$.set(returnJson.entityMapJson[r].sysRefName,"|||"===ae?void 0:{id:ta,name:ea})}else{if(301!==parseInt(o)&&300!==parseInt(o)||(ae=ae+""!="false"),!pt||36!==parseInt(o)&&143!==parseInt(o)&&145!==parseInt(o)&&144!==parseInt(o))if("Currency"===returnJson.entityMapJson[r].type){Lyte.registeredMixins["crm-detailview-parser"].parseAndSetCurrencyValue(he,pt,Ja,returnJson.entityMapJson[r].sysRefName,returnJson.entityMapJson[r].isaggrfield,k)}else if("TAGMODULEREFID"!==returnJson.entityMapJson[r].colname&&Crm.userDetails.isSubformNewComponentEnabled&&-1===detailView.headerRecordUpdateNotRequiredUIypes.indexOf(parseInt(o))){var Ga={id:Ja.id};Ga[returnJson.entityMapJson[r].sysRefName]=""===k?void 0:k,store.pushPayload(Ja.$.model._name,Ga)}else Crm.userDetails.isSubformNewComponentEnabled||-1!==detailView.headerRecordUpdateNotRequiredUIypes.indexOf(parseInt(o))||Lyte.objectUtils(Ja,"add",returnJson.entityMapJson[r].sysRefName,""===ae?void 0:ae);else Lyte.registeredMixins["crm-detailview-parser"].parseAndSetCurrencyValue(he,pt,Ja,returnJson.entityMapJson[r].sysRefName,returnJson.entityMapJson[r].isaggrfield,k)}}$("[id=topSectionTitle]:eq(1)").html($("[id=topSectionTitle]:eq(0)").html());var za=$("#headervalue_"+r);if(za.length>0&&(za.children().length>0&&(za=za.children().eq(0)),za.addClass("bCardHover")),"Potentials"==l&&"CLOSINGDATE"==r)SalesSummaryInfo.DEALDURATION=ge,SalesSummaryInfo.SALESDURATION=fe,loadSalesSummary();else if("Events"==l&&"VENUE"==r){var qa=$("#value_VENUE"),Wa=trimBoth(qa.html());""!=Wa&&Events.loadMap(Wa,500,200)}if("Calls"===l&&"CTIVOICEURL"===r){var Ya=$L("#bcard_"+detailView.entityId)[0];Lyte.objectUtils(Ya.component.data,"add",{copyrecording:[]}),""!==ae&&Lyte.objectUtils(Ya.component.data,"add",{copyrecording:[{src:ae,type:"audio/mpeg"}],recording:[{src:ae,type:"audio/mpeg"}]}),$("#headertextarea_CTIVOICEURL").hide()}if("true"==re){var Qa=getObj("h2");Qa&&($(Qa).empty(),Qa.innerHTML=ne)}null!=getElemById("value_MODIFIEDBY")&&($("#value_MODIFIEDBY,#headervalue_MODIFIEDBY").html(se),Crm.bindEventForUserBCView()),"Tasks"==l&&"STATUS"==r&&""!=oe&&"null"!=oe&&($('[id="value_CLOSEDTIME"]').text(oe),$('[id="headervalue_CLOSEDTIME"]').length>0&&$('[id="headervalue_CLOSEDTIME"]').text(oe)),Crm.userDetails.isSubformNewComponentEnabled?detailView.haveSpotEdited=!0:crmTab.deleteFromCache(l),refreshFollowDiv(),T.removeClass("errorFieldP"),$("#labelTD_"+r).removeClass("newmandatory").find(".infotoolTip").css("visibility","hidden").removeClass("infoTTStay")}if(("Tasks"==l||"Events"==l)&&-1!=Activities.reminderList.indexOf(c)){var Xa=$("#notificationCount").text();$("#reminder_notification").text(Xa).show(),$(".remainder-notifi").slideUp(),$(".timericon").removeClass("footIconActive timericonAct"),Activities.notifyCountToCrmPlusFrame(Xa),$("#reminderContent").empty(),Activities.reminderCount=0,Activities.reminderList=""}}else te?renderingUtils.showCustomAlert("Invalid response!!!!"):"Potentials"==l&&"PROBABILITY"==r?renderingUtils.showCustomAlert(I18n.getMsg("crm.create.pbty.check")):null==ae||"null"==ae?renderingUtils.showCustomAlert(I18n.getMsg("crm.copy.error.mail.internal.error")):renderingUtils.showCustomAlert("Error:"+ae);var Za=$("#"+i),Ka=Za.find("select");if(Ka.length>0&&Ka.select2("close"),Za.empty(),("Calls"!==l||"Calls"===l&&"CTIVOICEURL"!==r)&&(getObj(a).id.indexOf("header")>-1?show(a,"inline-block"):$("#"+a).css({display:"inline-block"})),"EMAIL"==r?setInfoIconNearEmailFeild(n.bouncedreason,"",n.bouncedtype):"ADDN_EMAIL"==r&&setInfoIconNearEmailFeild("",n.bouncedreason,"",n.bouncedtype),Crm.isUnsubscribeEnabled&&("EMAIL"===r||"ADDN_EMAIL"===r||"EMAILOPTOUT"===r||25==o)){var ei,ti,ai=n.unsubInfo,ii=n.hasOwnProperty("emailOptOutInfo"),ri=new crmRequestPool;ja="recordId="+encodeURIComponent($("#id").val());ja+="&module="+encodeURIComponent(l),"EMAIL"!=r&&"ADDN_EMAIL"!=r||!k||""==k||(ja+="&emailid="+encodeURIComponent(k));try{ti=Crm.getCrmBasePath()}catch(e){ti=""}ti&&""!=ti&&ri.initiate({action:ti+"/unsubscribelink.do?step=getUnsubscribeInfo",type:"GET",data:ja,success:function(e){ei=e.unsubscribedInfo,ii=e.hasOwnProperty("emailOptOutInfo"),ai=$ESAPI.encoder().encodeForHTMLAttribute(e.unsubInfo),setTimeout((function(){updateRecordUnsubscribeInfo(ei,ii,e.emailOptOutInfo,ai)}),100)}})}if("EMAIL"===r||"ADDN_EMAIL"===r)networkUtils.lyteInitiateRequest("/crm/v6/"+encodeURIComponent(moduleApiMapping[l])+"/"+encodeURIComponent($L("#id").val())+"/actions/get_feature_specific_info","GET",{params:{features:"blocked_emails"},headers:P}).then((function(e){if(e&&e.data[0].features_info[0].details){for(var t,a,i,r,l,s,o,n,d=e.data[0].features_info[0].details,c=d.length,u=0;u<c;u++)"Email"===d[u].field.api_name?(t=d[u].blocked_reason,l=d[u].block_sub_category,i="temporary"===d[u].block_category?"1":"2",o=d[u].unblock_count):(a=d[u].blocked_reason,s=d[u].block_sub_category,r="temporary"===d[u].block_category?"1":"2",n=d[u].unblock_count);setInfoIconNearEmailFeild(t,a,i,r,l,s,o,n)}}));if(Z){var li=$("#entityId").val();if("Leads"==l)return void detailView.callLyteRefresh("Leads");"Quotes"!=l&&"SalesOrders"!=l||(document.location.href=networkUtils.getPortalURL(Crm.getCrmBasePath()+"/EntityInfo.do?module="+l+"&id="+li))}if(Macro.autoSuggest(l,!1),fileupload.removedAttachmentIds.length=0,fileupload.uploadedFileObject.length=0,"ACCOUNTID"==r&&"Contacts"==l&&(Crm.userDetails.isRelatedListLyteEnabled?Lyte.registeredMixins["crm-related-list-utils"].reloadPersonality("Contacts",!1):reloadPersonality("reportingcontactspersonality"),$('div[ddname="REPORTINGCONTACTSPERSONALITY"]').find("[id=contactTreePopup]")&&$('div[ddname="REPORTINGCONTACTSPERSONALITY"]').find("[id=contactTreePopup]").addClass("disabledArow")),2===parseInt(o)&&featuresAvailable.PickListTracker)if(Crm.userDetails.isRelatedListLyteEnabled){var si=$L("crm-related-list-view")[0];if(si&&si.component){var oi=si.component.getData("relatedList").filter((function(e){return e.personality_name.toLowerCase().includes("historypersonality")}));oi&&oi[0]&&Lyte.registeredMixins["crm-related-list-utils"].reloadPersonality(idModuleMapping[oi[0].module.id])}}else{var ni;for(Ca="",ha="historypersonality",ba=(ni=crmRelatedList.personalityArr.split("||")).length,Oe=0;Oe<ba;Oe++){if(0==(Ba=ni[Oe].split("_"))[0].indexOf(ha)){ha=Ba[0],Ca=Ba[1];break}}void 0!==Ca&&""!==Ca&&reloadPersonality(ha)}var di=$(".detailViewContainer, .newBusinessCardView");$(".detailViewContainer").removeClass("editModeEnable"),$(".newBusinessCardView").removeClass("editModeEnable");var ci=$L(".businesscall");if(ci.length&&(ci.removeClass("editModeEnable"),ci.find(".editLabelBC").removeClass("editLabelBC focusEleField"),"CTIVOICEURL"===r)){var ui=$L("#bcardRow_Voice_Recording__s");ui.removeClass("editModeVR"),""!==ae&&ui.removeClass("dB").addClass("dIF")}$(".newBusinessCardView").find(".newDateTimeField").removeClass("newDateTimeField"),$(".newBusinessCardView").find(".editLabelBC").removeClass("editLabelBC focusEleField"),$(".newBusinessCardView").find(".lookupFieldCreate").removeClass("lookupFieldCreate"),$(".newBusinessCardView").find("td").removeClass("selectBoxSelect2");var mi=$("#"+a);"TD"===mi.parent()[0].tagName&&(mi=mi.parent()),mi.removeClass("highlightNewLookupField forceHyphen").addClass("highlightNewLookupField"),""!==je&&""!==He&&(je=je.substring(0,je.length-1),He=He.substring(0,He.length-1),$L(".fr_highLightFormulaField").removeClass("fr_highLightFormulaField"),setTimeout((function(){$L(je).addClass("fr_highLightFormulaField"),$L(He).addClass("fr_highLightFormulaField"),je="",He=""}),10)),mi.find(".busniess_card_Hover").removeClass("forceHyphen"),di.find(".forceHyphen").removeClass("forceHyphen"),1==Crm.userDetails.detailView_newUI&&null!=Crm.userDetails.detailView_newUI&&(detailView.setCurrentStageSetOnChange(),detailView.lastupdateChecking()),$("#vr_verifyBut").remove(),commonUtils.setErrVerifyContHeightToParent(!1,!1,!1),mi.find(".vr_err_verify_container").remove(),$("crux-subform").each((function(e,t){t.component.setData("cxPropDisableAjaxEdit",!1)}))}}},error:function(e){var f=e.responseJSON,v=$("#value_"+r);de.show();var C,h,b=$L("#cruxcomponent_Crm_"+l+"_"+r);if(f&&f.data&&f.data[0]&&"INVALID_DATA"===f.data[0].code&&f.data[0].message.includes("Non Subordinate User Found"))return r.includes("MXN")?(h=$L("#ownerNameLookup_Crm_"+l+"_"+r),C=I18n.getMsg("crm.record.creation.multiuserlookup.alert.manage.subordinate.user",f.data[0].message.split("-")[1])):(C=I18n.getMsg("crm.record.creation.userlookup.alert.manage.subordinate.user"),h=b),void commonUtils.showErrorMsg(C,h);if("MAX_RECORDS_LIMIT_REACHED"!==f.code&&"MAX_LIMIT_REACHED"!==f.code)if("AUTHENTICATION_FAILURE"!==f.code&&"Authentication failed"!==f.message)if(f.code&&"INVALID_DATA"===f.code&&"error"===f.status&&"the id given seems to be invalid"===f.message)renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error"));else if("MANDATORY_NOT_FOUND"===f.code||f.data&&"MANDATORY_NOT_FOUND"===f.data[0].code){if(f.data&&f.data[0]&&f.data[0].details&&"id"===f.data[0].details.api_name&&/\b(5|4|6|7|9|10|12|13|15|133|135)\b/.test(j.data("uitype"))){var y=j.data("lookupModule"),I=moduleRecordMapping[y].singular_label,_=$ESAPI.encoder().encodeForHTMLAttribute(I),E=I18n.getMsg("crm.label.lookup.norecord",_)+" ";if(Lyte.Component.registeredHelpers.showAddRecord(y)){var w=$("<a class='cP autoRecordCreateAlert'>");w.attr({id:"lookupFieldAlertDiv","data-zcqa":"createNewRecord",onclick:"crmLookupAutoComplete.openSearchCreatePopUp('"+j[0].id+"','createPageLookup','"+y+"')"}).text(I18n.getMsg("crm.label.create.new")+" "+I),E+=w.get(0).outerHTML}commonUtils.showErrorMsg(E,j)}else commonUtils.showErrorMsg(I18n.getMsg("crm.field.valid.check",[j.data("displaylabel")]),j);itsonview=!0}else{if(f.data&&("WEBINAR_SCHEDULE_INVALID"===f.data[0].code||"TP_SERVICE_UPDATE_FAILED"===f.data[0].code))return crmui.showMsgBand("error",f.data[0].message,3e3),void commonUtils.showHideLoadingDiv();if(f.data&&"MAPPING_MISMATCH"===f.data[0].code&&"Pipeline"===f.data[0].details.mapped_field&&""===returnJson.entityMapJson.PIPELINE.defaultvalue)commonUtils.showErrorMsg(I18n.getMsg("crm.pipeline.empty.detailview.disable"),j);else if(f.data&&"MAPPING_MISMATCH"===f.data[0].code&&"Pipeline"===f.data[0].details.mapped_field&&""===returnJson.entityMapJson.PIPELINE.defaultvalue)commonUtils.showErrorMsg(I18n.getMsg("crm.pipeline.empty.detailview.disable"),j);else{if("NO_PERMISSION"===f.code||f.data&&"NO_PERMISSION"===f.data[0].code||f.data&&"RECORD_IN_BLUEPRINT"===f.data[0].code||f.data&&"CANNOT_PERFORM_ACTION"===f.data[0].code||f.data&&"MAPPING_MISMATCH"===f.data[0].code)return f.data&&f.data[0]&&"You don't have permission to edit the primary invitation field of the portal user. To update this field, please contact the portal admin."===f.data[0].message?(_cruxUtils.showCustomMessage({params:{ltPropMessage:I18n.getMsg("custmr.prtl.perm.den.inv.fld.edit"),ltPropType:"error",ltPropDuration:4e3}}),itsonview=!0,void commonUtils.showHideLoadingDiv()):void renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error"));if(f.data&&f.data[0]&&"RECORD_LOCKED"===f.data[0].code&&"Sorry, you cannot perform this operation as the record is locked."===f.data[0].message)return renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.record.locking.permission.denied")),void(itsonview=!0);if(f.data&&"DELETED_ZOHO_CAMPAIGN_UPDATE"===f.data[0].code)return commonUtils.showHideLoadingDiv(),void crmui.showMsgBand("error",I18n.getMsg("crm.zcampaign.record.deleted.campaigns.dynamic",Crm.integrationsAppName.ZOHO_CAMPAIGNS),4e3);if(f.data&&"UNAUTHORIZED_CAMPAIGN_USER"===f.data[0].code)return commonUtils.showHideLoadingDiv(),void crmui.showMsgBand("error",I18n.getMsg("crm.campaign.non.campaign.user.error.dynamic",Crm.integrationsAppName.ZOHO_CAMPAIGNS),4e3);if(f.data&&"NO_PERMISSION_FOR_EMAILID"===f.data[0].code)return commonUtils.showHideLoadingDiv(),void crmui.showMsgBand("error",I18n.getMsg("crm.zcampaign.emailid.permission.denied"),4e3);if(f.data&&"NOT_ALLOWED"===f.data[0].code){if("Zoho Campaign can't be updated after the campaign is sent"!==f.data[0].message)return"A portal user with same email address already exists."===f.data[0].message?void crmui.showMsgBand("error",I18n.getMsg("custmr.prtl.email.already.used"),4e3):"portal users cannot edit invited field value"===f.data[0].message?void renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("custmr.prtl.inv.fld.ed.no.perm")):"A portal user with the same phone number already exists."===f.data[0].message?(_cruxUtils.removeCustomMessage(),void _cruxUtils.showCustomMessage({params:{ltPropMessage:I18n.getMsg("custmr.prtl.phone.already.used"),ltPropType:"error",ltPropDuration:4e3}})):void renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.alert.can.not.edit.email"));crmui.showMsgBand("error",I18n.getMsg("crm.zcampaign.edit.campaign.disallowed.dynamic",Crm.integrationsAppName.ZOHO_CAMPAIGNS),4e3)}if("NOT_ALLOWED"===f.code&&"portal users cannot edit invited field value"===f.message)return renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("custmr.prtl.inv.fld.ed.no.perm")),void de.hide();if(!f.data||"INVALID_DATA"!==f.data[0].code||"Email field cannot be empty for portal user"!==f.data[0].message&&"phone field cannot be empty for portal user"!==f.data[0].message)if(v&&v.hasClass("iu_imageDetailWrap")){var T=Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents("label_"+d,"create");if(void 0!==f.data){var L="";return L="storage space exceeds"===f.data[0].message?I18n.getMsg("crm.fileuploader.entityattachments.message.507"):"LIMIT_EXCEEDED"===f.data[0].code?1===f.data[0].details.limit?I18n.getMsg("crm.attachment.imageUploadField.Minlen.check"):I18n.getMsg("crm.imageupload.allowed.field.length",f.data[0].details.limit):I18n.getMsg("crm.imageupload.failure"),void T.setData("cxPropErrorMessage",L)}renderingUtils.displayPermissionDenied(null,null,f.message)}else if("Internal Server Error"===f.message||f.data&&f.data[0].code&&"INVALID_DATA"===f.data[0].code){var O=f.message?f.message:f.data[0].message,M=f.details?f.details:f.data[0].details;if(250===parseInt(o)&&M&&M.maximum_length)return void _cruxUtils.showCustomMessage({params:{ltPropMessage:I18n.getMsg("crm.richtext.warning.msg",Lyte.Component.registeredHelpers.formatNumber(M.maximum_length.toString())),ltPropType:"warning"}});if((555===parseInt(o)||556===parseInt(o))&&"Insufficient privileges"===O)return crmui.showMsgBand("error",I18n.getMsg("crm.FileuploadField.CloudLogin.check"),3e3),void commonUtils.showHideLoadingDiv();if(221===parseInt(o)&&"invalid data"===O)return commonUtils.showErrorMsg(I18n.getMsg("crm.userlookup.detailview.error"),b),void commonUtils.showHideLoadingDiv();if((555===parseInt(o)||556===parseInt(o))&&f.details.maximum_length)return crmui.showMsgBand("error",I18n.getMsg("crm.attachment.fileUploadField.Maxlen.check.field",[f.details.maximum_length,r]),3e3),void commonUtils.showHideLoadingDiv();if(f.data&&f.data[0]&&f.data[0].message){if("You cannot assign this email address to this portal user type, since the domain matches the super admin's domain."===f.data[0].message)return crmui.showMsgBand("error",I18n.getMsg("custmr.prtl.email.domain.check.failed"),4e3),itsonview=!0,void commonUtils.showHideLoadingDiv();if("You cannot send the portal invitation since the email address has the following characters"===f.data[0].message)return crmui.showMsgBand("error",I18n.getMsg("portal_invite_email_is_not_supported")+" "+f.data[0].details.inValidChars,4e3),itsonview=!0,void commonUtils.showHideLoadingDiv();if("Invalid phone number kindly check country code or extension should not be present"===f.data[0].message)return _cruxUtils.showCustomMessage({params:{ltPropMessage:I18n.getMsg("custmr.prtl.inv.rstrct.phone.invld"),ltPropType:"error",ltPropDuration:4e3}}),itsonview=!0,void commonUtils.showHideLoadingDiv()}renderingUtils.displayPermissionDenied(null,null,O)}else{if("duplicate data"===f.data[0].message){var D={},A=(M=f.data[0].details,returnJson.entityMapJson),S="",R=f.data[0].details.api_name;for(var U in A)if(A[U].sysRefName===R){S="true"===A[U].customfield?A[U].displaylabel:A[U].label;break}var N=M.duplicate_record;D.FIELDLABEL=S,D.OWNERNAME=N.Owner.name,D.MODULE=idModuleMapping[N.module.id],D.RECORDS={},D.COUNT=M.more_records?2:1,D.ZUID=N.Owner.zuid,delete N.Owner;var P={};P.ENTITYID=N.id,delete N.id;var x=[];if(Object.keys(N).length>1){var V=Crm.userDetails.NAME_FORMAT;V=V.split(",");var k=[];V.forEach((function(e){"Salutation"!==e&&(e=e.replace(" ","_")),N[e]&&k.push(N[e])})),0===k.length&&k.push(N[Crm.userDetails.MODULE_LIST[l].display_field.api_name]),P.ENTITYNAME=k.join(" "),P.ENTITYNAMEFORPOPOVER=k.join(" ")}else for(var F in N)P.ENTITYNAME=N[F],P.ENTITYNAMEFORPOPOVER=N[F];x.push(P),D.RECORDS=x,commonUtils.hideDuplicateErrorMsg("viewentityform"),itsonview=!0;var B=commonUtils.getDuplicateErrorMsg(D,!1);return commonUtils.showErrorMsg(B,$("#Crm_"+l+"_"+r),l),void commonUtils.showHideLoadingDiv()}if("DUPLICATE_LINKING_DATA"===f.data[0].code){var H=(z=f.data[0].details.duplicate_record).id,J=z.Name,G=(Crm.getCrmBasePath(),I18n.getMsg("crm.linking.module.duplicate.warning",[l,H,J,Crm.getCrmBasePath()]));renderingUtils.showCustomAlert(G,"",!0),commonUtils.hideDuplicateErrorMsg("viewentityform"),itsonview=!0}else if("SELF_REFERENCE_LINKING_DATA_INPUT"===f.data[0].code){var z;H=(z=f.data[0].details.duplicate_record).id,J=z.Name,G=I18n.getMsg("crm.linking.module.sameassociation.warning");renderingUtils.showCustomAlert(G,"",!0),commonUtils.hideDuplicateErrorMsg("viewentityform"),itsonview=!0}else if("FILTER_CRITERIA_NOT_SATISFIED"===f.data[0].code){y=j.data("lookupModule");let e=221===j.data("uitype")?I18n.getMsg("crm.user.text"):moduleRecordMapping[y].singular_label;commonUtils.showErrorMsg(I18n.getMsg("crm.lookupfilter.entity.errormsg",e),j,l),commonUtils.showHideLoadingDiv(),itsonview=!0}else"SCHEDULER_RUNNING"===f.data[0].code&&(renderingUtils.showCustomAlert(f.data[0].message,"",!0),commonUtils.hideDuplicateErrorMsg("viewentityform"),itsonview=!0);if("BLOCKED_RECORD"===f.data[0].code){var q=Handlebars.templates.blockListWarning();return $(q).appendTo("body"),crmui.showPopup("blockListWarning"),void $("#blockListWarning .redbtn").on("click",(function(){crmui.hidePopup("blockListWarning"),$(q).remove();Callonclickofbutton("/crm/v2/",t,a,i,r,l,s,o,n,d,c,u,m,p,g,!0)}))}e&&"error"===e.status&&renderingUtils.displayPermissionDenied(http)}else{_cruxUtils.removeCustomMessage();let e=store.peekRecord("field",p);_cruxUtils.showCustomMessage({params:{ltPropMessage:I18n.getMsg("custmr.prtl.inv.field.emt",e.display_label),ltPropType:"error",ltPropDuration:4e3}})}}}else renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error"));else Crm.showStorageExceedPopup()},complete:function(){commonUtils.showHideLoadingDiv();var e=$("#"+r),t=document.getElementById("iskanbanview");if(!e||t&&"true"===t.value||e.attr("class","label"),("Contacts"==l||"Leads"==l)&&"EMAIL"==r){var a="false",i=$("#supportStatus");null!=i&&(a=i.val()),"Enabled"==a&&getSupportLists(k,"1")}$(".newDetailPageStyle").find(".focusEleField").removeClass("focusEleField"),$L("#rpBtnResubmit").removeClass("disable"),CVRExec.removeVerifyBtn(),commonUtils.setErrVerifyContHeightToParent(!1,!1,!0)}}),void 0!==A&&Lyte.registeredMixins["crm-vision-create"].ajaxEditSubmitSRFeedBack(p,l,c)):Lyte.registeredMixins.approvalprocess.saveRecordWithApprovalResponse(businessCardJson.hidden.APPROVALBUTTONS,C,"dv")}))}crmLookupBusinessCard.result=null}function displayUniqueFieldDuplicateError(e,t,a){commonUtils.hideDuplicateErrorMsg("viewentityform");var i=e.INFO[0],r=i.MODULE,l=t.replace(/ /g,"\\ "),s=commonUtils.getDuplicateErrorMsg(i,!1);commonUtils.showErrorMsg(s,$("#Crm_"+a+"_"+l),r),commonUtils.showHideLoadingDiv(),itsonview=!0}function show(e,t){t=t||"block",$("#"+e).css("display",t)}function showHide(e,t){show(e),hide(t)}function hide(e,t){$("#"+e).hide(),"popupnew"==e&&$("body").removeClass("leftPanelHovered oH");var a=document.getElementById("FreezeLayer");a&&"freezeMessageDiv"===e&&document.body.removeChild(a),"summaryfield"==e&&$(".bCardHover,.bCardHoverLeft").removeClass("bCardHoverLeft"),$(".fieldHover").removeClass("fieldHover")}function handleMouseOver(e,t,a,i,r,l,s,o,n,d,c){if(detailView.recordLocked)"250"===e&&markRTFAsNotEditable(s,t);else if(!(businessCardJson&&businessCardJson.isEditRestricted&&businessCardJson.recordLockingDetails)||businessCardJson.recordLockingDetails.fieldIds.length&&businessCardJson.recordLockingDetails.fieldIds.contains(n)){if(detailView.readOnlyField=!1,"LAYOUTID"==t&&returnJson&&returnJson.layout_jsonarrayObj.showLayoutOption)return detailView.cscriptFieldAttribs&&detailView.cscriptFieldAttribs.Layout&&!0===detailView.cscriptFieldAttribs.Layout.readOnly&&d[0]&&d[0].classList&&d[0].classList.add("dvLayoutReadOnly"),void(a=!1);t=unescape(t);var u=$("#module").val();if(o||"true"===String(a)||-1!==["DAYSVISITED","NUMBEROFCHATS","FIRSTVISITEDTIME","REFERRER","AVERAGETIMESPENT","LASTVISITEDTIME","FIRSTVISITEDURL","REMINDAT","PROBABILITY","COMMENTCOUNT","PRICINGMODEL","RECURRING","REMINDINVITEESAT"].indexOf(t)||"false"===String(allowEditProf)||"Who Id"===t||"What Id"===t||"Potentials"===u&&"EXPECTEDREVENUE"===t||"Calls"===u&&("CALLSTARTDATETIME"===t||"CALLDURATION"===t||"CALLDURATIONINSEC"===t||"CALLTYPE"===t)){if(detailView.readOnlyField=!0,"250"===e&&markRTFAsNotEditable(s,t),"556"===e){Y="vlabel_"+t;Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents(Y,"view").setData("cxPropReadonly",!0)}}else if(Crm.isUnsubscribeEnabled||"EMAILOPTOUT"!==t||!$("#mouseArea__EMAILOPTOUT").find("#emailOptOutInfo").hasClass("unsubInfo")){if(!detailView.changedBCJson.hidden.SECURITY_EDIT_ALLOWED||2===detailView.changedBCJson.hidden.EditFieldsType&&!detailView.changedBCJson.hidden.ApprovalProcessEditFields.contains(n)){if("250"===e&&markRTFAsNotEditable(s,t),"556"===e){Y="vlabel_"+t;Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents(Y,"view").setData("cxPropReadonly",!0)}return detailView.readOnlyField=!0,void(s?$("#headervalue_"+t).addClass("lockIconBC"):d&&d.addClass("readOnlyFld"))}if("2"===businessCardJson.isApproved&&detailView.changedBCJson.hidden.SECURITY_EDIT_ALLOWED&&1===detailView.changedBCJson.hidden.EditFieldsType&&"556"===e){Y="vlabel_"+t;Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents(Y,"view").setData("cxPropReadonly",!0)}else{var m="Calls"!==u||("CONTACTID"===t||"SEID"===t);if(detailView.changedBCJson.hidden.RECORD_FIELDS_EDIT_ALLOWED||m){if("Contacts"===u&&"REPORTINGTOCONTACTID"===t){var p=$("#subvalue_ACCOUNTID");if(!p[0]||!p[0].dataset.params||""===JSON.parse(p[0].dataset.params).id){if(detailView.readOnlyField=!0,"250"===e&&markRTFAsNotEditable(s,t),"556"===e){Y="vlabel_"+t;Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents(Y,"view").setData("cxPropReadonly",!0)}return}detailView.readOnlyField=!1}if("Appointments"===u){if("REMINDER"===t||"APPOINTMENTDATEANDTIME"===t||"SERVICEID"===t||"SEID"===t||"SMOWNERID"===t||"APPOINTMENTFOR"===t||"APPOINTMENTSTATUS"===t||"APPOINTMENTLOCATION"===t||"APPOINTMENTADDRESS"===t||"APPOINTMENTNAME"===t||"RESCHEDULEDFROM"===t){if("APPOINTMENTDATEANDTIME"===t&&!s){var g=$("#iconReminder1");g.css({position:"absolute",top:$("#subvalue_"+t).position().top+4,left:$("#value_"+t).width()+10}),g.show(),g.children().first().css({left:-33}),$("#mouseArea__"+t).attr("onMouseOut","$('#iconReminder1').hide();")}if("556"===e){Y="vlabel_"+t;Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents(Y,"view").setData("cxPropReadonly",!0)}return void(detailView.readOnlyField=!0)}var f="#mouseArea__"+t;if($("#jobSheetInfoSection").find(f).length>0)return void(detailView.readOnlyField=!0)}if(itsonview)return $L(".iu_imageDetailWrap").not(".imageEditState").closest(".imageUploadDetailPage").addClass("eventNone"),void(detailView.readOnlyField=!0);var v="";s?(v="header_"+t,globalvaluespanid="headervalue_"+t,globaltextareapanid="headertextarea_"+t):(v="mouseArea__"+t,globalvaluespanid="value_"+t,globaltextareapanid="textarea_"+t);u=detailView.currentModule;globaltextboxpanid="Crm_"+u+"_"+t,globalfieldlabel=t;var C=!1;"Calls"===u&&"CTIVOICEURL"===t&&$L("#"+globalvaluespanid).parents("lyte-td").hasClass("vRecordingComp")&&(C=!0),objectUtils.getKeys(Crm.jsonDepValues[u]).contains(globalfieldlabel)||209==e||C||show("crmspanid"),globalsubvaluespanid="subvalue_"+t,globaluitype=parseInt(e),comboCount=r;var h=getObj("crmspanid"),b=null,y=null,I=0,_=$("#"+globalvaluespanid),E=_.parents("td");"Calls"===u&&isNewCallView&&s&&(E=_.parents("lyte-td"));_.offset(),_.width();var w=$(getObj(v)),T=w.find(".labelVal"),L=w.hasClass("bcEditIcon"),O=T.offset(),M=O.top+9,D=O.left+T.outerWidth()-20,A=E.offset(),S=$("#DetailViewInnerTabs"),R=$("#dv-button-layer"),U=document.getElementById("iskanbanview"),N=9,P=document.getElementById("show").offsetLeft;if(1==Crm.userDetails.detailView_newUI&&null!=Crm.userDetails.detailView_newUI){if(N=5,S.length&&null!=S){var x=R.outerHeight();$("#DetailViewInnerTabs").outerHeight();N="undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()?x:x+renderingUtils.tabLayerOuterHeight()}var V=$("#subscriptionExpiryMsgband");if(V.length)N+=V.outerHeight()}if(L||"Calls"===u&&isNewCallView&&s){M=A.top-N;"Calls"===u&&(M+=11);D=A.left+E.outerWidth()-20}if(s?(b=A.top-2,"Calls"===u&&isNewCallView?b=w.offset().top-N:!0===Crm.userDetails.detailView_newUI&&void 0!==Crm.userDetails.detailView_newUI&&(b=A.top-N),y=A.left):(b=$(getObj(v)).offset().top,1==Crm.userDetails.detailView_newUI&&null!=Crm.userDetails.detailView_newUI&&(b=$(getObj(v)).offset().top-N),y=$(getObj(v)).find(".labelVal").offset().left),h.setAttribute("onclick","ajaxEdit();sE(event);"),U&&"true"===U.value)if(1==Crm.userDetails.detailView_newUI&&null!=Crm.userDetails.detailView_newUI){$(h).offset({top:M,left:D});var k=w.parents(".busniesscard_width");$("#kventitydetailspage").length&&k.length&&$(h).offset({top:M+11,left:D})}else L&&(I=20),$(h).offset({top:M+I,left:D});else{if(s)if(Crm.userDetails.RTL_ENABLED)h.style.left=renderingUtils.findPosX(getObj("header_"+t))+10-P+"px";else{var F="td";"Calls"===u&&isNewCallView&&s&&(F="lyte-td"),h.style.left=y+$(getObj(globalvaluespanid)).parents(F).outerWidth()-23-P+"px"}else Crm.userDetails.RTL_ENABLED?h.style.left=y+10-P+"px":h.style.left=y+$(getObj(v)).find(".labelVal").outerWidth()-22-0-P+"px";$(getObj(v)).hasClass("tabDiv"),h.style.top=b+11+"px",$(getObj(v)).hasClass("uiType3")&&(h.style.top=b-11+"px")}try{if(Crm.userDetails.IS_SMART_PROMPT_AVAILABLE){var B=null,j="1";if(d&&d[0]?(j="1",c=c||d,B=0!==$L(c).find(".smartPromptField_"+t).length):(j="2",B=document.querySelector("#smartPromptFieldOutlet__"+t)),Lyte.registeredMixins.smart_prompt_handler.fieldCheck(u,t)){if("1"===j&&B)return;if("2"===j&&0!==B.children.length)return;var H={"icon-type":"box",class:"smartPromptField_"+t,"focused-area":"field",module:u,"field-col-name":t},J="";Object.keys(H).forEach((function(e){J+=e+'="'+H[e]+'" '}));var G="<crm-zia-smart-prompt-icon "+J.trim()+"></crm-zia-smart-prompt-icon>";if(d.find&&1===$L(c).find(".busniess_card_Hover").length){var z=document.createElement("div");return z.innerHTML=G,void c.appendChild(z)}if("Calls"===u&&"2"===j)Lyte.Component.render("crm-zia-smart-prompt-icon",H,"#smartPromptFieldOutlet__"+t);else{var q=d.find(".labelVal");0!==q.length&&q.append(G)}}else if("2"===j)B&&B.empty();else{var W=d.find(".smartPromptField_"+t);W&&W.empty()}}}catch(e){murphy.error(e)}}else{if("556"===e){var Y="vlabel_"+t;Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents(Y,"view").setData("cxPropReadonly",!0)}detailView.readOnlyField=!0}}}else if(detailView.readOnlyField=!0,"250"===e&&markRTFAsNotEditable(s,t),"556"===e){var Y="vlabel_"+t;Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents(Y,"view").setData("cxPropReadonly",!0)}}else if(detailView.readOnlyField=!0,"250"===e&&markRTFAsNotEditable(s,t),"556"===e){var Y="vlabel_"+t;Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents(Y,"view").setData("cxPropReadonly",!0)}}function markRTFAsNotEditable(e,t){e?$("#header_"+t).find("crm-richtext-component")[0].component.setData("cxPropIsEditable",!1):$("#mouseArea__"+t).find("crm-richtext-component")[0].component.setData("cxPropIsEditable",!1)}function Callonclickofbutton2(e,t,a,i,r,l,s,o,n,d){var c="";if(!d||!d.skipAlert){if("Forecasts"==t)c=window.confirm(I18n.getMsg("confirmforecast"));else{if("Contacts"==t&&customViewObject.isZBCustomModuleEnabled)return void ZInvoice.getAlertContentForContacts(e,t,a,i,r,l,s,o,n,d);"Accounts"!=t?c=window.confirm(I18n.getMsg("confirmmsg")):(c=!0,$("#Warningdiv").hide())}if(0==c)return}commonUtils.showHideLoadingDiv(!0);var u=void 0;crmListView.getObject().doMassActioninScheduler?u=crmListView.getObject().totalCount:null==(u=crmListView.getObject().selectedIds.length)&&(u=1);var m=!1;!d||1!=d.isWfTriggerCheckReq&&"true"!=d.isWfTriggerCheckReq||(m=!0),crmListView.getObject().doMassActioninScheduler&&u<=Crm.massOperationWorkflowLimit&&0==m&&Crm.trackSpotLightAction("Mass Scheduler - Delete Confirmed",{Module:t});var p=crmListView.getObject().includeChild?1:0,g={isload:!0,cvid:r,module:t,ajax:!0,display_cust_view_name:i,FROM_INDEX:crmListView.getObject().fromIndex,TO_INDEX:crmListView.getObject().toIndex,deleteEntityID:a,rangeValue:crmListView.getObject().currentOption,advSearchEnableVal:crmListView.getObject().advSearchEnable,isMassJobScheduled:crmListView.getObject().doMassActioninScheduler,isWfTriggerCheck:m,territoryId:crmListView.getObject().territoryId,includechild:p};if("Visits"===t){var f=crmListView.getObject().portalName;"All Portals"==f?g.allPortals=!0:(g.portalName=f,g.allPortals=!1)}"Potentials"!==t&&"Deals"!==t||crmListView.getObject().pipeline&&"0"!==crmListView.getObject().pipeline&&(g.pipeline=crmListView.getObject().pipeline),"All"!=crmListView.getObject().searchletter&&(g.searchletter=crmListView.getObject().searchletter);var v=null;if(crmListView.getObject().criteriaSearch&&1==crmListView.getObject().criteriaSearch){var C=crmListView.getObject();g.rowCount=Search.rowcnt;for(var h=[],b=1;b<=Search.rowcnt;b++){var y={text:C["searchfield"+b],type:C["searchfieldtype"+b],match:C["match"+b]};g["searchfield"+b]=C["searchfield"+b],1!=b&&(g["match"+b]=C["match"+b]),g["searchfieldtype"+b]=C["searchfieldtype"+b],"U"==(n=C["searchfieldtype"+b])?(y.value=g["searchuser"+b]=C["searchuser"+b],y.ptn=g["usercondition"+b]=C["usercondition"+b],Search.formUserConditionValues(y,b,"temp_value",y.value),y.temp_value=g["temp_searchuser"+b]=y.temp_value):"T"==n?(y.ptn=g["textcondition"+b]=C["textcondition"+b],y.value=g["searchtext"+b]=C["searchtext"+b]):"picklist"==n?(y.value=g["searchpicklist"+b]=C["searchpicklist"+b],y.ptn=g["textpicklistcondition"+b]=C["textpicklistcondition"+b]):"N"==n?(y.value=g["searchnum"+b]=C["searchnum"+b],y.ptn=g["numcondition"+b]=C["numcondition"+b]):"B"==n?(y.value=g["searchboolean"+b]=C["searchboolean"+b],y.ptn=g["booleancondition"+b]=C["booleancondition"+b]):"CML"==n?(y.value=dataOb["searchcampcv"+b]=C["searchcampcv"+b],y.ptn=g["campcvcondition"+b]=C["campcvcondition"+b],y.temp_value=g["temp_searchcampcv"+b]=C["temp_searchcampcv"+b]):"D"==n?(y.ptn=g["datecondition"+b]=C["datecondition"+b],C["datecondition"+b]==Search.ageCrt||C["datecondition"+b]==Search.dueCrt?(y.ageindayscondition=g["ageindayscondition"+b]=C["ageindayscondition"+b],y.ageindays=g["ageindays"+b]=C["ageindays"+b]):(y.value=g["searchdate"+b]=C["searchdate"+b],y.edate=g["searchedate"+b]=C["searchedate"+b])):"DT"==n?(y.ptn=g["datetimecondition"+b]=C["datetimecondition"+b],C["datetimecondition"+b]==Search.ageCrt||C["datetimecondition"+b]==Search.dueCrt?(y.ageindayscondition=g["ageindayscondition"+b]=C["ageindayscondition"+b],y.ageindays=g["ageindays"+b]=C["ageindays"+b]):(y.value=g["searchdatedate"+b]=C["searchdatedate"+b],y.sthour=g["searchsthour"+b]=C["searchsthour"+b],y.stminute=g["searchstminute"+b]=C["searchstminute"+b],y.stampm=g["searchstampm"+b]=C["searchstampm"+b],y.enddate=g["searchenddate"+b]=C["searchenddate"+b],y.endhour=g["searchethour"+b]=C["searchethour"+b],y.endminute=g["searchetminute"+b]=C["searchetminute"+b],y.stime=g["searchstime"+b]=C["searchstime"+b],y.etime=g["searchetime"+b]=C["searchetime"+b],y.endampm=g["searchetampm"+b]=C["searchetampm"+b])):"territory"==n&&(y.ptn=g["territorycondition"+b]=C["territorycondition"+b],y.value=g["searchterritory"+b]=C["searchterritory"+b]),h.push(y)}g.patternVal=C.patternVal,h.push(g.patternVal),g.criteriaSearch=!0,v=JSON.stringify(h)}g[csrfParamName]=csrfToken;var I=objectUtils.getKeys(crmListView.startIndex).sort()[0];g.FROM_INDEX=I,g.TO_INDEX=parseInt(I)+parseInt(g.rangeValue)-1,crmListView.getFilterParams(g),g.fetchOnlyBody="true",("list"===Lyte.Router.getRouteInstance().routeName||crmListView.getObject().isPrivacyListView||"canvas"===Lyte.Router.getRouteInstance().routeName)&&(g.from="listview"),doMassDelete(t,e,g,a.split(";"),v)}function doMassDelete(e,t,a,i,r){var l=void 0;l=isWFSchedulerUser()?i.splice(0,i.length):i.splice(0,crmConstants.maxRecOperCnt),a.deleteEntityID=l.join(";");var s=new crmRequestPool;customViewObject.filters&&(a.isNewFilter=!0,a.filters=JSON.stringify(customViewObject.filters)),customViewObject.cross_filters&&(a.isNewFilter=!0,a.cross_filters=JSON.stringify(customViewObject.cross_filters)),hideAnimatePopup("deletepopup"),s.initiate({action:t,data:a,type:"POST",dataType:"json",success:function(l){var s=l.orchestration_used;if(s)Crm.showOrchUsedBUlkDenyPopUp(s);else if(l.CannotDelete){var o='<div onclick="sE()" class="w500 p20"><div class="fL pL20 w430"><div class="crm-heading-font-size"><h2 style="color:#E20000";>'+I18n.getMsg(l.CannotDelete[0])+'</h2></div><div class="mT10">'+I18n.getMsg(l.CannotDelete[1])+'</div></div><br class="cBoth"><div  class="alignRight mT20"><input type="button" id="popupok" class="primarybtn" value="'+I18n.getMsg("crm.button.ok")+"\" onclick=\"hide('popupnew');renderingUtils.removeFreezeLayer();document.getElementById('popupnew').style.zIndex=30\"></div></div>";renderingUtils.popUpWithFreeze(o)}else{var n=Lyte.Router.getRouteInstance();if(1===i.length&&""===i[0]||i.length<=0){if("listview"!=a.from&&l.body&&0!=l.body.length){for(var d=[],c=l.fromIndex-1,u=0;c<=l.toIndex;c++,u++)l.body[u]?d[c]=l.body[u]:d[c]=null;l.body=d}var m=crmListView.getObject();if(void 0!==l.isWfTriggered&&1==l.isWfTriggered&&void 0!==l.approvalProcessTriggered&&1==l.approvalProcessTriggered)return void showMassDeleteRelatedRulesAlert(I18n.getMsg("crm.mass.actions.rules.alert.content",[I18n.getMsg("crm.mass.actions.workflow.rules")+" & "+I18n.getMsg("crm.mass.actions.approval.process")]));if(void 0!==l.isWfTriggered&&1==l.isWfTriggered)return void showMassDeleteRelatedRulesAlert(I18n.getMsg("crm.mass.actions.rules.alert.content",[I18n.getMsg("crm.mass.actions.workflow.rules")]));if(void 0!==l.approvalProcessTriggered&&1==l.approvalProcessTriggered)return void showMassDeleteRelatedRulesAlert(I18n.getMsg("crm.mass.actions.rules.alert.content",[I18n.getMsg("crm.mass.actions.approval.process")]));if(1==l.exceededRecordLimit);else if(void 0!==l.isWfTriggered&&0==l.isWfTriggered)commonUtils.showHideLoadingDiv(),renderingUtils.removeFreezeLayer();else if(1==l.isScheduledMassOperation||"true"==l.isScheduledMassOperation){if(commonUtils.showHideLoadingDiv(),renderingUtils.removeFreezeLayer(),renderingUtils.hideFreezeLayer(),hideAnimatePopup("massActionWorkFlowPopUp"),"listview"!=a.from?(crmListView.checkAll(),showHideListViewBtnFn(),crmListView.selectAllEntity("",$(".selCountIcon dIB"))):Lyte.registeredMixins["crm-view-utils"].clearSelection(),0==l.isValidInterval)return;if(1!=l.success){if(1==l.jobRunningForCvid)return void crmui.showMsgBand("info",I18n.getMsg("crm.mass.actions.cv.running"),4e3,"");var p=I18n.getMsg("crm.mass.actions.delete"),g=I18n.getMsg("crm.mass.actions.scheduled.fail",[p]);return void crmui.showMsgBand("error",g,18e4,"")}var f=I18n.getMsg("crm.mass.actions.mass.delete.job");f=l.isQueued?f+" "+I18n.getMsg("crm.mass.actions.scheduled.submit"):f+" "+I18n.getMsg("crm.mass.actions.scheduled.success"),crmui.showMsgBand("success",f,4e3,"");var v=$("#selectAllRecords");if(crmListView.setHideActionInModule(),v.length>0)return v.hide(),customViewObject.showSelectAll=!1,void customViewObject.moreActions.push("hideSelectAllRecords")}else if("false"==l.error&&"listview"!=a.from){if(1!=l.isStageView&&1!=l.isPredictView&&(m.body=l.body),m.fromIndex=l.fromIndex,m.toIndex=l.toIndex,m.selectedIds=[],l.body&&0!=l.body.length)$("#listviewHeaderRow").parent().html(Handlebars.templates.heading(m)),$(".fixedrowTd").html(Handlebars.templates.fixedColumnlistview(m)),$("#lvTred").html(Handlebars.templates.body(m)),m.isCustomizedView?new listViewHandler(m).renderListView():(renderingUtils.tableSorter("listViewTable","2",""),$("#listviewtablescroll").removeClass("oH"));else if(l.isStageView||l.isPredictView){crmTab.deleteFromCache(e),Lyte.Router.getRouteInstance().refresh({refreshTemplate:!0}).data={clearCache:!0,refreshTemplate:!0}}else 0===$("#lvNoRecordsFound").length&&($("#lvTred").html(""),$("#listviewHeaderRow").parent().html(Handlebars.templates.heading(m)),$(".fixedrowTd").html(Handlebars.templates.fixedColumnlistview(m)),$(Handlebars.templates.noRecordsFound(m)).insertAfter("#lvTred"),renderingUtils.tableSorter("listViewTable","0","")),$("#tcDiv").hide(),$("#checkAll").hide();1!=l.isStageView&&1!=l.isPredictView&&crmListView.getNavigationDiv(m),crmListView.checkAll(),showHideListViewBtnFn(),crmNavig.parseCurrentListView();var C='&nbsp;&nbsp;<nobr><a id="totalRecordsCount" href="javascript:;" onclick="showTotalCount(this,\''+I18n.getMsg("crm.label.totalcount")+'\')" class="link date">'+I18n.getMsg("crm.label.totalcount")+': <span id="totalCountNo">###</span></a></nobr>&nbsp;&nbsp;';$("#tcDiv").html(C),l.fetchCountValues&&showTotalCount($("#tcDiv #totalRecordsCount"),void 0,"false"),delete m.totalCount}else"listview"!=a.from&&$("#show").empty().html(l.responseText);customViewObject.isPrivacyListView||crmTab.putInCache(e,m),commonUtils.showHideLoadingDiv(!1),renderingUtils.removeFreezeLayer(),overLayForSelectAllClick(!1)}else doMassDelete(e,t,a,i,r);if("listview"==a.from){var h;const e=l.responseText.split("$");switch(e[0]){case"Records deleted successfully":_cruxUtils.showCustomMessage({params:{ltPropMessage:I18n.getMsg("crm.masstool.delete.success"),ltPropType:"success"}});break;case"Selected Record's are can't be deleted":_cruxUtils.showCustomMessage({params:{ltPropMessage:I18n.getMsg("crm.massdelete.record.lock.failure"),ltPropType:"error"}});break;case"Some Record's are can't be deleted":const t=[e[1],e[2]];_cruxUtils.showCustomMessage({params:{ltPropMessage:I18n.getMsg("crm.massdelete.bulk.lock.failure",t),ltPropType:"error"}})}if((1==l.isScheduledMassOperation||"true"==l.isScheduledMassOperation&&1==l.success)&&(h=!0),customViewObject.isPrivacyListView&&(Events.isPageLayoutModified=!0,CrmPrivacyDashboard.reloadCurrentListView()),(customViewObject.totalCount%customViewObject.currentOption==customViewObject.selectedIds.length||customViewObject.selectedIds.length==customViewObject.currentOption)&&customViewObject.totalCount>customViewObject.currentOption){var b=customViewObject.totalCount-customViewObject.selectedIds.length;crmTab.deleteFromCache(customViewObject.module),Lyte.registeredMixins["crm-view-utils"].hideCVbtns();var y=Math.round(b/customViewObject.currentOption);0==Math.round(b%customViewObject.currentOption)&&n.getQueryParams().page==y+1?n.setQueryParams("page",y):crmListView.reloadCurrentListView(void 0,n.routeName,h)}else crmListView.reloadCurrentListView(void 0,n.routeName,h)}}}})}function convertColumnName(e,t){return"SMCREATORID_FIRSTNAME"==e?e="Created By":"MODIFIEDBY_FIRSTNAME"==e?e="Modified By":"SMOWNERID_FIRSTNAME"==e&&"Activities"!=t?e=t.substring(0,t.length-1)+" Owner":"SMOWNERID_FIRSTNAME"==e&&"Activities"==t?e="Activity Owner":"Last Name"==e&&(e="Full Name"),e}function showSortDiv(e,t,a,i){var r,l=$(e),s=l.offset(),o=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,n=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft,d=getObj("sort_div"),c="BEST_TIME"===e.id;d.style.top=s.top+l.outerHeight()+"px",d.style.position="fixed";var u=moduleRecordMapping[a].cvid;if(n>0&&0===o&&(d.style.left=s.left+"px"),o<50)d.style.left=s.left-n+"px";else{var m=$("#cvpadding");0==$("#copyListviewHeaderDiv").is(":visible")&&1==m.hasClass("pFixed")?d.style.top=l.position().top+l.outerHeight()+82-(m.outerHeight()+15)-o+"px":$("#sort_div").addClass("fixedTopColumnList"),d.style.position="fixed",d.style.left=s.left-n+"px",d.style.zIndex=2502}var p=getObj("sorted_column"),g=void 0!==crmListView&&void 0!==crmListView.getObject().nearmeSortOrder?crmListView.getObject().nearmeSortOrder.trim():"",f="<div><ul>",v=JSON.stringify({clickId:"sortingRecords",clearCache:!0,module:a,fromIndex:1,sortColumnString:t,sortOrderString:"sort_asc",webTab:"false",mailingAddress:g}),C=JSON.stringify({clickId:"sortingRecords",clearCache:!0,module:a,fromIndex:1,sortColumnString:t,sortOrderString:"sort_desc",webTab:"false",mailingAddress:g}),h=JSON.stringify({clickId:"sortingRecords",clearCache:!0,module:a,fromIndex:1,sortColumnString:"",sortOrderString:"sort_desc",webTab:"false",mailingAddress:g});if(crmListView.getObject().isPrivacyListView){var b={};b.module=crmListView.getObject().module.replace("privacy_",""),b.fromIndex=1,b.toIndex=parseInt(crmListView.getObject().currentOption),b.currentOption=crmListView.getObject().currentOption,b.type=crmListView.getObject().privacyDetails.type,b.status=crmListView.getObject().privacyDetails.status,crmListView.getObject().filters&&crmListView.getObject().filters.length&&(b.filters=JSON.stringify(crmListView.getObject().filters)),b.sortColumnString="",b.sortOrderString="sort_desc",h=$ESAPI.encoder().encodeForHTMLAttribute(JSON.stringify(b)),b.sortColumnString=t,C=$ESAPI.encoder().encodeForHTMLAttribute(JSON.stringify(b)),b.sortColumnString=t,b.sortOrderString="sort_asc",v=$ESAPI.encoder().encodeForHTMLAttribute(JSON.stringify(b))}"Potentials"!=a&&"Accounts"!=a&&"Contacts"!=a&&"Leads"!=a||(v.fetchOnlyBody=!0,C.fetchOnlyBody=!0,h.fetchOnlyBody=!0);var y=JSON.stringify({module:a,fromIndex:1,sortColumnString:t,sortOrderString:"sort_desc",webTab:"false",mailingAddress:"sortby_name"}),I=JSON.stringify({module:a,fromIndex:1,sortColumnString:t,sortOrderString:"sort_desc",webTab:"false",mailingAddress:"sortby_distance"}),_={};if(_.sort_by=t,crmListView.getObject()){var E=crmHistory.getPageDetailsFromIndex(1,crmListView.getObject().currentOption);_.page=E.page,_.per_page=E.perPage}var w=Lyte.Router.getRouteInstance().transition.info.queryParams;w.filters?_.filters=w.filters:w.filter_id&&(_.filter_id=w.filter_id);var T=objectUtils.cloneObject(_),L=objectUtils.cloneObject(_);if(c)T.sort_order="sort_asc",crmListView.getObject().isPrivacyListView?f+='<li><link-to data-zcqa="privacySorting_desc" lt-prop-route="crm.settings.section.compliance.consent-dashboard.list-view" lt-prop-qp="'+C+'">'+I18n.getMsg(c?"crm.column.sort.asc":"crm.column.sort.desc")+'&nbsp;<span class="svgIcons '+(c?"sort_asc":"sort_desc")+'"></span></link-to></li>':f+='<li><link-to  data-zcqa="sorting_desc" lt-prop-route="crm.tab.module.custom-view.list"  lt-prop-td=\''+v+"'  lt-prop-dp='[\""+a+'","'+u+"\"]'>"+I18n.getMsg(c?"crm.column.sort.asc":"crm.column.sort.desc")+'&nbsp;<span class="svgIcons '+(c?"sort_asc":"sort_desc")+'"></span></link-to></li>',L.sort_order="sort_unsort",crmListView.getObject().isPrivacyListView?f+='<li><link-to data-zcqa="privacySorting_unsort" lt-prop-route="crm.settings.section.compliance.consent-dashboard.list-view" lt-prop-qp="'+h+'">'+I18n.getMsg("crm.column.unsort")+"</link-to></li>":f+="<li><link-to  lt-prop-td= '"+h+'\'  lt-prop-route="crm.tab.module.custom-view.list"  lt-prop-dp=\'["'+a+'","'+u+'"]\' data-zcqa="sort_unsort">'+I18n.getMsg("crm.column.unsort")+"</link-to></li>";else if(null!=p){var O=$("#sorted_column").data("param").fieldid;null!=O&&(r=getObj("sorted_column").className),O==t?r.indexOf("sort_asc")>-1?(T.sort_order="sort_desc",crmListView.getObject().isPrivacyListView?f+='<li><link-to data-zcqa="privacySorting_desc" lt-prop-route="crm.settings.section.compliance.consent-dashboard.list-view" lt-prop-qp="'+C+'">'+I18n.getMsg("crm.column.sort.desc")+'&nbsp;<span class="svgIcons sort_desc"></span></link-to></li>':f+='<li><link-to  data-zcqa="sorting_desc" lt-prop-route="crm.tab.module.custom-view.list"  lt-prop-td=\''+v+"'  lt-prop-dp='[\""+a+'","'+u+"\"]'>"+I18n.getMsg("crm.column.sort.desc")+'&nbsp;<span class="svgIcons sort_desc"></span></link-to></li>',L.sort_order="sort_unsort",crmListView.getObject().isPrivacyListView?f+='<li><link-to data-zcqa="privacySorting_unsort" lt-prop-route="crm.settings.section.compliance.consent-dashboard.list-view" lt-prop-qp="'+h+'">'+I18n.getMsg("crm.column.unsort")+"</link-to></li>":f+="<li><link-to  lt-prop-td= '"+h+'\'  lt-prop-route="crm.tab.module.custom-view.list"  lt-prop-dp=\'["'+a+'","'+u+'"]\' data-zcqa="sort_unsort">'+I18n.getMsg("crm.column.unsort")+"</link-to></li>"):(T.sort_order="sort_asc",crmListView.getObject().isPrivacyListView?f+='<li><link-to data-zcqa="privacySorting_asc" lt-prop-route="crm.settings.section.compliance.consent-dashboard.list-view" lt-prop-qp="'+v+'">'+I18n.getMsg("crm.column.sort.asc")+'&nbsp;<span class="svgIcons sort_asc"></span></link-to></li>':f+='<li><link-to data-zcqa="sorting_asc"  lt-prop-td=\''+v+'\'  lt-prop-route="crm.tab.module.custom-view.list"   lt-prop-dp=\'["'+a+'","'+u+"\"]'>"+I18n.getMsg("crm.column.sort.asc")+'&nbsp;<span class="svgIcons sort_asc"></span></link-to></li>',L.sort_order="sort_unsort",crmListView.getObject().isPrivacyListView?f+='<li><link-to data-zcqa="privacySorting_unsort" lt-prop-route="crm.settings.section.compliance.consent-dashboard.list-view" lt-prop-qp="'+h+'">'+I18n.getMsg("crm.column.unsort")+"</link-to></li>":f+="<li><link-to  lt-prop-dp='[\""+a+'","'+u+"\"]'  lt-prop-td= '"+h+'\'  lt-prop-route="crm.tab.module.custom-view.list" data-zcqa="sort_unsort">'+I18n.getMsg("crm.column.unsort")+"</link-to></li>"):(T.sort_order="sort_asc",crmListView.getObject().isPrivacyListView?f+='<li><link-to data-zcqa="privacySorting_asc" lt-prop-route="crm.settings.section.compliance.consent-dashboard.list-view" lt-prop-qp="'+v+'">'+I18n.getMsg("crm.column.sort.asc")+'&nbsp;<span class="svgIcons sort_asc"></span></link-to></li>':f+='<li><link-to data-zcqa="sortingasc"  lt-prop-td=\''+v+'\'  lt-prop-route="crm.tab.module.custom-view.list"   lt-prop-dp=\'["'+a+'","'+u+"\"]'>"+I18n.getMsg("crm.column.sort.asc")+'&nbsp;<span class="svgIcons sort_asc"></span></link-to></li>',L.sort_order="sort_desc",crmListView.getObject().isPrivacyListView?f+='<li><link-to data-zcqa="privacySorting_desc" lt-prop-route="crm.settings.section.compliance.consent-dashboard.list-view" lt-prop-qp="'+C+'">'+I18n.getMsg("crm.column.sort.desc")+'&nbsp;<span class="svgIcons sort_desc"></span></link-to></li>':f+="<li><link-to  lt-prop-dp='[\""+a+'","'+u+"\"]'  lt-prop-td='"+C+'\'  lt-prop-route="crm.tab.module.custom-view.list" data-zcqa="sort_desc">'+I18n.getMsg("crm.column.sort.desc")+'&nbsp;<span class="svgIconsImg sort_desc"></span></link-to></li>')}else T.sort_order="sort_asc",crmListView.getObject().isPrivacyListView?f+='<li><link-to data-zcqa="privacySorting_asc" lt-prop-route="crm.settings.section.compliance.consent-dashboard.list-view" lt-prop-qp="'+v+'">'+I18n.getMsg("crm.column.sort.asc")+'&nbsp;<span class="svgIcons sort_asc"></span></link-to></li>':f+='<li><link-to data-zcqa="sorting_asc" lt-prop-td=\''+v+'\' lt-prop-route="crm.tab.module.custom-view.list"  lt-prop-dp=\'["'+a+'","'+u+"\"]'>"+I18n.getMsg("crm.column.sort.asc")+'&nbsp;<span class="svgIcons sort_asc"></span></link-to></li>',L.sort_order="sort_desc",crmListView.getObject().isPrivacyListView?f+='<li><center><link-to data-zcqa="privacySorting_desc" lt-prop-route="crm.settings.section.compliance.consent-dashboard.list-view" lt-prop-qp="'+C+'">'+I18n.getMsg("crm.column.sort.desc")+'&nbsp;<span class="svgIcons sort_desc"></span></link-to></li>':f+="<li><link-to lt-prop-td='"+C+"'lt-prop-dp='[\""+a+'","'+u+'"]\' lt-prop-route="crm.tab.module.custom-view.list" data-zcqa="sort_desc">'+I18n.getMsg("crm.column.sort.desc")+'&nbsp;<span class="svgIconsImg sort_desc"></span></link-to></li>';null==e||"MAILINGSTREET"!=e.id&&"BILLINGSTREET"!=e.id&&"LANE"!=e.id||!getObj("nearme")||"yes"!=getObj("nearme").value||((void 0!==customViewObject&&null!=customViewObject.nearmeSortOrder?customViewObject.nearmeSortOrder:"").indexOf("sortby_name")>-1?f+="<li><a data-cid='sortingRecords' data-zcqa='sort_unsort' data-params='"+I+"'>"+I18n.getMsg("View Distance")+"</a></li>":f+="<li><a data-cid='sortingRecords' data-zcqa='sort_unsort' data-params='"+y+"'>"+I18n.getMsg("View Mailing Address")+"</a></li>");f+="</ul></div>",$(d).empty(),d.innerHTML=f;var M=d.querySelectorAll("li");crmListView.getObject().isPrivacyListView||(M[0].children[0].setAttribute("lt-prop-qp",JSON.stringify(T)),M[1].children[0].setAttribute("lt-prop-qp",JSON.stringify(L))),d.style.display="block",i||(i=window.event),i.stopPropagation&&(i.stopPropagation(),i.cancelBubble=!0)}function sortColumns(e,t,a,i,r,l){commonUtils.showHideLoadingDiv(!0);var s=getObj("sorted_column");if(getObj("sort_div")&&(getObj("sort_div").style.display="none"),null!=s){var o=getObj("sorted_column").title;sortOrderString=getObj("sorted_column").className,null!=(temp=o)&&(temp=convertColumnName(temp,t))}var n=getObj("chk");if(n){var d=n.length;(null==d||d<=1)&&n.parentNode.removeChild(n)}var c=commonUtils.formData2QueryString(document.showcvdetails);document.getElementById("advSearchEnable")&&document.getElementById("advSearchEnable").value,sortOrderString=getObj("sorted_column")?getObj("sorted_column").className:temp==e&&"sort_asc"==sortOrderString?"sort_desc":"sort_asc",getObj("currentOption")&&(document.showcvdetails.rangeValue.value=getObj("currentOption").value);var u=Crm.getCrmBasePath()+"/DeleteFromCV.do";u=u+"?start_index="+r+"&end_index="+l+"&sortColumnString="+encodeURIComponent(e)+"&sortOrderString="+sortOrderString;var m="";null!=c&&(m=c),m=m+"&"+csrfParamName+"="+csrfToken,httphandle.open("POST",u,!0),httphandle.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),httphandle.onreadystatechange=function(){if(4==httphandle.readyState){var e=httphandle.responseText;if(200==httphandle.status)"Leads"==t||"Contacts"==t||"Accounts"==t||"Potentials"==t?changeShowCacheObj(t,e):(divObj=getObj("idForCV"),$(divObj).empty(),divObj.innerHTML=e),JSEvalScript(getObj("idForCV")),document.getElementById("ajax_load_tab").style.display="none",bindEventListView(),hide("zohobusy_loadpage_cv");else if(httphandle.status==crmConstants.errorStatusCode)return void renderingUtils.displayPermissionDenied(httphandle)}},httphandle.send(m),temp=e}function handleCancel(e,t,a,i){_cruxUtils.removeCustomMessage();var r=$("#"+t).parent();if($("#vr_verifyBut").remove(),commonUtils.setErrVerifyContHeightToParent(!1,!1,!1),$("#fieldVerified").remove(),r.find(".vr_err_cont").remove(),a.includes("ATTACHMENTID")){$L("#"+e).closest(".uitype_555").removeClass("fileUploadMenuOpened");var l=$L("#"+e).parent();0===valueBeforeAjaxEdit.length?l.removeClass("fu_viewNonEmpty"):valueBeforeAjaxEdit.length>0&&l.addClass("fu_viewNonEmpty")}if(a.includes("IMAGEATTACHMENTID")){var s="vlabel_"+a;detailView.isImageModified[s]=!1;var o=Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents(s,"view").getData("cxPropValue");Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents(s,"view").setData("cxPropValue",[]),Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents(s,"view").setData("cxPropValue",o)}$L("#rpBtnResubmit").removeClass("disable");var n=$("#"+t);if(event&&event.stopPropagation(),"MXNDUMMYCOLUMNBUNDLE"===a){var d=$L("#Crm_Bundles_"+a).data("relatedListId"),c=document.getElementById("ract_"+d);c&&c.classList.remove("disabled","eventNone")}n.hide();var u=$("#"+e);u.closest(".tabDiv").removeClass("focusEleField errorFieldP"),u.closest(".tabdiv").removeClass("errorFieldP"),$("#labelTD_"+a).removeClass("newmandatory").find(".infotoolTip").css("visibility","hidden").removeClass("infoTTStay"),document.getElementById("unique").style.display="none",$(".errMsg").hide(),CVRExec.removeVerifyBtn(u.parent());var m=$("#mouseArea__"+globalfieldlabel);if("445"==m.data("params").uitype&&(m.data("params").selectedid=m.data("params").dataObj["data-selectedid"]),"DESCRIPTION"==a&&"Events"==$("#module").val()&&m.removeClass("dB").addClass("dIB"),"250"===m.data("params").uitype&&("Events"===m.data("params").module||"Tasks"===m.data("params").module)){var p=$L("#dvinner");Crm.userDetails.isCanvasActivitySupportEnabled?(p.scroll(),$L("crm-richtext-component.preventWheel").removeClass("preventWheel")):thirdPartyUtils.bindPerfectScroll(p)}if("Bundles"===m.data("params").module&&"MXNDUMMYCOLUMNBUNDLE"===a){var g=$L("#Crm_Bundles_MXNDUMMYCOLUMNBUNDLE"),f=g?g.data("editedVsOldQty"):null,v=g&&g.data("lVsp")&&JSON.parse(g.data("lVsp"))?JSON.parse(g.data("lVsp")):null;if(f&&moduleRecordMapping.LinkingModuleBundleRel&&moduleRecordMapping.Products)Object.keys(f).forEach((e=>{var t=store.peekRecord(moduleRecordMapping.LinkingModuleBundleRel.id,e);t&&t.$.set("Product_Quantity",f[e].Old_Product_Quantity);var a=v[e],i=a?store.peekRecord(moduleRecordMapping.Products.id,a):null;i&&i.Product_Quantity&&i.$.set("Product_Quantity",f[e].Old_Product_Quantity)}))}if(n.empty(),i){var C=$('<span data-zcqa="selectColorComponent" class="dIB activitesColor" id="selectColorComponent" style="background:'+i+'"></span>'),h=u.find("span");h.length>0?(h.find(".activitesColor_dv").remove(),C.insertBefore(h)):u.append(C)}if(e.indexOf("headervalue_")>-1)show(e,"inline-block");else{u.show(),$("#value_"+a).removeClass("newmandatory");var b=1;m.data("params")&&m.data("params").uitype&&(b=m.data("params").uitype);var y=valueBeforeAjaxEdit;"1"!==b&&"3"!==b&&"110"!==b||(y=revertSplChrs(y)),detailView.replaceDataParams(a,y)}var I=getObj(a),_=document.getElementById("iskanbanview");!I||_&&"true"===_.value||(I.className="label"),hideMenu(),itsonview=!1,$(".imageUploadDetailPage").removeClass("eventNone");var E=$(".detailViewContainer"),w=$(".newBusinessCardView");E.removeClass("editModeEnable"),w.removeClass("editModeEnable");var T=$L(".businesscall");if(T.length&&(T.removeClass("editModeEnable"),T.find(".editLabelBC").removeClass("editLabelBC focusEleField"),T.find(".highlightNewLookupField").removeClass("highlightNewLookupField"),"CTIVOICEURL"===a)){var L=$L("#bcardRow_Voice_Recording__s");L.removeClass("editModeVR"),$L("#"+e).parents("lyte-td").hasClass("vRecordingComp")&&L.removeClass("dB").addClass("dIF")}return w.find(".newDateTimeField").removeClass("newDateTimeField"),w.find(".editLabelBC").removeClass("editLabelBC focusEleField"),w.find(".newBCPhoneViewedit").removeClass("newBCPhoneViewedit"),w.find(".lookupFieldCreate").removeClass("lookupFieldCreate"),n.closest("td").removeClass("selectBoxSelect2"),E.add(w).find(".highlightNewLookupField").removeClass("highlightNewLookupField"),tkveventajax=!1,$("crux-subform").each((function(e,t){t.component.setData("cxPropDisableAjaxEdit",!1)})),!1}function patternValidate1(e,t,a,i,r){var l=null;if("EMAIL"==a.toUpperCase()&&(l=validationUtils.emailRegex),"DATE"==a.toUpperCase())switch(Crm.userDetails.DATE_PATTERN.toLowerCase()){case"yyyy/mm/dd":case"yyyy.mm.dd":case"yyyy-mm-dd":l=/^\d{4}(\-|\/|\.)\d{1,2}\1\d{1,2}$/;break;case"mm/dd/yyyy":case"mm.dd.yyyy":case"mm-dd-yyyy":case"dd/mm/yyyy":case"dd.mm.yyyy":case"dd-mm-yyyy":l=/^\d{1,2}(\-|\/|\.)\d{1,2}\1\d{4}$/}if("TIME"==a.toUpperCase())l=/^\d{1,2}(\:\d{1,2})*$/;if(!validationUtils.validatePattern(l,i))return"inline"===r?renderingUtils.displayErrorDiv(e,t,"crm.field.valid.check"):renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",t)),!1}function emailValidate1(e,t,a,i){return 0!=patternValidate1(e,t,"EMAIL",a,i)}function numValidate1(e,t,a,i){var r=i.replace(/^\s+/g,"").replace(/\s+$/g,"");if("any"!=a&&0!=parseInt(a))var l="^-?\\d+((\\d)+)*(\\.\\d{1,"+(a=a.split(","))[0]+"})*$",s=new RegExp(l);else s=/^-?\d+((\d)+)*(\.\d{1,2})*$/;if(s.test(r))return!0;var o=t.replace(/_____/g,")").replace(/____/g,"(").replace(/___/g,".");return $("#module").val()&&(o=$("[name='property("+t+")']").data()?$("[name='property("+t+")']").data().displaylabel:o),renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",o)),getObj("textbox_"+t).setAttribute("autocomplete","off"),getObj("textbox_"+t).focus(),!1}function phoneValidate1(e,t,a){var i=document.getElementById("textbox_"+t),r=$(i),l=a.replace(/^\s+/g,"").replace(/\s+$/g,"");if($("#module").val()&&(t=$("[name='property("+t+")']").data()?$("[name='property("+t+")']").data().displaylabel:s),validationUtils.isValidPhoneNo(r,l))return!0;var s=t.replace(/_____/g,")").replace(/____/g,"(").replace(/___/g,".");return renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",s)),r.attr("autocomplete","off"),r.focus(),!1}function formValidate1(e,t,a){var i=e.replace(/_____/g,")").replace(/____/g,"(").replace(/___/g,".");if((n=singularModule=getObj("singularModule")?getObj("singularModule").value:"")&&"true"===n.value){r=$('[name="fieldname"]').val().split(";"),l=$('[name="fielddatatype"]').val().split(";"),s=$('[name="fieldlabel"]').val().split(";");"STARTDATETIME"!==i&&"ENDDATETIME"!==i&&"LOCATION"!==i||(l="DT~O~istkv~OTH",r=new Array("property("+i+")"),s=i)}else var r=getObj("fieldname").value.split(";"),l=getObj("fielddatatype").value.split(";"),s=getObj("fieldlabel").value.split(";"),o="";for(var n=document.getElementById("iskanbanview"),d=r.length,c=0;c<d;c++){var u="undefined"!=typeof labelToCol?labelToCol[s[c]]:s[c];if(!n||"true"!==n.value||"STARTDATETIME"!==i&&"ENDDATETIME"!==i){var m=l[c].split("~");if(i!=u)continue;var p=$("[name='property("+i+")']");o=p.data()&&p.data().displaylabel?p.data().displaylabel:e}else{m=l.split("~");s[c]=i}if("M"==m[1]&&!emptyCheck1(r[c],e,!1,t,a))return!1;switch(m[0]){case"O":case"V":case"C":break;case"E":if(null!=t&&0!=t.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!emailValidate1(r[c],o,t))return!1;break;case"DT":if(null!=t&&0!=t.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===m[3])var g="OTH";else g=m[3];if(!CrmDateUtils.dateTimeValidate(r[c],m[2],e,g))return tkveventajax=!0,!1;if(tkveventajax=!1,m[4]){if(!CrmDateUtils.dateTimeComparison(r[c],m[2],e,m[5],m[6],m[7],m[4]))return tkveventajax=!1,!1;tkveventajax=!1}}break;case"D":if(null!=t&&0!=t.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(g=void 0===m[2]?"OTH":m[2],!CrmDateUtils.dateValidate(r[c],e,g))return!1;if(m[3]&&!CrmDateUtils.dateComparison(r[c],o,m[4],m[5],m[3]))return!1}break;case"T":if(null!=t&&0!=t.replace(/^\s+/g,"").replace(/\s+$/g,"").length){var f="";if(f=void 0===m[2]?"OTH":m[2],!CrmDateUtils.timeValidate(r[c],e,f))return!1;if(m[3]&&!CrmDateUtils.timeComparison(r[c],o,m[4],m[5],m[3]))return!1}break;case"I":case"B":if(null!=t&&0!=t.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(!intValidate1(e,t))return!1;if(m[2]&&!validationUtils.numConstComp(r[c],e,m[2],m[3]))return!1}break;case"DE":if(null!=t&&0!=t.replace(/^\s+/g,"").replace(/\s+$/g,"").length){var v="";if(v=void 0===m[2]?"any":m[2],!validationUtils.decimalValidate(r[c],e,v))return!1;if(m[2]&&!validationUtils.numConstComp(r[c],e,m[2],m[3]))return!1}break;case"N":if(null!=t&&0!=t.replace(/^\s+/g,"").replace(/\s+$/g,"").length){v="";if(v=void 0===m[2]?"any":m[2],!numValidate1(r[c],e,v,t))return!1;if(m[3]&&!validationUtils.numConstComp(r[c],e,m[3],m[4]))return!1}break;case"P":if(null!=t&&0!=t.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!phoneValidate1(r[c],e,t))return!1;break;case"W":if(null!=t&&0!=t.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!validationUtils.isValidWebURL_extended(o,t))return!1}}return!0}function intValidate1(e,t){var a=t.replace(/^\s+/g,"").replace(/\s+$/g,""),i=e.replace(/_____/g,")").replace(/____/g,"(").replace(/___/g,".");$("#module").val()&&(i=$("[name='property("+e+")']").data()?$("[name='property("+e+")']").data().displaylabel:i);return!(isNaN(a)||-1!=a.indexOf(".")||!/^\d+(,(\d)+)*$/.test(a))||(renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",i)),getObj("textbox_"+e).setAttribute("autocomplete","off"),getObj("textbox_"+e).focus(),!1)}function emptyCheck1(e,t,a,i,r){var l=t.replace(/\./g,"___").replace(/\(/g,"____").replace(/\)/g,"_____"),s=getObj("textbox_"+l);return 100==r&&(s=getObj("comboValue"+comboCount)),$("#module").val()&&(t=$("[name='property("+t+")']").data()?$("[name='property("+t+")']").data().displaylabel:t),a&&"none"==s.value?(renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.none.check",t)),!1):0!=s.value.trim().length||(renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.empty.check",t)),s.setAttribute("autocomplete","off"),!1)}function formDataFormSecurity(){for(var e="",t=getObj("counter").value,a=1;a<=parseInt(t);a++){var i="checkBoxAjax_"+a;1==getObj(i).checked&&(e+=encodeURIComponent(getObj(i).name),""!=getObj(i).value&&(e+="="+encodeURIComponent(getObj(i).value)),e+="&")}return e}function addStyle(e,t){if("3"==t||"110"==t)$(e).addClass("tAreaBox");else if(t===CrmField.UITYPES.SERVICE_DURATION.toString())for(var a=$(e).length,i=0;i<a;i++){var r=$(e)[i];"Crm_Services_SERVICEDURATION"===r.id?$(r).attr("style","display:none"):$(r).attr("style","")}else $(e).attr("style","");return e}function getMultiuserLookupValues(e,t,a,i,r){var l="/crm/v2.1/"+moduleApiMapping[e]+"/"+t+"?fields="+a+"&approved=both";"Bundles"===e&&(l=Crm.changeBundlesApiVersion(l,"v2.2"));var s={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken};clientPortalName&&(s["X-CRMPORTAL"]=window.clientPortalName),(new crmRequestPool).initiate({action:l,type:"GET",headers:s,success:function(t){var l=t.data[0][a];if($("#mouseArea__"+i).data("params").selectedAPIJson=l,r){var s={};s.api_name=a;for(var o=moduleRecordMapping[e].fields.filterBy(s)[0].multiuserlookup.connectedlookup_apiname,n=l.length,d="",c=0;c<n;c++)d=0==c?l[c][o].name:d+", "+l[c][o].name;$("#value_"+i).text(d)}}})}function onBeforeUpdateCScriptCheck(e,t,a){const i=("Calls"===e&&isNewCallView?$("#fullInfoDiv"):$(document)).find("#"+commonUtils.escapeSingleQuote(a)),r=i.data("uitype");return[3,110].includes(r)&&i[0]&&i[0].component?CScript.Engine.Global.dispatchIEvent("onBeforeUpdate",t,i[0].component.getData("cxPropValue")):[3,110].includes(r)?CScript.Engine.Global.dispatchIEvent("onBeforeUpdate",t,i.attr("cx-prop-value")):CScript.Engine.Global.dispatchIEvent("onBeforeUpdate",t,commonUtils.getValue(i))}function ajaxEdit(){if(!detailView.isSubformAjaxOpened){Lyte.registeredMixins["crm-entity-utils"].trackRecordEditSaveData("ajaxEdit"),$("#bundlePriceVal").addClass("dNImp");var e=[CrmField.UITYPES.LOOK_UP_ENTITY,CrmField.UITYPES.MULTISELECT_LOOK_UP,CrmField.UITYPES.CURRENCY,CrmField.UITYPES.ACCOUNT_NAME_LOOKUP,CrmField.UITYPES.SALESORDER_ID,CrmField.UITYPES.CONTACT_ID,CrmField.UITYPES.VENDOR_NAME_LOOKUP,CrmField.UITYPES.CONTACT_LOOKUP,CrmField.UITYPES.POTENTIAL_ID,CrmField.UITYPES.PRODUCT_NAME_LOOKUP,CrmField.UITYPES.CAMPAIGN_NAME_LOOKUP,CrmField.UITYPES.QUOTE_ID,CrmField.UITYPES.CURRENCY_ROUND_OFF,CrmField.UITYPES.CURRENCY_ROUND_DOWN,CrmField.UITYPES.CURRENCY_ROUND_UP,CrmField.UITYPES.LAYOUT_LOOKUP],t=$(".detailViewContainer"),a=$(".newBusinessCardView"),i=$("#header_"+globalfieldlabel),r=i.parent("td.labelVal").outerWidth(),l=$("#value_"+globalfieldlabel);if(itsonview){var s=detailView.currentModule;$("#Crm_"+s+"_"+globalfieldlabel).focus()}if(!itsonview&&!detailView.readOnlyField){var o=$("#mouseArea__"+globalfieldlabel).data("params");if(detailView.oldfieldUpdateJson&&detailView.oldfieldUpdateJson.length>0)detailView.currency&&(d=detailView.currency[globalfieldlabel]+""),"undefined"!==d&&(d=detailView.cloneupdateMap[globalfieldlabel]+""),"undefined"!==d&&(o.defaultvalue=d);"555"===o.uitype&&$L("#value_"+globalfieldlabel).parent().removeClass("fu_viewNonEmpty"),"32"!==o.uitype&&"38"!==o.uitype&&"52"!==o.uitype||(o.formattedValue?o.defaultvalue=Search.reverseFormatNumber(o.formattedValue):o.defaultvalue=Search.reverseFormatNumber(o.defaultvalue)),"true"==o.mandate&&($("#labelTD_"+globalfieldlabel).addClass("newmandatory"),l.addClass("newmandatory")),$("#labelTD_"+globalfieldlabel).find(".infotoolTip").css("visibility","visible").addClass("infoTTStay");s=detailView.currentModule;var n=returnJson;n.currentField=o,n.module=s,n.currentStatus="ajaxEdit",n.isClientAccount=Crm.userDetails.CLIENT_ACCOUNT;var d,c=n[s].entityid;if(valueBeforeAjaxEdit=o.defaultvalue,/\b(5|4|6|7|9|10|12|13|15|133|136|221)\b/.test(o.uitype)&&(idBeforeAjaxEdit="null"===o.defaultid?"":o.defaultid),o.uitype+""=="445"&&getMultiuserLookupValues(s,c,o.sysRefName,o.colname),n[s].fieldDependency&&(Crm.fieldDependency[s]=JSON.parse(n[s].fieldDependency)),"36"==o.uitype||"144"==o.uitype||"143"==o.uitype||"145"==o.uitype)"null"===(d=o.plainValue?o.plainValue:valueBeforeAjaxEdit)&&(d=""),valueBeforeAjaxEdit=d;if("35"!=o.uitype&&"33"!=o.uitype||(valueBeforeAjaxEdit=o.dbPhoneValue?o.dbPhoneValue:commonUtils.getPlainPhoneNo(valueBeforeAjaxEdit)),o.defaultvalue=valueBeforeAjaxEdit,"26"==o.uitype){var u=$("#value_PROBABILITY"),m="";u.length>0?(m=""==(m=u.text().trim())?"0":m,o.defaultvalue=m+":"+o.plainValue):o.defaultvalue=o.plainValue}o.defaultvalue&&o.default&&o.default[0]&&(o.default[0].value=o.defaultvalue),o.isDetailView=!0;var p,g=crmTemplate.createFieldContent(n);if("250"===o.uitype)(p=0===globaltextareapanid.indexOf("headertextarea_")?i[0].querySelector(".rtfViewValue"):l[0].querySelector(".rtfViewValue"))&&g.querySelector("crm-richtext-component").component.setData("cxPropEditorInitialHeight",p.clientHeight);if("3"===o.uitype||"110"===o.uitype){var f,v=0,C=(f=0===globaltextareapanid.indexOf("headertextarea_")?i:l).find(".showMoreLink");C.hasClass("more")?detailView.multilineJSON[globalfieldlabel]="more":C.hasClass("less")&&(detailView.multilineJSON[globalfieldlabel]="less",v-=C.outerHeight()-2),v+=f.outerHeight()-2,(g=crmTemplate.createFieldContentForMultiLine(o,v)).setData("cxPropTextAreaResize",{vertical:"true"})}var h=document.createDocumentFragment(),b=addStyle(g.children,o.uitype);"3"!==o.uitype&&"110"!==o.uitype&&"250"!==o.uitype?$(b).keydown((function(e){handleButton("button__"+commonUtils.escapeSingleQuote(globalfieldlabel),e)})):"3"==o.uitype&&"Events"==s&&$("#mouseArea__"+globalfieldlabel).removeClass("dIB").addClass("dB");var y=!1,I=!1;o.iscallallowed&&(I=!0),"33"==o.uitype&&1==o.outbound&&(y="true",recordid1=$("#id").val());var _=(h=$(h).append(b)).children()[0];if("3"===o.uitype||"110"===o.uitype){var E={"aria-valuemax":_.maxLength,"aria-label":_.dataset.displaylabel};_.setData("cxPropAriaAttributes",E)}else _.ariaValuemax=_.maxLength,_.ariaLabel=_.dataset.displaylabel;var w=o.fieldid,T=o.colname,L="",O="",M="",D="",A="",S=document.getElementById("iskanbanview"),R="/crm/v2/";if(556===globaluitype&&(R="/crm/v2.2/"),o.field_validation){var U="CVRExec.fieldVerify('"+s+"','"+o.colname+"');",N=I18n.getMsg("crm.validation.rule.verify");D=renderingUtils.createHTML({name:"input",attr:{value:N,type:"button",class:"newgraybtndd newwhitebtn vr_verifyBtn mB6",id:"vr_verifyBut",onclick:U,"data-zcqa":"vR_verify_"+w}})}var P="Callonclickofbutton('"+R+"','"+commonUtils.escapeSingleQuote(globaltextboxpanid)+"','"+commonUtils.escapeSingleQuote(globalvaluespanid)+"','"+commonUtils.escapeSingleQuote(globaltextareapanid)+"','"+commonUtils.escapeSingleQuote(globalfieldlabel)+"','"+s+"','"+commonUtils.escapeSingleQuote(globalsubvaluespanid)+"','"+o.uitype+"',undefined,'"+T+"','"+c+"','"+y+"',undefined,'"+w+"','"+I+"')";if(CScriptLib&&_cscript._info&&(P="onBeforeUpdateCScriptCheck('"+s+"', '"+w+"', '"+globaltextboxpanid+"').then(function(response){if(response){"+P+"}});"),S&&"true"===S.value)L=renderingUtils.createHTML({name:"span",attr:{value:"",class:"zcicncss-tick-filled-rounded zcicn-cssIcons zcicn_blue_mask saveLink crm-small-font-size p0 vaM kanbanviewImages tkvsaveLink",name:"button__"+globalfieldlabel,onclick:P,tabindex:"0","aria-label":x,role:"button","lt-prop-aria-keydown":"true"}});else{var x=I18n.getMsg("Save")+" ",V=I18n.getMsg("Cancel"),k=I18n.getMsg("or")+" ";L=renderingUtils.createHTML({name:"span",attr:{value:x,class:"zcicncss-tick-filled-rounded zcicn-cssIcons zcicn_blue_mask saveLink crm-small-font-size p0 vaM","data-zcqa":"fieldView_ajaxsave",name:"button__"+globalfieldlabel,onclick:P,tabindex:"0","aria-label":x,role:"button","lt-prop-aria-keydown":"true"}})}if(26==globaluitype){var F=$("#value_PROBABILITY").text().trim();F=F+":"+$("#value_STAGE").text().trim();var B="handleCancel('"+commonUtils.escapeSingleQuote(globalvaluespanid)+"','"+commonUtils.escapeSingleQuote(globaltextareapanid)+"','"+commonUtils.escapeSingleQuote(globalfieldlabel)+"'),setProbabilityInAjaxEdit('"+$ESAPI.encoder().encodeForJavaScript(F)+"');Crm.calculateExpectedRevenue();"}else if(2==globaluitype&&o.dataObj["data-picklist-color"]){var j=$(".activitesColor_dv");if(0==j.length&&(j=$("#selectColorComponent")),j.length>0){var H=Events.rgbtohex(j.css("background-color"));B="handleCancel('"+commonUtils.escapeSingleQuote(globalvaluespanid)+"','"+commonUtils.escapeSingleQuote(globaltextareapanid)+"','"+commonUtils.escapeSingleQuote(globalfieldlabel)+"', '"+H+"')"}else B="handleCancel('"+commonUtils.escapeSingleQuote(globalvaluespanid)+"','"+commonUtils.escapeSingleQuote(globaltextareapanid)+"','"+commonUtils.escapeSingleQuote(globalfieldlabel)+"')"}else B="handleCancel('"+commonUtils.escapeSingleQuote(globalvaluespanid)+"','"+commonUtils.escapeSingleQuote(globaltextareapanid)+"','"+commonUtils.escapeSingleQuote(globalfieldlabel)+"')";S&&"true"===S.value?(M=renderingUtils.createHTML({name:"a",attr:{id:revertSplChrs(commonUtils.escapeSingleQuote(globaltextareapanid))+"_cancel",value:"",href:"javascript:;",class:"cancelAct smalledit dIB kanbanviewImages tkvcancelLink vaM",name:"button__"+globalfieldlabel,onclick:B,"aria-label":V,role:"button","lt-prop-aria-keydown":"true"}}),A=renderingUtils.createHTML({name:"span",attr:{class:"zcicncss-close-rounded zcicn-cssIcons mT-2"}}),$(M).append(A)):(O=renderingUtils.createHTML({name:"b",attr:{value:k,class:"dim"}}),M=renderingUtils.createHTML({name:"a",attr:{id:revertSplChrs(commonUtils.escapeSingleQuote(globaltextareapanid))+"_cancel","data-zcqa":"fieldView_ajaxcancel",value:V,href:"javascript:;",class:"cancelAct smalledit mL10 crmLabelColor vaM",name:"button__"+globalfieldlabel,onclick:B,"aria-label":V,role:"buttom","lt-prop-aria-keydown":"true"}}),A=renderingUtils.createHTML({name:"span",attr:{class:"zcicncss-close-rounded zcicn-cssIcons mT-2"}}),$(M).append(A),$(O).text(""+k));var J="fR";"250"===o.uitype&&(J+=" rtfDvSaveCancelBtn");var G=renderingUtils.createHTML({name:"span",attr:{id:"saveCancelSpan",class:J}}),z=$(G);z.append(L),z.append(M),$(h).append(G);var q,W=getObj(globaltextareapanid),Y=$(W);if(W){$('[id="'+globaltextareapanid+'"]').show();var Q=$("#"+globaltextareapanid);if(Q.addClass("labelValTwo"),221==globaluitype&&Q.addClass("userLookupDetailView userLookupNewUI"),"250"===o.uitype&&Y.addClass("rtfDvEditWrap"),Y.html(h),""!==D){let e=Y.parent(),t=e.find(".labelValTwo").eq(0);if(Y.closest("#businesscardDtls").length>0&&(t=e),t){let e=t.find(".vr_err_verify_container");if(e.length>0)t.find(".vr_err_verify_container .vr_verifyBtn").remove(),e.prepend(D);else{let e=document.createElement("span");t.append(e),$(e).addClass("dIB vr_err_verify_container wbBreakWord").prepend(D)}commonUtils.setErrVerifyContHeightToParent(!1,!1,!1)}}Y.find(".lookup_hIconO").first().addClass("lookupIconChange"),"786"!=o.uitype&&"202"!=o.uitype&&"24"!=o.uitype&&"333"!=o.uitype||Y.closest(".tabdiv").addClass("newDateTimeField"),q=Y}else{var X=document.createElement("SPAN"),Z=$(X);X.setAttribute("class","labelValTwo"),221==globaluitype&&X.setAttribute("class","labelValTwo userLookupDetailView"),X.setAttribute("id","textarea_"+globalfieldlabel);var K=$("#value_"+globalfieldlabel);if("250"===o.uitype&&Z.addClass("rtfDvEditWrap"),K.after(Z.append(h)),Z.find(".lookup_hIconO").first().addClass("lookupIconChange"),"786"!=o.uitype&&"202"!=o.uitype&&"24"!=o.uitype&&"333"!=o.uitype||Z.closest(".tabdiv").addClass("newDateTimeField"),q=Z,""!==D){let e=Z;if(Y.closest("#businesscardDtls").length>0&&(e=$(X).parent()),e){let t=e.find(".vr_err_verify_container");if(t.length>0)e.find(".vr_err_verify_container .vr_verifyBtn").remove(),t.prepend(D);else{let t=document.createElement("span");e.append(t),$(t).addClass("dIB vr_err_verify_container wbBreakWord").prepend(D)}commonUtils.setErrVerifyContHeightToParent(!1,!1,!1)}}}if("3"!==o.uitype&&"110"!==o.uitype||q.addClass("textarea_multilineFld"),t.find("select").closest(".labelValTwo").addClass("selectBoxSelect2"),a.find("select").closest("td").addClass("selectBoxSelect2"),"Calls"===s&&Y.attr("id")&&-1!==Y.attr("id").indexOf("header")?(Y.closest("lyte-td").addClass("editLabelBC focusEleField"),"CTIVOICEURL"===T&&$L("#bcardRow_Voice_Recording__s").removeClass("dIF").addClass("editModeVR dB")):"33"===o.uitype&&Crm.userDetails.isPhoneNoNewView?Y.closest("td").addClass("editLabelBC focusEleField newBCPhoneViewedit"):Y.closest("td").addClass("editLabelBC focusEleField"),"250"===o.uitype&&Y.closest("td").removeClass("focusEleField"),hide(globalvaluespanid),"556"===o.uitype&&(Z&&Z.length>0?Z.find(".cxMultiImgUploadBtn").focus():Y.find(".cxMultiImgUploadBtn").focus()),-1!==e.indexOf(parseInt(o.uitype))&&q.parent().addClass("lookupFieldCreate"),"100"!==o.uitype&&"96"!==o.uitype||q.find("select").attr("onchange","focusEnableFuncDetailpage(this)"),"2"===o.uitype&&o.colorcode_enabled){var ee=$(".activitesColor_dv");if(ee.length>0){var te=ee.clone();q.find(".createSelect").find("div").append(te)}else{var ae=$("#"+globalvaluespanid).find(".activitesColor");ae.length>0&&q.find(".createSelect").find("div").append(ae)}}if("555"==o.uitype){w=o.fieldid;if(""!=o.defaultvalue&&0!=o.defaultvalue.length){for(var ie=0,re=0,le=0;le<o.defaultvalue.length;le++){var se=o.defaultvalue[le].original_Size_Byte;re+=parseInt(se),ie++}$("#attachCount_"+w).val(ie),$("#attachSize_"+w).val(re)}fileupload.removedAttachmentIds.length=0,fileupload.uploadedFileObject.length=0;var oe="label_"+T,ne=Lyte.registeredMixins["crm-uploadfields-mixin"];ne.getCruxFileUploadCreateComponents(oe)[0].component.setMethods({onMenuClick:function(e,t){ne.onFileUploadOptionClickImpl(s,e,t)},showUploadModal:function(e){ne.showAttachFilePopupImpl(s,e)},onRemoveFile:function(e,t){if(fileupload.removedAttachmentIds&&fileupload.removedAttachmentIds&&0===fileupload.removedAttachmentIds.length&&(fileupload.removedAttachmentIds=[]),e.attachment_Id&&fileupload.removedAttachmentIds.push(e.attachment_Id),CScriptLib){var a=t.data.cxPropField.sysRefName;CScript.Engine.Global.dispatchEvent("onChange",void 0,a),CScript.Engine.Global.dispatchEvent("onChange",w,CreatePageHandler.field_read.call({field_name:a}))}},showPreview:function(e){ne.showPreviewImpl(e)}})}if("556"===o.uitype){oe="label_"+T;var de=Lyte.registeredMixins["crm-uploadfields-mixin"].getCruxImageUploadComponents(oe,"create");de.setData("cxPropModalProperties",{maxHeight:"85%",wrapperClass:"crmImgUploadModal"}),de.setData("cxPropProgressStatusColours",{count:"var(--linkColor)",size:"var(--linkColor)",list:"var(--linkColor)"}),de.setMethods({onFileSuccess:function(e){return Lyte.registeredMixins["crm-uploadfields-mixin"].constructImageData(e)},onAddInModal:function(){$L(".crmImgUploadModal").length&&crmInteraction.modalShadow(".crmImgUploadModal")},onRemoveInModal:function(){$L(".crmImgUploadModal").length&&crmInteraction.modalShadow(".crmImgUploadModal")},onCropSuccess:function(e,t){return Lyte.registeredMixins["crm-uploadfields-mixin"].onCropSuccess(e,t)},onValidationImageClick:function(e){var t=moduleRecordMapping[s].fields.filterBy({column_name:T})[0];return Lyte.registeredMixins["crm-uploadfields-mixin"].openFeaturePopup(e.id,e.state,!1,!0,t.id,s,entityID.value,t.api_name)},onModalClose:function(){$L(".cxMultiImgUploadBtn").focus()},onPreviewClose:function(){$L(".cxMultiImgUploadBtn").focus()}})}"Events"==s&&3==globaluitype&&"DESCRIPTION"==globalfieldlabel&&$("#value_DESCRIPTION").hide(),786!==globaluitype&&14!==globaluitype||populateTimeVal(),hide("crmspanid"),itsonview=!0,t.addClass("editModeEnable"),a.addClass("editModeEnable");var ce=$(".businesscall");"Calls"===s&&ce.addClass("editModeEnable");var ue=Y.length?Y:$(X),me=ue.find(".newChosenSel select,.mlSelect select");if(-1!=ue.attr("id").indexOf("header")&&ue.addClass("oInherit"),me.length&&(2!==globaluitype&&26!==globaluitype||!o.colorcode_enabled||(me.data("colorcode",o.color_code),ue.addClass("colorEnabledPicklist"),"-None-"===me.val()||""===me.val()?ue.addClass("colorEnabledPKNone"):ue.removeClass("colorEnabledPKNone")),thirdPartyUtils.bindSelect2(me),"33"!=o.uitype&&setTimeout((function(){me.select2("open"),me.next(".select2").find(".select2-search__field").length?me.next(".select2").find(".select2-search__field").focus():me.next(".select2").find(".select2-selection").focus()}),30),sE()),"4"===o.uitype&&"Calls"===s&&("CONTACTID"===globalfieldlabel||"SEID"===globalfieldlabel)){var pe,ge=ue.find(" select, .mlSelect select");if(thirdPartyUtils.bindSelect2(ge),"SEID"===globalfieldlabel)ce.find("#Crm_Calls_SEID_select").on("change change.select2",(function(){var e=$(".businesscall"),t=e.find("#Crm_Calls_SEID"),a=e.find("#Crm_Calls_SEID_select").val();t.data("lookupModule",a);var i=e.find("#Crm_Calls_SEID_img");i.data("lookup-module",a),crmTab.tabList.contains(a)||i.hide();var r=Crm.moduleInfo[a]?Crm.moduleInfo[a].translatedSingularLabel:crmConstants.defaultWhatId[Calls.moduleName][a];t.val("").data("id","").data("displaylabel",I18n.getMsg("crm.module.name",[r]))}));else ce.find("#Crm_Calls_CONTACTID_WhoId_select").on("change change.select2",(function(){var e=$(".businesscall"),t=e.find("#Crm_Calls_CONTACTID"),a=e.find("#Crm_Calls_CONTACTID_WhoId_select").val();t.data("lookupModule",a);var i=e.find("#Crm_Calls_CONTACTID_img");i.data("lookup-module",a),crmTab.tabList.contains(a)||i.hide();var r=Crm.moduleInfo[a]?Crm.moduleInfo[a].translatedSingularLabel:crmConstants.defaultWhoId[Calls.moduleName][a];t.val("").data("id","").data("displaylabel",I18n.getMsg("crm.module.name",[r]))}));(pe=$L("#"+globaltextboxpanid)).on("focus blur",(function(e){var t=e.type,a=$(this),i=a.parent("div");0===i.length&&(i=a.closest(".labelValTwo")),"focus"===t?i.addClass("focusEleField"):i.removeClass("focusEleField")}))}if((pe=$("#"+globaltextboxpanid)).length>0){if(555!==globaluitype&&556!==globaluitype&&221!==globaluitype&&2!==globaluitype&&100!==globaluitype&&26!==globaluitype&&301!==globaluitype&&300!==globaluitype&&96!==globaluitype&&3!==globaluitype&&110!==globaluitype&&250!==globaluitype&&setCaretPosition("Crm_"+s+"_"+globalfieldlabel,o.defaultvalue?o.defaultvalue.length:0),$("#Crm_"+s+"_"+globalfieldlabel).focus(),"3"===o.uitype||"110"===o.uitype)setTimeout((function(){$("#Crm_"+s+"_"+globalfieldlabel).find("textarea").click()}),200);else if("250"===o.uitype){$("#Crm_"+s+"_"+globalfieldlabel).find("lyte-texteditor")[0].focus()}"250"!==o.uitype&&pe.closest(".tabDiv").addClass("focusEleField"),24!=globaluitype&&202!=globaluitype&&786!=globaluitype&&14!=globaluitype&&333!=globaluitype&&4!=globaluitype&&6!=globaluitype&&7!=globaluitype&&9!=globaluitype&&10!=globaluitype&&12!=globaluitype&&13!=globaluitype&&15!=globaluitype&&5!=globaluitype&&133!=globaluitype&&globaluitype!=CrmField.UITYPES.LAYOUT_LOOKUP||renderingUtils.triggerEvent("click",$("#"+globaltextboxpanid))}return globaluitype==CrmField.UITYPES.SERVICE_DURATION&&$("#serviceDurationDiv").click(),/(2|100|96)/.test(o.uitype)&&crmTemplate.setDependentFields(s,"view"),1==Crm.userDetails.detailView_newUI&&null!=Crm.userDetails.detailView_newUI&&(hide("summaryfield",!0),$("#headertextarea_"+globalfieldlabel).parent("td.labelVal").css("width",r)),$("crux-subform").each((function(e,t){t.component.setData("cxPropDisableAjaxEdit",!0)})),!1}}}function handleStageSelection(e){var t=$("#layoutInfo"),a=$("#txt_"+CrmField.UITYPES.STAGE),i=a.val();"-None-"==i?t.addClass("dN"):"mPStage"===e?(t.removeClass("dN"),t.find("span").html(I18n.getMsg("crm.massupdate.stage.info",$ESAPI.encoder().encodeForHTML(i)))):"mPPipe"===e&&(t.removeClass("dN"),t.find("span").html(I18n.getMsg("crm.massupdate.pipeline.info",$ESAPI.encoder().encodeForHTML($("#txt_"+CrmField.UITYPES.PICK_LIST).find("option:selected").closest("optgroup").attr("label"))))),a.data("colorcode_enabled")&&updateColorCodeForSelObj(a)}function getWorkflowPopUpContent(e,t,a){var i="<div class='zcrm-content w700 minW650'>";return i+="<div style='padding:60px; text-align:center;' class='crm-heading-font-size'>",i+="<span id='ruleNamesForMassActions'></span>",i=(i+=" <div class='pT30 aligncenter'>")+"<div id='muBtnLayerModal' style='display:visible' ><input type='button' value='"+I18n.getMsg("crm.button.cancel")+"' class='newgraybtn' data-zcqa='link_WfDelete_Cancel' href='javascript:;' onclick=\""+t+"('"+a+"')\">",i+=e,i+="</div></div></div></div>"}function doMassUpdate(e,t,a,i,r,l){Macro.canShowAutoSuggest=!0,isWFExecuted=!1;var s=new crmRequestPool,o=void 0;o=isWFSchedulerUser()?i.splice(0,i.length):i.splice(0,crmConstants.maxRecOperCnt),(customViewObject.isStageView&&1==customViewObject.isStageView||customViewObject.isPredictView&&1==customViewObject.isPredictView)&&customViewObject.layoutId&&"0"!=customViewObject.layoutId&&(a.layoutId=customViewObject.layoutId),a.idlist=o.join(";"),s.initiate({action:t,data:a,type:"POST",dataType:"json",success:function(s){if("SecurityError"==s.responseText)return hideAnimatePopup("bulkUpdateFldsListForScheduler"),renderingUtils.displayPermissionDenied(),!1;null!=Macro.autoSuggestHandler&&clearTimeout(Macro.autoSuggestHandler),Macro.autoSuggestHandler=setTimeout((function(){Macro.canShowAutoSuggest=!1}),1e4);Lyte.Router.getRouteInstance();if(1===i.length&&""===i[0]||i.length<=0){var o=a.isMassJobScheduled;if(s.body&&0!=s.body.length&&"listview"!=a.from){for(var n=[],d=s.fromIndex-1,c=0;d<=s.toIndex;d++,c++)s.body[c]?n[d]=s.body[c]:n[d]=null;s.body=n}var u=crmTab.getFromCache(e);if(void 0!==s.isWfTriggered&&1==s.isWfTriggered&&void 0!==s.approvalProcessTriggered&&1==s.approvalProcessTriggered)return void showMassActionRelatedRulesPop(I18n.getMsg("crm.mass.actions.rules.alert.content",[I18n.getMsg("crm.mass.actions.workflow.rules")+" & "+I18n.getMsg("crm.mass.actions.approval.process")]));if(void 0!==s.isWfTriggered&&1==s.isWfTriggered)return void showMassActionRelatedRulesPop(I18n.getMsg("crm.mass.actions.rules.alert.content",[I18n.getMsg("crm.mass.actions.workflow.rules")]));if(void 0!==s.approvalProcessTriggered&&1==s.approvalProcessTriggered)return void showMassActionRelatedRulesPop(I18n.getMsg("crm.mass.actions.rules.alert.content",[I18n.getMsg("crm.mass.actions.approval.process")]));if(1==s.exceededRecordLimit);else if(void 0!==s.isWfTriggered&&0==s.isWfTriggered)commonUtils.showHideLoadingDiv(),hideAnimatePopup("bulkUpdateFldsListForScheduler"),renderingUtils.removeFreezeLayer();else{if(1==s.isScheduledMassOperation||"true"==s.isScheduledMassOperation){if(commonUtils.showHideLoadingDiv(),renderingUtils.removeFreezeLayer(),renderingUtils.hideFreezeLayer(),hideAnimatePopup("massActionWorkFlowPopUp"),hideAnimatePopup("bulkUpdateFldsListForScheduler"),"listview"==a.from?1==s.success?crmListView.reloadCurrentListView(void 0,void 0,!0):crmListView.reloadCurrentListView():(crmListView.checkAll(),showHideListViewBtnFn(),crmListView.selectAllEntity("",$(".selCountIcon dIB"))),0==s.isValidInterval)return;if(1==s.success){var m=I18n.getMsg("crm.mass.actions.mass.update.job");m=s.isQueued?m+" "+I18n.getMsg("crm.mass.actions.scheduled.submit"):m+" "+I18n.getMsg("crm.mass.actions.scheduled.success"),crmui.showMsgBand("success",m,4e3,"");var p=$("#selectAllRecords");p.length>0&&(p.hide(),customViewObject.moreActions.push("hideSelectAllRecords")),customViewObject.showSelectAll=!1,crmListView.setHideActionInModule()}else if(1==s.jobRunningForCvid)crmui.showMsgBand("info",I18n.getMsg("crm.mass.actions.cv.running"),4e3,"");else{var g=I18n.getMsg("crm.mass.actions.update"),f=I18n.getMsg("crm.mass.actions.scheduled.fail",[g]);crmui.showMsgBand("error",f,18e4,"")}return}if("false"==s.error||"listview"==a.from){if(isWFSchedulerUser()&&s.isWFScheduler&&null!=o&&!o){var v=a.idlist.split(";").length,C=s.wfOffloadedJobid;detailView.currWFOffloadingJobIds.push(C),detailView.isMassupdatePopupLoading=!0;var h=automationActionsNotificationScheduler.setTimeoutForAutomationActionsOffload(v);return void setTimeout((function(){detailView.isMassupdatePopupLoading&&(detailView.isMassupdatePopupLoading=!1,automationActionsNotificationScheduler.showNotificationInProgress(C))}),h)}if("listview"==a.from)crmListView.reloadCurrentListView();else crmTab.deleteFromCache(e),Lyte.Router.getRouteInstance().refresh({refreshTemplate:!0}).data={clearCache:!0,refreshTemplate:!0}}else u=s,crmListView.createTemplate(s)}}if(void 0===s.isWfTriggered||0==s.isWfTriggered){crmTab.putInCache(e,u),crmTab.updateTabContent(e);var b=$("#checkAll");b.attr("class","customCheckBoxChecked")&&b.attr("class","customCheckBox"),commonUtils.showHideLoadingDiv(),hideAnimatePopup("bulkUpdateFldsListForScheduler",!0),renderingUtils.removeFreezeLayer()}if(!(!o&&0==i.length||o&&l<Crm.massOperationUserThreadLimit))return doMassUpdate(e,t,a,i,r);o&&overLayForSelectAllClick(!1),"string"==typeof s.responseText&&-1!=s.responseText.indexOf("CRM_ERROR_PAGE_500")?crmui.showMsgBand("error",I18n.getMsg("crm.unable.to.process.request"),"4000",""):crmui.showMsgBand("success",updatedsuccesfully,"4000",""),Macro.autoSuggest(e,!1),crmListView.startIndex={}},error:function(e){555===e.status&&(commonUtils.showHideLoadingDiv(),renderingUtils.removeFreezeLayer(),renderingUtils.hideFreezeLayer(),hideAnimatePopup("massActionWorkFlowPopUp"),hideAnimatePopup("bulkUpdateFldsListForScheduler"),crmui.showMsgBand("error",e.responseText,"4000",""))}})}function showMassActionRelatedRulesPop(e){commonUtils.showHideLoadingDiv(),renderingUtils.removeFreezeLayer(),hideAnimatePopup("bulkUpdateFldsListForScheduler",!1),$("#ruleNamesForMassActions").text(e),showAnimatePopup("massActionWorkFlowPopUp"),$("#muBtnLayerModal").css({display:"",visibility:"visible"})}function showMassDeleteRelatedRulesAlert(e){commonUtils.showHideLoadingDiv(),renderingUtils.removeFreezeLayer(),hideAnimatePopup("deletepopup",!1),$("#ruleNamesForMassActions").text(e),showAnimatePopup("massActionWorkFlowPopUp")}function showTransferRelatedRulesAlert(e){renderingUtils.hideFreezeLayer(),hideAnimatePopup("changeOwnerPopup",!1),$("#ruleNamesForMassActions").text(e),showAnimatePopup("massActionWorkFlowPopUp"),renderingUtils.hideFreezeLayer(),renderingUtils.removeFreezeLayer()}function navigate(e,t,a,i,r,l){"next"==r?(a+=10,i+=10):(a-=10,i-=10),crmNavig.checkForNavigReq("gsearch",t,a,10,(function(){httpHandle=getHTTPObject(),httpHandle.open("POST",e,!0),httpHandle.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),httpHandle.onreadystatechange=function(){if(4==httpHandle.readyState){var e=httpHandle.responseText;if(200==httpHandle.status){var i=getObj("ajax_"+t);$(i).empty(),i.innerHTML=e,JSEvalScript(i),$("#ajax_"+t+" #navigationNextIcon").hasClass("nextDisabled")?(jarr.isLast=!0,crmNavig.assignNavigCacheData("gsearch",t,a,10,jarr)):(jarr.isLast=!1,crmNavig.assignNavigCacheData("gsearch",t,a,10,jarr))}else if(httpHandle.status==crmConstants.errorStatusCode)return void renderingUtils.displayPermissionDenied(httpHandle)}},httpHandle.send("ajaxSearch=true&")}),(function(e){var r=$("#tmpl_"+t).html(),s=Handlebars.compile(r),o=$("#ajax_"+t),n=o.find("#gsearchTable"),d=o.find("#toindex"),c=o.find("#navigationPrevIcon"),u=o.find("#navigationNextIcon");n.find(".topband_dv_row").remove(),n.append(s(e));var m=i-a+1;o.find("#fromindex").text(a),d.text(i);var p=Crm.getCrmBasePath()+"/GSearch.do?mod_"+t+"=true&searchCategory=AllEntities&userOption="+(null==userOption?userOption:encodeURIComponent(crmHistory.getState().data.userOption))+"&searchword="+encodeURIComponent(l)+"&sModules="+t+"&isNavigate=true";a>10?(c.removeClass("previous_disabled"),c.addClass("previous"),$("#navigatePrev"+t).attr("onclick","javascript:navigate('"+Crm.getCrmBasePath()+"/NavigateByRecords.do?totalRecords="+m+"&fileName="+$ESAPI.encoder().encodeForJavaScript(p)+"&toIndex="+i+"&fromIndex="+a+"&currentOption=10&previous.x=x','"+encodeURIComponent(t)+"',"+a+","+i+",'previous')")):(c.addClass("previous_disabled"),c.removeClass("previous"),$("#navigatePrev"+t).removeAttr("onclick")),!0===e.isLast?(u.removeClass("next"),u.addClass("nextDisabled"),$("#navigateNext"+t).removeAttr("onclick"),d.text(i+e.length-10)):(u.addClass("next"),u.removeClass("nextDisabled"),$("#navigateNext"+t).attr("onclick","javascript:navigate('"+Crm.getCrmBasePath()+"/NavigateByRecords.do?totalRecords="+m+"&fileName="+$ESAPI.encoder().encodeForJavaScript(p)+"&toIndex="+i+"&fromIndex="+a+"&currentOption=10&next.x=x','"+encodeURIComponent(t)+"',"+a+","+i+",'next')"))}),!1)}function putGsearchOnHistory(){var e=getObj("searchStr").value,t=getObj("userOption").checked,a="ajaxSearch=true&searchword="+encodeURIComponent(e)+"&userOption="+t+"&searchCategory=AllEntities";putInHistory("Gsearch_11","GSearch|?"+a)}function populateCommentSection(e){var t=$("#value_COMMENTCONTENTS"),a=t.html();return t.html(e+a),CScriptLib&&"undefined"!=typeof DetailViewHandler&&"crm.tab.module.entity.detail"===Lyte.Router.getRouteInstance().transition.info.route&&detailView.cscriptFieldAttribs.Comments&&DetailViewHandler.field_style_add.call({field_name:"Comments",style_config:detailView.cscriptFieldAttribs.Comments.style}),""}function replace4Skype(e){return e=(e=(e=e.replace(/ /gi,"")).replace("(","")).replace(")","")}function submitMergeForm(e){var t=Crm.getCrmBasePath()+"/MailMerge.do?action=mergeRecords",a=document.allMailMergeForm;if(validateFile())if(null!=a.openfilein[0]&&a.openfilein[0].checked)if("zoho"==a.openfilein[0].value){var i=commonUtils.formData2QueryString(a);closeDashletDiv("lookupdiv"),sendMergeRequestToWriter(t,i,e)}else"msword"==a.openfilein[0].value&&(a.action=t,a.submit());else if(null!=a.openfilein[1]&&a.openfilein[1].checked)if("zoho"==a.openfilein[1].value){i=commonUtils.formData2QueryString(a);closeDashletDiv("lookupdiv"),sendMergeRequestToWriter(t,i,e)}else"msword"==a.openfilein[1].value&&(a.action=t,a.submit());else if(null!=a.openfilein&&a.openfilein.checked)if("zoho"==a.openfilein.value){i=commonUtils.formData2QueryString(a);closeDashletDiv("lookupdiv"),sendMergeRequestToWriter(t,i,e)}else"msword"==a.openfilein.value&&(a.action=t,a.submit())}function validateFile(){return""!=getObj("mailMergeListId").value||(alert("Please choose Mailmerge document"),!1)}function updateHomeCurrency(e){var t=document.getElementById(e),a=commonUtils.formData2QueryString(t);return a=a.replace(/_back/g,""),doAjaxUpdate("result",t.action,a,(function(){renderingUtils.removeFreezeLayer()})),!1}function validateERate(e){var t=e.value,a=document.getElementById("save_bbtn");""==t||isNaN(t)?a.setAttribute("disabled","disabled"):parseFloat(t,10)>0?a.removeAttribute("disabled"):a.setAttribute("disabled","disabled")}function showHideDivSpan(e,t){var a=e.split(";");for(var i in a){var r=document.getElementById(a[i]);r&&(r.style.display=t,"currFrmtDiv_front"!==a[i]&&"currFrmtDiv_back"!==a[i]||(thirdPartyUtils.bindSelect2($("#crn_fui, #crn_fuiT, #currFrmtDiv_front").find(".newSelect select")),select2ChangesInFields($(r))),crmui.modalZIndex("nonLyte",r,"open","noFreeze"))}}var sendMergeRequestToWriter=function(e,t,a){mR(e,(function(e){0==e.indexOf("https")?window.open(e):0==e.indexOf("ERROR:::")?renderingUtils.showCustomAlert(e.split("ERROR:::")[1]):renderingUtils.showCustomAlert(a)}),t)};function changeSubValueId(e,t){var a=e;return t&&t[0].id!=t[1].id&&(a=e.replace("subvalue_","subvalue1_")),a}function scrollDivLeft(e,t){creator_scroll_div_width<300&&(creator_scroll_div_width=300*t-601),getObj("rightImgId").style.visibility="visible";document.getElementById(e).scrollLeft+=300,(creator_scroll_div_width-=300)<300&&(getObj("leftImgId").style.visibility="hidden")}function scrollDivRight(e){var t=document.getElementById(e).scrollLeft;getObj("leftImgId").style.visibility="visible";document.getElementById(e).scrollLeft-=300,creator_scroll_div_width+=300,t-300<300&&(getObj("rightImgId").style.visibility="hidden")}function checkAll(e){var t=document.getElementsByName(e).length;if(null==t)getObj(e).checked=!0;else for(var a=0;a<t;a++)document.getElementsByName(e)[a].checked=!0}function unSelectAll(e){var t=document.getElementsByName(e).length;if(null==t)getObj(e).checked=!1;else for(var a=0;a<t;a++)document.getElementsByName(e)[a].checked=!1}function updateTabGroup(){store.unloadAll("tab_group");var e=document.querySelector("crm-left-menu");e&&e.component&&(e.getData("showToggleMenu")&&$L("#leftMenuLoader").show(),e.component.setData("renderTabGroup",!1)),store.findAll("tab_group").then((function(t){if(featuresAvailable.NEXTGENUI_ENABLED)e.component.setData("renderTabGroup",!0),e.getData("showToggleMenu")&&$L("#leftMenuLoader").hide();else{var a,i,r=document.getElementsByTagName("crm-tab-group")[0],l=document.getElementsByTagName("crm-tab")[0],s=document.querySelector("crm-menu");if(t&&1===t.length)return l.setData("tabModules",t[0].modules.sortBy("sequence_number")),void s.setData("showTabGroup",!1);s.setData("showTabGroup",!0),r&&(r.setData("tabGroupsName",t),a=r.getMethods("changeTabGroup")),r&&(i=r.getData("tabGroupsSelectedItem"));for(var o=0;o<t.length&&(!i||i!=t[o].id)&&(!t[o].default||null!=(i=t[o].id));o++);l&&i&&a&&a.call(r,null,i)}}))}function editTabGroup(e){var t=Crm.getCrmBasePath()+"/CustomizeTabGroup.do?action=editTabGroup&tabGroupId="+e,a=$("#topBandPopup");a.is(":visible")?t+="&isFrom=popup":t+="&isFrom=setup",mR(t,(function(e){if(e.includes("The action that you intend to perform is not possible"))$("#show").html(e);else{e='<div class="pR"><span onclick="hideAnimatePopup(\'topBandPopup\');" id="popup_editTabGroup" style="float:right;display:block;right: 20px;top: 20px;z-index: 1;" class="newPopupCloseIcon svgIcons ico-close-small2 cP op8 pA"></span></div><div id="result">'+e+"</div>",a.html(e),$("#popup_createTabGroup").parent().hide(),showAnimatePopup("topBandPopup");var t=$('[name=CustomizeTabGroupForm] [data-zcqa="btn_tab_cancel"]');"popup"===$("#tabGroup input[name='isFrom']").val()?t.attr("onclick","showCustomizePopup('tabGroupList','popup')"):t.attr("onclick","hideAnimatePopup('topBandPopup');"),setTimeout((function(){getObj("tabGroupName")&&getObj("tabGroupName").focus()}),500)}}))}function deleteTabGroup(){var e=getObj("deleteTabName").value.split("_"),t=e[0],a={},i={key:"alltabgroups"};i.label=I18n.getMsg("crm.tabgroup.label.AllAccessibleTabs"),renderingUtils.removeFreezeLayer(),commonUtils.showHideLoadingDiv(!0);a="action=deleteTabGroup&tabGroupName="+e[1]+"&"+csrfParamName+"="+encodeURIComponent(csrfToken);var r=JSON.parse('{"id":'+JSON.stringify(e[0])+',"currentdepartment":'+JSON.stringify(i)+"}"),l=Crm.getCrmBasePath()+"/CustomizeTabGroup.do";mR(l,(function(e){var l=$("lyte-menu-item[id='"+e+"']"),s=l.length>0?l.find("span"):void 0,o=$(s).css("visibility");if(-1!=e.indexOf("SECURITY_ERROR_403::::INSUFFICIENT")||-1!=e.indexOf("CRM_ERROR_PAGE_500"))return renderingUtils.showCustomAlert(I18n.getMsg("crm.maximum.request.limit")),void $("#TabGroupWarningDiv").hide();null!=s&&"visible"===o?(changeMyTabGroup("0"),a.currentdepartment=i):($("tr[id="+e+"]").remove(),$("#tabGroupListTable tr").length<2&&($("#tabGroups #tabGroupListTable").hide(),$("#emptyTabGroup").show()),updateTabGroup()),a.id=t,crmplusImplTriggerActions("removeUIElement",["department",r]);var n=document.getElementsByTagName("crm-tab-group")[0];n&&(n.getData("tabGroupsSelectedItem")==t&&"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()&&Utils.windowLocationReload())}),a)}function showHideNewTabGroup(e,t){var a="";if("new"==t?a=document.newCreatorApp:"old"==t&&(a=document.myCreator),"none"!=getObj("tabGroupDivWithSelect").style.display){var i=a.existingTabGroups.selectedIndex;"cntg"==a.existingTabGroups.options[i].value&&(e<10?(getObj("createtabGroupDiv").style.display="block",getObj("tabGroupDivWithSelect").style.display="none"):(renderingUtils.showCustomAlert(I18n.getMsg("crm.creator.label.tabgroup.error.maxexceeded")),a.existingTabGroups.value="0"))}else"none"!=getObj("createtabGroupDiv").style.display&&(getObj("createtabGroupDiv").style.display="none",getObj("tabGroupDivWithSelect").style.display="block",getObj("existingTabGroups").value="0")}function checkTabGroupSpecialChar(e){for(var t=new Array("`","~","!","#","^","*","[","]","{","}","|","\\",'"',";","'","&","+","%","(",")","@","_","?","<",">"),a=e.length,i=0;i<a;i++)if(-1!=t.toString().indexOf(e.charAt(i)))return!1;return!0}function checkTabGroupFields(e){buildTabGroup();var t=getObj("tabGroupName").value.trim(),a=$("#topBandPopup"),i=!0;if(""==t.trim())return getObj("tabGroupName").focus(),renderingUtils.showCustomAlert(I18n.getMsg("crm.tabgroup.name.check")),a.addClass("moveBackToTheFreeze"),!1;if(!checkTabGroupSpecialChar(t))return renderingUtils.showCustomAlert(I18n.getMsg("crm.tabgroup.name.specialCharacter")),i=!1,a.addClass("moveBackToTheFreeze"),!1;var r=Crm.getCrmBasePath()+"/CustomizeTabGroup.do?action=validateTabGroupName&tabGroupName="+t+"&tabGroupId="+e;return mR(r,(function(r){if("true"==r)renderingUtils.showCustomAlert(I18n.getMsg("crm.tabgroup.error.duplicateName")),document.getElementsByName("tabGroupName")[0].focus(),a.addClass("moveBackToTheFreeze");else{if(t.length>25)return renderingUtils.showCustomAlert(I18n.getMsg("crm.tabgroup.name.lengthcheck")),i=!1,a.addClass("moveBackToTheFreeze"),!1;if(1==i){var l=commonUtils.formData2QueryString(document.CustomizeTabGroupForm);mR(getAttr(document.CustomizeTabGroupForm,"action"),(function(t){if(-1!=t.indexOf("SECURITY_ERROR_403::::INSUFFICIENT")||-1!=t.indexOf("CRM_ERROR_PAGE_500"))return renderingUtils.showCustomAlert(I18n.getMsg("crm.maximum.request.limit")),void a.addClass("moveBackToTheFreeze");if(-1!=t.indexOf("DUPLICATE TABGROUP"))return renderingUtils.showCustomAlert(I18n.getMsg("crm.tabgroup.error.duplicateName")),document.getElementsByName("tabGroupName")[0].focus(),void a.addClass("moveBackToTheFreeze");if(-1!=t.indexOf("TABGROUPLIMITEXCEED"))return renderingUtils.showCustomAlert(I18n.getMsg("crm.massmail.limit.title")),void a.addClass("moveBackToTheFreeze");if(t=JSON.parse(t),"manage"===$("[name='isFrom']").val()||"setup"===$("[name='isFrom']").val()){var i="<tr id='"+t.tabGroupId+'\' class="topband_dv_row"><td nowrap align="center"><a class="link neweditIcon dIB" href="javascript:editTabGroup(\''+t.tabGroupId+'\')"></a><span class="sep"></span><a class="link deleteIcon dIB" href="javascript:" onclick="javascript:openWarningMessage(\'deleteTabGroup\',\''+t.tabGroupId+"_"+$ESAPI.encoder().encodeForHTML(t.tabGroupName)+"', this);\" data-onclick=\"deleteTabGroup(); hideAnimatePopup('deletepopup');\"></a></td><td nowrap>"+$ESAPI.encoder().encodeForHTML(t.tabGroupName)+"</td><td>"+$ESAPI.encoder().encodeForHTML(t.tabNameList)+"</td></tr>";if($("tr[id="+t.tabGroupId+"]").length>0)$("tr[id="+t.tabGroupId+"]").replaceWith(i);else{var r=$("#tabGroupListTable");r.is("visible")||($("#tabGroups #tabGroupListTable").show(),$("#emptyTabGroup").hide()),r.append(i)}}if(updateTabGroup(),hideAnimatePopup("topBandPopup"),$("#errorMsgDiv").html(I18n.getMsg("crm.entity.add.success",I18n.getMsg("crm.tabGroup"))).show().fadeOut(3e3),"new"==$("#tabGroupType").val()){var l=[],s={};s.key=t.tabGroupId,s.label=t.tabGroupName,l.push(s);var o=["department",{list:l,isnewdepartment:!0,cansetselected:!1}];crmplusImplTriggerActions("modifyUI",o)}else{o=["department",t.tabGroupId,t.tabGroupName];var n=featuresAvailable.NEXTGENUI_ENABLED?document.querySelector("crm-left-menu-tabgroups"):document.getElementsByTagName("crm-tab-group")[0],d=featuresAvailable.NEXTGENUI_ENABLED?n&&n.component?n.component.getData("selectedTabGroupId"):"":n.getData("tabGroupsSelectedItem");crmplusImplTriggerActions("updateField",o),d==e&&"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()&&Utils.windowLocationReload()}}),l),Crm.trackSpotLightAction("Tab Groups - New Tab Group Created")}}})),!1}function moduleFields(e,t,a,i,r){if(!Crm.userDetails.CLIENT_ACCOUNT){itsonview&&$("#saveCancelSpan").find('[value="Cancel"]').click();var l="",s=$("#labelTD_LAYOUTID").parent().data();void 0!==s&&(l=s.params.defaultid);var o=Crm.getCrmBasePath()+"/EntityFieldCustomize.do?action=getSummaryFieldJson&module="+a+"&layoutId="+l;if("false"==i||"true"==itsonedit)return!1;r||(e=escape(e));var n='<select id="textbox_fieldlabels" name="fieldlabels" onchange= "updateSummarySequence(this.options[this.options.selectedIndex].value,this.options[this.options.selectedIndex].text ,'+t+",'"+a+"','"+e+"');\">";e=unescape(e),mR(o,(function(i){var r=jsonFields=jQuery.parseJSON(i),l=r.I18NFields,s=r.FieldId,o=r.colname;r.uiType;"SCORE"===o&&(l.splice(l.indexOf("Score"),1),o.splice(o.indexOf("SCORE"),1)),globalvaluespanid="headervalue_"+e,globallabelspanid="headerlabel_"+e;var d=$("#"+globallabelspanid),c=d.text();c=c.replace("&amp;","&");var u,m=l.length;if(CScriptLib){const e=Object.keys(detailView.cscriptFieldAttribs).filter((e=>!1===detailView.cscriptFieldAttribs[e].visible));e.length&&(u=[],Object.keys(returnJson.entityMapJson).forEach((t=>{e.includes(returnJson.entityMapJson[t].sysRefName)&&u.push(returnJson.entityMapJson[t].colname)})))}for(var p=0;p<m;p++){var g=l[p],f=o[p];if(!(jsonFields.CurrentFields.indexOf(f)>-1&&trimBoth(f)!==trimBoth(e))&&!(CFRExec&&CFRExec.isLayoutRuleHiddenElem(f)||CScriptLib&&u&&u.length&&u.includes(f)||"Connected To"===g&&"SEID"===f)){var v=s[p];trimBoth(f)==trimBoth(e)?n+='<option value="'+v+'" col="'+f+'" selected>':n+='<option value="'+v+'" col="'+f+'">',n+=""+g,n+="</option>"}}n+="</select>",e=escape(e),n+='<a href=javascript:; id="summaryEdit" onclick="clearSummaryEdit(\''+e+"','"+t+"','"+a+"','True');\"></a>",$(d[0]).empty(),d[0].innerHTML=n;var C=$("#textbox_fieldlabels");thirdPartyUtils.bindSelect2(C),C.closest("td").addClass("selectBoxSelect2"),$(".newBusinessCardView").addClass("bCLeftPanelEditOpen"),setTimeout((function(){$(C).select2("open")}),30),C.next().trigger("mousedown"),itsonedit="true",hide("summaryfield")}))}}function updateSummarySequence(e,t,a,i,r){var l=document.getElementById("textbox_fieldlabels"),s=l.options[l.selectedIndex].getAttribute("col"),o=void 0,n=jsonFields,d=n.CurrentFields,c=n.FieldId,u=n.colname,m=u.length;if("SMOWNERID"===(r=unescape(r))&&"SMOWNERID"!==s){var p=$L("#otherRecommendationZiaIconBC")[0];p&&p.parentNode.parentNode.remove()}for(var g=r.replace(/_____/g,")").replace(/____/g,"(").replace(/___/g,"."),f=0;f<m;f++){var v=r;if(u[f]==v){o=c[f];break}}for(var C=d.length,h=0;h<C;h++)if(d[h]==s){renderingUtils.showCustomAlert(I18n.getMsg("crm.summary.same.field.alert",t));var b=$("#textbox_fieldlabels");return b.val(o),b.select2("close"),b.select2("destroy"),document.getElementsByTagName("body")[0].click(),!1}var y=Crm.getCrmBasePath()+"/Security.do?actionName=updateSS",I="sequence="+a+"&module="+i+"&selectedfieldId="+e+"&oldfieldId="+o+"&"+csrfParamName+"="+encodeURIComponent(csrfToken)+"&entityId="+$("[name='id']").val();mR(y,(function(){void 0!==CFRExec&&CFRExec.handleBusinessCardFields()}),I),globallabelspanid="headerlabel_"+r;var _="header_"+r,E=getObj("historyFrame"),w=null;w=E.contentDocument?E.contentDocument:E.contentWindow?E.contentWindow.document:E.document;var T,L=s.replace(/\./g,"___").replace(/\(/g,"____").replace(/\)/g,"_____"),O=unescape("mouseArea__"+L),M=$("#mouseArea__"+L).data("params");if(Crm.userDetails.isSubformNewComponentEnabled){var D=store.peekRecord("field",e);if(D&&D.subform&&500!==D.ui_type&&returnJson&&returnJson.entityMapJson){var A=returnJson.entityMapJson;M=A[D.column_name];var S=store.peekRecord(moduleRecordMapping[detailView.currentModule].id,detailView.entityId)[D.api_name];if((S=S||0===S?S:"")&&"currency"===D.data_type){var R=featuresAvailable.MultiCurrency,U=Crm.userDetails,N=A&&A.CURRENCYISOCODE?A.CURRENCYISOCODE.defaultvalue:U.BASE_CURRENCY?U.BASE_CURRENCY:void 0;S=R&&void 0!==Crm.userDetails.CURRENCY_DETAILS[N]?A.EXCHANGERATE&&A.EXCHANGERATE.defaultvalue?currencyUtils.returnValueInDefaultCurrency(N,S,Crm.userDetails.CURRENCY_DETAILS[N].decimals,parseFloat(A.EXCHANGERATE.defaultvalue)):currencyUtils.returnValueInDefaultCurrency(N,S,Crm.userDetails.CURRENCY_DETAILS[N].decimals):currencyUtils.returnValueInDefaultCurrency(N,S)}else S&&D.separator&&(S=Lyte.Component.registeredHelpers.formatNumber(S.toString()));T='<span data-zcqa="value_'+D.field_label+'" id="subvalue_'+D.column_name+'">'+S+"</span>"}}var P="";!M||"3"!==M.uitype&&"110"!==M.uitype||(P="textarea_multilineFldTD");var x="<table id='tab'><tr><td id=\"header_"+L+'" class="dvValueTxt bcEditIcon '+P+' dblClk smartPromptEl smartPromptBefore" onMouseOver="detailView.mouseover(\'#'+O+"','true')\" onFocusIn=\"detailView.mouseover('#"+O+'\',\'true\')" onMouseOut="hide(\'crmspanid\')" onFocusOut="hide(\'crmspanid\')" role="button" lt-prop-aria-keydown="true" tabindex="0"><span id="headermouseArea__'+L+'" style="display: inline;"></span><span id="headervalue_'+L+'" style="display: inline-block;"></span><span id="headertextarea_'+L+'"></span></td></tr></table>';w.open(),w.write(x),w.close();var V=w.getElementById("tab").firstChild.firstChild.childNodes[0],k=getObj(_).parentNode;k.removeChild(getObj(_)),k.appendChild(V.cloneNode(!0));var F=M&&"1"===M.tooltiptype?"bcShowInfoIcon":"",B="<table id='tab1'><tr><td id=\"headerlabel_"+L+'"  class="bcDropDownTd alignLeft pR" width="120" name="fieldlabel" onclick= "moduleFields(\''+escape(s)+"',"+a+",'"+i+"','True','True');\" onmouseover=\"summaryEditMouseOver('"+escape(L)+"',"+a+",'"+i+"','True');\" onfocusin=\"summaryEditMouseOver('"+escape(L)+"',"+a+",'"+i+'\',\'True\');"  onmouseout="hide(\'summaryfield\');" onfocusout="hide(\'crmspanid\')" onclick="sE(event);" role="button" lt-prop-aria-keydown="true" tabindex="0"><span class="bcDropDownIcon '+F+' fL">';if(Crm.userDetails.DV_MANDATORY_FIELD_ASTERIX_SYMBOL){var j=returnJson.entityMapJson[L]&&"true"===returnJson.entityMapJson[L].mandate;!j&&CFRExec.lrMandatoryElem&&-1!==CFRExec.lrMandatoryElem.indexOf(L)&&(j=!0),B+=" <span id='mandate_ast_"+L+"_header' class='dvNewMandateAst "+(j?"":"dN")+"'>*</span> "}if(B+=$ESAPI.encoder().encodeForHTML(t)+"</span>",M&&"1"===M.tooltiptype){var H="<span class='businessCardTooltipCont mT8 dIB'>";["111","116","133"].contains(M.uitype)?H+="<i class='icon_roundinfo infotoolTip mL5 dIB vaM cP infoTTShow' lt-prop-title='"+M.tooltipcontent+"'></i></span>":H+="<i class='icon_roundinfo infotoolTip mL5 dIB vaM cP' lt-prop-title='"+M.tooltipcontent+"'></i></span>",B+=H}B+="</td></tr></table>",w.open(),w.write(B),w.close();var J="headerlabel_"+r,G=w.getElementById("tab1").firstChild.firstChild.childNodes[0],z=getObj(J).parentNode;$("#textbox_fieldlabels").select2("close"),$(getObj(J)).empty(),z.removeChild(getObj(J)),$(G).removeClass("alignLeft").addClass("labelTab"),$(G).find("span").removeClass("fL"),z.insertBefore(G.cloneNode(!0),z.firstChild);var q="value_"+L,W=$("#"+("headervalue_"+L));crmTemplate.bindFldTooltip(),"SMOWNERID"===s&&(M.zia_owner_assignment=$("#ownerName_id").data("params").reqFrom),detailView.changedBCJson.BCViewObject[detailView.BCkeyVsArrayIndex[r]]=M,detailView.BCkeyVsArrayIndex[L]=detailView.BCkeyVsArrayIndex[r],delete detailView.BCkeyVsArrayIndex[r],$(W[0]).empty(),"SMOWNERID"===s&&"SMOWNERID"!==r&&"assigned_by_zia"===M.zia_owner_assignment?W[0].innerHTML='<span id="headervalue_SMOWNERID" class="busniess_card_Hover formatLtr w100_per"><span class="bCardHover cDefault w100_per" purpose="showUserBC" data-params="{&quot;userId&quot;:&quot;'+M.defaultid+'&quot;,&quot;reqFrom&quot;: &quot;assigned_by_zia&quot;}" id="ownerName_id" data-zcqa="" onmouseover="detailView.showZiaReasoningPopover(\'aBZiaIconBC\' , \''+i+'\', \'show_reasoning\')"><span id="aBZiaIconBC" class="w100_per"><crmutil-icon icon-name="zia-logo" icon-class="zcicn-zia-logo zcicn_4a8de9 mR4" class="zRspacing"></crmutil-icon><span id="aBZPopBC" class="ziaAssignMax"><lyte-text lt-prop-value=\''+M.defaultvalue+"'></lyte-text></span></span></span><a class=\"crmLinkColor cP accessibility-route-elem\" id=\"changeOwnerIco\" href=\"javascript:void(null)\" onclick=\"newShowLookUp('ownerName','ownerId','AssignedTo','ownername','fromentityview','','',$('#cvid').val(),'null','','"+M.defaultid+"','','',$('#module').val())\"></a></span>":"250"===M.uitype?(W[0].append(crmTemplate.createFieldViewContentForRTF(M)),"true"==M.readonly&&M.defaultvalue&&W.addClass("rtfLockIcon")):"Tasks"===i&&"CONTACTID"===M.colname&&"Leads"===M.lookupmodule||(W[0].innerHTML=$("[id='"+q+"']").html(),T&&(W[0].innerHTML=T)),$(W[0]).closest("td").addClass("labelVal").attr({onclick:"triggerClickEvent(event)","data-uitypesele":M.uitype}),$(W[0]).closest("td").find("span:first").css("padding","0"),"true"===M.isaggrfield&&W.addClass("agrFld"),"250"===M.uitype&&(W.closest("td").addClass("rtfLabelValBc"),"Tasks"===i&&W.closest("td").addClass("rtfTask"));var Y=$("#changeOwnerIco");""===W.html().trim()&&W.addClass("forceHyphen"),"8"==M.uitype&&0===W.find("#changeOwnerIco").length&&Y.length>0&&W.after(Y.clone()),W.addClass("busniess_card_Hover w100_per"),"true"==M.readonly&&W.addClass("lockIconBC"),"LAYOUTID"==M.colname&&returnJson.layout_jsonarrayObj.showLayoutOption&&W.removeClass("lockIconBC");for(var Q=0;Q<C;Q++)d[Q]==g&&(d[Q]=s);jsonFields.CurrentFields=d,$(".newBusinessCardView").removeClass("bCLeftPanelEditOpen"),itsonedit="false",crmLookupBusinessCard.result=null}function summaryEditMouseOver(e,t,a,i){if(Crm.userDetails.permissions.Crm_Implied_Customize_Zoho_CRM){$(".kv_detailview").outerWidth();if("false"==i||"true"==itsonedit||Crm.userDetails.CLIENT_ACCOUNT||detailView.isSubformAjaxOpened)return!1;var r;r="headerlabel_"+(e=unescape(e)),show("summaryfield");var l=getObj("summaryfield"),s=$(getObj(r)),o=s.find("span.bcDropDownIcon"),n=$("#dv-button-layer"),d=$(".kanbanTaskDetailContainer"),c=";",u=n.outerHeight(),m=document.getElementById("show").offsetLeft,p=document.getElementById("iskanbanview");p&&"true"===p.value?(c=o.offset().top-renderingUtils.tabLayerOuterHeight(),1==Crm.userDetails.detailView_newUI&&null!=Crm.userDetails.detailView_newUI&&(c=o.offset().top-renderingUtils.tabLayerOuterHeight())):c=o.offset().top-2,n.length&&$("#DetailViewInnerTabs").length&&1==Crm.userDetails.detailView_newUI&&("undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()?c-=u:c-=u+renderingUtils.tabLayerOuterHeight());var g=o.offset().left,f=$L("#"+r).find("span.bcDropDownIcon").outerWidth();if($(l).off("click").click((function(){moduleFields.apply(moduleFields,[e,t,a,i])})),Crm.userDetails.RTL_ENABLED)l.style.left=g+10+"px";else if(s.find("span").hasClass("bcDropDownIcon")){if(p&&"true"===p.value)v=g+f-15;else var v=g+f-15;l.style.left=v-m+"px",d.length&&(l.style.left=v-m+"px")}else l.style.left=g+o.offsetWidth+"px";l.style.top=c+16+"px";var C=$(".bCardHover");if("yes bCardHover"!=C.attr("class")&&"no-new bCardHover"!=C.attr("class")){var h=$("#"+r).next("td");0==h.find(".busniess_card_Hover").hasClass("lockIconBC")&&""==h.find(".bCardHover").html()?h.find(".bCardHover").addClass("bCardHoverLeft"):0==h.find(".busniess_card_Hover").hasClass("lockIconBC")&&""==h.find(".bCardHover>span").html()&&h.find(".bCardHover>span").addClass("bCardHoverLeft"),0==h.find(".busniess_card_Hover").hasClass("lockIconBC")&&""==h.find(".bCardHover>pre").html()&&h.find(".bCardHover>pre").addClass("bCardHoverLeft"),0==h.find(".busniess_card_Hover").hasClass("lockIconBC")&&""==h.find(".bCardHover .link").html()?h.find(".bCardHover .link").addClass("bCardHoverLeft"):$(".lockIconBC").css("position","relative")}}}function clearSummaryEdit(e,t,a){var i=(e=unescape(e)).replace(/\./g,"___").replace(/\(/g,"____").replace(/\)/g,"_____"),r=getObj("historyFrame"),l=null;r.contentDocument?l=r.contentDocument:r.contentWindow&&(l=r.contentWindow.document);var s=getObj("textbox_fieldlabels"),o=s[s.selectedIndex].text,n=$("#mouseArea__"+i).data("params");!n&&Crm.userDetails.isSubformNewComponentEnabled&&returnJson&&returnJson.entityMapJson&&("true"===returnJson.entityMapJson[i].isaggrfield||!0===returnJson.entityMapJson[i].isaggrfield)&&(n=returnJson.entityMapJson[i]);var d="",c="";"1"===n.tooltiptype&&(d="111"===n.uitype||"116"===n.uitype||"133"===n.uitype?'<span class="businessCardTooltipCont mT8 dIB">  <i class="icon_roundinfo infotoolTip mL5 dIB vaM cP infoTTShow" lt-prop-title=\''+n.tooltipcontent+"' ></i> </span>":'<span class="businessCardTooltipCont mT8 dIB">  <i class="icon_roundinfo infotoolTip mL5 dIB vaM cP" lt-prop-title=\''+n.tooltipcontent+"' ></i> </span>"),c=d?"<table id='tab1'><tr><td id=\"headerlabel_"+i+'"  class="bcDropDownTd alignLeft pR" width="120" name="fieldlabel" onclick= "moduleFields(\''+escape(e)+"',"+t+",'"+a+"','True','True');\" onmouseover=\"summaryEditMouseOver('"+escape(i)+"',"+t+",'"+a+'\',\'True\');" onmouseout="hide(\'summaryfield\');" onclick="sE(event);"><span class="bcDropDownIcon bcShowInfoIcon fL">'+revertSplChrs(o)+"</span>"+d+"</td></tr></table>":"<table id='tab1'><tr><td id=\"headerlabel_"+i+'"  class="bcDropDownTd alignLeft pR" width="120" lt-prop-aria-keydown="true" role="button" tabindex="0" name="fieldlabel" onclick= "moduleFields(\''+escape(e)+"',"+t+",'"+a+"','True','True');\" onmouseover=\"summaryEditMouseOver('"+escape(i)+"',"+t+",'"+a+"','True');\" onmouseout=\"hide('summaryfield');\" onfocus=\"summaryEditMouseOver('"+escape(i)+"',"+t+",'"+a+'\',\'True\');" onblur="hide(\'summaryfield\');" onclick="sE(event);"><span class="bcDropDownIcon fL">'+revertSplChrs(o)+"</span></td></tr></table>",l.open(),l.write(c),l.close();var u="headerlabel_"+i,m=l.getElementById("tab1").firstChild.firstChild.childNodes[0];$(m).removeClass("alignLeft").addClass("labelTab"),$(m).find("span").removeClass("fL");var p=getObj(u).parentNode;p.removeChild(getObj(u)),p.insertBefore(m.cloneNode(!0),p.firstChild),crmTemplate.bindFldTooltip(),itsonedit="false"}function setDivWidthHeight(e){document.body.clientWidth;getObj(e).style.top="0px",getObj(e).style.width="850px",navigator.appName.indexOf("Internet Explorer"),getObj(e).style.height="550px"}function reloadRelatedList(e,t=!0){var a="false";if(0!=$("[name='rlContentChngd']").length&&(a=$("[name='rlContentChngd']").val()),"false"!==a||void 0!==e){var i=CustomRelatedListObj.getCurrentPageDetails("module"),r=CustomRelatedListObj.getCurrentPageDetails("entityId"),l=CustomRelatedListObj.getCurrentPageDetails("cvId");let e=$L("crm-related-list-view");e=e.length?e[0].component.data:{};let t=CustomRelatedListObj.getCurrentPageDetails("layoutId"),a=e.rlMetaData,s=CustomRelatedListObj.currentAction;const o=CustomRelatedListObj.PERSONALITY_NAME;let n=CustomRelatedListObj.currentRLId;const d=function(e,t,a){return t&&t.filter((t=>t.personality_name===a&&!e.find((e=>t.id===e.id))))},c=function(){commonUtils.showHideLoadingDiv(!1),app.store.makeRequest("findAll","related_list",{module:moduleApiMapping[i],layout_id:t},!1,!0,{record:store.peekRecord(moduleRecordMapping[i].id,r)}).then((function(e){let t=d(a,e,o);t&&t.length&&Lyte.injectResources(networkUtils.returnDependencyFiles(["crm-custom-rl.js","crm-custom-rl.css"],ResourceConstants.CRMClient),void 0,(function(){Lyte.triggerEvent("customRelatedListChanged",{action:"CREATE",customRelatedList:t[0]})}))})).finally((function(){commonUtils.showHideLoadingDiv(!1)}))},u=function(){commonUtils.showHideLoadingDiv(!1),app.store.makeRequest("findRecord","related_list",n,{module:moduleApiMapping[i],layout_id:t},!1,!0,{record:store.peekRecord(moduleRecordMapping[i].id,r)}).then((function(e){let t=e[0];Lyte.triggerEvent("customRelatedListChanged",{action:"UPDATE",customRelatedList:t,relatedListId:n})})).finally((function(){commonUtils.showHideLoadingDiv(!1)}))},m=function(){commonUtils.showHideLoadingDiv(!1),n&&Lyte.triggerEvent("customRelatedListChanged",{action:"DELETE",relatedListId:n})},p=function(){commonUtils.showHideLoadingDiv(!1),app.store.makeRequest("findRecord","related_list",n,{module:moduleApiMapping[i],layout_id:t},!1,!0,{record:store.peekRecord(moduleRecordMapping[i].id,r)}).then((function(e){let t=e[0];Lyte.registeredMixins["crm-related-list-utils"].open_act_personality.includes(t.personality_name)&&"Services"!==i||Lyte.registeredMixins["crm-related-list-utils"].closed_act_personality.includes(t.personality_name)?Lyte.triggerEvent("relatedList",{refresh:!0}):Lyte.triggerEvent("customRelatedListChanged",{action:"ADD",customRelatedList:t,relatedListId:n})})).finally((function(){commonUtils.showHideLoadingDiv(!1)}))};if("CREATE"===s?c.call(this):"UPDATE"===s?u.call(this):"DELETE"===s||"HIDE"===s?m.call(this):"ADD"===s&&p.call(this),CustomRelatedListObj.resetCustomRelatedListData(),!Crm.renderDVLyteFlow(i))loadRelatedListNew(Crm.getCrmBasePath()+"/NewRelatedList.do?action=getAllData&module="+i+"&id="+r+"&cvid="+l+"&updateLeftPanel=true",onCompleteFnRl,onSuccessFnRl,i,r)}t&&hideAnimatePopup("topBandPopup",!0),renderingUtils.removeFreezeLayer()}function showDefaultRelatedList(){var e=CustomRelatedListObj.getCurrentPageDetails("module"),t=CustomRelatedListObj.getCurrentPageDetails("entityId"),a=Crm.getCrmBasePath()+"/CustomizePage.do?module="+e+"&entityid="+t+"&from=frmCustomRL";mR(a,(function(e){$("#topBandPopup").html(e)}))}function validateSplCharInNameFields(e){for(var t=new Array("`","~","!","#","^","*","[","]","{","}","|","\\",'"',";","'","&","+","%","(",")","@","?",":","<",">",":",".",",","$","=","/","-","_"),a=t.length,i=0;i<a;i++)if(e.indexOf(t[i])>=0)return!0;return!1}function validateWhiteSpace(e){return e.indexOf(" ")>=0}function validateIsNumberAsFirstChar(e){for(var t=new Array("0","1","2","3","4","5","6","7","8","9"),a=t.length,i=0;i<a;i++)if(e.charAt(0)==t[i])return!0;return!1}function validateForForeignLanguage(e){return!new RegExp("^[a-zA-Z0-9_]*$").test(e)}function showMyRelatedListDiv(e,t){var a=getObj("pageNum_"+e).value,i=getObj("totalPageCount_"+e).value;if("prev"==t){var r=e+"_"+(a-2),l=e+"_"+(a-1);getObj(r).style.display="",getObj(l).style.display="none";var s=parseInt(a)-1;$("#"+e+"_from").html($("#"+e+"_from").html()-10),$("#"+e+"_to").html($("#"+e+"_to").html()-10)}else if("next"==t){r=e+"_"+(a-1),l=e+"_"+a;$("#"+r).hide(),getObj(l).style.display="";s=parseInt(a)+1;$("#"+e+"_from").html(10*a+1),$("#"+e+"_to").html(parseInt($("#"+e+"_from").html())+9)}if(getObj("pageNum_"+e).value=s,s>1){var o=e+"_prev",n=e+"_prevDisabled";getObj(o).style.display="",getObj(n).style.display="none";var d=e+"_next",c=e+"_nextDisabled";getObj(d).style.display="",getObj(c).style.display="none"}if(s<=1){o=e+"_prev",n=e+"_prevDisabled";getObj(o).style.display="none",getObj(n).style.display="";d=e+"_next",c=e+"_nextDisabled";getObj(d).style.display="",getObj(c).style.display="none"}if(s>=i){d=e+"_next",c=e+"_nextDisabled";getObj(d).style.display="none",getObj(c).style.display=""}}function validateRLColumnSelection(e){$("[id^='cb']:checked").length>7&&(renderingUtils.showCustomAlert(I18n.getMsg("crm.newrelatedlist.selectedColumn.exceeded")),$(e).prop("checked",!1))}var AjaxAPI=function(e){for(var t in e)this[t]=e[t]};function ajaxSuccessCallBack(e,t,a){e?!a&&$("#"+e)[0]&&($("#"+e).empty(),document.getElementById(e).innerHTML=t,JSEvalScript(document.getElementById(e))):"Success"!=t?($("#failureMsgEditTab").empty(),document.getElementById("failureMsgEditTab").innerHTML=t,$("#errMsgId").fadeIn().delay(2e3).fadeOut("slow"),document.getElementById("submitBtn").style.display="inline-block",document.getElementById("busyBtn").style.display="none"):(changeLocal(tabName,singularName,tabId),cancelfun())}function isElementVisible(e){var t=$L(window),a=$(e),i=t.scrollTop(),r=i+t.height(),l=a.offset().top;return l+a.height()<=r&&l>=i}function getUIFormatData(e,t,a,i,r,l){var s="subvalue_"+a,o=$("#"+s);if(validationUtils.isJsonCheck(e)?36==t||143==t||145==t||144==t?e.actualValue=$ESAPI.encoder().encodeForHTML(e.actualValue.toString()):e.defaultvalue=$ESAPI.encoder().encodeForHTML(e.defaultvalue.toString()):24!=t&&202!=t&&333!=t&&786!=t&&14!=t&&301!=t&&(e=$ESAPI.encoder().encodeForHTML(e.toString())),!e&&o.length>0){if(o.empty(),36==t||143==t||145==t||144==t){var n={defaultvalue:"",plainValue:""};detailView.replaceDataParams(a,n)}else if(4==t||6==t||7==t||9==t||10==t||12==t||13==t||15==t||5==t||133==t){n={defaultvalue:"",defaultid:""};detailView.replaceDataParams(a,n)}else detailView.replaceDataParams(a,"");return o.outerHTML()}if(25==t)return detailView.replaceDataParams(a,e+""),'<a class="crmLinkColor cP accessibility-route-elem" href="mailto:'+e+'" id="'+s+'">'+e+"</a>";if(300!=t&&301!=t){if(21==t){var d="https",c=0!=e.toLowerCase().indexOf(d)?"https://"+e:e;return detailView.replaceDataParams(a,e+""),'<a class="crmLinkColor cP accessibility-route-elem" href="'+c+'" target="_blank" rel="noopener noreferrer" id="'+s+'">'+e+"</a>"}if("en_GB"!=Crm.userDetails.COUNTRY_LOCALE&&"en_US"!=Crm.userDetails.COUNTRY_LOCALE||24!=t&&202!=t||""==e){if(786==t||14==t||333==t){var u=e.split(" "),m=u[1].split(":"),p=parseInt(m[0]),g=m[1];"HH:mm"!==Crm.userDetails.TIME_FORMAT&&u.length>2&&(p=Utils.convertTimeTo24HoursFormat(p,u[2].toUpperCase()));var f=Utils.getDateObject(u[0],{hrs:p,mins:g});detailView.replaceDataParams(a,f+"");E=f&&""!==f?Utils.getDateTimeInUserFormat(f,!0):"";return o.html(E),o.outerHTML()}if(33==t){var v=replace4Skype(e),C="";v=0==v.indexOf("+")?v.substring(1):v,o.html(e);var h=!1;return i.params.iscallallowed&&(h=!0),"true"!==h&&!0!==h||!v||(C="<a class='pH2 fL phoneRtl' title='"+I18n.getMsg("crm.phoneNo.Link.Title")+"' href='skype:+"+v+"?call' id='zti_"+s+"'></a>"),detailView.replaceDataParams(a,e+""),C+o.outerHTML()}if(36==t||143==t||145==t||144==t&&e){o.html(e.outputValue+"");var b=getObj("actualValue_"+a);b&&(b.value=e.actualValue);n={defaultvalue:e.actualValue,plainValue:e.actualValue};return detailView.replaceDataParams(a,n),o.outerHTML()}if(4==t||6==t||7==t||9==t||10==t||12==t||13==t||15==t||5==t||133==t){var y=i.params.lookupmodule,I="<a class='link accessibility-route-elem' id='"+s+"' onclick=\"Crm.trackSpotLightAction('Lookup Click',{'Module':'"+y+'\'});" onmouseenter="crmLookupBusinessCard.showLookupDetails(this)" onmouseout="crmui.hideTooltip()" data-zcqa=\'detailView\' data-cid=\'detailView\' data-params=\'{"module":"'+y+'","id":"'+e.defaultid+'"}\' href="Crm.getCrmBasePath()/EntityInfo.do?module='+y+"&amp;id="+e.defaultid+'">'+e.defaultvalue+"</a>";if(detailView.replaceDataParams(a,e),4==t&&(getElemById("accountId")&&getElemById("accountName")&&(getElemById("accountId").value=e.defaultid,getElemById("accountName").value=e.defaultvalue),"SalesOrders"!==r&&"Invoices"!==r&&"Quotes"!==r||detailView.loadRelatedDetails(r,l,"Accounts"),"Contacts"===r)){var _=$("#value_REPORTINGTOCONTACTID");_.length>0&&(_.empty(),getObj("value_REPORTINGTOCONTACTID").innerHTML=""),$("#headervalue_REPORTINGTOCONTACTID").html("")}return I}return o.length>0?(o.html(e+""),detailView.replaceDataParams(a,e+""),o.outerHTML()):(detailView.replaceDataParams(a,e+""),e+"")}var E=Utils.getDateInUsrViewFormat(e);return o.html(E),detailView.replaceDataParams(a,crmCalendar.getDateObjectFromGivenDateString(e)+""),o.outerHTML()}var w="yes_"+a,T="no_"+a,L="",O="";1==e?(L=$("#"+w),O=$("#"+T)):(L=$("#"+T),O=$("#"+w)),L.show(),O.hide(),detailView.replaceDataParams(a,e+"")}function getFormattedDate(e){if(!e)return"";if(e.indexOf("/")>-1)var t=e.split("/");else if(e.indexOf("-")>-1)t=e.split("-");else if(e.indexOf(".")>-1)t=e.split(".");var a=Crm.userDetails.DATE_PATTERN.toLowerCase(),i=null;if("mm/dd/yyyy"===a||"mm.dd.yyyy"===a||"mm-dd-yyyy"===a)i=e;else if("dd/mm/yyyy"===a||"dd.mm.yyyy"===a||"dd-mm-yyyy"===a)i=t[1]+"/"+t[0]+"/"+t[2];else if("yyyy/mm/dd"===a||"yyyy-mm-dd"===a||"yyyy. mm. dd"===a||"yyyy.mm.dd."===a)i=t[1]+"/"+t[2]+"/"+t[0];else if("zh_HK"===Crm.userDetails.COUNTRY_LOCALE){var r=(a=a.replace(/'/g,"")).replace(/mm/i,"(\\d{1,2})");r=(r=r.replace(/dd/i,"\\d{1,2}")).replace(/yyyy/i,"\\d{4}");var l=new RegExp(r).exec(e),s=l[1];s=s.length<2?"0"+s:s;var o=a.replace(/yyyy/i,"(\\d{4})");o=(o=o.replace(/dd/i,"\\d{1,2}")).replace(/mm/i,"\\d{1,2}");var n=(l=new RegExp(o).exec(e))[1],d=a.replace(/dd/i,"(\\d{1,2})");d=(d=d.replace(/mm/i,"\\d{1,2}")).replace(/yyyy/i,"\\d{4}");var c=(l=new RegExp(d).exec(e))[1];i=s+"/"+(c=c.length<2?"0"+c:c)+"/"+n}null!=i&&(i=new Date(i));var u=new Date;if($.datepicker.formatDate("yyyy",u)===$.datepicker.formatDate("yyyy",i))var m=$.datepicker.formatDate("M dd",i);else m=$.datepicker.formatDate("M dd, yy",i);return m}function loadRelatedListNew(e,t,a,i,r,l){if(i||(i=detailView.currentModule),!Crm.userDetails.isRelatedListLyteEnabled){for(var s=returnJson.relListLabelsJson.relListLabelJson.length,o=[],n=0;n<s;n++)o[n]=returnJson.relListLabelsJson.relListLabelJson[n].name.toLowerCase()+"_"+returnJson.relListLabelsJson.relListLabelJson[n].id;crmRelatedList.personalityArr=o.join("||")}Lyte.injectResources(networkUtils.returnDependencyFiles(["crm-detailview-common-footer.js","canvasview_model.js","custom_button_model.js","features_model.js"],ResourceConstants.CRMClient),void 0,(function(){if(returnJson.relListLabelsJson&&(returnJson.relListLabelsJson.moduleApiName=moduleApiMapping[returnJson.relListLabelsJson.module]),!Crm.userDetails.isRelatedListLyteEnabled){var s=Handlebars.templates.RelatedList(returnJson.relListLabelsJson);$("#relatedPageContent").html(s)}var o=new crmRequestPool;Crm.userDetails.isRelatedListLyteEnabled&&commonUtils.showHideLoadingDiv(!0),o.initiate({action:e,type:"GET",data:{fromIndex:1},complete:function(){t(l)},success:function(e){Crm.userDetails.isRelatedListLyteEnabled?(e.listLabelsJson&&(returnJson.relListLabelsJson.relListLabelJson=e.listLabelsJson,returnJson.relListLabelsJson.isNotesRLPresent=e.isNotesRLPresent),detailView.formNewLeftPanel(),a(e),commonUtils.showHideLoadingDiv(!1),Lyte.registeredMixins["crm-related-list-utils"].loadRelatedListComponents(i,r,e)):(a(e),crmRelatedList.load(i,r,e,!1))}})}))}function onCompleteFnRl(e){null==getObj("nav")&&showDrillDownPtr(e)}function onSuccessFnRl(e){ajaxSuccessCallBack("relatedPageContent",e,returnJson?returnJson.relListLabelsJson:void 0)}function bindEventListView(){if(null!=document.getElementById("listViewTable"))for(var e=document.getElementById("listViewTable").getElementsByTagName("tr"),t=e.length,a=1;a<t;a++)$(e[a]).mouseover(dropRofn(this,this.id)),$(e[a]).mouseout(dropRoutfn(this,this.id))}function buildTabGroup(){var e=[];$("#tabGroupList input[type='checkbox']:checked").each((function(t,a){e.push($(a).val())})),e=e.join(";"),getObj("selectedTabsList").value=e;var t=document.getElementById("profileIds").value;if(""!=t){for(var a=t.split(","),i="",r=0;r<a.length;r++){var l=a[r]+"_visible";a[r];1==getObj(l).checked&&(i=""==i?""+getObj(l).value:i+";"+getObj(l).value)}getObj("visibleProfileList").value=i}}function changeShowCacheObj(e,t){if("Leads"==e||"Contacts"==e||"Accounts"==e||"Potentials"==e){var a="tab_"+e;if(showCacheObj.hasOwnProperty(a)){var i=document.getElementById("idForCV");i.parentNode.removeChild(i);var r=document.createElement("div");r.id="dummydivtagid",r.style.display="none",r.innerHTML=showCacheObj[a],document.body.appendChild(r),$("#idForCV").empty(),document.getElementById("idForCV").innerHTML=t;var l=document.getElementById("dummydivtagid").innerHTML;$("#lvTred tr").length?(setDataFetchDate(),showCacheObj[a]=l):clearShowCacheObj(a),document.getElementById("dummydivtagid").parentNode.removeChild(document.getElementById("dummydivtagid")),$("#show").empty(),getObj("show").innerHTML=l,EvalInnerScript(getObj("show"))}else divObj=getObj("idForCV"),$(divObj).empty(),divObj.innerHTML=t,EvalInnerScript(getObj("idForCV"))}}function openWarningMessage(e,t,a){if(getObj("deleteTabName").value=t,"deleteTabGroup"==e)hideMenu(),showDeletePopup(I18n.getMsg("crm.tabgroup.deleteWarning"),"crm.button.delete","","",a);else{if(renderingUtils.freezeBackground(),"deActivateCreator"==e)var i="CreatorDeactivationWarningDiv";else if("deleteCreatorTab"==e)i="CreatorDeleteCreatorWarningDiv";else if("creatorEditForm"==e)i="CreatorFormEditWarningDiv";else if("createCreatorAcc"==e)i="CreateCreatorAccWarningDiv";getObj(i).style.display="block",getObj(i).style.zIndex=10001,"deActivateCreator"!=e&&"deleteCreatorTab"!=e&&"createCreatorAcc"!=e||mailsetCenter(i)}}function apiDateFormat(e,t){if(!e)return"";var a=CrmDateUtils.getDateObjectFromString(e,null,t);return"Invalid Date"==a?"":CrmDateUtils.getFormattedDate(a)}function apiDateTimeFormat(e,t){var a=e.indexOf(":"),i=e.substring(0,a-3),r=e.substring(a-2,e.length).trim(),l=apiDateFormat(i,t);if(!l)return"";var s=l+"T";return"hh:mm a"===Crm.userDetails.TIME_FORMAT&&(r=Utils.convertTimeValueTo24HourFormat(r)),s+(r.split(" ")[0]+":00")}function getPLStyleObj(e){var t;if(null!==e){var a=getPickListFontColor(e);"transparent"===e&&(a="var(--baseColor)"),t="background-color:"+e+";color:"+a,"#ffffff"===e&&(t+=";border: 1px solid var(--br_c0c6cc)")}return t}function updateColorCodeForSelObj(e){var t=e.data(),a=e.children("option:selected").eq(0),i=a.attr("data-colorcode")?a.attr("data-colorcode"):"";if(26===t.uitype&&""===i){var r=t.values.filter((function(e){return e.value===a.val()}))[0];i=r?r.colorCode:""}var l="selectColorComponent",s=void 0!==e.data("subformsectionlabel"),o=s?e.data("zcqa"):"crmajax_colorcode_"+e.data("fieldid");l=s?l+"-"+e.attr("id"):l+"-"+e.data("fieldid"),e.data("colorcode",$ESAPI.encoder().encodeForHTMLAttribute(i));var n=e.parent().parent();(n.addClass("colorEnabledPicklist"),n.find("#"+l).remove(),a.val()&&"-None-"!==a.val())?(n.removeClass("colorEnabledPKNone"),$('<span class="dIB activitesColor" data-zcqa="'+o+'" id="'+l+'" style="background:'+$ESAPI.encoder().encodeForHTMLAttribute(i)+'"></span>').insertBefore(e)):n.addClass("colorEnabledPKNone")}function getPKcolorAppliedVal(e,t,a){return null===e||"-None-"===e?e:'<span class="colorAppliedPicklist" data-zcqa="colorcode_'+("colorcode_span_-"+e)+'"  style="'+getPicklistStyleObj(e,t,a)+'">'+e+"</span>"}function getPicklistStyleObj(e,t,a){return getPLStyleObj(getPickListColorCode(e,t,a))}function getPickListColorCode(e,t,a){if(e){void 0!==e.html&&(e=e.html);for(var i=t.length,r=0;r<i;r++)if(a&&(e===t[r].name||e===t[r].html||e===t[r].content)||e===t[r].display_value||e===t[r].DisplayValue||e===t[r].uservalue||e===t[r].defaultValue||e===t[r].id)return t[r].colour_code?t[r].colour_code:t[r].colorCode;if(""!==e.trim())return"#ffffff"}}function getPickListFontColor(e){if(e&&""!==e&&"#noFill"!==e&&0===e.indexOf("#")&&(e=e.substring(1),(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3<175))return"white";return"black"}function isColorCodeEnabled(e,t){var a=store.peekAll("field").filterBy({api_name:e}).filter((function(e){if(e.module&&e.module[0].module_name===t)return e}));return!(!a[0]||!0!==a[0].enable_colour_code)}AjaxAPI.prototype.post=function(){this.loadingimg&&commonUtils.showHideLoadingDiv(!0),this.freezebg&&renderingUtils.freezeBackground();var e=this.id;this.url=networkUtils.getPortalURL(this.url),$.ajax({type:"POST",url:this.url,data:this.params,dataType:this.dataType||"html",complete:this.callbackfn,success:function(t){ajaxSuccessCallBack(e,t,void 0)}})},AjaxAPI.prototype.get=function(){this.loadingimg&&commonUtils.showHideLoadingDiv(!0),this.freezebg&&renderingUtils.freezeBackground();var e=this.id;this.url=networkUtils.getPortalURL(this.url),$.ajax({type:"GET",url:this.url,data:this.params,dataType:this.dataType||"html",complete:this.callbackfn,success:function(t){ajaxSuccessCallBack(e,t,void 0)}})};