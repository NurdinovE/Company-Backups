function CrmPlusLib(){}CrmPlusLib.zoLogToParent=function(actionName,data){if(!CrmPlusLib.isLoadedInProjectsPlus()){var toPostMessage={type:"logToParent"};toPostMessage.actionName=actionName,toPostMessage.isfromcrmpluslibrary=!0,toPostMessage.data=data,toPostMessage.fromService=zoDebugGetName();var targetOrigin=CrmPlusLib.parentOrigin||"*";window.parent.postMessage(JSON.stringify(toPostMessage),targetOrigin)}};var ZSDebug=window.ZSDebug||{};function zoDebugGetName(){var a;return a=window.CrmPlusLib&&window.CrmPlusLib.currentService?window.CrmPlusLib.currentService:location.host.split(".")[0],ZSDebug.Constants&&ZSDebug.Constants[a]||a}function hasUserAgentExcluded(){return/iPad|iPhone|Edge\/|Trident\//.test(navigator.userAgent)}ZSDebug.Constants={cliq:"chat",one:"directory",desk:"support",workdrive:"teamdrive",meetinglab:"meeting"},CrmPlusLib.ZO={sendMessage:function(toPostMessage,event){toPostMessage.isfromZoLibrary=!0,toPostMessage.zoDebugGetName=zoDebugGetName(),toPostMessage.parentOrigin=CrmPlusLib.parentOrigin||"null",window.parent.postMessage(JSON.stringify(toPostMessage),"*"),CrmPlusLib.parentOrigin&&(toPostMessage.isFromParentorigin=!0,window.parent.postMessage(JSON.stringify(toPostMessage),CrmPlusLib.parentOrigin))},receiveMessage:function(event){var eventData;if(CrmPlusLib.getFrameOriginForURL()===event.origin&&(void 0!==(eventData="object"!=typeof event.data?JSON.parse(event.data):event.data)&&eventData.isfromZoLibrary&&"healthCheck"===eventData.type)){var serviceName=eventData.fromService,logMsg=" Received - healthCheck call received - count - "+eventData.healthCheckCount,toPostMessage={};toPostMessage.fromService=serviceName,toPostMessage.logMsg=logMsg,toPostMessage.type="healthCheck",CrmPlusLib.ZO.sendMessage(toPostMessage,event)}}},CrmPlusLib.setUpZOMessageListener=function(){window.addEventListener?window.addEventListener("message",CrmPlusLib.ZO.receiveMessage,!1):window.attachEvent("onmessage",CrmPlusLib.ZO.receiveMessage)},CrmPlusLib.setUpClickListener=function(){document.addEventListener?document.addEventListener("click",CrmPlusLib.sendClickEventToParent,!1):document.attachEvent("onclick",CrmPlusLib.sendClickEventToParent)},CrmPlusLib.addMutationAndObserve=function(){try{new MutationObserver(mutations=>{mutations.forEach(mutation=>{if(mutation.addedNodes)for(let i=0;i<mutation.addedNodes.length;i++){let node=mutation.addedNodes[i];"IFRAME"===node.nodeName?CrmPlusLib.didIframeLoadedInService(node):CrmPlusLib.findIframeInService(node,CrmPlusLib.didIframeLoadedInService)}})}).observe(window.document.body,{childList:!0,subtree:!0})}catch(e){}},CrmPlusLib.findIframeInService=function(node,callback){0!==node.childNodes.length&&node.childNodes.forEach(function(e){callback(e),CrmPlusLib.findIframeInService(e,callback)})},CrmPlusLib.didIframeLoadedInService=function(node){if("IFRAME"===node.nodeName&&node.src){var parentOrigin=CrmPlusLib.parentOrigin;if(parentOrigin&&-1===node.src.indexOf(parentOrigin)){var data={url:node.src,reason:"Parent origin not found",parentOrigin:parentOrigin,error:"Iframe Creation In Service Failed"};CrmPlusLib.zoLogToParent("iframeBreakageInService",data)}}},CrmPlusLib.sendClickEventToParent=function(event){if(CrmPlusLib.isWebDeepLinkingEnabled){var srcElement=event.target||event.srcElement||event.originalTarget;if(event.target&&event.target.parentElement&&"A"===event.target.parentElement.tagName&&(srcElement=event.target.parentElement),void 0!=srcElement&&"A"===srcElement.nodeName&&void 0!=srcElement.href&&srcElement.href.length>1){if(CrmPlusLib.isUrlValidForDeeplinking(srcElement.href,event)){event.preventDefault();var toPostMessage={type:"DeepLinking"};toPostMessage.params=srcElement.href,CrmPlusLib.parent.sendMessage(toPostMessage)}}else if(!event.shiftKey&&!event.ctrlKey&&!event.metaKey){CrmPlusLib.clickEventTriggered=!0;var timeoutId=setTimeout(function(){CrmPlusLib.clickEventTriggered=!1,clearTimeout(timeoutId)},500)}}},CrmPlusLib.setWebDeepLinkingStatus=function(){CrmPlusLib.isWebDeepLinkingEnabled=!0,CrmPlusLib.windowOpenOverride()},CrmPlusLib.defaultWindowOpen=window.open,CrmPlusLib.windowOpenOverride=function(){window.open=function(...args){if(CrmPlusLib.clickEventTriggered&&CrmPlusLib.isUrlValidForDeeplinking(args[0],new Event("click"))){var toPostMessage={type:"DeepLinking"};return toPostMessage.params=args[0],void CrmPlusLib.parent.sendMessage(toPostMessage)}return CrmPlusLib.defaultWindowOpen.call(window,...args)}},CrmPlusLib.isUrlValidForDeeplinking=function(clickedURL,event){var clickedUrl=clickedURL,clickedDC=(clickedUrl=(clickedUrl=clickedUrl.substring(clickedUrl.indexOf("//")+2)).substring(0,clickedUrl.indexOf("/"))).substring(clickedUrl.indexOf(".")),clickedAppName=clickedUrl.split(".")[0],currentUrl=location.href,currentDC=(currentUrl=(currentUrl=currentUrl.substring(currentUrl.indexOf("//")+2)).substring(0,currentUrl.indexOf("/"))).substring(currentUrl.indexOf(".")),currentAppName=currentUrl.split(".")[0],actualClickedAppName=ZSDebug.Constants[clickedAppName]||clickedAppName,currentService=CrmPlusLib.currentService.split("_")[0];return!(event.shiftKey||event.ctrlKey||event.metaKey||-1===clickedDC.indexOf(".qntrl.")&&-1===clickedDC.indexOf(".localzohositescontent.com")&&-1===clickedDC.indexOf(".zohositescontent.com")&&clickedDC!==currentDC||actualClickedAppName===currentService||currentAppName===clickedAppName)},CrmPlusLib.setUpClickListener(),CrmPlusLib.setUpZOMessageListener(),CrmPlusLib.currentService=null,CrmPlusLib.loadedFromElectron=!1,CrmPlusLib.loadedInUnifiedSpaces=!1,CrmPlusLib.serviceModulesSplitted=!1,CrmPlusLib.serviceOrgId=null,CrmPlusLib.currentServiceSOID=null,CrmPlusLib.parentOrigin=null,CrmPlusLib.isLoadedInCrmplusFrame=!1,CrmPlusLib.isLoadedinFrame=!0,CrmPlusLib.isInitializeCompleted=!1,CrmPlusLib.optionstype={LINK:0,SCRIPT:1,LINKSCRIPT:2},CrmPlusLib.isUIReady=!1,CrmPlusLib.pressedKeys="",CrmPlusLib.portalName,CrmPlusLib.isCRMPlusReady=!1,CrmPlusLib.autoSuggestSearchIDs={projects:"topnotify",support:"globalAutoSuggestContainer",crm:"ui-id-1",salesiq:"srchhelp"},CrmPlusLib.referrerTag="unsafe-url",CrmPlusLib.postMessageQueue=[],CrmPlusLib.currentModule="",CrmPlusLib.bundleTheme={blue:"unifiedui-blue-theme"},CrmPlusLib.trustedDomains=[],CrmPlusLib.isLoadedInChildIframe=!1,CrmPlusLib.isWebDeepLinkingEnabled=!1,String.prototype.endsWith||(String.prototype.endsWith=function(search,this_len){return(void 0===this_len||this_len>this.length)&&(this_len=this.length),this.substring(this_len-search.length,this_len)===search}),window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.host),CrmPlusLib.addOption=function(){},CrmPlusLib.onWindowLoad=function(){CrmPlusLib.zoLogToParent("onWindowLoad")},CrmPlusLib.getServiceSOID=function(serviceName){return CrmPlusLib.currentServiceSOID},CrmPlusLib.showSidePanel=function(){var toPostMessage={type:"SetSidePanelStatus",status:!0};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.hideSidePanel=function(){var toPostMessage={type:"SetSidePanelStatus",status:!1};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.canLoadInIframe=function(){return!!CrmPlusLib.isCrossOrigin()||(-1!=window.location.host.indexOf(".zohocorpin.com")||!(void 0===CrmPlusLib||!CrmPlusLib.parentOrigin||!CrmPlusLib.parentOrigin.endsWith(window.parent.location.origin)))},CrmPlusLib.initialize=function(serviceCode,serviceOrgId,uiJson){(serviceOrgId=""+serviceOrgId,CrmPlusLib.serviceOrgId=serviceOrgId,CrmPlusLib.currentService=serviceCode,CrmPlusLib.tempLog("InitializeTriggered"),uiJson&&uiJson.bundleInfo&&uiJson.bundleInfo.parent_origin)&&uiJson.bundleInfo.parent_origin.split(",").forEach(function(origin){CrmPlusLib.trustedDomains.push(origin.trim())});if(uiJson&&uiJson.serviceInfo&&uiJson.serviceInfo.isLoadedInChildIframe&&(CrmPlusLib.isLoadedInChildIframe=!0),CrmPlusLib.setParentOrigin(),CrmPlusLibUtil.updateTriggerAPI(),CrmPlusLib.canLoadInIframe())CrmPlusLib.initCRMPlus(serviceCode,serviceOrgId,uiJson);else if(2==CrmPlusLib.readCookie("newcrmplusredirection"))CrmPlusLib.initCRMPlus(serviceCode,serviceOrgId,uiJson);else if(CrmPlusLib.parentOrigin){var url=CrmPlusLib.parentOrigin+"/fetchusernewuioption.do?org_id="+CrmPlusLib.serviceOrgId+"&service="+serviceCode,xmlHttp=new XMLHttpRequest;xmlHttp.open("GET",url,!0),xmlHttp.withCredentials=!0,xmlHttp.onload=function(){"true"===xmlHttp.responseText&&(document.cookie="newcrmplusredirection=2; path=/"+window.location.pathname.split("/")[1]+"/; domain="+window.location.host.replace(window.location.host.split(".")[0],"")+"; secure;",CrmPlusLib.initCRMPlus(serviceCode,serviceOrgId,uiJson))},xmlHttp.send()}CrmPlusLib.isLoadedFromElectron()},CrmPlusLib.escapeHtml=function(string){var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(string).replace(/[&<>"'`=\/]/g,function(s){return entityMap[s]})},CrmPlusLib.initCRMPlus=function(serviceCode,serviceOrgId,uiJson){CrmPlusLib.setUpMessageListener(),void 0!==uiJson&&(void 0!==uiJson.currentservicesoid&&(CrmPlusLib.currentServiceSOID=uiJson.currentservicesoid,delete uiJson.currentservicesoid),CrmPlusLib.uiJson=uiJson),CrmPlusLib.isInitializeCompleted=!0,CrmPlusLib.parent.checkIfLoadedInFrame()},CrmPlusLib.setParentOrigin=function(parentOrigin){if(CrmPlusLib.isCrossOrigin()&&parentOrigin&&0!==CrmPlusLib.trustedDomains.length&&-1!==CrmPlusLib.trustedDomains.indexOf(parentOrigin))CrmPlusLib.parentOrigin=parentOrigin;else{parentOrigin||(parentOrigin="");var curdomain=window.location.host;if(-1!=curdomain.indexOf(".zoho.com.cn")||-1!=curdomain.indexOf(".zohositescontent.com.cn"))/^(crmplus.zoho.com.cn|precrmplus.zoho.com.cn|crmplus-ro.zoho.com.cn|precrmplus-ro.zoho.com.cn)$/,CrmPlusLib.isCrossOrigin()?-1!==(trustedList=["https://one.zoho.com.cn","https://preone.zoho.com.cn","https://one-ro.zoho.com.cn","https://preone-ro.zoho.com.cn","https://projectsplus.zoho.com.cn","https://preprojectsplus.zoho.com.cn","https://projectsplus-ro.zoho.com.cn","https://preprojectsplus-ro.zoho.com.cn"]).indexOf(parentOrigin)?CrmPlusLib.parentOrigin=parentOrigin:CrmPlusLib.parentOrigin=window.location.protocol+"//one.zoho.com.cn":CrmPlusLib.parentOrigin=window.location.protocol+"//crmplus.zoho.com.cn";else if(-1!=curdomain.indexOf(".zoho.com.au")||-1!=curdomain.indexOf(".zohositescontent.com.au")){/^(crmplus.zoho.com.au|precrmplus.zoho.com.au|crmplus-ro.zoho.com.au|precrmplus-ro.zoho.com.au)$/,CrmPlusLib.isCrossOrigin()?-1!==(trustedList=["https://one.zoho.com.au","https://preone.zoho.com.au","https://one-ro.zoho.com.au","https://preone-ro.zoho.com.au","https://projectsplus.zoho.com.au","https://preprojectsplus.zoho.com.au","https://projectsplus-ro.zoho.com.au","https://preprojectsplus-ro.zoho.com.au"]).indexOf(parentOrigin)?CrmPlusLib.parentOrigin=parentOrigin:CrmPlusLib.parentOrigin=window.location.protocol+"//one.zoho.com.au":CrmPlusLib.parentOrigin=window.location.protocol+"//crmplus.zoho.com.au"}else if(-1!=curdomain.indexOf(".zoho.com")||-1!=curdomain.indexOf(".manageengine.com")||-1!=curdomain.indexOf(".site24x7.com")||-1!=curdomain.indexOf(".zohositescontent.com")){CrmPlusLib.isCrossOrigin()?-1!==(trustedList=["https://one.zoho.com","https://preone.zoho.com","https://one-ro.zoho.com","https://preone-ro.zoho.com","https://zone.pugazhgm.com","https://projectsplus.zoho.com","https://preprojectsplus.zoho.com","https://projectsplus-ro.zoho.com","https://preprojectsplus-ro.zoho.com","https://mspcentral.manageengine.com","https://premspcentral.manageengine.com"]).indexOf(parentOrigin)?CrmPlusLib.parentOrigin=parentOrigin:CrmPlusLib.parentOrigin=window.location.protocol+"//one.zoho.com":CrmPlusLib.parentOrigin=window.location.protocol+"//crmplus.zoho.com"}else if(-1!=curdomain.indexOf(".zoho.eu")||-1!=curdomain.indexOf(".manageengine.eu")||-1!=curdomain.indexOf(".site24x7.eu")||-1!=curdomain.indexOf(".zohositescontent.eu")){/^(crmplus.zoho.eu|precrmplus.zoho.eu|crmplus-ro.zoho.eu|precrmplus-ro.zoho.eu)$/,CrmPlusLib.isCrossOrigin()?-1!==(trustedList=["https://one.zoho.eu","https://preone.zoho.eu","https://one-ro.zoho.eu","https://preone-ro.zoho.eu","https://euapps.zohocorp.com","https://projectsplus.zoho.eu","https://preprojectsplus.zoho.eu","https://projectsplus-ro.zoho.eu","https://preprojectsplus-ro.zoho.eu","https://mspcentral.manageengine.eu","https://premspcentral.manageengine.eu"]).indexOf(parentOrigin)?CrmPlusLib.parentOrigin=parentOrigin:CrmPlusLib.parentOrigin=window.location.protocol+"//one.zoho.eu":CrmPlusLib.parentOrigin=window.location.protocol+"//crmplus.zoho.eu"}else if(-1!=curdomain.indexOf(".zoho.in")||-1!=curdomain.indexOf(".zohositescontent.in")){/^(crmplus.zoho.in|precrmplus.zoho.in|crmplus-ro.zoho.in|precrmplus-ro.zoho.in)$/,CrmPlusLib.isCrossOrigin()?-1!==(trustedList=["https://one.zoho.in","https://preone.zoho.in","https://one-ro.zoho.in","https://preone-ro.zoho.in","https://projectsplus.zoho.in","https://preprojectsplus.zoho.in","https://projectsplus-ro.zoho.in","https://preprojectsplus-ro.zoho.in"]).indexOf(parentOrigin)?CrmPlusLib.parentOrigin=parentOrigin:CrmPlusLib.parentOrigin=window.location.protocol+"//one.zoho.in":CrmPlusLib.parentOrigin=window.location.protocol+"//crmplus.zoho.in"}else if(-1!=curdomain.indexOf(".zoho.jp")||-1!=curdomain.indexOf(".zohositescontent.jp")){/^(crmplus.zoho.jp|precrmplus.zoho.jp|crmplus-ro.zoho.jp|precrmplus-ro.zoho.jp)$/,CrmPlusLib.isCrossOrigin()?-1!==(trustedList=["https://one.zoho.jp","https://preone.zoho.jp","https://one-ro.zoho.jp","https://preone-ro.zoho.jp","https://projectsplus.zoho.jp","https://preprojectsplus.zoho.jp","https://projectsplus-ro.zoho.jp","https://preprojectsplus-ro.zoho.jp"]).indexOf(parentOrigin)?CrmPlusLib.parentOrigin=parentOrigin:CrmPlusLib.parentOrigin=window.location.protocol+"//one.zoho.jp":CrmPlusLib.parentOrigin=window.location.protocol+"//crmplus.zoho.jp"}else if(-1!=curdomain.indexOf(".zoho.sa")||-1!=curdomain.indexOf(".zohositescontent.sa")){/^(crmplus.zoho.sa|precrmplus.zoho.sa|crmplus-ro.zoho.sa|precrmplus-ro.zoho.sa)$/,CrmPlusLib.isCrossOrigin()?-1!==(trustedList=["https://one.zoho.sa","https://preone.zoho.sa","https://one-ro.zoho.sa","https://preone-ro.zoho.sa","https://projectsplus.zoho.sa","https://preprojectsplus.zoho.sa","https://projectsplus-ro.zoho.sa","https://preprojectsplus-ro.zoho.sa"]).indexOf(parentOrigin)?CrmPlusLib.parentOrigin=parentOrigin:CrmPlusLib.parentOrigin=window.location.protocol+"//one.zoho.sa":CrmPlusLib.parentOrigin=window.location.protocol+"//crmplus.zoho.sa"}else if(-1!=curdomain.indexOf(".zohocloud.ca")||-1!=curdomain.indexOf(".zohositescontent.ca")){/^(crmplus.zohocloud.ca|precrmplus.zohocloud.ca|crmplus-ro.zohocloud.ca|precrmplus-ro.zohocloud.ca)$/,CrmPlusLib.isCrossOrigin()?-1!==(trustedList=["https://one.zohocloud.ca","https://preone.zohocloud.ca","https://one-ro.zohocloud.ca","https://preone-ro.zohocloud.ca","https://projectsplus.zohocloud.ca","https://preprojectsplus.zohocloud.ca","https://projectsplus-ro.zohocloud.ca","https://preprojectsplus-ro.zohocloud.ca"]).indexOf(parentOrigin)?CrmPlusLib.parentOrigin=parentOrigin:CrmPlusLib.parentOrigin=window.location.protocol+"//one.zohocloud.ca":CrmPlusLib.parentOrigin=window.location.protocol+"//crmplus.zohocloud.ca"}else if(-1!=curdomain.indexOf(".localzoho.com")||-1!=curdomain.indexOf(".localzohositescontent.com"))if(/^(crmplus.localzoho.com|crmpluslab.localzoho.com|crmplusdev.localzoho.com|crmplusqa.localzoho.com|marketingplus.localzoho.com)$/,CrmPlusLib.isCrossOrigin()){var trustedList=["https://bsm-integ.localzoho.com","https://bundle.localzoho.com","https://zbundle.localzoho.com","https://projectsplus.localzoho.com","https://projectspluslab.localzoho.com","https://mspcentral.localzoho.com","https://mspcentral.localmanageengine.com"];/^(https:\/\/(one|directory|admin|remotely)([a-z-]*)\.localzoho\.com)$/.test(parentOrigin)||-1!==trustedList.indexOf(parentOrigin)?CrmPlusLib.parentOrigin=parentOrigin:CrmPlusLib.parentOrigin=window.location.protocol+"//one-lab.localzoho.com"}else CrmPlusLib.parentOrigin=window.location.protocol+"//crmplus.localzoho.com";else if(-1!=curdomain.indexOf(".zohocorpin.com")||-1!=curdomain.indexOf(".devzohositescontent.com")){if(CrmPlusLib.isCrossOrigin())-1!==(trustedList=["https://one.csez.zohocorpin.com","https://directory.csez.zohocorpin.com","https://zadmin.csez.zohocorpin.com","https://memsp-u22-01.csez.zohocorpin.com:8443"]).indexOf(parentOrigin)?CrmPlusLib.parentOrigin=parentOrigin:CrmPlusLib.parentOrigin=window.location.protocol+"//one.csez.zohocorpin.com";else CrmPlusLib.parentOrigin=window.location.protocol+"//crmplus.csez.zohocorpin.com:8080"}}},CrmPlusLib.setUpMessageListener=function(){window.addEventListener?(window.addEventListener("message",CrmPlusLib.parent.receiveMessage,!1),window.addEventListener("unload",CrmPlusLib.onWindowUnLoad,!1),"undefined"==typeof CrmPlusImpl&&window.addEventListener("load",CrmPlusLib.onWindowLoad,!1)):(window.attachEvent("onmessage",CrmPlusLib.parent.receiveMessage),window.attachEvent("onunload",CrmPlusLib.onWindowUnLoad),"undefined"==typeof CrmPlusImpl&&window.attachEvent("onload",CrmPlusLib.onWindowLoad))},CrmPlusLib.addEventListener=function(element,eventName,eventListener,useCapture){window.addEventListener?element.addEventListener(eventName,eventListener,useCapture):element.attachEvent("on"+eventName,eventListener)},CrmPlusLib.bindEventsforIdle=function(){document.addEventListener?(document.addEventListener("keydown",CrmPlusLib.setActive,!0),document.addEventListener("keypress",CrmPlusLib.setActive,!0),window.addEventListener("scroll",CrmPlusLib.setActive,!0),document.addEventListener("click",CrmPlusLib.onDocumentClick,!0)):(document.attachEvent("onkeydown",CrmPlusLib.setActive),document.attachEvent("onclick",CrmPlusLib.onDocumentClick),document.attachEvent("onkeypress",CrmPlusLib.setActive),window.attachEvent("onscroll",CrmPlusLib.setActive))},CrmPlusLib.setActive=function(){var toPostMessage={type:"SetActive"};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.setup={interval:null,complete:function(){if(CrmPlusLib.isLoadedInCrmplusFrame)CrmPlusLib.setup.clearInterval(),CrmPlusLib.currentService&&CrmPlusLib.addEventListener(window,"popstate",CrmPlusLib.parent.notifyURLChange);else if(CrmPlusLib.parent.initRetryCount<=5)CrmPlusLib.parent.initRetryCount++,CrmPlusLib.setup.setInterval();else{return}},setInterval:function(){null!==CrmPlusLib.setup.interval&&this.clearInterval(),CrmPlusLib.setup.interval=setTimeout(function(){CrmPlusLib.setup.complete()},500)},clearInterval:function(){clearTimeout(CrmPlusLib.setup.interval),CrmPlusLib.setup.interval=null}},CrmPlusLib.onWindowUnLoad=function(){CrmPlusLib.zoLogToParent("onWindowUnLoad");var toPostMessage={type:"WindowUnLoad"};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.isCrossOrigin=function(){return!0},CrmPlusLib.activity={},CrmPlusLib.activity.triggerAction=function(eventData){if(eventData.handler&&0==eventData.handler.indexOf("CrmPlusImpl.")){var funcRef=CrmPlusLibUtil.stringToFunctionReference(eventData.handler),params=eventData.params;funcRef&&funcRef.apply(null,params)}},CrmPlusLib.parent={initRetryCount:0,sendMessage:function(toPostMessage,event){if(CrmPlusLib.isInitializeCompleted)if(CrmPlusLib.isCRMPlusReady||void 0===toPostMessage||"InitCheck"===toPostMessage.type){toPostMessage.isfromcrmpluslibrary=!0,toPostMessage.fromService=CrmPlusLib.currentService;var targetOrigin=CrmPlusLib.parentOrigin;CrmPlusLib.isCrossOrigin()&&"InitCheck"==toPostMessage.type&&(targetOrigin="*"),CrmPlusLib.isCrossOrigin()&&CrmPlusLib.isLoadedInChildIframe&&(window.parent.CrmPlusLib.parent.sendMessage(toPostMessage,event),targetOrigin=window.parent.location.origin),event?event.source.postMessage(JSON.stringify(toPostMessage),targetOrigin):window.parent.postMessage(JSON.stringify(toPostMessage),targetOrigin)}else CrmPlusLib.postMessageQueue.push(toPostMessage)},receiveMessage:function(event){var eventData;if(void 0!==(eventData="object"!=typeof event.data?CrmPlusLib.jsonParse(event.data):event.data)&&eventData.isfromcrmplus&&(CrmPlusLib.isCrossOrigin()&&"InitReply"===eventData.type&&CrmPlusLib.setParentOrigin(event.origin),-1!=CrmPlusLib.parentOrigin.indexOf(".zohocorpin.com")||event.origin===CrmPlusLib.parentOrigin)){var eventType=eventData.type;if("handler"==eventType){if("CrmPlusImpl.loadedFromElectron"===eventData.handler)return void(CrmPlusLib.loadedFromElectron=eventData.params);if("CrmPlusImpl.getScreenSources"===eventData.handler)return void CrmPlusLib.receivedScreenSources(eventData.params);if("CrmPlusImpl.handleKeyboardShortcutFromParent"===eventData.handler){var keyEvent=new KeyboardEvent(eventData.params.type,eventData.params);return void CrmPlusLib.handleParentKeyBoardShortCut(keyEvent)}CrmPlusLibUtil.callByMethodName(eventData.handler,eventData.params)}else if("InitReply"===eventType){CrmPlusLib.handleChatBarInService(),CrmPlusLib.isLoadedInCrmplusFrame=!0,CrmPlusLib.loadedInUnifiedSpaces=eventData.spacesStatus,CrmPlusLib.serviceModulesSplitted=eventData.serviceModulesSplitted,CrmPlusLib.isUIReady&&CrmPlusLib.onLoadedInCrmplus(),CrmPlusLib.sendCommonUIElements("all",CrmPlusLib.uiJson),delete CrmPlusLib.uiJson,CrmPlusLib.setup.complete(),CrmPlusLib.tempLog("InitReplyReceived");var bundleData={origin:CrmPlusLib.parentOrigin};CrmPlusLibUtil.callByMethodName("CrmPlusImpl.setBundleData",[bundleData]),CrmPlusLib.addMutationAndObserve()}else if("GetCurrentURL"===eventType){var toPostMessage=CrmPlusLib.parent.constructToNotifyURL();toPostMessage.type=eventType,toPostMessage.callbackfunctionname=eventData.callbackfunctionname,CrmPlusLib.parent.sendMessage(toPostMessage,event)}if("ReplaceCurrentURL"===eventType){if(window.location.href===window.location.protocol+eventData.toreplaceurl)return void CrmPlusLib.parent.notifyURLChange();document.location.replace(eventData.toreplaceurl)}else if("HideLoading"===eventType)CrmPlusLib.hideSwitchingLoading(eventData.service);else if("scrollToDiv"===eventType)CrmPlusLib.scrollToDiv(eventData.ID);else if("TriggerAction"===eventType)eventData.handler?CrmPlusLib.activity.triggerAction(eventData):CrmPlusLib.triggerAction(eventData.uitype,eventData.key,eventData.valueJson,eventData.infoJSON);else if("FreezeLayerVisibility"===eventType){var status=eventData.status;CrmPlusLib.handleFreezeLayerVisibility(status),CrmPlusImpl.search.hideAutoSuggestView()}else if("HandleSetup"===eventType){status=eventData.status;var URL=eventData.url,selectedModule=eventData.selectedModule;CrmPlusLib.handleSetup(status,selectedModule,URL)}else if("CRMPlusUIReady"===eventType){CrmPlusLib.isCRMPlusReady=!0;for(var i=0;i<CrmPlusLib.postMessageQueue.length;i++)CrmPlusLib.parent.sendMessage(CrmPlusLib.postMessageQueue[i]);CrmPlusLib.postMessageQueue=null,CrmPlusLib.tempLog("UIReadyReceived")}else"SetAppsStatus"===eventType?(CrmPlusLib.appsStatus=eventData.appsStatus,void 0!=CrmPlusImpl.handleCrmPlusServicesIntegration&&CrmPlusImpl.handleCrmPlusServicesIntegration()):"HandleSalesSignalsVisibility"==eventType?CrmPlusLib.isInNewSalesSignalsView=eventData.isInNewSalesSignalsView:"HandleZiaSearchUnification"==eventType?CrmPlusLib.handleZiaSearchUnification():"setSpacesStatus"==eventType?(CrmPlusLib.loadedInUnifiedSpaces=eventData.status,CrmPlusLib.addStylesForSpaces()):"setLoadedInProjectsPlus"==eventType?CrmPlusLib.loadedInProjectsPlus=eventData.status:"SetWebDeepLinkingStatus"==eventType?CrmPlusLib.setWebDeepLinkingStatus():"modifyServiceDOMForSpaces"==eventType&&CrmPlusLib.modifyServiceDOMForSpaces(eventData.isRevert,eventData.isConnectEvents)}},notifyURLChange:function(){if(CrmPlusLib.isLoadedInCrmplusFrame&&CrmPlusLib.isUIReady){try{-1!==navigator.userAgent.indexOf("Edge")&&CrmPlusLib.handleStateIssueInEdge()}catch(e){}var toPostMessage=CrmPlusLib.parent.constructToNotifyURL();toPostMessage.type="URLChange",CrmPlusLib.parent.sendMessage(toPostMessage)}},constructToNotifyURL:function(){var toPostMessage={};return toPostMessage.value=document.location.href,toPostMessage},checkIfLoadedInFrame:function(){try{window.self!=window.top?CrmPlusLib.isLoadedInFrame=!0:CrmPlusLib.isLoadedInFrame=!1}catch(e){CrmPlusLib.isLoadedInFrame=!0}if(CrmPlusLib.isLoadedInFrame){var toPostMessage={type:"InitCheck"};CrmPlusLib.parent.sendMessage(toPostMessage),CrmPlusLib.setup.setInterval(),CrmPlusLib.tempLog("sentInitCheck")}else CrmPlusLib.isLoadedInCrmplusFrame=!1,CrmPlusLib.parent.initRetryCount=6,CrmPlusLib.setup.complete()}},CrmPlusLib.scrollToDiv=function(id){var element=$("#"+id);element&&null!=element&&element.length>0&&$("html,body").animate({scrollTop:$("#"+id).offset().top},"slow")},CrmPlusLib.onLoadedInCrmplus=function(){"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.handleUIChange(),CrmPlusLib.parent.notifyURLChange(),this.bindEventsforIdle(),CrmPlusLib.bindEventForShortCuts(),CrmPlusLib.injectFreezeLayer(),hasUserAgentExcluded()||CrmPlusLib.addFrameUnLoadListener()},CrmPlusLib.injectFreezeLayer=function(){var zIndex="1100";"projects"===CrmPlusLib.currentService&&(zIndex="20003");var style=document.createElement("style");style.innerHTML='.zcrmp-srchpanfreeze {content: "";position:fixed;top:0px;height: 100%;left:0px;right:0px;width:100%;background: rgba(0,0,0,0.6);z-index:'+zIndex+";}",document.head.appendChild(style);var divElement=document.createElement("div");divElement.id="crmplus_freezer_layer",divElement.onclick=CrmPlusLib.onClickOnFreezeLayer,divElement.classList.add("zcrmp-srchpanfreeze"),divElement.style.display="none",document.body.appendChild(divElement)},CrmPlusLib.onClickOnFreezeLayer=function(event){var toPostMessage={type:"OnClickOnFreezeLayer"};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.handleFreezeLayerVisibility=function(status){var element=document.getElementById("crmplus_freezer_layer");element.style.display=1==status?"block":"none"},CrmPlusLib.showLoading=function(){var toPostMessage={type:"SetLoadingStatus",status:!0};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.hideLoading=function(){var toPostMessage={type:"SetLoadingStatus",status:!1};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.changeBrowserTitle=function(title){var toPostMessage={type:"ChangeBrowserTitle"};toPostMessage.title=title,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.sendCommonUIElements=function(typeofUI,json){var toPostMessage={type:"SetCommonUIElements"};toPostMessage.uitype=typeofUI,toPostMessage.modulejson=json,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.UIReady=function(){!0!==CrmPlusLib.isUIReady&&(this.isUIReady=!0,CrmPlusLib.isLoadedInCrmplusFrame&&this.onLoadedInCrmplus(),CrmPlusLib.tempLog("UIReadyCalled"))},CrmPlusLib.selectEntity=function(type,key){var toPostMessage={type:"SelectEntity"};toPostMessage.selected=key,toPostMessage.uitype=type,CrmPlusLib.currentModule=key,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.modifyUI=function(type,json){CrmPlusLib.sendCommonUIElements(type,json)},CrmPlusLib.updateField=function(type,key,newValue){var toPostMessage={type:"UpdateField"};toPostMessage.key=key,toPostMessage.uitype=type,toPostMessage.newValue=newValue,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.setNotificationCount=function(type,count,isAlertIcon,showAlertDot){var toPostMessage={type:"SetNotificationCount"};toPostMessage.notificationtype=type,toPostMessage.count=count,void 0!==isAlertIcon&&(toPostMessage.isAlertIcon=isAlertIcon),void 0!=showAlertDot&&(toPostMessage.showAlertDot=showAlertDot),CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.addNew=function(type,json){var toPostMessage={type:"AddNewUIElement"};toPostMessage.uitype=type,toPostMessage.json=json,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.removeUIElement=function(type,key){var toPostMessage={type:"RemoveUIElement"};toPostMessage.uitype=type,toPostMessage.key=key,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.setSearchFilters=function(json){var toPostMessage={type:"SetSearchFilters"};toPostMessage.filters=json,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.setDefaultFilters=function(json){var toPostMessage={type:"SetDefaultFilters"};toPostMessage.filters=json,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.showTopBar=function(){var toPostMessage={type:"HandleTopBarVisibility",status:!0};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.hideTopBar=function(){var toPostMessage={type:"HandleTopBarVisibility",status:!1};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.notifyURLReplace=function(){CrmPlusLib.parent.notifyURLChange()},CrmPlusLib.notifyURLChange=function(){CrmPlusLib.parent.notifyURLChange()},CrmPlusLib.getScreenSources=function(){return new Promise(resolve=>{CrmPlusLib.receivedScreenSources=(sources=>{var result=[];sources.forEach(elem=>{var resp={};resp.id=elem.id,resp.name=elem.name,resp.thumbnail={},resp.thumbnail.toDataURL=(()=>elem.thumbnail),resp.appIcon={},resp.appIcon.toDataURL=(()=>elem.appIcon),result.push(resp)}),resolve(result)});var toPostMessage={type:"ScreenSources"};CrmPlusLib.parent.sendMessage(toPostMessage)})},CrmPlusLib.isLoadedFromElectron=function(){var toPostMessage={type:"isLoadedFromElectron"};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.addUser=function(departmentID,departmentRole,departmentLinkName){var toPostMessage={type:"ShowAddUser",status:!1};toPostMessage.departmentID=departmentID,toPostMessage.departmentRole=departmentRole,toPostMessage.departmentLinkName=departmentLinkName,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.changeView=function(viewType){var toPostMessage={type:"changeView"};toPostMessage.viewType=viewType,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.readCookie=function(name){for(var nameEQ=name+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(nameEQ))return c.substring(nameEQ.length,c.length)}return null},CrmPlusLib.addRecord=function(params){var toPostMessage={};"RecentItems"===params.Type&&(toPostMessage.type="pushrecentitems"),toPostMessage.params=params,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.triggerAction=function(type,key,valueJson,infoJSON){try{switch(type){case"selectmodule":CrmPlusImpl.selectModule(key,infoJSON);break;case"selectdepartment":CrmPlusImpl.selectDepartment(key.id,key.group_name);break;case"selectoption":CrmPlusImpl.selectOption(key,valueJson);break;case"newmodule":CrmPlusImpl.showCreateCustomModuleView();break;case"newdepartment":key?CrmPlusImpl.showManageDepartment?CrmPlusImpl.showManageDepartmentView(key):CrmPlusImpl.showCreateDepartmentView(!0):CrmPlusImpl.showCreateDepartmentView(key);break;case"managedepartment":CrmPlusImpl.showManageDepartment?CrmPlusImpl.showManageDepartmentView(key):CrmPlusImpl.showCreateDepartmentView(!0);case"getdepartmentlist":CrmPlusImpl.getDepartmentList(key.offset,key.range,key.searchkey,key.recentdepartment);break;case"triggersearch":CrmPlusLib.handleAutoSuggestForPopup(),CrmPlusImpl.triggerSearch(key);break;case"getSearchFilters":void 0===CrmPlusImpl.getSearchFilters?CrmPlusLib.setSearchFilters():CrmPlusImpl.getSearchFilters();break;case"getCurrentDefaultFilters":void 0===CrmPlusImpl.getCurrentDefaultFilters?CrmPlusLib.setDefaultFilters():CrmPlusImpl.getCurrentDefaultFilters();break;case"showNotificationDialog":CrmPlusImpl.showNotificationDialog(key.position,key.type);break;case"hideNotificationDialog":CrmPlusImpl.hideNotificationDialog(key);break;case"showDevModePopup":CrmPlusImpl.showDevModePopup(key.position,key.type);break;case"hideDevModePopup":CrmPlusImpl.hideDevModePopup(key);break;case"showAddRecordView":CrmPlusImpl.showAddRecordView(key);break;case"closesearchview":CrmPlusImpl.closeSearchView(key);break;case"showAutoSuggestPopupOnEmptyInput":CrmPlusImpl.search.showAutoSuggestPopupOnEmptyInput(key.position);break;case"ShowAutoSuggestForSearch":if(void 0!==CrmPlusImpl.search&&void 0!==CrmPlusImpl.search.showAutoSuggestionView){var textToSearch=key.textInput;CrmPlusImpl.search.showAutoSuggestionView(textToSearch,key.position,key.searchJson)}else if(void 0!==CrmPlusImpl.search&&void 0!==CrmPlusImpl.search.showAutoSuggestView){textToSearch=key.textInput;CrmPlusLib.handleAutoSuggestForPopup(key.position,key.isleftpanelvisible,key.ispopup),CrmPlusImpl.search.showAutoSuggestView(textToSearch)}break;case"HideAutoSuggestForSearch":void 0!==CrmPlusImpl.search&&void 0!==CrmPlusImpl.search.hideAutoSuggestionView?CrmPlusImpl.search.hideAutoSuggestionView(key):void 0!==CrmPlusImpl.search&&void 0!==CrmPlusImpl.search.hideAutoSuggestView&&(void 0!==CrmPlusLib.timerForRemovingSearchClass&&clearTimeout(CrmPlusLib.timerForRemovingSearchClass),CrmPlusImpl.search.hideAutoSuggestView(key),CrmPlusLib.timerForRemovingSearchClass=setTimeout(function(){CrmPlusLib.handleAutoSuggestForPopup()},2e3));break;case"SetLiveChatAgentStatus":"undefined"!=typeof UserStatus&&void 0!==UserStatus.changeUserStatus&&(!0===key?UserStatus.changeUserStatus("chat","on"):UserStatus.changeUserStatus("chat","off"));break;case"handleChatNotificationAction":CrmPlusImpl.handleChatNotificationAction(key);break;case"showDialog":CrmPlusImpl.showDialog(key);break;case"updatePhoneAgentStatus":CrmPlusImpl.updatePhoneAgentStatus(key);break;case"logoutPhoneAgent":CrmPlusImpl.logoutPhoneAgent(key);break;case"handleParentEvents":CrmPlusLib.handleParentEvents(key);break;case"showUsersTab":CrmPlusImpl.showUsersTab(key);break;case"hideDialog":CrmPlusImpl.hideDialog(key);break;case"showSearchFilter":CrmPlusImpl.search.showSearchFilter(key);break;case"clearSearchFilter":CrmPlusImpl.search.clearSearchFilter();break;case"triggerAction":CrmPlusImpl.triggerAction(key.name,key.params);break;case"setTheme":CrmPlusLib.setBundleThemeToService(key);break;case"setNotificationSound":CrmPlusImpl.setChatNotificationSoundStatus(key);break;case"getOtherPortalsList":CrmPlusImpl.getOtherPortalsList(key);break;case"getdashboardslist":CrmPlusImpl.getDashboardsList();break;case"loadDashboard":CrmPlusImpl.loadDashboard(key);break;case"handleUIChange":CrmPlusImpl.handleUIChange(key);break;case"toggleSidepane":CrmPlusImpl.toggleSidepane(key);break;case"setBundleData":CrmPlusLib.setBundleData(valueJson)}}catch(e){}},CrmPlusLib.Constants={AppName:{workdrive:"teamdrive",projects:"projects",sprints:"sprints",analytics:"reports",dccloud:"dccloud",site24x7:"site24x7",mspadmin:"mspcentral"}},CrmPlusLib.setBundleData=function(data){if(CrmPlusLib.bundleData=data,data.cssFilePath&&"teamdrive"===CrmPlusLib.currentService){var style=document.createElement("link");style.href=data.cssFilePath,style.rel="stylesheet",style.type="text/css",style.onload=function(){document.body.classList.add("zod-bundle-theme","_blue")},document.head.appendChild(style)}},CrmPlusLib.getBundleData=function(){return CrmPlusLib.bundleData},CrmPlusLib.getAppSOID=function(appName){var appSOID=null;if(CrmPlusLib.bundleData&&CrmPlusLib.bundleData.apps){var appData=CrmPlusLib.bundleData.apps.find(function(app){return app.app_name===appName});appSOID=appData&&appData.zaaid}return appSOID},CrmPlusLib.handleAutoSuggestForPopup=function(position,isLeftPanelVisible,ispopup){try{if(void 0!==position){if(void 0!==CrmPlusLib.autoSuggestSearchIDs[CrmPlusLib.currentService]){var canCreateStyle=!1;try{null===document.getElementById("crmplusautosuggestpopupstyle")?canCreateStyle=!0:document.getElementById("crmplusautosuggestpopupstyle").getAttribute("isleftpanelvisible")==isLeftPanelVisible&&document.getElementById("crmplusautosuggestpopupstyle").getAttribute("ispopup")==ispopup||(document.getElementById("crmplusautosuggestpopupstyle").outerHTML="",canCreateStyle=!0)}catch(e){canCreateStyle=!0}if(canCreateStyle){var zindex="1101",styleHTML=".zcrmplus-cmstyles.crmplussearchpopup .hdrprt{z-index:1101;} .zcrmplus-cmstyles.crmplussearchpopup .srcmn";"crm"==CrmPlusLib.currentService?styleHTML=".crmplussearchpopup .primarySearchList":"support"==CrmPlusLib.currentService?styleHTML=".zcrmplus-cmstyles.crmplussearchpopup .globalautosugg_lookup-bg-black":"projects"==CrmPlusLib.currentService&&(styleHTML=".crmplussearchpopup #topnotify, .crmplussearchpopup #search-popup",zindex="20004");var styleContent={},topX=position.top+" !important",left=position.left+" !important",width=position.width+" !important";styleContent=JSON.stringify(styleContent),styleHTML=styleHTML+"{z-index:"+zindex+" !important;top:"+topX+";left:"+left+";width:"+width+"}","projects"==CrmPlusLib.currentService&&(styleHTML+=".crmplussearchpopup #search-popup{right:auto}"),"salesiq"==CrmPlusLib.currentService&&(styleHTML=styleHTML+".crmplussearchpopup #global_search_results{z-index:"+zindex+" !important;top:"+topX+";left:"+left+";width:"+width+"}");var styleElement=document.createElement("style");styleElement.setAttribute("id","crmplusautosuggestpopupstyle"),styleElement.setAttribute("isleftpanelvisible",isLeftPanelVisible),styleElement.setAttribute("ispopup",ispopup),styleElement.innerHTML=styleHTML,document.head.appendChild(styleElement)}void 0!==CrmPlusLib.timerForRemovingSearchClass&&clearTimeout(CrmPlusLib.timerForRemovingSearchClass),document.body.classList.add("crmplussearchpopup")}}else document.body.classList.remove("crmplussearchpopup")}catch(e){}},CrmPlusLib.pushNotification=function(json){var toPostMessage={type:"PushNotification"};toPostMessage.notifyData=json,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.setLiveChatAgentStatus=function(status){var toPostMessage={type:"SetLiveChatAgentStatus"};toPostMessage.status=status,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.setPhoneAgentStatus=function(status){var toPostMessage={type:"SetPhoneAgentStatus"};toPostMessage.statusData=status,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.updatePhoneAgentStatus=function(status){var toPostMessage={type:"UpdatePhoneAgentStatus"};toPostMessage.statusData=status,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.removeAgentStatus=function(channel){var toPostMessage={type:"RemoveAgentStatus"};toPostMessage.channel=channel,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.showChatNotification=function(notifyData){var toPostMessage={type:"ShowChatNotification"};toPostMessage.notifyData=notifyData,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.setNotificationSound=function(soundData){var toPostMessage={type:"SetNotificationSound"};toPostMessage.soundData=soundData,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.createWMSChat=function(zuid){var toPostMessage={type:"CreateWMSChat"};toPostMessage.zuid=zuid,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.showTopBarButton=function(buttonInfo){var toPostMessage={};toPostMessage.buttonInfo=buttonInfo,toPostMessage.type="showTopBarButton",CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.removeTopBarButton=function(){var toPostMessage={type:"removeTopBarButton"};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.enableDepartments=function(){var toPostMessage={state:!0,type:"toggleDepartments"};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.disableDepartments=function(){var toPostMessage={type:"toggleDepartments"};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.openServiceView=function(serviceName,url){var toPostMessage={};toPostMessage.serviceName=serviceName,toPostMessage.url=url,toPostMessage.type="openServiceView",CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.hideDevModePopup=function(){var toPostMessage={type:"hideDevModePopup"};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.hideChatBarUI=function(){try{var styleElement=document.createElement("style");styleElement.innerHTML="#wmstoolbar{display:none !important} #wms-hysearch{display:none !important} #wms-overlay{display:none !important} #wms-netdownbanner{display:none !important}",document.head.appendChild(styleElement),void 0!==CrmPlusLib.wmsUIReady&&CrmPlusLib.wmsUIReady()}catch(e){}},CrmPlusLib.handleChatBarTriggers=function(triggerObj){var toPostMessage={type:"handleChatBarTriggers"};toPostMessage.params=triggerObj,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.handleChatBarInService=function(){CrmPlusLib.hideChatBarUI();var counter=0,timerID=setInterval(function(){"undefined"!=typeof WebMessanger&&("function"==typeof WebMessanger.listenToApiInvocation&&WebMessanger.listenToApiInvocation(CrmPlusLib.handleChatBarTriggers),clearInterval(timerID)),++counter>=20&&clearInterval(timerID)},1e3)},CrmPlusLib.bindEventForShortCuts=function(){CrmPlusLib.addEventListener(window,"keyup",CrmPlusLib.handleKeyBoardShortCut,!0),CrmPlusLib.addEventListener(window,"keydown",CrmPlusLib.handleKeyBoardShortCut,!0),CrmPlusLib.addEventListener(window,"blur",function(){CrmPlusLib.pressedKeys=""},!0)},CrmPlusLib.removeEventListener=function(element,eventName,eventListener,useCapture){element.removeEventListener?element.removeEventListener(eventName,eventListener,useCapture):element.detachEvent("on"+eventName,eventListener)},CrmPlusLib.handleParentKeyBoardShortCut=function(event){"salesiq"!=CrmPlusLib.currentService&&void 0===CrmPlusImpl.handleKeyBoardShortCut||("salesiq"==CrmPlusLib.currentService?Shortcuts.handleShortcut(event):CrmPlusImpl.handleKeyBoardShortCut(event)),CrmPlusLib.isCtrlClick(event)&&80===event.keyCode&&(event.stopPropagation?event.preventDefault():event.returnValue=!1,window.print())},CrmPlusLib.handleKeyBoardShortCut=function(event){var target=event.target||event.srcElement||event.originalTarget;"INPUT"!==target.nodeName&&"TEXTAREA"!==target.nodeName&&"true"!==target.contentEditable&&("keydown"==event.type?(CrmPlusLib.sendKeyBoardShortCutEventToParent(event),32===event.keyCode&&!0===event.ctrlKey?CrmPlusLib.pressedKeys="ctrl+space":"support"!==CrmPlusLib.currentService&&(191!==event.keyCode||!1!==event.shiftKey||CrmPlusLib.isCtrlClick(event)?85!==event.keyCode||!1!==event.shiftKey||CrmPlusLib.isCtrlClick(event)?!0!==event.shiftKey||187!==event.keyCode&&61!==event.keyCode||(CrmPlusLib.pressedKeys="shift+"):CrmPlusLib.pressedKeys="u":CrmPlusLib.pressedKeys="/")):"keyup"==event.type&&(void 0!==CrmPlusLib.pressedKeys&&""!==CrmPlusLib.pressedKeys&&CrmPlusLib.sendKeyBoardShortCutToParent(CrmPlusLib.pressedKeys),CrmPlusLib.pressedKeys="",CrmPlusLib.sendKeyBoardShortCutEventToParent(event)),CrmPlusLib.isCtrlClick(event)&&80===event.keyCode&&(event.stopPropagation?event.preventDefault():event.returnValue=!1,window.print()))},CrmPlusLib.sendKeyBoardShortCutEventToParent=function(event){var toPostMessage={},eventInfo={};eventInfo.ctrlKey=event.ctrlKey,eventInfo.keyCode=event.keyCode,eventInfo.key=event.key,eventInfo.altKey=event.altKey,eventInfo.shiftKey=event.shiftKey,eventInfo.metaKey=event.metaKey,eventInfo.repeat=event.repeat,toPostMessage.eventInfo=eventInfo,toPostMessage.type="HandleKeyBoardShortCutEvent",CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.sendKeyBoardShortCutToParent=function(shortCutCode){var toPostMessage={type:"HandleKeyBoardShortCut"};toPostMessage.pressedKeys=shortCutCode,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.hideCrmPlusDialog=function(event){var toPostMessage={type:"HideCrmPlusDialog"};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.updateSalesInboxConfigurationData=function(configurationData){var toPostMessage={type:"updateSalesInboxConfigurationData"};toPostMessage.configurationData=configurationData,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.handleSetup=function(status,module,url){void 0!==CrmPlusImpl.setup&&void 0!==CrmPlusImpl.setup.show&&void 0!==CrmPlusImpl.setup.hide?status?CrmPlusImpl.setup.show():CrmPlusImpl.setup.hide(module):window.location.href=url},CrmPlusLib.handleAction=function(action,actionParam){"adduser"==action&&CrmPlusLib.isLoadedInFrame&&CrmPlusLib.addUser(actionParam)},CrmPlusLib.addListenerToModifyReferrer=function(){if(null===document.querySelector('meta[name="referrer"]')){var refererEle=document.createElement("meta");refererEle.setAttribute("name","referrer"),refererEle.setAttribute("content","unsafe-url"),document.head.appendChild(refererEle)}document.addEventListener("contextmenu",CrmPlusLib.setDOMReferrer),document.addEventListener("click",CrmPlusLib.setDOMReferrer),document.addEventListener("mouseout",CrmPlusLib.resetDOMReferrer),document.addEventListener("keypress",CrmPlusLib.setDOMReferrer),document.addEventListener("auxclick",CrmPlusLib.setDOMReferrer)},CrmPlusLib.resetDOMReferrer=function(e){void 0!==e.type&&"unsafe-url"!==CrmPlusLib.referrerTag&&(document.querySelector('meta[name="referrer"]').content="unsafe-url",CrmPlusLib.referrerTag="unsafe-url")},CrmPlusLib.isOpenInNewTab=function(e){var target=e.target,isNewTabLink=!1;null!==target&&("a"===target.tagName&&"_blank"===target.getAttribute("target")&&(isNewTabLink=!0));return isNewTabLink},CrmPlusLib.isUnifiedSpacesEnabled=function(){var toPostMessage={type:"isUnifiedSpacesEnabled"};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.isLoadedInUnifiedSpaces=function(){return CrmPlusLib.loadedInUnifiedSpaces},CrmPlusLib.isProjectsPlus=function(){var toPostMessage={type:"isProjectsPlus"};CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.isLoadedInProjectsPlus=function(){return CrmPlusLib.loadedInProjectsPlus},CrmPlusLib.isServiceModulesSplitted=function(){return CrmPlusLib.serviceModulesSplitted},CrmPlusLib.addStylesForSpaces=function(){if(CrmPlusLib.loadedInUnifiedSpaces)if("tasks"===CrmPlusLib.currentService)(style=document.createElement("style")).innerHTML="body.zodspaces-tasks .zmCollapseLhs {display: none}",document.head.appendChild(style);else if("teamdrive"===CrmPlusLib.currentService){(style=document.createElement("style")).innerHTML="body.zodspaces-org-files .zwd-leftpanel-primary,body.zodspaces-org-files .zwd-teamspace-header .secondary.menu .menu button:first-child+.zwd-v-divider{display:none!important}body.zodspaces-org-files .zwd-teamspace-header .secondary.menu button:has([DataSvgName=wd_pin]){display:none}body.zodspaces-org-files .zwd-teamspace-header .secondary.menu button:has([DataSvgName=wd_teamfolders_icon]){display:none}",document.head.appendChild(style)}else if("connect"===CrmPlusLib.currentService){var style;(style=document.createElement("style")).innerHTML="body.zodspaces-org-calendar .zc-leftContainer {display: none !important} body.zodspaces-org-calendar .zc-rightContainer {padding-left: 0 !important} body.zodspaces-org-calendar .zc-rightContainer .zc-pageHeader, body.zodspaces-org-calendar .zc-rightContainer .fc-toolbar, body.zodspaces-org-calendar .zc-rightContainer .calendarView .fc-view-container .fc-view .fc-head {left: 0 !important} body.zodspaces-connect .zc-leftContainer,body.zodspaces-connect .zc-leftContainer .zc-networkDropdownMenu{width:208px}body.zodspaces-connect .zc-rightContainer{padding-left:208px}body.zodspaces-connect .zc-rightContainer .zc-pageHeader{left:200px}body.zodspaces-connect .zc-navigation .zc-navigationList{display:none;width:208px}",document.head.appendChild(style)}},CrmPlusLib.modifyServiceDOMForSpaces=function(isRevert,isConnectEvents){CrmPlusLib.loadedInUnifiedSpaces&&("tasks"===CrmPlusLib.currentService?isRevert||(document.body.classList.add("zodspaces-tasks"),$(".msi-larrow").click()):"teamdrive"===CrmPlusLib.currentService?isRevert?document.body.classList.remove("zodspaces-org-files"):document.body.classList.add("zodspaces-org-files"):"connect"===CrmPlusLib.currentService&&(isConnectEvents?isRevert?(document.body.classList.remove("shirnkMenu"),document.body.classList.remove("zodspaces-org-calendar"),setTimeout(function(){alignCalendarOnResize()},400)):(document.body.classList.add("shirnkMenu"),document.body.classList.add("zodspaces-org-calendar"),$("li.calCompanyEvent")[0].click(),setTimeout(function(){alignCalendarOnResize()},400)):isRevert?document.body.classList.remove("zodspaces-connect"):document.body.classList.add("zodspaces-connect")))},CrmPlusLib.setDOMReferrer=function(e){var eventType=e.type,keyCode=e.keyCode,buttonType=e.button,isCtrlKey=CrmPlusLib.isCtrlClick(e);if(void 0!==eventType){var refererTag=document.querySelector('meta[name="referrer"]');("contextmenu"===eventType||isCtrlKey&&13===keyCode||isCtrlKey&&0===buttonType||1===buttonType||CrmPlusLib.isOpenInNewTab(e))&&"no-referrer"!==CrmPlusLib.referrerTag?(refererTag.content="no-referrer",CrmPlusLib.referrerTag="no-referrer"):"unsafe-url"!==CrmPlusLib.referrerTag&&(refererTag.content="unsafe-url",CrmPlusLib.referrerTag="unsafe-url")}},CrmPlusLib.isCtrlClick=function(event){return!0===(event&&(event.metaKey&&-1!=window.navigator.platform.indexOf("Mac")||event.ctrlKey&&-1==window.navigator.platform.indexOf("Mac")))},CrmPlusLib.addFrameUnLoadListener=function(){void 0!==window.onbeforeunload?(CrmPlusLib.addEventListener(window,"beforeunload",CrmPlusLib.beforeunload_handler),"motivator"!==CrmPlusLib.currentService&&CrmPlusLib.addEventListener(window,"unload",CrmPlusLib.removeFrameCookie)):CrmPlusLib.addFrameCookie()},CrmPlusLib.beforeunload_handler=function(){CrmPlusLib.addFrameCookie(),window.history.replaceState(null,void 0,window.location.href)},CrmPlusLib.addFrameCookie=function(){console.log("beforeunload--\x3e"+(new Date).toGMTString());try{var domain=window.parent.document.domain;(domain.endsWith("marketingplus.localzoho.com")||domain.endsWith("marketingplus.zoho.com"))&&CrmPlusLib.resetNewUICookie(CrmPlusLib.currentService)}catch(e){}var path="/"+CrmPlusLib.currentService+"/";"projects"===CrmPlusLib.currentService&&(path="/portal/"),document.cookie="crmplusframe=true;path="+path+";secure;"},CrmPlusLib.removeFrameCookie=function(){console.log("unload--\x3e"+(new Date).toGMTString());var date=new Date;date.setTime(date.getTime()-1e3);var expires=date.toGMTString(),path="/"+CrmPlusLib.currentService+"/";"projects"===CrmPlusLib.currentService&&(path="/portal/"),document.cookie="crmplusframe=true;path="+path+";expires="+expires},CrmPlusLib.jsonParse=function(toJson){try{return toJson=JSON.parse(toJson)}catch(e){}},CrmPlusLib.showAppliedFiltersOnSearch=function(searchText,filters){var toPostMessage={type:"showAppliedFiltersOnSearch"},filtersData={};filtersData.searchtext=searchText,filtersData.filters=filters,toPostMessage.filtersData=filtersData,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.resetNewUICookie=function(context){document.cookie="newcrmplusredirection=0; path=/"+context+"/; domain="+window.location.host.replace(window.location.host.split(".")[0],"")+"; secure;"},CrmPlusLib.tempLog=function(key,value){CrmPlusLib.zoLogToParent(key);var serviceName="";try{null===CrmPlusLib.currentService?("portal"===(serviceName=(serviceName=window.location.href.split(window.location.protocol+"//"+window.location.host)[1]).split("/")[1])&&(serviceName="projects"),"marketinghub"===serviceName&&(serviceName="hub")):serviceName=CrmPlusLib.currentService}catch(e){serviceName=CrmPlusLib.currentService}try{if(void 0===value&&(value=!0),CrmPlusLib.isCrossOrigin()){var toPostMessage={type:"tempLog"},paramObj={};paramObj.key="crmplus_"+serviceName+"_"+key,paramObj.value=value,toPostMessage.params=paramObj,CrmPlusLib.parent.sendMessage(toPostMessage)}else sessionStorage.setItem("crmplus_"+serviceName+"_"+key,value)}catch(e){}},CrmPlusLib.tempLog("LibraryLoaded"),CrmPlusLib.onDocumentClick=function(event){CrmPlusLib.setActive();try{var srcElement=event.target||event.srcElement||event.originalTarget;void 0!=srcElement&&"A"===srcElement.nodeName&&void 0!=srcElement.href&&0===srcElement.href.trim().indexOf("mailto:")&&srcElement.setAttribute("target","_top")}catch(e){}},CrmPlusLib.handleHighlighting=function(type,key,canHighlight){try{if(0!=document.body.offsetHeight&&canHighlight&&CrmPlusLib.currentModule==key)return}catch(e){return}var toPostMessage={type:"HandleHighlighting"};toPostMessage.canHighlight=canHighlight,toPostMessage.key=key,toPostMessage.uitype=type,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.isIntegratedWithCrmPlus=function(serviceJson){try{var serviceName=serviceJson.serviceName,zsoid=serviceJson.zsoid,portal=serviceJson.portalName,serviceData=CrmPlusLib.appsStatus[serviceName];if((serviceData.APPID==zsoid||serviceData.PORTAL==portal)&&serviceData.ISCONFIGURED)return!0}catch(e){}return!1},CrmPlusLib.enableApplication=function(serviceName,callbackFunction){callbackFunction()},CrmPlusLib.setBundleThemeToService=function(key){var bundleTheme=CrmPlusLib.bundleTheme[key];bundleTheme&&document.body.classList.add(bundleTheme)},CrmPlusLib.set=function(key,valueJson){var toPostMessage={type:"set"};toPostMessage.key=key,toPostMessage.value=valueJson,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.toggleZiaInteg=function(key,valueJson){var toPostMessage={type:"toggleZiaInteg"};toPostMessage.key=key,toPostMessage.value=valueJson,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.setupView={onbeforeload:function(){var toPostMessage={handler:"setupView.onbeforeload"};CrmPlusLib.parent.sendMessage(toPostMessage)},onafterload:function(){var toPostMessage={handler:"setupView.onafterload"};CrmPlusLib.parent.sendMessage(toPostMessage)},onclose:function(){var toPostMessage={handler:"setupView.onclose"};CrmPlusLib.parent.sendMessage(toPostMessage)}},CrmPlusLib.searchView={onbeforeload:function(){var toPostMessage={handler:"searchView.onbeforeload"};CrmPlusLib.parent.sendMessage(toPostMessage)},onafterload:function(){var toPostMessage={handler:"searchView.onafterload"};CrmPlusLib.parent.sendMessage(toPostMessage)},onclose:function(){var toPostMessage={handler:"searchView.onclose"};CrmPlusLib.parent.sendMessage(toPostMessage)}},CrmPlusLib.triggerHandler=function(handler,params){var toPostMessage={type:"triggerHandler"};toPostMessage.handler=handler,toPostMessage.params=params,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.getFrameOriginForURL=function(){if(CrmPlusLib.isCrossOrigin())return CrmPlusLib.parentOrigin},CrmPlusLib.handleZiaSearchUnification=function(){window.ZSLite=!0,window.openZSHandler=function(paramObj){var toPostMessage={type:"openParentZiaContainer"};toPostMessage.params=paramObj,CrmPlusLib.parent.sendMessage(toPostMessage)},window.openZiaAPIHandler=function(functionPathName,params){var toPostMessage={type:"openParentZiaContainer"};toPostMessage.params={functionPathName:functionPathName,params:params},CrmPlusLib.parent.sendMessage(toPostMessage)}},CrmPlusLib.credentials=function(type,params){var toPostMessage={};toPostMessage.params=params,toPostMessage.type=type+"Credentials",CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLib.sendDesktopNotification=function(data){var toPostMessage={};toPostMessage.params=data,toPostMessage.type="sendDesktopNotification",CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLibUtil={},CrmPlusLibUtil.callByMethodName=function(methodName,params){var functionRefJson=CrmPlusLibUtil.getParentAndMethodReferenceByName(methodName);if(functionRefJson&&"function"==typeof functionRefJson.reference)return functionRefJson.reference.apply(functionRefJson.parent,params);var toPostMessage={};toPostMessage.handler=methodName.slice("CrmPlusLib".length+1),toPostMessage.params=params,CrmPlusLib.parent.sendMessage(toPostMessage)},CrmPlusLibUtil.getParentAndMethodReferenceByName=function(methodName){if(null!==methodName&&void 0!==methodName){for(var parent,methodNamespaces=methodName.split("."),methodReference=window,i=0;i<methodNamespaces.length;i++)if(parent=methodReference,void 0===(methodReference=methodReference[methodNamespaces[i]]))return;return{parent:parent,reference:methodReference}}},CrmPlusLibUtil.stringToFunctionReference=function(fullyQualifiedName){var str;for(var functionRef,strArray=fullyQualifiedName.trim().split("."),parent=window,i=0;i<strArray.length;i++){if(functionRef=null,!parent[str=strArray[i]]||"object"!=typeof parent[str]&&"function"!=typeof parent[str])return null;"function"==typeof parent[str]&&(functionRef=parent[str]),parent=parent[str]}return functionRef},CrmPlusLibUtil.trigger=function(actionName,params){if(void 0!==CrmPlusLib)if(void 0!==(functionObject=CrmPlusLib[actionName])&&"function"==typeof functionObject)functionObject.apply(CrmPlusLib,params);else if("undefined"!=typeof CrmPlusLibUtil){var methodName="CrmPlusLib."+actionName;if(CrmPlusLibUtil.callByMethodName)CrmPlusLibUtil.callByMethodName(methodName,params);else if(CrmPlusLibUtil.stringToFunctionReference){var functionObject;(functionObject=CrmPlusLibUtil.stringToFunctionReference(methodName))&&"function"==typeof functionObject&&functionObject.apply(null,params)}}},CrmPlusLibUtil.updateTriggerAPI=function(){CrmPlusImpl.trigger&&-1==CrmPlusImpl.trigger.toString().indexOf("callByMethodName")&&(CrmPlusImpl.trigger=CrmPlusLibUtil.trigger)};try{-1!==navigator.userAgent.indexOf("Edge")&&(CrmPlusLib.isEdgeIssueReplaceCompleted=!0,CrmPlusLib.handleStateIssueInEdge=function(){try{1==CrmPlusLib.isEdgeIssueReplaceCompleted&&(CrmPlusLib.isEdgeIssueReplaceCompleted=!1,CrmPlusLib.historyStateToBeReset=history.state,setTimeout(CrmPlusLib.replaceHistoryStateForEdge,100))}catch(e){}},CrmPlusLib.replaceHistoryStateForEdge=function(){try{window.history.replaceState(CrmPlusLib.historyStateToBeReset,window.location.href),CrmPlusLib.isEdgeIssueReplaceCompleted=!0}catch(e){}})}catch(e){}