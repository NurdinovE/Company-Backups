$L&&($L.prototype.cropper=function(t){if("destroy"===t||"Destroy"===t){var e=this[0],i=e.parentElement,h=$L(i).find(".lyteCropArea")[0];h||(h=$L(i).find(".lytePSParent")[0]),i.removeChild(h),$L(e).data("cropper",{}),e.style.display="block"}else if(t&&(t.type||(t.type="default")),"default"===t.type){function p(t){return t.getBoundingClientRect()}var o,l,s=this[0],n=1,r=s.parentElement,a="n:n",d=1,c=t,g=!1;t&&t.useExif&&(g=t.useExif);var f=function(){},x=function(){};t&&(t.beforeRender&&(f=t.beforeRender),t.afterRender&&(x=t.afterRender));var y=0,m=0;c||(c={aspectRatio:"n:n"});var u,w,L,C,$,v,b,R,S,B,E,A,z,I,D,M,k,F,H,T,W,Y,V,N,P,X,G,U,O,_={},q=function(){},j=function(){},J=function(){},K=function(){};if(0!==r.querySelectorAll(".lyteCropArea").length){var Q=r.querySelectorAll(".lyteCropArea")[0];m=$L(s).data("cropper").exifAngle,$L(s).data("cropper")?(l=$L(s).data("cropper").angle,m=$L(s).data("cropper").exifAngle):l=y,r.removeChild(Q),s.style.display="block",o=p(s)}function Z(){s.complete&&0===r.querySelectorAll(".lyteCropArea").length&&(o=p(s),s.style.display="none"),s.removeEventListener("load",Z)}function tt(){u=document.createElement("DIV"),w=document.createElement("DIV"),L=document.createElement("DIV"),C=document.createElement("DIV"),v=document.createElement("DIV"),$=document.createElement("DIV"),b=document.createElement("DIV"),R=document.createElement("DIV"),S=document.createElement("DIV"),B=document.createElement("DIV"),E=document.createElement("DIV"),z=document.createElement("DIV"),A=document.createElement("DIV"),I=document.createElement("DIV"),k=document.createElement("SPAN"),F=document.createElement("SPAN"),H=document.createElement("SPAN"),T=document.createElement("SPAN"),Y=document.createElement("SPAN"),V=document.createElement("SPAN"),N=document.createElement("SPAN"),P=document.createElement("SPAN"),ct=document.createElement("IMG"),D=document.createElement("IMG"),M=document.createElement("IMG"),(W=s.parentElement).appendChild(u),u.appendChild(w),w.appendChild(L),L.appendChild(D),w.appendChild(C),w.appendChild($),$.appendChild(b),b.appendChild(Y),$.appendChild(R),R.appendChild(V),$.appendChild(S),S.appendChild(N),$.appendChild(B),B.appendChild(P),$.appendChild(E),$.appendChild(z),$.appendChild(I),$.appendChild(A),$.appendChild(k),$.appendChild(F),$.appendChild(H),$.appendChild(T),$.appendChild(v),v.appendChild(M)}function et(){switch(c&&(a=c.aspectRatio),c.cropStart&&(q=c.cropStart),c.cropDrag&&(j=c.cropDrag),c.onSet&&(J=c.onSet),c.cropEnd&&(K=c.cropEnd),a){case"n:n":d=void 0;break;case"1:1":d=1;break;case"2:3":d=2/3;break;case"3:2":d=1.5;break;case"4:3":d=4/3;break;case"3:4":d=3/4;break;case"16:9":d=16/9;break;case"9:16":d=9/16}n=s.naturalWidth/s.naturalHeight,s.naturalWidth>s.naturalHeight?gt="landscape":s.naturalWidth<=s.naturalHeight&&(gt="portrait"),tt(),u.setAttribute("class","lyteCropArea"),ct.setAttribute("class","lyteCropMainImage"),w.setAttribute("class","lyteCropBox"),L.setAttribute("class","lyteCropFixedDiv"),D.setAttribute("class","lyteCropFixedImage"),C.setAttribute("class","lyteCropOpacityDiv"),$.setAttribute("class","lyteCropCropper"),k.setAttribute("class","lytecropVerGrid1"),F.setAttribute("class","lytecropVerGrid2"),H.setAttribute("class","lytecropHorGrid1"),T.setAttribute("class","lytecropHorGrid2"),b.setAttribute("class","lyteCropTopEdge"),Y.setAttribute("class","lyteCropTopSpan"),R.setAttribute("class","lyteCropBottomEdge"),V.setAttribute("class","lyteCropBottomSpan"),S.setAttribute("class","lyteCropLeftEdge"),N.setAttribute("class","lyteCropLeftSpan"),B.setAttribute("class","lyteCropRightEdge"),P.setAttribute("class","lyteCropRightSpan"),E.setAttribute("class","lyteCropTopRightCorner"),z.setAttribute("class","lyteCropTopLeftCorner"),A.setAttribute("class","lyteCropBottomRightCorner"),I.setAttribute("class","lyteCropBottomLeftCorner"),v.setAttribute("class","lyteCropDivImage"),M.setAttribute("class","lyteCropDivImageImg"),function(){var t=function(){var t={};switch(gt){case"landscape":t.imageWidth=p(W).width,t.imageHeight=p(W).width/n;break;case"portrait":t.imageWidth=p(W).height*n,t.imageHeight=p(W).height}return t}();D.style.height=t.imageHeight+"px",D.style.width=t.imageWidth+"px",M.style.height=t.imageHeight+"px",M.style.width=t.imageWidth+"px",u.style.height=p(D).height+"px",u.style.width=p(D).width+"px";var e,i=(e={},"landscape"===gt?(e.imageTop=(p(W).height-p(D).height)/2,e.imageLeft=0):(e.imageTop=0,_lyteUiUtils.getRTL()?e.imageLeft="-"+(p(W).width-p(D).width)/2:e.imageLeft=(p(W).width-p(D).width)/2),e);u.style.left=i.imageLeft+"px",u.style.top=i.imageTop+"px";var h=function(){var t,e,i={};return D.src=ct.src=M.src=s.src,i.cropperWidth=ot(),i.cropperHeight=(t=d,"n:n"===a&&(t=1),c.selection?c.selection.size?(e=parseFloat(c.selection.size)/t,c.maxSize&&parseFloat(c.maxSize)<parseFloat(c.selection.size)&&(e=parseFloat(c.maxSize)/t),c.minSize&&parseFloat(c.minSize)>parseFloat(c.selection.size)&&(e=parseFloat(c.minSize)/t)):e=lt().height:e="n:n"===a?p(D).height:lt().height,e),i}();$.style.height=h.cropperHeight+"px",$.style.width=h.cropperWidth+"px";var o=function(){var t={};return c.selection?(c.selection.top?t.cropperTop=st().top:t.cropperTop=nt().cropperTop,c.selection.left?t.cropperLeft=st().left:t.cropperLeft=nt().cropperLeft):(t.cropperLeft=nt().cropperLeft,t.cropperTop=nt().cropperTop),t}();if($.style.top=o.cropperTop+"px",$.style.left=o.cropperLeft+"px",M.style.left=-o.cropperLeft+"px",M.style.top=-o.cropperTop+"px",w.style.overflow="unset",90===l||270===l){var r=p($),g=p(u);p(D);if(f=l)l-90,(f=l)>=360&&(f=0),D.style.transform="rotate("+f+"deg) rotateY("+m+"deg)",M.style.transform="rotate("+f+"deg) rotateY("+m+"deg)";else{var f=90;D.style.transform="rotate("+f+"deg) rotateY("+m+"deg)",M.style.transform="rotate("+f+"deg) rotateY("+m+"deg)"}d=1/d,gt="landscape"===gt?"portrait":"landscape",it(),at(r,g)}180!==l&&0!==l||(0===(f=l)?(l-90,(f=l)>=360&&(f=0),D.style.transform="rotate("+f+"deg) rotateY("+m+"deg)",M.style.transform="rotate("+f+"deg) rotateY("+m+"deg)"):(D.style.transform="rotate("+f+"deg) rotateY("+m+"deg)",M.style.transform="rotate("+f+"deg) rotateY("+m+"deg)")),dt(),$.addEventListener("mousedown",rt)}(),it(),dt()}function it(){switch(a){case"n:n":ht(1),pt(1);break;case"1:1":case"2:3":case"3:2":case"4:3":case"3:4":case"16:9":case"9:16":ht(d),pt(d)}}function ht(t){c.minSize?(G=c.minSize,X=c.minSize/t):(G=15,X=15/t)}function pt(t){var e=p(D);"landscape"===gt?c.maxSize?c.maxSize>e.width?(U=e.height,O=e.height*t,"n:n"===a&&(U=e.height,O=e.width)):(O=c.maxSize,U=c.maxSize/t,"n:n"===a&&(U=c.maxSize,O=c.maxSize)):(U=e.height,O=e.height*t,"n:n"===a&&(U=e.height,O=e.width)):"portrait"===gt&&(c.maxSize?c.maxSize>e.height?(U=e.width/t,O=e.width,"n:n"===a&&(U=e.height,O=e.width)):(O=c.maxSize*t,U=c.maxSize,"n:n"===a&&(U=c.maxSize,O=c.maxSize)):(U=e.width/t,O=e.width,"n:n"===a&&(U=e.height,O=e.width)))}function ot(t){var e;return c.selection?c.selection.size?(e=parseFloat(c.selection.size),c.maxSize&&parseFloat(c.maxSize)<parseFloat(c.selection.size)&&(e=parseFloat(c.maxSize)),c.minSize&&parseFloat(c.minSize)>parseFloat(c.selection.size)&&(e=parseFloat(c.minSize))):initialValue=lt().width:e="n:n"===a?p(D).width:lt().width,e}function lt(){var t={};return"landscape"===gt?(t.width=p(D).height*d,t.height=p(D).height):(t.width=p(D).width,t.height=p(D).width/d),t.width>p(D).width&&(t.width=p(D).width,t.height=p(D).width/d),t.height>p(D).height&&(t.height=p(D).height,t.width=p(D).height*d),t}function st(){var t={};return parseFloat(c.selection.top)+p($).height>p(C).bottom?t.top=p(C).height-p($).height:t.top=parseFloat(c.selection.top),parseFloat(c.selection.left)+p($).width>p(C).right?t.left=p(C).width-p($).width:t.left=parseFloat(c.selection.left),t}function nt(){var t={};return t.cropperTop=(p(C).height-p($).height)/2,t.cropperLeft=(p(D).width-p($).width)/2,t}function rt(t){var e;switch(q(),k.style.opacity=F.style.opacity=H.style.opacity=T.style.opacity=1,C.style.opacity="0.6",t.preventDefault(),e="lyteCropDivImageImg"===t.target.className||"lyteCropDivImage"===t.target.className?"parent":"child",$L(".lyteCropTopEdge")[0],$L(".lyteCropRightEdge")[0],$L(".lyteCropBottomEdge")[0],$L(".lyteCropLeftEdge")[0],$L(".lyteCropTopRightCorner")[0],$L(".lyteCropBottomRightCorner")[0],$L(".lyteCropBottomLeftCorner")[0],$L(".lyteCropTopLeftCorner")[0],e){case"parent":if("lyteCropDivImage"===t.target.className||"lyteCropDivImageImg"===t.target.className){var i=p($),h=p(C),o=p(u),l=p(w),s=(p(D),t.clientX),n=t.clientY,r=h.left-o.left,c=h.right-i.width-l.left,g=h.top-o.top;function f(t){k.style.opacity=F.style.opacity=H.style.opacity=T.style.opacity=1,t.preventDefault();var e=t.clientX,l=t.clientY;i.top+(l-n)-o.top+o.top>h.top?$.style.top=i.top+(l-n)-o.top+"px":$.style.top=g+"px",i.left+(e-s)-o.left+o.left>h.left?$.style.left=i.left+(e-s)-o.left+"px":$.style.left=r+"px",i.right+(e-s)-o.right+o.right<h.right||($.style.left=c+"px"),i.bottom+(l-n)-o.bottom+o.bottom<h.bottom||($.style.top=h.bottom-i.height-o.top+"px");var a=D.style.transform;D.style.transform="rotate(0deg)",M.style.left=p(D).left-p($).left+"px",M.style.top=p(D).top-p($).top+"px",D.style.transform=a,dt()}o.bottom,o.bottom,h.bottom,i.height,window.innerHeight,o.bottom,document.addEventListener("mousemove",f),document.addEventListener("mouseup",(function t(){C.style.opacity="",k.style.opacity=F.style.opacity=H.style.opacity=T.style.opacity=0,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",t),document.removeEventListener("mousedown",f),dt(),J()}))}break;case"child":{var x,y=p($),m=y.left,L=y.top,v=y.width,b=y.height,R=y.right,S=y.bottom,B=p(C),E=B.top,A=B.left,z=B.width,I=B.height,W=B.bottom,Y=B.right,V=p(u),N=V.top,P=V.left,_=(V.width,V.height,V.right),Q=V.bottom,Z=p(w),tt=(Z.height,Z.width,Z.left,Z.top,p(D)),et=tt.left,it=tt.top,ht=tt.width,pt=tt.height,ot=(s=t.clientX,n=t.clientY,y.top+y.height/2-V.top),lt=y.left+y.width/2-V.left;function st(t){if(dt(),!1!==j()){var e,i,h,o,l,r,c=t.clientX,g=t.clientY,f=t.clientX,y=t.clientY,u=p($);switch(x){case"lyteCropLeftEdge":if(k(),e=0,i=0,h=0,o=0,v-(c-s)>=G&&v-(c-s)<=O)c>A&&(h=v-(f-s)+"px",o=(v-(f-s))/d+"px",e=L-N+(f-s)/d/2+"px",i=m-P+(c-s)+"px",$L($).css({width:h,height:o,top:e,left:i})),k(),c-6<=A&&(u.height>=I&&(u.width>=z||!(u.top<E))||(e=W-((z-(Y-R))/d+(W-(ot+(z-(Y-R))/d/2)))+"px",i=A-P+"px",$L($).css({top:e,left:i})),i=A-P+"px",h=R-A+"px",o=(z-(Y-R))/d+"px",$L($).css({width:h,height:o,left:i})),k(),u.bottom>=W&&(e=W-u.height-N+"px",$L($).css({top:e})),k(),u.top<=E&&(e=E-N+"px",$L($).css({top:e})),k(),u.bottom>=W&&u.top<=E&&(i=R-(W-E)*d-P+"px",h=(W-E)*d+"px",o=W-E+"px",e=E-N+"px",$L($).css({width:h,height:o,top:e,left:i}));else if(v-(c-s)<=G)"n:n"!==a?(i=R-G-P+"px",e=ot-X/2+"px",h=G+"px",o=X+"px",$L($).css({width:h,height:o,top:e,left:i})):(i=R-G-P+"px",h=G+"px",$L($).css({width:h,left:i}));else if(v-(c+6-s)>=O)if("n:n"!==a){var w=(v-(f-s))/d;((C=v-(f-s))>=O||w>=U)&&c+6<=A&&R-A>=O&&(i=R-O-P+"px",k(),(e=ot-U/2)<0&&(e=0),e>W-U-E&&(e=W-U-E),h=O+"px",o=U+"px",$L($).css({width:h,height:o,top:e,left:i}))}else O!=ht?(i=R-O-A,h=O+"px"):(i=0,h=R-A+"px"),$L($).css({width:h,left:i});break;case"lyteCropTopEdge":k(),e=0,i=0,h=0,o=0,b-(g-n)>=X&&b-(g-n)<=U?(g>E+6&&(h=(b-(g-n))*d+"px",o=b-(g-n)+"px",i=m-P+(g-n)*d/2+"px",e=L-N+(g-n)+"px",$L($).css({width:h,height:o,top:e,left:i})),k(),g-6<=E&&(u.height>=I&&(u.width>=z||!(u.left<A))||(i=Y-((S-E)*d+(Y-(lt+(S-E)*d/2)))+"px",e=E-N+"px",$L($).css({top:e,left:i})),h=(S-E)*d+"px",o=S-E+"px",$L($).css({width:h,height:o})),k(),u.left<=A&&(i=A-P+"px",$L($).css({left:i})),k(),u.right>=Y&&(i=Y-u.width-P+"px",$L($).css({left:i})),k(),u.right>=Y&&u.left<=A&&(h=Y-A+"px",o=(Y-A)/d+"px",e=S-(Y-A)/d-N+"px",i=A-P+"px",$L($).css({width:h,height:o,top:e,left:i}))):b-(g-n)<=X?"n:n"!==a?(e=S-X-N+"px",i=lt-G/2+"px",h=G+"px",o=X+"px",$L($).css({width:h,height:o,top:e,left:i})):(e=S-X-N+"px",o=X+"px",$L($).css({height:o,top:e})):b-(g-n)>=U&&("n:n"!==a?(w=b-(g-n),((C=(b-(g-n))*d)>=O||w>=U)&&g-6<E&&S-E>=U&&(e=S-U-N+"px",k(),(i=lt-O/2)<0&&(i=0),i>Y-O-A&&(i=Y-O-A),h=O+"px",o=U+"px",$L($).css({width:h,height:o,top:e,left:i}))):(U!=pt?(e=S-U-E,o=U+"px"):(e=0,o=S-E+"px"),$L($).css({height:o,top:e})));break;case"lyteCropRightEdge":if(k(),e=0,l=0,h=0,o=0,i=0,v+(f-s)>=G&&v+(f-s)<=O)f<Y&&(h=v+(f-s)+"px",o=(v+(f-s))/d+"px",e=L-N-(f-s)/d/2+"px",l=R-_-(f-s)+"px",$L($).css({width:h,height:o,top:e,right:l})),f>=Y&&(e=ot-(Y-m)/d/2+"px",h=Y-m+"px",o=(Y-m)/d+"px",$L($).css({width:h,height:o,top:e})),k(),u.bottom>=W&&(e=W-u.height-N+"px",$L($).css({top:e})),k(),u.top<=E&&(e=E-N+"px",$L($).css({top:e})),k(),u.bottom>=W&&u.top<=E&&(i=m-P+"px",h=(W-E)*d+"px",o=W-E+"px",$L($).css({width:h,height:o,left:i}));else if(v+(f-s)<=G)"n:n"!==a?(e=ot-X/2+"px",h=G+"px",o=X+"px",$L($).css({width:h,height:o,top:e})):(h=G+"px",$L($).css({width:h}));else if(v+(c-s)>=O)if("n:n"!==a){var C=v+(f-s);((w=(v+(f-s))/d)>=U||C>=O)&&m<=Y-O&&((e=ot-U/2)<0&&(e=0),e>W-U-E&&(e=W-U-E),h=O+"px",o=U+"px",$L($).css({width:h,height:o,top:e}))}else h=O!=ht?O+"px":Y-m+"px",$L($).css({width:h});break;case"lyteCropBottomEdge":k(),e=0,l=0,h=0,o=0,i=0,b+(g-n)>=X&&b+(g-n)<=U?(g<W&&(h=(b+(y-n))*d+"px",o=b+(g-n)+"px",i=m-P-(y-n)*d/2+"px",r=S-Q-(y-n)+"px",$L($).css({width:h,height:o,left:i,bottom:r})),g>=W&&(i=lt-(W-L)*d/2+"px",h=(W-L)*d+"px",o=W-L+"px",$L($).css({width:h,height:o,left:i})),k(),u.left<=A&&(i=A-P+"px",$L($).css({left:i})),k(),u.right>=Y&&(i=Y-u.width-P+"px",$L($).css({left:i})),k(),u.right>=Y&&u.left<=A&&(i=A-P+"px",h=Y-A+"px",o=(Y-A)/d+"px",$L($).css({width:h,height:o,left:i}))):b+(g-n)<=X?"n:n"!==a?(i=lt-G/2+"px",h=G+"px",o=X+"px",$L($).css({width:h,height:o,left:i})):(o=X+"px",$L($).css({height:o})):b+(g-n)>=U&&("n:n"!==a?(w=b+(g-n),((C=(b+(y-n))*d)>=O||w>=U)&&L<=W-U&&((i=lt-O/2)<0&&(i=0),i>Y-O-A&&(i=Y-O-A),h=O+"px",o=U+"px",$L($).css({width:h,height:o,left:i}))):(o=U!=pt?U+"px":W-L+"px",$L($).css({height:o})));break;case"lyteCropTopRightCorner":k(),e=0,l=0,h=0,o=0,i=0,"n:n"===a?(v+(f-s)>=G&&v+(f-s)<=O?f<Y&&(h=v+(f-s)+"px",$L($).css({width:h}),$L($).css({width:h})):v+(f-s)<G?f<=m&&(h=G+"px",$L($).css({width:h})):v+(f-s)>O&&f>=Y&&(h=O!=ht?O+"px":Y-m+"px",$L($).css({width:h})),b-(y-n)>=X&&b-(y-n)<=U?y>E&&(e=L-N+(g-n)+"px",o=b-(y-n)+"px",$L($).css({height:o,top:e})):b-(y-n)<X?y>S&&(o=X+"px",e=S-X-E+"px",$L($).css({height:o,top:e})):b-(y-n)>U&&y<=E&&(U!=pt?(e=S-U-E+"px",o=U+"px"):(e=E-it+"px",o=S-E+"px"),$L($).css({height:o,top:e}))):b-(g-n)>=X&&b-(g-n)<=U?(g>=E+5&&(h=(b-(g-n))*d+"px",o=b-(g-n)+"px",e=L-N+(g-n)+"px",l=R-_-(c-s)+"px",$L($).css({width:h,height:o,top:e,right:l})),k(),g<E+5&&(u.height>=I&&(u.width>=z||!(u.left<A))||(e=E-N+"px"),h=(S-E)*d+"px",o=S-E+"px",$L($).css({width:h,height:o,top:e})),k(),u.right>=Y&&(e=S-(Y-m)/d-N+"px",h=Y-m+"px",o=(Y-m)/d+"px",$L($).css({width:h,height:o,top:e}))):b-(g-n)<=X?(e=S-X-N+"px",h=G+"px",o=X+"px",$L($).css({width:h,height:o,top:e})):b-(g-n)>=U&&(w=b-(g-n),((C=(b-(g-n))*d)>=O||w>=U)&&g-6<E&&S-E>=U&&m<=Y-O&&(e=S-U-N+"px",(i=lt-O/2)<0&&(i=0),i>Y-O-A&&(i=Y-O-A),h=O+"px",o=U+"px",$L($).css({width:h,height:o,top:e})));break;case"lyteCropTopLeftCorner":k(),e=0,l=0,h=0,o=0,i=0,"n:n"===a?(k(),v-(c-s)>=G&&v-(c-s)<=O?c>A&&(h=v-(f-s)+"px",i=m-P+(c-s)+"px",$L($).css({width:h,left:i})):v-(c-s)<G?f>R&&(h=G+"px",i=R-G-A+"px",$L($).css({width:h,left:i})):v-(c-s)>O&&c<=A&&(O!=ht?(h=O+"px",i=R-O-A+"px"):(h=R-A+"px",i=A-et+"px"),$L($).css({width:h,left:i})),b-(y-n)>=X&&b-(y-n)<=U?y>E&&(e=L-N+(g-n)+"px",o=b-(y-n)+"px",$L($).css({height:o,top:e})):b-(y-n)<X?y>S&&(o=X+"px",e=S-X-E+"px",$L($).css({height:o,top:e})):b-(y-n)>U&&y<=E&&(U!=pt?(e=S-U-E+"px",o=U+"px"):(e=E-it+"px",o=S-E+"px"),$L($).css({height:o,top:e}))):b-(g-n)>=X&&b-(g-n)<=U?(g>=E+5&&(h=(b-(g-n))*d+"px",o=b-(g-n)+"px",e=L-N+(g-n)+"px",i=m-P+(g-n)*d+"px",$L($).css({width:h,height:o,left:i,top:e})),k(),g-6<=E&&(u.height>I&&(u.width>z||!(u.left<A))||(i=Y-((S-E)*d+(Y-R))-P+"px",e=E-N+"px"),h=(S-E)*d+"px",o=S-E+"px",$L($).css({width:h,height:o,left:i,top:e})),k(),u.left<=A&&(e=S-(R-A)/d-N+"px",i=A-P+"px",h=R-A+"px",o=(R-A)/d+"px",$L($).css({width:h,height:o,left:i,top:e}))):b-(g-n)<=X?"n:n"!==a&&(e=S-X-N+"px",i=R-G-P+"px",h=G+"px",o=X+"px",$L($).css({width:h,height:o,left:i,top:e})):b-(g-n)>=U&&(w=b-(g-n),((C=(b-(g-n))*d)>=O||w>=U)&&g-6<E&&S-E>=U&&R-A>=O&&(e=S-U-N+"px",(i=lt-O/2)<0&&(i=0),i>Y-O-A&&(i=Y-O-A),h=O+"px",o=U+"px",$L($).css({width:h,height:o,top:e,left:i})));break;case"lyteCropBottomRightCorner":k(),e=0,l=0,h=0,o=0,i=0,"n:n"===a?(k(),b+(g-n)>=X&&b+(g-n)<=U?g<W&&(o=b+(g-n)+"px",$L($).css({height:o})):b+(g-n)<X?y<L&&(o=X+"px",$L($).css({height:o})):b+(g-n)>U&&g>=W&&(o=U!=pt?U+"px":W-L+"px",$L($).css({height:o})),v+(c-s)>=G&&v+(c-s)<=O?c<Y&&(h=v+(c-s)+"px",$L($).css({width:h})):v+(c-s)<G?f<=m&&(h=G+"px",$L($).css({width:h})):v+(c-s)>O&&c>=Y&&(h=O!=ht?O+"px":Y-m+"px",$L($).css({width:h}))):v+(f-s)>=G&&v+(f-s)<=O?(f<Y&&(h=v+(f-s)+"px",o=(v+(f-s))/d+"px",$L($).css({width:h,height:o})),k(),u.right>=Y-5&&f>=Y-5&&(h=Y-m+"px",o=(Y-m)/d+"px",$L($).css({width:h,height:o})),k(),u.bottom>=W&&(o=W-L+"px",h=(W-L)*d+"px",$L($).css({width:h,height:o}))):v+(f-s)<=G?(h=G+"px",o=X+"px",$L($).css({width:h,height:o})):v+(f-s)>=O&&(C=v+(f-s),((w=(v+(f-s))/d)>=U||C>=O)&&W-L>=U&&Y-m>=O&&(h=O+"px",o=U+"px",$L($).css({width:h,height:o})));break;case"lyteCropBottomLeftCorner":k(),e=0,l=0,h=0,o=0,i=0,"n:n"===a?(k(),v-(c-s)>=G&&v-(c-s)<=O?c>A&&(h=v-(f-s)+"px",i=m-P+(c-s)+"px",$L($).css({width:h,left:i})):v-(c-s)<G?f>R&&(h=G+"px",i=R-G-A+"px",$L($).css({width:h,left:i})):v-(c-s)>O&&c<=A&&(O!=ht?(h=O+"px",i=R-O-A+"px"):(h=R-A+"px",i=A-et+"px"),$L($).css({width:h,left:i})),b+(g-n)>=X&&b+(g-n)<=U?g<W&&(o=b+(g-n)+"px",$L($).css({height:o})):b+(g-n)<X?y<L&&(o=X+"px",$L($).css({height:o})):b+(g-n)>U&&g>=W&&(o=U!=pt?U+"px":W-L+"px",$L($).css({height:o}))):v-(c-s)>=G&&v-(c-s)<=O?(c>A&&(h=v-(f-s)+"px",o=(v-(f-s))/d+"px",i=m-P+(c-s)+"px",$L($).css({width:h,height:o,left:i})),k(),c-6<=A+2&&(u.height>=I&&(u.width>=z||!(u.left<A))||(i=A-P+"px"),h=R-A+"px",o=(R-A)/d+"px",$L($).css({width:h,height:o,left:i})),k(),u.bottom>=W&&(o=W-L+"px",h=(W-L)*d+"px",i=Y-((W-L)*d+(Y-R))-P+"px",$L($).css({width:h,height:o,left:i}))):v-(c-s)<=G?"n:n"!==a&&(i=R-G-P+"px",h=G+"px",o=X+"px",$L($).css({width:h,height:o,left:i})):v-(c-s)>=O&&"n:n"!==a&&(C=v-(f-s),((w=(v-(f-s))/d)>=U||C>=O)&&c-6<A&&R-A>=O&&W-L>=U&&(i=R-O-P+"px",h=O+"px",o=U+"px",$L($).css({width:h,height:o,left:i})))}var B=D.style.transform;D.style.transform="rotate(0deg)",M.style.left=p(D).left-p($).left+"px",M.style.top=p(D).top-p($).top+"px",D.style.transform=B,dt()}function k(){u=p($)}}r=B.left-V.left,g=B.top-V.top,c=B.right-y.width-Z.left,x=""===t.target.className?t.target.parentElement.className:t.target.className,document.addEventListener("mousemove",st),document.addEventListener("mouseup",(function t(){C.style.opacity="",k.style.opacity=F.style.opacity=H.style.opacity=T.style.opacity=0,document.removeEventListener("mousemove",st),document.removeEventListener("mouseup",t),dt(),K()}))}}}function at(t,e,i,h,l){var s=D.style.transform.match(/-?\d+/g)[0],n=parseInt(s),c=n;if(90===(n=Math.abs(n))||270===n){if(o.height<o.width){D.style.width=M.style.width=p(r).height+"px",D.style.height=M.style.height="auto",u.style.height=p(r).height+"px",u.style.top="0px",u.style.width=p(D).width+"px";var g=Math.abs(p(u).left-p(D).left);_lyteUiUtils.getRTL()?(u.style.left="-"+(p(r).width-p(u).width)/2+"px",D.style.left=-g+"px"):(u.style.left=(p(r).width-p(u).width)/2+"px",D.style.left=-g+"px")}else if(o.height>o.width){D.style.width=M.style.width="auto",D.style.height=M.style.height=p(r).width+"px",u.style.width=p(r).width+"px",u.style.left="0px",u.style.height=p(D).height+"px",u.style.top=(p(r).height-p(u).height)/2+"px";var f=Math.abs(p(u).left-p(D).left);_lyteUiUtils,D.style.left=f+"px"}D.style.top=p(u).top-p(D).top+"px",it(),"n:n"!==a?(X=p(u).height/e.width*15,G=X*d):(X=p(u).height/e.width*15,G=X);var x=m=t.height*p(u).width/e.height,y=L=t.width*p(u).height/e.width;G>m&&"n:n"!=a&&(y=(x=G)/d),X>L&&"n:n"!=a&&(x=(y=X)*d),$.style.width=x+"px",$.style.height=y+"px",-90!==c&&-270!==c||($.style.left=(t.top-e.top)*p(u).width/e.height+"px",$.style.top=p(u).height-((t.left-e.left)*p(u).height/e.width+p($).height)+"px"),90!==c&&270!==c||($.style.top=(t.left-e.left)*p(u).height/e.width+"px",$.style.left=p(u).width-(p($).width+(t.top-e.top)*p(u).width/e.height)+"px")}else{var m,L;o.height<o.width?(D.style.width=M.style.width=p(r).width+"px",D.style.height=M.style.height="auto",u.style.width=p(r).width+"px",u.style.left="0px",u.style.right="",u.style.height=p(D).height+"px",u.style.top=(p(r).height-p(u).height)/2+"px",D.style.left=(p(u).width-p(D).width)/2+"px"):(D.style.width=M.style.width="auto",D.style.height=M.style.height=p(r).height+"px",u.style.height=p(r).height+"px",u.style.top="0px",u.style.width=p(D).width+"px",_lyteUiUtils.getRTL()?u.style.left="-"+(p(r).width-p(u).width)/2+"px":u.style.left=(p(r).width-p(u).width)/2+"px",D.style.left=(p(u).width-p(D).width)/2+"px"),D.style.top=(p(w).height-p(D).height)/2+"px",it(),x=m=t.height*p(u).width/e.height,y=L=t.width*p(u).height/e.width,X>L&&"n:n"!=a&&(x=(y=X)*d),$.style.width=x+"px",$.style.height=y+"px",-180===c&&($.style.top=p(u).height-((t.left-e.left)*p(u).height/e.width+p($).height)+"px",$.style.left=(t.top-e.top)*p(u).width/e.height+"px"),0!==c&&180!==c||($.style.top=(t.left-e.left)*p(u).height/e.width+"px",$.style.left=p(u).width-(p($).width+(t.top-e.top)*p(u).width/e.height)+"px")}var C=D.style.transform;D.style.transform="rotate(0deg)",M.style.left=p(D).left-p($).left+"px",M.style.top=p(D).top-p($).top+"px",D.style.transform=C}function dt(){var t,e,i,h=p($);_.cropperDimensions={top:$.offsetTop,left:$.offsetLeft,width:h.width,height:h.height},_.imageDimension=o,_.resolution=(t=$L(".lyteCropDivImageImg")[0],e=t.naturalWidth/t.getBoundingClientRect().width,i=t.naturalHeight/t.getBoundingClientRect().height,90!==_.angle&&270!==_.angle||(e=t.naturalHeight/t.getBoundingClientRect().width,i=t.naturalWidth/t.getBoundingClientRect().height),{width:$.getBoundingClientRect().width*e,height:$.getBoundingClientRect().height*i}),_.rotate=function(){var t=p($),e=p(u),i=(p(D),D.style.transform);if(i)(h=i.match(/-?\d+/g))[0],(h=parseInt(h[0])+90)>=360&&(h=0),D.style.transform="rotate("+h+"deg) rotateY("+m+"deg)",M.style.transform="rotate("+h+"deg) rotateY("+m+"deg)";else{var h=90;D.style.transform="rotate("+h+"deg) rotateY("+m+"deg)",M.style.transform="rotate("+h+"deg) rotateY("+m+"deg)"}l=h,_.angle=h,d=1/d,gt="landscape"===gt?"portrait":"landscape",at(t,e),dt()},_.getCroppedImage=function(){var t=$L(".lyteCropDivImageImg")[0],e=p($),i=p(u),h=p(M);return t.naturalWidth,e.width,function(p,o){var l=document.createElement("CANVAS"),s=l.getContext("2d");l.style.background="#eee";var n,r,a=D.style.transform,d=0;a&&(d=a.match(/-?\d+/g),d=parseInt(d[0])),90!==Math.abs(d)&&270!==Math.abs(d)&&(M.style.transform="rotate(0deg) rotateY("+m+"deg)");var c=i.left-e.left,g=i.top-e.top;if(90!==Math.abs(d)&&270!==Math.abs(d)?(l.width=Math.round(e.width*(p.naturalWidth/h.width)),l.height=Math.round(e.height*(p.naturalHeight/h.height)),n=p.naturalWidth,r=p.naturalHeight):(l.height=Math.round(e.height*(p.naturalWidth/h.height)),l.width=Math.round(e.width*(p.naturalHeight/h.width)),r=p.naturalWidth,n=p.naturalHeight),c*=n/h.width,g*=r/h.height,M.style.transform=a,0!==d||180===m){s.save(),Math.abs(d)%90==0&&180!==Math.abs(d)&&360!==Math.abs(d)&&(p.naturalWidth,p.naturalHeight);var f=n/2,x=r/2;Math.abs(d)%90==0&&0!=d&&180!==Math.abs(d)&&360!==Math.abs(d)?(s.translate(c+f,g+x),s.rotate(d*(Math.PI/180)),180===m&&s.scale(-1,1),s.drawImage(t,-x,-f,r,n)):(s.translate(c+n/2,g+r/2),s.rotate(d*(Math.PI/180)),180===m&&s.scale(-1,1),s.drawImage(t,-n/2,-r/2,n,r)),s.restore()}else s.drawImage(p,c,g,n,r);return l}(t)},_.changeByHeight=function(t){var e,i,h=p($),o=p(C),l=parseFloat(t);l+p($).top<=p(C).bottom||(l=p(C).bottom-p($).top);var s=p($).left+p($).width/2-p(C).left;l>=U&&(l=U),l<=X&&(l=X);var n=l*d;h.top+l>=o.bottom&&(i=o.bottom-l-o.top,$L($).css({top:i}));var r=s-n/2;r>=0&&$L($).css({left:r}),r+n>=p(C).right-p(C).left&&(r=p(C).right-n-p(C).left,$L($).css({left:r})),"n:n"!==a?$L($).css({width:n,height:l}):(n=p($).width,$L($).css({height:l})),"NaN"===t&&(n=G,l=X),e={cropperWidth:n,cropperHeight:l};var c=D.style.transform;return D.style.transform="rotate(0deg)",M.style.left=p(D).left-p($).left+"px",M.style.top=p(D).top-p($).top+"px",D.style.transform=c,dt(),e},_.changeByWidth=function(t){var e,i,h=parseFloat(t);h+p($).left<=p(C).right||(h=p(C).right-p($).left);var o=p($),l=p(C),s=p($).top+p($).height/2-p(C).top;h>=O&&(h=O),h<=G&&(h=G);var n=h/d;o.left+h>=l.right&&(i=l.right-h-l.left,$L($).css({left:i}));var r=s-n/2;r>=0&&$L($).css({top:r}),r+n>=p(C).bottom-p(C).top&&(r=p(C).bottom-n-p(C).top,$L($).css({top:r})),"n:n"!==a?$L($).css({width:h,height:n}):(n=p($).height,$L($).css({width:h})),"NaN"===t&&(h=G,n=X),e={cropperWidth:h,cropperHeight:n};var c=D.style.transform;return D.style.transform="rotate(0deg)",M.style.left=p(D).left-p($).left+"px",M.style.top=p(D).top-p($).top+"px",D.style.transform=c,dt(),e},_.moveCropperInXaxis=function(t){var e=p($),i=p(C),h=t+e.width;t>=0&&h<=i.width&&($L($).css({left:t}),$L(M).css({left:-1*t})),t<0&&(t=0,$L($).css({left:t}),$L(M).css({left:-1*t})),h>i.width&&(t=i.width-e.width,$L($).css({left:t}),$L(M).css({left:-1*t}))},_.moveCropperInYaxis=function(t){var e=p($),i=p(C),h=t+e.height;t>=0&&h<=i.height&&($L($).css({top:t}),$L(M).css({top:-1*t})),t<0&&(t=0,$L($).css({top:t}),$L(M).css({top:-1*t})),h>i.height&&(t=i.height-e.height,$L($).css({top:t}),$L(M).css({top:-1*t}))},_.deleteCropper=function(){r.removeChild(u),s.style.display="block"},_.swapAspectRatio=function(){d=1/d,it();var t,e,i,h,o=p($).height,l=p($).width,s=p($).height/2+p($).top,n=p($).width/2+p($).left;p($).top+l>p(C).bottom?(t=p(C).bottom-l-p(C).top,$L($).css({top:t})):((t=s-p($).width/2-p(C).top)<=0&&(t=0),$L($).css({top:t})),p($).left+o>p(C).right?(e=p(C).right-o-p(C).left,$L($).css({left:e})):((e=n-p($).height/2-p(C).left)<=0&&(e=0),$L($).css({left:e})),$L($).css({width:o,height:l}),l>=p(D).height&&(i=p(D).height*d,h=p(D).height,e=(p(D).width-i)/2,$L($).css({height:h,width:i,top:0,left:e})),o>=p(D).width&&(i=p(D).width,h=p(D).width/d,t=(p(D).height-h)/2,$L($).css({height:h,width:i,left:0,top:t}));var r=D.style.transform;D.style.transform="rotate(0deg)",M.style.left=p(D).left-p($).left+"px",M.style.top=p(D).top-p($).top+"px",D.style.transform=r+"rotateY("+m+")",dt()},_.angle=l,_.exifAngle=m,$L(s).data("cropper",_)}"from-image"!==getComputedStyle(s).imageOrientation&&g?$L.exif&&$L.exif({target:s,getData:function(t){if(s=t.target,"from-image"!==getComputedStyle(s).imageOrientation){switch(t.exifdata.Orientation){case 1:y=0;break;case 2:y=0,m=180;break;case 3:y=180;break;case 4:y=180,m=180;break;case 5:y=270,m=180;break;case 6:y=90;break;case 7:y=90,m=180;break;case 8:y=270}f(t.exifdata.Orientation),Z(),$L(s).data("cropper")?(l=$L(s).data("cropper").angle,m=$L(s).data("cropper").exifAngle):l=y,s.style.display="none",et(),x()}}}):(f(),Z(),et(),x())}else if("DP"===t.type){var ct,gt,ft,xt,yt,mt,ut,wt,Lt,Ct=(ct=this[0]).getBoundingClientRect(),$t=ct.parentElement,vt=$t.getBoundingClientRect();_={},t||(t={}),t.cropperSize||(t.cropperSize=300),gt=Ct.height<Ct.width?"landscape":"portrait";var bt,Rt,St,Bt,Et=function(){yt.appendChild(mt),yt.appendChild(Lt),wt.appendChild(ut),yt.appendChild(wt),$t.appendChild(yt),ft=ct.getBoundingClientRect(),ct.style.display="none"},At=function(){wt.style.width=wt.style.height=t.cropperSize+"px",wt.style.top=vt.height/2-t.cropperSize/2+"px",wt.style.left=vt.width/2-t.cropperSize/2+"px","landscape"===gt?(mt.style.top=vt.height/2-t.cropperSize/2+"px",mt.style.left=(vt.width-ft.width)/2+"px"):(mt.style.top=(vt.height-ft.height)/2+"px",mt.style.left=vt.width/2-t.cropperSize/2+"px"),ut.style.left=mt.getBoundingClientRect().left-wt.getBoundingClientRect().left+"px",ut.style.top=mt.getBoundingClientRect().top-wt.getBoundingClientRect().top+"px",xt=mt.getBoundingClientRect(),$t.addEventListener("mousedown",zt)},zt=function(t){$L(t.target).hasClass("lytePSvisualArea")&&($t.addEventListener("mousemove",It),$t.addEventListener("mouseup",Dt),bt=mt.getBoundingClientRect().top-$t.getBoundingClientRect().top,Rt=mt.getBoundingClientRect().left-$t.getBoundingClientRect().left,St=t.clientY,Bt=t.clientX)},It=function(e){vt.height,t.cropperSize,e.clientY;var i=bt-(St-e.clientY),h=(e.clientX,vt.width,t.cropperSize,Rt-(Bt-e.clientX));h<=wt.getBoundingClientRect().left-$t.getBoundingClientRect().left?(mt.style.left=Rt-(Bt-e.clientX)+"px",ut.style.left=Rt-(Bt-e.clientX)-(vt.width/2-t.cropperSize/2)+"px"):(mt.style.left=wt.getBoundingClientRect().left-$t.getBoundingClientRect().left+"px",ut.style.left=wt.getBoundingClientRect().left-$t.getBoundingClientRect().left-(vt.width/2-t.cropperSize/2)+"px"),h+mt.getBoundingClientRect().width<wt.getBoundingClientRect().left-$t.getBoundingClientRect().left+wt.getBoundingClientRect().width&&(mt.style.left=-1*(mt.getBoundingClientRect().width-wt.getBoundingClientRect().width-(wt.getBoundingClientRect().left-$t.getBoundingClientRect().left))+"px",ut.style.left=-1*(mt.getBoundingClientRect().width-wt.getBoundingClientRect().width-(wt.getBoundingClientRect().left-$t.getBoundingClientRect().left))-(vt.width/2-t.cropperSize/2)+"px"),i<=wt.getBoundingClientRect().top-$t.getBoundingClientRect().top?(mt.style.top=bt-(St-e.clientY)+"px",ut.style.top=-1*(vt.height/2-t.cropperSize/2)+(bt-(St-e.clientY))+"px"):(mt.style.top=wt.getBoundingClientRect().top-$t.getBoundingClientRect().top+"px",ut.style.top=-1*(vt.height/2-t.cropperSize/2)+(wt.getBoundingClientRect().top-$t.getBoundingClientRect().top)+"px"),i+mt.getBoundingClientRect().height<wt.getBoundingClientRect().top-$t.getBoundingClientRect().top+wt.getBoundingClientRect().height&&(mt.style.top=-1*(mt.getBoundingClientRect().height-wt.getBoundingClientRect().height-(wt.getBoundingClientRect().top-$t.getBoundingClientRect().top))+"px",ut.style.top=-1*(mt.getBoundingClientRect().height-wt.getBoundingClientRect().height-(wt.getBoundingClientRect().top-$t.getBoundingClientRect().top))-(vt.height/2-t.cropperSize/2)+"px")},Dt=function(t){$t.removeEventListener("mousemove",It),$t.removeEventListener("mouseup",Dt)};yt=document.createElement("DIV"),Lt=document.createElement("DIV"),mt=document.createElement("IMG"),wt=document.createElement("DIV"),ut=document.createElement("IMG"),mt.src=ut.src=ct.src,yt.setAttribute("class","lytePSParent"),Lt.setAttribute("class","lytePSFreezeLayer"),mt.setAttribute("class","lytePSBackImage"),wt.setAttribute("class","lytePSvisualArea"),ut.setAttribute("class","lytePSFrontImage"),"landscape"===gt?(mt.style.height=t.cropperSize+"px",ut.style.height=t.cropperSize+"px"):(mt.style.width=t.cropperSize+"px",ut.style.width=t.cropperSize+"px"),Et(),At(),_.zoomImage=function(t){var e,i,h=t/100+1,p=$t.getBoundingClientRect(),o=parseFloat(mt.style.top),l=parseFloat(mt.style.left),s=mt.getBoundingClientRect(),n=s.height,r=s.width,a=l+r,d=o+n,c=wt.getBoundingClientRect(),g=c.top-p.top,f=c.left-p.left,x=f-l,y=a-(f+c.width),m=g-o,u=d-(g+c.height),w=xt.height*h,L=xt.width*h,C=r-c.width,$=n-c.height,v=w-n,b=L-r,R=x/C*(L-c.width),S=m/$*(w-c.height);x==y&&m==u?(i=l-b/2,e=o-v/2):x==y?(e=g-S,i=l-b/2):m==u?(e=o-v/2,i=f-R):(e=g-S,i=f-R),"landscape"===gt?(mt.style.height=w+"px",ut.style.height=w+"px"):(mt.style.width=L+"px",ut.style.width=L+"px"),mt.style.top=e+"px",ut.style.top=e-g+"px",mt.style.left=i+"px",ut.style.left=i-f+"px"},_.getCroppedImage=function(){var t=ut,e=wt.getBoundingClientRect(),i=(yt.getBoundingClientRect(),ut.getBoundingClientRect());return t.naturalWidth,e.width,function(h,p){var o=document.createElement("CANVAS"),l=o.getContext("2d");o.style.background="#eee";var s,n,r=mt.style.transform,a=0;r&&(a=r.match(/-?\d+/g),a=parseInt(a[0]));var d=i.left-e.left,c=i.top-e.top;return 90!==Math.abs(a)&&270!==Math.abs(a)?(o.width=Math.round(e.width*(t.naturalWidth/i.width)),o.height=Math.round(e.height*(t.naturalHeight/i.height)),s=t.naturalWidth,n=t.naturalHeight):(o.height=Math.round(e.height*(t.naturalWidth/i.height)),o.width=Math.round(e.width*(t.naturalHeight/i.width)),n=t.naturalWidth,s=t.naturalHeight),d*=s/i.width,c*=n/i.height,ut.style.transform=r,l.drawImage(t,d,c,s,n),o}()},$L(ct).data("lyteCrop",_)}});
