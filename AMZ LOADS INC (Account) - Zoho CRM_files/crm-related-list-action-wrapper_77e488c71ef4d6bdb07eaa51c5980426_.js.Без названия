Lyte.Component.register("crm-related-list-actions",{_template:'<template tag-name="crm-related-list-actions"> <template is="if" value="{{newLyteRL}}"><template case="true"> <template is="if" value="{{expHandlers(relatedList.module.api_name,\'==\',&quot;Attachments&quot;)}}"><template case="true"> <template is="if" value="{{expHandlers(options,\'==\',\'left_pannel\')}}"><template case="true"> <template is="if" value="{{showAddRecordForAttachments(relatedList.actions)}}"><template case="true"> <a href="javascript:void(0);" class="attachmentsLeftPanelAddition {{if(expHandlers(rl_actions_info,\'&amp;&amp;\',rl_actions_info.newLeftPanelDom),\'pA vH dF right0 dv_addModulesList top0 flexAlignCenter jcCenter\',\'addNewIcP\')}}" data-zcqa="newleft__Add_Attachments_leftPanel" id="addNewIcP_Attachments"> <span class="{{if(expHandlers(rl_actions_info,\'&amp;&amp;\',rl_actions_info.newLeftPanelDom),\'zcicncss-reg-plus zcicn-cssIcons zcicn_black_mask\',\'dN\')}}"></span> </a> </template></template> </template><template case="false"> <lyte-button lt-prop-appearance="primary" data-zcqa="Detail_Add_Attachemnt" class="lyteDropdownButton lyte-attach-menu {{if(relatedList.fromBlueprint,if(relatedList.mandatory,\'bp-attach-menu mandatoryField\',\'bp-attach-menu\'),\'queryElem\')}} pR" lt-prop-class="outlineprimary {{if(relatedList.fromBlueprint,\'bp-hover-disabled\',\'\')}}" lt-prop-size="small"><template is="registerYield" yield-name="text">{{getI18n(\'crm.attach.option.label\')}}</template> </lyte-button> </template></template> <lyte-menu on-before-open="{{method(\'menuOnBeforeOpen\')}}" lt-prop-yield="true" lt-prop-query="{{if(expHandlers(options,\'===\',\'left_pannel\'),\'a.attachmentsLeftPanelAddition\',if(relatedList.fromBlueprint,relatedList.menuSelector,\'.lyteDropdownButton.lyte-attach-menu.queryElem\'))}}" lt-prop-freeze="false" on-open="{{method(\'addSelectionMarker\')}}" on-close="{{method(\'removeSelectionMarker\')}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body> <crm-attachments from-blueprint="{{relatedList.fromBlueprint}}" from="{{from}}" module="{{module}}" related-list="{{relatedList}}" record="{{record}}"></crm-attachments> </lyte-menu-body> </template> </lyte-menu> </template><template case="false"> <template is="for" items="{{actions}}" item="item" index="index"> <template is="if" value="{{expHandlers(item[\'showaction\'],\'!==\',false)}}"><template case="true"> <template is="if" value="{{item[\'data-cid\']}}"><template case="true"> <lyte-button lt-prop-appearance="primary" lt-prop-class="outlineprimary" lt-prop-size="small" class="{{if(isPartOf(\'updateCampaignStatus,sendMailToMembers,addToCampaigns,newCampaignWithMembers,un-EnrollSeries\',item[\'data-cid\']),\'campaignShowOnCheckActions\',\'campaignHideOnCheckActions\')}} {{if(expHandlers(relatedList.personality_name,\'===\',\'SERIESPERSONALITY\'),if(ifEquals(\'un-EnrollSeries\',item[\'data-cid\']),\'seriesShowOnCheckAction\',\'seriesHideOnCheckAction\'),\'\')}} {{if(checkAction(\'Add\',item),\'dummyForLeftPanel\',\'\')}} {{if(ifEquals(item[\'data-cid\'],\'sendMailToMembers\'),\'dNImp\',\'\')}}" id="{{if(checkAction(\'Edit\',item),expHandlers(\'relList_Edit_\',\'+\',relatedList.id),expHandlers(expHandlers(expHandlers(\'relList_\',\'+\',item.label),\'+\',\'_\'),\'+\',relatedList.id))}}" data-zcqa="{{if(item.data_zcqa,item.data_zcqa,item.zcqa)}}" onclick="{{action(\'executeRelatedListActions\',item[\'data-cid\'])}}" data-relid="{{relatedList.id}}"> <template is="registerYield" yield-name="text">{{item.label}}</template> </lyte-button> </template><template case="false"> <lyte-button lt-prop-appearance="primary" lt-prop-class="outlineprimary" lt-prop-size="small" class="chosen-disabled {{if(checkAction(\'Add\',item),\'dummyForLeftPanel\',\'\')}} {{if(isPartOf(\'updateCampaignStatus,sendMailToMembers,addToCampaigns,newCampaignWithMembers,un-EnrollSeries\',item[\'action-id\']),\'campaignShowOnCheckActions\',\'campaignHideOnCheckActions\')}}" id="{{if(checkAction(\'Edit\',item),expHandlers(\'relList_Edit_\',\'+\',relatedList.id),expHandlers(expHandlers(expHandlers(\'relList_\',\'+\',item.label),\'+\',\'_\'),\'+\',relatedList.id))}}" data-zcqa="{{item.data_zcqa}}" lt-prop-title="{{item.tooltip}}" data-relid="{{relatedList.id}}"><template is="registerYield" yield-name="text">{{item.label}}</template></lyte-button> </template></template> </template></template> </template></template></template> </template><template case="false"> <template is="if" value="{{expHandlers(relatedList.module.api_name,\'==\',&quot;Attachments&quot;)}}"><template case="true"> <template is="if" value="{{expHandlers(options,\'==\',\'left_pannel\')}}"><template case="true"> <a href="javascript:void(0);" aria-label="{{getI18n(\'crm.label.add\')}}" lt-prop-aria-keydown="true" role="button" class="attachmentsLeftPanelAddition addNewIcP accessibility-clickable-elem" data-zcqa="newleft__Add_Attachments" id="addNewIcP_Attachments" tabindex="0"></a> </template><template case="false"> <a href="javascript:void(0);" aria-label="{{getI18n(\'crm.attach.option.label\')}}" lt-prop-aria-keydown="true" role="button" class="atch-dropdown lyte-attach-menu pR pR5 accessibility-clickable-elem" data-zcqa="Detail_Add_Attachemnt" tabindex="0">{{getI18n(\'crm.attach.option.label\')}} <template is="if" value="{{negate(expHandlers(relatedList.fromBlueprint,\'&amp;&amp;\',expHandlers(newLyteRL,\'!\')))}}"><template case="true"> <span class="zcicn-arrow-solid-down-sm-mask zcicn-cssIcons zcicn_blue_mask"></span> </template></template> </a> </template></template> <lyte-menu on-before-open="{{method(\'menuOnBeforeOpen\')}}" lt-prop-aria="{{isAccessibilityConfigSupported}}" lt-prop-yield="true" lt-prop-query="{{if(expHandlers(options,\'===\',\'left_pannel\'),\'a.attachmentsLeftPanelAddition\',\'a.atch-dropdown.lyte-attach-menu\')}}" lt-prop-freeze="false" on-open="{{method(\'addSelectionMarker\')}}" on-close="{{method(\'removeSelectionMarker\')}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body> <crm-attachments module="{{module}}" related-list="{{relatedList}}" record="{{record}}"></crm-attachments> </lyte-menu-body> </template> </lyte-menu> </template><template case="false"> <template is="for" items="{{actions}}" item="item" index="index"> <template is="if" value="{{expHandlers(item[\'showaction\'],\'!==\',false)}}"><template case="true"> <span class="relatedListActionClick" onclick="{{action(\'executeRelatedListActions\',item[\'data-cid\'])}}" data-relid="{{relatedList.id}}">{{item.label}}</span> </template></template> </template></template></template> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,0],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,0],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"attr",position:[1,2]},{type:"if",position:[1,2],cases:{true:{dynamicNodes:[]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}}]}]}},default:{}}]}},default:{}}],_observedAttributes:["actions","isAccessibilityConfigSupported","options","noRecordsHideEdit","from","newLyteRL"],data:function(){return{actions:Lyte.attr("array"),isAccessibilityConfigSupported:Lyte.attr("boolean",{default:Crm.userDetails.isAccessibilityConfigSupported&&!featuresAvailable.NEXTGENUI_ENABLED}),options:Lyte.attr("string",{default:void 0}),noRecordsHideEdit:Lyte.attr("boolean"),from:Lyte.attr("string",{default:void 0}),newLyteRL:Lyte.attr("boolean",{default:Crm.userDetails.isRelatedListLyteEnabled})}},init:function(){this.setData("actions",this.getData("relatedList").actions),this.getData("relatedList.fromBlueprint")&&this.getData("relatedList.forceEnableRelatedListLyte")&&this.setData("newLyteRL",!0),"Campaigns"!==this.getData("module")||"Leads"!==this.getData("relatedList").api_name&&"Contacts"!==this.getData("relatedList").api_name||(this.getRelatedListActions(this.getData("relatedList"),this.getData("module"),this.getData("record"),void 0),this.setData("actions",this.getData("relatedList").actions))},actions:{executeRelatedListActions:function(e){this.getData("newLyteRL")&&(this.$lg.relatedList.campaignSelectedIds=this.data.selectedIds),this.executeRelatedListActions(e,this.getData("relatedList"),this.getData("module"),this.getData("record"),event,this.data.selectedIds,this.getData("from"))}},methods:{addSelectionMarker:function(){"left_pannel"===this.getData("options")&&$("#newleft_"+this.getData("relatedList").id).addClass("leftnavEnable")},removeSelectionMarker:function(){"left_pannel"===this.getData("options")&&$("#newleft_"+this.getData("relatedList").id).removeClass("leftnavEnable")},menuOnBeforeOpen:function(e){var t=this;$L.fastdom.measure((function(){var a="left_pannel"===t.data.options?$L("#dv-button-layer"):$L("#DetailViewInnerTabs"),i=$L("#wmstoolbar"),s={top:0,bottom:0};a.length&&(s.top=a[0].getBoundingClientRect().bottom),i.length&&(s.bottom=i[0].getBoundingClientRect().top),$L.fastdom.mutate((function(){e.ltProp("boundary",s)}))}))}},didConnect:function(){if(this.getData("newLyteRL")){var e=this.$node.querySelectorAll(".campaignShowOnCheckActions");if(e.length&&e.forEach((function(e){$L(e).hide()})),this.getData("noRecordsHideEdit")&&$L(this.$node.querySelector("#relList_Edit_"+this.getData("relatedList.id"))).hide(),0===this.$node.querySelectorAll(".dummyForLeftPanel").length&&"Attachments"!==this.getData("relatedList.module.api_name")&&$L("#newleft_"+this.getData("relatedList.id")).find(".addNewIcP").hide(),this.data.record.Data_Processing_Basis_Details&&("Consent - Stop Processing"===this.data.record.Data_Processing_Basis_Details.Data_Processing_Basis||"Consent - Delete"===this.data.record.Data_Processing_Basis_Details.Data_Processing_Basis)){var t=$L(".seriesHideOnCheckAction");if(t){var a=$L("#addNewIcP_Cadences");t.addClass("hide"),a.addClass("dN")}}}}},{mixins:["crm-detail-view-utils","crm-related-list-utils"]}),Lyte.Component.registerHelper("checkAction",(function(e,t){return this.component.checkAction(e,t)})),Lyte.Component.registerHelper("showAddRecordForAttachments",(function(e){if(Crm.userDetails.hideUnauthorizedCreateLink){let t=!1;return e.forEach((e=>{t=t||!1!==e.showaction})),t}return!0}));
