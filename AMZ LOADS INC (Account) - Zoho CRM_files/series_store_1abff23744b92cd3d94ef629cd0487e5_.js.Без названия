store.registerModel("cadence",{id:Lyte.attr("string",{primaryKey:!0}),name:Lyte.attr("string",{default:""}),description:Lyte.attr("string",{default:""}),type:Lyte.attr("string",{default:""}),module:Lyte.attr("object"),custom_view:Lyte.attr("object"),execution_details:Lyte.attr("object"),follow_ups:Lyte.attr("array"),automatic_unenroll:Lyte.attr("boolean",{default:!1}),unenroll_properties:Lyte.attr("object"),end_date:Lyte.attr("string",{default:""}),active:Lyte.attr("boolean",{default:!0}),actionDetails:Lyte.attr("object",{default:{}}),seriesFollowUps_arr:Lyte.attr("object",{default:{}})},{actions:{clone:{},analytics:{},activate:{},count:{},merge:{},publish:{},enrollSeries:{},unEnrollSeries:{}}}),store.registerAdapter("cadence",{namespace:"crm/v4/settings/automation",buildURL:function(e,t,r,a,i,n,s){if(s&&s.hostUrl&&s.hostUrl.url)if((i=s.hostUrl.url).match("sandbox/diff")||i.match("production/diff")){c=i.split("diff/").pop().split("v4/")[0];i=i.replace(c,"")}else{var c=i.split("crm/").pop().split("v4/")[0];i=i.replace(c,"")}else i=this.$super.buildURL(e,t,r,a,i,n,s);if("enrollSeries"===n){var o=i.split("settings"),l=moduleApiMapping[s.module];i=o[0]+l+"/actions/enrol_in_cadences"}if("unEnrollSeries"===n){o=i.split("settings"),l=moduleApiMapping[s.module];i=o[0]+l+"/actions/unenrol_from_cadences"}return i},headersForRequest:function(e,t,r){var a={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken,"X-CRM-ORG":crmZgid};return r&&r.headers&&r.headers["X-CRM-ORG"]&&(a["X-CRM-ORG"]=r.headers["X-CRM-ORG"]),a},methodForRequest:function(e,t,r,a,i){if("action"===t)switch(i){case"activate":return!0===a.status?"PUT":"DELETE";case"clone":return"POST";case"publish":return"PUT";case"analytics":case"count":return"GET"}return"PATCH"===e?"PUT":e},processRequest:function(){commonUtils.showHideLoadingDiv(!0)}}),store.registerSerializer("cadence",{normalize:function(e,t,r){if("findAll"===t&&r){var a=r.modified_by?r.modified_by:r.created_by;r.current_user=a,r.isSelected=!1,r.module&&(r.module=r.module.api_name)}return r},payloadKey:function(){return"cadences"},normalizeResponse:function(e,t,r){if(("updateRecord"===t||"createRecord"===t)&&r&&r.cadences){for(var a=r.cadences?r.cadences.length:0,i=0;i<a;i++){var n=r.cadences[i];n.details&&(n.id=n.details.id)}"updateRecord"!==t&&"createRecord"!==t||(r.cadences=r.cadences[0])}return this.$super.normalizeResponse.apply(this.$super,arguments)},serialize:function(e,t){var r={};return void 0!==t&&(t.hasOwnProperty("cadences_ids")?r=t:r.cadences=[t.cadence]),r},setDeletedId:function(e,t,r){r&&r[t]&&(e[t]||(e[t]=[]),Object.keys(r[t]).forEach((function(a){var i=r[t][a];e[t].splice(a,0,{id:i})})))}}).extends("application");
