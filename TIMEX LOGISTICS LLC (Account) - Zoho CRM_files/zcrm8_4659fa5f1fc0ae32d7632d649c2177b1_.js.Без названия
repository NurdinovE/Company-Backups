var frmName,crmListView={sortTimer:void 0,oldCampaignCustomViewObject:void 0,clickEventIdVsMethodMapping:{selectAllEntity:"crmListView.selectAllEntity",selectEntity:"crmListView.selectEntity",selectOnlineEntities:"crmListView.selectOnlineEntities",selectColumn:"crmListView.selectColumn",navigate_previous_stages:"crmListView.setPrevStageView",navigate_next_stages:"crmListView.loadMoreStageBoards",mLookupselectAllEntity:"multiLookupsView.selectMultiSelectAllEntity",mLookupselectEntity:"multiLookupsView.selectMultiSelectEntity",navigate_previous_listviewmLookup:"multiLookupsView.navigatePrevious",navigate_next_listviewmLookup:"multiLookupsView.navigateNext",campTypeOnClick:"crmListView.viewCampSummaryOnClick",addToCampaigns:"crmListView.addToCampaigns",newCampaignWithMembers:"crmListView.createNewCampaignwithMembers",showPromoPopup:Crm.userDetails.isRelatedListLyteEnabled?"Lyte.registeredMixins['crm-related-list-utils'].showPromoPopup":"crmRelatedList.showPromoPopup"},defaultCVFiltersObj:{},modulesWithSmartFilters:["Leads","Contacts","Potentials"],upComingActionTemplateStr:'<div class="w120"><span class="fL w20 h18 mL15 pB1 {{getActivityIcon seType}}"></span><span class="fL dIB mR15 pR0 lh16 mT2 h_duedate {{class}}" onmouseenter="crmListView.showActivityDetails(this, \'{{activityId}}\', \'{{encodeJS subject}}\', \'{{seType}}\');" onmouseleave="$(\'#actDetailsDiv,#wf_tooltip\').hide();">{{value}}</span></div>',svUpcomingActionTemplateStr:'<span class="fL dIB pR0 cP lh16 {{seType}}" data-params=\'{"activityId":"{{activityId}}"}\' onmouseenter="crmListView.showActivityDetails(this, \'{{activityId}}\', \'{{encodeJS value}} - {{encodeJS subject}}\', \'{{seType}}\');" onmouseleave="$(\'#actDetailsDiv,#wf_tooltip\').hide();"><crmutil-icon non-lyte="true"  icon-name="{{toLowerCase seType}}" icon-class="zcicn-{{toLowerCase seType}} crmBaseIcon {{class}}"></crmutil-icon></span>',MAX_FILTER_CNT:15,MAX_STAGECARD_CNT:20,moduleVsDispCol:{Leads:"LASTNAME",Activities:"SUBJECT",Accounts:"ACCOUNTNAME",Contacts:"LASTNAME",Potentials:"POTENTIALNAME",Campaigns:"CAMPAIGNNAME",Cases:"CASESUBJECT",Solutions:"SOLUTIONTITLE",Products:"PRODUCTNAME",Bundles:"BUNDLENAME",Vendors:"VENDORNAME",PriceBooks:"BOOKNAME",Quotes:"QUOTESUBJECT",SalesOrders:"SALESORDERSUBJECT",PurchaseOrders:"PURCHASEORDERSUBJECT",Invoices:"INVOICESUBJECT",Forecasts:"FORECASTNAME",Visits:"VISITEDPAGE"},originalOrder:[],clickHandler:function(e,t,i){return!this.clickEventIdVsMethodMapping[i]||(Lyte.registeredMixins["crm-utilities"].executeFunctionByName(this.clickEventIdVsMethodMapping[i],window,e,t),!1)},initStageTemplates:function(){crmListView.upComingActionTemplate=Handlebars.compile(crmListView.upComingActionTemplateStr),crmListView.svUpComingActionTemplate=Handlebars.compile(crmListView.svUpcomingActionTemplateStr),crmListView.savedcanvasFiltersTemplate=Handlebars.compile('<li class="f_list cBoth pL0 lh20 filter_listcontent pR" id="{{filterId}}" data-showForAllCv="{{showForAllCV}}" data-params=\'{"module":"{{module}}", "calleeObj":"crmTab", "fetchOnlyBody":"true", "cvid":"{{cvId}}", "filterId":"{{filterId}}"}\' onClick="Crm.trackSpotLightAction(\'Saved Filter Click\',{\'Module\':\'{{module}}\'});"><link-to lt-prop-route="{{route}}" lt-prop-td=\'{"clearCache" :true,"fetchOnlyBody":"true","clearselectedIds":true}\' lt-prop-dp=\'["{{module}}","{{cvId}}","{{viewid}}"]\' lt-prop-qp = \'{"filter_id" : "{{filterId}}"}\' lt-prop-custom>\t\t\t\t<div class="pL15 pR15 p5"><span class="listText crm-base-font-size dIB vaM mR5" style="max-width:60%;">{{{filterName}}}</span>{{#if displayFilterCount}}<span id="{{filterId}}_count" class="dIB vaM crm-extra-small-font-size listTxtCount"><img src="{{getCrmImageUrl \'moreloading.gif\'}}"></span>{{/if}}\t\t\t\t<span class="dots3 pA dN svgIcons filterEdit" onclick="crmListView.showFilterOptions(event, \'{{filterId}}\');"></span><div class="cBoth"></div></div></li></link-to>'),crmListView.savedFiltersTemplate=Handlebars.compile('<li class="f_list cBoth pL0 lh20 filter_listcontent pR" id="{{filterId}}" data-showForAllCv="{{showForAllCV}}" data-params=\'{"module":"{{module}}", "calleeObj":"crmTab", "fetchOnlyBody":"true", "cvid":"{{cvId}}", "filterId":"{{filterId}}"}\' onClick="Crm.trackSpotLightAction(\'Saved Filter Click\',{\'Module\':\'{{module}}\'});"><link-to lt-prop-route="{{route}}" lt-prop-td=\'{"cvid":"{{cvId}}","clearCache" :true,"fetchOnlyBody":"true","clearselectedIds":true}\' lt-prop-dp=\'["{{module}}","{{cvId}}"]\' lt-prop-qp = \'{"filter_id" : "{{filterId}}"}\' lt-prop-custom>\t\t\t\t<div class="pL15 pR15 p5"><span class="listText crm-base-font-size dIB vaM mR5" style="max-width:60%;">{{{filterName}}}</span>{{#if displayFilterCount}}<span id="{{filterId}}_count" class="dIB vaM crm-extra-small-font-size listTxtCount"><img src="{{getCrmImageUrl \'moreloading.gif\'}}"></span>{{/if}}\t\t\t\t<span class="dots3 pA dN svgIcons filterEdit" onclick="crmListView.showFilterOptions(event, \'{{filterId}}\');"></span><div class="cBoth"></div></div></li></link-to>'),crmListView.MUStageOptionsTemplate=Handlebars.compile('<option value="-None-" data-zcqa="pl_MUStage_None">{{getI18n "crm.massupdate.select.stage"}}</option>{{#each stages}}<option value="{{this.display_value}}" {{#if this.colour_code}}data-colorcode="{{this.colour_code}}"{{/if}} data-zcqa="pl_MUStage_{{this.display_value}}">{{this.display_value}}</option>{{/each}}'),crmListView.MUPipelineOptionsTemplate=Handlebars.compile('<option value="-None-" data-zcqa="pl_MUPipeline_None">{{getI18n "crm.massupdate.select.pipeline"}}</option>{{#each pick_list_values}}<option value="{{this.id}}" data-zcqa="pl_MUPipeline_{{this.id}}">{{this.display_value}}</option>{{/each}}'),crmListView.WFPipelineTemplate=Handlebars.compile('<div class="newSelect forpipeline dIB mB15"><select id="fieldValue1" {{#unless layouts}}class="depField" data-fieldInfo={{pipelineFieldInfo}}{{/unless}} onchange="{{#if onchange}}{{onchange}}{{else}}appendDependencyFields(this){{/if}}"><option value="-None-">{{getI18n "crm.massupdate.select.pipeline"}}</option>{{#each layouts}}{{#layoutHasPipelines this.sections this.id}}<optgroup label="{{../name}}">{{#each this}}<option data-layoutId="{{../../id}}" {{#ifEquals ../../../selectedPipeline this.display_value}} selected {{/ifEquals}} value="{{this.display_value}}">{{this.display_value}}</option>{{/each}}</optgroup>{{/layoutHasPipelines}}{{/each}}</select></div>'),crmListView.MacroPipelineTemplate=Handlebars.compile('{{#each layouts}}{{#layoutHasPipelines this.sections this.id}}<li class="pL10 pT5 cDefault crm-font-bold" label="{{../name}}" value="{{../id}}">{{../name}}</li>{{#each this}}<li class="Macro_droplistupdateLi crm-font-regular pL20{{#ifEquals ../../../selectedPipeline this.display_value}} Macro_liActive {{/ifEquals}}" onclick="Macro.selectDropListValue(this);sE(event);" data-layoutId="{{../../id}}" data-val="{{this.display_value}}"><span class="pA {{#ifEquals ../../../selectedPipeline this.display_value}} Macro_tickIcon {{/ifEquals}}"></span>{{this.display_value}}</li>{{/each}}{{/layoutHasPipelines}}{{/each}}'),crmListView.BPFieldUpdateTemplate=Handlebars.compile('<div class="newSelect forpipeline dIB mB15"><select id="fieldValue1" onchange="ProcessBuilder.appendDependencyFields(this)" data-zcqa="pl_BPPipeline"><option value="-None-" data-zcqa="pl_BPPipeline_None">{{getI18n "crm.massupdate.select.pipeline"}}</option>{{#each layouts}}{{#layoutHasPipelines this.sections this.id}}<optgroup label="{{../name}}">{{#each this}}<option data-layoutId="{{../../id}}" {{#ifEquals ../../../selectedPipeline this.id}} selected {{/ifEquals}} value="{{this.id}}" data-zcqa="pl_BPPipeline_{{this.id}}">{{this.display_value}}</option>{{/each}}</optgroup>{{/layoutHasPipelines}}{{/each}}</select></div>')},selectEntity:function(e,t){$("body").trigger("click");var i=$(t).data("params").entityId,s=customViewObject.prevSelectedId,a=Lyte.Router.getRouteInstance().transition.info.route,r=Lyte.Router.getRouteInstance().routeName;if(1==e.shiftKey&&null!=s&&s!=i&&0!=$("#"+s).length)return this.shiftSelect(e,t,a,r),!1;var l,o=crmListView.getObject().module,n=$(t).attr("class"),c=customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView?customViewObject.selectedIds:crmTab.getFromCache(o).selectedIds,d=crmListView.getObject().fromIndex,m=$(t).closest("tr").attr("id"),u=0;if($(t).attr("data-params")&&(l=JSON.parse($(t).attr("data-params")).stageId),"customCheckBox"==n){if(c.length==crmConstants.maxSelectCount)return void renderingUtils.showCustomAlert(I18n.getMsg("crm.listview.maximum.records.alert",crmConstants.maxSelectCount));if($(t).attr("class","customCheckBoxChecked"),$(t).closest("tr").css("background-color","var(--tableHighlight)").addClass("setTdBorBtm"),$("#listViewTable,.fixedrowTd").find("tr#"+m).css("background-color","var(--tableHighlight)").addClass("setTdBorBtm"),$("#listViewTable tr#"+m+" .customCheckBox,.fixedrowTd tr#"+m+" .customCheckBox").attr("class","customCheckBoxChecked"),0==$(t).closest("tr").prev("tr").hasClass("setTdBorBtm")&&$(t).closest("tr").prev("tr").addClass("setTdBorBtm"),$(t).closest(".sv-stage-card").addClass("sv-stage-card-selected"),customViewObject.isStageView&&0==c.length&&crmListView.disableSortable(),Lyte.arrayUtils(c,"push",i),crmListView.startIndex.hasOwnProperty(d)?crmListView.startIndex[d]=++crmListView.startIndex[d]:crmListView.startIndex[d]=1,0==(u=l?$("#"+l+" .customCheckBox[data-cid=selectEntity]").length:$(".customCheckBox[data-cid=selectEntity]").length)){var p="";l&&(p=",#"+l+" .stageview-heading-container #checkAll"),$("#listViewTable #checkAll,.fixedheadercolumn #checkAll,#fixedHeader #checkAll,#cvlistViewFilter #cvcheckAll"+p).attr("class","customCheckBoxChecked"),$("#fixedChkSelAll").attr("class","customCheckBoxChecked"),$("#listViewTable #checkAll").attr("class","customCheckBoxChecked"),$("#selectAllRecords").length>0&&($("#selectAllRecords").show(),customViewObject.showSelectAll=!0)}else{p="";l&&(p=",#"+l+" .stageview-heading-container #checkAll"),$("#listViewTable #checkAll,.fixedheadercolumn #checkAll,#fixedHeader #checkAll,#cvlistViewFilter #cvcheckAll"+p).attr("class","partialselect"),$("#listViewTable #checkAll").attr("class","partialselect"),$("#fixedChkSelAll").attr("class","partialselect")}showHideSelectAllLink($("#checkAll").attr("class"),o),"crm.tab.module.custom-view.zia"!=a&&"crm.tab.module.custom-view.list"!=a&&"crm.tab.module.custom-view.kanban"!=a&&"crm.tab.module.custom-view.canvas"!=a&&showHideListViewBtnFn()}else{$(t).attr("class","customCheckBox"),$(t).closest(".sv-stage-card").removeClass("sv-stage-card-selected"),$(t).closest("tr").css("background-color","").removeClass("setTdBorBtm"),$("#listViewTable,.fixedrowTd").find("tr#"+m).css("background-color","").removeClass("setTdBorBtm"),$("#listViewTable tr#"+m+" .customCheckBoxChecked,.fixedrowTd tr#"+m+" .customCheckBoxChecked").attr("class","customCheckBox"),1==$(t).closest("tr").prev("tr").hasClass("setTdBorBtm")&&$(t).closest("tr").prev("tr").removeClass("setTdBorBtm"),Lyte.arrayUtils(c,"removeAt",c.indexOf(i),1),customViewObject.isPredictView||0==c.length&&crmListView.enableSortable(),1==crmListView.startIndex[d]?delete crmListView.startIndex[d]:crmListView.startIndex[d]=--crmListView.startIndex[d];p="";l&&(p="#"+l),0==$(p+" .customCheckBoxChecked[data-cid=selectEntity]").length?(l&&(p+=" .stageview-heading-container #checkAll,"),$(p+"#listViewTable #checkAll,.fixedheadercolumn #checkAll,#fixedHeader #checkAll,#cvlistViewFilter #cvcheckAll").attr("class","customCheckBox"),$("#listViewTable #checkAll").attr("class","customCheckBox"),$("#fixedChkSelAll").attr("class","customCheckBox")):(l&&(p+=" .stageview-heading-container #checkAll,"),$(p+"#listViewTable #checkAll,.fixedheadercolumn #checkAll,#fixedHeader #checkAll,#cvlistViewFilter #cvcheckAll").attr("class","partialselect"),$("#listViewTable #checkAll").attr("class","partialselect"),$("#fixedChkSelAll").attr("class","partialselect"),$("#selectAllRecords").length>0&&$("#selectAllRecords").hide()),showHideSelectAllLink($("#checkAll").attr("class"),o),!customViewObject.doMassActioninScheduler&&c.length>crmConstants.maxSelectCount&&($.each($(".customCheckBoxChecked[data-cid=selectEntity]"),(function(e,t){$(t).attr("class","customCheckBox"),$("#listViewTable tr").eq($(t).closest("tr").index()+1).css("background-color","").removeClass("setTdBorBtm"),$(t).closest("tr").css("background-color","").removeClass("setTdBorBtm"),1==$(t).closest("tr").prev("tr").hasClass("setTdBorBtm")&&$(t).closest("tr").prev("tr").removeClass("setTdBorBtm"),c.removeFirstOccurenceOfElement($(t).data("params").entityId)})),$("#checkAll").attr("class","customCheckBox"),$("#fixedChkSelAll").attr("class","customCheckBox"),c.length>crmConstants.maxSelectCount&&(c=c.slice(0,crmConstants.maxSelectCount))),"crm.tab.module.custom-view.zia"!=a&&"crm.tab.module.custom-view.list"!=a&&"crm.tab.module.custom-view.kanban"!=a&&"crm.tab.module.custom-view.canvas"!=a&&showHideListViewBtnFn()}if("crm.tab.module.custom-view.list"==a||"crm.tab.module.custom-view.zia"==a||"crm.tab.module.custom-view.kanban"==a||"crm.tab.module.custom-view.canvas"==a){var f=Math.round(customViewObject.fromIndex/moduleRecordMapping[o].per_page)+1,v={selectedIds:c,per_page:customViewObject.toIndex,page:f,module:o,start_index:customViewObject.fromIndex-1,route:r};if("customCheckBox"==n&&(v.unCheckedEntitiesCount=u),Lyte.registeredMixins["crm-view-utils"].observeSelectedIds(v),"Leads"==o||"Contacts"==o){var g=$(".customCheckBox").closest("tr").find(".online-entity").length,h=document.querySelector("crm-customview-buttons");if(h)if(h.getData("displayOnlineEntities"))0!=g&&0!=u||h.setData("displayOnlineEntities",!1);else $('[data-id="online-entity-'+i+'-lview"]').length>0&&g>0&&h.setData("displayOnlineEntities",!0)}}customViewObject.selectedIds=c,customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView||(crmTab.getFromCache(o).selectedIds=c),crmListView.editSelectionLayerText(c.length),customViewObject.prevSelectedId=i},selectAllEntity:function(e,t){$("body").trigger("click");var i,s=Lyte.Router.getRouteInstance().transition.info.route,a=crmListView.getObject().module,r=crmTab.getFromCache(a),l=customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView?customViewObject.selectedIds:r&&r.selectedIds?r.selectedIds:[],o=$(t).attr("class"),n=crmListView.getObject().fromIndex;if($(t).attr("data-params")&&(i=JSON.parse($(t).attr("data-params")).stageId),"customCheckBox"==o){customViewObject.selectAllInCurrentView=!0;var c=$("#"+i+" .customCheckBox[data-cid=selectEntity]");if(1==customViewObject.isStageView||1==customViewObject.isPredictView){c=$("#"+i+" .customCheckBox[data-cid=selectEntity]");$("#"+i+" #checkAll").attr("class","customCheckBoxChecked")}else{c=$(".customCheckBox[data-cid=selectEntity]");$(".lv_table_holder #listViewTable #checkAll,.lv_table_holder .fixedheadercolumn #checkAll,.lv_table_holder #fixedHeader #checkAll,#cvlistViewFilter #cvcheckAll").attr("class","customCheckBoxChecked"),$("#fixedChkSelAll").attr("class","customCheckBoxChecked")}0==l.length&&1==customViewObject.isStageView&&crmListView.disableSortable();for(var d=0;d<c.length;d++){var m=$(c).eq(d);if(m.attr("class","customCheckBoxChecked"),m.closest(".sv-stage-card").addClass("sv-stage-card-selected"),!l.contains(m.data("params").entityId)){if(l.length==crmConstants.maxSelectCount&&!customViewObject.doMassActioninScheduler)return customViewObject.selectedIds=l,customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView||(crmTab.getFromCache(a).selectedIds=l),crmListView.editSelectionLayerText(l.length),"crm.tab.module.custom-view.list"!=s&&"crm.tab.module.custom-view.zia"!=s&&"crm.tab.module.custom-view.kanban"!=s&&"crm.tab.module.custom-view.canvas"!=s&&showHideListViewBtnFn(),renderingUtils.showCustomAlert(I18n.getMsg("crm.listview.maximum.records.alert",crmConstants.maxSelectCount)),$(t).trigger("click"),$("#fixedChkSelAll").attr("class","customCheckBox"),void(crmListView.startIndex.hasOwnProperty(n)?crmListView.startIndex[n]=crmListView.startIndex[n]+d:crmListView.startIndex[n]=d);m.closest("tr").css("background-color","var(--tableHighlight)").addClass("setTdBorBtm").prev("tr").addClass("setTdBorBtm"),Lyte.arrayUtils(l,"push",m.data("params").entityId)}}if(crmListView.startIndex.hasOwnProperty(n)?crmListView.startIndex[n]=crmListView.startIndex[n]+c.length:crmListView.startIndex[n]=c.length,customViewObject.totalCount&&$("#selectAllRecords").length>0)if(customViewObject.totalCount<=Crm.massOperationTotalLimit&&1==customViewObject.showSelectAll){var u=I18n.getMsg("crm.mass.actions.select.all",["",customViewObject.pluralModName]);$("#selectAllRecords").find("a").find("u").text(u),$("#selectAllRecords").show(),customViewObject.showSelectAll=!0}else $("#selectAllRecords").hide(),customViewObject.showSelectAll=!1,$("#scheduleMassActionDiv").hide(),$("#actionMenuForScheduler").css({display:"",visibility:"hidden"});else $("#selectAllRecords").length>0&&1==customViewObject.showSelectAll&&($("#selectAllRecords").show(),customViewObject.showSelectAll=!0);$("#selectAllRecords").length>0&&0==customViewObject.showSelectAll&&(customViewObject.selectAllInCurrentView=!1,customViewObject.doMassActioninScheduler=!1,customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView||(crmTab.getFromCache(a).doMassActioninScheduler=!1)),hideMassOperationsForScheduler()}else if("underLine mL15 cP"==o){if(0!=$(".f_listclick-view").length||0!=$(".checkfilter").length)return renderingUtils.showCustomAlert(I18n.getMsg("crm.listview.selection.all.records.not.available")),void $("#selectAllRecords").css("display","none");if(customViewObject.totalCount){customViewObject.totalCount<=Crm.massOperationTotalLimit?(customViewObject.doMassActioninScheduler=!0,customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView||(crmTab.getFromCache(a).doMassActioninScheduler=!0),showMassOperationsForScheduler(),$(".selCountNum").html(I18n.getMsg("crm.mass.actions.all.selected",["",customViewObject.pluralModName])),overLayForSelectAllClick(!0)):(customViewObject.doMassActioninScheduler=!1,customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView||(crmTab.getFromCache(a).doMassActioninScheduler=!1),$("#selectAllRecords").hide(),customViewObject.showSelectAll=!1,$("#scheduleMassActionDiv").hide(),$("#actionMenuForScheduler").css({display:"",visibility:"hidden"}),crmui.showMsgBand("info",I18n.getMsg("crm.listview.maximum.records.alert",[Crm.massOperationTotalLimit]),4e3,""));c=document.getElementById("totalRecordsCount");var p="Total Records Count";showTotalCount(c,p)}else{customViewObject.doMassActioninScheduler=!0,customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView||(crmTab.getFromCache(a).doMassActioninScheduler=!0);c=document.getElementById("totalRecordsCount"),p="Total Records Count";showTotalCount(c,p)}Crm.trackSpotLightAction("Mass Scheduler - Select All Link",{Module:customViewObject.module})}else{customViewObject.selectedStages&&!customViewObject.selectedStages.length>0?(customViewObject.doMassActioninScheduler=!1,customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView||(crmTab.getFromCache(a).doMassActioninScheduler=!1)):customViewObject.selectedStages&&customViewObject.selectedStages.removeFirstOccurenceOfElement(i);var f=0;divIdStr=1==customViewObject.isStageView||1==customViewObject.isPredictView?"#"+i:"",i&&"#"!=divIdStr?(customViewObject.indTotalCount-=parseInt($("#"+i+" .recordsCount").text().split(" ")[0]),0==customViewObject.indTotalCount&&delete customViewObject.indTotalCount):(divIdStr="",delete customViewObject.indTotalCount),$.each($(divIdStr+" .customCheckBoxChecked[data-cid=selectEntity]"),(function(e,t){$(t).attr("class","customCheckBox"),$(t).closest(".sv-stage-card").removeClass("sv-stage-card-selected"),$("#listViewTable tr").eq($(t).closest("tr").index()+1).css("background-color","").removeClass("setTdBorBtm"),$(t).closest("tr").css("background-color","").removeClass("setTdBorBtm"),1==$(t).closest("tr").prev("tr").hasClass("setTdBorBtm")&&$(t).closest("tr").prev("tr").removeClass("setTdBorBtm"),Lyte.arrayUtils(l,"removeAt",l.indexOf($(t).data("params").entityId)),l.removeFirstOccurenceOfElement($(t).data("params").entityId),f++})),1!=customViewObject.isStageView&&1!=customViewObject.isPredictView||(i?$("#"+i+" #checkAll").attr("class","customCheckBox"):$("#lv_stageview .customCheckBoxChecked[data-cid=selectAllEntity],#lv_stageview .partialselect[data-cid=selectAllEntity]").attr("class","customCheckBox")),1==customViewObject.isStageView?0==l.length&&crmListView.enableSortable():$("#listViewTable #checkAll,.fixedheadercolumn #checkAll,#fixedHeader #checkAll,#cvlistViewFilter #cvcheckAll").attr("class","customCheckBox"),$("#fixedChkSelAll").attr("class","customCheckBox"),crmListView.startIndex[n]=crmListView.startIndex[n]-f,crmListView.startIndex[n]<=0&&delete crmListView.startIndex[n],"customCheckBoxChecked"!=o&&"partialselect"!=o&&(l=[],crmListView.startIndex={}),overLayForSelectAllClick(!1,i)}if(customViewObject.selectedIds=l,customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView||(crmTab.getFromCache(a).selectedIds=l),"crm.tab.module.custom-view.list"==s||"crm.tab.module.custom-view.zia"==s||"crm.tab.module.custom-view.kanban"==s||"crm.tab.module.custom-view.canvas"==s){var v=Math.round(customViewObject.fromIndex/moduleRecordMapping[a].per_page)+1,g={selectedIds:l,data:i,per_page:customViewObject.toIndex,page:v,module:a,start_index:customViewObject.fromIndex-1};Lyte.registeredMixins["crm-view-utils"].observeSelectedIds(g)}else showHideListViewBtnFn(i);if(crmListView.editSelectionLayerText(l.length),"Leads"==a||"Contacts"==a){var h=$("#selectOnlineEntities");h.length>0&&h.hide()}},selectOnlineEntities:function(){for(var e=$(".online-entity"),t=e.length,i=0;i<t;i++){var s=$(e[i]).attr("data-id").split("-")[2],a=$("#selectEntity_"+s);if("customCheckBoxChecked"!=a.attr("class")){crmListView.selectEntity(event,a[0]);var r=crmListView.getObject().module;if(crmTab.getFromCache(r).selectedIds.length==crmConstants.maxSelectCount){renderingUtils.showCustomAlert(I18n.getMsg("crm.listview.maximum.records.alert",crmConstants.maxSelectCount));break}}}$("#selectOnlineEntities").hide(),Crm.trackSpotLightAction("Sales IQ - Select All Online Click",{Module:crmListView.getObject().module})},getObject:function(){return customViewObject},latestEntity:function(e){var t=$L("#listView_"+e),i=crmListView.getObject();t.length<=0&&i.isCustomizedView&&(t=$L("#"+e));var s=i&&i.isStageView;if(0!=t.length)if(s){$(".sv_sel_entity").removeClass("sv_sel_entity");var a=t.closest("div.stageview-data-container").offset().left+t.closest("div.stageview-data-container").width(),r=$("#sv_stage_inner_parent").width();a>r&&$("#sv_stage_inner_parent").scrollLeft(a-r),t.closest("div.stageview-data-container").scrollTop(t.offset().top-250),t.closest("li").addClass("sv_sel_entity"),setTimeout((function(){$(".sv_sel_entity").removeClass("sv_sel_entity")}),5e3)}else $("#listviewtablescroll #lvTred tr#"+e).length?(setTimeout((function(){var t=document.getElementById("tabLayer").offsetHeight,i=document.getElementById("cvpadding"),s=t+(i?i.offsetHeight:"")+document.getElementById("listviewHeaderRow").offsetHeight,a=$("#lvTred tr#"+e).offset().top-s;$L("#listviewtablescroll").scrollTop(a)}),50),$("#listViewTable tr[id="+e+"],.fixedrowTd tr[id="+e+"]").attr("class","trialyellowbox"),$("#listViewTable div[id=div"+e+"],.fixedrowTd tr[id="+e+"]").closest("td").addClass("border-left"),setTimeout((function(){$("#listViewTable div[id=div"+e+"],.fixedrowTd tr[id="+e+"]").closest("td").removeClass("border-left")}),2e3)):$("#canvasview-tablescroll #lvTred tr#"+e).length&&(setTimeout((function(){var t=document.getElementById("tabLayer").offsetHeight,i=document.getElementById("cvpadding"),s=t+(i?i.offsetHeight:"")+document.getElementById("cvlistViewFilter").offsetHeight,a=$("#lvTred tr#"+e).offset().top-s;$L("#canvasview-tablescroll").scrollTop(a)}),50),$("#listViewTable tr[id="+e+"]").attr("class","trialyellowbox"),$("#listViewTable div[id=div"+e+"]").closest("td").addClass("border-left"),setTimeout((function(){$("#listViewTable div[id=div"+e+"]").closest("td").removeClass("border-left")}),2e3))},renderFilterCount:function(e,t,i){if(customViewObject.displayFilterCount){var s=customViewObject.filterId?void 0:$("#lv_saved_filters").find(".f_listclick-view").attr("id");for(var a in e)if("TotalCount"==a&&null!=t)$(t).find("span").attr("count",e[a]).html("<b>"+e[a]+"</b>&nbsp;"),$(t).children().unwrap(),crmListView.getObject().isPrivacyListView||customViewObject.isCampaignAddMemberListView||!crmTab.getFromCache(i)||(crmTab.getFromCache(i).totalCount=e[a]),!crmListView.getObject().isPrivacyListView&&crmTab.countCache[i]&&(crmTab.countCache[i].TotalCount=e[a]),crmListView.getObject().totalCount=e[a];else{var r=a===s&&null!=e.TotalCount?parseInt(e.TotalCount):parseInt(e[a]),l=$("#"+a+"_count");if(l.length){!crmListView.getObject().isPrivacyListView&&crmTab.getFromCache(i)&&(crmTab.getFromCache(i)[a]=r),!crmListView.getObject().isPrivacyListView&&crmTab.countCache[i]&&(crmTab.countCache[i][a]=r),l.next("#lv_filter_cnt_load").hide(),r>=1e5?l.html("<span class='wsNowrap getWid'>99,999+</span>").attr("title",commonUtils.formatDecimalValue(r)).show().prev("span").attr("style","max-width:60%"):l.html("<span class='wsNowrap getWid'>"+r+"</span>");var o=l.find(".getWid").width();l.css("width",o+"px").find(".getWid").addClass("countAnimi");var n=o+14,c=$("#"+a).find(".listText");c.css("max-width",192-n),"TotalCount"!=a&&thirdPartyUtils.titleForEllipsis(c[0])}$("#filterOptions").bind("onBeforeClose",(function(){$(".filterEdit").addClass("dN")}))}}},checkAll:function(e){var t="partialselect";1!=customViewObject.isStageView&&1!=customViewObject.isPredictView?(0==$(".customCheckBoxChecked[data-cid=selectEntity]").length?t="customCheckBox":0==$(".customCheckBox[data-cid=selectEntity]").length&&(t="customCheckBoxChecked"),$("span[data-cid='selectAllEntity']").attr("class",t)):(0==$("#"+e+" .customCheckBoxChecked[data-cid=selectEntity]").length?t="customCheckBox":0==$("#"+e+" .customCheckBox[data-cid=selectEntity]").length&&(t="customCheckBoxChecked"),$("#"+e+" span[data-cid='selectAllEntity']").attr("class",t)),$("#fixedChkSelAll").attr("class",t)},createTemplate:function(e,t){var i=e.module;if(renderingUtils.fieldsJSONArray=[],1!=e.showKanbanPopup){if(e.isCustomizedView){for(var s=e.heading?e.heading.length:0,a=[],r=[],l=0;l<s;l++){var o=e.heading[l];if("PHOTO_FILEID"!=o.COLUMNNAME){if(r.indexOf(o.FIELDID)>-1)continue;o.isSortable&&(a.push({FIELDID:o.FIELDID,FIELDLABEL:o.FIELDLABEL}),r.push(o.FIELDID))}}e.sortFields=a,$("#cvfieldMappingdropdown").remove(),e.canModifyCanvas=Crm.userDetails.permissions.Crm_Implied_Customize_Zoho_CRM||Crm.userDetails.USER_ID===e.customizationJSON.created_by.id&&Crm.userDetails.permissions.Crm_Implied_Manage_CustomViews}if("string"==typeof e.fromIndex&&(e.fromIndex=parseInt(e.fromIndex),e.toIndex=parseInt(e.toIndex)),e.filterId&&(e.filters=customViewObject.filters,e.cross_filters=customViewObject.cross_filters),customViewObject=e,e.maxSelectCount=crmConstants.maxSelectCount,e.isOrchestration=!!e.module&&(e.module.startsWith("Orchestration")||e.module.startsWith("PathFinder")),e.isOrchestration&&(e.orchestChildModules=Lyte.registeredMixins.orchestration.fetchOrchestrationChildModules()),"false"==e.error&&e.cvName&&(e.module&&e.cvName==="REVIEWPROCESS "+e.module.toUpperCase()||"REVIEWPROCESS CUSTOMMODULE"===e.cvName)&&(e.isReviewProcessView=!0,e.isAdmin=Crm.userDetails.IS_ADMIN),"false"!==e.error||!e.cvName||e.cvName!=="IMAGEVALIDATION"+e.module.toUpperCase()&&"IMAGEVALIDATIONCUSTOMMODULE"!==e.cvName||(e.isImageValidationView=!0),e.body&&null!=e.body&&0!=e.body.length||"false"!=e.error)crmListView.renderNormalView(i,e);else if(1==customViewObject.showBlankState)"Visits"==customViewObject.module?crmListView.renderVistBlankState(e):$("#show").html(Handlebars.templates.newEntityObj(e));else if(1==customViewObject.isDataWaitingForApproval)$("#show").html(Handlebars.templates.customViewObj(e));else{if(e.isKanbanView&&"Closed"==e.columntype&&(e.columns=["Closed","Open","RelatedTo","other"]),"Potentials"==e.module&&(e.isModulePredictionAvailable=Crm.userDetails.isDealPredictionEnabled),moduleRecordMapping[e.module].isRecommendationsEnable){var n=moduleRecordMapping[e.module].recommendationsDetailsJson.what_to;e.recommendation_data=n}$("#viewcontainer").html(Handlebars.templates.customViewObj(e))}if(e.isCustomizedView&&!e.isPredictView){CustomizationLoader.loadJs((function(){new listViewHandler(e).renderListView()})),$("#cvfieldMappingdropdown").remove();var c=$("#CustomizedViewSortColumn"),d=$("#CustomizedViewSortOrder");thirdPartyUtils.bindSelect2("#CustomizedViewSortColumn select",{dropdownParent:c}),thirdPartyUtils.bindSelect2("#CustomizedViewSortOrder select",{dropdownParent:d}),setTimeout((function(){"0"==$("#CustomizedViewSortColumn select").val()?$("#select2-CustomizedViewSortColumnSelect-container").hide():$("#select2-CustomizedViewSortColumnSelect-container").show()}),100)}$("#tagOperList").hide();var m=crmTab.getFiltersFromCache(i);"false"!==e.error||"Leads"!=i&&"Accounts"!=i&&"Contacts"!=i&&"Potentials"!=i?CrmTags.doListViewOperations():crmListView.reorderFiltersForCV(e),e.modulePicklistValues&&(Crm.jsonSelectValues=JSON.parse(JSON.stringify(e.modulePicklistValues))),this.renderFilters(i,e,m),e.isStageView||e.isPredictView?e.showBlankState||crmListView.afterRenderStageView(e):e.isKanbanView?"false"==e.normListView&&"Visits"==e.module?$((function(){$(".footernewClass").addClass("hide"),customViewObject.showBlankState||networkUtils.loadFeatureScripts(["zohocrm_visitstab.js"],(function(){$$zVisits.init(e.posts)}))})):Lyte.injectResources(networkUtils.returnDependencyFiles(["crux-lookupfilter-component.js","crux-column-list.js"],ResourceConstants.CRMClient),void 0,(function(){crmListView.afterRenderKanbanView(e)})):e.isCustomizedView?crmListView.afterRenderCustomizedView(e):crmListView.afterRenderNormalView(e),1===$("#view_toggler a").length&&$("#view_toggler").hide(),setTimeout((function(){placeExtra(),CustomView.initFavorite(),crmNavig.parseCurrentListView(),populateTimeVal($(".ddTime")),e.isCustomizedView||$(".fixedrowTd").html(Handlebars.templates.fixedColumnlistview(e)),e.isCustomizedView&&renderingUtils.tableSorter("listViewTable","0","");var t=$L(e.isCustomizedView)?$L("#canvasview-tablescroll"):$L("#listviewtablescroll");Crm.userDetails.RTL_ENABLED||t.scrollLeft(Crm.tablesorterScrollLeft),t.scrollTop(Crm.tablesorterScrollTop),null==crmTab.countCache[i]&&e.fetchCountValues?showTotalCount($("#tcDiv #totalRecordsCount"),void 0,"true"):null==e.isTotalcountCached&&e.fetchCountValues?showTotalCount($("#tcDiv #totalRecordsCount"),void 0,"false"):crmListView.renderFilterCount(crmTab.countCache[i],$("#tcDiv #totalRecordsCount"),i),"Tasks"!=i&&"Activities"!=i||crmListView.storeVRrules(i,e)}),50),"Visits"==customViewObject.module&&0==$("#printviewBtn").length&&$(".customPluswithImpotBtnCon").hide();var u=$("#listviewtablescroll");u.on("mouseover",".lv_data_user",(function(){crmListView.showUserToolTip(this)})),u.on("mouseout",".lv_data_user",(function(){hideUserBusinessCard()}))}else crmListView.popup(!0,e)},storeVRrules:function(e,t){customViewObject.vRules&&(Crm.validationRuleJSONData||(Crm.validationRuleJSONData={}),Crm.validationRuleJSONData.Tasks={},Crm.validationRuleJSONData.Tasks.validation_rules=customViewObject.vRules,delete customViewObject.vRules)},renderVistBlankState:function(e){$("#show").html(Handlebars.templates.customViewObj(e)),e.isKanbanView?$("#visits_parent_div").html(Handlebars.templates.newEntityObj(e)):$("#idForCV").html(Handlebars.templates.newEntityObj(e)),networkUtils.loadFeatureScripts(["zohocrm_visitsetup.js"],(function(){"All Portals"==customViewObject.screenName&&(VisitsConfig.getEmbedCode(),thirdPartyUtils.bindSelect2("#pListDD"))}))},renderNormalView:function(e,t){$("#divMacro").css("display","none");$("#show");if("Potentials"==t.module&&(t.isModulePredictionAvailable=Crm.userDetails.isDealPredictionEnabled),moduleRecordMapping[t.module]&&moduleRecordMapping[t.module].isRecommendationsEnable){var i=moduleRecordMapping[t.module].recommendationsDetailsJson.what_to;t.recommendation_data=i}if($("#viewcontainer").html(Handlebars.templates.customViewObj(t)),"false"==t.error){var s=t.selectedIds.length,a=$(".bg_white");0!=s&&$("#listviewButtonLayerDiv").css("display","block");for(var r=0;s>0&&r<a.length;r++){var l=$(a)[r];-1!=t.selectedIds.indexOf($(l).attr("id"))&&($(l).css("background-color","var(--tableHighlight)"),s--)}}},renderSelectedFilters:function(e,t){var i=$("#lv_left_filter");if(i.length){if(i.css("visibility","visible"),e.filters&&e.filters.length){var s=t&&t.filters&&t.filters.length?t:{filters:e.filters};crmListView.populateFilters(s,e)}e.filterId&&$("#"+e.filterId).addClass("f_listclick-view");var a=$("#lv_left_filter").find("input.checkFilter:checked").closest(".filterContainBox");if($("#lv_filter_scroll").children("div").eq(0).prepend(a),e.isVTAdvFilterAvailable){var r=$("#vtFieldOuterDiv"),l=$("#vtMoreSpan");0==i.find("input.checkFilter:checked").closest(".vtColumn").length?(crmListView.setVTDivHt(),l.css("display","inline-block"),l.click((function(){$("#vtFieldDiv").css({height:""}).removeClass("oH"),r.find(l).remove(),r.find(".vt-filter-sep").show()}))):(r.find(".vt-filter-sep").show(),r.find(l).remove())}i.css("visibility","visible");var o=Lyte.Router.getRouteInstance().transition.info.route;e.displayFilters||"crm.tab.module.custom-view.zia"==o||"crm.tab.module.custom-view.kanban"==o||"crm.tab.module.custom-view.list"==o||"crm.tab.module.custom-view.canvas"==o||i.css("display","none"),"crm.tab.module.custom-view.zia"!=o&&"crm.tab.module.custom-view.kanban"!=o&&"crm.tab.module.custom-view.list"!=o&&"crm.tab.module.custom-view.canvas"!=o&&(a.length?$("#lv_filter_hide").css("display","none"):$("#lv_filter_hide").css("display",""))}},renderFilters:function(e,t,i){var s=$("#lv_left_filter");if($("#territorypart a").click((function(){var e=$(this),t=e.attr("id");t=-1!=t.indexOf("a")?t.replace("a_",""):t.replace("sub_",""),Territory.setTerritoryCV(t,e.attr("setvalue"))})),s.length){if(crmListView.renderSelectedFilters(t,i),"Potentials"==e)"Viewed"==localStorage.getItem("dealKanbanViewData")?$(".taskKanbanViewDeactive").addClass("vivewedkanban"):$(".taskKanbanViewDeactive").removeClass("vivewedkanban");"Activities"==e&&$("span[title|='Billable']").closest("div").hide();var a=$("input.userSrchSmartFilter");Search.assignEnter(a),Search.assignOn(a),setTimeout((function(){crmListView.bindPerfectScrollbar()}),1),getElemById("listViewTable")&&(document.getElementById("listViewTable").onselectstart=function(e){if("customCheckBox"==e.target.className||"customCheckBoxChecked"==e.target.className)return!1}),$("#lv_filter_scroll").keypress((function(e){crmListView.toggleFilterOptions(!1,!0)})),$("#lv_filter_scroll").change((function(e){crmListView.toggleFilterOptions(!1,!0)}))}},afterRenderStageView:function(e){var t=$("#sv_visitkanban");if($("#sv_visitnormal").removeClass("listViewTaskActive").addClass("listViewTaskDeactive"),t.removeClass("taskKanbanViewDeactive ripple-wave").addClass("taskKanbanViewActive"),$("#sv_visitcustomization").removeClass("customizedViewActive").addClass("customizedViewDeactive"),"true"!=e.error){if(e.layoutId){var i=$L("#layoutDropdown")[0];i&&(i.ltProp("selected",""),i.ltProp("selected",e.layoutId))}if("Potentials"==e.module&&e.pipeline&&""!=e.pipeline){var s=$L("#pipelineSelect")[0];s&&(s.ltProp("selected",""),s.ltProp("selected",e.pipeline))}var a=$L("#KanbanViewSortColumnDropdown")[0];if(a)if(a.ltProp("selected",""),e.sortColumnString){var r=e.sortColumnString;a.ltProp("selected",r);var l=$L("#KanbanViewSortOrderDropdown");"0"===r?l.addClass("nlvDisableOption"):(l[0].ltProp("selected",""),l[0].ltProp("selected",e.sortOrderString),l.removeClass("nlvDisableOption"))}else a.ltProp("selected","0"),$L("#KanbanViewSortOrderDropdown").addClass("nlvDisableOption");crmListView.createStageIdsArr(e.stageBoards),e.isStageView?(crmListView.checkForNoneStage(e,!0),crmListView.loadStageBoards(e.stageBoardDetails),t.removeClass("taskKanbanViewDeactive").addClass("taskKanbanViewActive")):(crmListView.loadStageBoards(e.predictData),t.removeClass("taskKanbanViewActive").addClass("taskKanbanViewDeactive"),$("#sv_visitpredict").removeClass("predictionKanbanIcon").addClass("predictionKanbanIconAct")),crmListView.checkForEmptyStage(e),crmListView.setWHforStageView(),$("#sv_stage_inner_parent").on("scroll",$L.debounce((function(){crmListView.loadMoreStageBoards()}),100)),e.isStageView&&e.colorScheme&&"random"===e.colorScheme&&crmListView.applyRandomColorForStages(),crmListView.bindScrollToStageBoards(),crmListView.updateStageSummary(),$("#ShowCustomViewDetails").find("br").remove();var o=$("#cvlist");o.length>0&&void 0!==o.perfectScrollbar&&thirdPartyUtils.bindPerfectScroll("#cvlist",{wheelSpeed:1,preventOnEnd:!0,preventHorizontal:!0})}},createStageIdsArr:function(e){var t=[],i=[],s=1;for(key in e)e.hasOwnProperty(key)&&(i.push(e[key].id),s%4==0&&(t.push(i),i=[]),s++);i.length>0&&t.push(i),customViewObject.stageIdsArr=t},checkForEmptyStage:function(e){var t=e.isStageView?e.stageBoardDetails:e.predictData;for(key in t)0===t[key].body.length&&$("#"+key+" #checkAll").hide()},getCustomClasses:function(e){for(var t=e.length,i=0;i<t;i++)e[i].commonClasses={},"Tasks"==e[i].ACTIVITYTYPE?(1==e[i].taskeditperm&&"2"!=e[i].RECORDAPPROVED&&"true"==e[i].ISCOMPLETED&&(e[i].commonClasses.taskCloseClass="dN"),e[i].commonClasses.subjectStyle="max-width: 40%",e[i].commonClasses.subjectClass="crm-base-font-size",e[i].commonClasses.priorityDurationClass="",e[i].commonClasses.priorityDurationTitle=e[i].PRIORITY,e[i].commonClasses.priorityDurationDisplay=e[i].PRIORITY,e[i].commonClasses.statusLocationType=e[i].STATUS,e[i].commonClasses.statusLocationClass="maxW35per",""!=e[i].RELATEDTITLE&&(e[i].commonClasses.relatedTitleClass="w75_per")):"Events"==e[i].ACTIVITYTYPE?(e[i].commonClasses.subjectClass="crm-base-font-size maxW35per crm-font-bold",e[i].commonClasses.dateClass="maxW60per",e[i].commonClasses.dateStyle="width: auto;",e[i].commonClasses.dateTitle=e[i].EVENTLISTVIEWFULLTIME,e[i].commonClasses.dateDisplayVal=e[i].EVENTLISTVIEWTIME,e[i].commonClasses.priorityDurationClass="dN",e[i].commonClasses.statusLocationType=e[i].LOCATION,e[i].commonClasses.statusLocationClass="mL3 w50_per",""!=e[i].RELATEDTITLE&&(e[i].commonClasses.relatedTitleClass="w100_per")):(e[i].commonClasses.subjectStyle="max-width: 58%",e[i].commonClasses.subjectClass="crm-base-font-size",e[i].commonClasses.dateStyle="width: 32%;",e[i].commonClasses.dateTitle=e[i].CALLSTARTDATETIME_TITLE,e[i].commonClasses.dateDisplayVal=e[i].CALLSTARTDATETIME,e[i].commonClasses.priorityDurationClass="maxW35per crm-base-font-size",e[i].commonClasses.priorityDurationDisplay=e[i].CALLDURATION,e[i].commonClasses.statusLocationType=e[i].CALLTYPE,e[i].commonClasses.statusLocationClass="mL3 w45_per",""!=e[i].RELATEDTITLE&&(e[i].commonClasses.relatedTitleClass="w65_per"))},afterRenderKanbanView:function(e){function t(){$(".tkvcancelLink").click((function(e){e.stopPropagation()})),$(".EditClose").click((function(e){e.stopPropagation()})),TaskKanbanView.setlayoutHt(".leftContainerctn")}TaskKanbanView.KvListItemClickCount=0,TaskKanbanView.kvrecordid=0,TaskKanbanView.iskanbanview=1,TaskKanbanView.kanbanviewloaded=1,e.kvColumnObj&&"false"==e.kvColumnObj.jsonobj.NORECORD&&crmListView.getCustomClasses(e.kvColumnObj.jsonarrayObj),crmListView.constructNavigObjForActivityModules(e,e.isKanbanView,e.module),$((function(){$(".footernewClass").addClass("hide");var i=e.isloadmore,s=(e.isRefresh,e.columntype);if("false"===i){if("Closed"===s){e.isFromActivityModule="Activities"===e.module?"true":"false";var a=Handlebars.templates.CrmKanbanViewColumns;$("#"+s+"_leftContainerBody").html(a(e))}t()}else{e.isFromActivityModule="Activities"===e.module?"true":"false";var r=Handlebars.templates.CrmKanbanViewColumns(e);if("false"==e.isRefresh){$("#loadmorediv").html(r),$("ul#"+s+"_Container").append(document.getElementById("loadmorediv").innerHTML);var l=$("#"+s+"_startindex");l.attr("value",parseInt(l.val())+20)}else $("#recordid_"+e.recordid).html(r);$(".tkvcancelLink").off("click"),$(".EditClose").off("click"),t()}"true"==e.nomore&&$("#"+s+"_tkvshowmore").addClass("hide")})),TaskKanbanView.KvCenterItem=0,$(".showhide").removeAttr("style")},afterRenderNormalView:function(e){TaskKanbanView.iskanbanview=0;var t=e.module;null!=e.fetchdate_title||"Leads"!=t&&"Accounts"!=t&&"Contacts"!=t&&"Potentials"!=t||null!=customViewObject.showBlankState&&0!=customViewObject.showBlankState||0!=customViewObject.isDataWaitingForApproval||(setDataFetchDate(),customViewObject.fetchdate_title=getObj("fetchdate_title").title),$("#sv_visitnormal").removeClass("listViewTaskDeactive").addClass("listViewTaskActive"),$("#sv_visitkanban").removeClass("taskKanbanViewActive").addClass("taskKanbanViewDeactive"),$("#sv_visitcustomization").removeClass("customizedViewActive").addClass("customizedViewDeactive"),setTimeout((function(){crmListView.createTableHeader()}),50)},afterRenderCustomizedView:function(e){if($("#sv_visitnormal").removeClass("listViewTaskActive").addClass("listViewTaskDeactive"),$("#sv_visitkanban").removeClass("taskKanbanViewActive").addClass("taskKanbanViewDeactive"),$("#sv_visitcustomization").removeClass("customizedViewDeactive").addClass("customizedViewActive"),LVCGallery.bindCanvasScrollEvent(),e.sortColumnString){var t=e.sortColumnString;0==$("#CustomizedViewSortColumnSelect option[value='"+t+"']").length&&(t="0"),$("#CustomizedViewSortColumnSelect").val(t),"0"==t?$("#CustomizedViewSortOrder").hide():$("#CustomizedViewSortOrderSelect").val(e.sortOrderString)}else $("#CustomizedViewSortColumn").val("0"),$("#CustomizedViewSortOrder").hide(),$("#cvfieldMappingdropdown").remove();Crm.trackSpotLightAction("Canvas - Default View",{Module:e.module}),Crm.client_tracking("Canvas - Default View");var i=$("#cvlist");i.length>0&&void 0!==i.perfectScrollbar&&thirdPartyUtils.bindPerfectScroll("#cvlist",{wheelSpeed:1,preventOnEnd:!0,preventHorizontal:!0})},kanbanView:function(e){for(var t=e.kvColumnObj.jsonarrayObj,i=t.length,s=0;s<i;s++){e.kvmodule.includes("Activities")?t[s].isFromActivityModule="true":t[s].isFromActivityModule="false";var a=store.peekRecord(moduleRecordMapping[e.kvmodule].id,t[s].ACTIVITYID);a&&a.Locked__s&&(t[s].Locked__s="detail"!==Lyte.Router.getRouteInstance().routeName||a.$locked_for_me,t[s].locked_for_me=a.$locked_for_me)}if("false"==e.kvColumnObj.jsonobj.NORECORD&&crmListView.getCustomClasses(e.kvColumnObj.jsonarrayObj),crmListView.constructNavigObjForActivityModules(e,!0,e.kvmodule),"Closed"==e.columntype&&"false"==e.isloadmore){e.columns=["Closed","Open","RelatedTo","other"];var r=Handlebars.templates.TaskKanbanView(e)}function l(){$(".tkvcancelLink").click((function(e){e.stopPropagation()})),$(".EditClose").click((function(e){e.stopPropagation()})),TaskKanbanView.setlayoutHt(".leftContainerctn")}return"Closed"==e.columntype&&($("#idForCV").remove(),$("#ShowCustomViewDetails").append(r)),$((function(){$(".leftContainerctn ul li").on("mouseover",(function(){$(this).hasClass("ligraybackground")||($(this).prev("li").find("div").eq(1).css("border-bottom-color","transparent"),$(this).find("div").eq(1).css("border-bottom-color","transparent"))})),$(".leftContainerctn ul li").on("mouseout",(function(){$(this).hasClass("ligraybackground")||$(this).next("li").hasClass("ligraybackground")&&$(this).find("div").eq(1).css("border-bottom-color","transparent")})),$(".footernewClass").addClass("hide");var t=e.columntype,i=e.nomore;if("false"==e.isloadmore)e.isFromActivityModule="Activities"===e.kvmodule?"true":"false","Closed"!==t&&"Open"!==t&&"RelatedTo"!==t&&"other"!==t||$("#"+t+"_leftContainerBody").html(Handlebars.templates.CrmKanbanViewColumns(e)),l();else{e.isFromActivityModule="Activities"===e.kvmodule?"true":"false";var s=(0,Handlebars.templates.CrmKanbanViewColumns)(e);if("false"==e.isRefresh||null==e.isRefresh){$("#loadmorediv").html(s),$("#"+t+"_Container").append($(s).find("li"));var a=$("#"+t+"_startindex");a.attr("value",parseInt(a.val())+20)}else $("#recordid_"+e.recordid).html(s);$(".tkvcancelLink").off("click"),$(".EditClose").off("click"),l(),i=e.kvColumnObj.jsonobj.NOMORE}"true"==i&&$("#"+t+"_tkvshowmore").addClass("hide"),$(".overDueCtn").on("mouseover",(function(){$(this).find(".overDueTask").addClass("hide"),$(this).find(".overdue").removeClass("hide")})),$(".overDueCtn").on("mouseout",(function(){$(this).find(".overDueTask").removeClass("hide"),$(this).find(".overdue").addClass("hide")})),$(".smFile").on("mouseover",(function(){$(this).siblings(".attachFile").addClass("linkactive")})),$(".smFile").on("mouseout",(function(){$(this).siblings(".attachFile").removeClass("linkactive")})),$(".ddTime").on("focus",(function(){taskDetailsview.ddTime("kanbanTaskDetailctn")})),taskDetailsview.setComposeWindow()})),TaskKanbanView.KvCenterItem=0,r},constructNavigObjForActivityModules:function(e,t,i){if(featuresAvailable.NEXTGENUI_ENABLED&&t&&("Activities"===i||"Tasks"===i||"Calls"===i||"Events"===i)){for(var s=moduleRecordMapping[i].per_page,a=[],r=1,l=e.kvColumnObj.jsonarrayObj,o=l.length,n=0;n<o;n++)l[n].RECORDNUM=r+"",a[r++]={module:"Activities"===i?l[n].ACTIVITYTYPE:i,id:l[n].ACTIVITYID};if(a.length>0){var c=customViewObject.cvid+"#"+e.columntype;crmNavig[c]={},crmNavig[c].recordId=a,crmNavig[c].currentOption=s}}},editSelectionLayerText:function(e){var t=customViewObject.singularModName;if(0!=e){if(1!=e&&(t=customViewObject.pluralModName),customViewObject.selectAllInCurrentView){customViewObject.totalCount&&customViewObject.totalCount>Crm.massOperationTotalLimit&&(customViewObject.doMassActioninScheduler=!1,$("#selectAllRecords").length>0&&(customViewObject.showSelectAll=!1,$("#selectAllRecords").hide()))}customViewObject.doMassActioninScheduler?customViewObject.selectedStages&&customViewObject.selectedStages.length>0&&$(".selCountNum").html(I18n.getMsg("crm.listview.selected.records",[customViewObject.indTotalCount,t])):$(".selCountNum").html(I18n.getMsg("crm.listview.selected.records",[e,t]))}},startIndex:{},changedPermissionsForZBModules:{Crm_Implied_View_CustomModule5001:"Crm_Implied_View_Invoice_Invoices",Crm_Implied_Create_CustomModule5001:"Crm_Implied_Create_Invoice_Invoices",Crm_Implied_Edit_CustomModule5001:"Crm_Implied_Create_Invoice_Invoices",Crm_Implied_View_CustomModule5002:"Crm_Implied_View_Invoice_Estimates",Crm_Implied_Create_CustomModule5002:"Crm_Implied_Create_Invoice_Estimates",Crm_Implied_Edit_CustomModule5002:"Crm_Implied_Create_Invoice_Estimates",Crm_Implied_View_CustomModule5004:"Crm_Implied_View_Invoice_SalesOrders",Crm_Implied_Create_CustomModule5004:"Crm_Implied_Create_Invoice_SalesOrders",Crm_Implied_Edit_CustomModule5004:"Crm_Implied_Create_Invoice_SalesOrders",Crm_Implied_View_CustomModule5003:"Crm_Implied_View_Invoice_PurchaseOrders",Crm_Implied_Create_CustomModule5003:"Crm_Implied_Create_Invoice_PurchaseOrders",Crm_Implied_Edit_CustomModule5003:"Crm_Implied_Create_Invoice_PurchaseOrders"},showColumnList:function(e,t){var i=$L(window).scrollTop(),s=$(window).height(),a=$(document).width(),r=$("#wmstoolbar").outerHeight(),l=renderingUtils.tabLayerOuterHeight();columnListVDropDown=!0,t=t||"columnList";var o=customViewObject.isCampaignAddMemberListView?$("#lv_table_holder #columnList"):$("#"+t);if(e.preventDefault(),"none"==o.css("display")){$("#listviewHeaderRow #addColumn").addClass("addColumnActive");var n=customViewObject;n.module=customViewObject.isPrivacyListView?customViewObject.module.replace("privacy_",""):customViewObject.module;var c=n.isStageView;if(c||n.hasOwnProperty("columns")){if(c){var d={from:"stageView",save:"crmListView.setStageFilters();",cancel:"hideMenu(event, this);",divid:"sv_sel_stagelist",columns:customViewObject.stageBoards};o.html(Handlebars.templates.columnList(d)),Crm.menu.createMenu(e,t),o.find("li").find('input[type="checkbox"]').off("click").click((function(){!$(this).prop("checked")&&$("#sv_sel_stagelist input:checked").length<2&&(alert("There must be a minimum of 3 stages selected in Stage view"),$(this).prop("checked",!0))}))}else{n.from="listview";var m=Handlebars.templates.columnList(n);o.html(m),delete n.from,Crm.menu.createMenu(e,"columnList"),$("#columnListId").sortable({stop:function(e,t){var i=t.item.find('input[type="checkbox"]');i.length&&(i.prop("disabled",!0),setTimeout((function(){var e=i.attr("data-params");e&&"true"===JSON.parse(e).ismandatory||i.prop("disabled",!1)}),300))}}),o.find("li").find('input[type="checkbox"]').off("click").click((function(){$(this).prop("checked")&&$("#columnListId input:checked").length>Search.MAX_COL_CNT&&(alert(I18n.getMsg("crm.alert.max.cvcols.reached",Search.MAX_COL_CNT)),$(this).prop("checked",!1))}))}o.css("position","fixed"),crmListView.rowClick("listview"),$(document).off("menuItemClicked");var u=$("#cvpadding").outerHeight(),p=$("#notificationCenterContainer").length?$("#notificationCenterContainer").outerHeight():0;if($("#copyListviewHeaderDiv").is(":visible")){o.addClass("fixedTopColumnList");var f=s-(l+u+r)-140}else{o.removeClass("fixedTopColumnList");f=s-(l+u+p+r)-140+i}0==$("#copyListviewHeaderDiv").is(":visible")&&1==$("#cvpadding").hasClass("pFixed")&&o.css("top",parseInt(o.css("top"))+67.5),$("#menuColumnListView").css({"max-height":f}),Crm.userDetails.RTL_ENABLED&&o.css({"min-width":a-($("#addColumn").offset().left+$("#addColumn").width()),zindex:"12 !important"})}else{var v=n.module;(new crmRequestPool).doAjax(Crm.getCrmBasePath()+"/CustomDisplay.do?actionName=show&frmmodule="+v+"&cust_disp_module="+v+"&from=listView&cvid="+n.cvId+"&nocache="+(new Date).getTime(),(function(t){n.columns=t.columns,n.from="listview",n.save="crmListView.saveCustomView(event);",n.cancel="hideMenu(event, this);",n.divid="columnListId";var c=Handlebars.templates.columnList(n);delete n.from,o.html(c),Crm.menu.createMenu(e,"columnList"),o.css("position","fixed"),$("#columnListId").sortable({helper:"clone",stop:function(e,t){var i=t.item.find('input[type="checkbox"]');i.length&&(i.prop("disabled",!0),setTimeout((function(){var e=i.attr("data-params");e&&"true"===JSON.parse(e).ismandatory||i.prop("disabled",!1)}),300))}}),crmListView.rowClick("listview"),$(document).off("menuItemClicked");var d=$("#cvpadding").outerHeight(),m=$("#notificationCenterContainer").length?$("#notificationCenterContainer").outerHeight():0,u=$("#addColumn");if($("#copyListviewHeaderDiv").is(":visible")){o.addClass("fixedTopColumnList");var p=s-(l+d+r)-140}else{o.removeClass("fixedTopColumnList");p=s-(l+d+m+r)-140+i}$("#menuColumnListView").css({"max-height":p}),thirdPartyUtils.bindPerfectScroll("#menuColumnListView",{wheelSpeed:1,preventOnEnd:!0,preventHorizontal:!1}),Crm.userDetails.RTL_ENABLED&&o.css({"min-width":a-(u.offset().left+u.width()),zindex:"12 !important"}),customViewObject.columns=t.columns,o.find("li").find('input[type="checkbox"]').off("click").click((function(){$(this).prop("checked")&&$("#columnListId input:checked").length>Search.MAX_COL_CNT&&(alert(I18n.getMsg("crm.alert.max.cvcols.reached",Search.MAX_COL_CNT)),$(this).prop("checked",!1))})),$("input[value='CrmTask:ISCALLBILLABLE:Billable:']").closest("li").hide()}))}thirdPartyUtils.bindPerfectScroll("#menuColumnListView",{wheelSpeed:1,preventOnEnd:!0,preventHorizontal:!1})}else $("#listviewHeaderRow #addColumn").removeClass("addColumnActive"),o.slideUp(100)},rowClick:function(e){$("#columnListId li").find("label").on("click",(function(t){var s=$(this).find("input");if(s.is(":disabled"))return!1;var a=$("#columnListId li:visible").find("label input:checked").length;t.preventDefault();var r=$(this).closest("li"),l=$("#columnListId li:visible").index($(this).closest("li"));if(s.is(":checked")){s.prop("checked",!1);var o=a-l-1;for(o*=26,r.css({transform:"translateY("+o+"px)",transition:"0.3s all ease"}),i=l+1;i<a;i++)myCSSObj={},myCSSObj.transition="0.3s transform ease",myCSSObj.transition="translateY(-100%)",$($("#columnListId li:visible")[i]).css(myCSSObj);r.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",(function(e){$("#columnListId li").css({transform:"",transition:""}),r.insertAfter($("#columnListId li:visible")[a-1]),r.off("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend")}))}else{if($("#columnListId input:checked").length>=Search.MAX_COL_CNT)return crmui.showMsgBand("error",I18n.getMsg("crm.alert.max.cvcols.reached",Search.MAX_COL_CNT),4e3),!1;o=l-a;for(s.prop("checked",!0),o*=26,r.css({transform:"translateY(-"+o+"px)",transition:"0.3s all ease"}),i=a;i<l;i++)myCSSObj={},myCSSObj.transition="0.3s transform ease",myCSSObj.transition="translateY(100%)",$($("#columnListId li:visible")[i]).css(myCSSObj);r.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",(function(e){$("#columnListId li").css({transform:"",transition:""}),r.insertAfter($("#columnListId li:visible")[a-1]),r.off("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend")}))}if(Crm.userDetails.isLookupAdvancedSearchEnabled&&"lookupview"==e){var n=$("#columnListId");n.find("input:checked").length>=10?n.find("label input:not(:checked)").attr("disabled","disabled").closest("li").addClass("disable"):n.find("label  input[ismandatory!='true']").removeAttr("disabled").closest("li").removeClass("disable")}}));var t=crmListView.getObject();"Leads"!==t.module&&"Contacts"!==t.module||"lookupview"==e||crmListView.mandatoryCheck()},alphaSearchHandling:function(){var e=window.event,t=e.target?e.target:e.srcElement;if("A"===t.tagName){var i=objectUtils.cloneObject(Lyte.Router.getRouteInstance().transition.info);if(i.queryParams.page&&(i.queryParams.page=1),"alphaSearch_all"===t.getAttribute("id")||"alphaSearch_remove"===t.getAttribute("id")?delete i.queryParams.search_letter:i.queryParams.search_letter=t.innerHTML,t.getAttribute("data-td"))var s=JSON.parse(t.getAttribute("data-td"));customViewObject.viewid&&s&&delete s.fetchOnlyBody;var a=Lyte.Router.transitionTo(i);s.fetchOnlyBody&&(a.fetchOnlyBody=!0,delete s.fetchOnlyBody),s&&(a.data=s)}},saveCustomView:function(e){var t=crmListView.getObject();t.module=customViewObject.isPrivacyListView?t.module.replace("privacy_",""):t.module;for(var i=$("#columnListId input:checked"),s=!1,a=0;a<t.columns.length;a++)if(t.columns[a]){if(!t.columns[a].hasOwnProperty("SELECTED")){0!=$(i[a]).length&&(s=!0);break}if(0==$(i[a]).length||$(i[a]).data("params").columnname!=t.columns[a].COLUMNNAME){s=!0;break}}if(s){$("#UpdateCustomView").remove(),$("#show").append(CustomView.formSelectColumnString());var r=commonUtils.formData2QueryString(document.getElementById("UpdateCustomView"));return r=r+"&cvid="+t.cvId+"&actionType=addColumn&customviewname="+t.dispCvName+"&"+Territory.csrf(),doAjaxUpdate("json",Crm.getCrmBasePath()+"/UpdateCustomView.do?module="+t.module,r,(function(){var e=crmTab.getFromCache(t.module);crmTab.deleteFromCache(t.module);var i=new crmRequestPool,s={module:t.module,fromIndex:t.fromIndex,toIndex:t.toIndex,currentOption:t.currentOption,fetchOnlyBody:"true",cvid:t.cvId};if(crmListView.getFilterParams(s),crmListView.getAdvSearchCrtFromCVObject(s),"Visits"==t.module){var a=t.portalName;"All Portals"==a?s.allPortals=!0:(s.portalName=a,s.allPortals=!1)}if(customViewObject.isPrivacyListView){var r=objectUtils.cloneObject(commonUtils.getRouteObject(Lyte.Router.getRouteInstance().transition));return r.data&&delete r.data.fetchOnlyBody,Lyte.Router.transitionTo(r).refresh=!0,!0}if(customViewObject.isCampaignAddMemberListView&&"undefined"!=typeof CrmCampaignInteg)return CrmCampaignInteg.onColumnChange(s,t.module),!0;i.initiate({action:Crm.getCrmBasePath()+"/ShowDetails.do?",data:s,type:"GET",success:function(t){if(t.body&&0!=t.body.length){for(var i=[],s=t.fromIndex-1,a=0;s<=t.toIndex;s++,a++)t.body[a]?i[s]=t.body[a]:i[s]=null;t.body=i}e.body=t.body,e.heading=t.heading,e.fromIndex=t.fromIndex,e.toIndex=t.toIndex,e.sortColumnString="",delete e.columns;var r,l=e.cvFilters.length,o=e.heading,n=o.length;for(s=0;s<l;s++)if(e.isVTAdvFilterAvailable){if(e.cvFilters[s]&&!e.cvFilters[s].crossModule&&!e.cvFilters[s].trackingFilter&&!e.cvFilters[s].isVtColumn){r=s;break}}else if(e.cvFilters[s]&&!e.cvFilters[s].crossModule&&!e.cvFilters[s].trackingFilter){r=s;break}for(s=0;s<n&&r<l;s++,r++){var c,d=o[s].COLUMNNAME;if(e.cvFilters[r]&&e.cvFilters[r].value.split(":")[1]!=d){for(a=r;a<l;a++)if(e.cvFilters[a]&&(e.cvFilters[a].value.split(":")[1]==d||e.cvFilters[a].value.indexOf(d)>-1)){c=e.cvFilters[a];for(a=a;a>r;a--)e.cvFilters[a]=e.cvFilters[a-1]}c?(e.cvFilters[r]=c,c=null):r--}}$(".fixedrowTd").html(Handlebars.templates.fixedColumnlistview(e)),$("#listviewHeaderRow").parent().html(Handlebars.templates.heading(e)),$("#lvTred").html(Handlebars.templates.body(e)),renderingUtils.tableSorter("listViewTable","2","500"),customViewObject=e,crmTab.putInCache(e.module,e),hideMenu(),setTimeout((function(){crmListView.createTableHeader()}),50)}}),delete s.fetchOnlyBody})),!0}this.showColumnList(e)},selectColumn:function(e,t){var i=$(t).find("input");if($(i).prop("disabled"))return!1;$(i).prop("checked")?$(i).pro("checked",!1):$(i).prop("checked",!0)},shiftSelect:function(e,t,i,s){var a=$(t).data("params").entityId,r=customViewObject.body,l=$("#"+customViewObject.prevSelectedId).data("params").recordNum-1,o=$("#"+a).data("params").recordNum-1,n=customViewObject.selectedIds,c=0,d=customViewObject.fromIndex;if("customCheckBox"==$(t).attr("class")){if(o<l)for(var m=l;m>=o;m--){if(n.length==crmConstants.maxSelectCount){renderingUtils.showCustomAlert(I18n.getMsg("crm.listview.maximum.records.alert",crmConstants.maxSelectCount));break}if(2!=r[m].approveStatus){var u=r[m].ENTITYID;n.contains(u)||($("#listViewTable #"+u+" .customCheckBox").attr("class","customCheckBoxChecked"),Lyte.arrayUtils(n,"push",u),$("#listViewTable #"+u,".fixedrowTd #"+u).css("background-color","var(--tableHighlight)"),$("#listViewTable,.fixedrowTd").find("tr#"+u).css("background-color","var(--tableHighlight)").addClass("setTdBorBtm"),$("#fixedrowTd tr#"+u+" .customCheckBox").attr("class","customCheckBoxChecked"),c++)}}else for(m=l;m<=o;m++){if(n.length==crmConstants.maxSelectCount){renderingUtils.showCustomAlert(I18n.getMsg("crm.listview.maximum.records.alert",crmConstants.maxSelectCount));break}if(2!=r[m].approveStatus){u=r[m].ENTITYID;n.contains(u)||($("#listViewTable #"+u+" .customCheckBox").attr("class","customCheckBoxChecked"),Lyte.arrayUtils(n,"push",u),$("#listViewTable #"+u,".fixedrowTd #"+u).css("background-color","var(--tableHighlight)"),$("#listViewTable,.fixedrowTd").find("tr#"+u).css("background-color","var(--tableHighlight)").addClass("setTdBorBtm"),$("#fixedrowTd tr#"+u+" .customCheckBox").attr("class","customCheckBoxChecked"),c++)}}this.startIndex.hasOwnProperty(d)?this.startIndex[d]=this.startIndex[d]+c:this.startIndex[d]=c,0==$(".customCheckBox[data-cid=selectEntity]").length&&($("#listViewTable #checkAll,.fixedheadercolumn #checkAll,#fixedHeader #checkAll,#cvcheckAll").attr("class","customCheckBoxChecked"),$("#fixedChkSelAll").attr("class","customCheckBoxChecked"))}else{if(o<l){var p=l;l=o,o=p}for(m=l;m<=o;m++)if(2!=r[m].approveStatus){u=r[m].ENTITYID;n.contains(u)&&($("#listViewTable #"+u+" .customCheckBoxChecked").attr("class","customCheckBox"),Lyte.arrayUtils(n,"removeAt",n.indexOf(u),1),$("#listViewTable #"+u,".fixedrowTd #"+u).css("background-color",""),$("#listViewTable,.fixedrowTd").find("tr#"+u).css("background-color",""),$("#fixedrowTd tr#"+u+" .customCheckBoxChecked").attr("class","customCheckBox"),c++)}this.startIndex[d]=this.startIndex[d]-c,0==this.startIndex[d]&&delete this.startIndex[d],0==$(".customCheckBoxChecked[data-cid=selectEntity]").length&&($("#listViewTable #checkAll,.fixedheadercolumn #checkAll,#fixedHeader #checkAll,#cvcheckAll").attr("class","customCheckBox"),$("#fixedChkSelAll").attr("class","customCheckBox"))}if(customViewObject.selectedIds=crmTab.getFromCache(customViewObject.module).selectedIds=n,this.editSelectionLayerText(n.length),"crm.tab.module.custom-view.list"!=i&&"crm.tab.module.custom-view.kanban"!=i&&"crm.tab.module.custom-view.canvas"!=i&&showHideListViewBtnFn(),"crm.tab.module.custom-view.list"==i||"crm.tab.module.custom-view.kanban"==i||"crm.tab.module.custom-view.canvas"==i){var f=Math.round(customViewObject.fromIndex/moduleRecordMapping[customViewObject.module].per_page)+1,v={selectedIds:n,per_page:customViewObject.toIndex,page:f,module:customViewObject.module,start_index:Math.round(customViewObject.fromIndex)-1,route:s};Lyte.registeredMixins["crm-view-utils"].observeSelectedIds(v)}customViewObject.prevSelectedId=a},showSheet:function(){Crm.isSheetViewInfoEnabled?crmListView.export_sheet():Lyte.injectResources(networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("sheetview")],ResourceConstants.CRM),(function(e){"error"!==e.type&&$L("crm-customview-layer")[0].component.setData("show_sheet_modal",!0)}),(function(){$L("crm-customview-layer")[0].component.setData("show_sheet_modal",!0)}))},export_sheet:function(){Crm.isSheetViewInfoEnabled||$L("crm-customview-layer")[0].component.setData("show_sheet_modal",!1),Crm.isSheetViewInfoEnabled=!0,Lyte.injectResources(networkUtils.returnDependencyFiles(["crm-sheet-view.js"],ResourceConstants.CRMClient),void 0,(function(){commonUtils.showHideLoadingDiv(!0);var e={};if(!Crm.userDetails.isStorageLimitReached||Crm.isSheetAlertDisabled)if(Crm.userDetails.isStorageLimitReached&&(Crm.isSheetAlertDisabled=!1),Crm.userDetails.permissions["Crm_Implied_ZohoSheet_View_"+customViewObject.module]||Crm.userDetails.permissions["Crm_Implied_Edit_"+customViewObject.module]){var t=store.peekRecord("custom_view",customViewObject.cvId);e.module=t.module,e.custom_view={id:t.id,name:t.name},e.alphabet=customViewObject.searchletter,"All"===e.alphabet&&(e.alphabet=null),customViewObject.filter_id?e.filter_id=customViewObject.filter_id:(customViewObject.filters&&(e.filters=customViewObject.filters),customViewObject.cross_filters&&(e.cross_filters=customViewObject.cross_filters)),customViewObject.includeChild&&(e.includeChild=customViewObject.includeChild),e.page=customViewObject.fromIndex,e.per_page=customViewObject.currentOption;var i=store.createRecord("sheet_view");i.$.set("sheet_view",e),i.$.save().then((function(e){commonUtils.showHideLoadingDiv(!1),e.sheet_view.details&&networkUtils.openUrlwithpopBlockerHandle(e.sheet_view.details.url,I18n.getMsg("crm.nsocial.setup.popup.blocking"))}),(function(e){commonUtils.showHideLoadingDiv(!1),403===e.status?renderingUtils.displayPermissionDenied():500===e.status?_cruxUtils.showCustomMessage({params:{ltPropMessage:I18n.getMsg("crm.alert.generalError"),ltPropType:"error"}}):_cruxUtils.showCustomMessage({params:{ltPropMessage:I18n.getMsg("crm.errorpage.note1"),ltPropType:"error"}})}))}else renderingUtils.displayPermissionDenied();else Crm.showStorageExceedPopup("sheetAlert")}))},reportErrorPage:function(e){var t=JSON.parse($(e).attr("data-params"));networkUtils.setCsrfParam(t),(new crmRequestPool).initiate({action:Crm.getCrmBasePath()+"/FailurePage.do",type:"POST",data:t,success:function(e){$("#listViewErrorMsg").hide(),$("#successMsgContainer").show()}})},getNavigationDiv:function(e){var t=document.getElementsByName("displayCount");$(t).parent("tr").css("display",""),0==e.body.length&&$(t).parent("tr").css("display","none"),1==e.fromIndex?($($(t)[0]).prev("td").html("<div class='previousDisabled'></div>"),$($(t)[1]).prev("td").html("<div class='previousDisabled'></div>")):($($(t)[0]).prev("td").html("<span id='navigatePreviousPage_"+e.fromIndex+"'><input type='button' class='previous' alt='"+I18n.getMsg("crm.label.page.navigation.previous.enabled")+"' name='previoues' id='advancedsearchArrowP' border='0' onclick='crmListView.recordChange({\"module\":\""+e.module+'", "fromIndex":"'+e.fromIndex+'", "nav":"true", "fromListView":"true", "fromApproval":"false", "massActions":"false", "cvid":"'+e.cvId+'","clickId":"navigate_previous_listview"},this)\'></span>'),$($(t)[1]).prev("td").html("<span id='navigatePreviousPage_"+e.fromIndex+"'><input type='button' class='previous' alt='"+I18n.getMsg("crm.label.page.navigation.previous.enabled")+"' name='previoues' id='advancedsearchArrowP' border='0' onclick='crmListView.recordChange({\"module\":\""+e.module+'", "fromIndex":"'+e.fromIndex+'", "nav":"true", "fromListView":"true", "fromApproval":"false", "massActions":"false", "cvid":"'+e.cvId+'","clickId":"navigate_previous_listview"},this)\'></span>')),$($(t)[0]).html("<b>"+e.fromIndex+"</b>&nbsp;<span class='crmLabelColor'>"+I18n.getMsg("crm.label.lowercase.to")+"</span>&nbsp;<b>"+getEndIndex(e.fromIndex,e.toIndex,e.currentOption,e.body)+"</b>"),$($(t)[1]).html("<b>"+e.fromIndex+"</b>&nbsp;<span class='crmLabelColor'>"+I18n.getMsg("crm.label.lowercase.to")+"</span>&nbsp;<b>"+getEndIndex(e.fromIndex,e.toIndex,e.currentOption,e.body)+"</b>"),e.body[e.toIndex]?($($(t)[0]).next("td").html("<span id='navigateNextPage_"+e.fromIndex+"'><input type='button' alt='"+I18n.getMsg("crm.label.page.navigation.next.enabled")+"' class='next fL' name='next' id='advancedsearchArrowN' border='0' onclick='crmListView.recordChange({\"module\":\""+e.module+'", "fromIndex":"'+e.fromIndex+'", "nav":"true", "fromListView":"true", "fromApproval":"false", "massActions":"false", "cvid":"'+e.cvId+'","clickId":"navigate_next_listview"},this)\'></span>'),$($(t)[1]).next("td").html("<span id='navigateNextPage_"+e.fromIndex+"'><input type='button' alt='"+I18n.getMsg("crm.label.page.navigation.next.enabled")+"' class='next fL' name='next' id='advancedsearchArrowN' border='0' onclick='crmListView.recordChange({\"module\":\""+e.module+'", "fromIndex":"'+e.fromIndex+'", "nav":"true", "fromListView":"true", "fromApproval":"false", "massActions":"false", "cvid":"'+e.cvId+'","clickId":"navigate_next_listview"},this)\'></span>')):($($(t)[0]).next("td").html("<div class='nextDisabled'></div>"),$($(t)[1]).next("td").html("<div class='nextDisabled'></div>"))},showCompatibilityError:function(e){renderingUtils.showCustomAlert(I18n.getMsg("crm.filters.incompatible.error.msg")),e&&e.stopPropagation()}};Handlebars.registerHelper("isPipelineEnabled",(function(e,t){var i=crmListView.getObject();if(Crm.userDetails.isMultiPipelineActivated){if(!e){if(!i.layoutId)return t.fn(this);e=i.layoutId}var s=store.peekRecord("layout",e);if(s&&s.sections)for(var a=s.sections,r=a.length,l=0;l<r;l++)if(a[l].fields.filterBy({column_name:"PIPELINE"}).length)return t.fn(this)}return t.inverse(this)})),crmListView.getAdvSearchCrtFromCVObject=function(e){var t=crmListView.getObject();if(t){if(!0===t.criteriaSearch||"true"===t.criteriaSearch){e.rowCount=Search.rowcnt;for(var i=1;i<=Search.rowcnt;i++){e["searchfield"+i]=t["searchfield"+i],1!=i&&(e["match"+i]=t["match"+i]);var s=e["searchfieldtype"+i]=t["searchfieldtype"+i];"U"==s?(e["searchuser"+i]=t["searchuser"+i],e["usercondition"+i]=t["usercondition"+i],e["temp_searchuser"+i]=t["temp_searchuser"+i]):"T"==s?(e["textcondition"+i]=t["textcondition"+i],e["searchtext"+i]=t["searchtext"+i]):"picklist"==s?(e["searchpicklist"+i]=t["searchpicklist"+i],e["textpicklistcondition"+i]=t["textpicklistcondition"+i]):"L"==s?(e["searchlayout"+i]=t["searchlayout"+i],e["textlayoutcondition"+i]=t["textlayoutcondition"+i]):"tag"==s?(e["searchtag"+i]=t["searchtag"+i],e["texttagcondition"+i]=t["texttagcondition"+i]):"N"==s?(e["searchnum"+i]=t["searchnum"+i],e["numcondition"+i]=t["numcondition"+i]):"B"==s?(e["searchboolean"+i]=t["searchboolean"+i],e["booleancondition"+i]=t["booleancondition"+i]):"CML"==s?(e["searchcampcv"+i]=t["searchcampcv"+i],e["campcvcondition"+i]=t["campcvcondition"+i],e["temp_searchcampcv"+i]=t["temp_searchcampcv"+i]):"D"==s?(e["datecondition"+i]=t["datecondition"+i],t["datecondition"+i]==Search.ageCrt||t["datecondition"+i]==Search.dueCrt?(e["ageindayscondition"+i]=t["ageindayscondition"+i],e["ageindays"+i]=t["ageindays"+i]):(e["searchdate"+i]=t["searchdate"+i],e["searchedate"+i]=t["searchedate"+i])):"DT"==s&&(e["datetimecondition"+i]=t["datetimecondition"+i],t["datetimecondition"+i]==Search.ageCrt||t["datetimecondition"+i]==Search.dueCrt?(e["ageindayscondition"+i]=t["ageindayscondition"+i],e["ageindays"+i]=t["ageindays"+i]):(e["searchdatedate"+i]=t["searchdatedate"+i],e["searchsthour"+i]=t["searchsthour"+i],e["searchstminute"+i]=t["searchstminute"+i],e["searchstampm"+i]=t["searchstampm"+i],e["searchenddate"+i]=t["searchenddate"+i],e["searchethour"+i]=t["searchethour"+i],e["searchetminute"+i]=t["searchetminute"+i],e["searchstime"+i]=t["searchstime"+i],e["searchetime"+i]=t["searchetime"+i],e["searchetampm"+i]=t["searchetampm"+i]))}e.patternVal=t.patternVal,e.criteriaSearch=!0}t.searchletter&&"All"!==t.searchletter&&(e.searchletter=t.searchletter);var a=Lyte.Router.getRouteInstance();t.filters&&(e.filters=JSON.stringify(t.filters),"kanban"!=a.routeName&&"canvas"!=a.routeName&&"zia"!=a.routeName||(e.isNewFilter=!0)),t.cross_filters&&(e.cross_filters=JSON.stringify(t.cross_filters),e.isNewFilter=!0),(t.filter_id||t.filterId)&&(e.filterId=t.filter_id?t.filter_id:t.filterId)}},crmListView.showUserToolTip=function(e){if(!Crm.userDetails.CLIENT_ACCOUNT){var t=$(e),i=$("body").outerWidth(),s=t.offset(),a=i<t.closest("td").width()+s.left+300?"left":"right",r=JSON.parse(e.getAttribute("data-params")).userId;Crm.getUserBusinessCard(r,e,a)}};var recordNum,customViewObject={};function getEndIndex(e,t,i,s,a){if(e=parseInt(e),t=parseInt(t),null==i&&(i=t-e+1),i=parseInt(i),!0!==a){if(s&&s.length>=i){if(null!=s[t-1])return e+i-1;for(var r=e-1;null!=s[r];r++);return r}if(s)return s&&s.length>=i&&null!=s[t-1]?e+i-1:e+s.length-1}else if(s)return s&&s.length>=i?e+i-1:e+s.length-1;return 0}function hideMassOperationsForScheduler(){$("#scheduleMassActionDiv").hide(),$("#actionMenuForScheduler").css({display:"",visibility:"hidden"})}function showMassOperationsForScheduler(){$("#macroDiv").css({display:"none",visibility:"hidden"}),$("#selectAllRecords").length>0&&($("#scheduleMassActionDiv").show(),$("#actionMenuForScheduler").css({display:"",visibility:"hidden"}),$("#selectAllRecords").hide(),customViewObject.showSelectAll=!0)}function overLayForSelectAllClick(e,t){var i=customViewObject.fromIndex,s="navigatePreviousPage_"+i,a="navigateNextPage_"+i,r="";t&&(r="#"+t+" .stageview-data-container"),e?$("#lv_stageview "+r+",#lv_left_filter,#lv_table_holder,#listviewHeaderRow,#lvTred,#"+s+",#"+a+",#viewcontainer,crm-custom-filter").addClass("selectAllOverlay"):$("#lv_stageview "+r+",#lv_left_filter,#lv_table_holder,#listviewHeaderRow,#lvTred,#"+s+",#"+a+",#viewcontainer,crm-custom-filter").removeClass("selectAllOverlay")}function reloadAfterMassAction(e,t){if("Leads"===e||"Accounts"===e||"Contacts"===e||"Potentials"===e){var i=$("#fetchdate_title");i.length>0&&i[0].click()}else Utils.windowLocationReload();$("div:visible[id*='job_']").each((function(){$(this).remove()})),massActionNotification.hideMassOperationProgressDiv()}function showHideSelectAllLink(e,t){var i=$("crm-customview-buttons");"customCheckBoxChecked"==e&&Crm.userDetails.ISPAID_USER?(!Lyte.Router.getRouteInstance().getQueryParams().filters&&i&&i.length&&Crm.massOperationTotalLimit>=moduleRecordMapping[t].total_count&&(customViewObject.showHideSelectAllDiv=!0,i[0].setData("showSelectedDiv",!0)),customViewObject.selectAllInCurrentView=!0):(customViewObject.doMassActioninScheduler=!1,customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView||(crmTab.getFromCache(t).doMassActioninScheduler=!1))}function checkDateString(e,t,i){try{var s=Utils.convertUsrtoDefaultDatePattern(i.CONTENT[t],!0)}catch(e){}if(!s||!s.getMonth)return i.CONTENT[t];var a=Utils.getDateInUserDatePattern(s);if($("#currentDate").length&&$("#currentDate").val())var r=$("#currentDate").val().trim().split("-"),l=new Date(r[0],r[1]-1,r[2]);l&&l.getMonth||(l=new Date).setHours(0,0,0,0);var o=Utils.getDayDiff(l,s),n="",c=0===o?"h_todaytask":"h_latertask",d=0===o?I18n.getMsg("Today"):$.datepicker.formatDate("M d",s),m="";s<todaydate&&"false"===i.COMPLETED?(n=s.getTime()<l.getTime()?Utils.getDayDiff(l,s):"",c=0!==o?"h_overdue":c,m=1===o?"crm.label.overdue.late.day":"crm.label.overdue.late.days"):"false"!==i.COMPLETED&&(c="h_completetask");var u=i.ENTITYID;return'<span class="h_duedate '+c+'" title="'+a+'"><input  value="'+d+'" data-old="'+d+'" id="task_'+u+'" name="task_'+u+'" size="6" class="borderNone cP h_duedate '+c+'" onchange="homePageDateEdit(this);" readonly/></span><span class="pL25 crm-extra-small-font-size" name="daydiff" title="'+I18n.getMsg(m,n)+'">'+n+"</span>"}function editmouseover(e,t){var i="#customButtonDetails_"+t;if("phone"==t){var s=$(e).closest("tr");$(s).is(":animated")&&$(s).finish(),$(s).removeClass("bg_white").addClass("bg_crmSelectBg"),t=$(s).attr("id"),$("#div"+t).attr("style","visibility:visible"),$(i).attr("style","visibility:visible"),$(e).find("a").attr("style","visibility:visible")}else{$(e).is(":animated")&&$(e).finish(),$(".bg_crmSelectBg").removeClass("bg_crmSelectBg"),$(e).removeClass("bg_white").addClass("bg_crmSelectBg");var a=$(e).attr("id");$(".fixedrowTd").find("tr#"+a).removeClass("bg_white").addClass("bg_crmSelectBg"),$("#listViewTable tbody").find("#"+a).removeClass("bg_white").addClass("bg_crmSelectBg"),$("#div"+t).attr("style","visibility:visible"),$(i).attr("style","visibility:visible"),$(".fixedrowTd").find("#div"+t).attr("style","visibility:visible"),$(".fixedrowTd").find("#div"+t+" a:not(.task_vr_failed)").attr("style","visibility:visible"),$("#selectEntity_"+t+".onHover").attr("style","visibility:visible"),$("#selectEntity_"+t+".customCheckBoxDisabled").attr("style","visibility:visible")}}function editmouseout(e,t){var i="#customButtonDetails_"+t;if("phone"==t){var s=$(e).closest("tr");$(s).removeClass("bg_crmSelectBg").addClass("bg_white"),t=$(s).attr("id"),$("#div"+t).attr("style","visibility:hidden"),$(i).attr("style","visibility:hidden"),$(e).find("a").attr("style","visibility:hidden")}else{$("#fixedRowHeader").find();var a=$(e).attr("id");$(".bg_crmSelectBg").removeClass("bg_crmSelectBg"),$(e).removeClass("bg_crmSelectBg").addClass("bg_white"),$(".fixedrowTd").find("tr#"+a).removeClass("bg_white").addClass("bg_crmSelectBg"),$("#fixedRowHeader").find("#"+a).removeClass("bg_crmSelectBg").addClass("bg_white"),$("#div"+t).attr("style","visibility:hidden"),$(i).attr("style","visibility:hidden"),$(".fixedrowTd").find("#div"+t).attr("style","visibility:hidden"),$(".fixedrowTd").find("#div"+t+" a:not(.task_vr_failed)").attr("style","visibility:hidden"),$("#selectEntity_"+t+".onHover").attr("style","visibility:hidden"),$("#selectEntity_"+t+".customCheckBoxDisabled").attr("style","visibility:hidden")}}function callMassRecords(e,t,i){var s=i&&"bulk_mass_update"==i;return(s&&Search.getCriteriaDetails(void 0,void 0,!1,void 0)||!s&&Search.validate())&&(s&&(i="mass_update"),document.TransferWizardForm.action=Crm.getCrmBasePath()+"/MassRecords.do?mod=true&actiontype="+i+"&from_index="+e+"&to_index="+t,document.TransferWizardForm.method="post",doAjaxUpdateForm("massResult",document.TransferWizardForm)),!1}Handlebars.registerHelper("getIncludeChild",(function(e,t,i){for(var s=0;s<e.length;s++)if(e[s].id==t)return e[s].hasOwnProperty("ishaving")&&i?e[s].nameanditschild:e[s].name;return""})),Handlebars.registerHelper("IterateMoreActions",(function(e,t,i,s){var a="",r=0,l=3;if("button"!==i){r=l;var o=!0;if((l=e.length)>r)1==l-r&&"scheduleMassOperation"===e[l-1]&&(o=!1);l>r&&o&&(a='<div class="pR dIB fL">',a+='<span class="normalDropDown fL'+(customViewObject.isZBCustomModule?"hide":"")+'">',a+='<span class="newwhitebtn moredot_h2_35 showAct  moredotparentBtn" name="moreAct" data-zcqa="dash_contact_moreAct" id="moreAct" onclick="sE(event);moreAction(this,event)"></span>    \t\t</span>    \t\t<div id="actionMenu" data-zcqa="actionMenu" class="ddM">    \t\t<ul>')}if(l=l>e.length?e.length:l,s)for(;r<l;r++)a+=s.fn(e[r]);return a})),Handlebars.registerHelper("getEndIndex",getEndIndex),Handlebars.registerHelper("I18nDynamicKey",(function(){for(var e=[],t=2;t<arguments.length;t++){var i=arguments[t];null!=Crm.moduleInfo[i]?arguments[t]=Crm.moduleInfo[i].translatedPluralLabel:null!=i.data&&(arguments[t]=arguments[t].data.root.module),e.push(arguments[t])}return I18n.getMsg(arguments[0]+arguments[1],e)})),Handlebars.registerHelper("checkDateString",(function(e,t,i,s){return checkDateString(t,e,i)+s.fn(this)})),crmListView.displayTags=function(e,t,i){for(var s="<ul class='listview_taglists "+(i=i||"w240")+" m0 p0 dIB'>",a=e.length,r=0;r<a;r++){var l=e[r].lastIndexOf("#"),o=e[r],n=o.substring(0,l);""===n&&(n=o.replace("null",""));var c=o.substring(l);if(customViewObject.isKanbanView)if(r<2)s+="<li class='tagElementList crm-small-font-size dIB vaM cxAddedTags' style='background-color:"+c+";color:"+getPickListFontColor(c)+"'><span>"+$ESAPI.encoder().encodeForHTML(n)+"</span></li>";else{var d=a-2,m=a-d;if(r===m||r>m)if(s+="<li class='tagElementList crm-small-font-size dIB vaM cxAddedTags hiddenTag'  style='background-color:"+c+";color:"+getPickListFontColor(c)+"'><span>"+$ESAPI.encoder().encodeForHTML(n)+"</span></li>",r===m)s+='<li class="moreTagOption dIB p0 mB7 mR3 crm-base-font-size crmParagraphColor vaM">'+('<span class="eventNone" onclick="sE(event);">'+I18n.getMsg("and")+" </span>")+('<span class="moreCount cP" onclick="sE(event);crmListView.showTags(this);">'+parseInt(d)+" "+I18n.getMsg("crm.label.More")+"</span>")+"</li>"}else s+="<li class='tagElementList crm-small-font-size dIB vaM cxAddedTags' style='background-color:"+c+";color:"+getPickListFontColor(c)+"'><span>"+$ESAPI.encoder().encodeForHTML(n)+"</span></li>"}return s+"</ul>"},Handlebars.registerHelper("isHiddenModule",(function(e,t){return e?moduleRecordMapping.hasOwnProperty(e)&&4&moduleRecordMapping[e].visibility||"Forecasts"==e||"Notes"==e||"Emails"==e?"":'data-cid="detailView"  data-params=\'{"id":"'+$ESAPI.encoder().encodeForHTML(t)+'","module":"'+$ESAPI.encoder().encodeForHTML(e)+"\"}'":""})),Handlebars.registerHelper("isVisibleModule",(function(e,t,i,s){if(s){var a=getPLStyleObj(s);return"<span data-zcqa='colorcode_span_"+$ESAPI.encoder().encodeForHTML(t+"")+"_"+$ESAPI.encoder().encodeForHTML(i+"")+"' class='colorAppliedPicklist' style='"+a+"'>"+$ESAPI.encoder().encodeForHTML(t+"")+"</span>"}if(!e||moduleRecordMapping.hasOwnProperty(e)&&4&moduleRecordMapping[e].visibility)return $ESAPI.encoder().encodeForHTML(t+"");if("Events"!=e&&"Tasks"!=e&&"Calls"!=e||Crm.isActivitySplitDone){if("Forecasts"===e&&newForecastsEnabled)return'<link-to lt-prop-route="crm.tab.newForecasts.view" lt-prop-dp=\'["'+$ESAPI.encoder().encodeForHTML(i)+'"]\' lt-prop-class="crmParagraphColor crm-base-font-size crm-font-bold">'+$ESAPI.encoder().encodeForHTML(t)+"</link-to>";var r="crm.tab.module.entity";return e&&void 0!==moduleRecordMapping[e]&&"team_based"===moduleRecordMapping[e].access_type&&"Requesters"===moduleRecordMapping[e].private_profile.name&&(r="crm.tab.requesters.module.index-module.entity.detail"),'<crux-lookup-component cx-prop-from="view" id="territorytooltip" cx-prop-value="'+$ESAPI.encoder().encodeForHTMLAttribute(t)+'" cx-prop-route-name="'+r+'" cx-prop-dynamic-params=\'["'+$ESAPI.encoder().encodeForHTMLAttribute(e)+'", "'+$ESAPI.encoder().encodeForHTMLAttribute(i)+"\"]' />"}return'<link-to lt-prop-route="crm.tab.module.entity" lt-prop-dp=\'["Activities","'+$ESAPI.encoder().encodeForHTML(i)+'"]\' lt-prop-qp =\'{"sub_module" : "'+$ESAPI.encoder().encodeForHTML(e)+'"}\' lt-prop-class="crmParagraphColor crm-base-font-size crm-font-bold">'+$ESAPI.encoder().encodeForHTML(t)+"</link-to>"})),Handlebars.registerHelper("checkString",(function(e,t,i,s,a,r,l,o,n,c,d){if(r&&moduleRecordMapping.hasOwnProperty(r)&&4&moduleRecordMapping[r].visibility)return"object"==typeof e?e.DISPLAYLABEL:e;var m="listView_reports"===o;(null==o||m)&&(o="listView");var u=m;if(m=m&&("Forecasts"===r||"Notes"===r||"Emails"===r),customViewObject&&!r&&(recordNum=s.index,t=customViewObject.heading,a=customViewObject.cvId,r=customViewObject.module),a||(a=null),"Contact Roles"==r?r="Contacts":"Invited Events"==r&&(r="Activities"),"Member Status"==t[i].COLUMNALIAS&&null!=s.REMARKS)return"<span style='cursor: pointer' onmouseout='renderingUtils.zctt.hidett();' onmouseover='renderingUtils.zctt.showtt( \""+s.REMARKS+"\")'>"+d.fn(this)+"</span>";if("PHOTO_FILEID"==t[i].COLUMNNAME&&""!=e){var p=Crm.getCrmBasePath()+"/EntityImageAttach.do?action_module="+r+"&entityId="+s.ENTITYID+"&actionName=readImage&fileId="+e;return p=networkUtils.getPortalURL(p),"<div id = 'imgContainer' class='emptyAccLogo'><img id="+r+"_"+s.ENTITYID+"_photo src="+p+" class='dvPhotoShadow'/></div>"}if("CONTACTID"===t[i].COLUMNNAME&&("homePage"===o||"customHomepage"===o)&&""!==e&&CrmDashboard.needToLoadContactImage){var f=e.ENTITYID,v=$("<div>").attr("class","Image_Container").attr("style","width:22px;height:22px;float:left");if(v.append($("<img>").attr("class","Image_"+f).attr("onerror","this.onerror=null;this.src="+networkUtils.getImageUrl("nophoto.png",ResourceConstants.CRM))),v=v.prop("outerHTML"),void 0===(N=this.MODULE))return"";var g=this.MODULE.toLowerCase(),h="Crm_Implied_View_"+N;crmListView.changedPermissionsForZBModules.hasOwnProperty(h)&&(h=crmListView.changedPermissionsForZBModules[h]),h=Crm.userDetails.permissions[h],N=N.slice(0,N.lastIndexOf("s"));var w="<crux-lookup-component ";if(h>-1)"Tasks"===this.MODULE||"Calls"===this.MODULE||"Events"===this.MODULE?w+='cx-prop-id="'+o+"_"+this.ENTITYID+'" cx-prop-class="vaM" class="wrapLyteTextWrapperClass pL7" cx-prop-value="'+d.fn(this.DISPLAYLABEL)+'" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params=\'["Activities","'+this.ENTITYID+'"]\' cx-prop-query-params=\'{"sub_module":"'+this.MODULE+'"}\' cx-prop-transition-data=\'{"relContactId":"'+(s.relContactId?s.relContactId:null)+'","module":"'+this.MODULE+'","id":"'+this.ENTITYID+'","lookback":"true","fromActivityListView":"true"}\' onmouseover="showRelatedFields_new(\''+this.MODULE+"','"+this.ENTITYID+'\',this)" onmouseout="hideLoadingDiv();" cx-prop-zcqa="detailView">':w+='cx-prop-id="'+o+"_"+this.ENTITYID+'" cx-prop-class="vaM" class="wrapLyteTextWrapperClass pL7" cx-prop-value="'+d.fn(this.DISPLAYLABEL)+'" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params=\'["'+this.MODULE+'","'+this.ENTITYID+'"]\' cx-prop-transition-data=\'{"relContactId":"'+(s.relContactId?s.relContactId:null)+'","module":"'+this.MODULE+'","id":"'+this.ENTITYID+'","lookback":"true","fromActivityListView":"true"}\' onmouseover="showRelatedFields_new(\''+this.MODULE+"','"+this.ENTITYID+'\',this)" onmouseout="hideLoadingDiv();" cx-prop-zcqa="detailView">';else{w="<a href='"+Crm.getCrmBasePath()+"/EntityInfo.do?module="+this.MODULE+"&id="+this.ENTITYID+'\' style="padding-left:7px"  title="permission denied" >';var C=!0}return"CONTACTID"!==t[i].COLUMNNAME&&(g.includes("custommodule")&&(g="custom"),w+='<div class=\'dIB vaM crmListVwRelLiIcon\'><crmutil-icon non-lyte="true"  icon-name="'+g+'" icon-class="zcicn-'+g+' crmBaseIcon zcicn_embedSvg crmBaseIcon size_m mR5" ></crmutil-icon></div>'),C?(w+=d.fn(this.DISPLAYLABEL),w+="</a>"):w+="</crux-lookup-component>",v+w}if("CALLDURATION"==t[i].COLUMNNAME&&":00"==e)e="";else{if("BOUNCE_REASON"===t[i].COLUMNNAME)return V='<span class="lvBounceMsg vaM dIB">'+e+' <i id="bounceicon" onmouseenter="showBounceMsgTooltip(this)"  class="svgIconsImg svgErrorIcon mL3 fR mT3"></i></span>';if(t[i].UITYPE==CrmField.UITYPES.SERVICE_DURATION){var b=detailView.converMinToHourAndMin(parseInt(e));return b.length>1?detailView.constructDurationTxt(b[0],b[1]):""}if("object"!=typeof e&&void 0!==t){if(void 0===t[i])return;if(25==t[i].UITYPE)return V='<a data-cid="dummy" class="crmLinkColor cP" href="mailto:'+d.fn(this)+'">'+d.fn(this)+"</a>";if(21==t[i].UITYPE){var V="",I="http";return""===e||0!=e.indexOf(I)&&0!=e.indexOf("https")?""!=e&&(V='<a data-cid="dummy" class="crmLinkColor cP" href="http://'+d.fn(this)+'" target="_blank">'+d.fn(this)+"</a>"):V='<a data-cid="dummy" class="crmLinkColor cP" href="'+d.fn(this)+'" target="_blank">'+d.fn(this)+"</a>",V}if(301==t[i].UITYPE||300==t[i].UITYPE||116==t[i].UITYPE&&"boolean"==t[i].RETURNTYPE){V="";return!0===e||"true"==e?(V='<span class="yes"></span>',customViewObject.isStageView&&(V+='<span class="dIB pL5">'+t[i].FIELDLABEL+"</span>")):(V='<span class="no-new"></span>',customViewObject.isStageView&&(V="")),V}if(100==t[i].UITYPE){V=d.fn(this);return""!=e&&(V=V.replace(/;/g,"; ")),V}if(22==t[i].UITYPE){V="";if(""!=e){var O=d.fn(this);V='<a data-cid="dummy" data-zcqa="dummy" class="link" href="'+RebrandLinkUtil.getProperty("TW_URL")+"/"+$ESAPI.encoder().encodeForURL(O)+'" target="_blank" id="subvalue_Twitter">'+$ESAPI.encoder().encodeForHTML(O)+"</a>"}return V}if(38==t[i].UITYPE)return"TIMESPENT"==t[i].COLUMNNAME||"AVERAGETIMESPENT"==t[i].COLUMNNAME?Utils.convertTimeInDoubleToReadableForm(d.fn(this)):isNaN(parseFloat(d.fn(this)))?"":!0===t[i].separator?d.fn(this):parseFloat(d.fn(this));if(33==t[i].UITYPE){if(""==e)return d.fn(this);if(!1===s.ISCALLALLOWED||t[i].donotshow)return"<div class='phoneRtl' style='min-width:100%'>"+d.fn(this)+"</div>";if(customViewObject&&1==customViewObject.outbound||d&&d.data&&d.data.root&&!0===d.data.root.outbound){customViewObject.ctiprotocol&&(customViewObject.ctiprotocol,d.fn(this));return"<div class='phoneRtl' style='min-width:100%'>"+d.fn(this)+"<a href='javascript:;' class='calliconOuter fN' onmouseover='CTIAPI.showCallButtonlabel(this)' onmouseout=\"CTIAPI.hideCallButtonlabel(this)\" onclick=\"sE();ctiApiNotifier.click2Call('"+$ESAPI.encoder().encodeForJavaScript(this)+"','"+Crm.userDetails.ZGID+"','"+Crm.userDetails.USER_ID+"','"+s.ENTITYID+"','','"+r+"','"+$ESAPI.encoder().encodeForJavaScript(s.ENTITYNAME)+"','"+t[i].COLUMNNAME+"')\"><i class='callIcon'></i><span id='calllabel1'>"+I18n.getMsg("Call")+"</span></a></div>"}if(Crm.userDetails.ZPBENABLED){var _='asyncFn(crmCallsNew.getClick2CallPromise,"'+s.ENTITYID+'","'+r+'","'+$ESAPI.encoder().encodeForJavaScript(s.ENTITYNAME)+'","","'+d.fn(this)+'","'+t[i].COLUMNNAME+'")';return"<div class='phoneRtl pR pR20'><span class='dIB vaM'>"+d.fn(this)+"</span><span class='phoneIcon_lv m0'><zpb-phone number='"+d.fn(this)+"' module='"+r+"' recordid='"+s.ENTITYID+"' callbackparamfn='"+_+"'></zpb-phone></span></div>"}return"<div onmouseover='editmouseover(this, \"phone\");' onmouseout='editmouseout(this, \"phone\");' class='phoneRtl dIB'>"+d.fn(this)+"<a style='visibility:hidden;' class='pH2 phoneRtl' title='"+I18n.getMsg("crm.phoneNo.Link.Title")+"' href='skype:"+d.fn(this)+"?call' onclick='sE();'></a></div>"}if(200!=t[i].UITYPE&&786!=t[i].UITYPE&&14!=t[i].UITYPE&&24!=t[i].UITYPE&&202!=t[i].UITYPE&&333!=t[i].UITYPE&&(116!=t[i].UITYPE||"datetime"!=t[i].RETURNTYPE&&"date"!=t[i].RETURNTYPE)||"en_US"!=Crm.userDetails.COUNTRY_LOCALE&&"en_GB"!=Crm.userDetails.COUNTRY_LOCALE){if(209==t[i].UITYPE&&e&&e.length>0)return crmListView.displayTags(e.split(","));if(3==t[i].UITYPE||110==t[i].UITYPE)return l&&"DESCRIPTION"===t[i].COLUMNNAME?crmListView.toggleText(!0,!1,void 0,e):"<pre style='word-wrap: break-word; white-space:pre-wrap;'> "+d.fn(this)+"</pre>";if(32===t[i].UITYPE||52===t[i].UITYPE||117===t[i].UITYPE)return e;if(2===t[i].UITYPE||26===t[i].UITYPE){if(t[i].colorcode_enabled&&!0===t[i].colorcode_enabled&&e&&""!==e.trim()&&"-None-"!==e){var T=getPicklistStyleObj(e,t[i].picklistmap);return"<span data-zcqa='colorcode_span_"+s.ENTITYID+"_"+t[i].FIELDID+"' class='colorAppliedPicklist' style='"+T+"'>"+d.fn(this)+"</span>"}return d.fn(this)}if(!m&&(0===r.indexOf("CustomModule")&&"NAME"===t[i].COLUMNNAME||6===Crm.moduleInfo[r].genType&&"NAME"===t[i].COLUMNNAME||t[i].COLUMNNAME===crmConstants.listViewMandatoryColumns[r]||"FULLNAME"===t[i].COLUMNNAME)){var L=s.relContactId?s.relContactId:null;h="Crm_Implied_View_"+r;crmListView.changedPermissionsForZBModules.hasOwnProperty(h)&&(h=crmListView.changedPermissionsForZBModules[h]),h=Crm.userDetails.permissions[h];V="<a ",w="<crux-lookup-component ";if("object"==typeof CrmTracking)CrmTracking.isEntityOnline(r,s.ENTITYID)&&(V="<span data-id='online-entity-"+s.ENTITYID+"-lview' class='online-entity vaT'></span><a ",w="<span data-id='online-entity-"+s.ENTITYID+"-lview' class='online-entity left5 vaT'></span><crux-lookup-component ");if(h>-1?w+="mLookup"==o?"Activities"===r?'cx-prop-target="_blank" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params=\'["Activities","'+s.ENTITYID+'"]\' cx-prop-query-params=\'{"sub_module":"'+s.MODULE+"\"}'":'cx-prop-target="_blank" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params=\'["'+s.MODULE+'","'+s.ENTITYID+"\"]' ":"Activities"===r?' cx-prop-zcqa="detailView" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params=\'["Activities","'+s.ENTITYID+'"]\' cx-prop-query-params=\'{"sub_module":"'+s.MODULE+"\"}'":' cx-prop-zcqa="detailView" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params=\'["'+s.MODULE+'","'+s.ENTITYID+"\"]' ":V+="href='"+Crm.getCrmBasePath()+"/EntityInfo.do?module="+s.MODULE+"&id="+s.ENTITYID+'\' title="permission denied" onclick="crmListView.onLinkClick(\''+s.MODULE+"','"+s.ENTITYID+"',event)\"",V+='id="'+o+"_"+s.ENTITYID+'" data-params=\'{"relContactId":"'+L+'","module":"'+s.MODULE+'","id":"'+s.ENTITYID+'","cvid":"'+a+'","recordNum":"'+recordNum+'","lookback":"true"',w+='cx-prop-id="'+o+"_"+s.ENTITYID+'" cx-prop-transition-data=\'{"relContactId":"'+L+'","module":"'+s.MODULE+'","id":"'+s.ENTITYID+'","cvid":"'+a+'","recordNum":"'+recordNum+'","lookback":"true"',"Activities"!==r&&"Tasks"!==r&&"Calls"!==r&&"Events"!==r||u)l&&(V+=',"stageId":"'+l+'"',w+=',"stageId":"'+l+'"');else if("Activities"===r?(V+=',"fromActivityListView":"true"',w+=',"fromActivityListView":"true"'):(V+=',"fromActSubModuleListView":"true"',w+=',"fromActSubModuleListView":"true"'),c){var y=parseInt((parseInt(recordNum)-1)/c)*c+1,E=y+c-1;V+=',"FROM_INDEX":"'+y+'","TO_INDEX":"'+E+'"',w+=',"FROM_INDEX":"'+y+'","TO_INDEX":"'+E+'"'}return"homePage"!=o&&"customHomepage"!=o||!n||(V+=', "layoutId" : "'+n+'"',w+=', "layoutId" : "'+n+'"'),"customHomepage"==o&&(V+=', "toolTip" : "'+I18n.getMsg("crm.custom.home.tooltip")+'"',w+=', "toolTip" : "'+I18n.getMsg("crm.custom.home.tooltip")+'"'),V+='}\' class="crmLinkColor cP">'+d.fn(this)+"</a>",w+='}\' class="wrapLyteTextWrapperClass" cx-prop-class="crmLinkColor cP accessibility-route-elem" cx-prop-value="'+d.fn(this)+'"></crux-lookup-component>',"Activities"!==r&&"Calls"!==r||"homePage"!=o&&"customHomepage"!=o||"Calls"!=s.MODULE||"Scheduled"!=s.callStatus&&"Overdue"!=s.callStatus||(V+="<span id='homePageMore_"+s.ENTITYID+"' class='rep_runbtn vH' data-zcqa='callMoreOption' onclick=\" Crm.scheduledCallMoreOption(this, 'homePage',"+s.OWNERID+",'"+n+'\'); sE1(event);"><i class="sort_desc svgIconsImg"></i></span>',w+="<span id='homePageMore_"+s.ENTITYID+"' class='rep_runbtn vH' data-zcqa='callMoreOption' onclick=\" Crm.scheduledCallMoreOption(this, 'homePage',"+s.OWNERID+",'"+n+'\'); sE1(event);"><i class="sort_desc svgIconsImg"></i></span>'),w}if("Mailing Street"===t[i].FIELDLABEL||"Billing Street"===t[i].FIELDLABEL||"Street"===t[i].FIELDLABEL){var S=d.fn(this).split("~~~"),M=void 0===S[0]||""===S[0]||"null"===S[0]?"&nbsp;":S[0],k=S[1];return V=null!=k&&""!==k&&"null"!==k?'<div class="fromAddress" onmouseenter="newshowtt(\''+k+'\')"  onmouseout="newhidett()">'+M+"</div>":'<div class="fromAddress">'+M+"</div>"}if("Campaigns"==r){if("TYPE"===t[i].COLUMNNAME&&[1,2,3].contains(s.CAMPAIGN_TYPE))return V='<div class="strong">'+d.fn(this)+'<span class="svgIconsImg camTypeDetIcon mL15 cP" onmouseenter="crmui.showTooltip({content: \'View Stats\',isHTML: false,position: \'showOnRight\'});" onmouseleave="crmui.hideTooltip();" data-cid="campTypeOnClick" data-params=\'{"campaignId":"'+s.ENTITYID+"\"}'></span></div>"}else if(l&&"CLOSINGDATE"===t[i].COLUMNNAME){var A;if(!(A=new CrmDate(CrmDateUtils.getDateObjectFromString(e,Crm.userDetails.DATE_PATTERN.toUpperCase()))).isToday()&&!A.isFutureTime())return"<span class='d_overDue'>"+d.fn(this)+"</span>"}return d.fn(this)}return!l||"CLOSINGDATE"!==t[i].COLUMNNAME||(A=new CrmDate(CrmDateUtils.getDateObjectFromString(e,Crm.userDetails.DATE_PATTERN.toUpperCase()))).isToday()||A.isFutureTime()?"<span class='crm-base-font-size'>"+d.fn(this)+"</span>":"<span class='d_overDue'>"+d.fn(this)+"</span>"}if(void 0!==t[i]){if(4==t[i].UITYPE&&("Calls"==s.MODULE||"Tasks"==s.MODULE||"Events"==s.MODULE)){var N;if(null==(N=this.MODULE))return"";g=this.MODULE.toLowerCase(),h="Crm_Implied_View_"+N;crmListView.changedPermissionsForZBModules.hasOwnProperty(h)&&(h=crmListView.changedPermissionsForZBModules[h]),h=Crm.userDetails.permissions[h],N=N.slice(0,N.lastIndexOf("s"));w="<link-to ";if(h>-1)"mLookup"==o?w+='lt-prop-target="_blank" lt-prop-td=\'{"relContactId":"'+(s.relContactId?s.relContactId:null)+'","module":"'+this.MODULE+'","id":"'+this.ENTITYID+'","lookback":"true",,"fromActivityListView":"true"}\' lt-prop-route="crm.tab.module.entity" lt-prop-dp=\'["'+this.MODULE+'","'+this.ENTITYID+'"]\' onclick=\'Lyte.registeredMixins["crm-view-utils"].checkAndRenderPublicFields("'+this.MODULE+'","'+this.ENTITYID+'",event);\' lt-prop-id="'+o+"_"+this.ENTITYID+'" lt-prop-class="crmLinkColor cP accessibility-route-elem">':"Tasks"==this.MODULE||"Calls"==this.MODULE||"Events"==this.MODULE?w+='lt-prop-id="'+o+"_"+this.ENTITYID+'" lt-prop-class="crmLinkColor cP accessibility-route-elem" lt-prop-route="crm.tab.module.entity.detail" lt-prop-dp=\'["Activities","'+this.ENTITYID+'"]\' lt-prop-qp=\'{"sub_module":"'+this.MODULE+'"}\' lt-prop-td=\'{"relContactId":"'+(s.relContactId?s.relContactId:null)+'","module":"'+this.MODULE+'","id":"'+this.ENTITYID+'","lookback":"true","fromActivityListView":"true"}\' onmouseover="showRelatedFields_new(\''+this.MODULE+"','"+this.ENTITYID+'\',this)" onmouseout="hideLoadingDiv();" data-zcqa="detailView">':w+='lt-prop-id="'+o+"_"+this.ENTITYID+'" lt-prop-class="crmLinkColor cP accessibility-route-elem" lt-prop-route="crm.tab.module.entity" lt-prop-dp=\'["'+this.MODULE+'","'+this.ENTITYID+'"]\' onclick=\'Lyte.registeredMixins["crm-view-utils"].checkAndRenderPublicFields("'+this.MODULE+'","'+this.ENTITYID+'",event);\' lt-prop-td=\'{"relContactId":"'+(s.relContactId?s.relContactId:null)+'","module":"'+this.MODULE+'","id":"'+this.ENTITYID+'","lookback":"true","fromActivityListView":"true"}\' onmouseover="showRelatedFields_new(\''+this.MODULE+"','"+this.ENTITYID+'\',this)" onmouseout="hideLoadingDiv();" data-zcqa="detailView">';else{w="<a href='"+Crm.getCrmBasePath()+"/EntityInfo.do?module="+this.MODULE+"&id="+this.ENTITYID+'\' title="permission denied" onclick="crmListView.onLinkClick(\''+this.MODULE+"','"+this.ENTITYID+"',event)\">";C=!0}return"CONTACTID"!=t[i].COLUMNNAME&&(g.includes("custommodule")&&(g="custom"),w+='<div class=\'dIB vaM crmListVwRelLiIcon\'><crmutil-icon non-lyte="true" icon-name="'+g+'" icon-class="zcicn-'+g+' zcicn_embedSvg crmBaseIcon size_m mR5" ></crmutil-icon></div>'),w+=d.fn(this.DISPLAYLABEL),w+=C?"</a>":"</link-to>"}if("User"===e.MODULE||"Users"===e.MODULE||"Modules"===e.MODULE)return V='<span class="lv_data_user ellipsistext vaM dIB maxW100per" data-params=\'{"userId":"'+e.ENTITYID+"\"}'>"+d.fn(this.DISPLAYLABEL)+"</span>";if("OrchestrationState"===e.MODULE)return V='<span class="ellipsistext vaM dIB">'+d.fn(this.DISPLAYLABEL)+"</span>";if("BEST_TIME"===t[i].COLUMNNAME)return crmBstTime.getListViewString(e);if(!m){h="Crm_Implied_View_"+r;crmListView.changedPermissionsForZBModules.hasOwnProperty(h)&&(h=crmListView.changedPermissionsForZBModules[h]);V="<a ",w="<link-to ";var D=!1;return(h=Crm.userDetails.permissions[h])>-1?"mLookup"==o?w+='lt-prop-target="_blank" lt-prop-td=\'{"relContactId":"null","module":"'+e.MODULE+'","id":"'+e.ENTITYID+'","lookback":"true"}\' lt-prop-route="crm.tab.module.entity" lt-prop-dp=\'["'+e.MODULE+'","'+e.ENTITYID+'"]\' onclick=\'Lyte.registeredMixins["crm-view-utils"].checkAndRenderPublicFields("'+e.MODULE+'","'+e.ENTITYID+'",event);\' lt-prop-id="'+o+"_"+e.ENTITYID+'" lt-prop-class="crmLinkColor cP accessibility-route-elem">':"customHomepage"===o?w+='lt-prop-id="'+o+"_"+this.ENTITYID+'" lt-prop-class="crmLinkColor cP accessibility-route-elem" lt-prop-route="crm.tab.module.entity" lt-prop-dp=\'["'+e.MODULE+'","'+e.ENTITYID+'"]\' onclick=\'Lyte.registeredMixins["crm-view-utils"].checkAndRenderPublicFields("'+e.MODULE+'","'+e.ENTITYID+'",event);\' lt-prop-td=\'{"relContactId":"null","module":"'+e.MODULE+'","id":"'+e.ENTITYID+'","lookback":"true", "toolTip" : "'+I18n.getMsg("crm.custom.home.tooltip")+'" }\' data-zcqa="detailView">':"Orchestration"==e.MODULE?w+='lt-prop-target="_blank" lt-prop-class="crmLinkColor cP accessibility-route-elem" onclick="event.stopPropagation();" lt-prop-route="crm.settings.section.orchestration.edit-orchestration"  lt-prop-dp=\'["'+this.ENTITYID+"\"]'>":"Tasks"==e.MODULE||"Calls"==e.MODULE||"Events"==e.MODULE?w+='lt-prop-id="'+o+"_"+this.ENTITYID+'" lt-prop-class="crmLinkColor cP accessibility-route-elem" lt-prop-route="crm.tab.module.entity.detail" lt-prop-dp=\'["Activities","'+e.ENTITYID+'"]\' lt-prop-qp=\'{"sub_module":"'+e.MODULE+'"}\' lt-prop-td=\'{"relContactId":"null","module":"'+e.MODULE+'","id":"'+e.ENTITYID+'","lookback":"true", "toolTip" : "'+I18n.getMsg("crm.custom.home.tooltip")+'"}\' data-zcqa="detailView">':moduleRecordMapping.CalendarBookings&&e.MODULE===moduleRecordMapping.CalendarBookings.module_name?w+='lt-prop-id="'+o+"_"+this.ENTITYID+'"lt-prop-class="cP link"lt-prop-route="crm.settings.section.calendar-booking.view-calendar-booking"lt-prop-dp=\'["'+e.ENTITYID+'"]\'lt-prop-qp=\'{"module":"'+moduleApiMapping.Appointments+'" }\'data-zcqa="detailView">':(w='<a class="crmLinkColor cP accessibility-route-elem" href="'+Crm.getCrmBasePath()+"/tab/"+e.MODULE+"/"+e.ENTITYID+'">',D=!0):V+=" href='"+Crm.getCrmBasePath()+"/EntityInfo.do?module="+e.MODULE+"&id="+e.ENTITYID+'\' title="Permission denied" onclick="crmListView.onLinkClick(\''+e.MODULE+"','"+e.ENTITYID+'\',event)" id="'+o+"_"+e.ENTITYID+'" class="crmLinkColor cP">',V+=d.fn(this.DISPLAYLABEL)+"</a>",w+=D?"<span onclick=\"crmListView.onLinkClick('"+e.MODULE+"','"+e.ENTITYID+"',event)\">"+d.fn(this.DISPLAYLABEL)+"</span></a>":d.fn(this.DISPLAYLABEL)+"</link-to>"}}}})),Handlebars.registerHelper("getSpacerImg",(function(){return Search.spacerImg})),Handlebars.registerHelper("isAlphaSearchSupported",(function(e,t){return e.alphaDetails?t.fn(this):"en_US"!==Crm.userDetails.RELEVANT_LOCALE&&"en_GB"!==Crm.userDetails.RELEVANT_LOCALE||"Zoho"!==customViewObject.brandName?t.inverse(this):(e.alphaDetails=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],t.fn(this))})),Handlebars.registerHelper("deleteObj",(function(e){void 0!==customViewObject&&delete customViewObject[e]})),Handlebars.registerHelper("addObj",(function(e,t){customViewObject[e]=t})),Handlebars.registerHelper("CrmUserDetailsRTL_ENABLED",(function(){return Crm.userDetails.RTL_ENABLED?"left":"right"})),Handlebars.registerHelper("addOptions",(function(e){e.optionList||(e.optionList=["10","20","30","40","50"],Crm.userDetails.ISPAID_USER&&e.optionList.push("100"),500===e.maxRange&&e.optionList.push("500"))})),Handlebars.registerHelper("addSearchLimits",(function(e){e.searchList||(e.searchList=[{"${AGEINMONTHS6}":"Past 6 months"},{"${AGEINMONTHS12}":"Past year"},{all:"Any time"}])})),Handlebars.registerHelper("isKanbanView",(function(){var e=crmListView.getObject();return!!e&&e.isKanbanView})),Handlebars.registerHelper("objPresentAtIndex",(function(e,t,i){return e&&e[t]?i.fn(this):i.inverse(this)})),Handlebars.registerHelper("showSelectAll",(function(e,t,i,s){return 1!=t||e&&e[i]?s.fn(this):s.inverse(this)})),Handlebars.registerHelper("indexOf",(function(e,t,i,s){return e.indexOf(t)==i?s.fn(this):s.inverse(this)})),Handlebars.registerHelper("checkStringForPrintPreview",(function(e,t,i,s){var a=i[t].FIELDLABEL;if("BEST_TIME"===i[t].COLUMNNAME)return"";var r=i[t].UITYPE;if(301==r||300==r||116==r&&"boolean"==i[t].RETURNTYPE)return 1==e||"true"==e?'<img src="'+Search.yesImg+'" class="yes">':'<img src="'+Search.spacerImg+'" class="no-new" width="9" height="9">';if(100==r){var l=s.fn(this);return""!=e&&(l=l.replace(/;/g,"; ")),l}if(80===r)return Handlebars.helpers.setServiceDuration(e);if(38==i[t].UITYPE){var o=parseFloat(s.fn(this));return isNaN(o)?"":!0===i[t].separator?s.fn(this):o}return 200!=r&&786!=r&&14!=r&&24!=r&&202!=r&&333!=r||"en_US"!=Crm.userDetails.COUNTRY_LOCALE&&"en_GB"!=Crm.userDetails.COUNTRY_LOCALE?"object"==typeof e?s.fn(this.DISPLAYLABEL):"Mailing Street"===a||"Billing Street"===a||"Street"===a?void 0!==s.fn(this)?s.fn(this).split("~~~")[0]:s.fn(this):32!==i[t].UITYPE&&52!==i[t].UITYPE||!0!==i[t].separator?s.fn(this):e:"<span class='crm-base-font-size'>"+s.fn(this)+"</span>"})),Handlebars.registerHelper("safestring",(function(e){return new Handlebars.SafeString(e)})),Handlebars.registerHelper("objSizeGreaterThan",(function(e,t,i){return objectUtils.getLength(e)>t?i.fn(this):i.inverse(this)})),Handlebars.registerHelper("getStaticCssPath",(function(e){var t=FingerPrint.basePathUrl+ResourceConstants.CSS+"/";if(FingerPrint.isCdnEnabled){var i=commonUtils.getfingerPrintProperties(e);return networkUtils.getCdnUrl("CRM")+t+i}return t+e})),Handlebars.registerHelper("getHelpUrl",(function(e){return crmConstants.helpUrl["help.domain.url"]+crmConstants.helpUrl[e]})),Handlebars.registerHelper("crmConstants",(function(e){return crmConstants[e]})),Handlebars.registerHelper("checkPermission",(function(e,t,i){return""!=t&&(Crm.splittedPermission&&Crm.splittedPermission.hasOwnProperty(e)&&"team_based"===moduleRecordMapping[t].access_type?e=Crm.splittedPermission[e]+t:Crm.splittedPermission.hasOwnProperty(e)||(e=e+"_"+t)),crmListView.changedPermissionsForZBModules.hasOwnProperty(e)&&(e=crmListView.changedPermissionsForZBModules[e]),1==Crm.userDetails.permissions[e]?i.fn(this):i.inverse(this)})),Handlebars.registerHelper("checkActivityAuthorization",(function(e){return customViewObject.isActivitiesAuthorized?e.fn(this):e.inverse(this)})),Handlebars.registerHelper("canShowActivity",(function(e){return crmListView.isSmartFilterSupportedModule(customViewObject.module)?e.fn(this):e.inverse(this)})),Handlebars.registerHelper("canCreateActivity",(function(e){return!customViewObject.isActivitiesAuthorized||-1!==["Solutions","PriceBooks","Vendors","Services","Appointments"].indexOf(customViewObject.module)||"Activities"===Crm.activityGrp[customViewObject.module]||customViewObject.cvName&&customViewObject.cvName.indexOf("CONVERTEDVIEWS")>-1?e.inverse(this):e.fn(this)})),Handlebars.registerHelper("isEdit",(function(e,t,i,s){var a=Crm.userDetails.permissions.Crm_Implied_Manage_CustomViews;return"Edit"===t&&e&&-1!=e.indexOf("CONVERTEDVIEWS")||!a||"mLookup"==i?s.inverse(this):s.fn(this)})),Handlebars.registerHelper("showEntity",(function(e,t,i,s,a){for(var r="",l=t-1;l<i&&(null!=e&&null!=e[l]);l++)recordNum=l+parseInt(s),r+=a.fn(e[l]);return r})),Handlebars.registerHelper("showEntityRL",(function(e,t){for(var i="",s=0;s<10&&(null!=e&&null!=e[s]);s++)recordNum=s+1,i+=t.fn(e[s]);return i})),Handlebars.registerHelper("getLengthOfHeading",(function(e,t){t.length=e?e.length+1:0})),Handlebars.registerHelper("recordNum",(function(){return recordNum})),Handlebars.registerHelper("objSizeEqualTo",(function(e,t,i){return e&&e.length==t?i.fn(this):i.inverse(this)})),Handlebars.registerHelper("escape",(function(e){return $ESAPI.encoder().encodeForJavaScript(unescape(e))})),Handlebars.registerHelper("setLengthOfSelectedIds",(function(e){customViewObject.lengthOfSelectedIds=e?e.length:0})),Handlebars.registerHelper("loop",(function(e,t,i,s){var a="";t=parseInt(t);for(var r=e;r<=t;r++)i.index1=r,a+=s.fn(this);return a})),Handlebars.registerHelper("getSearchField",(function(e,t){return e["displaySearchField"+t]}));var dateTemp=["${TODAY}","${TOMORROW}","${TOMORROWPLUS}","${YESTERDAY}","${YESTERDAYMINUS}","${LASTMONTH}","${THISMONTH}","${NEXTMONTH}","${LASTWEEK}","${THISWEEK}","${NEXTWEEK}"];function changeRight(e){for(var t=document.getElementById("SearchStringUL").getElementsByTagName("li"),i=0;i<t.length;i++)t[i].className="";document.getElementById("searchField").value=e}function showHideWarningDivs(){var e=document.allMailMergeForm;null!=e.openfilein&&e.openfilein[1].checked?($("#currentLimitDiv").length>0&&$("#currentLimitDiv").css("display","block"),$("#alertWaringdDiv").length>0&&$("#alertWaringdDiv").css("display","block"),$("#alertMsgDiv").length>0&&$("#alertMsgDiv").css("display","block")):($("#currentLimitDiv").length>0&&$("#currentLimitDiv").css("display","none"),$("#alertWaringdDiv").length>0&&$("#alertWaringdDiv").css("display","none"),$("#alertMsgDiv").length>0&&$("#alertMsgDiv").css("display","none"))}Handlebars.registerHelper("getConditionOrSearchValue",(function(e,t,i,s){var a=e["searchfieldtype"+t];if("condition"!=i){var r=[];switch(a){case"U":"${CURRENTUSER}"!=e["searchuser"+t]&&(r=[e["temp_searchuser"+t]]);break;case"T":r=[e["searchtext"+t]];break;case"picklist":r=[e["searchpicklist"+t].replace("\\,",",")];break;case"L":r=[e["searchlayout"+t].replace("\\,",",")];break;case"tag":r=[e["searchtag"+t].replace("\\,",",")];break;case"N":r=[e["searchnum"+t]];break;case"B":r=[e["searchboolean"+t]];break;case"CML":r=[e["temp_searchcampcv"+t]];break;case"D":e["ageindayscondition"+t]?r=[e["ageindayscondition"+t],e["ageindays"+t]]:dateTemp.contains(e["searchdate"+t])||(r=[e["searchdate"+t]],"between"!=e["datecondition"+t]&&"not between"!=e["datecondition"+t]||r.push(e["searchedate"+t]));break;case"DT":e["ageindayscondition"+t]?r=[e["ageindayscondition"+t],e["ageindays"+t]]:dateTemp.contains(e["searchdatedate"+t])||(r=[e["searchdatedate"+t],e["searchstime"+t],e["searchstampm"+t]],"between"!=e["datetimecondition"+t]&&"not between"!=e["datetimecondition"+t]||(r.push(e["searchenddate"+t]),r.push(e["searchetime"+t]),r.push(e["searchetampm"+t])))}for(var l="",o=0;o<r.length;o++)l+=s.fn(r[o]);return l}switch(a){case"U":return"${CURRENTUSER}"==e["searchuser"+t]?I18n.getMsg("is")+" "+I18n.getMsg(e["usercondition"+t]):I18n.getMsg(e["usercondition"+t]);case"T":return I18n.getMsg(e["textcondition"+t]);case"picklist":return I18n.getMsg(e["textpicklistcondition"+t]);case"L":return I18n.getMsg(e["textlayoutcondition"+t]);case"tag":return I18n.getMsg(e["texttagcondition"+t]);case"N":return I18n.getMsg(e["numcondition"+t]);case"B":return I18n.getMsg(e["booleancondition"+t]);case"CML":return I18n.getMsg(e["campcvcondition"+t]);case"D":return dateTemp.contains(e["searchdate"+t])?I18n.getMsg("is")+" "+I18n.getMsg(e["datecondition"+t]):I18n.getMsg(e["datecondition"+t]);case"DT":return dateTemp.contains(e["searchdatedate"+t])?I18n.getMsg("is")+" "+I18n.getMsg(e["datetimecondition"+t]):I18n.getMsg(e["datetimecondition"+t])}})),Handlebars.registerHelper("getMatchValue",(function(e,t){return 1==t?"":I18n.getMsg(e["match"+t]).toUpperCase()})),Handlebars.registerHelper("isCurrencyField",(function(e,t,i){var s=e[t].UITYPE;if(36==s||77==s||116==s&&"currency"==e[t].RETURNTYPE)return i.fn(this)})),Handlebars.registerHelper("getClassForLVData",(function(e,t,i,s){var a="list"==s?e.ui_type:e[t].UITYPE;if(!s){if("SMOWNERID"===e[t].COLUMNNAME||"SMCREATORID"===e[t].COLUMNNAME||"MODIFIEDBY"===e[t].COLUMNNAME)return"lv_data_textfield lv_data_username";if(36===a||77===a||116===a&&"DOUBLE"===e[t].TYPE)return"lv_data_currency alignRight"}return 25===a?"lv_data_email":127===a||1===a||4===a||133===a||9===a||5===a||13===a?"lv_data_textfield":33===a||6===a||7===a||35===a||124===a||200===a?"lv_data_phone":32===a||38===a||52===a||333===a||786===a||14===a||24===a||202===a?"lv_data_number":3===a||110===a?"lv_data_desc":"lv_data_textfield"})),Handlebars.registerHelper("getDateTimeCVFilters",(function(e){var t=Search["_"+e];"T"==e&&(this.value.indexOf(":EMAIL")>-1||this.value.indexOf(":ADDN_EMAIL")>-1)&&(t=t.concat(Search._BOUNCE));for(var i=t.length,s="",a=0;a<i;a++){var r=t[a];s+=2===r.length?"<option value='"+r[0]+"'>"+r[1]+"</option>":"<option value='"+r[0]+"' selected>"+r[1]+"</option>"}return s})),Handlebars.registerHelper("leadConvertSubFilter",(function(e){var t=[{label:I18n.getMsg("crm.lead.prediction.convert.high"),value:"high"},{label:I18n.getMsg("crm.lead.prediction.convert.medium"),value:"medium"},{label:I18n.getMsg("crm.lead.prediction.convert.low"),value:"low"}];e.leadConvertAry=t})),Handlebars.registerHelper("leadSubFilterRecordFocus",(function(e){var t=[{label:I18n.getMsg("crm.intelligence.prediction.slowmoving"),value:"slowmoving"},{label:I18n.getMsg("crm.intelligence.prediction.trend.down"),value:"gonedown"}];e.leadRecordFocus=t})),Handlebars.registerHelper("getSentimentCVFilters",(function(){for(var e=[{label:I18n.getMsg("crm.sentiment.Positive"),value:"POSITIVE"},{label:I18n.getMsg("crm.sentiment.Negative"),value:"NEGATIVE"},{label:I18n.getMsg("sentiment.positiveandnegative"),value:"POSITIVE_AND_NEGATIVE"},{label:I18n.getMsg("sentiment.positiveornegative"),value:"POSITIVE_OR_NEGATIVE"},{label:I18n.getMsg("sentiment.positiveonly"),value:"POSITIVE_ONLY"},{label:I18n.getMsg("sentiment.negativeonly"),value:"NEGATIVE_ONLY"},{label:I18n.getMsg("crm.sentiment.Neutral"),value:"NEUTRAL"}],t=e.length,i="",s=0;s<t;s++){var a=e[s];i+="<option value='"+a.value+"'>"+a.label+"</option>"}return i})),Handlebars.registerHelper("setCurrentCVFilterName",(function(e){crmListView.curCVFilterName=e})),Handlebars.registerHelper("getCurrentCVFilterName",(function(){return crmListView.curCVFilterName})),Handlebars.registerHelper("removeCurrentCVFilterName",(function(){delete crmListView.curCVFilterName})),Handlebars.registerHelper("getActivityIcon",(function(e){return"Events"===e?"EventSmall":"Tasks"===e?"TaskSmall":"Calls_small"})),Handlebars.registerHelper("getDefaultFilters",(function(e,t){if(validationUtils.isEmpty(crmListView.defaultCVFiltersObj)&&!Crm.userDetails.CLIENT_ACCOUNT||"Email Status"===e.label){var i=I18n.getMsg("Notes");if(moduleRecordMapping.Activities){var s=I18n.getMsg(moduleRecordMapping.Activities.singular_label);crmListView.defaultCVFiltersObj.ACT=[{label:I18n.getMsg("crm.filter.label.without.open",s),"data-params":'{"searchfield" : "Activities:WITHOUTOPEN"}',subFilters:[],"data-value":"Activities:WITHOUTOPEN"},{label:I18n.getMsg("Overdue"),"data-params":'{"searchfield":"Activities:OVERDUE","searchModule":"Activities"}',"data-value":"OVERDUE"},{label:I18n.getMsg("crm.filter.label.activity.due",s),selected:"checked","data-value":"Activities:DUE","data-params":'{"searchfield" : "Activities:DUE"}',subFilters:["ACTIVITYFILTERS"]},{label:I18n.getMsg("crm.filter.label.without.any",s),"data-value":"Activities:MODIFIEDTIME:WITHOUTANY","data-params":'{"searchfield": "Activities:MODIFIEDTIME:WITHOUTANY"}',subFilters:["DATETIMEFILTERS1"]},{label:I18n.getMsg("crm.filter.label.activity.done",s),"data-value":"Activities:COMPLETED","data-params":'{"searchfield": "Activities:COMPLETED"}',subFilters:["DATETIMEFILTERS"]}]}if(crmListView.defaultCVFiltersObj.NOT=[{label:I18n.getMsg("crm.filter.label.without.any",i),"data-value":"Notes:CREATEDTIME:WITHOUTANY","data-params":'{"searchfield" : "Notes:CREATEDTIME:WITHOUTANY"}',subFilters:["DATETIMEFILTERS1"]},{label:I18n.getMsg("crm.filter.label.notes.added"),"data-value":"Notes:CREATEDTIME","data-params":'{"searchfield" : "Notes:CREATEDTIME"}',subFilters:["DATETIMEFILTERS"]}],moduleRecordMapping.Potentials){var a=I18n.getMsg(moduleRecordMapping.Potentials.singular_label);crmListView.defaultCVFiltersObj.POT=[{label:I18n.getMsg("crm.filter.label.with.open",a),"data-params":'{"searchfield" : "Potentials:WITHOPEN"}',subFilters:["RESTRICTEDDTFILTERS"],"data-value":"Potentials:WITHOPEN"},{label:I18n.getMsg("crm.filter.label.without.open",a),"data-params":'{"searchfield" : "Potentials:WITHOUTOPEN"}',subFilters:["RESTRICTEDDTFILTERS"],"data-value":"Potentials:WITHOUTOPEN"},{label:I18n.getMsg("crm.filter.label.without.any",a),"data-value":"Potentials:CREATEDTIME:WITHOUTANY","data-params":'{"searchfield": "Potentials:CREATEDTIME:WITHOUTANY","condition":"0","value":"${EMPTY}"}'}]}if(moduleRecordMapping.Contacts){var r=I18n.getMsg(moduleRecordMapping.Contacts.singular_label);crmListView.defaultCVFiltersObj.CON=[{label:I18n.getMsg("crm.filter.label.with.module",r),"data-params":'{"searchfield" : "Contacts:WITH"}',"data-value":"Contacts:WITH"},{label:I18n.getMsg("crm.filter.label.without.any",r),"data-value":"Contacts:CREATEDTIME:WITHOUTANY","data-params":'{"searchfield": "Contacts:CREATEDTIME:WITHOUTANY","searchfieldtype":"CON","condition":"0","value":"${EMPTY}"}'}]}crmListView.defaultCVFiltersObj.CHATS=[{label:I18n.getMsg("Attended"),"data-value":"Visits:CHATSATTENDED","data-params":'{"searchfield" : "Visits:CHATSATTENDED", "searchModule" : "Visits"}',subFilters:["DATETIMEFILTERS1"]},{label:I18n.getMsg("Missed"),"data-value":"Visits:CHATSMISSED","data-params":'{"searchfield" : "Visits:CHATSMISSED", "searchModule" : "Visits"}',subFilters:["DATETIMEFILTERS"]}],crmListView.defaultCVFiltersObj.PRE=[{label:I18n.getMsg("crm.intelligence.prediction.likelywin"),"data-params":'{"searchfield" : "winorlose"}',subFilters:[],"data-value":"PREWIN"},{label:I18n.getMsg("crm.intelligence.prediction.trendup"),"data-params":'{"searchfield" : "goneup"}',subFilters:["PREDICTIONFILTER1"],"data-value":"PREGONEUP"},{label:I18n.getMsg("crm.intelligence.prediction.trenddown"),"data-params":'{"searchfield" : "gonedown"}',subFilters:["PREDICTIONFILTER1"],"data-value":"PREGONEDOWN"},{label:I18n.getMsg("crm.intelligence.prediction.recordsfocus"),"data-params":'{"searchfield" : "focus"}',subFilters:["PREDICTIONFILTER2"],"data-value":"PREFOCUS"},{label:I18n.getMsg("crm.intelligence.prediction.score"),"data-params":'{"searchfield" : "score"}',subFilters:["PREDICTIONFILTER3"],"data-value":"PRESCORE"}],"entprofon"==e.trackoption?crmListView.defaultCVFiltersObj.EMA=[{name:"SENT",label:I18n.getMsg("crm.filter.label.sent"),searchfield:"LAST_SENT_TIME"},{name:"NOTSENT",label:I18n.getMsg("crm.filter.label.not.sent"),searchfield:"NOT_SENT"},{name:"OPENED",label:I18n.getMsg("crm.filter.label.opened"),searchfield:"LAST_ACTION_TIME"},{name:"CLICKED",label:I18n.getMsg("crm.label.filter.email.clicked"),searchfield:"LAST_ACTION_TIME"},{name:"NOTOPENED",label:I18n.getMsg("crm.filter.label.not.opened"),searchfield:"NOT_OPENED"},{name:"RECEIVED",label:I18n.getMsg("crm.filter.label.received"),searchfield:"LAST_ACTION_TIME"},{name:"NOTRECEIVED",label:I18n.getMsg("crm.filter.label.not.received"),searchfield:"NOT_RECEIVED"},{name:"BOUNCED",label:I18n.getMsg("crm.filter.label.bounced"),searchfield:"LAST_ACTION_TIME"},{name:"OPENEDNOTREPLIED",label:I18n.getMsg("crm.filter.label.opened.not.replied"),searchfield:"LAST_ACTION_TIME"}]:"stdon"==e.trackoption?crmListView.defaultCVFiltersObj.EMA=[{name:"SENT",label:I18n.getMsg("crm.filter.label.sent"),searchfield:"LAST_SENT_TIME"},{name:"NOTSENT",label:I18n.getMsg("crm.filter.label.not.sent"),searchfield:"NOT_SENT"},{name:"OPENED",label:I18n.getMsg("crm.filter.label.opened"),searchfield:"LAST_ACTION_TIME"},{name:"CLICKED",label:I18n.getMsg("crm.label.filter.email.clicked"),searchfield:"LAST_ACTION_TIME"},{name:"NOTOPENED",label:I18n.getMsg("crm.filter.label.not.opened"),searchfield:"NOT_OPENED"},{name:"BOUNCED",label:I18n.getMsg("crm.filter.label.bounced"),searchfield:"LAST_ACTION_TIME"}]:"entprofoff"==e.trackoption?crmListView.defaultCVFiltersObj.EMA=[{name:"SENT",label:I18n.getMsg("crm.filter.label.sent"),searchfield:"LAST_SENT_TIME"},{name:"NOTSENT",label:I18n.getMsg("crm.filter.label.not.sent"),searchfield:"NOT_SENT"},{name:"RECEIVED",label:I18n.getMsg("crm.filter.label.received"),searchfield:"LAST_ACTION_TIME"},{name:"NOTRECEIVED",label:I18n.getMsg("crm.filter.label.not.received"),searchfield:"NOT_RECEIVED"},{name:"BOUNCED",label:I18n.getMsg("crm.filter.label.bounced"),searchfield:"LAST_ACTION_TIME"}]:crmListView.defaultCVFiltersObj.EMA=[{name:"SENT",label:I18n.getMsg("crm.filter.label.sent"),searchfield:"LAST_SENT_TIME"},{name:"NOTSENT",label:I18n.getMsg("crm.filter.label.not.sent"),searchfield:"NOT_SENT"},{name:"BOUNCED",label:I18n.getMsg("crm.filter.label.bounced"),searchfield:"LAST_ACTION_TIME"}]}e.FILTERS=crmListView.defaultCVFiltersObj[t]})),Handlebars.registerHelper("isSmartFilterSupportedModule",(function(e,t,i){return"mLookup"==t?i.inverse(this):crmListView.isSmartFilterSupportedModule(e)?i.fn(this):void 0})),Handlebars.registerHelper("getUpdatedUpComingActionsJson",(function(e,t){var i=crmListView.getObject();i.upComingActionsJson&&i.upComingActionsJson[e]&&(t.upcomingTime=i.upComingActionsJson[e],delete i.upComingActionsJson[e],validationUtils.isEmpty(i.upComingActionsJson)&&delete i.upComingActionsJson)})),Handlebars.registerHelper("checkPermission_dots",(function(e,t,i){var s="Crm_Implied_Customize_Zoho_CRM",a="Crm_Implied_Print_View",r="Crm_Implied_Tags";return""!=t&&(a=a+"_"+t,r=r+"_"+t),crmListView.changedPermissionsForZBModules.hasOwnProperty(s)&&(s=crmListView.changedPermissionsForZBModules[s]),crmListView.changedPermissionsForZBModules.hasOwnProperty(a)&&(a=crmListView.changedPermissionsForZBModules[a]),crmListView.changedPermissionsForZBModules.hasOwnProperty(r)&&(r=crmListView.changedPermissionsForZBModules[r]),1==Crm.userDetails.permissions[s]&&1==Crm.userDetails.permissions[r]||1==Crm.userDetails.permissions[a]?i.fn(this):i.inverse(this)})),Handlebars.registerHelper("checkPermission_invmodules",(function(e,t,i){var s="Crm_Implied_Customize_Zoho_CRM",a="Crm_Implied_Tags";return""!=t&&(a=a+"_"+t),crmListView.changedPermissionsForZBModules.hasOwnProperty(s)&&(s=crmListView.changedPermissionsForZBModules[s]),crmListView.changedPermissionsForZBModules.hasOwnProperty(a)&&(a=crmListView.changedPermissionsForZBModules[a]),1==Crm.userDetails.permissions[s]&&1==Crm.userDetails.permissions[a]?i.fn(this):i.inverse(this)})),Handlebars.registerHelper("getCampaignData",(function(e,t,i){var s=customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView?t||customViewObject.modulePicklistValues.Campaigns:t||crmListView.getObject().modulePicklistValues.Campaigns;if(e.statusClass="dN",e.typeClass="dN",s&&(s.STATUS&&(e.camp_status=s.STATUS.slice(),e.camp_status.shift(),e.statusClass="oBor mT0 mB5 campLeftFilter"),s.TYPE)){e.camp_types=s.TYPE.slice(),e.camp_types.shift(),e.typeClass="oBor mT0 campLeftFilter";var a=Crm.partnerName+" Campaigns";(i||crmListView.getObject().modulePicklistValues&&crmListView.getObject().modulePicklistValues["Zoho Campaign Members"])&&-1===e.camp_types.indexOf(a)&&e.camp_types.unshift(a)}})),Handlebars.registerHelper("isDotToBeShown",(function(e,t){var i=!1;if(customViewObject.supportedIntegFeatures)for(var s=customViewObject.supportedIntegFeatures.length,a=0;a<s;a++){var r=customViewObject.supportedIntegFeatures[a];if(r.isSupported&&"true"!==r.isDotNotToBeShown){i=!0;break}}var l=Lyte.registeredMixins["crm-view-utils"].getIntegCampObject();i&&(customViewObject.campaignLayoutSubMenu.forEach((function(e){e.namespace&&delete l[e.namespace]})),0===Object.keys(l).length&&(i=!1));return"Campaigns"===e&&i?t.fn(this):t.inverse(this)})),crmListView.isSmartFilterSupportedModule=function(e){return!(!e||!crmListView.modulesWithSmartFilters.contains(e)&&0!==e.indexOf("LinkingModule")&&(0!==e.indexOf("CustomModule")||crmTab.isZBCustomModule(e)||crmTab.isZSCustomModule(e)))},crmListView.dropCacheOnActivityCreate=function(e,t){var i=crmTab.getFromCache(e),s="Activities"===Crm.activityGrp[t]?"ACT":"Notes"===t?"NOT":void 0;if(i&&s&&crmListView.isSmartFilterSupportedModule(e)){var a=i.filters;if(a&&a.length)for(var r=a.length,l=0;l<r;l++){if(a[l].searchfieldtype===s){crmTab.deleteFromCache(e);break}}}},crmListView.recordChange=function(e,t){var i=t?$(t).data("params"):"";if(i&&i.massActions){var s=["mass_delete","mass_update","mass_convert","mass_transfer"],a=objectUtils.cloneObject(Lyte.Router.getRouteInstance().transition),r=a.info.queryParams;if(s.contains(r.type)&&a.data&&(r=a.data.query_params),r.page=r.page?Number(r.page):1,s.contains(r.type)){"mass_update"==r.type&&(r.type="bulk_mass_update");var l=1,o=10;return"navigate_next"==e.clickId?(l=r.page*parseInt(r.per_page)+1,r.page=r.page+1,o=r.page*parseInt(r.per_page)):(r.page=r.page-1,l=(r.page-1)*parseInt(r.per_page)+1,o=r.page*parseInt(r.per_page)),callMassRecords(l,o,r.type),Lyte.Router.getRouteInstance().transition.data.query_params.page=r.page,!1}return r.page="navigate_next"==e.clickId?r.page+1:r.page-1,Lyte.Router.transitionTo({route:a.info.route,dynamicParams:a.info.dynamicParams,queryParams:r}),!1}if("mLookup"==e.from)return $(t).attr("data-params",JSON.stringify(e)),"navigate_previous_listview"==e.clickId?multiLookupsView.navigatePrevious(event,t):multiLookupsView.navigateNext(event,t);Crm.currentPageData.title="listView",Crm.currentPageData.module=e.module;var n={},c=crmListView.getObject(),d=e.clickId?e.clickId:$(t).attr("id"),m=Number(c.fromIndex),u=Number(c.toIndex),p=c?c.portalName:void 0,f={};null!=p&&"All Portals"!=p?(e.portalName=p,e.allPortals=!1):e.allPortals=!0;var v=$('#lv_filter_savePopup input[name="module"]').val(),g=0,h=[];if($.each($(".newcheckboxfilternew:checked"),(function(){var e=$(this),t=e.data().params?e.data().params.searchModule:"",i=e.data().params.searchfield;""!==t&&t!==v&&-1===h.indexOf(t)?(h.push(t),g++):(e.closest(".filterContainBox").find(".historyTrackerFilterVal").length||i&&"EMAIL"===i.split(":")[1])&&g++})),g>3)return showAnimatePopup("custom_filter_alert_popup"),void $("#freezeBackGround").css({background:"var(--freezeLayerBg)",opacity:"0.4"});if("currentOption"==d){var w=moduleRecordMapping[e.module];e.currentOption=$("#currentOption").val(),w.per_page=Number(e.currentOption),e.clearCache=!0}else c?e.currentOption=c.currentOption:getObj("rangeValue")?e.currentOption=getObj("rangeValue").value:e.currentOption=10;e.OnSelect=!0;var C=e.currentOption?parseInt(e.currentOption):c?c.currentOption:parseInt(e.toIndex)-parseInt(e.fromIndex)+1,b=(m=e.fromIndex?parseInt(e.fromIndex):c&&c.fromIndex?parseInt(c.fromIndex):1,parseInt(e.currentOption));"true"==e.changeOption&&1!=m&&m-1<b&&(e.fromIndex=m-b,m=e.fromIndex,e.toIndex=m+C-1);u=m+C-1;var V=c?c.searchletter:$("input[name=searchletter]").val();$L("crm-page-navigator")[0];"navigate_next"!=d&&"navigate_next_listview"!==d||$("#recordNum").val()&&!crmListView.getObject().isCampaignAddMemberListView?"navigate_previous"!=d&&"navigate_previous_listview"!==d||$("#recordNum").val()&&!crmListView.getObject().isCampaignAddMemberListView||(!e.recordNum&&!e.recordNum<m&&(m-=C,u-=C),f.fetchOnlyBody=!0):(m+=C,u+=C,f.fetchOnlyBody=!0),m<0&&(m="1",u=e.currentOption),e.fromIndex=m,e.toIndex=e.currentOption,e.currentOption||delete e.currentOption,V&&"All"!==V&&(e.searchletter=V,n.search_letter=c.searchletter),e.module||(e.module=0!=$("input[name=module]").length?$("input[name=module]").val():crmListView.getObject().module);var I=$("input[name=rangeValue]");I[0]&&(e.rangeValue=I.val()),$("input[name=previous_sort_order]").val()&&$("input[name=previous_sort_column]").val()?(e.sortOrderString||(e.sortOrderString=$("input[name=previous_sort_order]").val(),e.previous_sort_order=e.sortOrderString),e.sortColumnString||(e.sortColumnString=$("input[name=previous_sort_column]").val(),e.previous_sort_column=e.sortColumnString)):"sortingRecords"!==d&&c&&(e.sortColumnString=e.previous_sort_column=c.sortColumnString,e.sortOrderString=e.previous_sort_order=c.sortOrderString);var O=crmHistory.getPageDetailsFromIndex(m,u);if(e.toIndex=u,n.page=O.page,n.per_page=O.perPage,n.sort_by=c.sortColumnString,n.sort_order=c.sortOrderString,c.filterId&&(n.filter_id=c.filterId),c.filters&&(n.filters=JSON.stringify(c.filters)),c.cross_filters&&(n.cross_filters=JSON.stringify(c.cross_filters)),"true"===e.changeOption&&(f.fetchOnlyBody=!0),crmListView.getObject().isPrivacyListView)return CrmPrivacyDashboard.changeCurrentOption(e);if(crmListView.getObject().isCampaignAddMemberListView)return CrmCampaignInteg.changeCurrentOption(e);if(e.cvid=crmListView.getObject().cvId,c.viewid){Lyte.Router.getRouteInstance();(_=Lyte.Router.transitionTo({route:"crm.tab.module.custom-view.canvas",dynamicParams:[c.module,c.cvId,c.viewid],queryParams:n})).data=e,_.fetchOnlyBody=f.fetchOnlyBody}else if(c.module&&c.cvId){var _;(_=Lyte.Router.transitionTo({route:"crm.tab.module.custom-view.list",dynamicParams:[c.module,c.cvId],queryParams:n})).data=e,_.fetchOnlyBody=f.fetchOnlyBody}},crmListView.setVTDivHt=function(e){var t=$("#vtFieldDiv"),i=0;e&&$(e.closest(".vtColumn")).length>0&&$("#vtMoreSpan").is(":visible")&&(t.find(".filterContainBox:lt(3)").each((function(){i+=$(this).innerHeight()})),t.css({height:i}).addClass("oH")),e||(i=93,t.css({height:i}).addClass("oH"))},crmListView.showHiddenRFMFilter=function(e){var t=$(e).closest(".rfmTop").find(".withNotesdays");t.hasClass("dN")?t.removeClass("dN"):t.addClass("dN")},crmListView.showHideSelectedFilter=function(e,t){var i=$("#lv_left_filter"),s=i.find("input.checkFilter:checked"),a=$(e).prop("checked"),r=$(e).attr("data-value"),l=r&&r.indexOf("RECORDACTION")>-1,o=!1;if(a&&s.length>crmListView.MAX_FILTER_CNT)return renderingUtils.showCustomAlert(I18n.getMsg("crm.criteria.max.rowcnt.exceeds")),void $(e).prop("checked",!1);(r&&r.indexOf("TOUCH")>-1||l)&&($(e).parent().parent().find("#lv_touchedRec_filters").toggle(a),$(e).parent().parent().find("#lv_RecordAction_filters").toggle(a&&l));var n="";if($(e).attr("data-params")){var c=JSON.parse($(e).attr("data-params"));c&&c.searchfield&&(n=c.searchfield.split(":")[1])}var d=!0,m=crmListView.getObject();$("#lv_filter_submit").prop("disabled",!1),0!==s.length||m.filters&&0!==m.filters.length&&!m.filterId?($("#lv_filter_submitdiv").css("visibility","visible"),crmListView.toggleFilterOptions(!1),i.find("#clearFilterLink").show()):$("#lv_filter_submitdiv").css("visibility","hidden"),"undefined"==typeof event&&(d=!1);var u=(e=$(e)).attr("id");if("MXN"===t){var p=(b=e.closest("div .facetContainer")).find("input[type=text]");e.prop("checked")&&b.find('[data-connectedmodule="Users"]').length&&(t="U",o=!0)}if("LPR"===t&&($(e).is(":checked")?$("#sub_"+u).find("input[type=radio]").eq(0).prop("checked",!0):$("#sub_"+u).find("input[type=radio]").filter(":checked").prop("checked",!1)),"EMAIL"===t){var f=e.val(),v=i.find("#lv_email_status");return i.find(".subFilters_Email").hide(),i.find("#lv_email_date").show(),"SENT"===f?(v.show(),v.find(".rbCheckHtml:visible").length>1&&0==v.find('input[type="radio"]:checked:visible').length&&v.find('input[type="radio"]').eq(0).click()):(v.hide(),v.find('input[type="radio"][data-value="'+f+'"]').click()),void("NOTSENT"===f?(i.find("#sub_NOTSENT").show().find("select").trigger("change"),i.find("#lv_email_date").hide()):i.find("#lv_email_date").find("select").trigger("change"))}if("T"===t&&"LATITUDE"===n){if(void 0!==m.filters)for(var g=0;g<m.filters.length;g++){f=m.filters[g].value.split(";");$("#latlong").val(f[2]+","+f[1]),$("#km").val(f[3]);var h="";h=""===$("#maps_search").val()?I18n.getMsg("Near By"):$("#km").val()+" "+I18n.getMsg("crm.nearby");var w="textcondition1_"+u.split("_")[1];$("#"+w+" option").text(h).prop("selected",!0)}}else if("REC"===t){var C=e.parents(".facetContainer").find(".subFilters_Recommendations");e.prop("checked")?C.show():C.hide();p=C.find("input[type=text]");V="#"+p[0].name;p=$(p[0]);I=p.data("connectedmodule"),O=p.data("dispsysrefname"),setTimeout((function(){CustomView.bindMultiSelectLookup2(I,V,O)}),100),setTimeout((function(){CustomView.bindMultiSelectLookup2(I,"#recommendation_select_2",O)}),100)}else if("EMA"===t){e.prop("checked")?($("#lv_email_filters").show(),$("#info_button").show()):($("#lv_email_filters").hide(),$("#info_button").hide());f=$("#emailCondition").val(),v=i.find("#lv_email_status");"SENT"===f?0==v.find('input[type="radio"]:checked:visible').length&&v.find('input[type="radio"]').eq(0).click():v.find('input[type="radio"][data-value="'+f+'"]').click()}else if("MXN"===t||"CAM"===t){var b;p=(b=e.closest("div .facetContainer")).find("input[type=text]");if(e.prop("checked")){var V="#campaign_name_select",I="Campaigns",O="Campaign_Name";"MXN"===t&&(V="#"+p[0].name,I=$(p[0]).data("connectedmodule"),O=$(p[0]).data("dispsysrefname")),"MXN"===t?setTimeout((function(){CustomView.bindMultiSelectLookup2(I,V,O),"0"==e.closest("div .facetContainer").find(".filterCondition").val()?e.closest("div .facetContainer").find("#mxnSelect2").css("display","block"):e.closest("div .facetContainer").find("#mxnSelect2").css("display","none")}),100):setTimeout((function(){CustomView.bindMultiSelectLookup2(I,V,O)}),100),$("#lv_camp_filters").show()}else $("#campaign_status_sel").val(""),$("#campaign_type_sel").val("").trigger("change"),setTimeout((function(){$("#"+p[0].name).select2("destroy")}),100),$("#lv_camp_filters").hide()}else if("L"===t){var _="textlayoutcondition1_"+u.split("_")[1];Search.checkEmptyCdn($('select[id="'+_+'"]')[0],void 0,void 0,void 0,JSON.parse(e.attr("data-params")).searchfield)}else if("W"===t){_="textwizardcondition1_"+u.split("_")[1];Search.checkEmptyCdn($('select[id="'+_+'"]')[0],void 0,void 0,void 0,JSON.parse(e.attr("data-params")).searchfield)}else if("tag"===t){if($("#ActivityTag")&&$("#ActivityTag").length>0)$("#ActivityTag").find('input[type="radio"]').prop("checked",!1).closest("div.facetContainer").find("ul.facets").hide(100),e.prop("checked",!0);var T=(_="texttagcondition1_"+u.split("_")[1]).substr(_.lastIndexOf("n")+1);$("input[name=searchtag"+T+"]").val(""),$("select[id=searchtag"+T+"]").val(""),Search.checkEmptyCdn($('select[id="'+_+'"]')[0],void 0,void 0,void 0,JSON.parse(e.attr("data-params")).searchfield)}else if("ActivityTag"==t){var L=$("#ActivityTag"),y=L.find("#activityRelTo");y.is(":visible")?y.hide():y.show(),L.find("div.facetContainer").show(),L.find("input.checkFilter").prop("checked",!1)}else if(!a||"picklist"!==t&&"B"!==t)if("ActivityType"===t&&a){0===e.closest(".facetContainer").find("ul.filter_range").find("#actcondition_chosen").length&&thirdPartyUtils.bindSelect2("#actcondition")}else(r&&r.indexOf("TOUCH")>-1||l)&&($(e).parent().parent().find("#lv_touchedRec_filters").toggle(a),$(e).parent().parent().find("#lv_RecordAction_filters").toggle(a&&l));else{_="B"===t?"booleancondition1_"+u.split("_")[1]:"textpicklistcondition1_"+u.split("_")[1];var E=JSON.parse(e.attr("data-params")),S=$('select[id="'+_+'"]');Search.checkEmptyCdn(S[0],void 0,void 0,void 0,E.searchfield,E.searchModule)}var M=u.split("_")[0];d?$(".subFilters_"+M).slideUp("fast"):$(".subFilters_"+M).hide();var k="filter"===M?e.attr("data-name"):"sub_"+M;o&&$("#sub_"+u).find('option[value="1"]').remove(),a?(d?$("#sub_"+u).slideDown("fast",(function(){crmListView.setVTDivHt(e)})):$("#sub_"+u).show(),"EMA"!=t&&"true"===e.attr("data-subFilters")&&0==$("#sub_"+u).find('input[type="radio"][name="'+k+'"]:checked').length&&$("#sub_"+u).find('input[type="radio"]').eq(0).click()):$("#sub_"+u).slideUp("fast",(function(){crmListView.setVTDivHt(e)}))},crmListView.checkCVLeadFilterCond=function(e,t){var i=$(e).val(),s=$(e).parent().parent("div").parent("a");"14"===i?s.find(".betweenCrt").show():s.find(".betweenCrt").hide()},crmListView.showRecommendationProd=function(e){"all"==$(e).val()?$(e).parent().next().hide():$(e).parent().next().show()},crmListView.checkCVFilterCondition=function(e,t,i){var s=$(e).val(),a=$(e).parent();(crmListView.toggleFilterOptions(!1),$("#lv_filter_submit").prop("disabled",!1),$(e).parent().removeClass("mT3"),!t||"N"===t&&("14"===s||"15"===s||s.startsWith("$"))||"RFM_score"===t&&("14"===s||"15"===s))&&$(e).parent().nextAll().hide().removeClass("filterValue").find(".filterValue").removeClass("filterValue");if("U"===t){var r=$("#temp_searchuser"+i);r.find("li").remove(),$("#searchuser"+i).val(""),"${CURRENTUSER}"===s?(r.find("ul").prepend('<li class="search-choice">${CURRENTUSER}</li>').children("input").css({readonly:"true",display:"none"}),$("#searchuser"+i).val("${CURRENTUSER}")):void 0===r.find("li").eq(0).attr("id")&&r.children("ul").children("input").attr("placeholder",I18n.getMsg("crm.label.select.user"))}if(s&&s.startsWith("$"))$(e).parent().addClass("mT3"),$(e).parent().nextAll("#searchdate").addClass("filterValue"),"picklist"!=t&&"tag"!=t&&"SMA"!=i?$(e).closest("li").find(".filterValue").attr("readonly","readonly").hide():"SMA"!=i&&$(e).closest("li").find(".filterValue").parent().hide();else if(s===Search.dueCrt||s===Search.ageCrt)$(e).parent().parent("div").find("#ageindays").show().addClass("filterValue").parent().show(),$(e).parent().nextAll("#selDays").show();else if("N"===t||"RFM_score"===t||"14"!==s&&"15"!==s)if("RFM_score"===t)if("14"===s||"15"===s){(n=a.parent("div")).find(".betweenCrt").show();var l="readonly",o="filterValue";n.find("#fromnum").show().removeAttr(l).val("").addClass(o),n.find("#tonum").show().removeAttr(l).val("").addClass(o),n.find("#betweenDateText").show()}else{(n=a.parent("div")).find(".betweenCrt").hide(),n.find("#fromnum").removeClass("filterValue").hide(),n.find("#tonum").removeClass("filterValue").hide(),n.find("#searchnum1").show().val("").addClass("filterValue"),$(e).closest(".rfmTop").find(".filterValue").removeAttr("readonly").show(),a.next().focus()}else if("N"===t){if("14"===s||"15"===s)(n=$(e).parent().parent("div")).find(".betweenCrt").show(),n.find("#fromnum").show().removeAttr("readonly").val("").addClass("filterValue"),n.find("#tonum").show().removeAttr("readonly").val("").addClass("filterValue");else(n=$(e).parent().parent("div")).find(".betweenCrt").hide(),n.find("#fromnum").removeClass("filterValue").hide(),n.find("#tonum").removeClass("filterValue").hide(),n.find("#searchnum1").show().val("").addClass("filterValue"),$(e).closest("li").find(".filterValue").removeAttr("readonly").show(),$(e).parent().next().find('input[type="text"]').focus();$(e).parent().parent("div").find("#currencyCode1").length>0&&$(e).parent().parent("div").find("#currencyCode1").show()}else"picklist"===t||"L"===t||"W"===t||"tag"==t?$(e).closest("li").find(".filterValue").parent().show():t?($(e).closest("li").find(".filterValue").removeAttr("readonly").show(),$(e).parent().next().find('input[type="text"]').focus()):$(e).parent().nextAll("#searchdate").removeAttr("readonly").val("").show().addClass("filterValue");else{var n;(n=$(e).parent().parent("div")).find(".betweenCrt").show(),n.find("#fromdate").show().removeAttr("readonly").val("").addClass("filterValue"),n.find("#todate").show().removeAttr("readonly").val("").addClass("filterValue")}$(e).hasClass("historyTrackerFilterCond")&&(0==s?(""==$(".historyTrackerFilterVal").val()||""!==$(".historyTrackerFilterVal").val()&&$(".historyTrackerFilterVal").val().split(",").length<=5)&&$(".historyMoreOpt").removeClass("hide"):$(".historyMoreOpt").addClass("hide"))},crmListView.formFilterValues=function(e,t){for(var i=1;i<e.length;i++)t=t+","+e.eq(i).val();return t},crmListView.checkMXNCVFilterCondition=function(e,t,i){var s=$(e).val();crmListView.toggleFilterOptions(!1),$("#lv_filter_submit").prop("disabled",!1),$(e).parent().removeClass("mT3"),s&&s.startsWith("$")?($(e).parent().addClass("mT3"),$($(e).closest("div .facetContainer")).find("#mxnSelect2").css("display","none")):$($(e).closest("div .facetContainer")).find("#mxnSelect2").css("display","block")},crmListView.processLeadPrediction=function(e,t,i){e.filter(":checked").attr("id");var s,a=$(t).attr("data-value"),r=$("#sub_filter_l1").find("input[type=radio]").filter(":checked");if("LPCON"==a)s=$(e).find("input[type=radio]").filter(":checked").val();else if("LPSCR"==a){var l=$(e).find("select").val(),o=$(e).find(".filterValue");if(!crmListView.predictionFilterValidation(r,o,"LPSCR",l))return i=void 0,null;if("14"==l){if(o.length>0&&(s=o.eq(0).val(),s=crmListView.formFilterValues(o,s),!crmListView.validateBetweenCrt(o.eq(0),o.eq(1))))return o.eq(1).focus(),alert(I18n.getMsg("crm.lead.prediction.field.less.than.to")),null}else s=o.eq(0).val();i.condition=l}else if("LPREC"==a){var n,c=$(e).eq(0).find("select").val();(n=$(e).find('input[type="radio"]:checked').parent().find(".filterValue")).length>0&&(s=(s=c)+","+n.eq(0).val(),s=crmListView.formFilterValues(n,s))}else if("LPRFOC"==a){var d=$(e).find('input[type="checkbox"]:checked');d.length>0&&(s=d.eq(0).val(),s=crmListView.formFilterValues(d,s))}i.searchfield=a,i.value=s},crmListView.formFilterValues=function(e,t){for(var i=1;i<e.length;i++)t=t+","+e.eq(i).val();return t},crmListView.handleRecommendationType=function(e){var t=$("#already_bought_div"),i=$("#rebuy_date_div");"CWBAB"===(e=$(e)).val()?(t.show(),i.hide()):"REBUY"===e.val()?(t.hide(),i.show()):(t.hide(),i.hide())},crmListView.handleRecommendationRebuyOption=function(e){var t=$("#rec_searchdate");"custom"===$(e).val()?t.show():t.hide()},crmListView.formFilterConditions=function(e){for(var t=0,i=$("#lv_filter_scroll"),s=!1,a=i.find("input.checkFilter:checked").not(".rfmFilter"),r=a.length,l=[],o={filters:l},n=$("#camp_service_status_sel").val(),c=void 0!==n?n.join(","):"",d=0;d<r;d++){var m={},u=a.eq(d),p=$("#sub_"+u.attr("id")),f=p.find("li"),v=u.data("name"),g=u.attr("data-params")?JSON.parse(u.attr("data-params")):{};for(var h in g)m[h]=g[h];if("RFM_score"===m.searchfieldtype){var w=f.find(".rfmFilter:checked"),C=w.length;if(!C)return alert(I18n.getValueForFields("crm.field.valid.check",f.closest(".filterContainBox").find(".filterLabel").attr("title"))),null;for(var b=m.searchfield.split(":::"),V={},I=b.length,O=0;O<I;O++)b[O].includes("CF_R")?V.CF_R=b[O]:b[O].includes("CF_F")?V.CF_F=b[O]:b[O].includes("CF_M")&&(V.CF_M=b[O]);for(var _=0;_<C;_++){for(var T=$(w.get(_)),L=T.attr("id"),y=T.closest(".rfmTop"),E=y.find(".filterValue"),S=E.val(),M=E.length,k=1;k<M;k++)S=S+","+E.eq(k).val();if(m.condition?(m.condition=m.condition+":::"+y.find(".filterCondition").val(),m.value=m.value+":::"+S,m.searchfield=m.searchfield+":::"+V[L]):(m.condition=y.find(".filterCondition").val(),m.value=S,m.searchfield=V[L]),!crmListView.validateFilterValue(E[0],m,S,!1))return null}}if("CAM"===m.searchfieldtype){if(crmListView.selectedCampaigns=[],$.each($("#campaign_name_select option:selected"),CustomView.populateCampaigns),m.searchfield="Campaigns:CAMPAIGNID",validationUtils.isEmpty(crmListView.selectedCampaigns))return crmui.showMsgBand("warning",I18n.getValueForFields("crm.field.valid.check",I18n.getMsg("crm.module.name",$ESAPI.encoder().encodeForHTML(I18n.getMsg(moduleRecordMapping.Campaigns.singular_label)))),"2500"),null;m.value=JSON.stringify(crmListView.selectedCampaigns);var A,N=$("#camp_member_status_sel").val().join(",");if(""!=N)(A=jQuery.extend(!0,{},m)).searchfield="Campaigns:MEMBERSTATUS",A.value=N,l.push(A);if(""!=c)(A=jQuery.extend(!0,{},m)).searchfield="Campaigns:SERVICESTATUS",A.value=c,l.push(A)}if("REC"===m.searchfieldtype){var D={},P=$("#recommendation_type");if(m.searchfield="Recommendation:"+P.val(),"all"!==$("#product_choose").val()){var x=[],R=(W=$("#recommendation_select_id")).attr("name");if(0==(z=(G=$("#"+R+" option:selected")).length))return crmui.showMsgBand("warning",I18n.getMsg("crm.dashboard.sharing.empty.value.alert"),"2500"),W.next().find("input").trigger("click"),null;for(var F=0;F<z;F++){var j={},U=$(G[F]);j.id=U.val(),j.value=U.text(),x.push(j)}D.selected_products=x}if("REBUY"===P.val()){var B={},H=$("#rebuy_select").val();if(B.option=H,"custom"===H){var Y=$("#rec_searchdate");if(!crmListView.validateFilterValue(Y[0],void 0,Y.val()))return null;B.custom_date=Y.val()}D.rebuy_options=B}else if("CWBAB"===P.val()){x=[];var z,J=(W=$("#recommendation_select_2_id")).attr("name"),q=$("#"+J+" option:selected");if(0==(z=q.length))return crmui.showMsgBand("warning",I18n.getMsg("crm.dashboard.sharing.empty.value.alert"),"2500"),W.next().find("input").trigger("click"),null;for(F=0;F<z;F++){j={},U=$(q[F]);j.id=U.val(),j.value=U.text(),x.push(j)}D.in_fields=x}m.value=JSON.stringify(D)}if("MXN"===m.searchfieldtype){var W;x=[],R=(W=$(f.find("input[type=text]"))).attr("name");if(W.data("connectedmodule")){var G=$("#"+R+" option:selected");for(F=0;F<G.length;F++){j={},U=$(G[F]);j.id=U.val(),j.value=U.text(),x.push(j)}}else{for(var K=W.attr("id"),Z=$(f.find("li")),F=0;F<Z.length;F++){var j={},U=$(Z[F]);j.id=U.data("id"),j.value=U.text(),x.push(j)}W=$("#"+K.replace("hostSearch_temp_",""))}if(m.searchfield=W.data("sysrefname")+":ID",m.searchModule=W.data("connectedmodule"),m.linkingModule=W.data("linkingmodule"),m.dispsysrefname=W.data("dispsysrefname"),m.sysrefname=W.data("sysrefname"),m.tagName=W.data("sysrefname")+"_select",m.condition=f.find(".filterCondition").val(),validationUtils.isEmpty(x)&&"0"==m.condition)return crmui.showMsgBand("warning",I18n.getValueForFields("crm.field.valid.check",I18n.getMsg("crm.module.name",$ESAPI.encoder().encodeForHTML(I18n.getMsg(moduleRecordMapping[m.searchModule].singular_label)))),"2500"),null;m.value=JSON.stringify(x)}else if(m.searchfield.indexOf("TOUCH")>-1)m.searchfield=m.searchfield+":"+u.closest(".filterContainBox").find("#touchSource").val();else if(m.searchfield.indexOf("RECORDACTION")>-1){var X=u.closest(".filterContainBox");m.searchfield=m.searchfield+":"+X.find("#actionType").val()+":"+X.find("#touchSource").val()}if("PRE"==m.searchfieldtype){var Q,ee=f.find(".predictionMain").filter(":checked").attr("id"),te=$("#sub_"+ee).find(".preSubFilter"),ie=$(".predictionMain:checked").attr("data-value");if("PREWIN"===ie)m.searchfield=ie,be=$(".predictionMain:checked").closest("li").find(".predFilterVal").val();else if("PREGONEUP"===ie||"PREGONEDOWN"===ie){if(m.searchfield=ie,(Q=$(te).find('input[type="radio"]:checked').closest(".preSubFilter").find(".predFilterVal")).length>0){be=Q.eq(0).val();for(k=1;k<Q.length;k++)be=be+","+Q.eq(k).val()}}else if("PREFOCUS"===ie){m.searchfield=ie;var se=$(te).find('input[type="checkbox"]:checked');if(se.length>0){be=se.eq(0).val();for(k=1;k<se.length;k++)be=be+","+se.eq(k).val()}}else if("PRESCORE"===ie){m.searchfield=ie;var ae=$(te).find("select").val();be=$(te).find('input[type="text"]').val(),m.condition=ae}m.value=be}else if("LPRE"==m.searchfieldtype&&(crmListView.processLeadPrediction(f,u,m),!m.searchfield)){s=!0;continue}if("true"===u.attr("data-subFilters"))if("EMA"===m.searchfieldtype){var re=(me=i.find("#emailCondition").find("option:selected")).attr("data-value");m.searchfield=customViewObject.module+":"+re,f="NOTSENT"===(me=me.val())?i.find("#sub_NOTSENT"):$("#lv_email_date");customViewObject.module;var le=i.find("#lv_email_status").find('input[name="mail_status"]:checked').attr("data-value");"SENT"===me&&(le="OPENED"==le?"SENT_OPENED":le||me),m.searchfield=m.searchfield+":"+le}else if("SMA"!=m.searchfieldtype&&"Prediction"!=v){f=(me=p.find('input[name="'+v+'"]:checked')).closest("li");var oe=JSON.parse(me.attr("data-params"));for(var h in oe)m[h]=oe[h];if("OVERDUE"===me.attr("data-value")){var ne=f.find("select").val();m.searchfield=ne+":OVERDUE",m.searchModule=ne}else if("true"===me.attr("data-subFilters")){var ce=me.closest("li").find('input[name="sub_'+v+'"]:checked');if(f=ce.length?ce.closest("div"):f,ce.attr("data-params")){f=ce.closest("div");var de=JSON.parse(ce.attr("data-params"));for(var h in de)m[h]=de[h]}}t++}if("SMA"===m.searchfieldtype){var me=i.find("#emailSentimentCondition").find("option:selected").val(),ue=m.searchfield.split(":")[0];f=$("#lv_email_sentiment_date");var pe=i.find("#lv_email_sentiment_status").find('input[name="sentiment_status"]:checked'),fe=pe.closest("li"),ve=(le=pe.attr("data-value"),fe.find("#sub_Sentiment_1New").find("option:selected").val()),ge=fe.find("#ageindays1").val();if(le&&(!ge||""===ge.trim()||isNaN(ge))&&"LASTMAIL"!=le)return crmui.showMsgBand("error",I18n.getMsg("crm.mb.field.startnum.notn.number"),6e3),fe.find("#ageindays1").focus(),null;m.searchfield=ge&&ve?ue+":"+me+":"+le+":"+ve+":"+ge:ue+":"+me+":"+(le||"COUNT")}if("RFM_score"!=m.searchfieldtype&&"PRE"!=m.searchfieldtype&&"LPRE"!=m.searchfieldtype&&!m.condition&&f.find(".filterCondition").length){if(m.condition=f.find(".filterCondition").val(),"${BLOCKED}"==m.condition||"${NOTBLOCKED}"==m.condition){var he=m.searchfield.split(":")[1],we=m.searchfield.split(":")[0];m.searchfield=we+":"+he,"EMAIL"==he?m.searchModule="PRIM_Bounce":"ADDN_EMAIL"==he&&(m.searchModule="SEC_Bounce"),t++}"near to"==m.condition&&null!=$("#latlong")&&(m.latlong=$("#latlong").val())}if("RFM_score"!=m.searchfieldtype&&"PRE"!=m.searchfieldtype&&"LPRE"!=m.searchfieldtype&&!m.value&&f.find(".filterValue").length){var Ce=f.find(".filterValue");if(Search.defaultFilters.contains(m.condition)||Search.bounceDefaultFilters.contains(m.condition))var be=m.condition;else{be=Ce.val();if("searchdate"==Ce[0].id||"fromdate"==Ce[0].id)try{var Ve=CrmDateUtils.getDateObjectFromString(be);be=CrmDateUtils.getFormattedDate(Ve)}catch(e){murphy.error(e)}for(k=1;k<Ce.length;k++){var Ie=Ce.eq(k).val();if("todate"==Ce[k].id)try{Ve=CrmDateUtils.getDateObjectFromString(Ie);Ie=CrmDateUtils.getFormattedDate(Ve)}catch(e){murphy.error(e)}be=be+","+Ie}}var Oe=be&&"string"==typeof be&&-1!==be.indexOf("${LASTAGEINMONTHS")?be.replace("${LASTAGEINMONTHS","").replace("}",""):be;if(!crmListView.validateFilterValue(Ce[0],m,Oe,e))return null;be=m.condition===Search.dueCrt?"+"+be:be,"ageindays"===Ce.attr("name")&&(be=m.condition===Search.dueCrt?Ce.next("#selDays").find("select").val().replace("LAST","")+be+"}":Ce.next("#selDays").find("select").val()+be+"}"),m.value=be,"U"===m.searchfieldtype&&Search.formUserConditionValues(o,"1_"+Ce.attr("id").split("_")[1],"temp_searchuser"+d,be)}if(!m.value&&Search.defaultFilters.contains(m.condition)&&(m.value=m.condition),"picklist"===m.searchfieldtype){var _e=f.find(".historyMoreOpt");if(_e.length>0&&_e.is(":visible")&&!_e.hasClass("disableHistory")){if(m.trackerOption="none",_e.find("#historyTrackedPickList_duration").is(":checked")){m.trackerOption="duration",m.trackerOptionCond=_e.find("#historyTracker_duration_cond").val();var Te=_e.find("#histTrackDurationDays");if(Te&&(""===Te.val()||parseInt(Te.val())<0||/\D/.test(Te.val())))return alert(I18n.getMsg("crm.smartfilter.history.duration")),Te.focus(),null;m.trackerOptionDays=Te.val()}t++}}if("ActivityType"===m.searchfieldtype&&(m.searchfieldtype="T"),"tag"==m.searchfieldtype&&("CrmTask:TAGMODULEREFID"===m.searchfield||"CrmCall:TAGMODULEREFID"===m.searchfield||"CrmEvent:TAGMODULEREFID"===m.searchfield)){if(null!=e){if(e)continue;if(!e&&$("#filter_activityTag").length>0&&0==$("#filter_activityTag:checked").length)continue}"CrmTask:TAGMODULEREFID"===m.searchfield?m.searchModule="Tasks":"CrmCall:TAGMODULEREFID"===m.searchfield?m.searchModule="Calls":Crm.isActivitySplitDone||"Calls"==m.searchModule||"Tasks"==m.searchModule||"Events"==m.searchModule||(m.searchfield="CrmActivity:TAGMODULEREFID")}l.push(m)}return s?null:(t>3&&alert(I18n.getMsg("crm.smartfilter.related.module.msg")),o)},crmListView.populateFilters=function(e,t){t||(t=crmListView.getObject());var i=e.filters,s=i.length,a=$("#lv_filter_scroll");if(0!==a.length){for(var r=a.find("#lv_email_status"),l=r.find("#anyEmailStatus"),o=$("#historyTrackedPickList_duration"),n=0;n<s;n++){var c=i[n],d=c.searchfieldtype,m=c.searchfield,u=m.split(":"),p=m.indexOf("TOUCHED")>-1||m.indexOf("RECORDACTION")>-1;u=u&&u.length>=5||p?u[0]+":"+u[1]:m;var f=c.condition;if("MXN"===d&&"Users"===c.searchModule){d="U";var v=m.replace(":ID","");u=(I=(N=a.find('[data-sysrefname="'+v+'"]')).closest(".filterContainBox")).closest(".filterContainBox").find('input[type="checkbox"]').data("value"),c.ovalue=c.ovalue?c.ovalue:c.value;for(var g=$.parseJSON(c.ovalue),h=g.length,w=0;w<h;w++)0==w?oe=g[w].id:oe+=","+g[w].id}if("EMA"===d){var C=(_=m.split(":"))[2],b=-1!==(m=_.splice(0,2).join(":")).indexOf("LAST_SENT_TIME")?"SENT":C,V=a.find("#emailCondition"),I="NOTSENT"===b?a.find("#sub_NOTSENT"):$("#lv_email_date");V.find('option[value="'+b+'"]').prop("selected",!0),V.trigger("onchange"),I.closest(".filterContainBox").find('input[type="checkbox"]').prop("checked","checked").trigger("onchange");var O=r.find('input[data-value="'+C+'"]');O.length?O.trigger("click"):"SENT"===C&&l.trigger("click")}else if("SMA"===d){var _,T=(_=m.split(":"))[1];C=_[2];if(_.length>3)var L=_[3],y=_[4];b=-1!==(m=_.splice(0,2).join(":")).indexOf("POSITIVE")?"POSITIVE":T,V=a.find("#emailSentimentCondition"),I=$("#lv_email_sentiment_date");if(V.find('option[value="'+b+'"]').prop("selected",!0),V.trigger("onchange"),I.closest(".filterContainBox").find('input[type="checkbox"]').prop("checked","checked").trigger("onchange"),"COUNT"!==C||L||y){var E=a.find("#lv_email_sentiment_status").find('input[data-value="'+C+'"]');if(E.trigger("click"),L&&y){var S=E.closest("ul").closest("li");S.find("#ageindays1").val(y),S.find("#sub_Sentiment_1New").find('option[value="'+L+'"]').prop("selected",!0)}}}else if("CAM"===d){if("Campaigns:CAMPAIGNID"!=m){var M=c.value.split(",");CustomView.showOrHideMemberStatusDiv(!0),$("#camp_member_status_sel").val(M).trigger("change");continue}var k=$("#campaign_name_select"),A=JSON.parse(c.value);CustomView.populateSelectedCampaignNames(A),(I=k.closest(".filterContainBox")).closest(".filterContainBox").find('input[type="checkbox"][data-name="Campaigns"]').prop("checked","checked").trigger("onchange")}else if("MXN"===d){v=m.replace(":ID","")+"_select";var N=$("#"+v),D=!0;try{$.parseJSON(c.value)}catch(e){D=!1}if(D){var P=JSON.parse(c.value);CustomView.populateSelectedMxNNames(P,v)}else CustomView.populateSelectedMxNNames([],v);(I=N.closest(".filterContainBox")).find(".filterCondition").val(f).trigger("onchange"),I.closest(".filterContainBox").find('input[type="checkbox"]').prop("checked","checked").trigger("onchange")}else if("PRE"===d){if((I=$(".predictionMain."+m)).attr("checked","checked").trigger("onchange"),I.closest(".filterContainBox").find('input[type="checkbox"]').prop("checked",!0).trigger("onchange"),"PREWIN"===m)$("#predWinSel").val(c.value).change();else if("PRESCORE"===m)$(".filterCondition.predictionScore option[value="+c.condition+"]").prop("selected",!0),$(".predFilterVal.predictionScore").val(c.value);else if("PREFOCUS"===m){$(".predSubFilter.PREFOCUS input").prop("checked",!1);var x=c.value.split(",");for(n=0;n<x.length;n++)$('.predSubFilter.PREFOCUS input[value="'+x[n]+'"]').prop("checked",!0)}else if("PREGONEUP"===m||"PREGONEDOWN"===m){var R=$(".predSubFilter."+m),F=c.value.split(",");1==F.length?R.find("input.trendLast3").prop("checked",!0):(R.find("input.trendLastN").prop("checked",!0),R.find(".predFilterVal.ageindays").val(F[0]),R.find("select.predFilterVal.period").val(F[1]).change())}}else if("REC"===d){if((I=a.find('[data-name="Recommendation"]')).prop("checked","checked").trigger("onchange"),$("#recommendation_type").val(m.split(":")[1]).trigger("onchange"),void 0!==(K=JSON.parse(c.value)).selected_products&&($("#product_choose").val("selected").trigger("onchange"),CustomView.populateSelectedMxNNames(K.selected_products,"recommendation_select")),void 0!==K.rebuy_options){var j=K.rebuy_options;$("#rebuy_select").val(j.option).trigger("onchange"),"custom"===j.option&&$("#rec_searchdate").val(j.custom_date)}void 0!==K.in_fields&&CustomView.populateSelectedMxNNames(K.in_fields,"recommendation_select_2")}else if("LPRE"===d){(I=$('.leadPreFilter[data-value="'+m+'"]')).attr("checked","checked").trigger("onchange");var U=$('.leadPreFilter[data-value="'+m+'"]').attr("id");if("LPCON"==m){R=$("#sub_"+U).find('input[type="radio"]');$(':radio[name="lead_Convert_radio"][value="'+c.value+'"]').prop("checked",!0)}else if("LPRFOC"==m){R=$("#sub_"+U).find("input[type='checkbox']");var B=c.value.split(",");for(n=0;n<B.length;n++)R.filter('input[name="'+B[n]+'"]').prop("checked",!0)}else if("LPSCR"==m){$("#sub_"+U).find("select").val(c.condition).change();for(R=$("#sub_"+U).find('input[type="text"]'),B=c.value.split(","),n=0;n<B.length;n++)$(R[n]).val(B[n]).change()}else if("LPREC"==m){B=c.value.split(","),R=$("#sub_"+U);var H=$(R).find("select");H.eq(0).val(B[0]).change(),B.length>2?(R.find('input[type="radio"]').eq(0).prop("checked",!0),R.find('input[type="text"]').val(B[1]),H.eq(1).val(B[2]).change()):R.find('input[type="radio"]').eq(1).prop("checked",!0)}}else{if(-1!==m.indexOf("OVERDUE")){var Y=m.split(":")[0];u=m=m.split(":")[1]}if("tag"==d&&-1!=u.indexOf("CrmActivity")){var z=c.searchModule;"Activities"==z&&(z=crmListView.getActivitySubModule(c.value,z,i)),"Calls"==z?(u="CrmCall:TAGMODULEREFID",m="CrmCall:TAGMODULEREFID"):"Tasks"==z?(u="CrmTask:TAGMODULEREFID",m="CrmTask:TAGMODULEREFID"):"Events"==z&&(u="CrmEvent:TAGMODULEREFID",m="CrmEvent:TAGMODULEREFID")}var J=!1;if(!(R=a.find('[data-value="'+u+'"]')).length){if(!(R=a.find('.rfmTop[rfmdetails="'+u+'"]')).length)continue;J=!0}I=null;var q=null;if(J)q=(I=R.closest(".filterContainBox")).closest(".filterContainBox").find('input[type="checkbox"]');else I="checkbox"===R.attr("type")?R.closest(".filterContainBox"):R.closest("li");if("OVERDUE"===m)I.find("select").val(Y),R.attr("data-params",JSON.stringify(c));else if("true"===R.attr("data-subFilters")){var W=$("#sub_"+R.attr("id"));I=W,W.find('[data-value="'+f+'"]').length&&(I=W.find('[data-value="'+f+'"]').click())}else if(p){if(m.indexOf("RECORDACTION")>-1){I.find("#actionType").val(m.split(":")[2]);var G=m.split(":")[3]}else G=m.split(":")[2];I.find("#touchSource").val(G)}J?q.not(".rfmFilter").prop("checked","checked").trigger("onchange"):I.closest(".filterContainBox").find('input[type="checkbox"]').prop("checked","checked").trigger("onchange"),R.attr("name")&&-1!==R.attr("name").indexOf("sub_")&&R.closest("li").find('input[type="radio"]').click(),R.prop("checked")||J||R.prop("checked","checked").trigger("onchange")}if(I.find(".filterCondition").length){J?(R.find(".rfmFilter").prop("checked","checked").trigger("onchange"),R.find(".filterCondition").val(f).trigger("onchange")):(I.find(".filterCondition").closest("div").prev('input[type="radio"]').click(),I.find(".filterCondition").val(f).trigger("onchange"));var K=c.value+"",Z=I.find(".filterValue");if(!K||-1===K.indexOf("${LASTAGE")&&-1===K.indexOf("${AGE"))if("N"==d||14!=f&&15!=f)if("N"!=d||14!=f&&15!=f){if(!Search.defaultFilters.contains(f)&&!Search.bounceDefaultFilters.contains(f)){if("searchdate"==Z.attr("id"))try{K=CrmDateUtils.convertDateToUserPattern(CrmDateUtils.getDateObjectFromString(K,"YYYY-MM-DD"))}catch(e){murphy.error(e)}Z.hasClass("historyTrackerFilterVal")?(c.trackerOption&&""!==c.trackerOption&&"duration"===c.trackerOption?(o.prop("checked",!0),$("#histTrackDurationDays").val(c.trackerOptionDays),$("#historyTracker_duration_cond").val(c.trackerOptionCond)):o.prop("checked",""),Z.val(K)):J?R.find(".filterValue").val(K):I.find(".filterValue").val(K)}}else if(J){R.find(".betweenCrt").show();var X="readonly",Q="filterValue";R.find("#fromnum").show().removeAttr(X).val(K.split(",")[0]).addClass(Q),R.find("#tonum").show().removeAttr(X).val(K.split(",")[1]).addClass(Q)}else I.find(".betweenCrt").show(),I.find("#fromnum").show().removeAttr("readonly").val(K.split(",")[0]).addClass("filterValue"),I.find("#tonum").show().removeAttr("readonly").val(K.split(",")[1]).addClass("filterValue");else{I.find(".betweenCrt").show();var ee=K.split(",")[0],te=K.split(",")[1];try{ee=CrmDateUtils.convertDateToUserPattern(CrmDateUtils.getDateObjectFromString(ee,"YYYY-MM-DD")),te=CrmDateUtils.convertDateToUserPattern(CrmDateUtils.getDateObjectFromString(te,"YYYY-MM-DD"))}catch(e){murphy.error(e)}I.find("#fromdate").removeAttr("readonly").val(ee).addClass("filterValue").show(),I.find("#todate").removeAttr("readonly").val(te).addClass("filterValue").show()}else{if(0===I.find(".filterValue").find('option[value="'+K+'"]').length){f===Search.dueCrt&&(K=K.replace("+","").replace("${","${LAST"));var ie=-1!==(K=K.split("}")[0]).indexOf("${LASTAGEIN")?K.lastIndexOf("S")+1:K.lastIndexOf("E")+1;I.find(".filterValue").next("#selDays").find("select").val(K.substring(0,ie)),K=K.substr(ie)}Z.val(K)}if("picklist"===d||"B"===d){var se="1_"+Z.attr("name").split("_")[1],ae="B"===d?"booleancondition1_"+Z.attr("name").split("_")[1]:"textpicklistcondition1_"+Z.attr("name").split("_")[1],re='select[id="';"picklist"===d?Search.checkEmptyCdn($(re+ae+'"]')[0],void 0,void 0,void 0,m,c?c.searchModule:void 0):$('select[id="searchboolean'+se+'"]').val(K).trigger("change.select2")}else if("L"===d){ae="textlayoutcondition1_"+Z.attr("name").split("_")[1];Search.checkEmptyCdn($('select[id="'+ae+'"]')[0],void 0,void 0,void 0,m)}else if("W"===d){ae="textwizardcondition1_"+Z.attr("name").split("_")[1];Search.checkEmptyCdn($('select[id="'+ae+'"]')[0],void 0,void 0,void 0,m)}else if("tag"===d){ae="texttagcondition1_"+Z.attr("name").split("_")[1];Search.checkEmptyCdn($('select[id="'+ae+'"]')[0],void 0,void 0,void 0,m)}else if("U"===d){var le=Z.attr("id"),oe=[],ne=!0;try{var ce=$.parseJSON(c.value)}catch(e){ne=!1}if(ne&&!ce.length&&(ne=!1),ne)for(h=ce.length,w=0;w<h;w++)0==w?oe=ce[w].id:oe+=","+ce[w].id;else oe=K;Search.populateUserConditionValues(oe,e["temp_searchuser"+n],$("#temp_"+le))}else"T"===d&&-1!==m.indexOf("CrmActivity:ACTIVITYTYPE")&&I.find("#actcondition").val(K.split(",")).trigger("change.select2")}var de=I.closest(".filterContainBox").find('input[type="checkbox"]').eq(0).attr("id").split("_")[1];t.filterDispIndex=de&&parseInt(de)>t.filterDispIndex?++t.filterDispIndex:t.filterDispIndex}s?($("#lv_left_filter").find("#clearFilterLink").show(),$("#lv_filter_submit").prop("disabled",!0),customViewObject.filterId,setTimeout((function(){$L("#lv_filter_scroll").scrollTo(a.find("input.checkFilter:checked").eq(0).closest(".filterContainBox"))}),100)):$("#lv_filter_submitdiv").css("visibility","hidden")}},crmListView.validateFilterValue=function(e,t,i,s){var a=i||e.value,r=$(e).attr("data-fieldlabel");if("rec_searchdate"===e.id)return!(!Search.defaultFilters.contains(a)&&!CrmDateUtils.dateValidate("searchdate",r||I18n.getMsg("Date"),"OTH","lv_left_filter",e))||(e.focus(),!1);if("searchdate"===e.id&&!Search.defaultFilters.contains(a)&&!CrmDateUtils.dateValidate("searchdate",r||I18n.getMsg("Date"),"OTH","lv_left_filter",e))return e.focus(),!1;if("fromdate"!==e.id||Search.defaultFilters.contains(a)){if("ageindays"===e.id&&(!a||/\D/.test(a)||a.length>4)){var l=I18n.getMsg(a?"crm.mb.field.common.splc":"crm.mb.field.common.empt");return a&&a.length>4&&(l=I18n.getMsg("crm.mb.field.common.lenp",4)),alert(l),e.focus(),!1}if("N"!==t.searchfieldtype&&"RFM_score"!==t.searchfieldtype||"fromnum"==e.id)if("N"!==t.searchfieldtype&&"RFM_score"!==t.searchfieldtype||"fromnum"!==e.id){if("L"===t.searchfieldtype||"U"===t.searchfieldtype||"W"===t.searchfieldtype||"picklist"===t.searchfieldtype||"T"===t.searchfieldtype||"B"===t.searchfieldtype||"ActivityType"===t.searchfieldtype){if(!a)return alert(I18n.getValueForFields("crm.field.valid.check",r)),e.focus(),!1;if("U"!==t.searchfieldtype&&a.replace(/^\s+/g,"").replace(/\s+$/g,"").indexOf("*")>-1)return alert(I18n.getMsg("crm.alert.character.not.allowed",["*"])),e.focus(),!1}else if("tag"===t.searchfieldtype&&!a&&null!=s&&!s)return("Events"==t.searchModule||"Calls"==t.searchModule||"Tasks"==t.searchModule)&&$("#filter_activityTag").length>0&&0==$("#filter_activityTag:checked").length||(alert(I18n.getMsg("crm.tag.customview.filter.select.one.tag")),e.focus(),!1)}else{n=a.split(","),o=/^-?\d+(,(\d)+)*(\.\d{1,2})*$/;if(!Search.defaultFilters.contains(n[0])&&(isNaN(n[0])||!o.test(n[0])))return alert(I18n.getValueForFields("crm.field.valid.check",r)),e.focus(),!1;if(!Search.defaultFilters.contains(n[1])&&(isNaN(n[1])||!o.test(n[1])))return alert(I18n.getValueForFields("crm.field.valid.check",r)),$(e).parent().find("#tonum").focus(),!1;if(!commonUtils.compareNumber(n[0].replace(/^\s+/g,"").replace(/\s+$/g,""),n[1].replace(/^\s+/g,"").replace(/\s+$/g,"")))return e.focus(),renderingUtils.showCustomAlert(I18n.getMsg("crm.custom.field.less.than.to"),void 0,!0),!1}else{a=a.replace(/^\s+/g,"").replace(/\s+$/g,"");var o=/^-?\d+(,(\d)+)*(\.\d{1,2})*$/;if(!Search.defaultFilters.contains(a)&&(isNaN(a)||!o.test(a)))return alert(I18n.getValueForFields("crm.field.valid.check",r)),e.focus(),!1}}else{var n=a.split(",");if(!CrmDateUtils.dateValidate("fromdate",r||I18n.getMsg("Date"),"OTH","lv_left_filter",e))return e.focus(),!1;if(!CrmDateUtils.dateValidate("todate",r||I18n.getMsg("Date"),"OTH","lv_left_filter",$(e).next().next()[0]))return $(e).next().next()[0].focus(),!1;var c=new Date(n[0]),d=new Date(n[1]);if(!Utils.compareDate(c,d)){var m="'"+I18n.getMsg("workflow.option.webhookFailure.fromDate")+"'",u="'"+I18n.getMsg("workflow.option.webhookFailure.toDate")+"'";return renderingUtils.showCustomAlert(I18n.getMsg("crm.custom.field.less.than.equalto",[m,u]),void 0,!0),e.focus(),!1}}return!0},crmListView.isNewFilter=function(e,t){if(!e)return 0!==t.length;var i=e.length;if(i!==t.length)return!0;for(var s=0;s<i;s++){var a=e[s],r=t[s];for(var l in r)if(r[l]!=a[l])return!0}return!1},crmListView.setViewProps=function(e,t){e.hasOwnProperty("isStageView")?t.stageView=e.isStageView:t.stageView=!1,e.hasOwnProperty("isPredictView")?t.predictview=e.isPredictView:t.predictview=!1,e.hasOwnProperty("normListView")?t.normListView=e.normListView:t.stageView||t.predictview?t.normListView=!1:t.normListView=!0,e.hasOwnProperty("isCustomizedView")&&(t.normListView=!1,t.predictview=!1,t.stageView=!1,t.view="customisedview")},crmListView.submitFilters=function(e){var t=crmListView.getObject(),i={module:t.module,fetchOnlyBody:"true"};if(customViewObject.isPrivacyListView&&(i.module=t.module.replace("privacy_",""),i.privacyDetails=customViewObject.privacyDetails),e?(crmListView.setFiltersToDefaultState(),$("#lv_filter_hide").show(),delete t.filterId,$(".filter_listcontent").removeClass("f_listclick-view"),crmListView.setViewProps(t,i)):($("#lv_filter_hide").hide(),i.isFilterApplied=!0,crmListView.setViewProps(t,i)),crmListView.getAdvSearchCrtFromCVObject(i),delete i.filters,i.latlong=$("#latlong").val(),void 0!==$("#km")?i.meter=$("#km").val():i.meter=$("#meter").val(),crmListView.getFilterParams(i,!0,e),null===i.filters&&!i.filterSearch)return!1;if(!e)if(t.filterId||$("#lv_saved_filters").find(".f_listclick-view").attr("id")){if(!i.filters)return alert(I18n.getMsg("crm.warning.select.filter")),!1;crmListView.toggleFilterOptions(!0,t.savedFilters.length<5,!0)}else i.filters&&t.savedFilters.length<5&&!Crm.userDetails.CLIENT_ACCOUNT&&crmListView.toggleFilterOptions(!0);if("All Portals"==t.portalName?i.allPortals=!0:(i.portalName=t.portalName,i.allPortals=!1),i.filters&&JSON.parse(i.filters).length>0?$("#lv_left_filter").find("#clearFilterLink").show():($("#lv_left_filter").find("#clearFilterLink").hide(),$("#lv_filter_hide").show()),Crm.userDetails.RTL_ENABLED||$("#listviewtablescroll").scrollLeft(0),$("#lv_filter_submit").prop("disabled",!0),t.isStageView&&1==t.isStageView&&t.layoutId&&"0"!=t.layoutId&&(i.layoutId=t.layoutId),customViewObject.isCampaignAddMemberListView)return e&&(customViewObject.filters=[]),CrmCampaignInteg.applyFilters(i),!1;if(i.clearCache=!0,customViewObject.isPrivacyListView)return e&&(customViewObject.filters=[]),CrmPrivacyDashboard.applyFilters(i),!1;delete i.filterSearch,i.cvid=t.cvId;var s=void 0;i.filters&&(s=i.filters,JSON.parse(i.filters).length>0&&!customViewObject.isPrivacyListView&&(customViewObject.showSelectAll=!1));var a=Lyte.Router.getRouteInstance().transition.info.route;"crm.tab.module.custom-view.canvas"===a?Lyte.Router.transitionTo({route:a,dynamicParams:[t.module,t.cvId,t.viewid],queryParams:{filters:s}}).data=i:Lyte.Router.transitionTo({route:a,dynamicParams:[t.module,t.cvId],queryParams:{filters:s}}).data=i;return!1},crmListView.setFiltersToDefaultState=function(){var e=$("#lv_left_filter").find("input.checkFilter:checked"),t=e.closest(".filterContainBox");t.find('input[type="radio"]:checked').prop("checked",!1),t.find(".filterCondition").find("option:selected").prop("selected",!1),t.find(".filterCondition:visible").trigger("change"),t.find("#filter_activityTag")&&(t.find("#filter_activityTag").trigger("click"),$("#ActivityTag").find("input.checkFilter").each((function(){$(this).prop("selected",!1)}))),t.find(".filterValue").length&&(t.find("input.filterValue").each((function(){var e=$(this).data("defvalue")?$(this).data("defvalue"):"";$(this).val(e);var t=$(this).attr("id");t&&-1!==t.indexOf("searchuser")&&$("#temp_"+t).find("li").remove();var i=$(this).attr("name");!i||-1==i.indexOf("searchpicklist")&&-1==i.indexOf("searchboolean")&&-1==i.indexOf("searchtag")||$("#"+i).find("option:selected").prop("selected",!1).trigger("change.select2")})),t.find("select.filterValue").each((function(){$(this).find("option:selected").prop("selected",!1).trigger("change.select2")}))),e.click(),$("#lv_filter_submitdiv").css("visibility","hidden"),$("#lv_filter_submit").val(I18n.getMsg("crm.button.apply.filter")),$L("#lv_filter_scroll").scrollTop(0)},crmListView.getFilterParams=function(e,t,i){i=null!=i&&i;var s=Lyte.Router.getRouteInstance(),a=crmListView.getObject(),r={};if(a&&e.module===a.module){if(a.filters)(r=a.filters).constructor==Object&&("kanban"!=s.routeName&&"canvas"!=s.routeName&&"zia"!=s.routeName||(e.isNewFilter=!0),e.filters=JSON.stringify(r));if(a.cross_filters&&(e.isNewFilter=!0,e.cross_filters=JSON.stringify(a.cross_filters)),t&&$("#lv_left_filter").length){var l=crmListView.formFilterConditions(i);if(null==l)return void(e.filters=null);var o=l.filters;if(!crmListView.isNewFilter(r,o))return void(e.filters=null);a.filterId&&(l.filterId=a.filterId),crmTab.putFiltersInCache(e.module,l),r=o,e.filterSearch=!0}if(r&&r.length>0&&(e.filters=JSON.stringify(r),"kanban"!=s.routeName&&"canvas"!=s.routeName&&"zia"!=s.routeName||(e.isNewFilter=!0)),a.filter_id&&!a.filters&&!a.cross_filters&&("kanban"==s.routeName||"canvas"==s.routeName||"zia"==s.routeName)){var n=store.peekRecord("filter",a.filter_id);n.criteria&&(e.isNewFilter=!0,e.filters=JSON.stringify(n.criteria)),n.cross_filters&&(e.isNewFilter=!0,e.cross_filters=JSON.stringify(n.cross_filters))}}},crmListView.updateUpComingActions=function(e){"object"!=typeof e&&(e=JSON.parse(e));var t=Lyte.Router.getRouteInstance();if("kanban"===t.routeName||$L("crm-kanbanview-component")[0])return Lyte.triggerEvent("updateIcons",e),void Lyte.triggerEvent("clearSelection");var i=crmListView.getObject();if(i.upComingActionsJson=e,"list"!==t.routeName||!customViewObject.fromLyte){var s=i.isStageView||i.isPredictView?"#detailView_":"#";for(var a in e){var r=e[a],l=$(s+a).find("#upComingActionstd");if(i.isStageView)l.next("#sv_act_create_div").remove(),$(l).html(crmListView.svUpComingActionTemplate(r)).show(),l.find("span").attr("onmouseout","crmui.hideTooltip()");else if(i.isPredictView)for(var o=i.stageIdsArr[0],n=0;n<o.length;n++)l=$("#data-container_"+o[n]+"_inner").find(s+a).find("#upComingActionstd"),crmListView.svUpActionTemplate(l,r);else customViewObject.fromLyte||$(l).html(crmListView.upComingActionTemplate(r)).show()}customViewObject.fromLyte||($(".setTdBorBtm").css("background-color",""),renderingUtils.tableSorter("listViewTable","2",""),crmListView.createTableHeader())}},crmListView.svUpActionTemplate=function(e,t){e.next("#sv_act_create_div").remove(),$(e).html(crmListView.svUpComingActionTemplate(t)).show(),e.find("span").attr("onmouseout","crmui.hideTooltip()")},crmListView.refreshRecords=function(e){var t=crmListView.getObject();if(t.isStageView){e||(e=$("#stageView_create_act").find("lyte-menu-item").attr("data-relid"));var i=$L("#detailView_"+e).closest("lyte-board")[0].getData("ltPropBoardDetail");crmListView.refreshStageBoards(i)}else{var s={module:t.module,calleeObj:"crmTab",clickId:"tab",fetchOnlyBody:"true",filterSearch:!0};crmListView.getAdvSearchCrtFromCVObject(s),"list"===Lyte.Router.getRouteInstance().routeName&&(store.unloadAll(moduleRecordMapping[Lyte.Router.getRouteInstance().currentModel.module].id),Lyte.Router.getRouteInstance().refresh())}},crmListView.showSearchBarSF=function(e){$(e).hide(),$("#lv_filter_srchdiv").show(),$("#lv_filter_srchdiv #lv_filter_srch_input").focus()},crmListView.clearSearchResults=function(e){sE(event),0==$("#lv_filter_srch_input").val().length&&($(e).hide(),$("#lv_filter_srchdiv").hide(),$("#lv_filter_search").show(),$("#lv_filter_scroll .filterContainBox").show(),$("#lv_filter_caption").show(),$("#lv_filter_srchIcon").show()),$("#lv_filter_srch_input").val("").focus().trigger("keyup")},crmListView.applyRandomColorForStages=function(){for(var e=$("#stageViewContainer"),t=e.find(".sv_each_stage"),i=t.length,s=0;s<i;s++){var a=s%15;t.eq(s).addClass("randomcolor_"+a)}e.removeClass("kanban_revamp_mono_theme")},crmListView.clearStageSelectionNew=function(){for(var e=$("#stageViewContainer").find(".sv-stage-card-selected"),t=e.length,i=0;i<t;i++){e.eq(i).removeClass("sv-stage-card-selected")}},crmListView.showHideNoResult=function(e,t){(t=t||$("#values_"+e)).find(".sv-stage-card").length>0?$("#noRecordsCont_"+e).hide():$("#noRecordsCont_"+e).show()},crmListView.toggleText=function(e,t,i,s){var a,r;if(e){var l=s.length>170;return r=l?$ESAPI.encoder().encodeForHTML(s.substring(0,170)):$ESAPI.encoder().encodeForHTML(s),r=l?r+'... <a class="kv_showMoreLink" onclick="crmListView.toggleText(false, true, this)">'+I18n.getMsg("crm.wf.summary.label.ShowInstantActions")+"</a>":r,a='<span class="more_desc" data-value="'+$ESAPI.encoder().encodeForHTMLAttribute(s)+"\"><pre style='word-wrap: break-word; white-space:pre-wrap; font-size: 15px; color: var(--baseColor); line-height: 1.33'>"+r+"</pre></span>"}var o=$(i).closest(".more_desc");s=o.data("value"),a=t?(r=$ESAPI.encoder().encodeForHTML(s))+'<a class="kv_showMoreLink" onclick="crmListView.toggleText(false, false, this)">'+I18n.getMsg("crm.wf.summary.label.HideInstantActions")+"</a>":(r=$ESAPI.encoder().encodeForHTML(s.substring(0,170)))+'... <a class="kv_showMoreLink" onclick="crmListView.toggleText(false, true, this)">'+I18n.getMsg("crm.wf.summary.label.ShowInstantActions")+"</a>",o.find("pre").html(a)},crmListView.calculateStageWidth=function(){var e=customViewObject.stageSize,t=(customViewObject.module_info.filter_status?window.innerWidth-301:window.innerWidth)-20;return 320*e>=t?320:t/e},crmListView.setWHforStageView=function(){thirdPartyUtils.bindSelect2("#svEditSetting .newChosenSel select",{width_auto:!0});var e=$("#sv_stage_inner_parent");if(e.length){var t=window.innerWidth,i=window.innerHeight,s="0",a=document.getElementById("lv_left_filter"),r=a?a.style.display:"";"block"!=r&&""!=r||(s="301");var l=customViewObject.displayFilters?s:0;null==renderingUtils.listviewTable&&(renderingUtils.listviewTable=document.getElementById("cvpadding").offsetTop+67);var o=e.offset().top,n=crmListView.calculateStageWidth();getElemById("sv_stage_inner_parent").style.width=t-l+"px",getElemById("lv_stageview").style.height=i-(o+48)+"px";document.getElementsByClassName("sv_each_stage"),parseInt($("#svEditSetting").outerHeight());var c=i-(o+48);$(".stageview-heading-container").height();getElemById("sv_stage_inner_parent").style.height=c+"px",getElemById("stageViewContainer").style.width=customViewObject.stageSize*n+5+"px",getElemById("stageViewContainer_parent").style.width=customViewObject.stageSize*n+5+"px";var d=c-parseInt($(".stageview-heading-container").outerHeight());$(".sv_each_stage").css({width:n+"px",height:c+"px"}),$(".sv_each_stage:first-child").css({width:n+5+"px"}),$(".sv_each_stage .sv-stage-card").css({width:n-20+"px"});var m=$(".stageview-data-container");m.css("height",d-10+"px"),m.children("div").css("min-height",d-10+"px"),$(".sv_acceptable").css("min-height",d-50+"px"),getElemById("stageViewContainer_parent").style.height=c+"px",localStorage.setItem("dealKanbanViewData","Viewed"),"Viewed"==localStorage.getItem("dealKanbanViewData")?$(".taskKanbanViewDeactive:after").hide():$(".taskKanbanViewDeactive:after").show()}},crmListView.showActivityDetails=function(e,t,i,s){var a=$("#actDetailsDiv").length?$("#actDetailsDiv"):$("#idForCV").append('<div id="actDetailsDiv" class="newPopup pL10 pR10 pT4 pB2" onmouseout="$(this).hide().html(\'\');" onmouseover="$(this).stop().show();"></div>').find("#actDetailsDiv"),r=(e=$(e)).offset();r.left,r.top;if(customViewObject.isStageView)l=Crm.isActivitySplitDone?'<div class="sv-tooltip" id="tooltip_'+t+'"><link-to lt-prop-target="_blank" lt-prop-class="crm-extra-small-font-size crmWhiteColor" lt-prop-route="crm.tab.module.entity" lt-prop-dp=["'+s+'","'+t+'"]>'+$ESAPI.encoder().encodeForHTML(i)+"</link-to></div>":'<div class="sv-tooltip" id="tooltip_'+t+'"><link-to lt-prop-target="_blank" lt-prop-class="crm-extra-small-font-size crmWhiteColor" lt-prop-route="crm.tab.module.entity" lt-prop-dp=["Activities","'+t+'"] lt-prop-qp=\'{"sub_module" : "'+s+"\"}'>"+$ESAPI.encoder().encodeForHTML(i)+"</link-to></div>";else{var l='<div><link-to lt-prop-target="_blank" lt-prop-class="crm-small-font-size crmWhiteColor" lt-prop-route="crm.tab.module.entity" ';Crm.isActivitySplitDone?l+='lt-prop-dp=["'+s+'","'+t+'"]>':l+='lt-prop-dp=["Activities","'+t+'"] lt-prop-qp={"sub_module":"'+s+'"}>',l+=$ESAPI.encoder().encodeForHTML(i)+"</link-to></div>",a.html(l)}crmui.showTooltip({content:l,isHTML:!0,position:"center"}),e.off("click").on("click",(function(){if($("#actDetailsDiv").find("a")[0])$("#actDetailsDiv").find("a")[0].click();else{var t=JSON.parse(e.attr("data-params"));t&&$("#tooltip_"+t.activityId).find("a")[0]&&$("#tooltip_"+t.activityId).find("a")[0].click()}return!1}))},crmListView.bindPerfectScrollbar=function(){var e=$("#lv_filter_scroll"),t=$("#lv_filter_scroll").offset().top+$("#lv_left_filter .lv_filter_options:visible").outerHeight();if($("#lv_filter_scroll").length&&!$("#lv_filter_scroll").parent("#intelConfigFltrsDiv").length){if(thirdPartyUtils.unbindPerfectScroll("#lv_filter_scroll"),"absolute"===$("#lv_left_filter").css("position"))$("#lv_filter_scroll").css({height:$(window).height()-t});else{if(customViewObject.isKanbanView)var i=t;else i=t;$("#lv_filter_scroll").css({height:$(window).height()-i})}e.hasClass("cxSmartFilterScrollElem")||thirdPartyUtils.bindPerfectScroll("#lv_filter_scroll",{wheelSpeed:1,preventOnEnd:!0,preventHorizontal:!1}),e.addClass("oH")}},crmListView.reorderFiltersForCV=function(e){var t=$("#lv_left_filter");if(t.length){var i=e.heading,s=(i.length,$('input[data-cm="true"].checkFilter').length+$('input[data-trackingFilter="true"].checkFilter').length);if(customViewObject.module&&CrmTags.doListViewOperations(),e.filterDispIndex=i.length+s-1,e.isVTAdvFilterAvailable){var a=$('<div id="vtFieldOuterDiv"><div id="vtHeadDiv" class="lvDivSubHead"><span class="ld-filter-span fL">'+I18n.getMsg("crm.website.activity")+'</span><div class="cBoth"></div></div> <div id="vtFieldDiv"> </div><div class=" mL15"><span class="vt-filter-more crm-extra-small-font-size cP pR dIB" id="vtMoreSpan" style="display:none">'+I18n.getMsg("crm.general.label.more")+'</span><div class="vt-filter-sep mL0" style="display:none"></div></div></div>');s=$('input[data-cm="true"].checkFilter').length+$('input[data-trackingFilter="true"].checkFilter').length,a.insertBefore(t.find(".filterContainBox").eq(s)),$("#lv_filter_scroll .vtColumn").each((function(){0==$(this).find("input.checkFilter:checked").length&&$(this).detach().appendTo("#vtFieldDiv")}))}}},crmListView.loadStageBoards=function(e){for(var t in e){var i=e[t],s=$("#values_"+t);if(s.length){i.smartFilterSupported=crmListView.isSmartFilterSupportedModule(customViewObject.module),i.selectedIds=customViewObject.selectedIds,s.html(Handlebars.templates.stageCard(i)),crmListView.checkAll(t),crmListView.showHideNoResult(t,s),delete i.selectedIds;var a=$("#data-container_"+t),r=JSON.parse(a.attr("data-params"));r.noOfRecords=r.noOfRecords?parseInt(r.noOfRecords)+i.body.length:i.body.length,a.attr("data-params",JSON.stringify(r)),a.attr("data-loaded","true")}}},crmListView.loadMoreStageBoardsAfterRender=function(){var e=$("#stageViewContainer").find('div.stageview-data-container[data-loaded = "false"]:visible').eq(0);if(0!==e.length){var t=e.data()?e.data().params.stageId:void 0;if(t){var i=$("#"+t),s=i.offset().left;(renderingUtils.windowWidth>s&&s>0||s+i.width()>0)&&crmListView.loadMoreStageBoards()}}else crmListView.setWHforStageView()},crmListView.loadMoreStageBoards=function(){var e=$("#stageView_create_act");if(e.is(":visible")){var t=$L("#manualCallListPopover")[0];t&&t.ltProp({show:!1})}e.trigger("onBeforeClose");var i=$("#stageViewContainer").find('div.stageview-data-container[data-loaded = "false"]:visible'),s=i.length;if(0!=s){for(var a=[],r=0;r<s;r++){var l=i.eq(r),o=l.data()?l.data().params.stageId:void 0,n=l.data()?l.data().index:void 0,c=$("#"+o).offset();if(o&&(renderingUtils.windowWidth>c.left&&c.left>0||renderingUtils.windowWidth>c.right&&c.left>0)){var d=Math.floor(parseInt(n)/4);a=customViewObject.stageIdsArr[d];var m=i.slice(r+1);for(var u of m)if(!!u.dataset.index&&Math.floor(parseInt(u.dataset.index)/4)>d){setTimeout(crmListView.loadMoreStageBoards,0);break}break}}var p=a.length;if(0!=p){for(r=0;r<p;r++)$("#"+a[r]+" .stageview-data-container").attr("data-loaded","loading");var f={module:customViewObject.module,stageId:a.join(";"),fetchOnlyBody:"true",cvid:customViewObject.cvId};0!=customViewObject.layoutId&&(f.layoutId=customViewObject.layoutId),customViewObject.pipeline&&"0"!=customViewObject.pipeline&&(f.pipeline=customViewObject.pipeline),crmListView.getFilterParams(f),crmListView.getAdvSearchCrtFromCVObject(f);var v=new crmRequestPool;$("#sv_stage_inner_parent").addClass("sv_stage_prevent_scroll"),v.initiate({action:Crm.getCrmBasePath()+"/ShowSelectedCustomView.do?",data:f,type:"POST",success:function(e){var t=crmTab.getFromCache(e.module)?crmTab.getFromCache(e.module):customViewObject,i=t.stageBoardDetails;i=$.extend({},i,e.stageBoardDetails),t.stageBoardDetails=i,crmListView.checkForNoneStage(t,!0),crmListView.checkForEmptyStage(t),crmTab.putInCache(e.module,t),crmListView.loadStageBoards(e.stageBoardDetails),$("#sv_stage_inner_parent").removeClass("sv_stage_prevent_scroll"),crmListView.setWHforStageView(),crmListView.bindScrollToStageBoards(),customViewObject.viewSummary&&crmListView.checkStageSummary(a),crmNavig.parseCurrentListView()}})}}else crmListView.setWHforStageView()},crmListView.bindScrollToStageBoard=function(e){e.on("scroll",$L.debounce((function(){var e=$L(this);"true"===e.attr("data-load")&&crmListView.loadMoreStageCards(e);var t=$("#stageView_create_act");if(t.is(":visible")){var i=$L("#manualCallListPopover")[0];i&&i.ltProp({show:!1})}t.trigger("onBeforeClose"),e.data("scrollTimer")&&clearTimeout(e.data("scrollTimer")),e.prev(".stageview-heading-container").addClass("dv_shadow"),e.data("scrollTimer",setTimeout((function(){e.scrollTop()<=10&&e.prev(".stageview-heading-container").removeClass("dv_shadow")}),300))}),250))},crmListView.bindScrollToStageBoards=function(){for(var e=$("#stageViewContainer").find('div.stageview-data-container[scroll-binded != "true"]'),t=e.length,i=0;i<t;i++){var s=e.eq(i),a=JSON.parse(s.attr("data-params"));a.noOfRecords&&(s.attr("scroll-binded","true"),"true"===s.attr("data-scupdate")||a.noOfRecords>crmListView.MAX_STAGECARD_CNT&&a.noOfRecords%crmListView.MAX_STAGECARD_CNT==1?(a.module=customViewObject.module,a.cvId=customViewObject.cvId,a.fromIndex=a.noOfRecords,s.attr("data-params",JSON.stringify(a)),s.attr("data-load","true")):s.attr("data-load","false"),crmListView.bindScrollToStageBoard(s))}setTimeout((function(){customViewObject.isPredictView?$(".stageview-data-container").addClass("prediction_dont_drag"):($(".stageview-data-container.prediction_dont_drag").removeClass("prediction_dont_drag"),crmListView.enableStageCardsSortable())}),1)},crmListView.enableStageCardsSortable=function(){if(Crm.userDetails.permissions["Crm_Implied_Edit_"+customViewObject.module]&&(!customViewObject.isReadOnlyPermission||"UNSUBSCRIBEDMODE"==customViewObject.stageColumn)){crmListView.addListenerToStageCards();var e=!1;$("#stageViewContainer").find(".sv_sortable").sortable({items:".sv-stage-card:not('.sv_approve_wait')",connectWith:".sv_acceptable",placeholder:"ui-state-highlight stagesPlaceHolder",scroll:!0,scrollSensitivity:100,scrollSpeed:10,containment:"#stageViewContainer_parent",cursor:"move",forcePlaceholderSize:!0,revert:!1,helper:function(e,t){var i=$(t).clone(),s=$(t).outerHeight();i.css({position:"absolute",overflow:"hidden"});return s>190&&(s=190,$(this).height(s),i.css({height:s})),i.get(0)},start:function(e,t){$(".stageview-data-container").css("overflow","hidden"),t.item.addClass("sv_sort_element"),$("ul.currsortable").removeClass("currsortable"),t.item.closest("ul").addClass("currsortable")},sort:function(e,t){$(e.target);$("#sv_stage_inner_parent").offset().top>$("#stageViewContainer_parent").offset().top&&$("#sv_stage_inner_parent").animate({scrollTop:0})},over:function(e){var t=$(e.target).closest(".sv_each_stage").find(".noRecordsCont:visible");t.length&&t.hide()},out:function(e){var t=$(e.target).closest(".sv_each_stage");0===t.find(".sv-stage-card:not('.ui-sortable-helper'):visible").length&&t.find(".noRecordsCont").show()},beforeStop:function(t,i){var s=i.item,a=s.attr("id").replace("detailView_",""),r=JSON.parse($("#listView_"+a).parents().eq(0).attr("lt-prop-td")).stageId;s.closest(".sv_each_stage").attr("id")===r?(i.item.removeClass("sv_sort_element"),$(".stageview-data-container").css("overflow","auto"),e=!0):e=!1},update:function(){e&&$(this).sortable("cancel")},stop:function(t,i){if(renderingUtils.zctt.hidett(),e){var s=$(t.target).closest(".sv_each_stage");s.find(".sv-stage-card").length&&s.find(".noRecordsCont").hide()}else{$(".stageview-data-container").css("overflow","auto"),i.item.removeClass("sv_sort_element"),$(".sv_sel_entity").removeClass("sv_sel_entity"),i.item.addClass("sv_sel_entity"),setTimeout((function(){$(".sv_sel_entity").removeClass("sv_sel_entity")}),5e3);var a=i.item,r=a.attr("id").replace("detailView_",""),l=a.closest(".sv_each_stage").attr("id"),o=$("#listView_"+r),n=o.attr("data-params");n||(n=o.parent("link-to").attr("lt-prop-td"));var c=JSON.parse(n).stageId,d=a.data("layout"),m=!1;if("Potentials"===customViewObject.module&&customViewObject.stageBoards){var u=$("div#"+l).attr("name"),p=customViewObject.stageBoards,f=p.length;crmListView.haltStateParams={},crmListView.haltStateParams.curStageId=l,crmListView.haltStateParams.prevStageId=c;for(var v=0;v<f;v++)if(p[v].label===u){if("Closed Won"===p[v].fcType||"Closed Lost"===p[v].fcType)m=!0,(C={module:customViewObject.module,entityId:r,layoutId:d+""})[csrfParamName]=encodeURIComponent(csrfToken),C.onlyEntityDetails=!0,(h=new crmRequestPool).initiate({action:Crm.getCrmBasePath()+"/FormRule.do?action=getLayoutRuleNEntityInfo",data:C,type:"POST",success:function(e){returnJson=$.parseJSON(e.entityInfo),returnJson.module="Potentials",closePotentialFromDV(p[v].probability+":"+u,"kanbanview",!0)},error:function(){m||crmListView.updateStageError(l,c)}});break}}var g=!1;if((void 0===Crm.userDetails.VALIDATIONRULEAVAILABLE||!0===Crm.userDetails.VALIDATIONRULEAVAILABLE&&Crm.userDetails.VRINVOLVEDMODULES.contains(customViewObject.module))&&(g=!0,Crm.VR||(Crm.VR={}),delete Crm.VR.stagePopUp,Crm.VR.ajaxEditFieldLabel=customViewObject.stageColumn),CFRExec&&(void 0===Crm.userDetails.LAYOUTRULEAVAILABLE||!0===Crm.userDetails.LAYOUTRULEAVAILABLE&&Crm.userDetails.LRINVOLVEDMODULES.contains(customViewObject.module)))if(""===d||""!==d&&Crm.userDetails.LRINVOLVEDLAYOUTID.contains(d)){renderingUtils.freezeBackground(),(C={module:customViewObject.module,entityId:r,layoutId:d+""})[csrfParamName]=encodeURIComponent(csrfToken),g&&(C.includeVR=!0);var h=new crmRequestPool,w="";"Potentials"===customViewObject.module&&(w=$(a.parent()[0]).data("probability")),h.initiate({action:Crm.getCrmBasePath()+"/FormRule.do?action=getLayoutRuleNEntityInfo",data:C,type:"POST",success:function(e){if(returnJson=$.parseJSON(e.entityInfo),Crm.validationRuleJSONData[customViewObject.module]=JSON.parse(e.validationRuleJSON),validationUtils.isEmpty(returnJson))return renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error")),void crmListView.updateStageError(l,c);var t=$($("div#"+l)[0]).attr("name");g&&(Crm.VR.entityDetails=JSON.parse(JSON.stringify(returnJson)),CVRExec.storeStageValue(t,customViewObject.stageColumn)),CFRExec.init(e.layoutRuleJSONObj,customViewObject.module,"list");t=$($("div#"+l)[0]).attr("name");if(CFRExec.evalAjaxEditForLayoutRule(customViewObject.module,customViewObject.stageColumn,"Potentials"===customViewObject.module&&"STAGE"===customViewObject.stageColumn?w+":"+t:t)){var i={type:"StageView"};if(i.newStageBoardValue=t,i.valId=l,i.prevStageId=c,"STAGE"!=customViewObject.stageColumn){var s=customViewObject.stageBoards;for(v in s)if(l==s[v].id){l=s[v].label.trim();break}}nparams={module:customViewObject.module,columnName:customViewObject.stageColumn,fieldValue:l,moduleid:r,fieldLabel:customViewObject.stageLabel,type:"StageView"},nparams[csrfParamName]=encodeURIComponent(csrfToken),nparams.check=i,CFRExec.haltStageChange(nparams)}else g?new Promise((function(e){e(crmListView.executeVRForStageDropping(l,r,c))})).then((function(e){e||(renderingUtils.removeFreezeLayer(),CFRExec.haltStageChange({}),m||crmListView.updateStage(r,l,c))})):(renderingUtils.removeFreezeLayer(),CFRExec.haltStageChange({}),m||crmListView.updateStage(r,l,c))},error:function(e){m||crmListView.updateStageError(l,c)}})}else m||crmListView.updateStage(r,l,c);else if(g){var C;renderingUtils.freezeBackground(),(C={module:customViewObject.module,entityId:r,layoutId:d+""})[csrfParamName]=encodeURIComponent(csrfToken),C.onlyEntityDetails=!0,C.includeVR=!0;h=new crmRequestPool,w="";"Potentials"===customViewObject.module&&(w=$(a.parent()[0]).data("probability")),h.initiate({action:Crm.getCrmBasePath()+"/FormRule.do?action=getLayoutRuleNEntityInfo",data:C,type:"POST",success:function(e){returnJson=$.parseJSON(e.entityInfo),Crm.validationRuleJSONData[customViewObject.module]=JSON.parse(e.validationRuleJSON),Crm.VR.entityDetails=JSON.parse(JSON.stringify(returnJson));var t=$($("div#"+l)[0]).attr("name");CVRExec.storeStageValue(t,customViewObject.stageColumn),new Promise((function(e){e(crmListView.executeVRForStageDropping(l,r,c))})).then((function(e){e||(renderingUtils.removeFreezeLayer(),m||crmListView.updateStage(r,l,c))}))},error:function(e){m||crmListView.updateStageError(l,c)}})}else m||crmListView.updateStage(r,l,c);$(".sv_sortable").sortable("refresh"),Utils.detachObjects.push($.ui.ddmanager.current),setTimeout((function(){crmListView.addListenerToStageCards([l,c])}),500)}}}).disableSelection(),"PRICINGMODEL"!=customViewObject.stageColumn&&"UNSUBSCRIBEDMODE"!=customViewObject.stageColumn&&"INTEGRATION_TYPE"!==customViewObject.stageColumn||crmListView.disableSortable()}},crmListView.addListenerToStageCards=function(e){if(e)for(var t=e.length,i=0;i<t;i++)$("#data-container_"+e[i]).find(".sv-stage-card").mousedown((function(){crmListView.mouseDownOnStageCard($(this))}));else $(".sv_sortable").find(".sv-stage-card").mousedown((function(){crmListView.mouseDownOnStageCard($(this))}))},crmListView.mouseDownOnStageCard=function(e){var t=e.attr("data-layout"),i=$("#pipeDropdown"),s=e.attr("data-pipeline");if(t&&"null"!==t)$(".sv_acceptable").removeClass("sv_acceptable"),"STAGE"!==customViewObject.stageColumn||i.hasClass("eventNone")||!s||"null"===s?$('.sv_sortable[data-layouts*="'+t+'"').addClass("sv_acceptable"):$('.sv_sortable[data-layouts*="'+t+'"][data-pipelines*="'+s+'"]').addClass("sv_acceptable");else{var a=$L("#pipelineSelect"),r=!i.hasClass("eventNone")&&a.length?a[0].ltProp("selected"):void 0;r&&"0"==r?($(".sv_acceptable").removeClass("sv_acceptable"),$('.sv_sortable[data-pipelines*="'+s+'"').addClass("sv_acceptable")):r&&"DELETED"==r?$(".sv_acceptable").removeClass("sv_acceptable"):$(".sv_sortable").addClass("sv_acceptable")}},crmListView.enableSortable=function(){if(Crm.userDetails.permissions["Crm_Implied_Edit_"+customViewObject.module]&&!customViewObject.isReadOnlyPermission&&"PRICINGMODEL"!=customViewObject.stageColumn&&"UNSUBSCRIBEDMODE"!=customViewObject.stageColumn&&"INTGERATION_TYPE"!==customViewObject.stageColumn){var e=$("#stageViewContainer");e.find(".sv_sortable").sortable("enable"),e.removeClass("sv-sortable-disabled")}},crmListView.disableSortable=function(){if(Crm.userDetails.permissions["Crm_Implied_Edit_"+customViewObject.module]&&!customViewObject.isReadOnlyPermission){var e=$("#stageViewContainer");e.find(".sv_sortable").sortable("disable"),e.addClass("sv-sortable-disabled")}},crmListView.updateStageSuccess=function(e,t,i,s,a,r,l){commonUtils.showHideLoadingDiv();var o,n="";if("object"!=typeof a&&(a.indexOf("SECURITY::::")>-1||a.indexOf("CRM_ERROR_PAGE_500::::")>-1))alert("Unable to process your request");else{if(a.responseJSON){var c=a.responseJSON;if("MANDATORY_NOT_FOUND"===c.code||c.data&&"MANDATORY_NOT_FOUND"===c.data[0].code)return commonUtils.showErrorMsg(I18n.getMsg("crm.field.valid.check",[cm_fl.data("displaylabel")]),cm_fl),void(itsonview=!0);if("NO_PERMISSION"===c.code||c.data&&"RECORD_IN_BLUEPRINT"===c.data[0].code||c.data&&"MAPPING_MISMATCH"===c.data[0].code||c.data&&"CANNOT_PERFORM_ACTION"===c.data[0].code)return renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error")),void crmListView.updateStageError(i,s);if("Internal Server Error"===c.message||c.data[0].message&&"invalid data"===c.data[0].message)return renderingUtils.displayPermissionDenied(null,null,c.message),void crmListView.updateStageError(i,s);if(c.data&&"NOT_ALLOWED"===c.data[0].code)return void renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.alert.can.not.edit.email"));if("duplicate data"===c.data[0].message){var d={},m=c.data[0].details,u=returnJson.entityMapJson,p="",f="",v=c.data[0].details.api_name;for(var g in u)u[g].sysRefName===v&&(f=u[g].displaylabel,p=u[g].colname);var h=m.duplicate_record;d.FIELDLABEL=f,d.OWNERNAME=h.Owner.name,d.MODULE=t,d.RECORDS={},d.COUNT=m.more_records?2:1,d.ZUID=h.Owner.zuid,delete h.Owner;var w={};w.ENTITYID=h.id,delete h.id;var C=[];if(Object.keys(h).length>1){var b=Crm.userDetails.NAME_FORMAT;b=b.split(",");var V=[];b.forEach((function(e){"Salutation"!==e&&(e=e.replace(" ","_")),h[e]&&V.push(h[e])})),w.ENTITYNAME=V.join(" "),w.ENTITYNAMEFORPOPOVER=V.join(" ")}else for(var I in h)w.ENTITYNAME=h[I],w.ENTITYNAMEFORPOPOVER=h[I];C.push(w),d.RECORDS=C,commonUtils.hideDuplicateErrorMsg("viewentityform"),itsonview=!0;var O=commonUtils.getDuplicateErrorMsg(d,!1);return commonUtils.showErrorMsg(O,$("#Crm_"+t+"_"+p),t),"saveDenied"}if("DUPLICATE_LINKING_DATA"===c.data[0].code){var _=c.data[0].details.duplicate_record,T=_.id,L=_.Name,y=I18n.getMsg("crm.linking.module.duplicate.warning",[$ESAPI.encoder().encodeForHTML(t),$ESAPI.encoder().encodeForHTML(T),$ESAPI.encoder().encodeForHTML(L),$ESAPI.encoder().encodeForHTML(Crm.getCrmBasePath())]);renderingUtils.showCustomAlert(y,"",!0),commonUtils.hideDuplicateErrorMsg("viewentityform"),itsonview=!0}}var E;o=(E=a).data&&"SUCCESS"===E.data[0].code?"true":"false",n=E.outputValue,"true"===o&&(n.includes("##")&&(n=n.split("##")[1]),"Potentials"==customViewObject.module&&"STAGE"==customViewObject.stageColumn||(n=$(".sv_each_stage[name='"+n+"']").attr("id")),("popupsave"===r||l&&l!==i)&&(n=i),(1==$("#"+n).find(".sv-stage-card").length||l&&l!==i)&&($("#"+i+" #checkAll").show(),$("#noRecordsCont_"+i).hide()),l&&l!==i&&1==$("#"+l).find(".sv-stage-card").length&&($("#"+l+" #checkAll").hide(),$("#noRecordsCont_"+l).show()),0==$("#"+s).find(".sv-stage-card").length&&($("#"+s+" #checkAll").hide(),$("#noRecordsCont_"+s).show()),crmListView.updateSummaryOnEdit(e,n,E.data[0].details,l))}},crmListView.updateStageError=function(e,t){$(".currsortable").sortable("cancel");var i=customViewObject.stageBoardDetails[t],s=$("#values_"+t);s.length>0&&(s.html(Handlebars.templates.stageCard(i)),crmListView.showHideNoResult(t)),i=customViewObject.stageBoardDetails[e],(s=$("#values_"+e)).length>0&&(s.html(Handlebars.templates.stageCard(i)),crmListView.showHideNoResult(e)),$(".sv_sortable").sortable("refresh"),crmListView.addListenerToStageCards([e,t])},crmListView.executeVRForStageDropping=function(e,t,s){return CVRExec.setAjaxEditPrimaryField(!0),new Promise((function(e){e(CVRExec.evalRules("view",customViewObject.module,customViewObject.stageColumn,!0,!0))})).then((function(a){if(a)return!1;hideAnimatePopup("deletepopup");var r={type:"StageView"};if(r.valId=e,r.prevStageId=s,"STAGE"!=customViewObject.stageColumn){var l=customViewObject.stageBoards;for(i in l)if(e==l[i].id){e=l[i].label.trim();break}}var o={module:customViewObject.module,columnName:customViewObject.stageColumn,fieldValue:e,moduleid:t,fieldLabel:customViewObject.stageLabel,type:"StageView"};return o[csrfParamName]=encodeURIComponent(csrfToken),o.check=r,CVRExec.storeCachedParams(o),!0}))},crmListView.updateStage=function(e,t,s){commonUtils.showHideLoadingDiv(!0);var a=t;$("#listView_"+e),s=JSON.parse($("#listView_"+e).parents().eq(0).attr("lt-prop-td")).stageId;if("STAGE"!=customViewObject.stageColumn){var r=customViewObject.stageBoards;for(i in r)if(t==r[i].id){t=r[i].label.trim();break}}var l={},o={},n=[];o[customViewObject.stageSysRefName]=t;var c={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken};clientPortalName&&(c["X-CRMPORTAL"]=window.clientPortalName),n.push(o),l.data=n;var d=new crmRequestPool,m="Campaigns"===customViewObject.module||"FORECAST_CATEGORY"===customViewObject.stageColumn?"/crm/v2.2/":"/crm/v2/";d.initiate({action:m+moduleApiMapping[customViewObject.module]+"/"+e+"?affected_data=true",headers:c,contentType:"application/json",data:JSON.stringify(l),type:"PUT",success:function(i){if("INVALID_DATA"===i.data[0].code)return renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error")),void crmListView.updateStageError(t,s);i.outputValue=t,crmListView.updateStageSuccess(e,customViewObject.module,a,s,i)},error:function(e){if(commonUtils.showHideLoadingDiv(!1),"NO_PERMISSION"===e.responseJSON.code||e.responseJSON.data&&("RECORD_IN_BLUEPRINT"===e.responseJSON.data[0].code||"CANNOT_PERFORM_ACTION"===e.responseJSON.data[0].code||"INVALID_DATA"===e.responseJSON.data[0].code||"MAPPING_MISMATCH"===e.responseJSON.data[0].code))renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error"));else if("NOT_ALLOWED"===e.responseJSON.data[0].code)crmListView.updateStageError(a,s),"Zoho Campaign can't be updated after the campaign is sent"===e.responseJSON.data[0].message?crmui.showMsgBand("error",I18n.getMsg("crm.zcampaign.edit.campaign.disallowed.dynamic",Crm.integrationsAppName.ZOHO_CAMPAIGNS),4e3):"Integration fields can be updated only for respective integration campaigns"===e.responseJSON.data[0].message&&crmui.showMsgBand("error",I18n.getMsg("crm.campaign.integfield.edit.layout.mismatch",Crm.partnerName),4e3);else{if("DELETED_ZOHO_CAMPAIGN_UPDATE"===e.responseJSON.data[0].code)return crmListView.updateStageError(a,s),void crmui.showMsgBand("error",I18n.getMsg("crm.zcampaign.record.deleted.campaigns.dynamic",Crm.integrationsAppName.ZOHO_CAMPAIGNS),4e3);if("UNAUTHORIZED_CAMPAIGN_USER"===e.responseJSON.data[0].code)return crmListView.updateStageError(a,s),void crmui.showMsgBand("error",I18n.getMsg("crm.campaign.non.campaign.user.error.dynamic",Crm.integrationsAppName.ZOHO_CAMPAIGNS),4e3);if("NO_PERMISSION_FOR_EMAILID"===e.responseJSON.data[0].code)return crmListView.updateStageError(a,s),void crmui.showMsgBand("error",I18n.getMsg("crm.zcampaign.emailid.permission.denied"),4e3)}crmListView.updateStageError(a,s)}})},crmListView.animateCount=function(e,t,i,s,a){var r=a.format.split("|");e.ltProp({useGrouping:!0,separator:r[0],decimalSeperator:r[1],prefix:a.symbol+" ",suffix:"",decimals:a.decimals,start:t,end:i,duration:s}),e.ltProp("state","start")},crmListView.updateSummaryOnEdit=function(e,t,i,s){var a,r=$("#listView_"+e),l=(U=JSON.parse(r.parents().eq(0).attr("lt-prop-td"))).stageId,o=r.closest("li").find(".sv_AMOUNT"),n=o.text(),c=customViewObject.summarizeById?customViewObject.module_info.fields.find((function(e){return e.id===customViewObject.summarizeById})):void 0,d=!(!c||!i.affected_data)&&c.api_name in i.affected_data[0],m=n.trim();U.stageId=t,r.parents().eq(0).attr("data-params",JSON.stringify(U)),-1!=n.indexOf("(")&&(n=n.split("(")[1].replace(")","").trim());var u=Territory.getCurrencyObj(n),p=parseFloat(Territory.formatCurrencytoNum({amtStr:n},u).amtStr);if(d){var f=-1!=m.indexOf("(")?m.split("(")[0].trim().match(/^.*?(?=[0-9])/)[0].trim():u.symbol;m=-1!=(m=crmListView.convertCurrencyForAffectedStageCard(f,i.affected_data[0].Expected_Revenue)).indexOf("(")?m.split("(")[1].replace(")","").trim():m,a=parseFloat(Territory.formatCurrencytoNum({amtStr:m},u).amtStr)}var v=customViewObject.viewSummary[l],g=customViewObject.viewSummary[t];if(g||(customViewObject.viewSummary[t]=g={recordsCount:0,amount:0}),v.recordsCount=parseInt(v.recordsCount)-1,g.recordsCount=parseInt(g.recordsCount)+1,p||0===p){var h=parseFloat(v.amount)-p,w=parseFloat(g.amount)+(d?a:p),C=o.data("amountValue");if(C){C=parseFloat(C),"AMOUNT"===c.column_name&&(w=w+C-p);for(var b=customViewObject.heading,V=b.length,I=0,O=0;O<V;O++)"AMOUNT"===b[O].COLUMNNAME&&(I=O);var _,T=(A=customViewObject.stageBoardDetails[l].body).length;for(var L in Crm.userDetails.CURRENCY_DETAILS)Crm.userDetails.CURRENCY_DETAILS[L].symbol===u.symbol&&(_=L);_=_||Crm.userDetails.BASE_CURRENCY;for(O=0;O<T;O++){(P=A[O]).ENTITYID===e&&(P.CONTENT[I]=currencyUtils.returnValueInDefaultCurrency(_,C))}}if(Lyte.Component.registeredComponents["lyte-counter"]){var y=$("#"+l),E=y.find(".amount")[0];crmListView.animateCount(E,v.amount,h,.5,u);var S=!!moduleRecordMapping[customViewObject.module].modified_by;y.find(".recordsCount").text(v.recordsCount+" "+(1==parseInt(v.recordsCount)?S?moduleRecordMapping[customViewObject.module].singular_label:I18n.getMsg(moduleRecordMapping[customViewObject.module].singular_label):S?moduleRecordMapping[customViewObject.module].plural_label:I18n.getMsg(moduleRecordMapping[customViewObject.module].plural_label)));var M=$("#"+t),k=M.find(".amount")[0];crmListView.animateCount(k,g.amount,w,.5,u),M.find(".recordsCount").text(g.recordsCount+" "+(1==parseInt(g.recordsCount)?S?moduleRecordMapping[customViewObject.module].singular_label:I18n.getMsg(moduleRecordMapping[customViewObject.module].singular_label):S?moduleRecordMapping[customViewObject.module].plural_label:I18n.getMsg(moduleRecordMapping[customViewObject.module].plural_label))),g.amount=w,v.amount=h}else g.amount=w,v.amount=h,crmListView.updateStageSummary(!0)}else crmListView.updateStageSummary(!0);var A,N,D=customViewObject.stageBoardDetails[l];for(T=(A=D.body).length,O=0;O<T;O++){var P;if((P=A[O]).ENTITYID===e){N=objectUtils.cloneObject(P),A.splice(O,1),T%crmListView.MAX_STAGECARD_CNT==0&&(D.bindScroll=!0);break}}var x,R=$("#data-container_"+l);if((U=JSON.parse(R.attr("data-params"))).noOfRecords=parseInt(U.noOfRecords)-1,D.toIndex=parseInt(D.toIndex)-1,R.attr("data-params",JSON.stringify(U)),N){N=crmListView.updateAffectedDetailsInStageCard(N,i,u);var F=customViewObject.stageBoardDetails[t],j=$("#values_"+t).find("#detailView_"+e).index();F.body.splice(j,0,N);var U;R=$("#data-container_"+t);(U=JSON.parse(R.attr("data-params"))).noOfRecords=parseInt(U.noOfRecords)+1,F.toIndex=parseInt(F.toIndex)+1,R.attr("data-params",JSON.stringify(U))}if(((x=$("#values_"+l)).length>0&&x.html(Handlebars.templates.stageCard(D)),(x=$("#values_"+t)).length>0&&x.html(Handlebars.templates.stageCard(F)),s&&s!==t)&&(x=$("#values_"+s)).length>0){var B=customViewObject.stageBoardDetails[s];x.html(Handlebars.templates.stageCard(B))}$(".sv_sel_entity").removeClass("sv_sel_entity"),$("#detailView_"+e).addClass("sv_sel_entity"),setTimeout((function(){$(".sv_sel_entity").removeClass("sv_sel_entity")}),2e3),crmNavig.parseCurrentListView()},crmListView.updateAffectedDetailsInStageCard=function(e,t,i){if(t.affected_data&&t.affected_data[0].id===e.ENTITYID){var s,a=t.affected_data[0],r=function(e){return customViewObject.heading.findIndex((function(t){if(t.COLUMNNAME===e)return!0}))};if(a.Expected_Revenue&&(s=r("EXPECTEDREVENUE"))>-1){var l=e.CONTENT[s],o=-1!=l.indexOf("(")?l.split("(")[0].trim().match(/^.*?(?=[0-9])/)[0].trim():i.symbol;l=crmListView.convertCurrencyForAffectedStageCard(o,a.Expected_Revenue),e.CONTENT[s]=l}a.Probability&&(s=r("PROBABILITY"))>-1&&(e.CONTENT[s]=a.Probability)}return e},crmListView.convertCurrencyForAffectedStageCard=function(e,t){var i;for(var s in Crm.userDetails.CURRENCY_DETAILS)Crm.userDetails.CURRENCY_DETAILS[s].symbol===e&&(i=s);return i=i||Crm.userDetails.BASE_CURRENCY,featuresAvailable.MultiCurrency&&void 0!==Crm.userDetails.CURRENCY_DETAILS[i]?currencyUtils.returnValueInDefaultCurrency(i,t,Crm.userDetails.CURRENCY_DETAILS[i].decimals):currencyUtils.returnValueInDefaultCurrency(i,t)},crmListView.loadMoreStageCards=function(e,t,i){if(e=$L(e),(t||e.scrollTop()+e.outerHeight()>=e[0].scrollHeight-200)&&"loading"!=e.attr("data-loaded")){e.attr("data-loaded","loading");var s=new crmRequestPool,a=JSON.parse(e.attr("data-params"));delete a.index,customViewObject.isPredictView&&null!=a.stageId&&(a.predictId=a.stageId,delete a.stageId),a.toIndex=parseInt(a.fromIndex)+crmListView.MAX_STAGECARD_CNT-1,0!=customViewObject.layoutId&&(a.layoutId=customViewObject.layoutId),customViewObject.pipeline&&"0"!=customViewObject.pipeline&&(a.pipeline=customViewObject.pipeline),crmListView.getFilterParams(a),crmListView.getAdvSearchCrtFromCVObject(a),s.initiate({action:Crm.getCrmBasePath()+"/ShowSelectedCustomView.do?",data:a,type:"POST",success:function(t){var s,r;customViewObject.isPredictView?(s=a.predictId,r=t.predictData):(s=a.stageId,r=t.stageBoardDetails);var l=r;if(l&&l[s]){l=l[s],$("#values_"+s).append(Handlebars.templates.stageCard(l)),l.body.length<crmListView.MAX_STAGECARD_CNT+1&&(e.attr("data-load","false"),e.removeAttr("data-scupdate")),i&&crmListView.latestEntity(i);var o=JSON.parse(e.attr("data-params"));o.fromIndex=parseInt(a.fromIndex)+l.body.length-1,e.attr("data-params",JSON.stringify(o)),crmListView.updateStageCardsInCache(s,l,t.module,!1,customViewObject.isPredictView),crmNavig.parseCurrentListView()}e.attr("data-loaded","true"),crmListView.checkAll(a.stageId)}})}},crmListView.changeSortColumn=function(e,t){var i=e;"0"!=(e=$("#"+e).val())?t=$("#"+t).val():(e="",t="sort_desc");var s={module:customViewObject.module,clearCache:!0,cvid:customViewObject.cvId,webTab:!1};customViewObject.viewid?s.fetchOnlyBody=!1:s.fetchOnlyBody=!0,s.sortColumnString=e,s.sortOrderString=t,customViewObject.layoutId&&"0"!=customViewObject.layoutId&&(s.layoutId=customViewObject.layoutId),customViewObject.pipeline&&"0"!=customViewObject.pipeline&&(s.pipeline=customViewObject.pipeline),customViewObject.territoryId&&(s.territoryId=customViewObject.territoryId,s.includechild=customViewObject.includeChild?1:0);var a=store.peekRecord("custom_view",customViewObject.cvId);a&&(a.sort_order=t&&t.split("sort_")[1]?t.split("sort_")[1]:void 0,a.sort_by=""!=e?{id:e,api_name:store.peekRecord("field",e).api_name}:void 0),""!=e&&"0"!=e||"CustomizedViewSortColumnSelect"!=i||!$("#canvasview-container").length?($("#select2-CustomizedViewSortColumnSelect-container").show(),$("#CustomizedViewSortOrder").show()):($("#select2-CustomizedViewSortColumnSelect-container").hide(),$("#CustomizedViewSortOrder").hide());var r={dynamicParams:[],queryParams:{}},l=Lyte.Router.getRouteInstance().transition.info,o=l.queryParams.filters;o&&(r.queryParams.filters=o),l.queryParams.cross_filters&&(r.queryParams.cross_filters=l.queryParams.cross_filters),l.queryParams.filter_id&&(r.queryParams.filter_id=l.queryParams.filter_id),r.queryParams.sort_by=e,r.queryParams.sort_order=t,r.dynamicParams=l.dynamicParams,customViewObject.viewid?(r.dynamicParams.push(customViewObject.viewid),r.route="crm.tab.module.custom-view.canvas"):customViewObject&&customViewObject.isPredictView?r.route="crm.tab.module.custom-view.zia":r.route="crm.tab.module.custom-view.kanban",s.clearselectedIds=!0,Lyte.Router.transitionTo(r).data=s},crmListView.updateStageSummary=function(e){if(customViewObject.viewSummary){for(var t=$("#stageViewContainer").find("div.sv_each_stage"),i=t.length,s=!!moduleRecordMapping[customViewObject.module].modified_by,a=Crm.userDetails.defaultOrgCurrency&&Crm.userDetails.DEFAULT_ORG_CURRENCY?void 0:Crm.userDetails.BASE_CURRENCY,r=0;r<i;r++){var l=t.eq(r),o=l.attr("id"),n=0,c=0,d=!1;customViewObject.viewSummary[o]&&(c=(c=parseInt(customViewObject.viewSummary[o].recordsCount))+" "+(1==c?s?moduleRecordMapping[customViewObject.module].singular_label:I18n.getMsg(moduleRecordMapping[customViewObject.module].singular_label):s?moduleRecordMapping[customViewObject.module].plural_label:I18n.getMsg(moduleRecordMapping[customViewObject.module].plural_label)),n=customViewObject.viewSummary[o].amount,d=!0),l.find(".recordsCount").show().text(d?c:c+" "+(s?moduleRecordMapping[customViewObject.module].plural_label:I18n.getMsg(moduleRecordMapping[customViewObject.module].plural_label))),l.find(".amount")[0].component.setData("result",currencyUtils.returnValueInDefaultCurrency(a,n))}!e&&customViewObject.isStageView&&customViewObject.stageIdsArr&&crmListView.checkStageSummary(customViewObject.stageIdsArr[0])}},crmListView.checkStageSummary=function(e){var t,i=e.length,s=customViewObject.stageBoardDetails,a=customViewObject.viewSummary.summarizeById,r=customViewObject.heading.length,l=!!moduleRecordMapping[customViewObject.module].modified_by,o=Crm.userDetails.defaultOrgCurrency&&Crm.userDetails.DEFAULT_ORG_CURRENCY?void 0:Crm.userDetails.BASE_CURRENCY;if("0"!=a)for(var n=0;n<r;n++)customViewObject.heading[n].FIELDID==a&&(t=n);for(n=0;n<i;n++){var c=e[n];if(s[c]){var d=s[c].body.length;if(!(d>crmListView.MAX_STAGECARD_CNT)){var m=0,u=0;if(t)for(var p=0;p<d;p++){amtStr=s[c].body[p].CONTENT[t],-1!=amtStr.indexOf("(")&&(amtStr=amtStr.split("(")[1].replace(")","").trim());var f=Territory.getCurrencyObj(amtStr);entityAmt=parseFloat(Territory.formatCurrencytoNum({amtStr:amtStr},f).amtStr),isNaN(entityAmt)||(u+=entityAmt)}if(!((m=d)<0||u<0)){customViewObject.viewSummary[c]||(customViewObject.viewSummary[c]={recordsCount:0,amount:0}),customViewObject.viewSummary[c].recordsCount=m,customViewObject.viewSummary[c].amount=u;var v=$("#stageViewContainer").find("div#"+c);m=m+" "+(1==m?l?moduleRecordMapping[customViewObject.module].singular_label:I18n.getMsg(moduleRecordMapping[customViewObject.module].singular_label):l?moduleRecordMapping[customViewObject.module].plural_label:I18n.getMsg(moduleRecordMapping[customViewObject.module].plural_label)),v.find(".recordsCount").show().text(m),t&&v.find(".amount")[0].component.setData("result",currencyUtils.returnValueInDefaultCurrency(o,u))}}}}},crmListView.loadPredictSummary=function(){var e=new crmRequestPool,t={module:customViewObject.module};t.cvid=customViewObject.cvId,customViewObject.territoryId&&(t.territoryId=customViewObject.territoryId,t.includechild=customViewObject.includeChild?1:0),t.crmcsrfparam=csrfToken,crmListView.getFilterParams(t),crmListView.getAdvSearchCrtFromCVObject(t),e.initiate({action:Crm.getCrmBasePath()+"/ViewSummaryAction.do?action=predictSummary",data:t,type:"POST",success:function(e){var t=["Lose","Ten_Days","This_Month"];customViewObject.viewSummary||(customViewObject.viewSummary={});for(var i=t.length,s=0;s<i;s++){var a=t[s];e[a]?customViewObject.viewSummary[a]=e[a]:delete customViewObject.viewSummary[a]}crmListView.updateStageSummary()}})},crmListView.loadStageSummary=function(e,t,i){var s=new crmRequestPool,a={module:customViewObject.module,cvid:customViewObject.cvId};e&&(a.stageIds=e),t&&"0"!=t&&(a.layoutId=t),customViewObject.pipeline&&(a.pipeline=customViewObject.pipeline),a.searchLetter=customViewObject.searchletter,customViewObject.territoryId&&(a.territoryId=customViewObject.territoryId,a.includechild=customViewObject.includeChild?1:0),i&&(a.refresh=!0),crmListView.getFilterParams(a),crmListView.getAdvSearchCrtFromCVObject(a),a.crmcsrfparam=csrfToken,s.initiate({action:Crm.getCrmBasePath()+"/ViewSummaryAction.do?action=summary",data:a,type:"POST",success:function(t){if(e){customViewObject.viewSummary||(customViewObject.viewSummary={});for(var i=e.split(","),s=i.length,a=0;a<s;a++){var r=i[a];t[r]?customViewObject.viewSummary[r]=t[r]:delete customViewObject.viewSummary[r]}}else customViewObject.viewSummary=t;crmListView.updateStageSummary()}})},crmListView.refreshStageBoards=function(e){let t=$L("crm-kanbanview-component")[0];t&&t.component.refreshStageBoards(e)},crmListView.updateStageCardsInCache=function(e,t,i,s,a){var r,l=crmTab.getFromCache(i);if((r=a?l.predictData[e]:l.stageBoardDetails[e])&&r.body){var o=r.body.length;if(s)r=t;else{var n=r.body;n.splice(o-1,1),n.push.apply(n,t.body),r.toIndex=t.body.length<crmListView.MAX_STAGECARD_CNT+1?n.length:n.length-1}crmTab.putInCache(i,l)}},Handlebars.registerHelper("addNoWrap",(function(e,t){return 33==e[t].UITYPE?"nowrap":""})),Handlebars.registerHelper("containsRelatedInfo",(function(e,t,i){if("object"==typeof e&&e.MODULE&&"Accounts"===e.MODULE)for(var s=0;s<t.length;s++){var a=t[s];if("object"==typeof a&&a.MODULE&&"Contacts"===a.MODULE)return i.fn(this)}return i.inverse(this)})),Handlebars.registerHelper("isCompactView",(function(e){return Crm.userDetails.CUSTOMIZE_INFO&&Crm.userDetails.CUSTOMIZE_INFO.viewType?e.fn(this):e.inverse(this)})),Handlebars.registerHelper("getClassNameForStageView",(function(e,t){var i,s="";if(customViewObject&&(i=(s=customViewObject.heading)[t].UITYPE),301==i&&"false"==e)return"dN";var a="";return 0==t?a+="sv-box-heading crm-font-bold crm-base-font-size":200==s[t].UITYPE||786==s[t].UITYPE||14==s[t].UITYPE||24==s[t].UITYPE||202==s[t].UITYPE||333==s[t].UITYPE||116==s[t].UITYPE&&"datetime"==s[t].RETURNTYPE?a+="sv_date crm-base-font-size":36==s[t].UITYPE||77==s[t].UITYPE||143==s[t].UITYPE||144==s[t].UITYPE||145==s[t].UITYPE?customViewObject&&customViewObject.isStageView?s[t].FIELDID==customViewObject.summarizeById?a+="sv_AMOUNT crm-base-font-size":a+="sv-box-normal crm-base-font-size":a+="sv_AMOUNT crm-base-font-size":customViewObject&&customViewObject.isStageView&&s[t].FIELDID==customViewObject.summarizeById?a+="sv_AMOUNT crm-base-font-size":a+="sv-box-normal crm-base-font-size",a})),crmListView.checkForNoneStage=function(e,t){var i=e.stageBoards,s=i.length,a=i[s-1];if("0"===a&&((a={}).DISPLAYLABEL=a.label=I18n.getMsg("crm.label.unmapped.stages"),a.id="0",a.selected=!0,a.presence=!1,i[s-1]=a),t)for(var r=0;r<s;r++){var l=i[r],o=l.id,n=e.stageBoardDetails[o];probability="0",l.probability&&(probability=l.probability),(!1===l.presence||"-None-"===l.label&&"0"===probability)&&n&&0===n.body.length?(l.selected&&e.stageSize--,$("#"+o+":visible").length&&$("#"+o).hide(),i.splice(r,1),delete e.stageBoardDetails[o],r--,s--):"-None-"===l.label&&"0"===l.probability&&(l.presence=!1)}},crmListView.popup=function(e,t){if(e){var i=Handlebars.templates.kanbanViewSettings(t);$("#topBandPopup").html(i),crmListView.makeFullNameMandatory(),showAnimatePopup("topBandPopup",renderingUtils.sectionSorting())}else{var s=new crmRequestPool,a={module:customViewObject.module,action:"editKanbanViewSetup"};s.initiate({action:Crm.getCrmBasePath()+"/CustomView.do",data:a,type:"POST",success:function(e){var t=Handlebars.templates.kanbanViewSettings(e);$("#topBandPopup").html(t),crmListView.makeFullNameMandatory(),showAnimatePopup("topBandPopup",renderingUtils.sectionSorting())}})}},crmListView.makeFullNameMandatory=function(){var e=$("#kanbanSettingsColumn_Full_Name");if(e.length&&(crmModuleConstants.Leads===customViewObject.module||crmModuleConstants.Contacts===customViewObject.module)){var t=document.createElement("sup"),i=$(t);i.attr({class:"crmNegativeColor mL3 top8"}),i.html("*"),e.append(t)}},crmListView.setStageFilters=function(){var e=$("#sv_sel_stagelist input:checked"),t=CustomView.getFavoriteCVIDsAsString(e),i=CustomView.getFavoriteCVIDsAsString($('#sv_sel_stagelist input[data-selected="true"]:not(:checked)')),s={module:customViewObject.module,action:"setStageFilters",stageIds:t};i&&(s.removedStageIds=i),s[csrfParamName]=encodeURIComponent(csrfToken),(new crmRequestPool).initiate({action:Crm.getCrmBasePath()+"/CustomView.do",data:s,type:"POST",success:function(e){hideMenu();var t=CustomView.getFavoriteCVIDsAsString($('#sv_sel_stagelist input[data-selected!="true"]:checked'));crmListView.updateStagesInView(customViewObject,t,i),crmListView.loadStageSummary(t)}})},crmListView.updateStagesInView=function(e,t,i){var s=(e=customViewObject).stageBoards,a=s.length;t=t?t.split(","):[];for(var r=(i=i?i.split(","):[]).length,l=t.length,o=0;o<a;o++){var n=s[o],c=n.id;if(i.contains(c)?(delete n.selected,delete e.stageBoardDetails[c],$("#"+c).hide(),e.stageSize--,r--):t.contains(c)&&(n.selected=!0,$("#"+c).show(),l--),0===r&&0===l)break}$("#sv_stage_inner_parent").trigger("scroll")},crmListView.searchFilters=function(e,t){if($("#lv_filters_loadMore").click(),$("#lv_filter_search_clear").show(),showMacroSuggest(e,t,"lv_left_filter",".filterLabel","lv_filter_noMatch","","","300px","",void 0,"false",!0,".filterContainBox"),customViewObject.isVTAdvFilterAvailable){var i=$("#vtMoreSpan"),s=$("#vtHeadDiv"),a=$("#vtFieldOuterDiv"),r=a.find(".vt-filter-sep");a.length&&a.css("display",""),""!=e.value?i.length&&i.is(":visible")&&i.css("display","none"):i.length?(i.css("display",""),crmListView.setVTDivHt()):(r.css("display",""),$("#vtFieldDiv").css({height:""}).removeClass("oH")),$("#vtFieldOuterDiv").find(".vtColumn:visible").length?(""==e.value&&i.length&&(i.css("display",""),r.css("display","none")),s.css("display",""),i.length&&"none"!==i.css("display")||(r.css("display",""),$("#vtFieldDiv").css({height:""}).removeClass("oH"))):(s.length&&s.is(":visible")&&s.css("display","none"),r.length&&r.is(":visible")&&r.css("display","none"),$("#vtFieldOuterDiv").find("input:checkbox:checked").length||a.css("display","none"))}},crmListView.arrangeTagActivityFilters=function(){var e=$("#lv_left_filter").find("input#searchtag1");if(customViewObject.isActivitiesView){(f=e.closest("div.filterContainBox")).parent("div").append('<div class="oneFacet filterContainBox" id="ActivityTag"><div class="facetContainer"> <div class="head fk-uppercase"><div class="facet-title pR"><h2 class="unit fk-font-15"><span><label class="fL" ><input type="checkbox" data-name="" data-zcqa="filter_ActivitiesTag" id="filter_activityTag" data-params="{&quot;searchfieldtype&quot;:&quot;ActivityTag&quot;,&quot;searchModule&quot;:&quot;Activities&quot;}" onchange="crmListView.showHideSelectedFilter(this,\'ActivityTag\');" class=" newcheckboxfilternew" data-subfilters="true" data-value="CrmActivity:ActivityTag"><span class="mL2 vaM cP filterLabel crm-font-semibold crm-small-font-size" title="Subject">'+I18n.getMsg("crm.label.tag")+'</span></label></span>  </h2><div id="activityRelTo" style="display:none;color:var(--baseColor);position:relative;top:26px;margin-bottom:26px;left:-18px;font-size:12.5px;font-weight:bold">'+I18n.getMsg("crm.label.tag.related.to")+'</div></div></div><ul id="sub_filter_activityTag" style="padding: 0;margin: 2px 0px 1px 20px"></ul></div></div>');for(var t=void 0,i=$("ul#sub_filter_activityTag"),s=f.length,a=0;a<s;a++){var r=$("<li></li>",{html:$(f[a]).html()}).appendTo(i);r.css("padding","0px 0px 0px 7px");var l=(e=r.find('input[type="checkbox"]')).attr("id").split("_")[1],o=e.parent("label");e.attr("type","radio"),e.removeClass("newcheckboxfilternew"),o.addClass("rbCheckHtml");var n=e.data("value"),c=r.find("ul.facets").find("select#searchtag1_"+l);if(null!=c&&c.length>0){t=r.find("div.facetContainer"),customViewObject.tagFilterValue=$("input[name=searchtag1_"+l+"]").val();var d=t.find("ul#sub_filter_"+l);null!=customViewObject.tagFilterValue&&""!=customViewObject.tagFilterValue&&(d.removeClass("dN"),customViewObject.shownTagFilter="sub_filter_"+l),d.css("height","75px")}if(n){var m=o.find("span");-1!=n.indexOf("CrmCall")&&m.removeClass("filterLabel").text(I18n.getMsg("Calls")),-1!=n.indexOf("CrmEvent")&&m.removeClass("filterLabel").text(I18n.getMsg(Crm.getModuleDisplayName(!1,!0,!0))),-1!=n.indexOf("CrmTask")&&m.removeClass("filterLabel").text(I18n.getMsg("Tasks"))}var u=$("<span></span>",{class:"rbHtml dIB pR"}).insertAfter(e);$("<span></span>",{class:"rbTickHtml pA"}).appendTo(u),$(f[a]).remove()}null==t?$("#ActivityTag").find("input#searchtag1").closest("div.facetContainer").hide():($("#ActivityTag").find('input[type="checkbox"]').prop("checked",!0),t.find('input[type="radio"]').trigger("click"),t.show()),$("#manageTagOp").remove()}else if(customViewObject.isCallsView||customViewObject.isEventsView||customViewObject.isTasksView){var p=e.closest("div.facetContainer").hide();for(s=p.length,a=0;a<s;a++){var f;(n=(f=$(p[a])).find('input[type="checkbox"]').data("value"))&&(customViewObject.isCallsView&&-1!=n.indexOf("CrmCall")&&(f.find("label span").text(I18n.getMsg("crm.label.tag")),f.show()),customViewObject.isEventsView&&-1!=n.indexOf("CrmEvent")&&(f.find("label span").text(I18n.getMsg("crm.label.tag")),f.show()),customViewObject.isTasksView&&-1!=n.indexOf("CrmTask")&&(f.find("label span").text(I18n.getMsg("crm.label.tag")),f.show()))}}else e.closest("div.facetContainer").hide(),$("#manageTagOp").remove()},crmListView.getTagOptions=function(e){return"Activities"===e||Crm.isActivitySplitDone&&("Calls"===e||"Events"===e||"Tasks"===e)?(customViewObject.isCallsView?e="Calls":customViewObject.isEventsView?e="Events":customViewObject.isTasksView&&(e="Tasks"),options=Crm.jsonSelectValues.Tags[e]):options=Crm.jsonSelectValues[e].TAGMODULEREFID,options},crmListView.handleTagOpEvent=function(e,t){var i="add"==t?"addTagsDiv":"removeTagsDiv",s="add"==t?"#addTagsSel":"#removeTagsSel";switch(e){case"cancel":crmui.hidePopup(i),$(s).html(""),thirdPartyUtils.unbindChildSelect2($("#"+i)),"add"==t&&$("#addTagsDiv").find('input[name="overWriteRecords"]').prop("checked",!1),delete CrmTags.clientJSON;break;case"save":var a=$(s).val();if("add"!=t){if(!a||a&&0==a.length)return void renderingUtils.showCustomAlert(I18n.getMsg("crm.no.tag.selected"),I18n.getMsg("crm.label.small.tags"),!1);$("#removeTagsDiv #removeTagButton").addClass("disable eventNone")}if("add"==t){if(!CrmTags.checkAndPopulateNewlyAdded("addTagsDiv"))return!1;if(0==CrmTags.clientJSON.selectedIds.length&&0==CrmTags.clientJSON.newlyAdded.length)return void renderingUtils.showCustomAlert(I18n.getMsg("crm.no.tag.selected"),"",!1);$("#addTagsDiv #addTagButton").addClass("disable eventNone")}var r=customViewObject.selectedIds,l="add"==t?0:2,o=[],n=[],c=0,d=$("#addTagsDiv");if(t&&"remove"!=t&&d.find('input[name="overWriteRecords"]').is(":checked")&&(l=1,d.find('input[name="overWriteRecords"]').prop("checked",!1)),a&&"add"!=t){c=a.length;for(var m=0;m<c;m++)o.push(a[m])}if(a&&"add"==t&&CrmTags.clientJSON.selectedIds){c=CrmTags.clientJSON.selectedIds.length;for(var u=0;u<c;u++)o.push(CrmTags.clientJSON.selectedIds[u])}if("add"==t&&CrmTags.clientJSON.newlyAdded){c=CrmTags.clientJSON.newlyAdded.length;for(u=0;u<c;u++)n.push(CrmTags.clientJSON.newlyAdded[u])}var p=$("#selectModule").val();if("Activities"===p&&(customViewObject.isCallsView?p="Calls":customViewObject.isEventsView?p="Events":customViewObject.isTasksView&&(p="Tasks")),"add"==t&&null!=n&&n.length>0){var f=[],v={};c=n.length;for(u=0;u<c;u++)null!=n[u]&&n[u].length>0&&((v={}).name=n[u],f.push(v));var g={};g.tags=f;JSON.stringify(g);var h={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken};(new crmRequestPool).initiate({action:"/crm/v2/settings/tags?module="+moduleRecordMapping[p].api_name+"&fromPage=view",type:"post",data:JSON.stringify(g),headers:h,success:function(e){var a=e.tags;CrmTags.validateSymbol(e);var n=[];if(n="Calls"==p||"Events"==p||"Tasks"==p?Crm.jsonSelectValues.Tags[p]:Crm.jsonSelectValues[p].TAGMODULEREFID,a&&a.length>0){c=a.length;for(var d=0;d<c;d++){var m=a[d].details;if(m.name){var u={};u.id=m.modRefId,u.name=m.name,n.push(u),o.push(m.name),CrmTags.clientJSON.existingNames.push(m.name),CrmTags.clientJSON.names.push(m.name.toLowerCase()),CrmTags.clientJSON.existingtags[m.modRefId]=m.name}}"Activities"===p?(customViewObject.isCallsView?p="Calls":customViewObject.isEventsView?p="Events":customViewObject.isTasksView&&(p="Tasks"),Crm.jsonSelectValues.Tags[p]=n,crmListView.getObject().modulePicklistValues&&crmListView.getObject().modulePicklistValues.Tags&&(crmListView.getObject().modulePicklistValues.Tags[p]=n)):(Crm.jsonSelectValues[p].TAGMODULEREFID=n,crmListView.getObject().modulePicklistValues&&crmListView.getObject().modulePicklistValues[p]&&(crmListView.getObject().modulePicklistValues[p].TAGMODULEREFID=n)),Crm.trackSpotLightAction("Tagging - List View Tags Create",{Module:p,Count:c})}crmListView.processTagOperation(o,l,p,r,s,t,i)},error:function(){crmListView.processTagOperation(o,l,p,r,s,t,i)}})}else crmListView.processTagOperation(o,l,p,r,s,t,i);break;default:return crmui.hidePopup(i),void delete CrmTags.clientJSON}},crmListView.processTagOperation=function(e,t,i,s,a,r,l){isWFExecuted=!1;var o=CrmTags.getCommaSeparatedValue(s),n="",c=0;if(e.length>=1){var d=CrmTags.clientJSON.existingNames;c=e.length;for(var m=0;m<c;m++)d.contains(e[m])&&(n+=e[m]+",");n=n.substring(0,n.length-1)}var u="add_tags";2==t?(u="remove_tags",Crm.trackSpotLightAction("Tagging - List View Remove Tags Save",{Module:i,Count:e.length})):Crm.trackSpotLightAction("Tagging - List View Add Tags Save",{Module:i,Count:e.length,"Over write":1==t}),customViewObject.isCallsView?i="Calls":customViewObject.isEventsView?i="Events":customViewObject.isTasksView&&(i="Tasks");var p=new crmRequestPool,f="/crm/v2/"+moduleRecordMapping[i].api_name+"/actions/"+u,v={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken},g={};g.ids=o,g.tag_names=n,1==t?g.over_write=!0:0==t&&(g.over_write=!1),p.initiate({action:f,type:"post",data:g,headers:v,success:function(e){if(!isWFSchedulerUser()||!e.isWFScheduler){var t=e;if(t&&t.data&&t.data.length>0){var i="add"==r?I18n.getMsg("crm.tags.list.view.added.successfully"):I18n.getMsg("crm.tags.removed.successfully"),o=!1;o="add"==r&&t.success_count?crmListView.addTagsPopupMsg(t.success_count,s.length,customViewObject.tagRecordLimit,t.locked_count):crmListView.addTagsPopupMsgFrOverWrite(t.locked_count,s.length,"add"==r);var n=crmTab.getFromCache(customViewObject.module),c={module:$("#selectModule").val(),fromIndex:customViewObject.fromIndex,toIndex:customViewObject.toIndex,currentOption:customViewObject.currentOption,fetchOnlyBody:"true",cvid:customViewObject.cvId};crmListView.getFilterParams(c),(new crmRequestPool).initiate({action:Crm.getCrmBasePath()+"/ShowDetails.do?",data:c,type:"GET",success:function(e){if(1!=e.isStageView){if(e.body&&0!=e.body.length){for(var t=[],s=e.fromIndex-1,r=0;s<=e.toIndex;s++,r++)e.body[r]?t[s]=e.body[r]:t[s]=null;e.body=t}n.body=e.body}else n.stageBoardDetails=e.stageBoardDetails,n.stageBoards=e.stageBoards;(n.heading=e.heading,n.fromIndex=e.fromIndex,n.toIndex=e.toIndex,n.sortColumnString="",n.selectedIds=[],delete n.columns,customViewObject=n,crmTab.putInCache(n.module,n),thirdPartyUtils.unbindChildSelect2($("#"+l)),$(a).html(""),n.isCustomizedView)?($("#lvTred").html(Handlebars.templates.body(n)),new listViewHandler(n).renderListView()):1!=n.isStageView?($(".fixedrowTd").html(Handlebars.templates.fixedColumnlistview(n)),$("#listviewHeaderRow").parent().html(Handlebars.templates.heading(n)),$(".fixedheadercolumn #checkAll, .stageview-heading-container #checkAll").addClass("customCheckBox").removeClass("customCheckBoxChecked"),$("#lvTred").html(Handlebars.templates.body(n)),renderingUtils.tableSorter("listViewTable","2",""),$("#listviewtablescroll").removeClass("oH")):($("#lv_stageview").html(Handlebars.templates.stageView(n)),crmListView.afterRenderStageView(n));crmListView.checkAll(),showHideListViewBtnFn(),crmui.hidePopup(l),o?crmui.showPop("maximumReach"):crmui.showMsgBand("success",i,3e3,"")}})}else if(t&&"FAILURE"==t.code&&"permission denied to  update records"==t.message){crmui.hidePopup(l),crmui.showMsgBand("warning",I18n.getMsg("crm.tags.add.tags.per.den.all.record"),2e3,"");var d={message:"You do not have edit permission to add tags"};murphy.addCustomTracking(d),murphy.error(new Error("Tags Permission case"))}else crmui.hidePopup(l),crmui.showMsgBand("info",I18n.getMsg("crm.tags.add.unsuccessful"),2e3,"");delete CrmTags.clientJSON}},error:function(e){var t=e.responseJSON;t&&-1!=t.message.indexOf("permission denied to  update records")?renderingUtils.displayPermissionDenied(e):t&&-1!=t.message.indexOf("Tag edition limit exceeded")?($(a).html(""),thirdPartyUtils.unbindChildSelect2($("#"+l)),crmui.hidePopup(l),crmui.showMsgBand("error",I18n.getMsg("crm.tag.edition.limit.exceeded"),1e3,"")):t&&-1!=t.message.indexOf("Tags record limit exceeded")?crmui.showMsgBand("error",I18n.getMsg("crm.tags.records.limit.reached",customViewObject.tagRecordLimit),1e3,""):($(a).html(""),crmui.hidePopup(l),crmui.showMsgBand("info",I18n.getMsg("crm.tags.add.unsuccessful"),1e3,"")),delete CrmTags.clientJSON}})},crmListView.addTagsPopupMsg=function(e,t,i,s){var a=!1,r=parseInt(e),l=null!=s&&null!=s?parseInt(s):0,o=$("#maximumReach");return 0==r&&0==l?(o.find("#firstMsg").text(""),t>1?o.find("#secondMsg").text(I18n.getMsg("crm.tags.list.view.all.records.limit.reached",[i])):o.find("#secondMsg").text(I18n.getMsg("crm.tags.list.view.single.record.limit.reached",[i])),a=!0):0==r&&l>0?(o.find("#firstMsg").text(""),t>1?l==t?o.find("#secondMsg").text(I18n.getMsg("crm.tags.list.view.all.record.locked")):o.find("#secondMsg").html(I18n.getMsg("crm.tags.list.view.some.record.not.updated",[t-l])+"<br>"+I18n.getMsg("crm.tags.list.view.some.record.locked",[l])):o.find("#secondMsg").text(I18n.getMsg("crm.tags.list.view.single.record.locked")),a=!0):r<t&&0==l?(t>1?o.find("#firstMsg").text(I18n.getMsg("crm.tags.record.limit.reached.server.side.msg1",r)):o.find("#firstMsg").text(""),o.find("#secondMsg").text(I18n.getMsg("crm.tags.record.limit.reached.server.side.msg2",[t-parseInt(r),i])),a=!0):r<t&&l>0&&(t>1?o.find("#firstMsg").text(I18n.getMsg("crm.tags.record.limit.reached.server.side.msg1",r)):o.find("#firstMsg").text(""),0==l?o.find("#secondMsg").text(I18n.getMsg("crm.tags.record.limit.reached.server.side.msg2",[t-r,i])):o.find("#secondMsg").html(I18n.getMsg("crm.tags.record.limit.reached.server.side.msg3",[t-r-l,i])+"<br>"+I18n.getMsg("crm.tags.list.view.some.records.locked.remaining",[l])),a=!0),a},crmListView.addTagsPopupMsgFrOverWrite=function(e,t,i){var s=parseInt(e);if(s>0){var a=$("#maximumReach");return s==t?(a.find("#firstMsg").text(""),i?t>1?a.find("#secondMsg").text(I18n.getMsg("crm.tags.list.view.all.record.locked")):a.find("#secondMsg").text(I18n.getMsg("crm.tags.list.view.single.record.locked")):t>1?a.find("#secondMsg").text(I18n.getMsg("crm.tags.list.view.all.record.locked.remove")):a.find("#secondMsg").text(I18n.getMsg("crm.tags.list.view.single.record.locked.remove"))):i?(a.find("#firstMsg").text(I18n.getMsg("crm.tags.record.limit.reached.server.side.msg1",[t-s])),a.find("#secondMsg").text(I18n.getMsg("crm.tags.list.view.remaning.records.locked.limit.add",[s]))):(a.find("#firstMsg").text(I18n.getMsg("crm.tags.list.view.records.removed.limit",[t-s])),a.find("#secondMsg").text(I18n.getMsg("crm.tags.list.view.remaning.records.locked.limit.remove",[s]))),!0}return!1},Handlebars.registerHelper("isSubjectField",(function(e,t,i){return"SUBJECT"==t[e].COLUMNNAME?i.fn(this):i.inverse(this)})),Handlebars.registerHelper("isPickListField",(function(e,t,i){return 2===t[e].UITYPE?i.fn(this):i.inverse(this)})),Handlebars.registerHelper("isDueDateField",(function(e,t,i){return"DUEDATE"==t[e].COLUMNNAME?i.fn(this):i.inverse(this)})),crmListView.toggleFilterOptions=function(e,t,s){var a=crmListView.getObject(),r=crmTab.getFiltersFromCache(a.module),l=$("#lv_filter_save");if(null!=r&&null!=r.filters){var o=!1;for(i=0;i<r.filters.length;i++)"Recommendation"==r.filters[i].searchModule?e=!1:"LPRE"===r.filters[i].searchfieldtype||"Prediction"==r.filters[i].searchModule?(o=!0,l.addClass("disabledbtnForPrediction"),l.attr({onmouseenter:"crmui.showTooltip('This action is not supported for prediction.',false,'top',this)",onmouseleave:"crmui.hideTooltip()",onclick:""})):o||(l.removeClass("disabledbtnForPrediction"),l.attr({onmouseenter:"",onmouseleave:"",onclick:"crmListView.showSaveFilterWizard()"}))}if($("#lv_filter_savediv").toggle(e),customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView||$("#lv_filter_submitdiv").toggle(!e),crmListView.bindPerfectScrollbar(),e){s=void 0!==s&&s;var n=$("#lv_filter_savediv");n.find("#lv_filter_save_opt").toggle(s),n.find("#lv_filter_save").toggle(!s);var c=(a=crmListView.getObject()).filterId?a.filterId:$("#lv_saved_filters").find(".f_listclick-view").attr("id");if(s&&c){$("#lv_filter_save_menu").find(".saveTypBtn").eq(1).attr("data-filterId",c);var d=a.module,m=crmTab.getFiltersFromCache(d);m&&m.filterId&&delete m.filterId,delete a.filterId}t?$("#lv_filter_save_menu").find(".saveTypBtn").eq(0).removeClass("disabled"):$("#lv_filter_save_menu").find(".saveTypBtn").eq(0).addClass("disabled")}if(t){$("#lv_filter_submit").prop("disabled",!1);var u=$("#lv_left_filter");u.find("input.checkFilter:checked").length&&u.find("#clearFilterLink").show()}},crmListView.showSaveFilterWizard=function(e,t){if(!$(t).hasClass("disabled")){var i=$("#lv_filter_savePopup"),s=$("#filterName");if($("#displayContent_filterName").remove(),i.find(".form_err_fld").removeClass("form_err_fld"),$(".errMsg").remove(),$(".form_err_msg").remove(),crmui.showPopup("lv_filter_savePopup",!1),e){i.find("#lv_save_msg").text(I18n.getMsg("crm.filter.rename.label"));var a=$(t).attr("data-filterId"),r=$("#"+a).find("span:first");s.val(r.text().trim()).focus(),i.find("#save_filterId").val(a),i.find("form").attr("action",Crm.getCrmBasePath()+"/CustomView.do?action=updateFilterProps"),i.find("form").removeAttr("data-filters")}else i.find("#lv_save_msg").text(I18n.getMsg("crm.email.save.filter")),s.val("").focus(),i.find("#save_filterId").val(""),i.find("form").attr("action",Crm.getCrmBasePath()+"/CustomView.do?action=saveFilters"),i.find("form").attr("data-filters",!0);s.off("focus").on("focus",(function(){$(this).closest("td").addClass("wf_setFocus")}))}},crmListView.checkForDuplicateFilterNames=function(){for(var e=$("#filterName"),t=$("#lv_saved_filters").find("li"),i=t.find(".listText"),s=t.length,a=e.val().toLowerCase().trim(),r=$("#lv_filter_savePopup").find("#save_filterId").val(),l=0;l<s;l++)if(t.eq(l).attr("id")!==r&&i.eq(l).text().toLowerCase().trim()===a)return commonUtils.showErrorMsg(I18n.getMsg("crm.warning.duplicate.filter.name"),$("#filterName"),void 0,!0),!1;return!0},crmListView.saveFilters=function(e){$(".form_err_fld").removeClass("form_err_fld"),$(".errMsg").remove(),$(".form_err_msg").remove();var t=commonUtils.formData2QueryString(e);return!!(commonUtils.emptyCheck("filterName",I18n.getMsg("crm.email.filter.name"),void 0,void 0,"inline")&&checkSplChars("filterName",I18n.getMsg("crm.email.filter.name"),"inlineCenter")&&crmListView.checkForDuplicateFilterNames())&&($(e).attr("data-filters")&&(t+="&filters="+encodeURIComponent(JSON.stringify(customViewObject.filters))),t+="&"+Territory.csrf(),(new crmRequestPool).initiate({action:e.action,data:t,type:"POST",success:function(e){if(crmui.hidePopup("lv_filter_savePopup"),$("#lv_save_container").show(),e.module=customViewObject.module,e.cvId=customViewObject.cvId,e.displayFilterCount=customViewObject.displayFilterCount,e.route=Lyte.Router.getRouteInstance().transition.info.route,customViewObject.viewid){e.viewid=customViewObject.viewid;var t=crmListView.savedcanvasFiltersTemplate(e)}else t=crmListView.savedFiltersTemplate(e);var i=e.filterId;if($("#"+i).length)$("#"+i).replaceWith(t),crmListView.updateFilterInCache(e),crmui.showMsgBand("success",I18n.getMsg("crm.filter.save.msg",I18n.getMsg("crm.button.cvfilter")),"2000",""),$("#"+i+"_count").html("&nbsp;<b>"+crmTab.countCache[customViewObject.module][i]+"</b>&nbsp;");else{$("#lv_saved_filters").append(t),customViewObject.savedFilters.push(e),crmListView.showHideSavedFilters(!0),customViewObject.filterId=i;var s=crmTab.getFiltersFromCache(customViewObject.module);s&&(s.filterId=i),$(".f_listclick-view").removeClass("f_listclick-view"),crmui.showMsgBand("success",I18n.getMsg("crm.custom.module.complete.alert.title",I18n.getMsg("crm.button.cvfilter")),"2000","")}showTotalCount(void 0,void 0,!1),customViewObject.filterId===i&&($("#"+i).addClass("f_listclick-view"),crmTab.countCache[customViewObject.module]&&(crmTab.countCache[customViewObject.module][i]=crmTab.countCache[customViewObject.module].TotalCount),crmListView.renderFilterCount(crmTab.countCache[customViewObject.module])),crmListView.toggleFilterOptions(!1)},error:function(e){commonUtils.showHideLoadingDiv(),555==e.status&&e.responseText&&alert(e.responseText)}}),!1)},crmListView.updateFilterInCache=function(e){for(var t=e.filterId,i=customViewObject.savedFilters,s=i.length,a=0;a<s;a++){if(i[a].filterId===t){customViewObject.savedFilters[a]=e;break}}},crmListView.showFilterOptions=function(e,t,i){$("#"+t+"_count").next(".svgIcons").removeClass("dN"),$("#filterOptions").find("a").attr("data-filterId",t);var s={id:"filterOptions",clickSelector:"a"};Crm.menu.createMenu(e,s),renderingUtils.stopEvent(e);var a=$("#renameOpt");i?a.addClass("dN"):a.removeClass("dN")},crmListView.deleteFilter=function(e){var t={module:customViewObject.module,filterId:$("#filterOptions").find("a").attr("data-filterId")};t[csrfParamName]=encodeURIComponent(csrfToken),(new crmRequestPool).initiate({action:Crm.getCrmBasePath()+"/CustomView.do?action=deleteFilter",data:t,type:"POST",success:function(e){hideAnimatePopup("deletepopup"),$("#"+t.filterId).remove(),crmui.showMsgBand("success",I18n.getMsg("crm.filter.delete.msg"),"2000",""),$("#lv_saved_filters").find("li").length||$("#lv_save_container").hide(),crmListView.removeDeletedFilterFromCache(t.filterId),crmListView.bindPerfectScrollbar()}}),Crm.trackSpotLightAction("Delete Saved Filters",{Module:customViewObject.module})},crmListView.removeDeletedFilterFromCache=function(e){for(var t=customViewObject.savedFilters,i=t.length,s=0;s<i;s++){if(t[s].filterId===e){customViewObject.savedFilters.splice(s,1);break}}var a=customViewObject.module,r=crmTab.getFiltersFromCache(a);crmTab.deleteFromCacheCount(a,e),e===customViewObject.filterId&&(delete customViewObject.filterId,$("#lv_filter_submit").val(I18n.getMsg("crm.button.apply.filter"))),r&&r.filterId===e&&delete r.filterId},crmListView.showHideSavedFilters=function(e){$("#lv_saved_filter_div:visible").length&&!0!==e?$("#lv_saved_filter_div").slideUp(crmListView.bindPerfectScrollbar):$("#lv_saved_filter_div").slideDown(crmListView.bindPerfectScrollbar)},crmListView.reloadCurrentListView=function(e,t,i){document.getElementsByTagName("crm-list-view")[0];var s=Lyte.Router.getRouteInstance();if(crmTab.deleteFromCache(this.getObject().module),-1!=s.transition.target.indexOf("custom-view")){var a;"Visits"==this.getObject().module&&(a=customViewObject.screenName);var r,l=Object.keys(crmListView.startIndex).sort((function(e,t){return e-t}))[0];if(l=Number(l),!isNaN(l)){var o=Number(crmListView.getObject().currentOption);r=(l+o-1)/o}s.fetchCount=!0,s.getQueryParams().hasOwnProperty("page")&&r&&r!=s.getQueryParams().page?s.setQueryParams("page",r).data={clearCache:!0,portalName:a}:s.refresh({refreshTemplate:!0}).data={refreshTemplate:!0,portalName:a}}s.parent&&s.parent.parent&&"voc"===s.parent.parent.routeName&&(s.refresh().data={fetchOnlyBody:!0,clearCache:!0})},crmListView.mandatoryCheck=function(){var e=!1,t=!1;$("#columnListId li label input").each((function(){var i=$(this).attr("value");i&&-1!=i.indexOf("LASTNAME")&&$(this).is(":checked")&&(e=!0),i&&-1!=i.indexOf("FULLNAME")&&$(this).is(":checked")&&(t=!0)})),e&&t?$("#columnListId li label input").each((function(){var e=$(this).attr("value");-1!=e.indexOf("LASTNAME")&&$(this).prop("disabled",!1),-1!=e.indexOf("FULLNAME")&&$(this).prop("disabled",!1)})):e&&!t?$("#columnListId li label input").each((function(){var e=$(this).attr("value");-1!=e.indexOf("LASTNAME")&&$(this).prop("disabled",!0),-1!=e.indexOf("FULLNAME")&&$(this).prop("disabled",!1)})):!e&&t&&$("#columnListId li label input").each((function(){var e=$(this).attr("value");-1!=e.indexOf("LASTNAME")&&$(this).prop("disabled",!1),-1!=e.indexOf("FULLNAME")&&$(this).prop("disabled",!0)}))},crmListView.relatedMandatoryCheck=function(e){var t=!1,i=!1,s=$("#"+e+" li label input");s.each((function(){var e=$(this).attr("value");-1!=e.indexOf("LASTNAME")&&$(this).is(":checked")&&(t=!0),-1!=e.indexOf("FULLNAME")&&$(this).is(":checked")&&(i=!0)})),t&&i?s.each((function(){var e=$(this).attr("value");-1!=e.indexOf("LASTNAME")&&$(this).prop("disabled",!1),-1!=e.indexOf("FULLNAME")&&$(this).prop("disabled",!1)})):t&&!i?s.each((function(){var e=$(this).attr("value");-1!=e.indexOf("LASTNAME")&&$(this).prop("disabled",!0),-1!=e.indexOf("FULLNAME")&&$(this).prop("disabled",!1)})):!t&&i&&s.each((function(){var e=$(this).attr("value");-1!=e.indexOf("LASTNAME")&&$(this).prop("disabled",!1),-1!=e.indexOf("FULLNAME")&&$(this).prop("disabled",!0)}))},crmListView.createTableHeader=function(){$("#cvlist").length>0&&(void 0!==$("#cvlist").perfectScrollbar&&thirdPartyUtils.bindPerfectScroll("#cvlist",{wheelSpeed:1,preventOnEnd:!0,preventHorizontal:!0}),$("#lv_filter_scroll").length&&crmListView.bindPerfectScrollbar(),customViewObject.doMassActioninScheduler&&"inline"===$("#scheduleMassActionDiv").css("display")&&($("#checkAll").attr("class","customCheckBox"),crmListView.selectAllEntity("",$("#checkAll"))))},crmListView.viewCampSummaryOnClick=function(e,t){networkUtils.loadFeatureScripts(["ZCrmCampaigns.js"],(function(){ZCampaigns.onClickSummary(t)}))},crmListView.updateFilters=function(e){$(".saveTyp").hide();var t=crmListView.getObject(),i=$(e).attr("data-filterId");if(i){if(!t.filters)return alert(I18n.getMsg("crm.warning.select.filter")),!1;crmListView.toggleFilterOptions(!1);var s={action:"updateFilters",filters:JSON.stringify(t.filters),module:t.module,cvid:t.cvId,filterId:i};s[csrfParamName]=encodeURIComponent(csrfToken),(new crmRequestPool).initiate({action:Crm.getCrmBasePath()+"/CustomView.do",data:s,type:"POST",success:function(e){var t=crmListView.getObject(),s=t.module;t.filterId=i;var a=crmTab.getFiltersFromCache(s);a&&(a.filterId=i),crmTab.countCache[customViewObject.module]||(crmTab.countCache[customViewObject.module]={}),crmTab.countCache[customViewObject.module][i]=crmTab.countCache[customViewObject.module].TotalCount?crmTab.countCache[customViewObject.module].TotalCount:0,crmListView.renderFilterCount(crmTab.countCache[customViewObject.module]),crmui.showMsgBand("success",I18n.getMsg("crm.filter.save.msg",I18n.getMsg("crm.button.cvfilter")),"2000","")}})}},crmListView.cancelFilterSave=function(){$("#lv_saved_filters").find(".f_listclick-view").removeClass("f_listclick-view"),$("#lv_filter_save_menu").find(".saveTypBtn").eq(1).removeAttr("data-filterId"),crmListView.toggleFilterOptions(!1);var e=crmListView.getObject();crmTab.countCache[e.module]&&crmListView.renderFilterCount(crmTab.countCache[e.module]);e.filterId;delete e.filterId},crmListView.showFilterSaveOptions=function(e){var t={id:"lv_filter_save_menu",clickSelector:"div",setDefaultPos:!1};Crm.menu.createMenu(e,t),renderingUtils.stopEvent(e)},crmListView.compareAndFetchCount=function(e,t){var i=crmTab.countCache[t],s=!1;for(var a in e){if(i[a]&&i[a]!=e[a]){s=!0;break}i[a]=e[a]}s?(delete crmTab.countCache[module],showTotalCount($("#tcDiv #totalRecordsCount"),void 0,"true",!0)):crmListView.renderFilterCount(crmTab.countCache[t],$("#tcDiv #totalRecordsCount"),t)},crmListView.checkSelectedCondVal=function(e,t){var i=$(e).attr("id").split("_")[1],s=$("#filter_"+i).attr("data-value").split(":")[1],a=$("#filter_"+i).attr("data-value").split(":")[0];if("T"==t&&"EMAIL"===s){var r=$("[data-value='"+a+":ADDN_EMAIL']");if(0===r.length)return;var l=r.attr("id").split("_")[1],o=$("#"+("textcondition1_"+l)+" option:selected").val(),n="textcondition1_"+i;$($("#"+n+" option")[$("#"+n+" option").length-1]).show(),$($("#"+n+" option")[$("#"+n+" option").length-2]).show(),!r.is(":checked")||"${BLOCKED}"!==o&&"${NOTBLOCKED}"!==o||($($("#"+n+" option")[$("#"+n+" option").length-1]).hide(),$($("#"+n+" option")[$("#"+n+" option").length-2]).hide())}else if("T"==t&&"ADDN_EMAIL"===s){var c=$("[data-value='CrmLeadDetails:EMAIL']");if(0===c.length)return;l=c.attr("id").split("_")[1],o=$("#"+("textcondition1_"+l)+" option:selected").val(),n="textcondition1_"+i;$($("#"+n+" option")[$("#"+n+" option").length-1]).show(),$($("#"+n+" option")[$("#"+n+" option").length-2]).show(),!c.is(":checked")||"${BLOCKED}"!==o&&"${NOTBLOCKED}"!==o||($($("#"+n+" option")[$("#"+n+" option").length-1]).hide(),$($("#"+n+" option")[$("#"+n+" option").length-2]).hide())}},crmListView.callChecked=function(e){var t=$(e),i=t.parents("#emailFilterSentiment");i.find("label").next(".cBoth").hide(),i.find("#lv_email_sentiment_date").hide();var s=t.parents("label").find("input").attr("data-value");if(t.is(":checked")){var a=t.parents("li:not(.facet)"),r=a.find("label").next(".cBoth"),l=a.find("label").next(".cBoth");"COUNT"===s||"PERCENTAGE"===s?(r.show(),l.show()):"LASTMAIL"===s?(r.hide(),l.show()):"NOTHING"!==s&&"ONLY"!==s||(r.removeClass("hide").show(),l.show()),$(".andsecClear").show()}},crmListView.getActivitySubModule=function(e,t,i){if(!e)return t;if("${EMPTY}"==e||"${NOTEMPTY}"==e){for(var s=i.length,a=0;a<s;a++){var r=i[a];if("tag"!=r.searchfieldtype&&(null!=r.searchfield&&"CrmActivity:SETYPE"==r.searchfield&&null!=r.value))return r.value}return"Tasks"}var l=["Tasks","Calls","Events"],o=e.split(",");for(a=0;a<3;a++)for(var n=Crm.jsonSelectValues.Tags[l[a]],c=n.length,d=0;d<c;d++){var m=n[d];if(null!=m&&m.id&&o.contains(m.id))return l[a]}return t},crmListView.sectionInpClear=function(){var e=$(".emailFilterSentimentSecClear");e.find('input[type="radio"]').prop("checked",!1),e.find("li .cBoth").hide(),$(".andsecClear").hide(),crmListView.toggleFilterOptions(!1,!0)},crmListView.showSentimentSubFilterOptions=function(e){var t=$(e).val();"POSITIVE_AND_NEGATIVE"==t?($(".sentimentinpercentage").show(),$(".sentimentforthelastmail").hide()):"POSITIVE_ONLY"==t||"NEGATIVE_ONLY"==t?($(".sentimentforthelastmail").hide(),$(".sentimentinpercentage").hide()):$(".sentimentinpercentage, .sentimentforthelastmail").show()},crmListView.showPredictionToolTip=function(e){var t="<div class='w100_per mB10 mT15 crm-base-font-size crm-font-bold'>"+I18n.getMsg("crm.lead.prediction.tooltip")+"</div>";t+="<table border=0 cellpadding=0 cellspacing=0><thead><tr><td>"+I18n.getMsg("crm.lead.prediction.tooltip.convert")+"</td>",t+="<td>"+I18n.getMsg("crm.lead.prediction.tooltip.score")+"</td></tr></thead>",t+="<tbody id=lvTred><tr><td>"+I18n.getMsg("crm.lead.prediction.convert.high")+"</td>",t+="<td>61 - 100</td></tr><tr><td>"+I18n.getMsg("crm.lead.prediction.convert.medium")+"</td>",t+="<td>41 - 60</td></tr><tr><td>"+I18n.getMsg("crm.lead.prediction.convert.low")+"</td>",t+="<td>1 - 40</td></tr></tbody></table>",crmui.showTooltip(t,!0,"left",e),$("#wf_tooltip").addClass("wf_tooltip_bgwhite")},crmListView.validateBetweenCrt=function(e,t){return!!commonUtils.compareNumber(e.val().replace(/^\s+/g,"").replace(/\s+$/g,""),t.val().replace(/^\s+/g,"").replace(/\s+$/g,""))},crmListView.validateNumberIsInBetween=function(e,t,i){var s=!1,a=parseInt(e.replace(/^\s+/g,"")),r=parseInt(t.replace(/^\s+/g,"")),l=parseInt(i.replace(/^\s+/g,""));return a===r||l>=a&&l<=r&&(s=!0),s},crmListView.predictionFilterValidation=function(e,t,i,s){var a,r,l,o,n,c=e.val(),d=t;return!($(e).is(":checked")&&("LPSCR"==i&&(null!=s&&"14"!=s?d=t.eq(0):null!=s&&"14"===s&&(d=t.eq(1)),n=d.val(),"high"==c?(l="61",o="100",a="High"):"medium"==c?(l="41",o="60",a="Medium"):"low"==c&&(l="1",o="40",a="Low")),r=l+" - "+o,!crmListView.validateNumberIsInBetween(l,o,n)))||($("#pre_check1").html(I18n.getMsg("crm.lead.prediction.popup.text",[a,r])),crmui.showPopup("showAlertForConfirmation"),!1)},crmListView.showCusTooltip=function(e,t,i){if(0==$("#"+e).length){var s=$(event.target),a=$("<div>"),r=$("<div>");a.attr({id:e,class:"cusTooltip wf_tooltip fs bottom left "+i}),r.attr({id:e+"ctn",class:"cusTooltipCtn"}).html(t),a.append(r),$("body").append(a),$("#"+e).css({top:s.offset().top+s.outerHeight()+2,left:s.offset().left+8}).show()}else{s=$(event.target);$("#"+e+"ctn").html(t),$("#"+e).css({top:s.offset().top+s.outerHeight()+2,left:s.offset().left+8}).show()}},crmListView.hideCusTooltip=function(e){$("#"+e).hide()},crmListView.evaluteHistoryTracker=function(e){var t=$(".historyMoreOpt"),i=$(".historyMoreOpt").find("li"),s=t.find(".rbCheckHtml"),a=i.find(".durationFilter");$(e).val().length>10||0==$(e).val().length?(t.addClass("disableHistory"),t.find('input[type="checkbox"]').attr("checked",""),t.find("input,select").attr("disabled",!0),a.find("input").val(""),a.closest("li").find(".rbCheckHtml").find("input").removeAttr("checked"),a.addClass("eventNone"),a.find("select option:first-child").prop("selected",!0),$(e).val().length>10&&(s.attr("onmouseenter"," crmListView.showCusTooltip('cusTooltip','"+I18n.getMsg("crm.smartfilter.picklist.options.msg")+"','custWidth')"),s.attr("onmouseleave","crmListView.hideCusTooltip('cusTooltip');"))):(t.removeClass("disableHistory"),t.find("input,select").removeAttr("disabled"),s.removeAttr("onmouseenter onmouseleave"))},crmListView.picklistDuration=function(e){var t=$(e).closest("li").find(".durationFilter"),i=t.find("input,select"),s=t.find("input"),a=t.find("select");$(e).is(":checked")?(i.attr("disabled",!1),t.removeClass("eventNone")):(i.attr("disabled",!0),t.addClass("eventNone"),s.val(""),a.find("option:first-child").prop("selected",!0))},crmListView.addTOSeries=function(e,t,i,s){var a={},r=[];a.module=moduleApiMapping[i],a.active=!0,store.findAll("cadence",a).then((e=>{for(var t=[],a=e.length,l=0;l<a;l++)(!s||"CUSTOMVIEW"!==e[l].type&&"Custom view"!==e[l].type)&&t.push(e[l]);r=t;var o=networkUtils.returnDependencyFiles(["crm-add-to-series.js","series_mixin.js"],ResourceConstants.CRMClient);o=(o=o.concat(networkUtils.returnDependencyFiles(["series_store.js"],ResourceConstants.CRMClient))).concat(networkUtils.returnDependencyFiles(["series-configs.css"],ResourceConstants.CRMClient,ResourceConstants.LESSDEFAULT));var n=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("Series")],ResourceConstants.CRM),c=o.concat(n);Lyte.injectResources(c,void 0,(function(){Lyte.Component.render("crm-add-to-series",{isFromenrol:s,series_rules:r,module:i},"#show")})),setTimeout((function(){commonUtils.showHideLoadingDiv(!1)}),100)}),(function(e){403===e.status&&(commonUtils.showHideLoadingDiv(!1),setTimeout((function(){renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error"))}),10))}))},crmListView.addToCampaigns=function(e,t,i,s){var a=$(t).attr("data-relid"),r=[],l="",o={},n="";if(a=!a&&s?s:a){l=Crm.userDetails.isRelatedListLyteEnabled?Lyte.registeredMixins["crm-related-list-utils"].getPersonalityModuleObj(a).module.api_name:crmRelatedList.getPersonalityModuleObj(a).module,n="relatedList";var c="CB_"+a;i&&Crm.userDetails.isRelatedListLyteEnabled?r=i:CustomButtonJSObjectInit.checkBox&&CustomButtonJSObjectInit.checkBox[c]&&CustomButtonJSObjectInit.checkBox[c].length&&(r=CustomButtonJSObjectInit.checkBox[c]),o.listRelationId=a}else l=crmListView.getObject().module,n="listView",r=crmTab.getFromCache(l).selectedIds;if(!r.length>0)crmui.showMsgBand("error",I18n.getMsg("crm.campaign.member.email.empty"),3e3);else{crmListView.memberCopyObj={frommodule:l,idList:r.join(";"),from:n},a&&(crmListView.memberCopyObj.listRelationId=a,o.campaign_id=detailView.entityId),o.memberStatus=store.peekAll("campaign_status"),o.showPopup=!0;var d=networkUtils.returnDependencyFiles(["crm-add-to-campaign-popup.js"],ResourceConstants.CRMClient),m=networkUtils.returnDependencyFiles(["crm-add-to-campaign-popup.css"],ResourceConstants.CRMClient),u=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("variables")],ResourceConstants.CRM),p=d.concat(m);p=p.concat(u);Lyte.injectResources(p,void 0,(function(){Lyte.Component.render("crm-add-to-campaign-popup",o,"#show")})),crmListView.trackAddToCampaignClick(n)}},crmListView.createNewCampaignwithMembers=function(e,t,i,s){if(Crm.userDetails.isStorageLimitReached)Crm.showStorageExceedPopup();else{var a,r=$(t),l=r.attr("data-relid"),o=r.data("layoutid"),n=[],c="",d="";if(l=!l&&s?s:l){d="relatedList",c=Crm.userDetails.isRelatedListLyteEnabled?Lyte.registeredMixins["crm-related-list-utils"].getPersonalityModuleObj(l).module.api_name:crmRelatedList.getPersonalityModuleObj(l).module;var m="CB_"+l;if(i&&Crm.userDetails.isRelatedListLyteEnabled?n=i:Lyte.Globals.get("relatedList.campaignSelectedIds")&&Crm.userDetails.isRelatedListLyteEnabled?n=Lyte.Globals.get("relatedList.campaignSelectedIds"):CustomButtonJSObjectInit.checkBox&&CustomButtonJSObjectInit.checkBox[m]&&CustomButtonJSObjectInit.checkBox[m].length&&(n=CustomButtonJSObjectInit.checkBox[m]),Crm.renderDVLyteFlow("Campaigns"))a=$L("crm-detail-view")[0].component.data.record.id;else a=detailView.entityId}else d="listView",c=crmListView.getObject().module,n=crmTab.getFromCache(c).selectedIds;if(!n.length>0)crmui.showMsgBand("error",I18n.getMsg("crm.campaign.member.email.empty"),3e3);else{crmListView.createCampaignMemberObj={member_info:{module:c,idList:n,from:d},parentCampaignId:a};var u=Crm.getCrmBasePath()+"/QuickCreateAction.do?module=Campaigns&createWithMember=true&searchmodule=Campaigns&newModel=true";a&&(u=u+"&parentCampaignId="+a),o&&(u=u+"&layoutId="+o),commonUtils.openCustomLookup(u,void 0,"searchCreatePopup"),crmListView.trackCampaignCreatePage("Entity_"+d,r.text())}}},crmListView.getMemberStatusArray=function(){var e=crmListView.getObject();return e&&e.modulePicklistValues&&e.modulePicklistValues["Campaign Members"]?crmListView.getObject().modulePicklistValues["Campaign Members"].MEMBERSTATUS:returnJson&&returnJson[detailView.currentModule]&&returnJson[detailView.currentModule]["Campaign Members"]?returnJson[detailView.currentModule]["Campaign Members"].MEMBERSTATUS:"add-to-campaigns"===Lyte.Router.getRouteInstance().routeName?bulkAddWizard.MEMBERSTATUS:void 0},crmListView.trackCampaignCreatePage=function(e,t){var i={from:e,layoutType:t,filtersUsed:Crm.userDetails.isRelatedListLyteEnabled?Lyte.Globals.get("relatedList.filters"):validationUtils.isNotEmpty(crmRelatedList.filters)};Crm.trackSpotLightAction("Campaign Create Form Rendered",i)},crmListView.trackAddToCampaignClick=function(e){var t={from:e,filtersUsed:Crm.userDetails.isRelatedListLyteEnabled?Lyte.Globals.get("relatedList.filters"):validationUtils.isNotEmpty(crmRelatedList.filters)};Crm.trackSpotLightAction("Add To Campaign Click",t)},crmListView.trackAddToCampaignSave=function(e){var t={campaignType:e};Crm.trackSpotLightAction("Add To Campaign Save",t)},crmListView.trackInviteMail=function(e){var t={campaignType:e};Crm.trackSpotLightAction("Campaign Integ - Invite Mail Sent",t)},crmListView.trackSendMailClickFromRL=function(e){var t={module:e,filtersUsed:Crm.userDetails.isRelatedListLyteEnabled?Lyte.Globals.get("relatedList.filters"):validationUtils.isNotEmpty(crmRelatedList.filters),campType:detailView.getCurrentCampaignType()};Crm.trackSpotLightAction("Send Mail Click From RL",t)},crmListView.pinUnpinAction=function(e,t){t.stopPropagation(),crmui.hideTooltip();var i=$(e.parentElement);if(i.removeClass("multiselectable-previous selectedElem"),!(e.classList.contains("pinDisabled")&&i[0].classList.contains("unPinField")||i[0].classList.contains("DisablePinFieldAction"))){i.css({background:""}),i.children().filter(".lArrowIcon").hide();var s=$(e);s.removeAttr("lt-prop-title");var a=s.attr("value"),r=i[0].parentElement,l=$("#selectedColumns"),o=l.find(".pinIcon"),n=o.filter(".pinIconActive").length,c=i.attr("mandatory"),d=Crm.userDetails.customViewPinLimit?Crm.userDetails.customViewPinLimit:"1";if(!("Pin Column"!==a||e.classList.contains("pinDisabled")||r.classList.contains("pinnedUl")&&n>=d)){var m=-1===crmListView.originalOrder.indexOf(i[0].getAttribute("field_id"))?i.index():crmListView.originalOrder.indexOf(i[0].getAttribute("field_id"));if(i.attr("pin-index",m),s.addClass("pinIconActive noRemovedItem"),s.attr({value:"unPin Column",style:"display : inline; cursor : pointer"}),s.html("<crmutil-icon icon-name='thumbuntack' icon-class='zcicn-thumbuntack crmBaseIcon '></crmutil-icon>"),i.addClass("pinField"),i.removeClass("unPinField"),$(r).addClass("pinnedUl"),n+1>=d){var u=o.not(".pinIconActive");u.html("<crmutil-icon icon-name='thumbtack' icon-class='zcicn-thumbtack crmBaseIcon '></crmutil-icon>"),u.addClass("pinDisabled"),u.attr("style","display : none; opacity: 0.5; cursor: default;")}r.insertBefore(i[0],r.childNodes[n]),l.scrollTop(0)}if("unPin Column"===a&&e.classList.contains("pinIconActive")&&r.classList.contains("pinnedUl")){m=parseInt(-1===crmListView.originalOrder.indexOf(i[0].getAttribute("field_id"))?i.attr("pin-index"):crmListView.originalOrder.indexOf(i[0].getAttribute("field_id")));i.removeClass("pinField"),i.addClass("unPinField"),i.removeAttr("pin-index"),1===n&&$(r).removeClass("pinnedUl");var p=o.not(".pinIconActive");p.html("<crmutil-icon icon-name='thumbtack' icon-class='zcicn-thumbtack crmBaseIcon '></crmutil-icon>"),p.removeClass("pinDisabled"),p.attr({value:"Pin Column",style:"display : none; cursor : pointer"});var f=i.find(".pinIconActive");f.removeClass("pinIconActive"),c||s.removeClass("noRemovedItem"),f.attr({value:"Pin Column",style:"display : none; cursor : pointer"}),f.html("<crmutil-icon icon-name='thumbtack' icon-class='zcicn-thumbtack crmBaseIcon '></crmutil-icon>");var v=l.find("li"),g=v.length,h=!1;if(m>=g-1)v.eq(g-1).after(i[0]),h=!0;else for(var w=n;w<g;w++)if(m<=crmListView.originalOrder.indexOf(v[w].getAttribute("field_id"))){v.eq(w).before(i[0]),h=!0;break}h||v.eq(g-1).after(i[0])}}},Handlebars.registerHelper("layoutHasPipelines",(function(e,t,i){for(var s=e.length,a=0;a<s;a++){var r=e[a].fields.filterBy({column_name:"PIPELINE"});if(r.length&&r[0][t])return i.fn(r[0][t].pick_list_values)}return i.inverse(this)})),Handlebars.registerHelper("getRebrandValueByKey",(function(e){return RebrandLinkUtil.getProperty(e)})),crmListView.setHideActionInModule=function(){var e=moduleRecordMapping[customViewObject.module].actions;if(e&&e.length&&!e.filter((function(e){return"hideSelectAllRecords"==e.name})).length){moduleRecordMapping[customViewObject.module].actions.push({display_label:"Select all  records in this view",layouts:null,name:"hideSelectAllRecords",type:"action"})}},crmListView.onLinkClick=async function(e,t,i){if(featuresAvailable.PUBLIC_FIELD&&void 0!==moduleRecordMapping[e]&&moduleRecordMapping[e].public_fields_configured)return void 0!==i&&(i.preventDefault(),i.stopImmediatePropagation(),i.stopPropagation()),!await Lyte.registeredMixins["crm-view-utils"].checkAndRenderPublicFields(e,t,i);{let s="_self";void 0!==i?(!0!==i.ctrlKey&&!0!==i.metaKey&&2!==i.which||networkUtils.openUrl(window.location.origin+Crm.getCrmBasePath()+"/tab/"+e+"/"+t,"_blank"),s="A"===i.target.tagName&&"_blank"===i.target.target||"LYTE-TEXT"===i.target.tagName&&"A"===i.target.parentElement.tagName&&"_blank"===i.target.parentElement.target||"TD"===i.target.tagName&&null!==i.target.parentElement.getAttribute("target")&&"_blank"===i.target.parentElement.getAttribute("target")?"_blank":"_self"):s="_blank",networkUtils.openUrl(window.location.origin+Crm.getCrmBasePath()+"/tab/"+e+"/"+t,s)}};