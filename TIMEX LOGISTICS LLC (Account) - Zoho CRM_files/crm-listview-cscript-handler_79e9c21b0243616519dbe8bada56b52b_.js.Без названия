var ListViewHandler=function(){var t={maskValue:function(t,e){const o=e.length;return t=e.reverse?t.substring(0,t.length-o)+(o<t.length?e.character.repeat(o):e.character.repeat(t.length)):(o<t.length?e.character.repeat(o):e.character.repeat(t.length))+t.substring(o)},addMask:function(e){const o=$L("crux-table-component")[0].component,n=Object.keys(e),a=o.getData("cxPropHeader");n.forEach((function(t){a.forEach((function(o){o.api_name===t&&(o.cxPropMaskingProperties=objectUtils.cloneObject(e[t]))}))})),o.setData("cxPropHeader",a);const i={},r={},c=$L("crm-list-view")[0].component.getData("listfields"),s=document.querySelectorAll(`[id="${c[0].id}"]`);$L(s[s.length-1]).parent().children().each((function(t){r[$L(this).attr("id")]=t})),c.forEach((function(t){i[t.api_name]=r[t.id]})),o.getData("cxPropContent").forEach((function(o){var a,r=$L("#"+o.id);if(r.length)for(a of(r=r[0]._relatedRow&&$L(r[0]._relatedRow)||r,n)){if(void 0===i[a])continue;var c=r.children().eq(i[a]),s=c.find("lyte-text").length>0?c.find("lyte-text"):c;const o=s.length&&s[0].ltProp&&s[0].ltProp("value"),n=s.find("lyte-text").attr("lt-prop-value")||o||s.text().trim();if(n){const i=t.maskValue(n,e[a]);o&&s[0].ltProp("value",i),s[0].textContent=i}}}))},addStyle:function(e,o,n){CriteriaHandler.init(e).then((()=>{n.forEach((function(t){CriteriaHandler.validate(t.criteria,!0);var e=CriteriaHandler.filter_records(o,t.criteria),n={};if(t.column){var a={},i=$L("crm-list-view")[0].component.getData("listfields");const t=document.querySelectorAll(`[id="${i[0].id}"]`);$L(t[t.length-1]).parent().children().each((function(t){a[$L(this).attr("id")]=t})),i.forEach((function(t){n[t.api_name]=a[t.id]}))}var r=t.column?Object.keys(t.column):void 0;e.forEach((function(e){var o=$L("#"+e.id);if(o.length){if(o=o[0]._relatedRow&&$L(o[0]._relatedRow)||o,t.row){if(t.row.backgroundColor&&!/^#[0-9A-F]{6}$/i.test(t.row.backgroundColor))throw CScript.Error("Invalid background color code: "+t.row.backgroundColor);t.row.backgroundColor?o.children().css("backgroundColor",t.row.backgroundColor):o.children().css("backgroundColor","")}t.column&&r.forEach((function(e){if(n[e]){var a=o.children()[n[e]],i=t.column[e];if(i.backgroundColor&&!/^#[0-9A-F]{6}$/i.test(i.backgroundColor))throw CScript.Error("Invalid background color code: "+i.backgroundColor);if(i.foregroundColor&&!/^#[0-9A-F]{6}$/i.test(i.foregroundColor))throw CScript.Error("Invalid foreground color code: "+i.foregroundColor);a.style.backgroundColor=i.backgroundColor||"";const r=$L(a).find("lyte-text");r.length&&(r[0].style.fontWeight=i.fontWeight||"",r[0].style.color=i.foregroundColor||"")}}))}}))})),$L("crux-table-component")[0].component.methods.onScrollRecordsHaveBeenRendered=function(){var e=$L("crm-inner-list")[0].component;t.addMask(e.getData("masked_fields")),t.addStyle(e.getData("module"),e.getData("customview_records"),e.getData("styles"))}}))},PageInfo:function(){return{module:moduleRecordMapping[Lyte.Router.getRouteInstance().transition.info.dynamicParams[0]].api_name,name:"record_list"}},CustomView:{Set:async function(t){if(isNaN(t)||!/^\d+$/.test(t))throw CScript.Error(`invalid custom view id - ${t}`);if(Lyte.Router.getRouteInstance().currentModel.cvId!==t){var e=$L("crm-customview-layer")[0].component.getData("module");if(!await store.findRecord("custom_view",t,{module:moduleApiMapping[e]}))throw CScript.Error(`invalid custom view id - ${t}`);{const e=Lyte.Router.getRouteInstance();e.transitionTo({route:"crm.tab.module.custom-view.list",dynamicParams:[e.currentModel.module,t]}).data={reloadAll:!0}}}},Get:function(){return Lyte.Router.getRouteInstance().currentModel.cvId},Restrict:function(t){var e=$L("crm-customview-dropdown")[0].component,o=e.getData("cscriptChecks");o.hasOwnProperty("restricted")&&0!==o.restricted.length?o.restricted.contains(t)||o.restricted.push(t):o.restricted=[t],e.setData("cscriptChecks",o);var n=e.getData("customViewList");n.forEach((function(e,o){var a=Object.keys(e)[0];n[o][a]=e[a].filter((function(e){return e.id!==t}))}))},Permit:function(t){var e=$L("crm-customview-dropdown")[0].component,o=e.getData("cscriptChecks");o.hasOwnProperty("restricted")&&o.restricted.length>0&&o.restricted.deleteElementAt(o.restricted.indexOf(t)),e.setData("cscriptChecks",o);var n=store.peekRecord("custom_view",t),a=e.getData("customViewList");a.forEach((function(t,e){var o=Object.keys(t)[0];o===n.category&&a[e][o].push(n)}))},Hide:function(){$L('[data-zcqa="cv_edit"]').hide(),$L("crm-customview-dropdown").hide(),$L("#cvDropBox").hide()},Show:function(){$L('[data-zcqa="cv_edit"]').show(),$L("crm-customview-dropdown").show(),$L("#cvDropBox").show()},GetOptions:async function(){return(await store.findAll("custom_view",{module:moduleRecordMapping[$L("crm-customview-layer")[0].component.getData("module")].api_name},void 0,void 0,{unloadCustomview:!1})).map((t=>({name:t.display_value||t.display_label,id:t.id})))}},View:{ViewNameMap:{list:"list_view",kanban:"kanban_view",canvas:"canvas_view"},ViewNameReverseMap:{list_view:"list",kanban_view:"kanban",canvas_view:"canvas"},Hide:function(){$L("lyte-td.alignRight").find("div.view_icon").hide(),$L('[cscript-tag="list-view-type-drop-down"]').hide()},Show:function(){$L("lyte-td.alignRight").find("div.view_icon").show(),$L('[cscript-tag="list-view-type-drop-down"]').show()},Get:function(){var e=Lyte.Router.getRouteInstance();return t.View.ViewNameMap[e.routeName]},Set:function(e){var o=t.View.ViewNameReverseMap[e];if(-1===["list","canvas","kanban"].indexOf(o))throw CScript.Error("invalid view type: "+e);if("canvas"===o&&0===$("[cscript-tag='list-view-type-drop-down']").find("[data-value='canvas']").length)throw CScript.Error("canvas view not available for the module");if(!$("#KanbanViewPopup").is(":visible")){var n=Lyte.Router.getRouteInstance(),a=$L("crm-customview-layer")[0].component,i=n.getQueryParams(),r={},c=a.getData("cvid");if("kanban"===n.routeName&&"kanban"!==o&&-1!==["Activities","Visits"].indexOf(a.data.module)){var s=a;store.findAll("filter",{module:moduleRecordMapping[a.data.module].api_name,cvid:n.parent.getDynamicParam()},!0,void 0,{module:moduleRecordMapping[a.data.module].api_name,cvid:n.parent.getDynamicParam()}).then((function(t){s.setSavedFilter(t)}))}"zia"===o||-1!==["Activities","Visits"].indexOf(a.data.module)&&"kanban"===o||(i.filters&&(r.filters=i.filters),i.cross_filters&&(r.cross_filters=i.cross_filters),i.filter_id&&(r.filter_id=i.filter_id)),"zia"===o&&delete r.filter_id,r.page=1;var u={},d={clearCache:!0};switch(o){case"list":u.route=c?"crm.tab.module.custom-view.list":"crm.tab.module",u.dynamicParams=c?[a.getData("module"),c]:[a.getData("module")],u.queryParams=r,d.portalName=a.getData("screenName");break;case"kanban":u.route=c?"crm.tab.module.custom-view.kanban":"crm.tab.module",u.dynamicParams=c?[a.getData("module"),c]:[a.getData("module")],u.queryParams=r,d.portalName=a.getData("screenName");break;case"zia":u.route="crm.tab.module.custom-view.zia",u.dynamicParams=[a.getData("module"),c],u.queryParams=r;break;case"canvas":void 0===c?(u.route="crm.tab.module",u.dynamicParams=[a.getData("module")],u.queryParams=r,d.portalName=a.getData("screenName")):a.getData("module_info").viewid?(u.route="crm.tab.module.custom-view.canvas",u.dynamicParams=[a.getData("module"),c,a.getData("module_info").viewid],u.queryParams=r):(u.route="crm.settings.canvas.begin",u.queryParams={module:a.getData("module")})}Lyte.Router.transitionTo(u).data=d}}},Button:{allButtons:["create","create_task","create_event","create_call","import"],Get:function(t){return $L('[cscript-tag="'+t+'"]')},GetAll:function(){var e=[];return $L("[cscript-id=system_button]").each((function(){const t=$L(this);e.push({api_name:t.attr("cscript-tag"),type:"system",name:t.text()})})),e=(e=e.concat(t.Button.Actions.GetAll())).concat(t.Button.Custom.GetAll())},IsPresent:function(e){var o=null;return t.Button.GetAll().forEach((function(t){t.api_name!==e&&t.id!==e||(o=t)})),o},Hide:function(e){var o=t.Button.Get(e);if(t.Button.allButtons.indexOf(e)>=0)switch(e){case"create":o.addClass("op5").parent().addClass("pointerEventsNone");break;case"actions":t.Button.Actions.Hide();break;case"custom":t.Button.Custom.Hide();break;case"import":o.attr("lt-prop-style","border: none !important").find("button").addClass("op5 pointerEventsNone");break;default:$(`[cscript-tag="${e}"]`)[0].ltProp("disabled",!0)}else/^-?[\d.]+(?:e-?\d+)?$/.test(e)?t.Button.Restrict("custom",e):t.Button.Restrict("actions",e)},Show:function(e){var o=t.Button.Get(e);if(t.Button.allButtons.indexOf(e)>=0)switch(e){case"create":o.removeClass("op5").parent().removeClass("pointerEventsNone");break;case"actions":t.Button.Actions.Show();break;case"custom":t.Button.Custom.Show();break;case"import":o.removeAttr("lt-prop-style","border: none !important").find("button").removeClass("op5 pointerEventsNone");break;default:$(`[cscript-tag="${e}"]`)[0].ltProp("disabled",!1)}else/^-?[\d.]+(?:e-?\d+)?$/.test(e)?t.Button.Permit("custom",e):t.Button.Permit("actions",e)},Permit:function(e,o){"actions"===e?t.Button.Actions.Permit(o):"custom"===e&&t.Button.Custom.Permit(o)},Restrict:function(e,o){"actions"===e?t.Button.Actions.Restrict(o):"custom"===e&&t.Button.Custom.Restrict(o)},SetValue:function(e,o){var n=t.Button.Get(e);t.Button.allButtons.indexOf(e)>=0?"lyte-button"===n[0].localName?n.find("lyte-yield").text(o):n.text(o):/^-?[\d.]+(?:e-?\d+)?$/.test(e)?t.Button.Custom.SetValue(e,o):t.Button.Actions.SetValue(e,o)},Click:function(e){var o=t.Button.Get(e);t.Button.allButtons.indexOf(e)>=0?o.click():/^-?[\d.]+(?:e-?\d+)?$/.test(e)?t.Button.Custom.Click(e):t.Button.Actions.Click(e)},Actions:{GetAll:function(){var t=$L("crm-customview-layer")[0].component.getData("actions");const e=new Set,o=new Set(["create_client_script","manage_client_script"]);var n=[];return t.forEach((function(t){e.has(t.name)||o.has(t.name)||(e.add(t.name),n.push({api_name:t.name,type:"system",name:t.display_label}))})),n},SetValue:function(t,e){var o;if($L("crm-customview-layer")[0].component.getData("actions").each((function(n){n.name===t&&(o=n.type,n.display_label=e)})),"action"===o){var n=moduleRecordMapping[module].actions;n.each((function(o){o.name===t&&(o.display_label=e)})),moduleRecordMapping[module].actions=n}$L('[cscript-tag="'+t+'"] a').text(e)},Click:function(t){$L('[cscript-tag="'+t+'"]').click()},Hide:function(){var t=$L("crm-customview-layer")[0].component,e=t.data.module,o=t.getData("actions"),n=t.getData("cscriptChecks"),a=new Array,i=o.filter((function(t){return a.push(t),!1}));moduleRecordMapping[e].actions=i,n.hasOwnProperty("restrictedActions")&&n.restrictedActions.length>0?n.restrictedActions=n.restrictedActions.concat(a):n.restrictedActions=a,t.setData("actions",i),t.setData("cscriptChecks",n),$L("crm-customview-layer").find("#moreTools").hide()},Show:function(){const t=$(`[cscript-tag="${action_name}"`);t.removeClass("customViewDisabled peNone"),t.parent().removeClass("customViewDisabled peNone")},Restrict:function(t){$L("crm-custom-outer-box")[0].component.getData("cscript_restricted_actions").add(t)},Permit:function(t){$L("crm-custom-outer-box")[0].component.getData("cscript_restricted_actions").delete(t)}},Custom:{GetAll:function(){var t=["list_view","list_view_without_record","list_view_each_record"],e=[],o=Lyte.Router.getRouteInstance().currentModel.module;return store.peekAll("custom_button",{module:moduleRecordMapping[o].api_name}).forEach((o=>{t.indexOf(o.position)>-1&&e.push(o)})),e.map((function(t){return{name:t.name,id:t.id,type:"custom"}}))},Hide:function(){$L('span[id^="customButtonDetails_"]').disable(),$L("crm-customview-layer").find("crm-custom-button").disable()},Show:function(){$L('span[id^="customButtonDetails_"]').enable(),$L("crm-customview-layer").find("crm-custom-button").enable()},Click:function(t){var e=Lyte.Router.getRouteInstance().transition.info.dynamicParams;CustomButtonJSObjectInit.execute(t,"",e[1],"",e[0])},SetValue:function(t,e){var o,n=Lyte.Router.getRouteInstance().transition.info.dynamicParams[0];if(store.peekAll("custom_button",{module:moduleRecordMapping[n].api_name}).forEach((n=>{n.id===t&&(n.name=e,o=n.position)})),"list_view_without_record"===o)(i=(a=$L("crm-customview-layer").find("crm-custom-button")[0].component).getData("customButtons")).forEach((function(o){o.id===t&&(o.name=e)})),a.setData("customButtons",i);else if("list_view_each_record"===o){var a,i;(i=(a=$L("crm-list-view")[0].component).getData("list_cv_btn")).forEach((function(o){o.id===t&&(o.name=e)})),a.setData("list_cv_btn",i)}$L('[cscript-tag="customBtn_'+t+'"]').each((function(t,o){"lyte-button"===o.localName?$L(this).find("lyte-yield").text(e):$L(this).text(e)}))},Restrict:function(t){var e,o=Lyte.Router.getRouteInstance().transition.info.dynamicParams[0];switch(store.peekAll("custom_button",{module:moduleRecordMapping[o].api_name}).forEach((o=>{o.id===t&&(e=o.position)})),e){case"list_view_without_record":var n=$L("crm-customview-layer").find("crm-custom-button"),a=(i=n[0].component).getData("customButtons").filter((function(e){return e.id!==t}));i.setData("customButtons",a),0===a.length&&n.hide();break;case"list_view_each_record":var i;a=(i=$L("crm-list-view")[0].component).getData("list_cv_btn").filter((function(e){return e.id!==t})),i.setData("list_cv_btn",a),0===a.length&&$L('span[id^="customButtonDetails_"]').hide();break;case"list_view":var r=$L("crm-custom-outer-box")[0].component.getData("restrictedCustomButtons");-1===r.indexOf(t)&&Lyte.arrayUtils(r,"push",t)}},Permit:function(t){var e,o=Lyte.Router.getRouteInstance().transition.info.dynamicParams[0];store.findAll("custom_button",{module:moduleRecordMapping[o].api_name}).then((o=>{var n=new Array;if(o.forEach((o=>{o.id===t&&(e=o.position,n.push(o))})),"list_view_each_record"===e){var a=(i=$L("crm-list-view")[0].component).getData("list_cv_btn");i.setData("list_cv_btn",a.concat(n)),$L('span[id^="customButtonDetails_"]').show()}else if("list_view_without_record"===e&&n.length>0){var i,r=$L("crm-customview-layer").find("crm-custom-button");a=(i=r[0].component).getData("customButtons"),i.setData("customButtons",a.concat(n)),r.show()}}))}}},PerPage:{Get:function(){return Lyte.Router.getRouteInstance().currentModel.per_page},Set:function(t){var e=$L("crm-page-navigator")[0].component;if(e.data.total_count>e.data.page*e.data.per_page||!e.data.total_count){e.setData("per_page",t);var o=e.getData("page");e.throwEvent("getRecord",t,o,!1,"next",e.getData("startIndex"))}},Hide:function(){$L("[data-zcqa='dash_currentOption']").hide()},Show:function(){$L("[data-zcqa='dash_currentOption']").show()}},Page:{Get:function(){return Lyte.Router.getRouteInstance().currentModel.page},Next:function(){var t=$L("crm-page-navigator")[0].component;if(t.data.total_count>t.data.page*t.data.per_page||!t.data.total_count){var e=t.getData("page")+1;t.setData("page",e);var o=t.getData("per_page");t.throwEvent("getRecord",o,e,!1,"next",t.getData("startIndex"))}},Set:function(t){var e=$L("crm-page-navigator")[0].component;if(e.data.total_count>e.data.page*e.data.per_page||!e.data.total_count){e.setData("page",t);var o=e.getData("per_page");e.throwEvent("getRecord",o,t,!1,"next",e.getData("startIndex"))}},Previous:function(){var t=$L("crm-page-navigator")[0].component,e=t.getData("page");if(e>1){e-=1,t.setData("page",e);var o=t.getData("per_page");t.throwEvent("getRecord",o,e,!1,"previous",t.getData("startIndex"))}},Show:function(){$L("crm-page-navigator").show()},Hide:function(){$L("crm-page-navigator").hide()}},Filter:{Hide:function(){$L("#lv_filter_hide").click(),$L("crm-custom-filter").hide(),$L("#lv_filter_hide").hide(),$L("span.newListviewFilterIcon").parent().css("display","none")},Show:function(){$L("crm-custom-filter").show(),$L("#lv_filter_hide").show(),$L("#lv_filter_hide").click(),$L("span.newListviewFilterIcon").parent().css("display","table-cell")},ClearFields:function(){$L("#customFilter")[0].resetFields()},Set:async function(t){const e=Lyte.Router.getRouteInstance(),o=e.transition.info.dynamicParams[0];if(await CriteriaHandler.init(o),!t||!t.trim())throw CScript.Error("invalid criteria");t.startsWith("(")||(t="("+t+")"),CriteriaHandler.validate(t,void 0,!0),await CriteriaHandler.validate_lookups(t),t.includes("(Tag:")&&await store.findAll("tag",{module:o,fromPage:"view"});const n=CriteriaHandler.convert_to_filter_criteria(t,"advanced_filter");$("crm-custom-filter")[0].component.criteria=n,e.setQueryParams({filters:JSON.stringify(n),filter_id:void 0}).data={clearCache:!0,clearselectedIds:!0}},Get:function(){var t=Lyte.Router.getRouteInstance(),e=t.currentModel.module;return new Promise((function(o){CriteriaHandler.init(e).then((()=>{var e=t.getQueryParams().filters,n=t.getQueryParams().filter_id,a=n?store.peekRecord("filter",n).criteria:void 0,i=e?JSON.parse(e):a,r=i?CriteriaHandler.convert_to_search_criteria(i,"advanced_filter"):void 0;o(r)}))}))}},Territory:{Hide:function(){$L("#territoryDropDown").hide()},Show:function(){$L("#territoryDropDown").show()}},Component:{componentMap:{"list-custom-view":"CustomView","list-view-type":"View"},CheckAndGetClass:function(e){var o=t.Component.componentMap[e];if(o)return o;throw CScript.Error("Component not found: "+e)},GetAll:function(){return Object.keys(t.Component.componentMap)},SetValue:async function(e,o){var n=t.Component.CheckAndGetClass(e);await t[n].Set(o)},GetOptions:function(e){if("list-custom-view"===e)return t.CustomView.GetOptions();throw CScript.Error("getOptions is not supported for "+e)},GetValue:function(e){if("list-advanced-filter"===e)throw CScript.Error(`getValue is not supported for ${e}`);var o=t.Component.CheckAndGetClass(e);return t[o].Get()},SetOptions:async function(e,o){if("list-custom-view"!==e)throw CScript.Error("setOptions is not supported for "+e);{const n=new Set((await t.CustomView.GetOptions()).map((({id:t})=>t))),a=new Set(o.map((t=>t.id)));a.forEach((t=>{if(!n.has(t))throw CScript.Error(`invalid custom view id - ${t}`)})),!a.has(Lyte.Router.getRouteInstance().currentModel.cvid)&&t[t.Component.CheckAndGetClass(e)].Set(o[0].id),n.forEach((e=>t.Component[a.has(e)?"Permit":"Restrict"]("list-custom-view",e)))}},Restrict:function(e,o){var n=t.Component.CheckAndGetClass(e);return t[n].Restrict(o)},Permit:function(e,o){var n=t.Component.CheckAndGetClass(e);return t[n].Permit(o)},Hide:function(e){var o=t.Component.CheckAndGetClass(e);t[o].Hide(o)},Show:function(e){var o=t.Component.CheckAndGetClass(e);t[o].Show(o)}},Icon:{iconMap:{records_edit:"[id^=listViewEdit_]",add_columns:"#addColumn"},Display:function(e,o){var n=t.Icon.iconMap[e],a=$L(n);o?a.show():a.hide()}},List:{Hide:function(e){var o=$L("crm-list-view")[0].component,n=o.getData("listfields");n.forEach((function(t,o){t.api_name===e&&n.deleteElementAt(o)})),o.setData("listfields",n);var a=$L("crm-inner-list")[0].component;a.setData("customview_records",o.getData("customview_records")),t.addStyle(a.getData("module"),a.getData("customview_records"),a.getData("styles")),t.addMask(a.getData("masked_fields"))},Freeze:function(t){$("crm-inner-list")[0].component.setData("manage_columns_visible",!t)},Mask:function(e,o){if("Tag"===e)throw CScript.Error("mask can't be applied for field - "+e);var n=$L("crux-table-component")[0].component.getData("cxPropHeader"),a=$L("crm-inner-list")[0].component,i=!1,r=n.find((t=>t.api_name===e));if(r){if(["userlookup","ownerlookup","boolean"].includes(r.data_type))throw CScript.Error("mask can't be applied for field - "+e);var c=a.getData("masked_fields");if(-1===Object.keys(c).indexOf(e)&&Object.keys(c).length>=10)throw CScript.Error("limit reached - only 10 fields can be masked at max");c[e]=o,i=!0}if(!i)throw CScript.Error("no such field present");t.addMask(a.getData("masked_fields")),t.addStyle(a.getData("module"),a.getData("customview_records"),a.getData("styles"))},Sort:function(t,e){if(-1===["asc","desc","unsort"].indexOf(e))throw CScript.Error("not a valid sort option");var o=$L("crm-inner-list")[0].component.getData("customfields").find((e=>e.api_name===t));if(!o)throw CScript.Error("no such field present");if(!o.sortable)throw CScript.Error(`field not supported - ${t}`);var n=Lyte.Router.getRouteInstance().transition.info,a=n.queryParams;a.sort_by===o.id&&a.sort_order===e||("unsort"===e?$("crm-list-view")[0].component.executeMethod("sortRecord","unsort",void 0,void 0,void 0,{api_name:o.api_name,id:o.id},!1):(a.sort_order=e,a.sort_by=o.id,Lyte.Router.transitionTo({route:n.route,queryParams:a,dynamicParams:n.dynamicParams}).data={clearCache:!0}))},Style:function(e,o){if(!o||""===o)throw CScript.Error("criteria cannot be empty");var n=$("crm-inner-list")[0].component,a=n.getData("styles");a=a.concat({criteria:o,row:e.record,column:e.field}),n.setData("styles",a),t.addStyle(n.getData("module"),n.getData("customview_records"),n.getData("styles"))},GetSelectedRecords:function(){var e=Array.from(document.querySelector("crm-custom-outer-box").getData("selectedIds"));return t.Records.Get().filter((function(t){return-1!==e.indexOf(t.id)}))},SerializeRecord:function(t,e){var o={};return e.forEach((function(e){t.hasOwnProperty(e)&&(o[e]=void 0===t[e]?null:t[e])})),o},GetRecords:function(){var e=[],o=Lyte.Router.getRouteInstance().currentModel.module,n=["id"];moduleRecordMapping[o].fields.forEach((function(t){n.push(t.api_name)}));var a=Array.from(document.querySelector("crm-custom-outer-box").getData("selectedIds"));return $L("crm-inner-list")[0].component.getData("customview_records").each((function(o){var i=t.List.SerializeRecord(o,n);i.$selected=!!a.contains(i.id),e.push(i)})),e},SelectRecordsById:function(t){if($L("crm-inner-list")[0].component.getData("customview_records").find((e=>e.id===t))){const e=document.querySelector("crm-custom-outer-box").getData("selectedIds");if(!e.includes(t)){const o=document.querySelector("#selectEntity_"+t);o?!o.ltProp("checked")&&o.click():Lyte.arrayUtils(e,"push",t)}}},SelectRecords:async function(e){var o=Lyte.Router.getRouteInstance().currentModel.module;if(await CriteriaHandler.init(o),!e||!e.trim())throw CScript.Error("invalid criteria");e.startsWith("(")||(e="("+e+")"),CriteriaHandler.filter_records($L("crm-inner-list")[0].component.getData("customview_records"),e).forEach((e=>e.$approved&&t.List.SelectRecordsById(e.id)))},ClearRecords:function(){const t=$("crm-customview-buttons")[0];t&&t.component.actions.clearFields.call(t.component)}}};return{style_config:[],page_info:function(){return t.PageInfo()},addStyle:function(){if(CScriptLib){var e=$L("crm-inner-list")[0];t.addStyle(e.getData("module"),e.getData("customview_records"),e.getData("styles"))}},component_list:function(){return t.Component.GetAll()},component_set_value:async function(){await t.Component.SetValue(this.name,this.value)},component_get_value:function(){return t.Component.GetValue(this.name)},component_get_options:function(){return t.Component.GetOptions(this.name)},component_set_options:async function(){await t.Component.SetOptions(this.name,this.options)},component_show:function(){t.Component.Show(this.name)},component_hide:function(){t.Component.Hide(this.name)},button_list:function(){return t.Button.GetAll()},get_button_apiname:function(){return t.Button.IsPresent(this.api_name)},get_button_id:function(){return t.Button.IsPresent(this.id)},button_disable:function(){var e;this.api_name?e=this.api_name:this.id&&(e=this.id),t.Button.Hide(e)},button_enable:function(){var e;this.api_name?e=this.api_name:this.id&&(e=this.id),t.Button.Show(e)},button_click:function(){var e;this.api_name?e=this.api_name:this.id&&(e=this.id),t.Button.Click(e)},button_set_value:function(){var e;this.api_name?e=this.api_name:this.id&&(e=this.id),t.Button.SetValue(e,this.value)},list_records_get:function(){return t.List.GetRecords()},list_records_select:async function(){this.criteria?await t.List.SelectRecords(this.criteria):t.List.ClearRecords(Array.from(document.querySelector("crm-custom-outer-box").getData("selectedIds")))},list_records_select_id:function(){this.ids.forEach((function(e){t.List.SelectRecordsById(e)}))},list_records_clear_selected:function(){t.List.ClearRecords()},list_field_hide:function(){return t.List.Hide(this.field)},list_fields_mask:function(){t.List.Mask(this.field_name,this.config)},list_fields_sort:function(){t.List.Sort(this.field_name,this.option)},list_records_style:function(){t.List.Style(this.style_config,this.criteria)},list_fields_freeze:function(){t.List.Freeze(this.option)},icon_enable:function(){t.Icon.Display(this.name,!0)},icon_disable:function(){t.Icon.Display(this.name,!1)},refresh_page:function(){Lyte.Router.getRouteInstance().prevent_cscript_onLoad=!this.config.triggerOnLoad,crmListView.reloadCurrentListView()}}}();
