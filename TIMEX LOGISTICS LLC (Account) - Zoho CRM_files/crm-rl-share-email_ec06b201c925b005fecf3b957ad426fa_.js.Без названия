Lyte.Component.register("crm-rl-share-email",{_template:'<template tag-name="crm-rl-share-email"> <template is="if" value="{{expHandlers(isRecordLocked,\'!\')}}"><template case="true"> <span id="getMailOpt" style="display:none;"> <template is="if" value="{{isRlLyteEnabled}}"><template case="true"> <lyte-button lt-prop-appearance="primary" lt-prop-class="outlineprimary" lt-prop-size="small" name="mail" data-zcqa="link_SendMail" onclick="{{action(\'sendEntMail\',encodeJS(mailObj.module),mailObj.entityId,\'\',encodeJS(mailObj.singularMod))}}"><template is="registerYield" yield-name="text">{{getI18n \'crm.emails.compose\'}}</template> </lyte-button> </template><template case="false"> <span name="mail" data-zcqa="link_SendMail" class="tb_newsmallbtn" onclick="{{action(\'sendEntMail\',encodeJS(mailObj.module),mailObj.entityId,\'\',encodeJS(mailObj.singularMod))}}">{{getI18n \'crm.emails.compose\'}}</span> </template></template> </span> </template></template> <span id="zmailRS" class="mR10 dIB vaM"> <template is="if" value="{{expHandlers(mailObj.customSharing,\'!=\',undefined)}}"><template case="true"> <template is="if" value="{{expHandlers(mailObj.checked,\'==\',&quot;checked&quot;)}}"><template case="true"> <lyte-checkbox lt-prop-name="{{getI18n(\'crm.label.share.email\')}}" lt-prop-checked="true" lt-prop-value="val" lt-prop-id="status_{{mailObj.loginUserId}}" lt-prop-label="{{getI18n(\'crm.label.share.email\')}}" id="status_{{mailObj.loginUserId}}" name="status_{{mailObj.loginUserId}}" on-changed="{{method(&quot;updateUsersList&quot;)}}" class="crm_rl_share_email_checkbox"> </lyte-checkbox> </template><template case="false"> <lyte-checkbox lt-prop-name="{{getI18n(\'crm.label.share.email\')}}" lt-prop-checked="false" lt-prop-value="val" lt-prop-id="status_{{mailObj.loginUserId}}" lt-prop-label="{{getI18n(\'crm.label.share.email\')}}" id="status_{{mailObj.loginUserId}}" name="status_{{mailObj.loginUserId}}" on-changed="{{method(&quot;updateUsersList&quot;)}}" class="crm_rl_share_email_checkbox"> </lyte-checkbox> </template></template> <input type="hidden" id="zmailkey" name="zmailkey" value="{{mailObj.zmailkey}}"> </template></template> </span> <template is="if" value="{{expHandlers(ifNotInventoryModule(mailObj.module),\'&amp;&amp;\',expHandlers(isSendMailRestricted,\'!\'))}}"><template case="true"> <template is="if" value="{{isUserHasSendMailPermission}}"><template case="true"> <template is="if" value="{{isRlLyteEnabled}}"><template case="true"> <lyte-button lt-prop-aria="{{isAccessibilityConfigSupported}}" lt-prop-data-tabindex="0" lt-prop-aria-attributes="{\'aria-label\' : \'{{getI18n(\'crm.emails.compose\')}}\'}" lt-prop-appearance="primary" lt-prop-class="outlineprimary" lt-prop-size="small" id="sendEntityMailLink" name="mail" data-zcqa="link_SendMail" class="dummyForLeftPanel crm-rl-write-action" onclick="{{action(\'sendEntMail\',mailObj.module,mailObj.entityId,\'\',mailObj.singularMod)}}"><template is="registerYield" yield-name="text">{{getI18n(\'crm.emails.compose\')}}</template></lyte-button> </template><template case="false"> <span id="sendEntityMailLink" name="mail" tabindex="0" aria-label="{{getI18n(\'crm.emails.compose\')}}" lt-prop-aria-keydown="true" role="button" data-zcqa="link_SendMail" class="dummyForLeftPanel tb_newsmallbtn dIB vam crm-rl-write-action" onclick="{{action(\'sendEntMail\',mailObj.module,mailObj.entityId,\'\',mailObj.singularMod)}}">{{getI18n(\'crm.emails.compose\')}}</span> </template></template> </template></template> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,0],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}}]}},default:{}},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3]}]}},default:{}},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,0],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}}]}},default:{}}]}},default:{}}],_observedAttributes:["isRecordLocked","isSendMailRestricted","mailObj","contactDetailsLength","isAccessibilityConfigSupported","isRlLyteEnabled","fromDetailView","isUserHasSendMailPermission"],data:function(){return{isRecordLocked:Lyte.attr("boolean"),isSendMailRestricted:Lyte.attr("boolean",{default:!1}),mailObj:Lyte.attr("object"),contactDetailsLength:Lyte.attr("number",{default:0}),isAccessibilityConfigSupported:Lyte.attr("boolean",{default:Crm.userDetails.isAccessibilityConfigSupported&&!featuresAvailable.NEXTGENUI_ENABLED}),isRlLyteEnabled:Lyte.attr("boolean",{default:Crm.userDetails.isRelatedListLyteEnabled}),fromDetailView:Lyte.attr("boolean"),isUserHasSendMailPermission:Lyte.attr("boolean",{default:!0})}},didConnect:function(){var e=this.getData("mailObj");e&&void 0!==e.contacts_details&&this.setData("contactDetailsLength",e.contacts_details.length)},actions:{sendEntMail:function(e,t,a,i){EntSendMail(e,t,a,i)}},methods:{updateUsersList:function(){updateUsersList($("#id").val(),Crm.userDetails.USER_ID)}},detailViewLeftPaneHandling:function(){this.getData("fromDetailView")&&Crm.userDetails.isRelatedListLyteEnabled&&(this.$node.querySelector("#sendEntityMailLink")||$L("#newleft_"+this.getData("rid")).find(".addNewIcP").hide())}.observes("isSendMailRestricted")});
