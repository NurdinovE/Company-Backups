Lyte.Component.register("crm-activity-rel-wrapper",{_template:'<template tag-name="crm-activity-rel-wrapper" id="{{parent_relation_name}}"><template is="if" value="{{lyteViewPort}}"><template case="true"><dummy-port-element></dummy-port-element> <div class="norec w100_per pR30 boxBB noDataFountDetailtxt">{{getI18(\'crm.new.label.no.records\')}}</div> <lyte-event-listener event-name="relatedListCount" on-fire="{{action(\'renderRelatedList\')}}"> <lyte-event-listener class="actSplitEV" event-name="relatedList" on-fire="{{action(\'renderRelatedList\')}}"> </lyte-event-listener></lyte-event-listener><dummy-port-element></dummy-port-element></template><template case="false"> <lyte-event-listener event-name="relatedListCount" on-fire="{{action(\'handleRelCount\')}}"> <template is="if" value="{{expHandlers(expHandlers(canvas,\'!\'),\'&amp;&amp;\',expHandlers(isprintview,\'!\'))}}"><template case="true"> <div class="rl_Header"> <div class="relListHeader maxW450"> <span name="{{related_list.display_label}}_{{related_list.id}}" tabindex="0" aria-label="{{displayLabel}}" id="{{related_list.display_label}}_{{related_list.id}}" class="relListHead ellipticText dIB">{{displayLabel}}</span> </div> <div class="mlAuto dIFlex aiCenter"> <template is="if" value="{{expHandlers(showActions,\'&amp;&amp;\',expHandlers(isClientAccount,\'!\'))}}"><template case="true"> <div class="zcanvas_rl_hide dIFlex enableRelLinks pR5"> <crm-activity-rel-actions data="{{relActionData.data}}" is-data-set="true" parentid="{{relActionData.parentid}}" record="{{module_data}}" module="{{rel_module}}"></crm-activity-rel-actions> </div> </template></template> <div class="zcanvas_rl_hide dIFlex"> <template is="if" value="{{custData.appointmentAlone}}"><template case="true"> <crm-activity-rel-customize btn_name="{{custData.btn_name}}" data="{{custData.data}}" module_data="{{custData.module_data}}" parentid="{{custData.parentid}}" isshowcol="{{custData.isshowcol}}" activity_name="{{activityView}}" outer_selector="{{custData.outer_selector}}" from-detail-lyte="true" layout_id="{{layout_id}}" canvas="true" entity_id="{{entity_id}}" rel_module="{{rel_module}}" parent_relation_name="{{parent_relation_name}}" chrono-rel-list="{{lbind(relModData)}}" sub-module-data="{{subModuleData}}" nav-items="{{lbind(navItems)}}" related_list="{{lbind(related_list)}}" activity-data="{{lbind(activityData)}}"></crm-activity-rel-customize> </template><template case="false"> <crm-activity-rel-customize btn_name="{{custData.btn_name}}" data="{{custData.data}}" entity_id="{{custData.entity_id}}" module_data="{{custData.module_data}}" module_name="{{custData.module_name}}" outer_selector="{{custData.outer_selector}}" parentid="{{custData.parentid}}" isshowcol="{{custData.isshowcol}}" chrono-rel-list="{{lbind(relModData)}}" parent_relation_name="{{parent_relation_name}}" sub-module-data="{{subModuleData}}" nav-items="{{lbind(navItems)}}" related_list="{{lbind(related_list)}}" activity-data="{{lbind(activityData)}}" activity_name="{{custData.activity_name}}"> </crm-activity-rel-customize> </template></template> </div> </div> </div> </template></template> <template is="if" value="{{showLoading}}"><template case="true"> <div class="noDataFountDetailtxt p10 pT30 pB30 mL10 mR10 crm-font-regular crmNotFoundColor crm-small-font-size">{{getI18n(\'crm.admin.loading\')}}</div> </template><template case="false"> <div class="actDVSplit"> <div id="{{idselector}}"> <template is="if" value="{{showBlankState}}"><template case="true"> <template is="if" value="{{isprintview}}"><template case="true"> <table width="95%" cellspacing="0" cellpadding="0"> <tbody><tr> <td width="15"></td> <td valign="top" class="printSecContent"> <div class="notd p15">{{getI18(\'crm.new.label.no.records\')}}</div> </td> </tr> </tbody></table> </template><template case="false"> <template is="if" value="{{expHandlers(expHandlers($lg,\'&amp;&amp;\',$lg.relatedList),\'&amp;&amp;\',$lg.relatedList.oldAppointments)}}"><template case="true"> <lyte-event-listener class="actSplitEV" event-name="relatedList" on-fire="{{action(\'handleRefresh\')}}"> </lyte-event-listener></template></template> <div id="{{parent_relation_name}}_split_no_data_div" class="norec w100_per pR30 crm-font-regular boxBB noDataFountDetailtxt">{{getI18(\'crm.new.label.no.records\')}}</div> </template></template> </template><template case="false"> <template is="if" value="{{expHandlers(canvas,\'&amp;&amp;\',expHandlers(fromDetailLyte,\'!\'))}}"><template case="true"> <lyte-event-listener class="actSplitEV" event-name="relatedList" on-fire="{{action(\'handleRefresh\')}}"> <template is="if" value="{{expHandlers(activityView,\'===\',\'ColumnView\')}}"><template case="true"> <template is="for" items="{{relation_names}}" item="relation_name" index="index"> <crm-activity-rel-list id="{{getPersonalityByRelation(relation_name)}}_split" entity_id="{{entity_id}}" rel_module="{{rel_module}}" module="{{getModuleByRelation(relation_name)}}" list_relation_id="{{related_list_id}}" translabel="{{item.label}}" personality="{{item.personality}}" showpopover="{{item.showpopover}}" pr_class="pLR10" internal-fields="{{getFieldsForRelation(relation_name)}}" relation_name="{{relation_name}}" canvas="{{canvas}}" layout_id="{{layout_id}}" parent_relation_name="{{parent_relation_name}}" txt_ln="{{txt_ln}}"></crm-activity-rel-list> </template></template><template case="false"><template is="if" value="{{expHandlers(activityView,\'===\',\'TimeLineView\')}}"><template case="true"> <crm-activity-chronological-view entity_id="{{entity_id}}" rel_module="{{rel_module}}" related_list="{{related_list}}" list_relation_id="{{related_list_id}}" canvas="{{canvas}}" layout_id="{{layout_id}}" activity_type="{{activity_type}}" permitted-modules="{{relation_names}}" related-list-data="{{relModData}}" parent_relation_name="{{parent_relation_name}}"></crm-activity-chronological-view> </template></template></template></template></lyte-event-listener></template><template case="false"><template is="if" value="{{expHandlers(activityView,\'===\',\'ColumnView\')}}"><template case="true"> <template is="if" value="{{fromDetailLyte}}"><template case="true"> <lyte-event-listener class="actSplitEV" event-name="relatedList" on-fire="{{action(\'handleRefresh\')}}"> <div id="columnViewDiv" class="{{if(ifEquals(showColumnViewLoader,\'true\'),\'dN\',\'actSplitEV\')}}"> <template is="for" items="{{relation_names}}" item="relation_name" index="index"> <crm-activity-rel-list rl-id-vs-count="{{rlIdVsCount}}" is-count-api-enabled="{{isCountApiEnabled}}" from-new-detail="{{fromDetailLyte}}" id="{{getPersonalityByRelation(relation_name)}}_split" entity_id="{{entity_id}}" rel_module="{{rel_module}}" module="{{getModuleByRelation(relation_name)}}" list_relation_id="{{related_list_id}}" translabel="{{item.label}}" personality="{{item.personality}}" showpopover="{{item.showpopover}}" pr_class="pLR10" internal-fields="{{getFieldsForRelation(relation_name)}}" relation_name="{{relation_name}}" canvas="{{canvas}}" layout_id="{{layout_id}}" parent_relation_name="{{parent_relation_name}}" txt_ln="{{txt_ln}}" tab-head-count="{{lbind(tabHeadCount)}}" full-page-lyte-render="{{fullPageLyteRender}}"></crm-activity-rel-list> </template> <template is="if" value="{{showColumnViewLoader}}"><template case="true"> <div class="noDataFountDetailtxt p10 pT30 pB30 mL10 mR10 crm-font-regular crmNotFoundColor crm-small-font-size">{{getI18n(\'crm.admin.loading\')}}</div> </template></template> </div> </lyte-event-listener></template><template case="false"> <template is="if" value="{{expHandlers(expHandlers($lg,\'&amp;&amp;\',$lg.relatedList),\'&amp;&amp;\',$lg.relatedList.oldAppointments)}}"><template case="true"> <lyte-event-listener class="actSplitEV" event-name="relatedList" on-fire="{{action(\'handleRefresh\')}}"> <template is="for" items="{{subModuleData}}" item="item" index="index"> <crm-activity-rel-list is-client-account="{{isClientAccount}}" full-page-lyte-render="{{fullPageLyteRender}}" rl-id-vs-count="{{rlIdVsCount}}" is-count-api-enabled="{{isCountApiEnabled}}" id="{{item.name}}_split" data="{{item.data}}" info="{{item.info}}" entity_id="{{item.entity_id}}" rel_module="{{item.rel_module}}" module="{{item.module}}" list_relation_id="{{item.list_relation_id}}" translabel="{{item.label}}" personality="{{item.personality}}" showpopover="{{item.showpopover}}" subject="{{item.subject}}" isprintview="{{isprintview}}" dateformat="{{dateformat}}" fields="{{item.fields.fields}}" headings="{{item.headings}}" fieldsforrel="{{item.fieldsforrel}}" pr_class="{{getPRClass(isprintview,item.module,index,subModuleData)}}" txt_ln="{{txt_ln}}" has-complete-permission-for-task="{{hasCompletePermissionForTask}}" parent_relation_name="{{parent_relation_name}}" tab-head-count="{{lbind(tabHeadCount)}}"></crm-activity-rel-list> </template> </lyte-event-listener></template><template case="false"> <template is="for" items="{{subModuleData}}" item="item" index="index"> <crm-activity-rel-list id="{{item.name}}_split" data="{{item.data}}" info="{{item.info}}" entity_id="{{item.entity_id}}" rel_module="{{item.rel_module}}" module="{{item.module}}" list_relation_id="{{item.list_relation_id}}" translabel="{{item.label}}" personality="{{item.personality}}" showpopover="{{item.showpopover}}" subject="{{item.subject}}" isprintview="{{isprintview}}" dateformat="{{dateformat}}" fields="{{item.fields.fields}}" headings="{{item.headings}}" fieldsforrel="{{item.fieldsforrel}}" pr_class="{{getPRClass(isprintview,item.module,index,subModuleData)}}" txt_ln="{{txt_ln}}" has-complete-permission-for-task="{{hasCompletePermissionForTask}}" parent_relation_name="{{parent_relation_name}}" tab-head-count="{{lbind(tabHeadCount)}}"></crm-activity-rel-list> </template> </template></template> </template></template></template><template case="false"><template is="if" value="{{expHandlers(activityView,\'===\',\'TabView\')}}"><template case="true"> <lyte-event-listener class="actSplitEV" event-name="relatedList" on-fire="{{action(\'handleRefresh\')}}"> <template is="if" value="{{expHandlers(showTabViewNoRec,\'&amp;&amp;\',fromDetailLyte)}}"><template case="true"> <div id="{{parent_relation_name}}_split_no_data_div" class="norec w100_per pR30 boxBB noDataFountDetailtxt">{{getI18(\'crm.new.label.no.records\')}}</div> </template><template case="false"> <lyte-tabs class="actSplitTab lyteOuterTab" lt-prop-hover="lyteOuterTabHover" on-open="{{method(\'switchTab\')}}" id="tabview_{{parent_relation_name}}_header"> <template is="registerYield" yield-name="tabYield"> <lyte-tab-head class="borderRightNone borderLeftNone pL10 crmNestedOuterTabHead"> <template items="{{navItems}}" item="item" index="index" is="for"><lyte-tab-title data-name="{{item.name}}" data-zcqa="tabview_{{getIdPropForTabView(item.name,parent_relation_name)}}" id="tabview_{{getIdPropForTabView(item.name,parent_relation_name)}}" lt-prop-id="{{getIdPropForTabView(item.name)}}"><span class="zcicncss-{{getActIconName(item.name)}} zcicn-cssIcons vaM mR5"></span> <span class="vaM dIB">{{getI18(getPluralLabel(item.name))}}</span> <template is="if" value="{{isNewCountFlow(fullPageLyteRender,isCountApiEnabled)}}"><template case="true"><span class="numCountn mL5 dIB actSplitCount">{{rlIdVsCount[item.id]}}</span></template></template> <template is="if" value="{{expHandlers(isNewCountFlow(fullPageLyteRender,isCountApiEnabled),\'!\')}}"><template case="true"><span class="numCountn mL5 dIB actSplitCount">{{getTabViewRelCount(item.name,tabHeadCount,parent_relation_name)}}</span></template></template> </lyte-tab-title></template> </lyte-tab-head> <lyte-tab-body class="actSplitTabBody borderNone"> <lyte-tab-content class="{{if(fromDetailLyte,\'pB5\',\'p20\')}}" id="{{getIdPropForTabView(currentActivity,parent_relation_name)}}"> <template is="if" value="{{showRL}}"><template case="true"> <crm-related-list-view-header rl-id-vs-count="{{rlIdVsCount}}" module="{{if(activityData.rel_module,activityData.rel_module,rel_module)}}" left-rel-id="{{left_rel_id}}" view-name="{{activityView}}" entity-id="{{activityData.entity_id}}" related-list-id="{{activityData.list_relation_id}}" related-list="{{related_list}}" record="{{module_data}}" layout-id="{{layout_id}}" canvas="false" is-chrono="true" parent_relation_name="{{parent_relation_name}}"></crm-related-list-view-header> </template></template> </lyte-tab-content> </lyte-tab-body> </template> </lyte-tabs> </template></template> </lyte-event-listener></template><template case="false"><template is="if" value="{{expHandlers(activityView,\'===\',\'TimeLineView\')}}"><template case="true"> <crm-activity-chronological-view rl-id-vs-count="{{rlIdVsCount}}" is-count-api-enabled="{{isCountApiEnabled}}" full-page-lyte-render="{{fullPageLyteRender}}" id="chronoview_{{parent_relation_name}}_split" entity_id="{{entity_id}}" txt_ln="{{txt_ln}}" rel_module="{{rel_module}}" parent_relation_name="{{parent_relation_name}}" related_list="{{related_list}}" list_relation_id="{{list_relation_id}}" layout_id="{{layout_id}}" activity_type="{{activity_type}}" is_field_api_success="{{lbind(isFieldApiSuccess)}}" has-complete-permission-for-task="{{hasCompletePermissionForTask}}" permitted-modules="{{relation_names}}" related-list-data="{{lbind(relModData)}}" from-new-detail="{{fromDetailLyte}}" nav-items="{{navItems}}"></crm-activity-chronological-view> </template></template></template></template></template></template></template></template></template></template> </div> </div> </template></template> </lyte-event-listener></template></template></template>',_dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[0]},{type:"text",position:[2,0]},{type:"attr",position:[4]},{type:"attr",position:[4,1]},{type:"componentDynamic",position:[4,1]},{type:"componentDynamic",position:[4]},{type:"componentDynamic",position:[5]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"text",position:[1,1,1,0]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"attr",position:[1,3,3,1]},{type:"if",position:[1,3,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0,3,1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3]},{type:"text",position:[3,0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"attr",position:[0,0]},{type:"text",position:[0,2,0]},{type:"attr",position:[0,4]},{type:"if",position:[0,4],cases:{true:{dynamicNodes:[{type:"text",position:[0,0]}]}},default:{}},{type:"attr",position:[0,6]},{type:"if",position:[0,6],cases:{true:{dynamicNodes:[{type:"text",position:[0,0]}]}},default:{}},{type:"componentDynamic",position:[0]}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"attr",position:[3,1,1]},{type:"if",position:[3,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[3,1]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}]}},default:{}}],_templateAttributes:{type:"attr",position:[]},_observedAttributes:["subModuleData","relModData","relModFields","showBlankState","isprintview","dateformat","canvas","parent_relation_name","relation_names","entity_id","rel_module","related_list_id","layout_id","txt_ln","activityView","navItems","currentActivity","related_list","activityData","module_data","can_module_data","showRL","list_relation_id","left_rel_id","is_field_api_success","hasCompletePermissionForTask","relActionData","custData","displayLabel","relselector","showActions","idselector","showLoading","Tasks_RelObj","Calls_RelObj","Events_RelObj","Appointments__s_RelObj","tabHeadCount","isClientAccount","activityTabModules","fromDetailLyte","allActData","showTabViewNoRec","lyteViewPort","isCountApiEnabled","fullPageLyteRender","rlIdVsCount","showColumnViewLoader"],data:function(){return{subModuleData:Lyte.attr("array"),relModData:Lyte.attr("object"),relModFields:Lyte.attr("array"),showBlankState:Lyte.attr("boolean"),isprintview:Lyte.attr("boolean"),dateformat:Lyte.attr("string"),canvas:Lyte.attr("boolean",{default:!1}),parent_relation_name:Lyte.attr("string"),relation_names:Lyte.attr("array"),entity_id:Lyte.attr("string"),rel_module:Lyte.attr("string"),related_list_id:Lyte.attr("string"),layout_id:Lyte.attr("string"),txt_ln:Lyte.attr("number"),activityView:Lyte.attr("string"),navItems:Lyte.attr("array"),currentActivity:Lyte.attr("string"),related_list:Lyte.attr("object"),activityData:Lyte.attr("object"),module_data:Lyte.attr("object"),can_module_data:Lyte.attr("object"),showRL:Lyte.attr("boolean",{default:!0}),list_relation_id:Lyte.attr("string"),left_rel_id:Lyte.attr("string"),is_field_api_success:Lyte.attr("boolean",{default:!1}),hasCompletePermissionForTask:Lyte.attr("boolean",{default:!0}),relActionData:Lyte.attr("object"),custData:Lyte.attr("object"),displayLabel:Lyte.attr("string"),relselector:Lyte.attr("string"),showActions:Lyte.attr("boolean",{default:!0}),idselector:Lyte.attr("string"),showLoading:Lyte.attr("boolean"),Tasks_RelObj:Lyte.attr("object"),Calls_RelObj:Lyte.attr("object"),Events_RelObj:Lyte.attr("object"),Appointments__s_RelObj:Lyte.attr("object"),tabHeadCount:Lyte.attr("object",{default:{Tasks:0,Calls:0,Meetings:0,Appointments__s:0}}),isClientAccount:Lyte.attr("boolean",{default:Crm.userDetails.CLIENT_ACCOUNT}),activityTabModules:Lyte.attr("array"),fromDetailLyte:Lyte.attr("boolean",{default:!1}),allActData:Lyte.attr("array",{default:[]}),showTabViewNoRec:Lyte.attr("boolean",{default:!1}),lyteViewPort:Lyte.attr("boolean",{default:!1}),isCountApiEnabled:Lyte.attr("boolean",{default:Crm.userDetails.isDVLyteRLCountQueryEnabled}),fullPageLyteRender:Lyte.attr("boolean",{default:!1}),rlIdVsCount:Lyte.attr("object",{default:{}}),showColumnViewLoader:Lyte.attr("boolean",{default:!0})}},init:function(){if(this.getData("isprintview")){if(this.getData("isprintview")){let t="activity_split_wrapper"===this.getData("idselector")?"Activities":"Activities_History";this.setData("parent_relation_name",t),this.setData("activityView","ColumnView")}}else{this.setTabViewModules();var t="Activities"===this.getData("parent_relation_name"),e=t?["Tasks","Events","Calls"]:["Tasks_History","Events_History","Calls_History"];if("Contacts"===this.getData("rel_module")||this.getData("rel_module").includes("CustomModule")){let a=t?"Open_Appointments__s":"Appointments_History__s";e.push(a)}var a=[],i=this,o=i.getData("canvas"),s=null,n=null,l=[],r=0;if(Crm.userDetails.isRelatedListLyteEnabled)var p,d=[],c=this.getData("rel_module");try{if(s=o?i.$node.parentNode.parentNode.parentNode.getElementsByTagName("crm-more-component"):s,Crm.userDetails.isRelatedListLyteEnabled&&("detail"===Lyte.Router.getRouteInstance().routeName&&(p=$L("crm-activity-rel-actions")),d=p&&p[0]&&p[0].component?p[0].getData("data"):[]),s&&s.length&&(n=s[0].getData("dropDownArray")),e.forEach((function(t){var e=Lyte.Component.registeredHelpers.getModuleByRelation(t),o="Crm_Implied_View_"+e,s="Crm_Implied_Create_"+e,m=i.getRelatedListUsingApiName(moduleApiMapping[i.data.rel_module],t);if(moduleRecordMapping&&moduleRecordMapping[e]&&moduleRecordMapping[e].visible&&Crm.userDetails.permissions[o])if(Crm.userDetails.isRelatedListLyteEnabled){var u=Lyte.Component.registeredHelpers.isRelationVisible(t,c);u.relationVisible&&(a.push(t),Crm.userDetails.permissions[s]&&u.createPermission&&m.visible&&(n&&n[r]?l.push(n[r]):d&&d.length&&!p[0].getData("isDataSet")&&l.push(d[r])))}else{Lyte.Component.registeredHelpers.isRelationVisible(t)&&(a.push(t),Crm.userDetails.permissions[s]&&n&&n[r]&&l.push(n[r]));var y=Lyte.Component.registeredHelpers.getPersonalityByRelation(t).toLocaleLowerCase();crmRelatedList.personalityArr?crmRelatedList.personalityArr.indexOf(y)>-1||(crmRelatedList.personalityArr=crmRelatedList.personalityArr+"||"+y):crmRelatedList.personalityArr=y}r++})),s&&s.length){if(s[0].setData("dropDownArray",l),0==l.length){s[0].setData("disabled",!0);var m=$L(s[0]).parents().eq(2);m.hasClass("zccbutton")&&m.addClass("zcanvas-tool-disable")}}else d&&d.length&&!p[0].getData("isDataSet")&&Crm.userDetails.isRelatedListLyteEnabled&&p[0].setData({data:l,isDataSet:!0})}catch(t){"undefined"!=typeof murphy&&murphy.error(t)}if(Crm.userDetails.isRelatedListLyteEnabled)if(this.getData("relation_names")){if(a&&a.length){var u=[];a.forEach(function(t){this.getData("relation_names").includes(t)&&u.push(t)}.bind(this)),this.setData("relation_names",u)}}else this.setData("relation_names",a);else this.setData("relation_names",a);try{var y=this;if(!("true"===window.isSandboxAcc||window.isCanvasSandboxDiff)&&Lyte.registeredMixins["zia-insights-utils"]&&Lyte.registeredMixins["zia-insights-utils"].getInsightsV2){var f=Lyte.registeredMixins["zia-insights-utils"].getInsightsV2(moduleRecordMapping[y.getData("rel_module")],y.getData("entity_id"),{keys:"call_analytics_data"},null,"call_transcription");f&&f.then((t=>{t.zia_insights&&t.zia_insights.call_analytics_data&&Lyte.triggerEvent("callAnalyticsAvailableEvent",t.zia_insights.call_analytics_data.output)}))}}catch(t){"undefined"!=typeof murphy&&murphy.error(t)}}if(!this.getData("canvas")){y=this;var _=this.getData("subModuleData");if(this.setNavItems(this.getData("subModuleData")),_&&_.forEach((function(t){var e=t.fields&&t.fields.fields?t.fields.fields.removeAll(["Subject","Event_Title","Appointment_Name","Due_Date","Owner","Start_DateTime","End_DateTime","All_day","Call_Start_Time","Appointment_Start_Time","Member"]):void 0;if(e){var a=t.headings,i={};a.forEach((function(t){e.contains(t.api_name)&&(i[t.api_name]=t)}));var o={};o[t.personality]=i,t.fieldsforrel=o}})),this.getData("parent_relation_name").indexOf("History")>-1&&this.setData("showActions",!1),!this.getData("isprintview")){let t=this.getData("activityTabModules");this.setData("currentActivity",t[0]),this.setData("left_rel_id",this.getData("relselector").substring(this.getData("relselector").indexOf("_")+1,this.getData("relselector").length))}}if(this.setData("activity_type",this.getData("parent_relation_name").indexOf("History")>-1?"closed":"open"),this.getData("fromDetailLyte")&&Crm.userDetails.isRelatedListLyteEnabled&&(this.setNavItems(void 0,this.getData("allActData")),"Activities"===this.getData("parent_relation_name")?this.setData("currentActivity",this.getData("relation_names")[0]?this.getData("relation_names")[0]:"Tasks"):this.setData("currentActivity",this.getData("relation_names")[0].substring(0,this.getData("relation_names")[0].indexOf("_")))),"undefined"==typeof Customization&&(Customization={},Customization.displayFieldMap={Leads:["Full_Name","Last_Name"],Activities:["Subject"],Accounts:["Account_Name"],Contacts:["Full_Name","Last_Name"],Deals:["Deal_Name"],Potentials:["Deal_Name"],Campaigns:["Campaign_Name"],Cases:["Subject"],Solutions:["Solution_Title"],Products:["Product_Name"],Vendors:["Vendor_Name"],PriceBooks:["Price_Book_Name"],Quotes:["Subject"],SalesOrders:["Subject"],PurchaseOrders:["Subject"],Invoices:["Subject"],Visits:["Visited_Page"],Appointments:["Appointment_Name"],Services:["Service_Name"],Tasks:["Subject"],Calls:["Subject"],Events:["Event_Title"]}),!this.getData("isprintview")){let t;if(t=this.data.rel_module?this.data.rel_module:Lyte.Router.getRouteInstance().parent.parent.currentModel.module_name,(!this.getData("canvas")||Crm.userDetails.isRelatedListLyteEnabled&&this.getData("fromDetailLyte"))&&(this.setData("module_data",store.peekRecord(moduleRecordMapping[t].id,this.getData("entity_id"))),!this.canvas&&this.getData("subModuleData")||Crm.userDetails.isRelatedListLyteEnabled&&this.getData("allActData"))){let t=this.getListRelationId();this.setData("related_list",store.peekRecord("related_list",t))}}if(this.getData("canvas")&&(void 0===this.getData("activityView")||""===this.getData("activityView"))){var v,g=Crm.userDetails.actUserRelViewObj.actviewobj?Crm.userDetails.actUserRelViewObj.actviewobj:Crm.userDetails.actUserRelViewObj,h=g.canvas;if(this.getData("fromDetailLyte")&&Crm.userDetails.isRelatedListLyteEnabled&&(h=g.detail),Crm.userDetails.isChronologicalviewEnabled&&g){Crm.userDetails.openActRelView=h.openActRelView,Crm.userDetails.closedActRelView=h.closedActRelView,v="Activities"===this.getData("parent_relation_name")?h.openActRelView:h.closedActRelView;let t="Activities"===this.getData("parent_relation_name")?"openActRelCustomize":"closedActRelCustomize",e=$L("#"+t);t.length>0&&e.length>0&&e[0].setData("activity_name",v)}else v="Activities"===this.getData("parent_relation_name")?Crm.userDetails.openActRelView:Crm.userDetails.closedActRelView;this.setData("activityView",v)}if(!this.getData("canvas")&&"TabView"===this.getData("activityView")&&!this.getData("isprintview")){let t=this.getData("tabHeadCount");this.getData("subModuleData").forEach((e=>{let a=e.data?e.data.length:0,i=e.module;"Events"===i&&(i="Meetings"),"Appointments"===i&&(i="Appointments__s"),t[i]=a})),this.setData("tabHeadCount",t)}},setTabViewModules:function(){let t=[];["Tasks","Calls","Events","Appointments"].forEach((e=>{moduleRecordMapping[e]&&moduleRecordMapping[e].viewable&&t.push(e)})),this.setData("activityTabModules",t)},setRecordCount:function(t){var e=this.getData("relation_names"),a=0,i=!1;e.forEach((function(t){var e="#"+Lyte.Component.registeredHelpers.getPersonalityByRelation(t)+"_split",o=$L(e);if(o&&o.length&&"function"==typeof o[0].getData){var s=o[0].getData("info");s&&(a=a+(s.page-1)*s.per_page+s.count,i=i||s.more_records)}}));var o=this.getData("parent_relation_name"),s="",n="false"===window.isSandboxAcc&&window.isCanvasSandboxDiff,l="true"===window.isSandboxAcc&&window.isCanvasProdDiff;n?s="#sandboxObj_sandboxChanges ":l&&(s="#parentObj_sandboxChanges ");var r="Activities"===o?$L(s+"#activity_split_wrapper"):$L(s+"#activity_history_split_wrapper"),p=$L(s+"#"+o+"_split_no_data_div"),d=$L(s+"#RL_dataCount_"+this.getData("related_list_id"));if(a>0){var c=i?a+"+":a;r.show(),d.css({height:"10px",padding:"2px 5px",backgroundColor:"#E0E0E0",borderRadius:"2px",lineHeight:"12px",display:"inline-block",textAlign:"center",fontSize:"12px",marginLeft:"8px",cursor:"auto"}),d.text(c),p.hide()}else d.hide(),r.hide(),p.show();t&&this.removeRelatedListCountKey(this.getData("rlIdVsCount"),this.getData("navItems")),this.setData("showColumnViewLoader",!1),Crm.userDetails.isRelatedListLyteEnabled&&Lyte.triggerEvent("activityRelatedListCountDetail",{count:a,updated:t,relation_name:o,has_more:i})},setDataInComponent:function(t,e){("Activities"===this.getData("parent_relation_name")?["Tasks","Events","Calls","Open_Appointments__s"]:"Activities_History"===this.getData("parent_relation_name")?["Tasks_History","Events_History","Calls_History","Appointments_History__s"]:[t]).forEach((function(t){var a=Lyte.Component.registeredHelpers.getModuleByRelation(t);if(moduleRecordMapping[a]&&moduleRecordMapping[a].visible){var i=Lyte.Component.registeredHelpers.getPersonalityByRelation(t),o=$L("#"+i+"_split")[0];o&&o.component.setDataInComp(!1,null,this,e)}}))},getListRelationId:function(){let t=this.getData("subModuleData");if(!this.getData("canvas")&&t){let e=t.length;if("Activities"===this.data.id){for(let a=0;a<e;a++)if(t[a].module===this.getData("currentActivity"))return this.setData("activityData",t[a]),t[a].listRelationId}else if("Activities_History"===this.data.id)for(let a=0;a<e;a++)if(t[a].module===this.getData("currentActivity"))return this.setData("activityData",t[a]),t[a].listRelationId}else if(Crm.userDetails.isRelatedListLyteEnabled&&this.getData("fromDetailLyte")&&this.getData("allActData").length){var e=this.getData("allActData"),a=e.length;for(let t=0;t<a;t++)if(e[t].module.api_name===this.getData("currentActivity")||moduleRecordMapping.Appointments&&"Appointments__s"===e[t].module.api_name&&this.getData("currentActivity")===moduleRecordMapping.Appointments.module_name)return this.setData("activityData",e[t]),e[t].id}},setNavItems:function(t,e){let a=[],i=this;if(!Crm.userDetails.isRelatedListLyteEnabled||Lyte.Globals.get("relatedList.oldAppointments")){let e=t.length,o=store.peekAll("related_list"),s=moduleApiMapping[i.getData("rel_module")];for(let i=0;i<e;i++){let e={};if("Events"===t[i].module?e.name="Meetings":e.name=t[i].module,o&&o.length){let t=this.getRelationName(e);e.id=o.filter((function(e){return e.api_name===t&&e.href.includes(s)}))[0].id}a.push(e)}}else if(e){var o=moduleRecordMapping.Appointments?moduleRecordMapping.Appointments.module_name:"",s=["Tasks","Meetings","Calls"];o&&s.push(o),e.forEach((function(t){var e={};"Events"===t.module.api_name?e.name="Meetings":e.name="Appointments__s"===t.module.api_name?o:t.module.api_name;var i=s.indexOf(e.name);a[i]&&(i+=1),Lyte.arrayUtils(a,"insertAt",i,e)}));for(let t of a)if(t){let e=this.getRelationName(t);t.id=store.peekAll("related_list").filter((function(t){return t.api_name===e&&t.href.includes(moduleApiMapping[i.getData("rel_module")])}))[0].id}a=$u.without(a,void 0)}this.setData("navItems",a)},getRelationName:function(t){let e;return e="Activities"===this.getData("parent_relation_name")?"Appointments"===t.name?"Open_Appointments__s":"Meetings"===t.name?"Events":t.name:"Appointments"===t.name?"Appointments_History__s":"Meetings"===t.name?"Events_History":t.name+"_History",e},setLeftRelCount:function(t){if(t.parent_relation_name===this.getData("parent_relation_name")){if(Crm.userDetails.isRelatedListLyteEnabled)var e=t.relMod;else e=t.api_name.indexOf("_")>-1?t.api_name.substring(0,t.api_name.indexOf("_History")):t.api_name;t.api_name.includes("Appointments")&&(e="Appointments__s");var a=Crm.userDetails.isRelatedListLyteEnabled?["Tasks","Calls","Events","Meetings","Appointments__s"].indexOf(e)>-1:crmRelatedList.isSplitActivitySubModule(e);if((!this.getData("canvas")||this.getData("fromDetailLyte")&&Crm.userDetails.isRelatedListLyteEnabled)&&Crm.isActivitySplitDone&&a){if("Events"===e&&(e="Meetings"),void 0===this.getData(e+"_RelObj")){let t={visitedPage:[],relCount:0,totalRelCount:0,more_records:!1};this.setData(e+"_RelObj",t)}var i=!1;this.getRelCount(t,e);let a=e+"_RelObj",n=this.getData("rlIdVsCount"),l=this.getData(a)?this.getData(a).more_records?this.getData(a).relCount:this.getData(a).totalRelCount:0,r=!!this.data.Tasks_RelObj&&this.data.Tasks_RelObj.more_records,p=!!this.data.Calls_RelObj&&this.data.Calls_RelObj.more_records,d=!!this.data.Events_RelObj&&this.data.Events_RelObj.more_records,c=!!this.data.Appointments__s_RelObj&&this.data.Appointments__s_RelObj.more_records,m=this.getData("tabHeadCount");m[e]!==l&&(m[e]=l,this.setData("tabHeadCount",m));let u=m.Tasks+m.Calls+m.Meetings+m.Appointments__s;if(this.getData("fullPageLyteRender")&&this.getData("isCountApiEnabled")){u=0;let t=this.getData("navItems");for(let e of t)u+=n[e.id]?n[e.id]:0}var o=this.getData("parent_relation_name");let y=$L("#tabview_"+o+"_"+t.relMod).find(".numCountn");if(u>0){(r||p||d||c)&&(i=!0);var s=i?u+"+":u;if(this.getData("fullPageLyteRender"))Lyte.triggerEvent("activityRelatedListCountDetail",{count:s,relation_name:o});else{if(Crm.userDetails.isRelatedListLyteEnabled)Crm.userDetails.isRelatedListLyteEnabled&&u>10&&u%10!=0&&i&&(u-=u%10);else{let e=t.more_records?l+"+":l;y.addClass("actSplitCount").text(e)}s=i?u+"+":u;let e=$L("#newleft_"+this.getData("left_rel_id")).find(".numCountn");e[0].classList.contains("numCountVal")||e.addClass("numCountVal"),e.text(s),e.css("display","inline-block")}}else if(Crm.userDetails.isRelatedListLyteEnabled)Lyte.triggerEvent("activityRelatedListCountDetail",{count:0,relation_name:o,has_more:!1});else{$L("#newleft_"+this.getData("left_rel_id")).find(".numCountn").css("display","none"),y.css("display","none")}if(!this.getData("isCountApiEnabled")||!this.getData("fullPageLyteRender")){let e=t.more_records?l+"+":l;y.addClass("actSplitCount").text(e)}}var n=document.querySelector("#tabview_Activities_header"),l=document.querySelector("#tabview_Activities_History_header");n&&n.length>1?crmInteraction.addLyteTabInteraction(n):l&&l.length>1&&crmInteraction.addLyteTabInteraction(l)}},getRelCount:function(t,e){if(t.count>0&&e&&null!==e){let a=this.getData(e+"_RelObj");if(a&&t){let i=0;a.visitedPage.contains(t.page)&&t.isNavig?i=a.totalRelCount:(i=t.count,a.totalRelCount=t.count,a.visitedPage.contains(t.page)||(a.visitedPage=[],a.visitedPage.push(t.page)),a.more_records=t.more_records),i-=i%10,a.relCount=i,this.setData(e+"_RelObj",a)}}else 0!==Object.keys(t).length&&0!==t.count||this.setData(e+"_RelObj",void 0)},methods:{switchTab:function(t,e,a){let i={name:a.getAttribute("data-name")};this.setData("showRL",!1);let o=this.getData("parent_relation_name")+"_"+i.name;"Meetings"===i.name&&(i.name="Events"),this.setData("currentActivity",i.name);let s=this.getListRelationId(this.data,i.name);this.setData("related_list",store.peekRecord("related_list",s));let n=$L("#"+o);if(n.hasClass("lyteTabHide")&&(n.removeClass("lyteTabHide"),n.addClass("lyteTabShow")),this.setData("showRL",!0),"Calls"===i.name){store.peekAll("field").filterBy({api_name:"Outgoing_Call_Status"})[0]||store.findAll("field",{module:i.name},!1,void 0,{apiVersion:"2.1"})}var l=$L("#newleft_"+this.getData("left_rel_id")).find(".numCountn");let r=this.getData("tabHeadCount"),p=r.Tasks+r.Calls+r.Meetings+r.Appointments;p>0&&(l.text(p),l.css("display","inline-block"))}},actions:{renderRelatedList:function(t){var e=!0;if(t.res&&!t.module){var a="object"==typeof t.res?t.res:JSON.parse(t.res);if(a[this.data.rel_module]){var i=Object.values(a[this.data.rel_module]).map((function(t){return t.module})),o=$u.intersection(i,["Tasks","Calls","Events","Appointments"]);o.length||(t.module=o[0],e=!1)}}(t.module&&["Tasks","Calls","Events","Appointments"].includes(t.module)||!t.module&&e)&&!this.getData(this.getData("parent_relation_name")+"_refreshed")&&this.setData("lyteViewPort",!1)},handleRefresh:function(t){if(Crm.userDetails.isRelatedListLyteEnabled){if("EMAILSPERSONALITY"===t.pname)return;var e=this.getData("parent_relation_name"),a=!0;if(t.res&&!t.module){var i="object"==typeof t.res?t.res:JSON.parse(t.res);if(i[this.data.rel_module]){var o=Object.values(i[this.data.rel_module]).map((function(t){return t.module})),s=$u.intersection(o,["Tasks","Calls","Events","Appointments"]);s.length||(t.module=s[0],a=!1)}}if((t.module&&["Tasks","Calls","Events","Appointments"].includes(t.module)||!t.module&&a)&&!this.getData(e+"_refreshed")){Lyte.Globals.get("relatedList.oldAppointments")&&Lyte.triggerEvent("appointmentsReload",{});let t=this;t.getData("fullPageLyteRender")&&t.getData("isCountApiEnabled")?(t.removeRelatedListCountKey(t.getData("rlIdVsCount"),t.getData("navItems")),Lyte.triggerEvent("activityRelatedListCountDetail",{relation_name:e}),t.setDataInComponent(e,!0)):"TabView"===t.getData("activityView")?Lyte.triggerEvent("refreshActivityTabView",{refresh:!0}):t.setDataInComponent(e,!0),t.setData(e+"_refreshed",!0),setTimeout(function(){t.setData(e+"_refreshed",!1)}.bind(this),2e3)}}else this.setDataInComponent(this.getData("parent_relation_name"))},handleRelCount:function(t){this.setLeftRelCount(t)}},didConnect:function(){if(!this.getData("isprintview"))try{this.getData("canvas")&&("Activities"===this.getData("parent_relation_name")?$L("#activity_split_wrapper").parent().css("overflow","auto"):"Activities_History"===this.getData("parent_relation_name")&&$L("#activity_history_split_wrapper").parent().css("overflow","auto")),this.getData("canvas")||$L("#RelList_"+this.getData("relselector"))[0].remove()}catch(t){murphy.error(t)}},detailActDataObserver:function(){var t=this.$node.parentElement;Crm.userDetails.isRelatedListLyteEnabled&&this.getData("fromDetailLyte")&&1===this.getData("allActData").length&&t&&t.classList&&t.classList.add&&t.classList.add("singleAct_list")}.observes("allActData.[],activityView").on("init")},{mixins:["crm-related-list-utils","crm-activity-mixin"]}),Lyte.Component.register("crm-activity-rel-list",{_template:'<template tag-name="crm-activity-rel-list"> <lyte-event-listener event-name="callAnalyticsAvailableEvent" on-fire="{{action(\'handleCallAnalyticsAvailable\')}}"> <div class="actColumn fL pB10 actColumn_{{module}}"> <div class="title_grey crm-font-bold"> <span class="dIB vaM"> <crmutil-icon icon-name="{{getIconForAspComp(module)}}" icon-class="zcicn-{{getIconForAspComp(module)}}"></crmutil-icon></span> <span class="crmBaseColor ttCapitalize crm-base-font-size mL4 vaM dIB" id="activities_{{module}}" tabindex="0" aria-labelledby="activities_{{module}} {{if(ifEquals(parent_relation_name,&quot;Activities&quot;),concat(&quot;count_&quot;,module),concat(&quot;count_&quot;,module,&quot;_History&quot;))}}">{{translabel}}</span> <template is="if" value="{{expHandlers(isNewCountFlow(fullPageLyteRender,isCountApiEnabled),\'!\')}}"><template case="true"><span class="crm-base-font-size crmBaseColor vaM dIB actSplitCount" id="{{if(ifEquals(parent_relation_name,&quot;Activities&quot;),concat(&quot;count_&quot;,module),concat(&quot;count_&quot;,module,&quot;_History&quot;))}}"> {{getSubActivtyCount(info,true)}}</span></template></template> <template is="if" value="{{isNewCountFlow(fullPageLyteRender,isCountApiEnabled)}}"><template case="true"><span class="crm-base-font-size crmBaseColor vaM dIB actSplitCount" id="{{if(ifEquals(parent_relation_name,&quot;Activities&quot;),concat(&quot;count_&quot;,module),concat(&quot;count_&quot;,module,&quot;_History&quot;))}}"> {{rlIdVsCount[rlId]}}</span></template></template> </div> <template is="if" value="{{expHandlers(isPermissionDenied,\'===\',true)}}"><template case="true"> <div class="p30 aligncenter">{{unescape(getI18n(\'crm.canvas.component.permission.denied\'))}}</div> </template><template case="false"><template is="if" value="{{isLoading}}"><template case="true"> <div class="noDataFountDetailtxt p10 mL10 mR10 crm-font-regular crmNotFoundColor crm-small-font-size">{{getI18n(\'crm.admin.loading\')}}</div> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(data,\'!\'),\'||\',expHandlers(data.length,\'===\',0))}}"><template case="true"> <div class="actColumnValues"> <ul class="actColumnList m0 p0"> <li class="actColumnListEle"> <div class="crm-font-regular crmNotFoundColor crm-small-font-size">{{getI18n(\'crm.new.label.no.records\')}}</div> </li> </ul> </div> </template><template case="false"> <div class="actColumnValues"> <ul class="actColumnList m0 p0" onscroll="{{action(\'viewMoreData\',this)}}"> <template is="for" items="{{data}}" item="item" index="index"> <li class="actColumnListEle"> <div class="clearAfterB pR"> <template is="if" value="{{expHandlers(item.$approval_state,\'===\',\'approval_process_pending\')}}"><template case="true"> <crmutil-icon icon-name="lock-locked" icon-class="zcicn-lock-locked crmBaseIcon" class="fR mR5 mL5 mT2" title="{{getI18(&quot;crm.approvalProcess.label.waitingForApproval&quot;)}}" alt="{{getI18(&quot;crm.approvalProcess.label.waitingForApproval&quot;)}}"></crmutil-icon> </template><template case="false"><template is="if" value="{{expHandlers(item.$approval_state,\'===\',\'merge_pending\')}}"><template case="true"> <crmutil-icon icon-name="lock-locked" icon-class="zcicn-lock-locked crmBaseIcon" class="fR mR5 mL5 mT2" title="{{getI18(&quot;crm.approvalProcess.label.waitingForFindAndMerge&quot;)}}" alt="{{getI18(&quot;crm.approvalProcess.label.waitingForFindAndMerge&quot;)}}"></crmutil-icon> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(item.$approval_state,\'===\',\'review_process_pending\'),\'||\',expHandlers(item.$approval_state,\'===\',\'review_process_rejected\'))}}"><template case="true"> <crmutil-icon icon-name="lock-locked" icon-class="zcicn-lock-locked crmBaseIcon" class="fR mR5 mL5 mT2" title="{{getI18(&quot;crm.reviewprocess.record.review.pending&quot;)}}" alt="{{getI18(&quot;crm.reviewprocess.record.review.pending&quot;)}}"></crmutil-icon> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(item.Locked__s,\'&amp;&amp;\',item.$locked_for_me),\'&amp;&amp;\',expHandlers(item.$editable,\'!\'))}}"><template case="true"> <span data-zcqa="lockedforMeAct_{{item.id}}" class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspLockIcon" title="{{getI18(&quot;crm.record.lock.record.locked&quot;)}}" alt="{{getI18(&quot;crm.record.lock.record.locked&quot;)}}"></span> </template></template></template></template></template></template></template></template> <template is="if" value="{{getSubject(module,item)}}"><template case="true"> <div class="crm-base-font-size robotoRegular cP aspH17 actSubject pR"> <template is="if" value="{{expHandlers(isprintview,\'!\')}}"><template case="true"> <link-to lt-prop-class="link dIB accessibility-route-elem" data-zcqa="relatedList_{{getSubject(module,item)}}_Activities" lt-prop-route="crm.tab.module.entity.detail" lt-prop-dp="[&quot;{{module}}&quot;,&quot;{{item.id}}&quot;]" lt-prop-td="{&quot;fromActivityListView&quot;:&quot;true&quot;,&quot;pfrom&quot;:&quot;rel&quot;,&quot;module&quot;:&quot;{{module}}&quot;,&quot;id&quot;:&quot;{{item.id}}&quot;,&quot;pn&quot;:&quot;{{personality}}&quot;,&quot;peId&quot;:&quot;{{entity_id}}&quot;,&quot;bMod&quot;:&quot;{{rel_module}}&quot;,&quot;fromActSubModuleListView&quot;:&quot;true&quot;,&quot;lookback&quot;:&quot;true&quot;}"> <template is="if" value="{{item.$colour_code}}"><template case="true"> <span class="eventColor_rL_split" data-zcqa="colorspan_{{getSubject(module,item)}}" style="background: {{item.$colour_code}}"></span> </template></template> {{getSubject(module,item)}} </link-to> <template is="if" value="{{item.$in_project_sync}}"><template case="true"> <i class="task_syncIcon vaM mL5 pA mB2" lt-prop-title="{{concat(getI18n(&quot;crm.schedules.prefix.in&quot;),getI18n(&quot;crm.integ.sync.message&quot;,&quot;crm.project.integration.title&quot;))}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;followcursor&quot;, &quot;appearance&quot; : &quot;box&quot;}"></i> </template></template> <template is="if" value="{{expHandlers(expHandlers(expHandlers(getApparovedState(item,personality),\'&amp;&amp;\',expHandlers(item.$approval_state,\'!==\',&quot;approval_process_pending&quot;)),\'&amp;&amp;\',expHandlers(expHandlers(item.$locked_for_me,\'!\'),\'||\',item.$editable)),\'&amp;&amp;\',expHandlers(isClientAccount,\'!\'))}}"><template case="true"> <span id="act_split_origin_{{item.id}}" tabindex="0" aria-label="showMoreOptions" lt-prop-aria-keydown="true" aria-haspopup="true" class="relatedList_moreOption pA dN actmoreIco" data-zcqa="relatedListMore_{{getSubject(module,item)}}_{{module}}" onclick="{{action(\'showMoreOptions\',item,this)}}"> <template is="if" value="{{expHandlers(expHandlers(personality,\'==\',\'TASKSPERSONALITY\'),\'||\',expHandlers(personality,\'==\',\'CALLSPERSONALITY\'))}}"><template case="true"> <crmutil-icon class="zcicn-more-brrounded" icon-name="more-hr-md" icon-class="zcicn-more-hr-md zcicn_636f86 zcicn_black "></crmutil-icon> </template><template case="false"> <crmutil-icon class="zcicn-more-brrounded" icon-name="more-hr-md" icon-class="zcicn-more-hr-md zcicn_636f86 zcicn_black "></crmutil-icon> </template></template> </span> </template></template><template is="if" value="{{item.Recurring_Activity}}"><template case="true"> <crmutil-icon class="mT1" icon-name="repeat" icon-class="zcicn-repeat crmBaseIcon mL5"></crmutil-icon> </template></template></template><template case="false"> <template is="if" value="{{item.$colour_code}}"><template case="true"> <span class="eventColor_rL_split" data-zcqa="colorspan_{{getSubject(module,item)}}" style="background: {{item.$colour_code}}"></span> </template></template> {{getSubject(module,item)}} </template></template><template is="if" value="{{item.$in_project_sync}}"><template case="true"> <i class="task_syncIcon vaM mL5 pA mB2" lt-prop-title="{{concat(getI18n(&quot;crm.schedules.prefix.in&quot;),getI18n(&quot;crm.integ.sync.message&quot;,&quot;crm.project.integration.title&quot;))}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;followcursor&quot;, &quot;appearance&quot; : &quot;box&quot;}"></i> </template></template> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(personality,\'==\',\'TASKSPERSONALITY\'),\'&amp;&amp;\',expHandlers(process_flow,\'!\')),\'&amp;&amp;\',expHandlers(isClientAccount,\'!\')),\'&amp;&amp;\',getApparovedState(item,personality))}}"><template case="true"> <span tabindex="0" type="button" lt-prop-aria-keydown="true" aria-label="{{getI18n(\'crm.label.mark.completed\')}}" class="pA markAsCompletedIcon dN" data-zcqa="lnk_close_Tasks" deleteaction="javascript:Lyte.registeredMixins[\'crm-related-list-utils\'].sortRelatedList(\'{{getActivityActionLink(\'closeTask\',null,item.id)}}\',null,\'{{item.id}}\')" lt-prop-tooltip-config="{&quot;position&quot; : &quot;left&quot;}" lt-prop-title="{{getI18n(\'crm.label.mark.completed\')}}" onclick="{{action(\'clickAction\',\'closeTask\',null,item,personality)}}"> <crmutil-icon class="eventNone" deleteaction="javascript:Lyte.registeredMixins[\'crm-related-list-utils\'].sortRelatedList(\'{{getActivityActionLink(\'closeTask\',null,item.id)}}\',null,\'{{item.id}}\')" icon-name="tick-rounded" icon-class="zcicn-tick-rounded zcicn16 zcicn_7c8bae tick_zcicn20 markAsUtilICo"></crmutil-icon> </span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(personality,\'==\',\'CALLSPERSONALITY\'),\'&amp;&amp;\',expHandlers(isClientAccount,\'!\'))}}"><template case="true"> <span tabindex="0" type="button" lt-prop-aria-keydown="true" aria-label="{{getI18n(\'crm.label.mark.completed\')}}" class="pA markAsCompletedIcon dN" data-zcqa="completeCallMoreOption" lt-prop-tooltip-config="{&quot;position&quot; : &quot;left&quot;}" lt-prop-title="{{getI18n(\'crm.label.mark.completed\')}}" onclick="{{action(\'callAction\',\'Completed\',item)}}"> <crmutil-icon class="eventNone" icon-name="tick-rounded" icon-class="zcicn-tick-rounded zcicn16 zcicn_7c8bae tick_zcicn20 markAsUtilICo"></crmutil-icon> </span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(personality,\'==\',\'APPOINTMENTSPERSONALITY\'),\'&amp;&amp;\',expHandlers(isClientAccount,\'!\'))}}"><template case="true"> <template is="if" value="{{hasEditPermissionForApp}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(item.Status,\'===\',getI18n(\'Scheduled\')),\'&amp;&amp;\',showCompleteaction),\'||\',expHandlers(item.Status,\'===\',getI18n(\'overdue\')))}}"><template case="true"> <span tabindex="0" type="button" lt-prop-aria-keydown="true" aria-label="{{getI18n(\'crm.appointments.status.markcompleted1\')}}" class="pA markAsCompletedIcon dN" id="completeAppMoreOption" lt-prop-tooltip-config="{&quot;position&quot; : &quot;left&quot;}" lt-prop-title="{{getI18n(\'crm.appointments.status.markcompleted1\')}}" onclick="{{action(\'showAppPopup\',\'appointmentCompletePopup\',this,appEndTime,item)}}" data-params="{&quot;module&quot;:&quot;Appointments&quot;,&quot;id&quot;:&quot;{{item.id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;}" data-zcqa="completeAppMoreOption"> <crmutil-icon class="eventNone" icon-name="tick-rounded" icon-class="zcicn-tick-rounded zcicn16 zcicn_7c8bae tick_zcicn20 markAsUtilICo"></crmutil-icon> </span> </template></template> </template></template> </template></template></template></template></template></template> </div> </template></template> <div data-zcqa="relatedList_{{getSubject(module,item)}}_Activities_date_time" class="crm-small-font-size date_time crmBaseColor mT2"> <template is="if" value="{{expHandlers(module,\'==\',\'Events\')}}"><template case="true"> {{convertEventDateTime(item.Start_DateTime,item.End_DateTime,item.All_day,false,dateformat)}} </template><template case="false"><template is="if" value="{{expHandlers(module,\'==\',\'Tasks\')}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(item.Due_Date,true,dateformat)}} </template><template case="false"><template is="if" value="{{expHandlers(module,\'==\',\'Calls\')}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(item.Call_Start_Time,false,dateformat)}} </template><template case="false"><template is="if" value="{{expHandlers(module,\'==\',\'Appointments\')}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(item.Appointment_Start_Time,false,dateformat)}} </template></template></template></template></template></template></template></template> </div> <template is="if" value="{{item.Owner.name}}"><template case="true"> <div data-zcqa="relatedList_{{getSubject(module,item)}}_Activities_owner" data-params="{&quot;userId&quot;:&quot;{{item.Owner.id}}&quot;}" class="wbBreakAll jobSheetLevel crm-small-font-size mT3 mB15 crmBaseColor"> <template is="if" value="{{fromNewDetail}}"><template case="true"><span class="zcicncss-userRounded zcicn_black_mask zcicn-cssIcons dIB vaM scale9"></span></template><template case="false"><span class="svgIconsImg dIB vaM aspIco-user"></span></template></template> <span class="vaM dIB mL2 ellipsistext mWid90per" id="relatedList_{{item.id}}_Activities_owner" onmouseover="{{action(\'showUserTooltip\',item.Owner.id,item.id)}}" onmouseout="{{action(\'hideUserTooltip\')}}">{{item.Owner.name}}</span> </div> </template></template> <template is="for" items="{{fields}}" item="field" index="index"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(contains(internalFields,field),\'!\'),\'&amp;&amp;\',expHandlers(contains(excludeFields,field),\'!\')),\'&amp;&amp;\',validateField(item[field])),\'&amp;&amp;\',expHandlers(fieldsforrel[personality][field].data_type,\'!==\',\'textarea\'))}}"><template case="true"> <div data-zcqa="relatedList_{{getSubject(module,item)}}_Activities_{{field}}" class="crm-base-font-size crm-font-regular date_time mT6 wsNormal"> <span class="crmParagraphColor dIB aspBw actSplitLabel">{{fieldsforrel[personality][field].field_label}}</span> <span class="crmParagraphColor vaT">:</span> <span class="crmBaseColor aspBw dIB vaT pL2 actSplitValue "> <template is="if" value="{{expHandlers(fieldsforrel[personality][field].data_type,\'===\',\'datetime\')}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(item[field],false,dateformat)}} </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(fieldsforrel[personality][field].data_type,\'===\',\'date\'),\'||\',expHandlers(expHandlers(expHandlers(fieldsforrel[personality][field].ui_type,\'===\',116),\'&amp;&amp;\',expHandlers(fieldsforrel[personality][field].formula,\'!==\',undefined)),\'&amp;&amp;\',expHandlers(fieldsforrel[personality][field].formula.return_type,\'===\',\'date\')))}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(item[field],true,dateformat)}} </template><template case="false"><template is="if" value="{{expHandlers(fieldsforrel[personality][field].data_type,\'===\',\'multiselectpicklist\')}}"><template case="true"> {{arrayJoin(item[field],"; ")}} </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(fieldsforrel[personality][field].data_type,\'===\',\'lookup\'),\'||\',expHandlers(fieldsforrel[personality][field].data_type,\'===\',\'multi_module_lookup\'))}}"><template case="true"> <template is="if" value="{{expHandlers(fieldsforrel[personality][field].api_name,\'==\',&quot;What_Id&quot;)}}"><template case="true"> <crux-lookup-component cx-prop-value="{{item[field].name}}" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params="[&quot;{{if(ifEquals(item.$se_module,&quot;Deals&quot;),&quot;Potentials&quot;,getModuleNameByApiNameAsp(item.$se_module))}}&quot;, &quot;{{item[field].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(item.$se_module),\'Small\')}} actSplitLookup" onmouseover="{{action(\'showHideRelatedFields\',item[field],fieldsforrel[personality][field].api_name,item.$se_module,event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-zcqa="{{item[field].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(fieldsforrel[personality][field].api_name,\'==\',&quot;Who_Id&quot;),\'||\',expHandlers(fieldsforrel[personality][field].api_name,\'==\',&quot;Appointment_For&quot;))}}"><template case="true"> <crux-lookup-component cx-prop-value="{{item[field].name}}" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params="[&quot;Contacts&quot;, &quot;{{item[field].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" onmouseover="{{action(\'showHideRelatedFields\',item[field],fieldsforrel[personality][field].api_name,\'Contacts\',event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(\'Contacts\'),\'Small\')}} actSplitLookup" cx-prop-zcqa="{{item[field].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(fieldsforrel[personality][field].api_name,\'==\',&quot;Service_Name&quot;)}}"><template case="true"> <crux-lookup-component cx-prop-value="{{item[field].name}}" cx-prop-route-name="crm.tab.module.entity" cx-prop-dynamic-params="[&quot;Services&quot;, &quot;{{item[field].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" onmouseover="{{action(\'showHideRelatedFields\',item[field],fieldsforrel[personality][field].api_name,item.$se_module,event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(\'Services\'),\'Small\')}} actSplitLookup" cx-prop-zcqa="{{item[field].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(fieldsforrel[personality][field].api_name,\'==\',&quot;Appointments_Booking_Form_Name__s&quot;)}}"><template case="true"> <crux-lookup-component cx-prop-zcqa="{{item[field].name}}" cx-prop-value="{{item[field].name}}" cx-prop-module="CalendarBookings" cx-prop-route-name="crm.settings.section.calendar-booking.view-calendar-booking" cx-prop-query-params="{&quot;module&quot; : &quot;Appointments__s&quot;, &quot;type&quot;: &quot;team&quot;}" cx-prop-dynamic-params="[&quot;{{item[field].id}}&quot;]"> </crux-lookup-component> </template></template></template></template></template></template></template></template> </template><template case="false"> {{unescape(getFormattedValue(fieldsforrel[personality],field,module,item,true,null,true))}} </template></template></template></template></template></template></template></template> </span> </div> </template></template> </template> <template is="for" items="{{fields}}" item="field" index="index"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(contains(internalFields,field),\'!\'),\'&amp;&amp;\',expHandlers(contains(excludeFields,field),\'!\')),\'&amp;&amp;\',validateField(item[field])),\'&amp;&amp;\',expHandlers(fieldsforrel[personality][field].data_type,\'===\',\'textarea\'))}}"><template case="true"> <div data-zcqa="relatedList_{{getSubject(module,item)}}_Activities_{{field}}" class="crm-base-font-size crm-font-regular date_time mT10 wsNormal lh20"> <span class="crmParagraphColor dB">{{fieldsforrel[personality][field].field_label}}:</span> <template is="if" value="{{expHandlers(expHandlers(isprintview,\'!\'),\'&amp;&amp;\',expHandlers(item[field].length,\'>\',txt_ln))}}"><template case="true"> <span class="wwBreakWord" id="Activities_{{field}}_{{item.id}}_old"> {{formattedText(item[field],txt_ln)}} </span> <span class="link cP crm-base-font-size dIB" data-zcqa="Activities_{{field}}_{{item.id}}_readMore" onclick="{{action(\'readMoreDesc\',this,item)}}" id="Activities_{{field}}_{{item.id}}" value="{{item[field]}}"> {{getI18n("crm.readmore")}} </span> </template><template case="false"> <span class="wwBreakWord" id="Activities_{{field}}_{{item.id}}_old"> {{item[field]}} </span> </template></template> </div> </template></template> </template> </div> </li> </template> </ul> </div> <crux-user-tooltip id="activities_addons_user_tooltip"></crux-user-tooltip> </template></template></template></template></template></template> </div> <lyte-popover lt-prop="{&quot;width&quot;:&quot;auto&quot;,&quot;wrapperClass&quot;:&quot;samplePopover&quot;,&quot;freeze&quot;:false,&quot;type&quot;:&quot;box&quot;,&quot;originElem&quot;:&quot;{{popoverOrigin}}&quot;}" lt-prop-scrollable="true" on-close="{{method(&quot;closePopup&quot;)}}" lt-prop-duration="{{ud}}" id="moreOptpop" lt-prop-placement="right bottom" lt-prop-show-close-button="false" lt-prop-show="{{lbind(showpopover)}}" lt-prop-content-padding="5px 0"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <ul class="m0 moreOptValues p0 crm-base-font-size"> <template is="if" value="{{expHandlers(personality,\'==\',\'CALLSPERSONALITY\')}}"><template case="true"> <li class="moreOptValueList" data-zcqa="scheduleCallMoreOption" onclick="{{action(\'callAction\',\'Scheduled\')}}"> <div class="crmLinkColor cP"> {{getI18n(\'crm.label.reschedule.call\',\'\')}} </div> </li> <li class="borderBottom moreOptValueList" data-zcqa="cancelCallMoreOption" onclick="{{action(\'callAction\',\'Cancelled\')}}"> <div class="crmLinkColor cP"> {{getI18n(\'crm.button.cancel\')}} </div> </li> </template><template case="false"><template is="if" value="{{expHandlers(personality,\'==\',\'APPOINTMENTSPERSONALITY\')}}"><template case="true"> <template is="if" value="{{hasEditPermissionForApp}}"><template case="true"> <li id="rescheduleAppMoreOption" onclick="{{action(\'showAppPopup\',\'Reschedule Information\',this)}}" data-params="{&quot;module&quot;:&quot;Appointments&quot;,&quot;id&quot;:&quot;{{activity_id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;,&quot;serviceId&quot; : &quot;{{service_id}}&quot;}" data-zcqa="rescheduleAppMoreOption"> <div class="crmLinkColor cP"> {{getI18n(\'crm.appointments.status.markreschedule\',getSingularLabel(\'Appointments\'))}} </div> </li> <li class="moreOptValueList" id="cancelAppMoreOption" onclick="{{action(\'showAppPopup\',\'Cancellation Information\',this)}}" data-params="{&quot;module&quot;:&quot;Appointments&quot;,&quot;id&quot;:&quot;{{activity_id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;}" data-zcqa="cancelAppMoreOption"> <div class="crmLinkColor cP"> {{getI18n(\'crm.appointments.status.markcancel\',getSingularLabel(\'Appointments\'))}} </div> </li> </template></template> </template></template></template></template> <a class="fillAspLi crmLinkColor cP" data-zcqa="relatedListEdit_{{module}}" href="javascript:;" data-params="{&quot;module&quot;:&quot;{{module}}&quot;,&quot;id&quot; : &quot;{{activity_id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;,&quot;goTo&quot;:&quot;{{personality}}&quot;}" data-cid="editbtn"> <li class="moreOptValueList" onclick="{{action(\'hidePopOver\')}}"> {{getI18n(\'Edit\')}} </li> </a> <li class="moreOptValueList" deleteaction="javascript:Lyte.registeredMixins[\'crm-related-list-utils\'].sortRelatedList(\'{{getActivityActionLink(\'deleteLink\')}}\',null,\'{{activity_id}}\')" data-params="{&quot;module&quot;:&quot;{{module}}&quot;}" onclick="{{action(\'clickAction\',\'delete\',this)}}"> <div class="crmLinkColor cP fillAspLi" id="deletelink" data-zcqa="lnk_delete_{{module}}" deleteaction="javascript:Lyte.registeredMixins[\'crm-related-list-utils\'].sortRelatedList(\'{{getActivityActionLink(\'deleteLink\')}}\',null,\'{{activity_id}}\')" data-params="{&quot;module&quot;:&quot;{{module}}&quot;}" onclick="{{action(\'clickAction\',\'delete\',this)}}"> {{getI18n(\'Delete\')}} </div> </li> <template items="{{callAnalyticsAvailableIds}}" item="callAnalyticsAvailableId" index="index" is="for"><template is="if" value="{{expHandlers(activity_id,\'===\',callAnalyticsAvailableId)}}"><template case="true"><li data-params="{&quot;module&quot;:&quot;{{module}}&quot;}"> <div class="crmLinkColor cP fillAspLi" id="ViewAnalyticsLink" data-zcqa="lnk_view_analytics_{{module}}" data-params="{&quot;module&quot;:&quot;{{module}}&quot;}" onclick="{{action(\'clickActionViewAnalytics\')}}"> {{getI18n(\'zia.call.analytics.view\')}} </div> </li></template></template></template> </ul> </lyte-popover-content> </template> </lyte-popover> <lyte-modal lt-prop-show="{{isViewAnalytics}}" id="addNotification" lt-prop-freeze="true" lt-prop-wrapper-class="ziaCallAnalyticswrapper" lt-prop="{&quot;width&quot; : &quot;650px&quot;, &quot;transition&quot; : {&quot;animation&quot; : &quot;slideFromTop&quot;, &quot;duration&quot; : &quot;0.3&quot;}, &quot;offset&quot; : {&quot;top&quot;:&quot;0px&quot;,&quot;left&quot;:&quot;center&quot;} }" lt-prop-show-close-button="true" lt-prop-dimmer="{&quot;color&quot;:&quot;var(--modalFreezeLayerBg)&quot;,&quot;opacity&quot;:&quot;0.5&quot;}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <div class="w100_per dF aiCenter crm-font-bold crm-heading-font-size zia-primary-color"> <div class="dIB ziaIc32x24"> <crmutil-icon icon-name="zia-logo" icon-class="zcicn-zia-logo zcicn_4a8de9 "></crmutil-icon> </div> <div class="dIB vaM mL10">{{getI18n(\'crm.setup.system.ziacallanalytics\')}}</div></div> </lyte-modal-header> <lyte-modal-content> <crm-zia-call-analytics is-pop-up="true" call-analytics-data="{{callAnalyticsData}}"></crm-zia-call-analytics> </lyte-modal-content> </template> </lyte-modal> </lyte-event-listener></template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1,1,1]},{type:"componentDynamic",position:[1,1,1,1,1]},{type:"attr",position:[1,1,1,3]},{type:"text",position:[1,1,1,3,0]},{type:"attr",position:[1,1,1,5]},{type:"if",position:[1,1,1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"text",position:[0,1]}]}},default:{}},{type:"attr",position:[1,1,1,7]},{type:"if",position:[1,1,1,7],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"text",position:[0,1]}]}},default:{}},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,1,1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","item.$colour_code"]}}}}]}},default:{}},{type:"text",position:[1,3]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[6]},{type:"if",position:[6],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","item.$colour_code"]}}}}]}},default:{}},{type:"text",position:[3]}]}},default:{}},{type:"attr",position:[1,2]},{type:"if",position:[1,2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[1,4]},{type:"if",position:[1,4],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,5]},{type:"attr",position:[1,1,5,1]},{type:"if",position:[1,1,5,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,7]},{type:"if",position:[1,1,7],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[]}},default:{}},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]}]}},default:{}},{type:"attr",position:[1,1,9]},{type:"for",position:[1,1,9],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,0]},{type:"attr",position:[1,5,1]},{type:"if",position:[1,5,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},{type:"attr",position:[1,1,11]},{type:"for",position:[1,1,11],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[3]},{type:"text",position:[3,1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]}]}},default:{}}]}},default:{}}]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"registerYield",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1]},{type:"attr",position:[3]},{type:"text",position:[3,1,1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1]},{type:"attr",position:[3]},{type:"text",position:[3,1,1]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,3]},{type:"attr",position:[1,1,3,1]},{type:"text",position:[1,1,3,1,1]},{type:"attr",position:[1,1,5]},{type:"attr",position:[1,1,5,1]},{type:"text",position:[1,1,5,1,1]},{type:"attr",position:[1,1,7]},{type:"for",position:[1,1,7],dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"attr",position:[0,1]},{type:"text",position:[0,1,1]}]}},default:{}}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5]},{type:"registerYield",position:[1,5,1],dynamicNodes:[{type:"componentDynamic",position:[1,1,1,1]},{type:"text",position:[1,1,3,0]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"componentDynamic",position:[3,1]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}],_observedAttributes:["data","info","entity_id","rel_module","module","list_relation_id","personality","showpopover","popoverOrigin","activity_id","subject","isprintview","dateformat","process_flow","approved","approval_state","pr_class","canvas","relation_name","isLoading","pr_class","hasEditPermissionForApp","appEndTime","fields","fieldsforrel","headings","excludeFields","layout_id","rlId","relatedList","rlIdVsCount","internalFields","isPermissionDenied","txt_ln","hasCompletePermissionForTask","parent_relation_name","showCompleteaction","service_id","isClientAccount","isViewAnalytics","callAnalyticsData","callAnalyticsIdVsDataMapObj","isTeamSpaceFeatureAvailable","callAnalyticsAvailableIds","tabHeadCount","fromNewDetail"],data:function(){return{data:Lyte.attr("array"),info:Lyte.attr("object"),entity_id:Lyte.attr("string"),rel_module:Lyte.attr("string"),module:Lyte.attr("string"),list_relation_id:Lyte.attr("string"),personality:Lyte.attr("string"),showpopover:Lyte.attr("boolean",{default:!1}),popoverOrigin:Lyte.attr("string"),activity_id:Lyte.attr("string"),subject:Lyte.attr("string"),isprintview:Lyte.attr("boolean",{default:!1}),dateformat:Lyte.attr("string"),process_flow:Lyte.attr("boolean",{default:!1}),approved:Lyte.attr("boolean",{default:!0}),approval_state:Lyte.attr("string"),pr_class:Lyte.attr("string"),canvas:Lyte.attr("boolean",{default:!1}),relation_name:Lyte.attr("string"),isLoading:Lyte.attr("boolean",{default:!1}),pr_class:Lyte.attr("string"),hasEditPermissionForApp:Lyte.attr("boolean",{default:!Crm.userDetails.permissions||Crm.userDetails.permissions.Crm_Implied_Edit_Appointments}),appEndTime:Lyte.attr("string",{default:""}),fields:Lyte.attr("array"),fieldsforrel:Lyte.attr("object"),headings:Lyte.attr("array"),excludeFields:Lyte.attr("array"),layout_id:Lyte.attr("string"),rlId:Lyte.attr("string"),relatedList:Lyte.attr("object",{hideAttr:!0}),rlIdVsCount:Lyte.attr("object",{default:{}}),internalFields:Lyte.attr("array",{default:[]}),isPermissionDenied:Lyte.attr("boolean",{default:!1}),txt_ln:Lyte.attr("number",{default:80}),hasCompletePermissionForTask:Lyte.attr("boolean",{default:!0}),parent_relation_name:Lyte.attr("string"),showCompleteaction:Lyte.attr("boolean",{default:!1}),service_id:Lyte.attr("string",{default:""}),isClientAccount:Lyte.attr("boolean",{default:Crm.userDetails.CLIENT_ACCOUNT}),isViewAnalytics:Lyte.attr("boolean",{default:!1}),callAnalyticsData:Lyte.attr("object"),callAnalyticsIdVsDataMapObj:Lyte.attr("object",{default:{}}),isTeamSpaceFeatureAvailable:Lyte.attr("boolean",{default:"undefined"!=typeof featuresAvailable&&featuresAvailable.TEAMSPACE_ENABLED}),callAnalyticsAvailableIds:Lyte.attr("array",{default:[]}),tabHeadCount:Lyte.attr("object"),fromNewDetail:Lyte.attr("boolean")}},init:function(){if(this.getData("canvas")){var t=store.peekAll("related_list",{module:this.getData("rel_module"),layout_id:this.getData("layout_id")}).filterBy({personality_name:Lyte.Component.registeredHelpers.getPersonalityByRelation(this.getData("relation_name"))}).filterBy({href:moduleApiMapping[this.getData("rel_module")]+"/{ENTITYID}/"+this.getData("relation_name")})[0].id;this.setData("rlId",t);this.setData("excludeFields",["Subject","Event_Title","Appointment_Name","Due_Date","Owner","Start_DateTime","End_DateTime","All_day","Call_Start_Time","Appointment_Start_Time","Member","$process_flow","$approved","$approval_state","$in_project_sync","$se_module","$colour_code","Locked__s"]),this.setDataInComp()}else"Appointments"===this.getData("module")&&this.getData("data")&&(this.data.isClientAccount&&this.setData("rlId",this.data.list_relation_id),this.executeMethod("setAppPreference",this))},setDataInComp:function(t,e,a,i){var o=this;app.store.makeRequest("findRecord","related_list",o.getData("rlId"),{module:moduleApiMapping[o.getData("rel_module")],layout_id:o.getData("layout_id"),include_inner_details:"fields.lookup,fields.ui_type,fields.formula,fields.rollup_summary,fields.field_label"}).then((function(s){if(void 0!==s){o.setData("isPermissionDenied",!1),o.setData("relatedList",s[0]),Lyte.Component.registeredHelpers.constructFieldsForRel(o,s[0].fields),a&&a.component&&a.component.getData||(a=o.data.fromNewDetail?o.$node.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode:o.$node.parentNode.parentNode.parentNode.parentNode.parentNode);var n=o.getData("rel_module");if(o.getData("entity_id")&&"undefined"!==o.getData("entity_id")&&"null"!==o.getData("entity_id")&&o.getData("relation_name")&&moduleRecordMapping[n]){var l=o.getData("fields").join();l+=",Currency","APPOINTMENTSPERSONALITY"!==o.getData("relatedList.personality_name")&&"APPOINTMENTSHISTORYPERSONALITY"!==o.getData("relatedList.personality_name")||o.getData("fields").includes("Status")||(l+=",Status");var r="/crm/v3/"+moduleRecordMapping[n].api_name+"/"+o.getData("entity_id")+"/"+o.getData("relation_name"),p=Lyte.Component.registeredHelpers.getSortColumn(o.getData("relation_name")),d=o,c=$L("#fetch_"+a.component.getData("related_list_id"));r=r.replace("v2","v3"),e=e||1,c.removeClass("ref_complete").addClass(" ref_loading peNone");var m={data:[]},u={data:[]},y={},f=o.getData("info");if(f&&f.next_page_token)var _=store.findAll("dummy",{page_token:f.next_page_token,fields:l,page:e,per_page:10,sort_by:p,sort_order:d.getData("relation_name").indexOf("History")>-1?"desc":"asc",approved:"both"},!1,!1,{url:r});else _=store.findAll("dummy",{fields:l,page:e,per_page:10,sort_by:p,sort_order:d.getData("relation_name").indexOf("History")>-1?"desc":"asc",approved:"both"},!1,!1,{url:r});_.then((function(e){if(e.errors)crmui.showMsgBand("error",I18n.getMsg("error"));else{d.setData("isPermissionDenied",!1);var s=d.getData("data"),n=s&&s.length&&t?s.concat(e.data):e.data;if(d.setData("data",n),d.setData("info",e.meta),d.setData("isLoading",!1),$L(".actColumnList").scroll({preventHorizontal:!0}),a.component.setRecordCount(i),c.removeClass("ref_loading peNone").addClass("ref_complete"),void 0!==n&&!Crm.userDetails.CLIENT_ACCOUNT){"Appointments"===d.getData("module")&&d.getData("hasEditPermissionForApp")&&o.executeMethod("setAppPreference",o),m.parentid||-1!==d.getData("personality").indexOf("HISTORY")?u.parentid||-1===d.getData("personality").indexOf("HISTORY")||(u.parentid=d.getData("list_relation_id")):m.parentid=d.getData("list_relation_id");var l={};l.module=d.getData("module"),l.zcqa="customize_"+l.module,l.personality=d.getData("personality"),l.label="Events"===d.getData("module")?"Meetings":d.getData("module"),l.parentid=d.getData("rlId"),l.relatedList=d.getData("relatedList"),-1===l.personality.indexOf("HISTORY")?y[d.getData("module")]=l:y[d.getData("module")+"_History"]=l,Lyte.Component.registeredHelpers.constructCustomizePopup(m,u,y)}}}),(function(){d.setData("isPermissionDenied",!0),d.setData("isLoading",!1)}))}else o.setData("isLoading",!1),a.component.setRecordCount(i);o.setData("translabel",store.peekAll("related_list",{module:o.getData("rel_module"),layout_id:o.getData("layout_id")}).filterBy({personality_name:Lyte.Component.registeredHelpers.getPersonalityByRelation(o.getData("relation_name"))}).filterBy({href:moduleApiMapping[o.getData("rel_module")]+"/{ENTITYID}/"+o.getData("relation_name")})[0].display_label),t||o.setData("isLoading",!0),o.setData("personality",Lyte.Component.registeredHelpers.getPersonalityByRelation(o.getData("relation_name")))}else o.setData("isPermissionDenied",!0)}),(function(){o.setData("isPermissionDenied",!0)}))},actions:{handleCallAnalyticsAvailable:function(t){const e=this,a="true"===window.isSandboxAcc||window.isCanvasSandboxDiff;try{if(!a&&t){let a=e.getData("callAnalyticsAvailableIds"),i=e.getData("callAnalyticsIdVsDataMapObj");t.forEach((t=>{a.contains(t.id)||(Lyte.arrayUtils(a,"push",t.id),Lyte.objectUtils(i,"add",t.id,t))}))}}catch(t){murphy.error(t)}},showUserTooltip:function(t,e){var a="relatedList_"+e+"_Activities_owner";this.showUserToolPopup(t,a)},clickActionViewAnalytics:function(){this.setData("isViewAnalytics",!1);var t=this.getData("activity_id");let e=this.getData("data").filter((e=>e.id===t))[0];e.callAnalyticsData=this.getData("callAnalyticsIdVsDataMapObj")[t],this.setData("callAnalyticsData",e),this.setData("isViewAnalytics",!0)},readMoreDesc:function(t){this.readMore(t)},hideUserTooltip:function(){this.$node.querySelector("#activities_addons_user_tooltip").component.hide()},showMoreOptions:function(t,e){var a=t.Event_Title?t.Event_Title:t.Appointment_Name?t.Appointment_Name:t.Subject;$L(e).closest("li").eq(0).addClass("aspActiveList"),this.setData("popoverOrigin","#act_split_origin_"+t.id),this.setData("process_flow",t.$process_flow),this.setData("approved",t.$approved),this.setData("approval_state",t.$approval_state),this.setData("activity_id",t.id),this.setData("subject",a),this.setData("showpopover",!0),"Appointments"===this.getData("module")&&(this.setData("service_id",t.Service_Name.id),this.setData("appEndTime",t.Appointment_End_Time))},hidePopOver:function(){this.setData("showpopover",!1)},callAction:function(t,e){this.showCallAction(t,e)},showAppPopup:function(t,e,a,i){a=i?i.Appointment_End_Time:void 0,this.setData("showpopover",!1),Lyte.resolvePromises({filesResolved:Lyte.injectResources(networkUtils.returnDependencyFiles(["zohocrm_services.js"],ResourceConstants.CRM).concat(networkUtils.returnDependencyFiles(["crm-services-appointments.js","servapp_preferences_model.js"],ResourceConstants.CRMClient)).concat(networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("businesshours")],ResourceConstants.CRM)))}).then((function(){Lyte.registeredMixins["crm-appointments-mixin"].setAppointmentStatusActions(t,e,a),$L("#Calendar").hide()}))},clickAction:function(t,e,a,i){this.showClickAction(t,e,a,i,!1)},viewMoreData:function(t){if(!this.getData("isprintview")){var e=$L(t),a=e.outerHeight(),i=e.scrollTop(),o=e[0].scrollHeight;if(this.getData("canvas")&&this.getData("fromNewDetail")||(o*=.8),o<=a+i&&i>0){var s=this.getData("info");if(s&&s.more_records){var n=(s.page-1)*s.per_page+s.count+1;if(this.getData("canvas"))this.setDataInComp(!0,s.page+1);else if(Crm.userDetails.isRelatedListLyteEnabled)Lyte.triggerEvent("relatedList",{id:this.getData("list_relation_id"),module:this.getData("rel_module")});else{var l={fromIndex:n,rid:this.getData("list_relation_id"),module:this.getData("rel_module"),isSortRequest:!1,id:this.getData("entity_id")};crmRelatedList.ajaxReq(l,void 0,!0)}}}}},showHideRelatedFields:function(t,e,a,i){if("mouseout"==i.type)return crmui.hideTooltip(),!0;var o={},s=$L(i.target);"Who_Id"===e?o.module="Contacts":"Service_Name"===e?o.module="Services":store.peekAll("module").forEach((function(t){t.api_name===a&&(o.module=t.module_name)})),o.id=t.id,crmLookupBusinessCard.showingSide="showOnRight",renderingUtils.windowWidth/2<s.offset().left&&(crmLookupBusinessCard.showingSide="showOnLeft"),s.offset().left<400&&s[0].getBoundingClientRect().right>renderingUtils.windowWidth-400&&(crmLookupBusinessCard.showingSide="showOnBottom"),o&&o.module&&o.id&&setTimeout((function(){s.is(":hover")&&crmLookupBusinessCard.getRecordJSon(o.module,o.id,s)}),250)}},methods:{closePopup:function(t,e){$L(".aspActiveList").removeClass("aspActiveList"),setTimeout((function(){e.setData("ltPropBindToBody",!1)}),1)},setAppPreference:function(t){Lyte.injectResources(networkUtils.returnDependencyFiles(["servapp_preferences_model.js"],ResourceConstants.CRMClient),void 0,(function(){store.findAll("servapp_preferences",{},!1,!0,{module:"Appointments"}).then((function(e){"mark_as_complete"===e[0].appointments.when_duration_exceeds?t.setData("showCompleteaction",!1):t.setData("showCompleteaction",!0)}))}))}}},{mixins:["crm-activity-mixin","crm-related-list-utils"]}),Lyte.Component.register("crm-activity-rel-actions",{_template:'<template tag-name="crm-activity-rel-actions"> <template is="if" value="{{expHandlers(newLyteRL,\'!\')}}"><template case="true"> <template is="if" value="{{expHandlers(data.length,\'==\',1)}}"><template case="true"><template is="for" items="{{data}}" item="item" index="index"> <div class="dummyForLeftPanel createlink" id="addnew-btn" data-zcqa="{{item.zcqa}}" onclick="{{action(\'createAction\',item.datacid,event,this)}}" data-relid="{{parentid}}" tabindex="0" aria-label="{{item.label}}" role="button" lt-prop-aria-keydown="true" aria-haspopup="true">&gt;{{item.label}}</div> </template></template><template case="false"><template is="if" value="{{expHandlers(expHandlers(data.length,\'!=\',0),\'||\',expHandlers(getUserStatus(\'hideUnauthorizedCreateLink\'),\'!\'))}}"><template case="true"> <div class="pR dIB" data-zcqa="addNewActRL" id="addNewActRL"> <div class="addnew-btn1 pR activities_rl_btn {{openActPopKey}}" onclick="{{action(\'showAddNewPop\')}}" tabindex="0" role="combobox" aria-haspopup="listbox" lt-prop-aria-keydown="true" aria-label="{{getI18n(\'crm.import.add.new\')}}" aria-controls="addNewPopover"> <span class="addnew-btn crmLinkColor crm-base-font-size" id="addnew-btn">{{getI18n(\'crm.import.add.new\')}}</span> <span class="zcicn-arrow-solid-down-sm-mask zcicn-cssIcons zcicn_blue_mask"></span> </div> </div> </template></template></template></template> <lyte-popover lt-prop-bind-to-body="{{bindToBody}}" lt-prop-aria="{{isAccessibilityConfigSupported}}" lt-prop-origin-elem="{{originElem}}" lt-prop-height="auto" lt-prop-scrollable="true" lt-prop-duration="400" lt-prop-content-padding="5px 0" lt-prop-animation="fade" id="addNewPopover" lt-prop-show="{{lbind(showPopover)}}" lt-prop-freeze="false" lt-prop-show-close-button="false" lt-prop-allow-multiple="true" lt-prop-close-on-body-click="{{lbind(closeOnBodyClick)}}" on-before-close="{{method(\'closeActPop\')}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="addNewPopContent"> <ul class="addNewValues m0 p0" role="listbox" tabindex="0" id="addNewPopoverUL"> <template is="for" items="{{data}}" item="item" index="index"> <li class="alignLeft cP crm-base-font-size addNewPopoverLi" data-zcqa="{{item.zcqa}}" data-relid="{{parentid}}" onclick="{{action(\'createAction\',item.datacid,event,this)}}"> <div class="dummyForLeftPanel capt p0 link fillAspLi" data-relid="{{parentid}}">{{item.label}}</div> </li> </template> </ul> </lyte-popover-content> </template> </lyte-popover> </template><template case="false"> <template is="if" value="{{expHandlers(data.length,\'==\',1)}}"><template case="true"><template is="for" items="{{data}}" item="item" index="index"> <lyte-button lt-prop-appearance="primary" lt-prop-class="dummyForLeftPanel outlineprimary" lt-prop-size="small" id="addnew-btn" data-zcqa="{{item.zcqa}}" onclick="{{action(\'createAction\',item[\'data-cid\'],event,this)}}" data-relid="{{parentid}}"><template is="registerYield" yield-name="text">{{item.label}}</template></lyte-button> </template></template><template case="false"><template is="if" value="{{fromLeftPanel}}"><template case="true"> <span class="attachmentsLeftPanelAddition addNewIcP lyteMenuSelected" data-zcqa="newleft__Add_Create_{{actRelatedList.module.api_name}}" id="addnew-btn-leftpane" onclick="{{action(\'showAddNewPop\')}}"></span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(data.length,\'!=\',0),\'||\',expHandlers(getUserStatus(\'hideUnauthorizedCreateLink\'),\'!\'))}}"><template case="true"> <div class="pR dIB mT1" data-zcqa="addNewActRL" id="addNewActRL"> <lyte-button lt-prop-disabled="{{if(ifEquals(data.length,0),true,false)}}" lt-prop-title="{{if(ifEquals(data.length,0),getI18n(\'crm.security.error\'),\'\')}}" lt-prop-appearance="primary" lt-prop-class="outlineprimary" lt-prop-size="small" class="pR {{openActPopKey}} lyteDropdownButton addnew-btn1" onclick="{{action(\'showAddNewPop\')}}" data-zcqa="activity-addnew-btn" id="addnew-btn"><template is="registerYield" yield-name="text">{{getI18n(\'crm.import.add.new\')}}</template></lyte-button> </div> </template></template></template></template></template></template> <template is="if" value="{{data.length}}"><template case="true"> <lyte-popover lt-prop-origin-elem="{{originElem}}" lt-prop-height="auto" lt-prop-scrollable="true" lt-prop-duration="400" lt-prop-content-padding="5px 0" lt-prop-animation="fade" id="addNewPopover" lt-prop-show="{{lbind(showPopover)}}" lt-prop-freeze="false" lt-prop-show-close-button="false" lt-prop-allow-multiple="true" lt-prop-close-on-body-click="{{lbind(closeOnBodyClick)}}" on-before-close="{{method(\'closeActPop\')}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="addNewPopContent pR"> <ul class="addNewValues m0 p0" role="listbox" tabindex="0" id="addNewPopoverUL"> <template is="for" items="{{data}}" item="item" index="index"> <li class="alignLeft cP robotoRegular crm-base-font-size" data-zcqa="{{if(item.zcqa,item.zcqa,item.data_zcqa)}}" data-relid="{{parentid}}" onclick="{{action(\'createAction\',item[\'data-cid\'],event,this)}}"> <div class="dummyForLeftPanel capt p0 link fillAspLi" data-relid="{{parentid}}">{{item.label}}</div> </li> </template> </ul> </lyte-popover-content> </template> </lyte-popover> </template></template> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"for",position:[0],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]}]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,1,0]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"for",position:[0],dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,0],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]}]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1,0],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["showPopover","data","parentid","originElem","closeOnBodyClick","openActPopKey","newLyteRL","module","record","fromLeftPanel","isDataSet","isAccessibilityConfigSupported","leftPanelActId","bindToBody"],data:function(){return{showPopover:Lyte.attr("boolean",{default:!1}),data:Lyte.attr("array"),parentid:Lyte.attr("string"),originElem:Lyte.attr("string"),closeOnBodyClick:Lyte.attr("boolean"),openActPopKey:Lyte.attr("string",{default:""}),newLyteRL:Lyte.attr("boolean",{default:Crm.userDetails.isRelatedListLyteEnabled}),module:Lyte.attr("string"),record:Lyte.attr("object"),fromLeftPanel:Lyte.attr("boolean"),isDataSet:Lyte.attr("boolean"),isAccessibilityConfigSupported:Lyte.attr("boolean",{default:Crm.userDetails.isAccessibilityConfigSupported&&!featuresAvailable.NEXTGENUI_ENABLED}),leftPanelActId:Lyte.attr("string"),bindToBody:Lyte.attr("boolean",{default:!1})}},didConnect:function(){if(this.setData("bindToBody",!0),Crm.userDetails.isAccessibilityConfigSupported){var t=$L("#addNewPopoverUL");if(t.keyboardNavigator("presence"))t.keyboardNavigator("destroy");else{let e={scope:"#addNewPopoverUL",child:".addNewPopoverLi",selectedClass:"nonLyte_dd_focus",triggerClick:"true"};t.keyboardNavigator(e)}}},actions:{showAddNewPop:function(){this.setData("showPopover",!0),Crm.userDetails.isRelatedListLyteEnabled?this.setData("originElem",this.data.fromLeftPanel?"#addnew-btn-leftpane":"#addnew-btn"):this.setData("originElem","#addnew-btn"),this.setData("closeOnBodyClick",!0),this.setData("openActPopKey","openActPop")},createAction:async function(t,e,a){var i="";switch(t){case"newAppointment":i="Appointments";break;case"newEvent":i="Events";break;case"newTask":i="Tasks";break;case"logCall":i="Calls"}if(await Crm.loadRichTextFieldComponentResources(),""!==i){var o=Crm.getCrmBasePath()+"/Create.do",s=e;Crm.downloadValidationRules(o+"?format=json&module="+i,i,(function(){var i=$L("crm-activity-rel-actions")[0].component,o=a.children[0],n="newAppointment"===t?a:void 0===o?$("#addnew-btn"):o;if(Crm.userDetails.TaskPopup&&"newTask"===t)crmRelatedList.relTaskCreate(o);else if(Crm.userDetails.isRelatedListLyteEnabled){var l=$(e.target).attr("data-relid"),r=l||$(e.target.closest("lyte-button")).attr("data-relid");i.executeRelatedListActions(t,i.getPersonalityModuleObj(r),i.data.module,i.data.record,e)}else crmRelatedList[t](s,n);"logCall"===t&&isNewCallView?(i.setData("showPopover",!0),i.setData("closeOnBodyClick",!1)):i.setData("showPopover",!1)}))}}},methods:{closeActPop:function(){this.setData("openActPopKey","");var t=$L("crm-manual-call-list")[0];t&&t.component&&t.component.setData("showMenu",!1)}},dataObserver:function(){this.getData("leftPanelActId")&&this.data&&this.data.data&&!this.data.data.length&&$L("#newleft_"+this.data.leftPanelActId).find(".addNewIcP").hide()}.observes("data.[]")},{mixins:["crm-detail-view-utils","crm-related-list-utils"]}),Lyte.Component.register("crm-activity-rel-customize",{_template:'<template tag-name="crm-activity-rel-customize" id="{{outer_selector}}" class="{{if(canvas,\'\',\'dIB vaM\')}}"> <template is="if" value="{{expHandlers(expHandlers(data,\'!=\',undefined),\'&amp;&amp;\',expHandlers(data.length,\'!=\',0))}}"><template case="true"> <div class="pR aiCenter dF jcFlextEnd {{if(canvas,\'\')}} {{if(fromModuleBuilder,\'mB10\')}} {{if(fromDetailLyte,\'\',\'mL5\')}}"> <template is="if" value="{{expHandlers(isChronologicalEnabled(),\'&amp;&amp;\',expHandlers(fromModuleBuilder,\'!\'))}}"><template case="true"> <lyte-dropdown lt-prop-aria-button="{&quot;aria-label&quot; : {{getI18n(&quot;crm.accessibility.rl.view&quot;)}}}" lt-prop-aria-keydown="true" class="crmSmallDropdown mR5 {{parent_relation_name}}_relchronoview relview" lt-prop-selected="{{activity_name}}" on-show="{{method(\'chViewDropdownClose\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box> <lyte-drop-body> <lyte-drop-item data-value="ColumnView" data-zcqa="activities_columnview" onclick="{{action(\'triggerEvent\',\'ColumnView\')}}">{{getI18n(\'crm.related.view.columnview\')}}</lyte-drop-item> <template is="if" value="{{expHandlers(expHandlers(canvas,\'!\'),\'||\',fromDetailLyte)}}"><template case="true"><div> <lyte-drop-item data-value="TabView" data-zcqa="activities_tabview" onclick="{{action(\'triggerEvent\',\'TabView\')}}">{{getI18n(\'crm.related.view.tabview\')}}</lyte-drop-item> </div></template></template> <template is="if" value="{{expHandlers(isClientAccount,\'!\')}}"><template case="true"><div> <lyte-drop-item data-value="TimeLineView" data-zcqa="activities_timelineview" onclick="{{action(\'triggerEvent\',\'TimeLineView\')}}">{{getI18n(\'crm.related.view.chronological\')}}</lyte-drop-item> </div></template></template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template></template> <template is="if" value="{{isshowcol}}"><template case="true"> <div data-zcqa="{{btn_name}}_customize" id="{{btn_name}}_customize"></div> <template is="if" value="{{fromDetailLyte}}"><template case="true"> <div class="icon-hover-effects column-add-icon icon-hover-gray-bg-nb pR mR4 {{openActPopKey}}" onclick="{{action(\'showCustomizePop\')}}" tabindex="0" aria-label="showCustomizePop" lt-prop-aria-keydown="true"> <span class="zcicncss-column-add zcicn-cssIcons zcicn_black_mask scale9 zi2 cP {{if(fromModuleBuilder,\'hide\',\'\')}}" id="{{btn_name}}_btn"></span> </div> </template><template case="false"> <div class="pR {{openActPopKey}}" onclick="{{action(\'showCustomizePop\')}}" tabindex="0" aria-label="showCustomizePop" lt-prop-aria-keydown="true"> <span class="newRlEditBtn {{if(fromModuleBuilder,\'\',\'dIB svgIcons\')}} dvRlcolumnEdit visible" id="{{btn_name}}_btn"></span> </div> </template></template> <lyte-popover lt-prop-origin-elem="{{originElem}}" lt-prop-height="auto" lt-prop-type="box" lt-prop-scrollable="true" lt-prop-placement="bottom" lt-prop-wrapper-class="aspPopover" lt-prop-duration="400" lt-prop-content-padding="5px 0" lt-prop-animation="fade" id="customizePopover_{{btn_name}}" lt-prop-show="{{lbind(showPopover)}}" lt-prop-freeze="false" lt-prop-show-close-button="false" lt-prop-allow-multiple="true" lt-prop-close-on-body-click="{{lbind(closeOnBodyClick)}}" on-before-close="{{method(\'closeActPop\')}}" lt-prop-auto-align="true"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="pR addNewPopContent {{if(canvas,\'addNewPopContentCanvas\',\'\')}}"> <ul class="addNewValues addNewValues_{{btn_name}} m0 p0" id="{{btn_name}}_ul"> <template is="for" items="{{data}}" item="item" index="index"> <li class="alignLeft cP robotoRegular crm-base-font-size" data-zcqa="{{if(item.zcqa,item.zcqa,item.data_zcqa)}}" data-relid="{{item.personality}}_{{item.parentid}}" data-name="{{item.personality}}" data-module="{{item.module}}" data-listrelationid="{{item.parentid}}" id="{{item.personality}}_{{item.parentid}}" ddid="{{item.parentid}}" onclick="{{action(\'showCustomizeListPopup\',this,event,item.module,item.parentid)}}"> <span class="dummyForLeftPanel capt p0 link fillAspLi"> <template is="if" value="{{canvas}}"><template case="true"> {{getI18n(item.label)}} </template><template case="false"> {{item.label}} </template></template> </span> <input type="hidden" name="frmmodule" id="frmmodule_{{item.parentid}}" value="{{item.module}}"> </li> </template> </ul> </lyte-popover-content> </template> </lyte-popover> </template></template></div></template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"text",position:[1,1,1,0]},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0,1]},{type:"text",position:[0,1,0]},{type:"componentDynamic",position:[0,1]}]}},default:{}},{type:"attr",position:[1,1,5]},{type:"if",position:[1,1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[0,1]},{type:"text",position:[0,1,0]},{type:"componentDynamic",position:[0,1]}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]}]}},default:{}},{type:"attr",position:[5]},{type:"registerYield",position:[5,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"attr",position:[1,3]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[5]}]}},default:{}}]}},default:{}}],_templateAttributes:{type:"attr",position:[]},_observedAttributes:["showPopover","data","parentid","originElem","btn_name","closeOnBodyClick","openActPopKey","fromModuleBuilder","canvas","outer_selector","relatedModule","rel_module","relatedList","layout_id","entity_id","related_list_id","module_data","module_name","activity_name","mod_data","field_data","isshowcol","activityType","chronoRelList","parent_relation_name","subModuleData","navItems","related_list","activityData","isClientAccount","fromDetailLyte"],data:function(){return{showPopover:Lyte.attr("boolean",{default:!1}),data:Lyte.attr("array"),parentid:Lyte.attr("string"),originElem:Lyte.attr("string"),btn_name:Lyte.attr("string"),closeOnBodyClick:Lyte.attr("boolean"),openActPopKey:Lyte.attr("string",{default:""}),fromModuleBuilder:Lyte.attr("boolean",{default:!1}),canvas:Lyte.attr("boolean",{default:!1}),outer_selector:Lyte.attr("string"),relatedModule:Lyte.attr("string"),rel_module:Lyte.attr("string"),relatedList:Lyte.attr("object",{hideAttr:!0}),layout_id:Lyte.attr("string"),entity_id:Lyte.attr("string"),related_list_id:Lyte.attr("string"),module_data:Lyte.attr("object"),module_name:Lyte.attr("string"),activity_name:Lyte.attr("string"),mod_data:Lyte.attr("array"),field_data:Lyte.attr("array"),isshowcol:Lyte.attr("boolean",{default:!0}),activityType:Lyte.attr("string"),chronoRelList:Lyte.attr("object"),parent_relation_name:Lyte.attr("string"),subModuleData:Lyte.attr("array"),navItems:Lyte.attr("array"),related_list:Lyte.attr("object"),activityData:Lyte.attr("object"),isClientAccount:Lyte.attr("boolean",{default:Crm.userDetails.CLIENT_ACCOUNT}),fromDetailLyte:Lyte.attr("boolean",{default:!1})}},actions:{showCustomizePop:function(){this.setData("showPopover",!0),this.setData("originElem","#"+this.getData("btn_name")+"_btn"),this.setData("closeOnBodyClick",!0),this.setData("openActPopKey","openActPop"),$L("#dv-button-layer").addClass("pR zi10")},showCustomizeListPopup:function(t,e,a,i){if(this.getData("fromModuleBuilder"))CMB.openCuspopup(this.getData("originElem"),t,e);else if(this.getData("canvas")){var o=this;let t=a.includes("Appointments")?"Appointments":a;this.setData("relatedModule",t);var s=store.peekRecord("module",moduleRecordMapping[t].id).fields,n=!Crm.userDetails.isRelatedListLyteEnabled||Lyte.Globals.get("relatedList.oldAppointments");if("TimeLineView"===this.getData("activity_name")||n){var l=this.getData("relatedList");if(l&&l.fields&&l.fields.length>0){var r=l.fields,p=[];r.forEach((t=>{t.hasOwnProperty("_delete")||p.push(t)})),l.fields=p,this.setData("relatedList",l)}}s&&0!==s.length?Lyte.Component.registeredHelpers.openColumnList(o,i):store.findRecord("module",moduleRecordMapping[t].id).then((function(){Lyte.Component.registeredHelpers.openColumnList(o,i)}))}else if(!Crm.userDetails.isRelatedListLyteEnabled){if(""===this.getData("openActPopKey"))return this.setData("showPopover",!0),this.setData("originElem","#"+this.getData("btn_name")+"_btn"),this.setData("closeOnBodyClick",!0),this.setData("openActPopKey","openActPop"),void $L("#dv-button-layer").addClass("pR zi10");var d=$(t).data(),c=document.getElementById(this.getData("btn_name")+"_customize");$(c).data({module:d.module,name:d.name,relid:d.relid,listRelationId:d.listrelationid}),showCustomizeListPopup(c,e,a);var m=$(".addNewValues_"+this.getData("btn_name")),u=$("#"+this.getData("btn_name")+"_btn"),y=u.offset().left+u.outerWidth()-m.offset().left+1,f=$("#relatedListCols_"+d.name);f.removeClass("right0"),Crm.userDetails.RTL_ENABLED?(y=m.offset().left+m.outerWidth()+1-u.offset().left,f.css("left",y+"px")):f.css("right",y+"px")}},triggerEvent:function(t){if(this.getData("activity_name")===t)return;this.storeActivitiesRelView(t);let e=this.data.related_list_id?this.data.related_list_id:this.getData("outer_selector");this.renderActivityComponent(t,e)}},methods:{closeActPop:function(){if(this.setData("openActPopKey",""),$(".selectColPop").is(":visible"))return this.setData("openActPopKey","openActPop"),!1;$L("#dv-button-layer").removeClass("pR zi10")},chViewDropdownClose:function(){this.setData("showPopover",!1);var t=$(".selectColPop");t.is(":visible")&&t.css("display","none")}},getColumnListData:function(t){for(var e=t.length,a=[],i=0;i<e;i++)"BEST_TIME"===t[i].column_name||"Visits"===this.data.relatedModule&&"SEID"===t[i].column_name||a.push(t[i]);return a},saveColumnList:function(t,e){var a,i=this.data.relatedList,o=1;if(Crm.userDetails.isRelatedListLyteEnabled&&(i&&!i.$&&(i=store.peekRecord("related_list",i.id)),e.getData))var s=e.getData("module");i.fields.forEach((function(e){a=!1,t.forEach((function(t){e.id===t.id&&(a=!0)})),a||t.push({id:e.id,api_name:e.api_name,_delete:null})})),t.forEach((function(t){t._delete||(t.sequence_number=o++),"_delete"in t||1})),i.$.set("fields",t);var n=this;i.$.save(void 0,{module:moduleApiMapping[this.data.rel_module],layout_id:this.data.layout_id}).then((function(){setTimeout((function(){var t={module:n.data.rel_module,id:n.data.entity_id,fromIndex:1};Crm.userDetails.isRelatedListLyteEnabled||crmRelatedList.ajaxReq(t,void 0,!1),crmui.hidePopup("appointmentCreate"),("detail"===Lyte.Router.getRouteInstance().routeName&&Crm.userDetails.isRelatedListLyteEnabled||"canvas"===Lyte.Router.getRouteInstance().routeName)&&"entity"===Lyte.Router.getRouteInstance().parent.routeName&&(Crm.userDetails.isRelatedListLyteEnabled&&Lyte.Globals.get("relatedList.oldAppointments")&&Lyte.triggerEvent("appointmentsReload",{}),Lyte.triggerEvent("relatedList",{refresh:!0,refreshTemplate:!0,module:s,parent_relation_name:n.data.parent_relation_name})),e.hidePopover()}))}),(function(){e.hidePopover(),renderingUtils.displayPermissionDenied()})),this.setData("showPopover",!1)},storeActivitiesRelView:function(t){let e,a=this.getData("canvas")?this.getData("fromDetailLyte")?"detail":"canvas":"detail";if("openActivities"===this.getData("btn_name")?(Crm.userDetails.openActRelView=t,e="open"):"closedActivities"===this.getData("btn_name")&&(Crm.userDetails.closedActRelView=t,e="closed"),Crm.userDetails.actUserRelViewObj){var i=!!Crm.userDetails.actUserRelViewObj.actviewobj;let o;o=i?Crm.userDetails.actUserRelViewObj.actviewobj[a]:Crm.userDetails.actUserRelViewObj[a],"open"===e?o.openActRelView=t:o.closedActRelView=t,i?Crm.userDetails.actUserRelViewObj.actviewobj[a]=o:Crm.userDetails.actUserRelViewObj[a]=o}store.findAll("dummy",{action:"updateActRelView",viewname:t,activityType:e,viewpage:a},!1,!1,{url:Crm.getCrmBasePath()+"/EntityCustomization.do",method:"POST"})},renderActivityComponent:function(t,e){let a=this,i=a.getActivityComponentSelector(e);if(this.setData("activity_name",t),i.setData({Tasks_RelObj:void 0,Calls_RelObj:void 0,Events_RelObj:void 0,Appointments__s_RelObj:void 0}),"TimeLineView"===t){a.getData("canvas")||this.setTabData();let o=a.getData("module_name")?a.getData("module_name"):a.getData("rel_module");i.setData("showLoading",!0),this.getData("canvas")||store.unloadAll("related_list"),store.findAll("related_list",{module:moduleRecordMapping[o].api_name},!1,void 0,{from:"Chronological"}).then((function(o){let s=a.getPersonalityData(o,e,t);a.setData("chronoRelList",s),a.getData("canvas")?i.setData({activity_type:a.getData("activityType"),relModData:a.getData("chronoRelList"),activityView:t,showLoading:!1}):i.setData({activity_type:a.getData("activityType"),activityView:t,showLoading:!1})}))}else{if("ColumnView"===t&&!a.getData("canvas")&&!Crm.userDetails.isRelatedListLyteEnabled){i.setData("showLoading",!0);var o=a.getData("module_name"),s=Crm.getCrmBasePath()+"/NewRelatedList.do?action=getAllData",n=a.getData("entity_id"),l={module:decodeURIComponent(o),id:n,fromIndex:1},r=new crmRequestPool;this.setTabData();var p={action:s,type:"GET",data:l,success:function(t){i.setData({leftRelTotalCount:0,taskRelCount:0,callsRelCount:0,eventsRelCount:0,appRelCount:0}),i.setData("showLoading",!1),crmRelatedList.load(o,n,t,!1,void 0)},error:function(t){murphy.error(t)}};r.initiate(p)}i.setData("activityView",t)}},getPersonalityData:function(t,e,a){let i;return t.forEach((t=>{"TimeLineView"===a&&t.api_name.includes("Activities_Chronological_View")&&(("Activities"!==e&&"openActivities_customize_outer"!==e||"Activities_Chronological_View"!==t.api_name)&&("Activities_History"!==e&&"closedActivities_customize_outer"!==e||"Activities_Chronological_View_History"!==t.api_name)||(i=t))})),i},setTabData:function(){if(this.data.navItems.length>0){let t,e="Meetings"===this.getData("navItems")[0].name?"Events":this.getData("navItems")[0].name,a=this.getData("subModuleData");if(!this.getData("canvas")&&a){let i=a.length;if("Activities"===this.data.parent_relation_name)for(let o=0;o<i;o++)a[o].module===e&&(this.setData("activityData",a[o]),t=a[o].listRelationId);else if("Activities_History"===this.data.parent_relation_name)for(let o=0;o<i;o++)a[o].module===e&&(this.setData("activityData",a[o]),t=a[o].listRelationId)}this.setData("related_list",store.peekRecord("related_list",t))}},getActivityComponentSelector:function(t){return"Activities"===t||"openActivities_customize_outer"===t?(this.setData("activityType","open"),$L("#Activities")[0].component):"Activities_History"===t||"closedActivities_customize_outer"===t?(this.setData("activityType","closed"),$L("#Activities_History")[0].component):void 0}}),Lyte.Component.registerHelper("openColumnList",(function(t,e){commonUtils.showHideLoadingDiv();var a={};t.getData("data").forEach((function(t){t.parentid===e&&(a=t.relatedList)})),t.setData("relatedList",a),$L("crm-detail-view-common")[0].component.openColumnList(t,!0);var i=0;$L("crux-column-list")[0].component.getSelectedFields().each((function(t){!0===t.mandatory&&(i+=1)})),Crm.userDetails.isRelatedListLyteEnabled?Lyte.registeredMixins["crm-related-list-utils"].mandFields[a.personality_name]=i:crmRelatedList.mandFields[a.personality_name]=i})),Lyte.Component.registerHelper("getFieldsForRelation",(function(t){var e=null;switch(t){case"Tasks":case"Tasks_History":e=["$process_flow","$approved","$approval_state","$in_project_sync","$se_module","$colour_code","Locked__s"];break;case"Events":case"Events_History":case"Calls":case"Calls_History":case"Appointments_History__s":e=["$approved","$approval_state","$se_module","$colour_code"];break;case"Open_Appointments__s":e=["$approved","$approval_state","$se_module","$colour_code","Appointment_End_Time"]}return e})),Lyte.Component.registerHelper("isRelationVisible",(function(t,e){var a=store.peekAll("related_list");if(Crm.userDetails.isRelatedListLyteEnabled){var i={relationVisible:!1,createPermission:!1};if("Open_Appointments__s"===t||"Appointments_History__s"===t){var o;(o=store.peekAll("module").filter((t=>t.module_name===e&&t.related_lists))).length&&(a=o[0].related_lists)}for(var s in a)if(a[s].api_name===t)return i.relationVisible=a[s].visible,i.createPermission=a[s].record_operations.create,i;return i}for(var s in a)if(a[s].api_name===t)return!0;return!1})),Lyte.Component.registerHelper("formattedText",(function(t,e){return t.length<e?t:t.substring(0,e)+"..."})),Lyte.Component.registerHelper("getFormattedValue",(function(t,e,a,i,o,s,n,l){if("Appointments"===a&&"Duration"===e&&(i.Duration=Lyte.Transform["time-in-hrs"].deserialize(i.Duration)),l)var r=Lyte.registeredMixins["crm-canvas-core-construct-component"].constructCruxComponentForCanvas(t.id,a,i,!0,null,!0,!0,t);else r=Lyte.registeredMixins["crm-canvas-core-construct-component"].constructCruxComponentForCanvas(t[e].id,a,i,!0,null,!0,!0,t[e]);return Crm.userDetails.isRelatedListLyteEnabled&&(r=r||""),r})),Lyte.Component.registerHelper("validateField",(function(t){return!(!t||0===t.length||!1===t)})),Lyte.Component.registerHelper("getPluralLabel",(function(t){if("undefined"!=typeof moduleRecordMapping&&moduleRecordMapping[t])return moduleRecordMapping[t].plural_label;if(parent&&parent.Crm&&parent.Crm.userDetails.MODULE_LIST&&parent.Crm.userDetails.MODULE_LIST[t]){var e=parent.Crm.userDetails.MODULE_LIST[t],a=e.pluralLabel?e.pluralLabel:e.plural_label;if(a)return(0,Lyte.Component.registeredHelpers.getI18)(a)}return t})),Lyte.Component.registerHelper("getIconForAspComp",(function(t){return"Events"===t?"events":t.toLocaleLowerCase()})),Lyte.Component.registerHelper("getActivityActionLink",(function(t,e,a){var i=(e=e||this).getData("list_relation_id");if("Activities"===i){var o=e.getData("personality");i=store.peekAll("related_list").filterBy({personality_name:o})[0].id}switch(t){case"closeTask":return Crm.getCrmBasePath()+"/closeTask.do?action=CloseTask&taskid="+a+"&&module="+e.getData("rel_module")+"&id="+e.getData("entity_id")+"&nextStep=relatedlist&isajax=true#"+e.getData("personality")+"_"+i;case"deleteLink":return Crm.getCrmBasePath()+"/MassDelete.do?module="+e.getData("module")+"&id="+e.getData("activity_id")+"&actModule="+e.getData("rel_module")+"&actId="+e.getData("entity_id")+"&nextStep=relatedlist&isajax=true#"+e.getData("personality")+"_"+i;default:return""}})),Lyte.Component.registerHelper("getSubActivtyCount",(function(t,e){var a;a=t&&t.count?t.more_records?t.page*t.per_page+"+":(t.page-1)*t.per_page+t.count+"":"0";var i=this.getData("tabHeadCount");if((!this.getData("canvas")||this.getData("fromNewDetail"))&&e&&void 0!==i){var o=this.getData("module"),s=a;s.indexOf("+")>-1&&(s=s.substring(0,s.indexOf("+"))),s=Number(s),"Events"===o?o="Meetings":"Appointments"===o&&(o="Appointments__s"),i[o]=s,this.setData("tabHeadCount",i)}return a})),Lyte.Component.registerHelper("convertEventDateTime",(function(t,e,a,i,o){var s=Lyte.Component.registeredHelpers.convertTimeToUserDateFormatFromISO(t,i,o,!0);t=Utils.convertDateToUserPattern(s,o?o.toUpperCase():Crm.userDetails.DATE_PATTERN.toUpperCase());var n=Lyte.Component.registeredHelpers.convertTimeToUserDateFormatFromISO(e,i,o,!0);return e=Utils.convertDateToUserPattern(n,o?o.toUpperCase():Crm.userDetails.DATE_PATTERN.toUpperCase()),a?t===e?t+", "+I18n.getMsg("All Day"):t+" - "+e+", "+I18n.getMsg("All Day"):t===e?t+" "+Utils.getTimeInUserFormat(s,!0,!0)+" - "+Utils.getTimeInUserFormat(n,!0,!0):t+" "+Utils.getTimeInUserFormat(s,!0,!0)+" - "+e+" "+Utils.getTimeInUserFormat(n,!0,!0)})),Lyte.Component.registerHelper("convertTimeToUserDateFormatFromISO",(function(t,e,a,i){if(!t)return"";if(a=a?a.toUpperCase():a,e){var o=CrmDateUtils.getDateObjectFromString(t,"YYYY-MM-DD"),s=Crm.userDetails.DATE_PATTERN;return s||parent.Crm.userDetails.DATE_PATTERN&&(s=parent.Crm.userDetails.DATE_PATTERN),s&&(s=s.toUpperCase()),CrmDateUtils.convertDateToUserPattern(o,s)}var n=Utils.ISO8601toDateObject(t);if(i)return n;var l=Utils.convertDateToUserPattern(n,a);return l+=" "+Utils.getTimeInUserFormat(n,!0,!0)})),Lyte.Component.registerHelper("getSubject",(function(t,e){switch(t){case"Tasks":case"Calls":return e.Subject;case"Events":return e.Event_Title;case"Appointments":return e.Appointment_Name;default:return""}})),Lyte.Component.registerHelper("getPersonalityByRelation",(function(t){switch(t){case"Tasks":case"Calls":case"Events":return t.toUpperCase()+"PERSONALITY";case"Tasks_History":case"Events_History":case"Calls_History":return t.replace("_","").toUpperCase()+"PERSONALITY";case"Open_Appointments__s":return"APPOINTMENTSPERSONALITY";case"Appointments_History__s":return"APPOINTMENTSHISTORYPERSONALITY"}})),Lyte.Component.registerHelper("getModuleByRelation",(function(t){switch(t){case"Tasks":case"Tasks_History":return"Tasks";case"Calls":case"Calls_History":return"Calls";case"Events":case"Events_History":return"Events";case"Open_Appointments__s":case"Appointments_History__s":return"Appointments"}})),Lyte.Component.registerHelper("getSortColumn",(function(t){switch(t){case"Tasks":return"Due_Date";case"Tasks_History":return"Closed_Time";case"Calls":case"Calls_History":return"Call_Start_Time";case"Events":case"Events_History":return"Start_DateTime";case"Open_Appointments__s":case"Appointments_History__s":return"Appointment_Start_Time"}})),Lyte.Component.registerHelper("getPRClass",(function(t,e,a,i){return t?i&&a===i.length-1?"":"pR30":"pL10 pR10"})),Lyte.Component.registerHelper("getI18",(function(t){return"undefined"!=typeof I18n?I18n.getMsg(t):"undefined"!=typeof parent&&"undefined"!==parent.I18n?parent.I18n.getMsg(t):t})),Lyte.Component.registerHelper("getModuleNameForIconForAct",(function(t){return(t="Deals"===t?"Potentials":t)&&t.indexOf("_")>0&&(t=(t=t.split("_"))[0]+t[1]),t&&["Leads","Products","Accounts","Potentials","Contacts","Vendors","PriceBooks","Cases","Solutions","SalesOrders","Invoices","Quotes","PurchaseOrders","WeekEvent","Bundles"].contains(t)?t.slice(0,t.lastIndexOf("s")):"svgIcons CustomModule"})),Lyte.Component.registerHelper("constructFieldsForRel",(function(t,e){var a=[],i=[],o=t.getData("excludeFields"),s=t.getData("internalFields");e.forEach((function(t){if(a.push(t.api_name),s.size>0&&s.contains(t.api_name)&&s.splice(s.indexOf(t.api_name),1),!o.contains(t.api_name)){var e=CrmField.getDataType(parseInt(t.ui_type));t.data_type=e,i[t.api_name]=t}}));var n=t.getData("fieldsforrel")?t.getData("fieldsforrel"):{};n[Lyte.Component.registeredHelpers.getPersonalityByRelation(t.getData("relation_name"))]=i,t.setData("fields",t.getData("internalFields").concat(a)),t.setData("fieldsforrel",n)})),Lyte.Component.registerHelper("constructCustomizePopup",(function(t,e,a){var i=$L("crm-activity-rel-customize"),o=0===i.length?i:"openActivities"===i[0].component.data.btn_name?i[0]:i[1],s=0===i.length?i:"closedActivities"===i[0].component.data.btn_name?i[0]:i[1],n=["Tasks","Events","Calls","Appointments"],l=["Tasks_History","Events_History","Calls_History","Appointments_History"];t.parentid&&0!==i.length&&(t.btn_name="openActivities",o&&0!==o.getData().data&&o.getData().data&&o.getData().data.forEach((function(t){n.contains(t.module)&&!a[t.module]&&(a[t.module]=t)})),a.Tasks&&t.data.push(a.Tasks),a.Events&&t.data.push(a.Events),a.Calls&&t.data.push(a.Calls),a.Appointments&&t.data.push(a.Appointments),o.setData("data",t.data)),e.parentid&&i.length&&(e.btn_name="closedActivities",s&&0!==s.getData().data&&s.getData().data&&s.getData().data.forEach((function(t){l.contains(t.module+"_History")&&!a[t.module+"_History"]&&(a[t.module+"_History"]=t)})),a.Tasks_History&&e.data.push(a.Tasks_History),a.Events_History&&e.data.push(a.Events_History),a.Calls_History&&e.data.push(a.Calls_History),a.Appointments_History&&e.data.push(a.Appointments_History),s.setData("data",e.data))})),Lyte.Component.registerHelper("isActivitySplitComponent",(function(t){return!Lyte.registeredMixins["crm-related-list-utils"].isNotActivitySubPersonality(t,"Services"===Lyte.Router.getRouteInstance().parent.parent.getDynamicParam()||void 0)})),Lyte.Component.registerHelper("arrayJoin",(function(t,e){return t?t.join(e):void 0})),Lyte.Component.registerHelper("getModuleNameByApiNameAsp",(function(t){return Object.keys(moduleApiMapping).filter((e=>moduleApiMapping[e]===t))})),Lyte.Component.registerHelper("getPersonalityForChronological",(function(t,e){var a="Activities"===t?e:e+"_History";switch(a){case"Tasks":case"Calls":case"Events":return a.toUpperCase()+"PERSONALITY";case"Tasks_History":case"Events_History":case"Calls_History":return a.replace("_","").toUpperCase()+"PERSONALITY";case"Appointments":return"APPOINTMENTSPERSONALITY";case"Appointments_History":return"APPOINTMENTSHISTORYPERSONALITY"}})),Lyte.Component.registerHelper("isChronologicalEnabled",(function(){return Crm.userDetails.isChronologicalviewEnabled})),Lyte.Component.registerHelper("getIdPropForTabView",(function(t,e){var a=t;return"Events"===t&&(a="Meetings"),e?e+"_"+a:a})),Lyte.Component.registerHelper("getClassForFields",(function(t,e){var a="";return"Description"===t&&"asp"===e?a="dF flexDC":"Description"!==t&&"mL"===e&&(a="mL5"),a})),Lyte.Component.registerHelper("getChronologicalActivityActionLink",(function(t,e,a,i,o){e=e||this;var s=store.peekAll("related_list").filterBy({personality_name:o})[0].id;switch(t){case"closeTask":return Crm.getCrmBasePath()+"/closeTask.do?action=CloseTask&taskid="+a+"&module="+e.getData("rel_module")+"&id="+e.getData("entity_id")+"&nextStep=relatedlist&isajax=true#"+o+"_"+s;case"deleteLink":return Crm.getCrmBasePath()+"/MassDelete.do?module="+i.$module+"&id="+a+"&actModule="+e.getData("rel_module")+"&actId="+e.getData("entity_id")+"&nextStep=relatedlist&isajax=true#"+o+"_"+s;default:return""}})),Lyte.Component.registerHelper("getTabViewRelCount",(function(t,e){return"Appointments"===t&&(t="Appointments__s"),e[t]})),Lyte.Component.registerHelper("isNewCountFlow",(function(t,e){return t&&e})),Lyte.Component.registerHelper("getActIconName",(function(t){var e;switch(t){case"Meetings":e="events";break;case"Tasks":e="tasks";break;case"Calls":e="calls";break;case"Appointments":e="appointments"}return e})),Lyte.Component.registerHelper("getValueRemoveSubject",(function(t,e){if(t){let a=I18n.getMsg("crm.activities.call.defaultsubject.outgoingcall",""),i=t.replaceAll(a,"");return i.length===t.length&&(a=I18n.getMsg("crm.activities.call.defaultsubject.incomingattended",""),i=t.replaceAll(a,"")),e?a:i}return""})),Lyte.Component.registerHelper("getApparovedState",(function(t,e){return this.getData("canvas")&&!e.includes("APPOINTMENTS")?"approved"===t.$approval_state||"approval_process_rejected"===t.$approval_state:!!e.includes("APPOINTMENTS")||(!(!t.$approved&&"approved"!==t.$approval_state)||"approval_process_rejected"===t.$approval_state)})),Lyte.Component.registerHelper("getModName",(function(t){return moduleRecordMapping[t].plural_label})),Lyte.Component.registerHelper("getParsedDate",(function(t,e){const a={Jan:"january",Feb:"february",Mar:"march",Apr:"april",May:"may",Jun:"june",Jul:"july",Aug:"august",Sep:"september",Oct:"october",Nov:"november",Dec:"december"},i={month:"short",day:"numeric"},o=this.component.getDateBasedOnOffset(Date.now(),Crm.userDetails.tzOffset);let s=o.toLocaleDateString("en-US",i),n=$L.moment(o).toDate();n.setDate(o.getDate()+1),n=n.toLocaleDateString("en-US",i);let l=t;if("Overdue"!==t){l=l.split(" "),l=I18n.getMsg("crm.best.time.month.short."+a[l[0]])+" "+l[1]}return t===s?I18n.getMsg("Today")+", "+l:t===n?I18n.getMsg("Tomorrow")+", "+l:"Overdue"!==t?e?l:I18n.getMsg(Lyte.Component.registeredHelpers.getDayOfWeek.bind(this)(t))+", "+l:I18n.getMsg(l)})),Lyte.Component.registerHelper("getDayOfWeek",(function(t){const[e,a]=t.split(" "),i={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[e],o=this.component.getDateBasedOnOffset(Date.now(),Crm.userDetails.tzOffset),s=o.getFullYear(),n=o.getMonth();let l=s;11===i&&0===n&&(l=s-1);const r=$L.moment().toDate();r.setFullYear(l,i,a);return r.toLocaleDateString("en-US",{weekday:"long"})})),Lyte.Component.registerHelper("getDuration",(function(t){let e=t.Start_DateTime,a=t.End_DateTime;var i=($L.moment(a).toDate()-$L.moment(e).toDate())/1e3,o=Math.floor(i/3600),s=Math.floor(i%3600/60);let n="";return n=0===s&&1===o?I18n.getMsg("gs.duration")+" "+o+I18n.getMsg("gs.noty.hour"):0===s&&o>1?I18n.getMsg("gs.duration")+" "+o+I18n.getMsg("gs.noty.hours"):I18n.getMsg("gs.duration")+" "+o+":"+s+I18n.getMsg("gs.noty.hours"),n})),Lyte.Component.registerHelper("getParsedTime",(function(t,e){var a=Lyte.Component.registeredHelpers.getParsedDate.bind(this),i=Lyte.Component.registeredHelpers.convertTo24Hour.bind(this);return"Overdue"===t.header?"Tasks"===e?a(t.day,!0):t.day===t.pattern?a(t.day,!0)+I18n.getMsg(", ")+I18n.getMsg("All Day"):a(t.day,!0)+", "+i(t.pattern,Crm.userDetails.TIME_FORMAT):t.pattern.includes("AM")||t.pattern.includes("PM")?i(t.pattern,Crm.userDetails.TIME_FORMAT):a(t.pattern,!0)})),Lyte.Component.registerHelper("convertTo24Hour",(function(t,e){if("HH:mm"===e){let[e,a]=t.split(" "),[i,o]=e.split(":");i=parseInt(i,10),"PM"===a&&12!==i&&(i+=12),"AM"===a&&12===i&&(i=0),i=i.toString().padStart(2,"0"),o=o.padStart(2,"0"),t=`${i}:${o}`}else t.includes("AM")?t=t.replace("AM",I18n.getMsg("AM")):t.includes("PM")&&(t=t.replace("PM",I18n.getMsg("PM")));return t})),Lyte.Component.registerHelper("objContains",(function(t,e){return e.every((e=>t.hasOwnProperty(e)))})),Lyte.Component.registerHelper("getFormatedValue",(function(t,e,a,i){"Appointments"===a&&"Duration"===e&&(i.Duration=Lyte.Transform["time-in-hrs"].deserialize(i.Duration));let o=i.date;delete i.date;var s=Lyte.Component.registeredHelpers.getFormattedValue(t,e,a,i,!0,null,!0,t);return i.date=o,s||""})),Lyte.Component.registerHelper("getModuleForIcon",(function(t){var e=t.$se_module?t.$se_module:t.Appointment_For.module.api_name;if(!moduleRecordMapping[e]){let t="custommodule";if(this.component.data.customModuleMap[e])e=this.component.data.customModuleMap[e];else{let t=e;i=moduleApiMapping,o=e,e=Object.keys(i).find((t=>i[t]===o));var a=this.component.data.customModuleMap;a[t]=e,this.setData("customModuleMap",a)}e=e.toLowerCase().includes(t)?t:e}var i,o;return(e=(e="Deals"===e?"Potentials":e).replaceAll("_","")).toLowerCase()})),Lyte.Component.registerHelper("getElementBasedOnValue",(function(t,e,a,i,o,s,n,l){var r=Lyte.Component.registeredHelpers.encodeForHTMLAttribute(Lyte.Component.registeredHelpers.getSubject(a,i)+"_"+t.field_label+"_value"),p=Lyte.Component.registeredHelpers.getFormatedValue(t,e,a,i,o,s,n,l);if(p){const t=/data-zcqa='(.*?)'/;return p.replace(t,`data-zcqa='${r}'`)}return p})),Lyte.Component.registerHelper("isMoreContentAvailable",(function(t,e){let a=!1;if(t.$has_more){a=t.$has_more[e]}return a})),Lyte.Component.register("crm-skype-field",{_template:'<template tag-name="crm-skype-field"> <template is="if" value="{{cxPropView}}"><template case="true"> <template is="if" value="{{crmSkypeValue}}"><template case="true"> <span id="skypeLink" class="cP" onclick="{{action(&quot;skypeCall&quot;,crmSkypeValue)}}">{{crmSkypeValue}}<span class="skype dIB mL5 top2 pR "></span></span> </template><template case="false"> {{cxPropEmptyValue}} </template></template> </template><template case="false"> <div class="lyteField ltIconShow" cx-prop-appearance="box"> <lyte-input id="skypeInput" lt-prop-value="{{lbind(crmSkypeValue)}}" lt-prop-class="cxBorderBottom" class="w100_per cxBoxInput lyteInputBox vertical mandatoryField"> </lyte-input> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}],_observedAttributes:["crmSkypeValue","cxPropEmptyValue","cxPropField","cxPropView","cxPropValue"],data:function(){return{crmSkypeValue:Lyte.attr("string"),cxPropEmptyValue:Lyte.attr("string",{default:"-"}),cxPropField:Lyte.attr("object",{hideAttr:!0}),cxPropView:Lyte.attr("boolean",{default:!0}),cxPropValue:Lyte.attr("string")}},actions:{skypeCall:function(t){document.getElementById("skypeLink").setAttribute("href","skype:"+t+"?call")}},getValue:function(){return this.getData("crmSkypeValue")},validate:function(){var t=this.getData("crmSkypeValue"),e=this.getData("cxPropField");return t.length<=e.length}}),Lyte.Component.register("crm-email-field",{_template:'<template tag-name="crm-email-field"> <template is="if" value="{{emailOptOut}}"><template case="true"> <template is="if" value="{{listenerNeeded}}"><template case="true"> <lyte-event-listener event-name="tooltipInfo" on-fire="{{action(\'updateTooltip\')}}"> </lyte-event-listener></template></template> <crux-boolean-component iserror="{{isError}}" cx-prop-error-message="{{cxPropErrorMessage}}" cx-prop-masking-properties="{{cxPropMaskingProperties}}" cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}" cx-prop-empty-value="-"></crux-boolean-component> <template is="if" value="{{expHandlers(expHandlers(isToolTipNeeded,\'&amp;&amp;\',record.Email_Opt_Out),\'&amp;&amp;\',expHandlers(record.Unsubscribed_Mode,\'!=\',undefined))}}"><template case="true"> <span id="zc_ajax_info_icon_{{cxPropField.id}}" lt-prop-title="{{tooltipData}}" lt-prop-tooltip-class="alignLeft" lt-prop-tooltip-config="{&quot;position&quot;:&quot;top&quot;}" class="icon_roundinfo mL5 cP vaM"></span> </template></template> </template><template case="false"> <template is="if" value="{{listenerNeeded}}"><template case="true"> <lyte-event-listener event-name="emailFieldTooltipInfo" on-fire="{{action(\'updateEmailFieldTooltip\')}}"> <lyte-event-listener event-name="hideEmailFieldTooltipInfo" on-fire="{{action(\'handleHideEmailFieldTooltipInfo\')}}"> </lyte-event-listener></lyte-event-listener></template></template> <crux-email-component iserror="{{isError}}" cx-prop-error-message="{{cxPropErrorMessage}}" cx-prop-masking-properties="{{cxPropMaskingProperties}}" cx-prop-field="{{cxPropField}}" class="canvasCruxComponentEdit dIB" cx-prop-empty-value="-" cx-prop-value="{{cxPropValue}}"></crux-email-component> <template is="if" value="{{isEmailFieldTooltipData}}"><template case="true"> <div class="svgIconsImg svgErrorIcon mL3 dIB" lt-prop-title="{{emailFieldTooltipData}}" lt-prop-tooltip-class="alignLeft"></div> </template><template case="false"><template is="if" value="{{isEmailFieldBounced(isEmailFieldBounced,cxPropField)}}"><template case="true"> <span data-zcqa="ebm_block_icon_{{cxPropField.api_name}}" lyte-hovercard="true" onmouseenter="{{action(\'onhoverBounceIcon\',event,this)}}" onmouseleave="{{action(\'onhoverOutBounceIcon\',this)}}" id="bounceicon" class="zcicncss-alert-filled zcicn-cssIcons zcicn_sandal_mask cP emailUnblocking {{cxPropField.api_name}} mL3 vaM tdUnderline"></span> </template><template case="false"> <span data-zcqa="ebm_block_icon_{{cxPropField.api_name}}" lyte-hovercard="true" onmouseenter="{{action(\'onhoverBounceIcon\',event,this)}}" onmouseleave="{{action(\'onhoverOutBounceIcon\',this)}}" id="bounceicon" class="zcicncss-alert-filled zcicn-cssIcons zcicn_sandal_mask cP emailUnblocking hide {{cxPropField.api_name}} mL3 vaM tdUnderline"></span> </template></template></template></template> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}],_observedAttributes:["cxPropField","cxPropValue","emailOptValue","emailOptOut","moduleName","record","tooltipData","isEmailFieldTooltipData","cxPropMaskingProperties","isError","isToolTipNeeded","listenerNeeded","cxPropErrorMessage","emailBounceToolTipData","isEmailFieldBounced"],data:function(){return{cxPropField:Lyte.attr("object",{hideAttr:!0}),cxPropValue:Lyte.attr("string"),emailOptValue:Lyte.attr("boolean"),emailOptOut:Lyte.attr("boolean"),moduleName:Lyte.attr("string"),record:Lyte.attr("object"),tooltipData:Lyte.attr("string",{default:""}),isEmailFieldTooltipData:Lyte.attr("boolean",{default:!1}),cxPropMaskingProperties:Lyte.attr("object"),isError:Lyte.attr("boolean"),isToolTipNeeded:Lyte.attr("boolean",{default:!0}),listenerNeeded:Lyte.attr("boolean",{default:!0}),cxPropErrorMessage:Lyte.attr("string"),emailBounceToolTipData:Lyte.attr("object"),isEmailFieldBounced:Lyte.attr("boolean",{default:!1})}},init:function(){var t;if(null!=this.getData("cxPropValue")&&"true"!==this.getData("cxPropValue")&&Lyte.Router.getRouteInstance().currentModel&&Lyte.Router.getRouteInstance().currentModel.emailFieldTooltipData&&(Lyte.Router.getRouteInstance().currentModel.emailFieldTooltipData.data&&Lyte.Router.getRouteInstance().currentModel.emailFieldTooltipData.data[0]&&Lyte.Router.getRouteInstance().currentModel.emailFieldTooltipData.data[0].features_info[0]&&(t=Lyte.Router.getRouteInstance().currentModel.emailFieldTooltipData.data[0].features_info[0].details)))for(var e=t.length,a=0;a<e;a++)if(t[a].email===this.getData("cxPropValue")){var i=new Date(t[a].unsubscribed_time).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}),o=I18n.getMsg("crm.unsubscription.reason.tooltip")+"\n"+I18n.getMsg("crm.unsubscribed.mode")+": "+t[a].unsubscribed_mode+"\n"+I18n.getMsg("crm.unsubscribed.time")+": "+i;this.setData("isEmailFieldTooltipData",!0),this.setData("emailFieldTooltipData",o)}if(void 0!==this.getData("cxPropValue")&&"true"!==this.getData("cxPropValue")&&Lyte.Router.getRouteInstance().currentModel&&Lyte.Router.getRouteInstance().currentModel.emailFieldBounceTooltipData&&(Lyte.Router.getRouteInstance().currentModel.emailFieldBounceTooltipData.data&&Lyte.Router.getRouteInstance().currentModel.emailFieldBounceTooltipData.data[0]&&Lyte.Router.getRouteInstance().currentModel.emailFieldBounceTooltipData.data[0].features_info[0]&&(t=Lyte.Router.getRouteInstance().currentModel.emailFieldBounceTooltipData.data[0].features_info[0].details))){e=t.length;this.setData("isEmailFieldBounced",!1);for(a=0;a<e;a++)t[a].field.api_name===this.getData("cxPropField.api_name")&&(this.setData("isEmailFieldBounced",!0),this.setData("emailBounceToolTipData",t[a]))}var s=this.getData("cxPropField");if(void 0!==this.getData("moduleName")&&"boolean"===s.data_type&&this.getData("record")){var n=this.getData("record"),l=I18n.getMsg("crm.unsubscribed.mode")+": "+n.Unsubscribed_Mode+"\n"+I18n.getMsg("crm.unsubscribed.time")+": "+n.Unsubscribed_Time;this.setData("tooltipData",l)}"listview"!==Lyte.Router.getRouteInstance().routeName&&"custom-view"!==Lyte.Router.getRouteInstance().parent.routeName&&"ListView"!==Lyte.Router.getRouteInstance().getQueryParams().feature||(this.setData("isToolTipNeeded",!1),this.setData("listenerNeeded",!1))},actions:{updateTooltip:function(t){if(t&&t.affectedData){var e=new Date(t.affectedData.Unsubscribed_Time).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}),a=I18n.getMsg("crm.unsubscribed.mode")+": "+t.affectedData.Unsubscribed_Mode+"\n"+I18n.getMsg("crm.unsubscribed.time")+": "+e;this.setData("tooltipData",a)}},updateEmailFieldTooltip:function(t){if(this.$node===$("crm-email-field.fieldupdate_"+t.column_name)[0]){var e=this;if(void 0!==e.getData("cxPropValue")&&"true"!==e.getData("cxPropValue")){var a={"Content-Type":"application/json"},i=store.peekRecord("module",moduleRecordMapping[e.getData("moduleName")].id).api_name;(t=networkUtils.lyteInitiateRequest("/crm/v2.2/"+i+"/"+e.getData("record").id+"/actions/get_feature_specific_info","GET",{params:{features:"unsubscribed_emails"},headers:a})).then((function(t){e.setData("isEmailFieldTooltipData",!1);let a=!0;if(t&&t.data[0].features_info[0].details)for(var i=t.data[0].features_info[0].details,o=i.length,s=0;s<o;s++)if(i[s].email===e.getData("cxPropValue")){var n=new Date(i[s].unsubscribed_time).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}),l=I18n.getMsg("crm.unsubscription.reason.tooltip")+"\n"+I18n.getMsg("crm.unsubscribed.mode")+": "+i[s].unsubscribed_mode+"\n"+I18n.getMsg("crm.unsubscribed.time")+": "+n;e.setData("isEmailFieldTooltipData",!0),e.setData("emailFieldTooltipData",l),e.methods.updateOtherEmailFields(e,null,!0,l,!0),a=!1;break}a&&e.methods.updateOtherEmailFields(e,null,!1,null,!0)})),(t=networkUtils.lyteInitiateRequest("/crm/v6/"+i+"/"+e.getData("record").id+"/actions/get_feature_specific_info","GET",{params:{features:"blocked_emails"},headers:a})).then((function(t){e.setData("isEmailFieldBounced",!1);let a=!0;if(t&&t.data[0].features_info[0].details){var i=t.data[0].features_info[0].details,o=i.length;e.setData("isEmailFieldBounced",!1);for(var s=0;s<o;s++)if(i[s].field.api_name===e.getData("cxPropField.api_name")){e.setData("isEmailFieldBounced",!0),e.setData("emailBounceToolTipData",i[s]),e.methods.updateOtherEmailFields(e,!0),a=!1;break}}a&&e.methods.updateOtherEmailFields(e,!1)}))}}},handleHideEmailFieldTooltipInfo:function(){void 0!==this.getData("cxPropValue")&&"true"!==this.getData("cxPropValue")&&this.setData("isEmailFieldTooltipData",!1)},onhoverBounceIcon:function(t,e){EmailUnblocking.unblockEmailHelper(t,e,"canvas_detail",this.getData("record").id,this.getData("cxPropField.api_name"),this.getData("moduleName"),$L(e).closest(".zcanvas-data-node").attr("data-zcanvasid"))},onhoverOutBounceIcon:function(t){EmailUnblocking.emailUnblockingMouseOut(t)}},methods:{updateOtherEmailFields:function(t,e,a,i,o){let s=$L(".fieldupdate_"+t.getData("cxPropField.column_name")),n=s.length;for(let t=0;t<n;t++)o?Lyte.objectUtils(s[t].component.data,"add",{isEmailFieldTooltipData:a,emailFieldTooltipData:i}):Lyte.objectUtils(s[t].component.data,"add","isEmailFieldBounced",e)}}}),Lyte.Component.registerHelper("isEmailFieldBounced",(function(t,e){let a="Email"===e.api_name;return t||!$L("id").val()&&EmailUnblocking.checkIsBlockedSelcted(a)})),Lyte.Component.register("crm-activity-chronological-view",{_template:'<template tag-name="crm-activity-chronological-view" id="chronoview_{{parent_relation_name}}_split"> <lyte-event-listener event-name="relatedList" on-fire="{{action(\'handleRefresh\')}}"> <template is="if" value="{{expHandlers(isPermissionDenied,\'===\',true)}}"><template case="true"> <div class="p30 aligncenter">{{unescape(getI18n(\'crm.canvas.component.permission.denied\'))}}</div> </template><template case="false"><template is="if" value="{{showLoading}}"><template case="true"> <div class="noDataFountDetailtxt p10 pT30 pB30 mL10 mR10 crm-font-regular crmNotFoundColor crm-small-font-size">{{getI18n(\'crm.admin.loading\')}}</div> </template><template case="false"><template is="if" value="{{isDataEmpty}}"><template case="true"> <div class="actColumnValues norec w100_per pR30 crm-font-regular boxBB noDataFountDetailtxt"> <ul class="actColumnList m0 p0"> <li class="p0 m0"> <div class="crm-font-regular crmNotFoundColor crm-small-font-size">{{getI18n(\'crm.new.label.no.records\')}}</div> </li> </ul> </div> </template><template case="false"> <lyte-table lt-prop-yield="true" class="chronological_activities_table noBorderTable"> <template is="registerYield" yield-name="yield"> <lyte-table-structure> <lyte-thead> <lyte-tr> <lyte-th class="pL15 pR15 crm-font-semibold crmHeadingColor w55_per">{{getI18n(\'crm.related.view.chronological.info\')}} <span class="numCountn mL5 dIB">{{relatedListCount}}</span></lyte-th> <lyte-th class="pL15 pR15 crm-font-semibold crmHeadingColor minW200">{{getI18n(\'crm.related.view.chronological.owner\')}}</lyte-th> <lyte-th class="pL15 pR15 crm-font-semibold crmHeadingColor w200 minW200">{{getI18n(\'crm.label.dateandtime\')}}</lyte-th> </lyte-tr> </lyte-thead> <lyte-tbody> <template is="for" items="{{record_data}}" item="data" index="index"> <template is="if" value="{{expHandlers(data.$module,\'===\',\'Tasks\')}}"><template case="true"> <lyte-tr> <lyte-td class="pR30 vaT choroViewTd"> <template is="if" value="{{expHandlers(data.$process_flow,\'!\')}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(activity_type,\'===\',\'open\'),\'&amp;&amp;\',expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(data.$approval_state,\'===\',\'approval_process_pending\'),\'||\',expHandlers(data.$approval_state,\'===\',\'merge_pending\')),\'||\',expHandlers(data.$approval_state,\'===\',\'review_process_pending\')),\'||\',expHandlers(data.$approval_state,\'===\',\'review_process_rejected\')),\'!\'))}}"><template case="true"> <span class="cP markAsCompletedIcon pA dN" data-zcqa="lnk_close_Tasks" lt-prop-tooltip-config="{&quot;position&quot; : &quot;left&quot;}" lt-prop-title="{{getI18n(\'crm.label.mark.completed\')}}" deleteaction="javascript:Lyte.registeredMixins[\'crm-related-list-utils\'].sortRelatedList(\'{{getChronologicalActivityActionLink(\'closeTask\',null,data.id,data,getPersonalityForChronological(parent_relation_name,data.$module))}}\',null,\'{{data.id}}\')" onclick="{{action(\'clickAction\',\'closeTask\',null,data,getPersonalityForChronological(parent_relation_name,data.$module))}}"> <crmutil-icon icon-name="tick-rounded" class="eventNone" icon-class="zcicn-tick-rounded tick_zcicn20 zcicn_7c8bae markAsUtilICo"></crmutil-icon> </span> </template></template></template></template> <template is="if" value="{{expHandlers(expHandlers(data.Locked__s,\'!\'),\'&amp;&amp;\',expHandlers(data.$locked_for_me,\'!\'))}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(data.$approved,\'||\',expHandlers(data.$approved,\'==\',null)),\'||\',expHandlers(expHandlers(data.$approved,\'!\'),\'&amp;&amp;\',expHandlers(data.$approval_state,\'===\',\'approval_process_rejected\')))}}"><template case="true"> <span id="act_split_origin_{{data.id}}" class="icoThreeDots dN cP pA" data-zcqa="relatedListMore_{{getSubject(data.$module,data)}}_{{data.$module}}" onclick="{{action(\'showMoreOptions\',data,this,getPersonalityForChronological(parent_relation_name,data.$module))}}"> <crmutil-icon class="zcicn-more-brrounded" icon-name="more-hr-md" icon-class="zcicn-more-hr-md zcicn_636f86"></crmutil-icon> </span> </template></template></template></template> <span class="vaT dIB "> <crmutil-icon icon-name="tasks" icon-class="zcicn-tasks crmBaseIcon"></crmutil-icon> </span> <template is="if" value="{{expHandlers(data.$approval_state,\'===\',\'approval_process_pending\')}}"><template case="true"> <span class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspChLockIcon" title="{{getI18(&quot;crm.approvalProcess.label.waitingForApproval&quot;)}}" alt="{{getI18(&quot;crm.approvalProcess.label.waitingForApproval&quot;)}}"></span> </template><template case="false"><template is="if" value="{{expHandlers(data.$approval_state,\'===\',\'merge_pending\')}}"><template case="true"> <span class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspChLockIcon" title="{{getI18(&quot;crm.approvalProcess.label.waitingForFindAndMerge&quot;)}}" alt="{{getI18(&quot;crm.approvalProcess.label.waitingForFindAndMerge&quot;)}}"></span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(data.$approval_state,\'===\',\'review_process_pending\'),\'||\',expHandlers(data.$approval_state,\'===\',\'review_process_rejected\'))}}"><template case="true"> <span class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspChLockIcon" title="{{getI18(&quot;crm.reviewprocess.record.review.pending&quot;)}}" alt="{{getI18(&quot;crm.reviewprocess.record.review.pending&quot;)}}"></span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(data.Locked__s,\'&amp;&amp;\',data.$locked_for_me),\'&amp;&amp;\',expHandlers(data.$editable,\'!\'))}}"><template case="true"> <span data-zcqa="lockedforMeAct_{{data.id}}" class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspLockIcon" title="{{getI18(&quot;crm.record.lock.record.locked&quot;)}}" alt="{{getI18(&quot;crm.record.lock.record.locked&quot;)}}"></span> </template></template></template></template></template></template></template></template> <div class="dIB activity_info_details mL10"> <div class="mB3" data-zcq="relatedlist_{{getPersonalityForChronological(parent_relation_name,data.$module)}}_{{getSubject(data.$module,data)}}"> <template is="if" value="{{expHandlers(isprintview,\'!\')}}"><template case="true"> <link-to lt-prop-class="link dIB choronoSubLink" data-zcqa="relatedList_{{getSubject(data.$module,data)}}_Activities" lt-prop-route="crm.tab.module.entity.detail" lt-prop-dp="[&quot;{{data.$module}}&quot;,&quot;{{data.id}}&quot;]" lt-prop-td="{&quot;fromActivityListView&quot;:&quot;true&quot;,&quot;pfrom&quot;:&quot;rel&quot;,&quot;module&quot;:&quot;{{data.$module}}&quot;,&quot;id&quot;:&quot;{{data.id}}&quot;,&quot;pn&quot;:&quot;{{getPersonalityForChronological(parent_relation_name,data.$module)}}&quot;,&quot;peId&quot;:&quot;{{entity_id}}&quot;,&quot;bMod&quot;:&quot;{{rel_module}}&quot;,&quot;fromActSubModuleListView&quot;:&quot;true&quot;,&quot;lookback&quot;:&quot;true&quot;}"> <template is="if" value="{{data.$colour_code}}"><template case="true"> <div class="pR"> <span class="dIB eventColor_rL_split" data-zcqa="colorspan_{{getSubject(data.$module,data)}}" style="background: {{data.$colour_code}}"></span> </div> </template></template> {{getSubject(data.$module,data)}} </link-to> <template is="if" value="{{data.$in_project_sync}}"><template case="true"> <i class="task_syncIcon vaM mL5 mB2 pA" lt-prop-title="{{concat(getI18n(&quot;crm.schedules.prefix.in&quot;),getI18n(&quot;crm.integ.sync.message&quot;,&quot;crm.project.integration.title&quot;))}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;followcursor&quot;, &quot;appearance&quot; : &quot;box&quot;}"></i> </template></template><template is="if" value="{{data.Recurring_Activity}}"><template case="true"> <crmutil-icon class="mT1" icon-name="repeat" icon-class="zcicn-repeat crmBaseIcon mL5"></crmutil-icon> </template></template><template is="if" value="{{expHandlers(expHandlers(data.$approved,\'||\',expHandlers(data.$approved,\'==\',null)),\'||\',expHandlers(expHandlers(data.$approved,\'!\'),\'&amp;&amp;\',expHandlers(data.$approval_state,\'===\',\'approval_process_rejected\')))}}"><template case="true"> </template></template></template><template case="false"> <template is="if" value="{{data.$colour_code}}"><template case="true"> <div class="pR"> <span class="dIB eventColor_rL_split" data-zcqa="colorspan_{{getSubject(data.$module,data)}}" style="background: {{data.$colour_code}}"></span> </div> </template></template> <span class="crmLinkColor cP">{{getSubject(data.$module,data)}}</span> </template></template><template is="if" value="{{data.$in_project_sync}}"><template case="true"> <i class="task_syncIcon vaM mL5 mB2 pA" lt-prop-title="{{concat(getI18n(&quot;crm.schedules.prefix.in&quot;),getI18n(&quot;crm.integ.sync.message&quot;,&quot;crm.project.integration.title&quot;))}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;followcursor&quot;, &quot;appearance&quot; : &quot;box&quot;}"></i> </template></template> </div> <template is="for" items="{{task_fields}}" item="field" index="index"> <template is="if" value="{{expHandlers(expHandlers(contains(excludeFields,field.api_name),\'!\'),\'&amp;&amp;\',validateField(data[field.api_name]))}}"><template case="true"> <span class="openActiveinfoList {{if(ifEquals(field.api_name,\'Description\'),\'dF flexDC\',\'dIF aiFlexStart fwWrap\')}}" id="{{data.id}}" data-zcq="relatedlist_{{getPersonalityForChronological(parent_relation_name,data.$module)}}_{{getSubject(data.$module,data)}}__{{field.api_name}}"> <template is="if" value="{{expHandlers(field.api_name,\'===\',&quot;Description&quot;)}}"><template case="true"> <span class="crmLabelColor dIB aspChronoLabel"> {{field.field_label}} :</span> </template><template case="false"> <span class="crmLabelColor dIB aspChronoLabel"> {{field.field_label}}</span> <span class="mL3">:</span> </template></template> <span class="crmBaseColor dIB aspChronoValue {{getClassForFields(field.api_name,\'mL\')}}"> <template is="if" value="{{expHandlers(expHandlers(field.data_type,\'===\',\'lookup\'),\'||\',expHandlers(field.data_type,\'===\',\'multi_module_lookup\'))}}"><template case="true"> <template is="if" value="{{expHandlers(field.api_name,\'===\',\'What_Id\')}}"><template case="true"> <crux-lookup-component cx-prop-value="{{data[field.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{if(ifEquals(data.$se_module,&quot;Deals&quot;),&quot;Potentials&quot;,getModuleNameByApiNameAsp(data.$se_module))}}&quot;, &quot;{{data[field.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(data.$se_module),\'Small\')}} actSplitLookup" onmouseover="{{action(\'showHideRelatedFields\',data[field.api_name],field.api_name,data.$se_module,event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-zcqa="{{data[field.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(field.api_name,\'===\',\'Who_Id\')}}"><template case="true"> <crux-lookup-component cx-prop-value="{{data[field.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;Contacts&quot;, &quot;{{data[field.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" onmouseover="{{action(\'showHideRelatedFields\',data[field.api_name],field.api_name,\'Contacts\',event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(\'Contacts\'),\'Small\')}} actSplitLookup" cx-prop-zcqa="{{data[field.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(field.api_name,\'===\',\'Service_Name\')}}"><template case="true"> <crux-lookup-component cx-prop-value="{{data[field.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;Services&quot;, &quot;{{data[field.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" onmouseover="{{action(\'showHideRelatedFields\',data[field.api_name],field.api_name,data.$se_module,event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(\'Services\'),\'Small\')}} actSplitLookup" cx-prop-zcqa="{{data[field.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(field.api_name,\'==\',&quot;Appointments_Booking_Form_Name__s&quot;)}}"><template case="true"> <crux-lookup-component cx-prop-zcqa="{{data[field.api_name].name}}" cx-prop-value="{{data[field.api_name].name}}" cx-prop-module="CalendarBookings" cx-prop-route-name="crm.settings.section.calendar-booking.view-calendar-booking" cx-prop-query-params="{&quot;module&quot; : &quot;Appointments__s&quot;, &quot;type&quot;: &quot;team&quot;}" cx-prop-dynamic-params="[&quot;{{data[field.api_name].id}}&quot;]"> </crux-lookup-component> </template></template></template></template></template></template></template></template></template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'===\',\'textarea\')}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(isprintview,\'!\'),\'&amp;&amp;\',expHandlers(data[field.api_name].length,\'>\',txt_ln))}}"><template case="true"> <span class="wwBreakWord" id="Activities_{{field.api_name}}_{{data.id}}_old">{{formattedText(data[field.api_name],txt_ln)}}</span> <span class="crmLinkColor cP crm-base-font-size dIB" data-zcqa="Activities_{{field.api_name}}_{{data.id}}_readMore" onclick="{{action(\'readMoreDesc\',this,data)}}" id="Activities_{{field.api_name}}_{{data.id}}" value="{{data[field.api_name]}}"> {{getI18n("crm.readmore")}} </span> </template><template case="false"> <span class="wwBreakWord" id="Activities_{{field.api_name}}_{{data.id}}_old">{{data[field.api_name]}}</span> </template></template> </template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'===\',\'datetime\')}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(data[field.api_name],false,dateformat)}} </template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'===\',\'date\')}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(data[field.api_name],true,dateformat)}} </template><template case="false"> {{unescape(getFormattedValue(field,field.api_name,data.$module,data,true,null,true,true))}} </template></template></template></template></template></template></template></template> </span> </span> </template></template></template> </div> </lyte-td> <lyte-td class="pL15 pR15 vaT"> <div class="dF aiCenter"> <span class="dIB crmBaseColor vaM wbBreakWord" id="relatedList_{{data.id}}_Activities_owner" onmouseover="{{action(\'showUserTooltip\',data.Owner.id,data.id)}}" onmouseout="{{action(\'hideUserTooltip\')}}">{{data.Owner.name}}</span> </div> </lyte-td> <lyte-td class="pL15 pR15 vaT crmBaseColor"> <template is="if" value="{{data.Due_Date}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(data.Due_Date,true,dateformat)}} </template></template> </lyte-td> </lyte-tr> </template><template case="false"><template is="if" value="{{expHandlers(data.$module,\'===\',\'Events\')}}"><template case="true"> <lyte-tr> <lyte-td class="pR30 vaT choroViewTd"> <template is="if" value="{{expHandlers(expHandlers(data.Locked__s,\'!\'),\'&amp;&amp;\',expHandlers(data.$locked_for_me,\'!\'))}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(data.$approved,\'||\',expHandlers(data.$approved,\'==\',null)),\'||\',expHandlers(expHandlers(data.$approved,\'!\'),\'&amp;&amp;\',expHandlers(data.$approval_state,\'===\',\'approval_process_rejected\')))}}"><template case="true"> <span id="act_split_origin_{{data.id}}" class="icoThreeDots dN cP pA" data-zcqa="relatedListMore_{{getSubject(data.$module,data)}}_{{data.$module}}" onclick="{{action(\'showMoreOptions\',data,this,getPersonalityForChronological(parent_relation_name,data.$module))}}"> <crmutil-icon class="zcicn-more-brrounded" icon-name="more-hr-md" icon-class="zcicn-more-hr-md zcicn_636f86"></crmutil-icon> </span> </template></template></template></template> <span class="vaT dIB "> <crmutil-icon icon-name="events" icon-class="zcicn-events crmBaseIcon"></crmutil-icon> </span> <template is="if" value="{{expHandlers(data.$approval_state,\'===\',\'approval_process_pending\')}}"><template case="true"> <span class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspChLockIcon" title="{{getI18(&quot;crm.approvalProcess.label.waitingForApproval&quot;)}}" alt="{{getI18(&quot;crm.approvalProcess.label.waitingForApproval&quot;)}}"></span> </template><template case="false"><template is="if" value="{{expHandlers(data.$approval_state,\'===\',\'merge_pending\')}}"><template case="true"> <span class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspChLockIcon" title="{{getI18(&quot;crm.approvalProcess.label.waitingForFindAndMerge&quot;)}}" alt="{{getI18(&quot;crm.approvalProcess.label.waitingForFindAndMerge&quot;)}}"></span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(data.$approval_state,\'===\',\'review_process_pending\'),\'||\',expHandlers(data.$approval_state,\'===\',\'review_process_rejected\'))}}"><template case="true"> <span class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspChLockIcon" title="{{getI18(&quot;crm.reviewprocess.record.review.pending&quot;)}}" alt="{{getI18(&quot;crm.reviewprocess.record.review.pending&quot;)}}"></span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(data.Locked__s,\'&amp;&amp;\',data.$locked_for_me),\'&amp;&amp;\',expHandlers(data.$editable,\'!\'))}}"><template case="true"> <span data-zcqa="lockedforMeAct_{{data.id}}" class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspLockIcon" title="{{getI18(&quot;crm.record.lock.record.locked&quot;)}}" alt="{{getI18(&quot;crm.record.lock.record.locked&quot;)}}"></span> </template></template></template></template></template></template></template></template> <div class="dIB activity_info_details mL10"> <div class="mB3" data-zcq="relatedlist_{{getPersonalityForChronological(parent_relation_name,data.$module)}}_{{getSubject(data.$module,data)}}"> <template is="if" value="{{expHandlers(isprintview,\'!\')}}"><template case="true"> <link-to lt-prop-class="link dIB choronoSubLink" data-zcqa="relatedList_{{getSubject(data.$module,data)}}_Activities" lt-prop-route="crm.tab.module.entity.detail" lt-prop-dp="[&quot;{{data.$module}}&quot;,&quot;{{data.id}}&quot;]" lt-prop-td="{&quot;fromActivityListView&quot;:&quot;true&quot;,&quot;pfrom&quot;:&quot;rel&quot;,&quot;module&quot;:&quot;{{data.$module}}&quot;,&quot;id&quot;:&quot;{{data.id}}&quot;,&quot;pn&quot;:&quot;{{getPersonalityForChronological(parent_relation_name,data.$module)}}&quot;,&quot;peId&quot;:&quot;{{entity_id}}&quot;,&quot;bMod&quot;:&quot;{{rel_module}}&quot;,&quot;fromActSubModuleListView&quot;:&quot;true&quot;,&quot;lookback&quot;:&quot;true&quot;}"> <template is="if" value="{{data.$colour_code}}"><template case="true"> <div class="pR"> <span class="dIB eventColor_rL_split" data-zcqa="colorspan_{{getSubject(data.$module,data)}}" style="background: {{data.$colour_code}}"></span> </div> </template></template> {{getSubject(data.$module,data)}} </link-to> <template is="if" value="{{data.$in_project_sync}}"><template case="true"> <i class="task_syncIcon vaM mL5 mB2 pA" lt-prop-title="{{concat(getI18n(&quot;crm.schedules.prefix.in&quot;),getI18n(&quot;crm.integ.sync.message&quot;,&quot;crm.project.integration.title&quot;))}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;followcursor&quot;, &quot;appearance&quot; : &quot;box&quot;}"></i> </template></template> </template><template case="false"> <template is="if" value="{{data.$colour_code}}"><template case="true"> <div class="pR"> <span class="dIB eventColor_rL_split" data-zcqa="colorspan_{{getSubject(data.$module,data)}}" style="background: {{data.$colour_code}}"></span> </div> </template></template> <span class="crmLinkColor cP">{{getSubject(data.$module,data)}}</span> </template></template> <template is="if" value="{{data.$in_project_sync}}"><template case="true"> <i class="task_syncIcon vaM mL5 mB2 pA" lt-prop-title="{{concat(getI18n(&quot;crm.schedules.prefix.in&quot;),getI18n(&quot;crm.integ.sync.message&quot;,&quot;crm.project.integration.title&quot;))}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;followcursor&quot;, &quot;appearance&quot; : &quot;box&quot;}"></i> </template></template> </div> <template is="for" items="{{events_fields}}" item="field" index="index"> <template is="if" value="{{expHandlers(expHandlers(contains(excludeFields,field.api_name),\'!\'),\'&amp;&amp;\',validateField(data[field.api_name]))}}"><template case="true"> <span class="openActiveinfoList {{if(ifEquals(field.api_name,\'Description\'),\'dF flexDC\',\'dIF aiFlexStart fwWrap\')}}" data-zcq="relatedlist_{{getPersonalityForChronological(parent_relation_name,data.$module)}}_{{getSubject(data.$module,data)}}__{{field.api_name}}"> <template is="if" value="{{expHandlers(field.api_name,\'===\',&quot;Description&quot;)}}"><template case="true"> <span class="crmLabelColor dIB aspChronoLabel"> {{field.field_label}} :</span> </template><template case="false"> <span class="crmLabelColor dIB aspChronoLabel"> {{field.field_label}}</span> <span class="mL3">:</span> </template></template> <span class="crmBaseColor aspChronoValue {{getClassForFields(field.api_name,\'mL\')}}"> <template is="if" value="{{expHandlers(expHandlers(field.data_type,\'===\',\'lookup\'),\'||\',expHandlers(field.data_type,\'===\',\'multi_module_lookup\'))}}"><template case="true"> <template is="if" value="{{expHandlers(field.api_name,\'===\',\'What_Id\')}}"><template case="true"> <crux-lookup-component cx-prop-value="{{data[field.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{if(ifEquals(data.$se_module,&quot;Deals&quot;),&quot;Potentials&quot;,getModuleNameByApiNameAsp(data.$se_module))}}&quot;, &quot;{{data[field.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(data.$se_module),\'Small\')}} actSplitLookup" onmouseover="{{action(\'showHideRelatedFields\',data[field.api_name],field.api_name,data.$se_module,event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-zcqa="{{data[field.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(field.api_name,\'===\',\'Who_Id\')}}"><template case="true"> <crux-lookup-component cx-prop-value="{{data[field.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;Contacts&quot;, &quot;{{data[field.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" onmouseover="{{action(\'showHideRelatedFields\',data[field.api_name],field.api_name,\'Contacts\',event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(\'Contacts\'),\'Small\')}} actSplitLookup" cx-prop-zcqa="{{data[field.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(field.api_name,\'===\',\'Service_Name\')}}"><template case="true"> <crux-lookup-component cx-prop-value="{{data[field.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;Services&quot;, &quot;{{data[field.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" onmouseover="{{action(\'showHideRelatedFields\',data[field.api_name],field.api_name,data.$se_module,event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(\'Services\'),\'Small\')}} actSplitLookup" cx-prop-zcqa="{{data[field.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(field.api_name,\'==\',&quot;Appointments_Booking_Form_Name__s&quot;)}}"><template case="true"> <crux-lookup-component cx-prop-zcqa="{{data[field.api_name].name}}" cx-prop-value="{{data[field.api_name].name}}" cx-prop-module="CalendarBookings" cx-prop-route-name="crm.settings.section.calendar-booking.view-calendar-booking" cx-prop-query-params="{&quot;module&quot; : &quot;Appointments__s&quot;, &quot;type&quot;: &quot;team&quot;}" cx-prop-dynamic-params="[&quot;{{data[field.api_name].id}}&quot;]"> </crux-lookup-component> </template></template></template></template></template></template></template></template></template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'===\',\'textarea\')}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(isprintview,\'!\'),\'&amp;&amp;\',expHandlers(data[field.api_name].length,\'>\',txt_ln))}}"><template case="true"> <span class="wwBreakWord" id="Activities_{{field.api_name}}_{{data.id}}_old"> {{formattedText(data[field.api_name],txt_ln)}} </span> <span class="crmLinkColor cP crm-base-font-size dIB" data-zcqa="Activities_{{field.api_name}}_{{data.id}}_readMore" onclick="{{action(\'readMoreDesc\',this,data)}}" id="Activities_{{field.api_name}}_{{data.id}}" value="{{data[field.api_name]}}"> {{getI18n("crm.readmore")}} </span> </template><template case="false"> <span class="wwBreakWord" id="Activities_{{field.api_name}}_{{data.id}}_old"> {{data[field.api_name]}} </span> </template></template> </template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'===\',\'datetime\')}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(data[field.api_name],false,dateformat)}} </template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'===\',\'date\')}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(data[field.api_name],true,dateformat)}} </template><template case="false"> {{unescape(getFormattedValue(field,field.api_name,data.$module,data,true,null,true,true))}} </template></template></template></template></template></template></template></template> </span> </span> </template></template></template> </div> </lyte-td> <lyte-td class="pL15 pR15 vaT"> <div class="dF aiCenter"> <span class="dIB crmBaseColor vaM wbBreakWord" id="relatedList_{{data.id}}_Activities_owner" onmouseover="{{action(\'showUserTooltip\',data.Owner.id,data.id)}}" onmouseout="{{action(\'hideUserTooltip\')}}">{{data.Owner.name}}</span> </div> </lyte-td> <lyte-td class="pL15 pR15 vaT crmBaseColor"> {{convertEventDateTime(data.Start_DateTime,data.End_DateTime,data.All_day,false,dateformat)}} </lyte-td> </lyte-tr> </template><template case="false"><template is="if" value="{{expHandlers(data.$module,\'===\',\'Calls\')}}"><template case="true"> <lyte-tr> <lyte-td class="pR30 vaT choroViewTd"> <template is="if" value="{{expHandlers(data.$process_flow,\'!\')}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(activity_type,\'===\',\'open\'),\'&amp;&amp;\',expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(data.$approval_state,\'===\',\'approval_process_pending\'),\'||\',expHandlers(data.$approval_state,\'===\',\'merge_pending\')),\'||\',expHandlers(data.$approval_state,\'===\',\'review_process_pending\')),\'||\',expHandlers(data.$approval_state,\'===\',\'review_process_rejected\')),\'!\'))}}"><template case="true"> <span class="cP markAsCompletedIcon pA dN" data-zcqa="completeCallMoreOption" lt-prop-tooltip-config="{&quot;position&quot; : &quot;left&quot;}" lt-prop-title="{{getI18n(\'crm.label.mark.completed\')}}" onclick="{{action(\'callAction\',\'Completed\',data)}}"> <crmutil-icon class="eventNone" icon-name="tick-rounded" icon-class="zcicn-tick-rounded tick_zcicn20 zcicn_7c8bae markAsUtilICo"></crmutil-icon> </span> </template></template></template></template> <template is="if" value="{{expHandlers(expHandlers(data.Locked__s,\'!\'),\'&amp;&amp;\',expHandlers(data.$locked_for_me,\'!\'))}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(data.$approved,\'||\',expHandlers(data.$approved,\'==\',null)),\'||\',expHandlers(expHandlers(data.$approved,\'!\'),\'&amp;&amp;\',expHandlers(data.$approval_state,\'===\',\'approval_process_rejected\')))}}"><template case="true"> <span id="act_split_origin_{{data.id}}" class="icoThreeDots dN cP pA" data-zcqa="relatedListMore_{{getSubject(data.$module,data)}}_{{data.$module}}" onclick="{{action(\'showMoreOptions\',data,this,getPersonalityForChronological(parent_relation_name,data.$module))}}"> <crmutil-icon class="zcicn-more-brrounded" icon-name="more-hr-md" icon-class="zcicn-more-hr-md zcicn_636f86"></crmutil-icon> </span> </template></template></template></template> <span class="vaT dIB "> <crmutil-icon icon-name="calls" icon-class="zcicn-calls crmBaseIcon"></crmutil-icon> </span> <template is="if" value="{{expHandlers(data.$approval_state,\'===\',\'approval_process_pending\')}}"><template case="true"> <span class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspChLockIcon" title="{{getI18(&quot;crm.approvalProcess.label.waitingForApproval&quot;)}}" alt="{{getI18(&quot;crm.approvalProcess.label.waitingForApproval&quot;)}}"></span> </template><template case="false"><template is="if" value="{{expHandlers(data.$approval_state,\'===\',\'merge_pending\')}}"><template case="true"> <span class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspChLockIcon" title="{{getI18(&quot;crm.approvalProcess.label.waitingForFindAndMerge&quot;)}}" alt="{{getI18(&quot;crm.approvalProcess.label.waitingForFindAndMerge&quot;)}}"></span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(data.$approval_state,\'===\',\'review_process_pending\'),\'||\',expHandlers(data.$approval_state,\'===\',\'review_process_rejected\'))}}"><template case="true"> <span class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspChLockIcon" title="{{getI18(&quot;crm.reviewprocess.record.review.pending&quot;)}}" alt="{{getI18(&quot;crm.reviewprocess.record.review.pending&quot;)}}"></span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(data.Locked__s,\'&amp;&amp;\',data.$locked_for_me),\'&amp;&amp;\',expHandlers(data.$editable,\'!\'))}}"><template case="true"> <span data-zcqa="lockedforMeAct_{{data.id}}" class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspLockIcon" title="{{getI18(&quot;crm.record.lock.record.locked&quot;)}}" alt="{{getI18(&quot;crm.record.lock.record.locked&quot;)}}"></span> </template></template></template></template></template></template></template></template> <div class="dIB activity_info_details mL10"> <div class="dIB activity_info_details" data-zcq="relatedlist_{{getPersonalityForChronological(parent_relation_name,data.$module)}}_{{getSubject(data.$module,data)}}"> <template is="if" value="{{expHandlers(isprintview,\'!\')}}"><template case="true"> <link-to lt-prop-class="link dIB choronoSubLink" data-zcqa="relatedList_{{getSubject(data.$module,data)}}_Activities" lt-prop-route="crm.tab.module.entity.detail" lt-prop-dp="[&quot;{{data.$module}}&quot;,&quot;{{data.id}}&quot;]" lt-prop-td="{&quot;fromActivityListView&quot;:&quot;true&quot;,&quot;pfrom&quot;:&quot;rel&quot;,&quot;module&quot;:&quot;{{data.$module}}&quot;,&quot;id&quot;:&quot;{{data.id}}&quot;,&quot;pn&quot;:&quot;{{getPersonalityForChronological(parent_relation_name,data.$module)}}&quot;,&quot;peId&quot;:&quot;{{entity_id}}&quot;,&quot;bMod&quot;:&quot;{{rel_module}}&quot;,&quot;fromActSubModuleListView&quot;:&quot;true&quot;,&quot;lookback&quot;:&quot;true&quot;}"> <template is="if" value="{{data.$colour_code}}"><template case="true"> <div class="pR"> <span class="dIB eventColor_rL_split" data-zcqa="colorspan_{{getSubject(data.$module,data)}}" style="background: {{data.$colour_code}}"></span> </div> </template></template> {{getSubject(data.$module,data)}} </link-to> <template is="if" value="{{data.$in_project_sync}}"><template case="true"> <i class="task_syncIcon vaM mL5 mB2 pA" lt-prop-title="{{concat(getI18n(&quot;crm.schedules.prefix.in&quot;),getI18n(&quot;crm.integ.sync.message&quot;,&quot;crm.project.integration.title&quot;))}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;followcursor&quot;, &quot;appearance&quot; : &quot;box&quot;}"></i> </template></template> </template><template case="false"> <template is="if" value="{{data.$colour_code}}"><template case="true"> <div class="pR"> <span class="dIB eventColor_rL_split" data-zcqa="colorspan_{{getSubject(data.$module,data)}}" style="background: {{data.$colour_code}}"></span> </div> </template></template> <div class="mB20"> <span class="crmBaseColor" id="{{data.id}}">{{getSubject(data.$module,data)}}</span> </div> </template></template> </div> <template is="for" items="{{calls_fields}}" item="field" index="index"> <template is="if" value="{{expHandlers(expHandlers(contains(excludeFields,field.api_name),\'!\'),\'&amp;&amp;\',validateField(data[field.api_name]))}}"><template case="true"> <span class="openActiveinfoList {{if(ifEquals(field.api_name,\'Description\'),\'dF flexDC\',\'dIF aiFlexStart fwWrap\')}}" data-zcq="relatedlist_{{getPersonalityForChronological(parent_relation_name,data.$module)}}_{{getSubject(data.$module,data)}}"> <template is="if" value="{{expHandlers(field.api_name,\'===\',&quot;Description&quot;)}}"><template case="true"> <span class="crmLabelColor dIB aspChronoLabel"> {{field.field_label}} :</span> </template><template case="false"> <span class="crmLabelColor dIB aspChronoLabel"> {{field.field_label}}</span> <span class="mL3">:</span> </template></template> <span class="crmBaseColor dIB aspChronoValue {{getClassForFields(field.api_name,\'mL\')}}"> <template is="if" value="{{expHandlers(expHandlers(field.data_type,\'===\',\'lookup\'),\'||\',expHandlers(field.data_type,\'===\',\'multi_module_lookup\'))}}"><template case="true"> <template is="if" value="{{expHandlers(field.api_name,\'===\',\'What_Id\')}}"><template case="true"> <crux-lookup-component cx-prop-value="{{data[field.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{if(ifEquals(data.$se_module,&quot;Deals&quot;),&quot;Potentials&quot;,getModuleNameByApiNameAsp(data.$se_module))}}&quot;, &quot;{{data[field.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(data.$se_module),\'Small\')}} actSplitLookup" onmouseover="{{action(\'showHideRelatedFields\',data[field.api_name],field.api_name,data.$se_module,event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-zcqa="{{data[field.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(field.api_name,\'===\',\'Who_Id\')}}"><template case="true"> <crux-lookup-component cx-prop-value="{{data[field.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;Contacts&quot;, &quot;{{data[field.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" onmouseover="{{action(\'showHideRelatedFields\',data[field.api_name],field.api_name,\'Contacts\',event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(\'Contacts\'),\'Small\')}} actSplitLookup" cx-prop-zcqa="{{data[field.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(field.api_name,\'===\',\'Service_Name\')}}"><template case="true"> <crux-lookup-component cx-prop-value="{{data[field.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;Services&quot;, &quot;{{data[field.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" onmouseover="{{action(\'showHideRelatedFields\',data[field.api_name],field.api_name,data.$se_module,event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(\'Services\'),\'Small\')}} actSplitLookup" cx-prop-zcqa="{{data[field.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(field.api_name,\'==\',&quot;Appointments_Booking_Form_Name__s&quot;)}}"><template case="true"> <crux-lookup-component cx-prop-zcqa="{{data[field.api_name].name}}" cx-prop-value="{{data[field.api_name].name}}" cx-prop-module="CalendarBookings" cx-prop-route-name="crm.settings.section.calendar-booking.view-calendar-booking" cx-prop-query-params="{&quot;module&quot; : &quot;Appointments__s&quot;, &quot;type&quot;: &quot;team&quot;}" cx-prop-dynamic-params="[&quot;{{data[field.api_name].id}}&quot;]"> </crux-lookup-component> </template></template></template></template></template></template></template></template></template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'===\',\'textarea\')}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(isprintview,\'!\'),\'&amp;&amp;\',expHandlers(data[field.api_name].length,\'>\',txt_ln))}}"><template case="true"> <span class="wwBreakWord" id="Activities_{{field.api_name}}_{{data.id}}_old"> {{formattedText(data[field.api_name],txt_ln)}} </span> <span class="crmLinkColor cP crm-base-font-size dIB" data-zcqa="Activities_{{field.api_name}}_{{data.id}}_readMore" onclick="{{action(\'readMoreDesc\',this,data)}}" id="Activities_{{field.api_name}}_{{data.id}}" value="{{data[field.api_name]}}"> {{getI18n("crm.readmore")}} </span> </template><template case="false"> <span class="wwBreakWord" id="Activities_{{field.api_name}}_{{data.id}}_old"> {{data[field.api_name]}} </span> </template></template> </template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'===\',\'datetime\')}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(data[field.api_name],false,dateformat)}} </template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'===\',\'date\')}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(data[field.api_name],true,dateformat)}} </template><template case="false"> {{unescape(getFormattedValue(field,field.api_name,data.$module,data,true,null,true,true))}} </template></template></template></template></template></template></template></template> </span> </span> </template></template></template> </div> </lyte-td> <lyte-td class="pL15 pR15 vaT"> <div class="dF aiCenter"> <span class="dIB crmBaseColor vaM wbBreakWord" id="relatedList_{{data.id}}_Activities_owner" onmouseover="{{action(\'showUserTooltip\',data.Owner.id,data.id)}}" onmouseout="{{action(\'hideUserTooltip\')}}">{{data.Owner.name}}</span> </div> </lyte-td> <lyte-td class="pL15 pR15 vaT crmBaseColor"> {{convertTimeToUserDateFormatFromISO(data.Call_Start_Time,false,dateformat)}} </lyte-td> </lyte-tr> </template><template case="false"><template is="if" value="{{expHandlers(data.$module,\'===\',\'Appointments\')}}"><template case="true"> <lyte-tr> <lyte-td class="pR30 vaT choroViewTd"> <template is="if" value="{{expHandlers(expHandlers(data.Locked__s,\'!\'),\'&amp;&amp;\',expHandlers(data.$locked_for_me,\'!\'))}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(data.$approved,\'||\',expHandlers(data.$approved,\'==\',null)),\'||\',expHandlers(expHandlers(data.$approved,\'!\'),\'&amp;&amp;\',expHandlers(data.$approval_state,\'===\',\'approval_process_rejected\')))}}"><template case="true"> <span id="act_split_origin_{{data.id}}" class="icoThreeDots dN cP pA" data-zcqa="relatedListMore_{{getSubject(data.$module,data)}}_{{data.$module}}" onclick="{{action(\'showMoreOptions\',data,this,getPersonalityForChronological(parent_relation_name,data.$module))}}"> <crmutil-icon class="zcicn-more-brrounded" icon-name="more-hr-md" icon-class="zcicn-more-hr-md zcicn_636f86"></crmutil-icon> </span> </template></template></template></template> <template is="if" value="{{expHandlers(expHandlers(data.Locked__s,\'&amp;&amp;\',data.$locked_for_me),\'&amp;&amp;\',expHandlers(data.$editable,\'!\'))}}"><template case="true"> <span data-zcqa="lockedforMeAct_{{data.id}}" class="zcicncss-lock-locked zcicn-cssIcons zcicn_grey_mask pA aspLockIcon" title="{{getI18(&quot;crm.record.lock.record.locked&quot;)}}" alt="{{getI18(&quot;crm.record.lock.record.locked&quot;)}}"></span> </template></template> <span class="vaT dIB "> <crmutil-icon icon-name="appointments" icon-class="zcicn-appointments zcicn_black"></crmutil-icon> </span> <div class="dIB activity_info_details mL10"> <div class="dIB activity_info_details" data-zcq="relatedlist_{{getPersonalityForChronological(parent_relation_name,data.$module)}}_{{getSubject(data.$module,data)}}"> <template is="if" value="{{hasEditPermissionForApp}}"><template case="true"> <template is="if" value="{{isAppCompleteAction}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(activity_type,\'===\',\'open\'),\'&amp;&amp;\',expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(data.$approval_state,\'===\',\'approval_process_pending\'),\'||\',expHandlers(data.$approval_state,\'===\',\'merge_pending\')),\'||\',expHandlers(data.$approval_state,\'===\',\'review_process_pending\')),\'||\',expHandlers(data.$approval_state,\'===\',\'review_process_rejected\')),\'!\'))}}"><template case="true"> <span class="cP markAsCompletedIcon pA dN" id="completeAppMoreOption" data-zcqa="completeAppMoreOption" lt-prop-tooltip-config="{&quot;position&quot; : &quot;left&quot;}" lt-prop-title="{{getI18n(\'crm.label.mark.completed\')}}" onclick="{{action(\'showAppPopup\',\'appointmentCompletePopup\',this,appEndTime,data)}}" data-params="{&quot;module&quot;:&quot;Appointments&quot;,&quot;id&quot;:&quot;{{data.id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;}"> <crmutil-icon class="eventNone" icon-name="tick-rounded" icon-class="zcicn-tick-rounded tick_zcicn20 zcicn_7c8bae markAsUtilICo"></crmutil-icon> </span> </template></template></template></template> </template></template> <template is="if" value="{{expHandlers(isprintview,\'!\')}}"><template case="true"> <link-to lt-prop-class="link dIB choronoSubLink" data-zcqa="relatedList_{{getSubject(data.$module,data)}}_Activities" lt-prop-route="crm.tab.module.entity.detail" lt-prop-dp="[&quot;{{data.$module}}&quot;,&quot;{{data.id}}&quot;]" lt-prop-td="{&quot;fromActivityListView&quot;:&quot;true&quot;,&quot;pfrom&quot;:&quot;rel&quot;,&quot;module&quot;:&quot;{{data.$module}}&quot;,&quot;id&quot;:&quot;{{data.id}}&quot;,&quot;pn&quot;:&quot;{{getPersonalityForChronological(parent_relation_name,data.$module)}}&quot;,&quot;peId&quot;:&quot;{{entity_id}}&quot;,&quot;bMod&quot;:&quot;{{rel_module}}&quot;,&quot;fromActSubModuleListView&quot;:&quot;true&quot;,&quot;lookback&quot;:&quot;true&quot;}"> <template is="if" value="{{data.$colour_code}}"><template case="true"> <div class="pR"> <span class="dIB eventColor_rL_split" data-zcqa="colorspan_{{getSubject(data.$module,data)}}" style="background: {{data.$colour_code}}"></span> </div> </template></template> {{getSubject(data.$module,data)}} </link-to> <template is="if" value="{{data.$in_project_sync}}"><template case="true"> <i class="task_syncIcon vaM mL5 mB2 pA" lt-prop-title="{{concat(getI18n(&quot;crm.schedules.prefix.in&quot;),getI18n(&quot;crm.integ.sync.message&quot;,&quot;crm.project.integration.title&quot;))}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;followcursor&quot;, &quot;appearance&quot; : &quot;box&quot;}"></i> </template></template></template><template case="false"> <template is="if" value="{{data.$colour_code}}"><template case="true"> <div class="pR"> <span class="dIB eventColor_rL_split" data-zcqa="colorspan_{{getSubject(data.$module,data)}}" style="background: {{data.$colour_code}}"></span> </div> </template></template> <div class="mB20"> <span class="crmBaseColor" id="{{data.id}}">{{getSubject(data.$module,data)}}</span> </div> </template></template> </div> <template is="for" items="{{appointment_fields}}" item="field" index="index"> <template is="if" value="{{expHandlers(expHandlers(contains(excludeFields,field.api_name),\'!\'),\'&amp;&amp;\',validateField(data[field.api_name]))}}"><template case="true"> <span class="openActiveinfoList {{if(ifEquals(field.api_name,\'Description\'),\'dF flexDC\',\'dIF aiFlexStart fwWrap\')}}" data-zcq="relatedlist_{{getPersonalityForChronological(parent_relation_name,data.$module)}}_{{getSubject(data.$module,data)}}_{{field.api_name}}"> <template is="if" value="{{expHandlers(field.api_name,\'===\',&quot;Description&quot;)}}"><template case="true"> <span class="crmLabelColor dIB aspChronoLabel"> {{field.field_label}} :</span> </template><template case="false"> <span class="crmLabelColor dIB aspChronoLabel"> {{field.field_label}}</span> <span class="mL3">:</span> </template></template> <span class="crmBaseColor dIB aspChronoValue {{getClassForFields(field.api_name,\'mL\')}}"> <template is="if" value="{{expHandlers(expHandlers(field.data_type,\'===\',\'lookup\'),\'||\',expHandlers(field.data_type,\'===\',\'multi_module_lookup\'))}}"><template case="true"> <template is="if" value="{{expHandlers(field.api_name,\'===\',\'What_Id\')}}"><template case="true"> <crux-lookup-component cx-prop-value="{{data[field.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{if(ifEquals(data.$se_module,&quot;Deals&quot;),&quot;Potentials&quot;,getModuleNameByApiNameAsp(data.$se_module))}}&quot;, &quot;{{data[field.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(data.$se_module),\'Small\')}} actSplitLookup" onmouseover="{{action(\'showHideRelatedFields\',data[field.api_name],field.api_name,data.$se_module,event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-zcqa="{{data[field.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(field.api_name,\'===\',\'Who_Id\'),\'||\',expHandlers(field.api_name,\'==\',&quot;Appointment_For&quot;))}}"><template case="true"> <crux-lookup-component cx-prop-value="{{data[field.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;Contacts&quot;, &quot;{{data[field.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" onmouseover="{{action(\'showHideRelatedFields\',data[field.api_name],field.api_name,\'Contacts\',event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(\'Contacts\'),\'Small\')}} actSplitLookup" cx-prop-zcqa="{{data[field.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(field.api_name,\'===\',\'Service_Name\')}}"><template case="true"> <crux-lookup-component cx-prop-value="{{data[field.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;Services&quot;, &quot;{{data[field.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" onmouseover="{{action(\'showHideRelatedFields\',data[field.api_name],field.api_name,data.$se_module,event)}}" onmouseout="{{action(\'showHideRelatedFields\',undefined,undefined,undefined,event)}}" cx-prop-icon-class="{{concat(getModuleNameForIconForAct(\'Services\'),\'Small\')}} actSplitLookup" cx-prop-zcqa="{{data[field.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(field.api_name,\'==\',&quot;Appointments_Booking_Form_Name__s&quot;)}}"><template case="true"> <crux-lookup-component cx-prop-zcqa="{{data[field.api_name].name}}" cx-prop-value="{{data[field.api_name].name}}" cx-prop-module="CalendarBookings" cx-prop-route-name="crm.settings.section.calendar-booking.view-calendar-booking" cx-prop-query-params="{&quot;module&quot; : &quot;Appointments__s&quot;, &quot;type&quot;: &quot;team&quot;}" cx-prop-dynamic-params="[&quot;{{data[field.api_name].id}}&quot;]"> </crux-lookup-component> </template></template></template></template></template></template></template></template></template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'===\',\'textarea\')}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(isprintview,\'!\'),\'&amp;&amp;\',expHandlers(data[field.api_name].length,\'>\',txt_ln))}}"><template case="true"> <span class="wwBreakWord" id="Activities_{{field.api_name}}_{{data.id}}_old"> {{formattedText(data[field.api_name],txt_ln)}} </span> <span class="crmLinkColor cP crm-base-font-size dIB" data-zcqa="Activities_{{field.api_name}}_{{data.id}}_readMore" onclick="{{action(\'readMoreDesc\',this,data)}}" id="Activities_{{field.api_name}}_{{data.id}}" value="{{data[field.api_name]}}"> {{getI18n("crm.readmore")}} </span> </template><template case="false"> <span class="wwBreakWord" id="Activities_{{field.api_name}}_{{data.id}}_old"> {{data[field.api_name]}} </span> </template></template> </template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'===\',\'datetime\')}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(data[field.api_name],false,dateformat)}} </template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'===\',\'date\')}}"><template case="true"> {{convertTimeToUserDateFormatFromISO(data[field.api_name],true,dateformat)}} </template><template case="false"> {{unescape(getFormattedValue(field,field.api_name,data.$module,data,true,null,true,true))}} </template></template></template></template></template></template></template></template> </span> </span> </template></template></template> </div> </lyte-td> <lyte-td class="pL15 pR15 vaT"> <div class="dF aiCenter"> <span class="dIB crmBaseColor vaM wbBreakWord" id="relatedList_{{data.id}}_Activities_owner" onmouseover="{{action(\'showUserTooltip\',data.Owner.id,data.id)}}" onmouseout="{{action(\'hideUserTooltip\')}}">{{data.Owner.name}}</span> </div> </lyte-td> <lyte-td class="pL15 pR15 vaT crmBaseColor"> {{convertTimeToUserDateFormatFromISO(data.Appointment_Start_Time,false,dateformat)}} </lyte-td> </lyte-tr> </template></template></template></template></template></template></template></template></template> </lyte-tbody> </lyte-table-structure> </template> </lyte-table> <crux-user-tooltip id="activities_addons_user_tooltip"></crux-user-tooltip> </template></template></template></template></template></template> <template is="if" value="{{showNavig}}"><template case="true"> <div class="bg_white dF pT12 pB5 pR10 br_top_border4 jcFlextEnd"> <lyte-navigator lt-prop-yield="true" on-next="{{method(\'navigNext\')}}" on-previous="{{method(\'navigPrevious\')}}" lt-prop-value="{{startIndex}}" lt-prop-records="{{nextpagerelcount}}" lt-prop-perpage="10"> <template is="registerYield" yield-name="navigatorYield"> <div class="dF aiCenter"> <div class="lyteSingleBack lyteNavigator lyteIconSingleBack" data-zcqa="{{related_list.id}}_rellist_navig_prev"></div> <div class="crm-font-regular"> {{startRecord}} <span class="crmLabelColor pL10 pR10">-</span> {{endRecord}} </div> <div class="lyteSingleFront lyteNavigator lyteIconSingleFront" data-zcqa="{{related_list.id}}_rellist_navig_next"></div> </div> </template> </lyte-navigator> </div> </template></template> <lyte-popover lt-prop="{&quot;width&quot;:&quot;auto&quot;,&quot;wrapperClass&quot;:&quot;samplePopover&quot;,&quot;freeze&quot;:false,&quot;type&quot;:&quot;box&quot;,&quot;originElem&quot;:&quot;{{popoverOrigin}}&quot;}" lt-prop-scrollable="true" on-close="{{method(&quot;closePopup&quot;)}}" lt-prop-duration="{{ud}}" lt-prop-placement="right bottom" lt-prop-show-close-button="false" lt-prop-show="{{lbind(showpopover)}}" lt-prop-content-padding="5px 0"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <ul class="m0 moreOptValues p0 crm-base-font-size"> <template is="if" value="{{expHandlers(personality,\'===\',\'CALLSPERSONALITY\')}}"><template case="true"> <li class="moreOptValueList" data-zcqa="scheduleCallMoreOption" onclick="{{action(\'callAction\',\'Scheduled\')}}"> <div class="crmLinkColor cP"> {{getI18n(\'crm.label.reschedule.call\',\'\')}} </div> </li> <li class="borderBottom moreOptValueList" data-zcqa="cancelCallMoreOption" onclick="{{action(\'callAction\',\'Cancelled\')}}"> <div class="crmLinkColor cP"> {{getI18n(\'crm.button.cancel\')}} </div> </li> </template><template case="false"><template is="if" value="{{expHandlers(personality,\'===\',\'APPOINTMENTSPERSONALITY\')}}"><template case="true"> <template is="if" value="{{hasEditPermissionForApp}}"><template case="true"> <li class="moreOptValueList" id="rescheduleAppMoreOption" onclick="{{action(\'showAppPopup\',\'Reschedule Information\',this)}}" data-params="{&quot;module&quot;:&quot;Appointments&quot;,&quot;id&quot;:&quot;{{activity_id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;,&quot;serviceId&quot;:&quot;{{service_id}}&quot;}" data-zcqa="rescheduleAppMoreOption"> <div class="crmLinkColor cP"> {{getI18n(\'crm.appointments.status.markreschedule\',getSingularLabel(\'Appointments\'))}} </div> </li> <li class="moreOptValueList" id="cancelAppMoreOption" onclick="{{action(\'showAppPopup\',\'Cancellation Information\',this)}}" data-params="{&quot;module&quot;:&quot;Appointments&quot;,&quot;id&quot;:&quot;{{activity_id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;}" data-zcqa="cancelAppMoreOption"> <div class="crmLinkColor cP"> {{getI18n(\'crm.appointments.status.markcancel\',getSingularLabel(\'Appointments\'))}} </div> </li> </template></template> </template></template></template></template> <a class="fillAspLi crmLinkColor cP" data-zcqa="relatedListEdit_{{curRecMod}}" href="javascript:;" data-params="{&quot;module&quot;:&quot;{{curRecMod}}&quot;,&quot;id&quot; : &quot;{{activity_id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;,&quot;goTo&quot;:&quot;{{personality}}&quot;}" data-cid="editbtn"> <li class="moreOptValueList" onclick="{{action(\'hidePopOver\')}}"> {{getI18n(\'Edit\')}} </li> </a> <li class="moreOptValueList" deleteaction="javascript:Lyte.registeredMixins[\'crm-related-list-utils\'].sortRelatedList(\'{{getChronologicalActivityActionLink(\'deleteLink\',undefined,current_rl_data.id,current_rl_data,personality)}}\',null,\'{{activity_id}}\')" data-params="{&quot;module&quot;:&quot;{{curRecMod}}&quot;}" onclick="{{action(\'clickAction\',\'delete\',this,this,personality)}}"> <div class="crmLinkColor cP fillAspLi" id="deletelink" data-zcqa="lnk_delete_{{curRecMod}}" deleteaction="javascript:Lyte.registeredMixins[\'crm-related-list-utils\'].sortRelatedList(\'{{getChronologicalActivityActionLink(\'deleteLink\',undefined,current_rl_data.id,current_rl_data,personality)}}\',null,\'{{activity_id}}\')" data-params="{&quot;module&quot;:&quot;{{curRecMod}}&quot;}" onclick="{{action(\'clickAction\',\'delete\',this,this,personality)}}"> {{getI18n(\'Delete\')}} </div> </li> </ul> </lyte-popover-content> </template> </lyte-popover> </lyte-event-listener></template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,1,1,0]}]},false:{dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1,1,1,1,0]},{type:"text",position:[1,1,1,1,2,0]},{type:"componentDynamic",position:[1,1,1,1]},{type:"text",position:[1,1,1,3,0]},{type:"componentDynamic",position:[1,1,1,3]},{type:"text",position:[1,1,1,5,0]},{type:"componentDynamic",position:[1,1,1,5]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1,1,5,1]},{type:"attr",position:[1,1,7]},{type:"if",position:[1,1,7],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,9,1]},{type:"attr",position:[1,1,9,1,1]},{type:"if",position:[1,1,9,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","data.$colour_code"]}}}}]}},default:{}},{type:"text",position:[1,3]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[4]},{type:"if",position:[4],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","data.$colour_code"]}}}}]}},default:{}},{type:"text",position:[3,0]}]}},default:{}},{type:"attr",position:[1,1,9,1,2]},{type:"if",position:[1,1,9,1,2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[1,1,9,3]},{type:"for",position:[1,1,9,3],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"attr",position:[3]},{type:"text",position:[3,1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1,1]},{type:"text",position:[1,3,1,1,0]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5,1]},{type:"if",position:[1,5,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1,1,3,1]},{type:"attr",position:[1,1,5]},{type:"if",position:[1,1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,7,1]},{type:"attr",position:[1,1,7,1,1]},{type:"if",position:[1,1,7,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","data.$colour_code"]}}}}]}},default:{}},{type:"text",position:[1,3]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","data.$colour_code"]}}}}]}},default:{}},{type:"text",position:[3,0]}]}},default:{}},{type:"attr",position:[1,1,7,1,3]},{type:"if",position:[1,1,7,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[1,1,7,3]},{type:"for",position:[1,1,7,3],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[3]},{type:"text",position:[3,1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1,1]},{type:"text",position:[1,3,1,1,0]},{type:"componentDynamic",position:[1,3]},{type:"text",position:[1,5,1]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1,1,5,1]},{type:"attr",position:[1,1,7]},{type:"if",position:[1,1,7],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,9,1]},{type:"attr",position:[1,1,9,1,1]},{type:"if",position:[1,1,9,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","data.$colour_code"]}}}}]}},default:{}},{type:"text",position:[1,3]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","data.$colour_code"]}}}}]}},default:{}},{type:"attr",position:[3,1]},{type:"text",position:[3,1,0]}]}},default:{}},{type:"attr",position:[1,1,9,3]},{type:"for",position:[1,1,9,3],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[3]},{type:"text",position:[3,1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1,1]},{type:"text",position:[1,3,1,1,0]},{type:"componentDynamic",position:[1,3]},{type:"text",position:[1,5,1]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,1,5,1]},{type:"attr",position:[1,1,7,1]},{type:"attr",position:[1,1,7,1,1]},{type:"if",position:[1,1,7,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,7,1,3]},{type:"if",position:[1,1,7,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","data.$colour_code"]}}}}]}},default:{}},{type:"text",position:[1,3]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '","data.$colour_code"]}}}}]}},default:{}},{type:"attr",position:[3,1]},{type:"text",position:[3,1,0]}]}},default:{}},{type:"attr",position:[1,1,7,3]},{type:"for",position:[1,1,7,3],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[3]},{type:"text",position:[3,1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1,1]},{type:"text",position:[1,3,1,1,0]},{type:"componentDynamic",position:[1,3]},{type:"text",position:[1,5,1]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,3,1]},{type:"text",position:[1,3,5]},{type:"attr",position:[1,5]}]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"attr",position:[1,5]},{type:"registerYield",position:[1,5,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1]},{type:"attr",position:[3]},{type:"text",position:[3,1,1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1]},{type:"attr",position:[3]},{type:"text",position:[3,1,1]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,3]},{type:"attr",position:[1,1,3,1]},{type:"text",position:[1,1,3,1,1]},{type:"attr",position:[1,1,5]},{type:"attr",position:[1,1,5,1]},{type:"text",position:[1,1,5,1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}],_templateAttributes:{type:"attr",position:[]},_observedAttributes:["record_data","field_data","related_list","current_rl_data","info","entity_id","canvas","rel_module","curRecMod","layout_id","list_relation_id","activity_type","task_fields","calls_fields","events_fields","popoverOrigin","personality","process_flow","approved","appointment_fields","isDataEmpty","isprintview","activity_id","subject","showpopover","ownerFields","dateformat","dateFields","startIndex","pageRequested","pageNo","relatedListCount","showNavig","moreRecords","relatedListNavigData","showLoading","excludeFields","appEndTime","per_page","module_name","relatedListData","nextpagerelcount","txt_ln","is_field_api_success","isPermissionDenied","hasEditPermissionForApp","isAppCompleteAction","isPageLimitReached","isnextNavAction","hasCompletePermissionForTask","sortOrder","permittedModules","totalRelCount","availableDataModules","parent_relation_name","parent_related_lists","inner_field_data","isFieldRequest","activitiesPersonalities","idselector","service_id","leftRelId","fromNewDetail"],data:function(){return{record_data:Lyte.attr("array"),field_data:Lyte.attr("array"),related_list:Lyte.attr("object"),current_rl_data:Lyte.attr("object"),info:Lyte.attr("object"),entity_id:Lyte.attr("string"),canvas:Lyte.attr("boolean",{default:!1}),rel_module:Lyte.attr("string"),curRecMod:Lyte.attr("string"),layout_id:Lyte.attr("string"),list_relation_id:Lyte.attr("string"),activity_type:Lyte.attr("string"),task_fields:Lyte.attr("array"),calls_fields:Lyte.attr("array"),events_fields:Lyte.attr("array"),popoverOrigin:Lyte.attr("string"),personality:Lyte.attr("string"),process_flow:Lyte.attr("boolean",{default:!1}),approved:Lyte.attr("boolean",{default:!0}),appointment_fields:Lyte.attr("array"),isDataEmpty:Lyte.attr("boolean",{default:!1}),isprintview:Lyte.attr("boolean",{default:!1}),activity_id:Lyte.attr("string"),subject:Lyte.attr("string"),showpopover:Lyte.attr("boolean",{default:!1}),ownerFields:Lyte.attr("object"),dateformat:Lyte.attr("string"),dateFields:Lyte.attr("object"),startIndex:Lyte.attr("number",{default:0}),pageRequested:Lyte.attr("array",{default:[]}),pageNo:Lyte.attr("number",{default:1}),relatedListCount:Lyte.attr("string"),showNavig:Lyte.attr("boolean",{default:!1}),moreRecords:Lyte.attr("boolean",{default:!0}),relatedListNavigData:Lyte.attr("array",{default:[]}),showLoading:Lyte.attr("boolean",{default:!0}),excludeFields:Lyte.attr("array"),appEndTime:Lyte.attr("string"),per_page:Lyte.attr("number",{default:10}),module_name:Lyte.attr("string"),relatedListData:Lyte.attr("object"),nextpagerelcount:Lyte.attr("number"),txt_ln:Lyte.attr("number",{default:80}),is_field_api_success:Lyte.attr("boolean",{default:!1}),isPermissionDenied:Lyte.attr("boolean",{default:!1}),hasEditPermissionForApp:Lyte.attr("boolean",{default:!Crm.userDetails.permissions||Crm.userDetails.permissions.Crm_Implied_Edit_Appointments}),isAppCompleteAction:Lyte.attr("boolean",{default:!0}),isPageLimitReached:Lyte.attr("boolean",{default:!1}),isnextNavAction:Lyte.attr("boolean",{default:!1}),hasCompletePermissionForTask:Lyte.attr("boolean",{default:!0}),sortOrder:Lyte.attr("string"),permittedModules:Lyte.attr("array"),totalRelCount:Lyte.attr("number"),availableDataModules:Lyte.attr("array"),parent_relation_name:Lyte.attr("string"),parent_related_lists:Lyte.attr("array"),inner_field_data:Lyte.attr("string",{default:"fields.data_type,fields.ui_type,fields.lookup,fields.formula,fields.field_label,fields.pick_list_values,fields.separator"}),isFieldRequest:Lyte.attr("boolean",{default:!1}),activitiesPersonalities:Lyte.attr("array"),idselector:Lyte.attr("string"),service_id:Lyte.attr("string",{default:""}),leftRelId:Lyte.attr("string"),fromNewDetail:Lyte.attr("boolean")}},init:function(){this.setActivitiesPersonalities(),this.setRelatedListObj()},setModuleFields:function(t){this.setData("excludeFields",["Subject","Event_Title","Appointment_Name","Due_Date","Owner","Start_DateTime","End_DateTime","All_day","Call_Start_Time","Appointment_Start_Time","Member","$process_flow","$approved","$approval_state","$in_project_sync","$se_module","$colour_code"]),this.setData("parent_related_lists",t.related_list[0].parent_related_lists);let e,a,i,o,s=t.related_list[0].fields,n=[],l=[],r=[],p=[],d={},c={};var m=0;let u=s.length;for(;m<u;m++){let t=s[m].api_name.slice(1,s[m].api_name.indexOf("."));if("8"===s[m].ui_type){let e=s[m],a=e.id;e.data_type=this.getDataTypeForFields(a,t,e),d[e.api_name.substring(0,e.api_name.indexOf(".")+1)]=s[m]}else if("Due_Date"===s[m].api_name||"Call_Start_Time"===s[m].api_name||"End_DateTime"===s[m].api_name||"Start_DateTime"===s[m].api_name){let t=s[m];c[t.api_name.substring(0,t.api_name.indexOf(".")+1)]=s[m]}else if(s[m].api_name.indexOf("!Tasks.")>-1){let a=s[m],i=this.getApiName(a);if(a.api_name=i,"Subject"!==i){let e=a.id;a.data_type=this.getDataTypeForFields(e,t,a)}"Description"===i?e=a:n.push(a)}else if(s[m].api_name.indexOf("!Events.")>-1){let e=s[m],a=this.getApiName(e);if(e.api_name=a,"Event_Title"!==a){let a=e.id;e.data_type=this.getDataTypeForFields(a,t,e)}"Description"===a?i=e:r.push(e)}else if(s[m].api_name.indexOf("!Calls.")>-1){let e=s[m],i=this.getApiName(e);if(e.api_name=i,"Subject"!==i){let a=e.id;e.data_type=this.getDataTypeForFields(a,t,e)}"Description"===i?a=e:l.push(e)}else if(s[m].api_name.indexOf("!Appointments__s.")>-1){let e=s[m],a=this.getApiName(e);if(e.api_name=a,"Appointment_Name"!==a){let a=e.id;e.data_type=this.getDataTypeForFields(a,t,e)}"Description"===a?o=e:p.push(e)}}void 0!==e&&n.push(e),void 0!==i&&r.push(i),void 0!==a&&l.push(a),void 0!==o&&p.push(o),this.setData("task_fields",n),this.setData("events_fields",r),this.setData("calls_fields",l),this.setData("appointment_fields",p),this.setData("ownerFields",d),this.setData("dateFields",c)},getApiName:function(t){return t.api_name.substring(t.api_name.indexOf(".")+1,t.api_name.length)},setRelatedListObj:function(){var t=this;store.findAll("related_list",{module:moduleRecordMapping[t.getData("rel_module")].api_name,layout_id:t.getData("layout_id")},!1,void 0,{from:"Chronological"}).then((function(e){e.forEach((e=>{("Activities"===t.getData("parent_relation_name")&&"Activities_Chronological_View"===e.api_name||"Activities_History"===t.getData("parent_relation_name")&&"Activities_Chronological_View_History"===e.api_name)&&t.setData("relatedListData",e)})),t.renderChronologicalComponent()}))},renderChronologicalComponent:function(){let t=this;if(this.data.pageRequested.contains(this.data.pageNo)&&this.getData("isFieldRequest"))return;t.setData("sortOrder","open"===t.getData("activity_type")?"asc":"desc"),t.refreshFields(t.getData("permittedModules"));let e=t.getData("relatedListData");this.setData("showNavig",!1);let a={from:"Chronological"},i={relatedId:t.getData("entity_id"),relationId:e.id,type:"grouped",approval_state:"approved,approval_process_pending,approval_process_rejected",approved:"both",per_page:t.getData("per_page"),page:1},o=moduleRecordMapping[t.getData("rel_module")].id,s=t.getData("layout_id");Lyte.resolvePromises({fields:store.findRecord("related_list",e.id,{module:moduleRecordMapping[t.getData("rel_module")].api_name,layout_id:s,type:"grouped",include_inner_details:t.getData("inner_field_data")},!1,!1,a),datas:store.findAll(o,i,!1,!1,a)}).then((function(e){t.resetAllFields(t),t.setData("showLoading",!1),0===e.datas[moduleRecordMapping[t.getData("rel_module")].id].length?(t.setData("isDataEmpty",!0),t.setData("showNavig",!1)):(Crm.userDetails.isRelatedListLyteEnabled&&t.setData("isDataEmpty",!1),t.setModuleFields(e.fields),Lyte.arrayUtils(t.data.relatedListNavigData,"push",e.datas[moduleRecordMapping[t.getData("rel_module")].id]),t.getData("isFieldRequest")||Lyte.arrayUtils(t.data.pageRequested,"push",t.getData("pageNo")),t.setData("relatedListCount",t.getData("record_data").length)),t.setRelatedListData(),t.setDataForNavig(e,!1)})).catch((function(e){t.setData("showLoading",!1),t.setData("isPermissionDenied",!0),renderingUtils.displayPermissionDenied(e)}))},fireFieldRequest:function(t){store.findRecord("related_list",this.getData("relatedListData").id,{module:moduleRecordMapping[t.getData("rel_module")].api_name,layout_id:t.getData("layout_id"),type:"grouped",include_inner_details:t.getData("inner_field_data")},!1,!1,{from:"Chronological"}).then((function(e){t.setModuleFields(e)}))},fireRequest:function(t){if(0!==t.getData("record_data").length){let e=t.getData("relatedListData");t.setData("isFieldRequest",!1);let a={relatedId:t.getData("entity_id"),relationId:e.id,type:"grouped",approval_state:"approved,approval_process_pending,approval_process_rejected",approved:"both"},i=moduleRecordMapping[t.getData("rel_module")].id,o={from:"Chronological"};t.data.info.next_page_token?a.page_token=t.data.info.next_page_token:(a.per_page=t.data.per_page,a.pageNo=t.data.pageNo),store.findAll(i,a,!1,!1,o).then((function(e){t.setData("showLoading",!1),e?(Lyte.arrayUtils(t.data.relatedListNavigData,"push",e[i]),t.getData("isFieldRequest")||Lyte.arrayUtils(t.data.pageRequested,"push",t.getData("pageNo")),t.setRelatedListData(),t.setDataForNavig(e,!0)):t.setData("isDataEmpty",!0)})).catch((function(e){t.setData("showLoading",!1),t.setData("isPermissionDenied",!0),renderingUtils.displayPermissionDenied(e)}))}else t.setData("showLoading",!1),t.setData("isDataEmpty",!0)},setDataForNavig:function(t,e){if(void 0!==t){let a=e?t.info:t.datas.info;this.setData("info",a),a.more_records?(this.setData("nextpagerelcount",this.data.relatedListNavigData.length+1),this.data.nextpagerelcount>10&&this.setData("showNavig",!0)):(this.setData("moreRecords",a.more_records),this.setData("nextpagerelcount",this.data.relatedListNavigData.length)),this.populateRLCountForActivities()}},resetAllFields:function(t){t.setData("record_data",[]),t.setData("field_data",[]),t.setData("showLoading",!0),t.setData("appointmentArrFields",[]),t.setData("eventsArrFields",[]),t.setData("taskArrFields",[]),t.setData("callsArrFields",[]),t.setData("relatedListNavigData",[]),t.setData("pageRequested",[]),t.setData("startIndex",0),t.setData("pageNo",1),t.setData("relatedListCount",""),t.setData("per_page",10),t.setData("nextpagerelcount",t.data.relatedListNavigData.length)},populateRLCountForActivities:function(){try{var t=0;if(this.data.canvas){let o=this.getData("info").more_records;t=t+(this.data.info.page-1)*this.data.info.per_page+this.data.info.count;var e=$L("#RL_dataCount_"+this.getData("parent_relation_id")),a=$L(".numCountn");if(t>0){var i=o?t+"+":t;e.text(i),a.addClass("actSplitCount")}else e.hide(),a.hide()}else{let e=this.getData("info").more_records;t=t+(this.data.info.page-1)*this.data.info.per_page+this.data.info.count;let a=$L("#newleft_"+this.getData("leftRelId")).find(".numCountn").addClass("numCountVal"),i=$L("#chronoview_"+this.data.parent_relation_name+"_split").find(".numCountn").addClass("actSplitCount");var o=this.getData("parent_relation_name");t>0?(t=e?t+"+":t,i.text(t),a.text(t),Crm.userDetails.isRelatedListLyteEnabled&&(a.css("display",""),i.css("display",""),this.getData("fullPageLyteRender")&&(this.removeRelatedListCountKey(this.getData("rlIdVsCount"),this.getData("navItems")),Lyte.triggerEvent("activityRelatedListCountDetail",{count:t,relation_name:o,has_more:!0})))):(Crm.userDetails.isRelatedListLyteEnabled?Lyte.triggerEvent("activityRelatedListCountDetail",{count:0,relation_name:o,has_more:!1}):a.hide(),i.hide())}}catch(t){murphy.error(t)}},setRelatedListData:function(){if(this.setData("startIndex",10*(this.data.pageNo-1)),this.getData("relatedListNavigData").length){this.data.canvas&&this.setAvailableDataModule(this.getData("relatedListNavigData"));let t=this.getData("relatedListNavigData").slice(this.getData("startIndex"),this.getData("startIndex")+10);this.setData("record_data",[]),this.setData("record_data",t),this.setData("relatedListCount",t.length),t.length>0&&this.setData("isDataEmpty",!1)}},setAvailableDataModule:function(t){let e=[],a=store.peekAll("related_list");t.length>0&&t.forEach((t=>{e.contains(t.$module)||e.push(t.$module)})),this.setData("availableDataModules",e);var i={};e.forEach((t=>{let e=this.data.parent_related_lists.filter((function(e){return e.api_name.includes(t)})),o=a.filterBy({id:e[0].id})[0];var s={};s.module=o.module.api_name,s.zcqa="customize_"+s.module,s.personality=o.personality_name,s.label="Events"===o.module.api_name?"Meetings":o.module.api_name.includes("Appointments")?"Appointments":o.module.api_name,s.parentid=o.id,s.relatedList=o,i[o.module.api_name]=s}));var o=[],s=$L("crm-activity-rel-customize");let n="Activities"===this.getData("parent_relation_name")?"open":"close";i&&(i.Tasks&&o.push(i.Tasks),i.Events&&o.push(i.Events),i.Calls&&o.push(i.Calls),i.Appointments__s&&o.push(i.Appointments__s),s="open"===n?"openActivities"===s[0].component.getData("btn_name")?s[0].component:s[1].component:"closedActivities"===s[0].component.getData("btn_name")?s[0].component:s[1].component),s.setData({data:o})},getDataTypeForFields:function(t,e,a){let i=store.peekRecord("field",t,{module:e});return!i&&a.data_type?a.data_type:i.data_type},refreshFields(t){var e=this;t.forEach((t=>{store.peekRecord("module",moduleRecordMapping[e.getModuleName(t)].id).fields||store.findRecord("module",moduleRecordMapping[e.getModuleName(t)].id,void 0,!1,void 0,{from:"Chronological"})}))},setActivitiesPersonalities:function(){let t="open"===this.getData("activity_type")?["TASKSPERSONALITY","EVENTSPERSONALITY","CALLSPERSONALITY","APPOINTMENTSPERSONALITY"]:["TASKSHISTORYPERSONALITY","CALLSHISTORYPERSONALITY","EVENTSHISTORYPERSONALITY","APPOINTMENTSHISTORYPERSONALITY"];this.setData("activitiesPersonalities",t);let e=moduleApiMapping[this.getData("rel_module")];var a=[];t.forEach((t=>{let i=store.peekAll("related_list").filter((function(a){return a.personality_name===t&&a.href.startsWith(e)}));i&&i[0]&&a.push(i[0].id)}));let i=$L("#lp_rellist").children(),o=i.length;for(var s=0;s<o;s++){let t=i[s];if(t){let e=$L(t)[0].getAttribute("id");if(e=e.substring(e.indexOf("_")+1,e.length),a.includes(e)){this.setData("leftRelId",e);break}}}},actions:{showUserTooltip:function(t,e){var a="relatedList_"+e+"_Activities_owner";this.showUserToolPopup(t,a)},readMoreDesc:function(t){this.readMore(t)},hideUserTooltip:function(){this.$node.querySelector("#activities_addons_user_tooltip").component.hide()},showHideRelatedFields:function(t,e,a,i){if("mouseout"===i.type)return crmui.hideTooltip(),!0;var o={},s=$L(i.target);"Who_Id"===e?o.module="Contacts":"Service_Name"===e?o.module="Services":store.peekAll("module").forEach((function(t){t.api_name===a&&(o.module=t.module_name)})),o.id=t.id,crmLookupBusinessCard.showingSide="showOnRight",renderingUtils.windowWidth/2<s.offset().left&&(crmLookupBusinessCard.showingSide="showOnLeft"),s.offset().left<400&&s[0].getBoundingClientRect().right>renderingUtils.windowWidth-400&&(crmLookupBusinessCard.showingSide="showOnBottom"),o&&o.module&&o.id&&setTimeout((function(){s.is(":hover")&&crmLookupBusinessCard.getRecordJSon(o.module,o.id,s)}),250)},handleRefresh:function(t){if(!this.getData("canvas")&&!this.getData("fromNewDetail")&&this.getData("parent_relation_name")!==t.parent_relation_name&&!Lyte.Globals.get("relatedList.oldAppointments"))return;t.refreshTemplate&&t.id&&(this.setData("isFieldRequest",!0),this.fireFieldRequest(this));let e=!1,a=!!t.callActivity&&t.callActivity;if(t.refresh)e=!0;else if(t.res&&!a){var i="object"==typeof t.res?t.res:JSON.parse(t.res);i&&i[this.data.rel_module]&&(this.getData("canvas")||this.getData("fromNewDetail"))&&(e=!0)}else a&&(e=!0);e&&(this.setData("isFieldRequest",!1),this.setRelatedListObj())},showMoreOptions:function(t,e,a){var i=t.Event_Title?t.Event_Title:t.Appointment_Name?t.Appointment_Name:t.Subject;if($L(e).closest(".choroViewTd").eq(0).addClass("aspActiveList"),this.setData("personality",a),this.setData("curRecMod",t.$module),this.setData("current_rl_data",t),this.setData("popoverOrigin","#act_split_origin_"+t.id),this.setData("process_flow",t.$process_flow),this.setData("approved",t.$approved),this.setData("approval_state",t.$approval_state),this.setData("activity_id",t.id),this.setData("subject",i),this.setData("showpopover",!0),t.Status&&"Scheduled"===t.Status){var o=this;store.findAll("servapp_preferences",{},!1,!0,{module:"Appointments"}).then((function(t){t&&t.length&&o.setData("isAppCompleteAction","mark_as_complete"!==t[0].appointments.when_duration_exceeds)}))}else t.Status&&"Overdue"===t.Status&&this.setData("isAppCompleteAction",!0);"Appointments"===t.$module&&(this.setData("service_id",t.Service_Name.id),this.setData("appEndTime",t.Appointment_End_Time))},clickAction:function(t,e,a,i){this.showClickAction(t,e,a,i,!0)},hidePopOver:function(){this.setData("showpopover",!1)},callAction:function(t,e){this.showCallAction(t,e)},showAppPopup:function(t,e,a,i){this.showAppointmentPopup(t,e,a,i)}},methods:{navigNext:function(){this.setData("isnextNavAction",!0),this.setData("pageNo",this.getData("pageNo")+1),this.data.pageNo>200?this.setData("isPageLimitReached",!0):this.data.pageRequested.contains(this.data.pageNo)?this.setRelatedListData():this.fireRequest(this)},navigPrevious:function(){this.setData("pageNo",this.getData("pageNo")-1),this.setRelatedListData()},closePopup:function(t,e){$L(".aspActiveList").removeClass("aspActiveList"),setTimeout((function(){e.setData("ltPropBindToBody",!1)}),1)}}},{mixins:["crm-activity-mixin","crm-related-list-utils"]}),Lyte.Mixin.register("crm-activity-mixin",{readMore:function(t){commonUtils.showHideLoadingDiv(!0);var e=t.id;$L("#"+e+"_old").text($("#"+t.id).attr("value")),$L("#"+e).hide(),commonUtils.showHideLoadingDiv(!1)},showAppointmentPopup:function(t,e,a,i){a=i?i.Appointment_End_Time:void 0,this.setData("showpopover",!1),Lyte.resolvePromises({filesResolved:Lyte.injectResources(networkUtils.returnDependencyFiles(["zohocrm_services.js"],ResourceConstants.CRM).concat(networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("businesshours")],ResourceConstants.CRM)))}).then((function(){Lyte.registeredMixins["crm-appointments-mixin"].setAppointmentStatusActions(t,e,a),$L("#Calendar").hide()}))},showUserToolPopup:function(t,e){var a=this.$node.querySelector("#"+e),i=this.$node.querySelector("#activities_addons_user_tooltip");i&&(i.component.setData("userId",t),i.component.show(a))},showCallAction:function(t,e){this.setData("showpopover",!1),e?Crm.fetchCallDetails(t,e.id,"relatedList",!0):Crm.fetchCallDetails(t,this.getData("activity_id"),"relatedList",!0),closeMultipleReminderBussinesscardView(),this.stopPropagation(event)},showClickAction:function(t,e,a,i,o){if("TASKSPERSONALITY"===i){var s=store.peekAll("field"),n=this.setTasksClosePermission(s);this.setData("hasCompletePermissionForTask",n)}this.showClickAct(t,e,a,i,o)},showClickAct:function(t,e,a,i,o){i?this.setData("personality",i):i=this.getData("personality");var s=o?Lyte.Component.registeredHelpers.getChronologicalActivityActionLink:Lyte.Component.registeredHelpers.getActivityActionLink;if(a){this.setData("activity_id",a.id);var n=s(t,this,a.id,a,i)}else n=s(t,this);"delete"!==t?Crm.userDetails.isRelatedListLyteEnabled?this.sortRelatedList(n,null,this.getData("activity_id"),this):sortRelatedList(n,null,this.getData("activity_id"),this):showDeletePopup(this.getData("activity_id"),"crm.button.move.to.trash","","",e,"rl","","",this.getData("subject"),void 0,void 0,"deleteAction"),this.setData("showpopover",!1)},getModuleName:function(t){var e;return t.includes("Tasks")?e="Tasks":t.includes("Calls")?e="Calls":t.includes("Events")?e="Events":t.includes("Appointments")&&(e="Appointments"),e},disableActBanner:function(){if("Activities"===this.getData("module")){let t=$L("#aspDepricateBanner");"customCheckBox"===$L("#selectCheckbox")[0].ltProp("class")?t.css("display","flex"):t.css("display","none")}},stopPropagation:function(t){if(!t)t=window.event;t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()},setTasksClosePermission:function(t){var e=!0;return t&&t.forEach((t=>{"Status"===t.api_name&&t.module&&t.module[0]&&"Tasks"===t.module[0].api_name&&(e=!!t.visible&&!t.read_only)})),e},removeRelatedListCountKey:function(t,e){if(Crm.userDetails.isDVLyteRLCountQueryEnabled&&t&&Object.values(t).length)for(let a of e)Lyte.objectUtils(t,"delete",a.id)},replaceDataInRecordContainer:function(t,e,a,i){var o=this;t||(t=o.data.recordId),store.findRecord(moduleRecordMapping[e].id,t).then((function(t){t=t[0],Object.assign(t,t._$.original),i&&(a=i(t)),delete t.date,o.replaceDataInRecordsContainer.bind(o)(t,e,a)}))},completeActivityCallback:function(t){if(this){let e=this,a=e.data.recordId,i=e.getData("recordHeader");e.deleteRecordFromContainer.bind(e)(i,a,t)}}}),Lyte.Component.register("crm-zia-call-analytics",{_template:'<template tag-name="crm-zia-call-analytics"> <div class="dB crm-font-regular"> <template is="if" value="{{expHandlers(isPopUp,\'!\')}}"><template case="true"><div class="w100_per dIB crm-font-bold crm-subheading-font-size"> <div class="dIB ziaIc32x24 vaM"> <crmutil-icon icon-name="zia-logo" icon-class="zcicn-zia-logo zcicn_4a8de9 "></crmutil-icon> </div> <div class="dIB vaM mL10 crmHeadingColor"> <template is="if" value="{{expHandlers(isEnableCallTranscription,\'&amp;&amp;\',isEnableCallIntelligence)}}"><template case="true"> {{getI18n(\'crm.user.hierarchy.role.two\',\'crm.setup.system.ziacalltranscription\',\'crm.setup.system.ziacallanalytics\')}} </template><template case="false"><template is="if" value="{{isEnableCallTranscription}}"><template case="true"> {{getI18n(\'crm.setup.system.ziacalltranscription\')}} </template><template case="false"> {{getI18n(\'crm.setup.system.ziacallanalytics\')}} </template></template></template></template> </div> </div></template></template> <template is="if" value="{{isPopUp}}"><template case="true"><div class="callAnalyticsBox p15 boxBB w100_per dIB"> <div class="dF aiCenter"> <div class="dIB"> <div class="aiCenter dF jcCenter ziaCallTransOutGoingIcon"> <crmutil-icon icon-name="call-outgoing" icon-class="zcicn-call-outgoing zcicn-color-plain "></crmutil-icon> </div> </div> <div class="dIB mL10 ziaCallTransOutGoingIconContent"> <div class="crmHeadingColor crm-base-font-size">{{getValueRemoveSubject(callAnalyticsData.Subject,true)}} <b>{{getValueRemoveSubject(callAnalyticsData.Subject,false)}}</b></div> <div class="dB mT10"> <div class="dIB vaM"> <img class="dIB vaM cTuserImg" src="{{getUserImageUrl(callAnalyticsData.Owner.id)}}" alt="userImg"> </div> <div class="dIB vaM mL5 crmParagraphColor ziaCallAnalyticsUserComponentWidth"> {{getI18n(\'zia.call.analytics.attention.dec\',callAnalyticsData.Owner.name,convertISODatetoUserDatePattern(callAnalyticsData.Call_Start_Time),getTimeInUserFormat(callAnalyticsData.Call_Start_Time))}} </div> </div> </div> </div> </div></template></template> <template is="if" value="{{expHandlers(enableLoading,\'!\')}}"><template case="true"><div class="dB mT20"> <template is="if" value="{{expHandlers(isEnableLyte,\'&amp;&amp;\',isEnableCallTranscription)}}"><template case="true"><div class="w100_per dIB vaM mB15"> <div class="dIB vaM crmLabelColor crm-base-font-size alignRight w100 mB5 cLWidthFix" data-zcqa="call_transcription"> <div class="dF ziaFlexRev"> <div class="dIB mT10"> {{getI18n(\'crm.setup.system.ziacalltranscription\')}}</div> </div> </div> <div class="dIB vaT crmBaseColor mL15 crm-base-font-size cIWidthFix" data-zcqa="dataValTranscription"> <crm-zia-call-transcription activity-id="{{entityId}}"></crm-zia-call-transcription> </div> </div></template></template> <template items="{{ziaCallAnalyticsConfigs}}" item="configRec" index="index" is="for"><template is="if" value="{{expHandlers(expHandlers(expHandlers(configRec.type,\'!==\',\'call_analytics\'),\'&amp;&amp;\',configRec.enabled),\'&amp;&amp;\',callAnalyticsData.callAnalyticsData[configRec.sys_name])}}"><template case="true"><div class="w100_per dIB vaM mB15"> <div class="dIB vaM crmLabelColor crm-base-font-size alignRight w100 mB5 cLWidthFix" data-zcqa="{{configRec.sys_name}}"> <div class="dF ziaFlexRev"> <template is="if" value="{{expHandlers(expHandlers(configRec.sys_name,\'===\',\'satisfaction_score\'),\'||\',expHandlers(configRec.sys_name,\'===\',\'politeness_score\'))}}"><template case="true"> <div class="mT2 mL5" data-zcqa="zsrTooltip" lt-prop-tooltip-class="ziaScoreTooltipBgColor alignLeft br6 lh20 crmBaseColor" lt-prop-title="{{getI18n(\'zia.call.analytics.score.tooltip\')}}"> <crmutil-icon icon-name="info-solid" icon-class="zcicn-info-solid zcicn_grey"></crmutil-icon> </div> </template></template> <div class="dIB"> {{configRec.label}} </div> </div> </div> <template is="if" value="{{expHandlers(expHandlers(configRec.type,\'!==\',\'call_competitors\'),\'&amp;&amp;\',expHandlers(configRec.type,\'!==\',\'call_keywords\'))}}"><template case="true"><div class="dIB vaT crmBaseColor mL15 crm-base-font-size cIWidthFix" data-zcqa="dataVal{{configRec.sys_name}}"> {{callAnalyticsData.callAnalyticsData[configRec.sys_name]}} </div></template></template> <template is="if" value="{{expHandlers(configRec.type,\'===\',\'call_competitors\')}}"><template case="true"><div class="dIB vaT crmBaseColor mL15 crm-base-font-size cIWidthFix"> <template items="{{callAnalyticsData.callAnalyticsData.competitors}}" item="competitor" index="index" is="for"><template is="if" value="{{expHandlers(index,\'<\',5)}}"><template case="true"><span> <template is="if" value="{{expHandlers(index,\'!==\',0)}}"><template case="true"><span>,</span></template></template> {{competitor.name}} </span></template></template></template> <template is="if" value="{{moreTextLen(callAnalyticsData.callAnalyticsData.competitors)}}"><template case="true"><div class="dIB ziaCallLinkTag crmLabelColor vaM crm-base-font-size cP mR5 " id="call_competitors_more" onclick="{{action(\'moreOption\',configRec)}}"> {{moreText(callAnalyticsData.callAnalyticsData.competitors)}} </div></template></template> </div></template></template> <template is="if" value="{{expHandlers(configRec.type,\'===\',\'call_keywords\')}}"><template case="true"><div class="dIB vaT crmBaseColor mL15 crm-base-font-size cIWidthFix"> <template items="{{callAnalyticsData.callAnalyticsData.keywords}}" item="keyword" index="index" is="for"><template is="if" value="{{expHandlers(index,\'<\',5)}}"><template case="true"><div class="ziaCallAnalyticsBoxTag dIB vaT crm-base-font-size {{if(ifEquals(keyword.sentiment,\'Positive\'),\'callAnalyticsGreenTag\',if(ifEquals(keyword.sentiment,\'Neutral\'),\'callAnalyticsOrangeTag\',\'callAnalyticsRedTag\'))}} mR5 mB5 lh14"> {{keyword.value}} </div></template></template></template> <template is="if" value="{{moreTextLen(callAnalyticsData.callAnalyticsData.keywords)}}"><template case="true"><div class="ziaCallLinkTag crmLabelColor dIB vaM crm-extra-medium-font-size {{if(isPopUp,\'\',\'cP\')}} mR5 " id="call_keywords_more" onclick="{{action(\'moreOption\',configRec)}}"> {{moreText(callAnalyticsData.callAnalyticsData.keywords)}} </div></template></template> </div></template></template> </div></template></template></template> </div></template></template> <template is="if" value="{{enableLoading}}"><template case="true"><div class="dB mT20"> <div class="waverecommendation pR aligncenter mT15 mB10"> <div class="dIB mR10 crmLabelColor crm-font-regular">{{getI18n(\'crm.load\')}}</div> <span class="zvoice-dot"></span> <span class="zvoice-dot"></span> <span class="zvoice-dot"></span> </div> </div></template></template> </div> <lyte-popover lt-prop-show="{{showMore}}" lt-prop-origin-elem="#{{orginElem}}" lt-prop-max-width="500px"> <template is="registerYield" yield-name="popover"> <lyte-popover-header> {{configRecLabel}} </lyte-popover-header> <lyte-popover-content> <template is="if" value="{{expHandlers(configRecType,\'===\',\'call_keywords\')}}"><template case="true"><div class="dIB vaM crmBaseColor crm-base-font-size"> <template items="{{callAnalyticsData.callAnalyticsData.keywords}}" item="keyword" index="index" is="for"><template is="if" value="{{expHandlers(index,\'>=\',5)}}"><template case="true"><div class="ziaCallAnalyticsBoxTag dIB vaM crm-base-font-size {{if(ifEquals(keyword.sentiment,\'Positive\'),\'callAnalyticsGreenTag\',if(ifEquals(keyword.sentiment,\'Neutral\'),\'callAnalyticsOrangeTag\',\'callAnalyticsRedTag\'))}} mR5 mB5"> {{keyword.value}} </div></template></template></template> </div></template></template> <template is="if" value="{{expHandlers(configRecType,\'===\',\'call_competitors\')}}"><template case="true"><div class="dIB vaM crmBaseColor mL15 crm-base-font-size ziaShowMorePopRemWidth"> <template items="{{callAnalyticsData.callAnalyticsData.competitors}}" item="competitor" index="index" is="for"><template is="if" value="{{expHandlers(index,\'>=\',5)}}"><template case="true"><span> <template is="if" value="{{expHandlers(index,\'!==\',5)}}"><template case="true"><span>,</span></template></template> {{competitor.name}} </span></template></template></template> </div></template></template> </lyte-popover-content> </template> </lyte-popover> </template>',_dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[0,1,1]},{type:"attr",position:[0,3,1]},{type:"if",position:[0,3,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"componentDynamic",position:[0,1,1,1,1]},{type:"text",position:[0,1,3,1,0]},{type:"text",position:[0,1,3,1,2,0]},{type:"attr",position:[0,1,3,3,1,1]},{type:"text",position:[0,1,3,3,3,1]}]}},default:{}},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[0,1]},{type:"if",position:[0,1],cases:{true:{dynamicNodes:[{type:"text",position:[0,1,1,1,1]},{type:"attr",position:[0,3,1]},{type:"componentDynamic",position:[0,3,1]}]}},default:{}},{type:"attr",position:[0,3]},{type:"for",position:[0,3],dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0,1]},{type:"attr",position:[0,1,1,1]},{type:"if",position:[0,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"text",position:[0,1,1,3,1]},{type:"attr",position:[0,3]},{type:"if",position:[0,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"text",position:[0,1]}]}},default:{}},{type:"attr",position:[0,5]},{type:"if",position:[0,5],cases:{true:{dynamicNodes:[{type:"attr",position:[0,1]},{type:"for",position:[0,1],dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0,1]},{type:"if",position:[0,1],cases:{true:{dynamicNodes:[]}},default:{}},{type:"text",position:[0,3]}]}},default:{}}]},{type:"attr",position:[0,3]},{type:"if",position:[0,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"text",position:[0,1]}]}},default:{}}]}},default:{}},{type:"attr",position:[0,7]},{type:"if",position:[0,7],cases:{true:{dynamicNodes:[{type:"attr",position:[0,1]},{type:"for",position:[0,1],dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"text",position:[0,1]}]}},default:{}}]},{type:"attr",position:[0,3]},{type:"if",position:[0,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"text",position:[0,1]}]}},default:{}}]}},default:{}}]}},default:{}}]}]}},default:{}},{type:"attr",position:[1,7]},{type:"if",position:[1,7],cases:{true:{dynamicNodes:[{type:"text",position:[0,1,1,0]}]}},default:{}},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0,1]},{type:"for",position:[0,1],dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"text",position:[0,1]}]}},default:{}}]}]}},default:{}},{type:"attr",position:[3,3]},{type:"if",position:[3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0,1]},{type:"for",position:[0,1],dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0,1]},{type:"if",position:[0,1],cases:{true:{dynamicNodes:[]}},default:{}},{type:"text",position:[0,3]}]}},default:{}}]}]}},default:{}},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[3]}],_observedAttributes:["isPopUp","showMore","enableLoading","isEnableLyte","isEnableCallTranscription","isEnableCallIntelligence","callAnalyticsData","orginElem","configRecType","configRecLabel","ziaCallAnalyticsConfigs"],data:function(){return{isPopUp:Lyte.attr("boolean",{default:!1}),showMore:Lyte.attr("boolean",{default:!1}),enableLoading:Lyte.attr("boolean",{default:!1}),isEnableLyte:Lyte.attr("boolean",{default:Crm&&Crm.userDetails&&Crm.userDetails.DETAIL_VIEW_LYTE}),isEnableCallTranscription:Lyte.attr("boolean",{default:!1}),isEnableCallIntelligence:Lyte.attr("boolean",{default:!1}),callAnalyticsData:Lyte.attr("object",{default:{}}),orginElem:Lyte.attr("string"),configRecType:Lyte.attr("string"),configRecLabel:Lyte.attr("string"),ziaCallAnalyticsConfigs:Lyte.attr("array",{default:[]})}},displayDiv:function(){var t=this.getData("ziaCallAnalyticsConfigs");if(t){t=t.filter((t=>"call_analytics"!==t.type&&!0===t.enabled));let e=$L(".callAnalyticsDetailUi");0!==t.length?e.show():e.hide()}},init:function(){var t=this;if(!moduleRecordMapping||!moduleRecordMapping.Calls||moduleRecordMapping.Calls.isCallTranscriptionEnable){var e=networkUtils.returnDependencyFiles(["zia_call_analytics_config.js"],ResourceConstants.CRMClient),a=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("zia-call-analytics")],ResourceConstants.CRM),i=e.concat(a);(void 0===store.modelFor("zia_call_analytics_config")?Lyte.injectResources(i):Promise.resolve()).then((function(){(void 0===store.peekAll("zia_call_analytics_config")||0===store.peekAll("zia_call_analytics_config").length?store.findAll("zia_call_analytics_config",{type:"call_analytics",category:2}):Promise.resolve()).then((function(){if(t.setData("ziaCallAnalyticsConfigs",store.peekAll("zia_call_analytics_config").sortBy("order")),t.displayDiv(),!1===t.getData("isPopUp")){t.setData("enableLoading",!0);let e=Lyte.Router.getRouteInstance().transition.info.dynamicParams;const a=e[0];t.setData("module",a);const i=e[1];t.setData("entityId",i);const o=[];moduleRecordMapping&&(moduleRecordMapping.Leads&&moduleRecordMapping.Leads.module_name&&o.push(moduleRecordMapping.Leads.module_name),moduleRecordMapping.Contacts&&moduleRecordMapping.Contacts.module_name&&o.push(moduleRecordMapping.Contacts.module_name),moduleRecordMapping.Calls&&moduleRecordMapping.Calls.module_name&&o.push(moduleRecordMapping.Calls.module_name)),void 0!==i&&void 0!==a&&o.includes(a)?(void 0===store.peekRecord(moduleRecordMapping.Calls.id,i)?store.findRecord(moduleRecordMapping.Calls.id,i):Promise.resolve()).then((function(){const e=store.peekRecord(moduleRecordMapping.Calls.id,i);if(e){Object.keys(e).contains("Call_Transcription__c")&&!1===t.getData("isPopUp")&&t.setData("isEnableCallTranscription",!0);const a=["Zia_Call_Sentiment__c","Zia_Call_Intent__c","Zia_Call_Emotion__c","Zia_Call_Summary__c","Zia_Call_Satisfaction_Score__c","Zia_Call_Politeness_Score__c"],i={Zia_Call_Sentiment__c:"sentiment",Zia_Call_Intent__c:"intent",Zia_Call_Emotion__c:"emotion",Zia_Call_Summary__c:"summary",Zia_Call_Satisfaction_Score__c:"satisfaction_score",Zia_Call_Politeness_Score__c:"politeness_score"},o={};let s=t.getData("callAnalyticsData"),n={};a.forEach((t=>{const a=void 0!==e[t];o[t]=a,a&&(n[i[t]]=e[t])})),Lyte.objectUtils(s,"add","callAnalyticsData",n);const l=$L(t.getData("isEnableLyte")?"#ZiaCallAnalytics":".callAnalyticsDetailUi");let r=Object.values(o).filter((t=>!0===t)).length;0!==r||t.getData("isEnableLyte")&&t.getData("isEnableCallTranscription")||l.hide(),0!==r&&t.setData("isEnableCallIntelligence",!0),t.setData("enableLoading",!1)}})):t.setData("enableLoading",!1)}}))}))}},actions:{moreOption:function(t){!1===this.getData("isPopUp")&&(this.setData("configRecType",t.type),this.setData("orginElem",t.type+"_more"),this.setData("configRecLabel",t.label),this.setData("showMore",!1),this.setData("showMore",!0))}}}),Lyte.Component.register("crm-edit-delete-icons",{_template:'<template tag-name="crm-edit-delete-icons"> <div onclick="{{action(\'stopPropagation\',event)}}" id="relListViewIcons_{{record.id}}" class="crm_edit_delete_container crmeditdeleteiconcontainer flexAlignCenter"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(record.$review,\'!\'),\'||\',expHandlers(record.$review,\'==\',&quot;Approved&quot;)),\'&amp;&amp;\',expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(record.$approval_state,\'===\',\'approved\'),\'||\',expHandlers(record.$approval_state,\'===\',\'review_process_pending\')),\'||\',expHandlers(record.$approval_state,\'===\',\'review_process_rejected\')),\'||\',expHandlers(record.$approval_state,\'===\',\'merge_pending\')),\'||\',record.$approval.resubmit)),\'&amp;&amp;\',expHandlers(record.$stop_processing,\'!\')),\'||\',expHandlers(record.$approval,\'!\')),\'&amp;&amp;\',expHandlers(expHandlers(record.$locked_for_me,\'!\'),\'||\',record.$editable)),\'||\',expHandlers(relatedList.api_name,\'===\',\'Contact_Roles\'))}}"><template case="true"> <template is="if" value="{{expHandlers(parentRecApproved,\'||\',expHandlers(relatedList.api_name,\'===\',\'Contact_Roles\'))}}"><template case="true"> <template is="if" value="{{expHandlers(editEnabled,\'&amp;&amp;\',expHandlers(relatedList.personality_name,\'!=\',&quot;INVITEDEVENTSPERSONALITY&quot;))}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(record.$activity_type,\'==\',&quot;Events&quot;),\'||\',expHandlers(module,\'==\',&quot;Events&quot;)),\'||\',expHandlers(expHandlers(expHandlers(record.$activity_type,\'==\',&quot;Calls&quot;),\'||\',expHandlers(module,\'==\',&quot;Calls&quot;)),\'&amp;&amp;\',moduleInfo.new_call_view))}}"><template case="true"><template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(module,\'!=\',&quot;Calls&quot;),\'&amp;&amp;\',expHandlers(module,\'!=\',&quot;Events&quot;)),\'&amp;&amp;\',expHandlers(record.$activity_type,\'==\',&quot;Events&quot;)),\'||\',expHandlers(record.$activity_type,\'==\',&quot;Calls&quot;)),\'||\',expHandlers(record.Call_Status,\'==\',&quot;Overdue&quot;)),\'||\',indexOf(record.Call_Status,&quot;Scheduled&quot;,&quot;>=&quot;,0))}}"><template case="true"> <span class="icon-hover-effects zi2 mR5 crm-rl-write-action" lt-prop-title="{{getI18n(\'crm.button.edit\')}}" data-cid="editbtn" lt-prop-id="relListEdit_{{record.id}}" data-zcqa="relListEdit_{{record.id}}" onclick="{{action(\'eventEditPopup\',this)}}" id="relListEdit_{{record.id}}" data-params="{&quot;module&quot;:&quot;{{record.$activity_type}}&quot;,&quot;id&quot;:&quot;{{record.id}}&quot;,&quot;cvid&quot;:&quot;{{cvid}}&quot;,&quot;recordNum&quot;:&quot;{{record.recnum}}&quot;,&quot;reqFrom&quot; : &quot;detailView&quot;,&quot;from&quot; : &quot;relatedlist_new&quot;}"> <span class="zcicncss-editFilled zcicn-cssIcons zcicncss13 zi2"></span> </span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(module,\'==\',&quot;Events&quot;),\'||\',expHandlers(module,\'==\',&quot;Calls&quot;)),\'||\',expHandlers(record.Call_Status,\'==\',&quot;Overdue&quot;)),\'||\',indexOf(record.Call_Status,&quot;Scheduled&quot;,&quot;>=&quot;,0))}}"><template case="true"> <span class="icon-hover-effects zi2 mR5 crm-rl-write-action" lt-prop-title="{{getI18n(\'crm.button.edit\')}}" data-cid="editbtn" lt-prop-id="relListEdit_{{record.id}}" data-zcqa="relListEdit_{{record.id}}" onclick="{{action(\'eventEditPopup\',this)}}" id="relListEdit_{{record.id}}" data-params="{&quot;module&quot;:&quot;{{module}}&quot;,&quot;id&quot;:&quot;{{record.id}}&quot;,&quot;cvid&quot;:&quot;{{cvid}}&quot;,&quot;recordNum&quot;:&quot;{{record.recnum}}&quot;,&quot;reqFrom&quot; : &quot;detailView&quot;,&quot;from&quot; : &quot;relatedlist_new&quot;}"> <span class="zcicncss-editFilled zcicn-cssIcons zcicncss13 zi2"></span> </span> </template></template></template></template> </template><template case="false"><template is="if" value="{{isCustomLookUp}}"><template case="true"> <link-to class="icon-hover-effects mR5 crm-rl-write-action" data-zcqa="relListViewEdit_{{record.id}}" lt-prop-title="{{getI18n(\'crm.button.edit\')}}" lt-prop-route="crm.tab.module.entity.edit" lt-prop-id="relListViewEdit_{{record.id}}" lt-prop-class="zi2 ldlh1" lt-prop-dp="[&quot;{{module}}&quot;,&quot;{{record.id}}&quot;]" lt-prop-td="{&quot;recordNum&quot;:&quot;{{record.recnum}}&quot;,&quot;reqFrom&quot; : &quot;detailView&quot;}" lt-prop-qp="{{if(ifEquals(module,\'Activities\'),concat(\'{&quot;sub_module&quot; :&quot;\',record.$activity_type,\'&quot;}\'))}}"> <span class="zcicncss-editFilled zcicn-cssIcons zcicncss13 zcicn_black_mask zi2 mT1"></span> </link-to> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(module,\'==\',&quot;Campaigns&quot;),\'||\',expHandlers(module,\'==\',&quot;Competitors&quot;)),\'||\',expHandlers(module,\'==\',&quot;PriceBooks&quot;)),\'||\',expHandlers(expHandlers(fromModule,\'==\',&quot;PriceBooks&quot;),\'&amp;&amp;\',expHandlers(module,\'==\',&quot;Products&quot;))),\'||\',expHandlers(expHandlers(fromModule,\'===\',&quot;Campaigns&quot;),\'&amp;&amp;\',expHandlers(expHandlers(module,\'===\',&quot;Leads&quot;),\'||\',expHandlers(module,\'===\',&quot;Contacts&quot;))))}}"><template case="true"> <span class="icon-hover-effects zi2 mR5 crm-rl-write-action" data-cid="editbtn" lt-prop-title="{{getI18n(\'crm.button.edit\')}}" lt-prop-id="relListEdit_{{record.id}}" data-zcqa="relListEdit_{{record.id}}" onclick="{{action(\'popupEdit\',module,fromModule)}}" id="relListEdit_{{record.id}}"> <span class="zcicncss-editFilled zcicn-cssIcons zcicncss13 zi2"></span> </span> </template><template case="false"><template is="if" value="{{isLinkedModule}}"><template case="true"> <link-to class="icon-hover-effects mR5 crm-rl-write-action" data-zcqa="relListViewEdit_{{record.id}}" lt-prop-title="{{getI18n(\'crm.button.edit\')}}" lt-prop-route="crm.tab.module.entity.edit" lt-prop-id="relListViewEdit_{{record.id}}" lt-prop-class="zi2 ldlh1" lt-prop-dp="[&quot;{{linkedModule}}&quot;,&quot;{{linkedRecordId}}&quot;]" lt-prop-td="{&quot;reqFrom&quot; : &quot;detailView&quot;}" lt-prop-qp="{{if(ifEquals(module,\'Activities\'),concat(\'{&quot;sub_module&quot; :&quot;\',record.$activity_type,\'&quot;}\'))}}"> <span class="zcicncss-editFilled zcicn-cssIcons zcicncss13 zcicn_black_mask zi2 mT1"></span> </link-to> </template><template case="false"><template is="if" value="{{expHandlers(module,\'==\',\'Appointments\')}}"><template case="true"> <template is="if" value="{{expHandlers(hasEditPermissionForApp,\'||\',hasDeletePermissionForApp)}}"><template case="true"> <a class="icon-hover-effects zi2 mR5 crm-rl-write-action {{if(menuOpened,\'icon-menu-Active\',\'\')}}" data-zcqa="appMoreOptionList" id="relistViewMore_{{record.id}}" lt-prop-title="{{if(menuOpened,\'\',getI18n(\'crm.label.More\'))}}" href="javascript:;"> <span class="zcicncss-morevr zcicn-cssIcons zcicncss-rotate90 zcicn_black_mask zi2"></span> </a> <lyte-menu on-before-open="{{method(\'showAppMenu\')}}" on-close="{{method(\'onMenuClose\')}}" lt-prop-wrapper-class="appMoreOptionsMenu" lt-prop-yield="true" lt-prop-query="#relistViewMore_{{record.id}}" lt-prop-freeze="false"> <template is="registerYield" yield-name="yield"> <lyte-menu-body id="appMoreOptionList" class="appMoreOptionLyteNew" data-zcqa="appMoreOptionList"> <template is="if" value="{{expHandlers(isScheduled,\'&amp;&amp;\',hasEditPermissionForApp)}}"><template case="true"><template is="if" value="{{hasCompleteAction}}"><template case="true"> <lyte-menu-item id="completeAppMoreOption" onclick="{{action(\'showAppPopup\',\'appointmentCompletePopup\',this)}}" data-params="{&quot;module&quot;:&quot;Appointments&quot;,&quot;id&quot;:&quot;{{record.id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;}" data-zcqa="completeAppMoreOption" class="crm-font-regular">{{getI18n(\'crm.appointments.status.markcompleted1\')}}</lyte-menu-item> </template></template> <lyte-menu-item id="rescheduleAppMoreOption" onclick="{{action(\'showAppPopup\',\'Reschedule Information\',this)}}" data-params="{&quot;module&quot;:&quot;Appointments&quot;,&quot;id&quot;:&quot;{{record.id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;,&quot;serviceId&quot; : &quot;{{record.Service_Name.id}}&quot;}" data-zcqa="rescheduleMoreOption" class="crm-font-regular">{{getI18n(\'crm.appointments.status.markreschedule\',getSingularLabel(\'Appointments\'))}}</lyte-menu-item> <lyte-menu-item id="cancelAppMoreOption" onclick="{{action(\'showAppPopup\',\'Cancellation Information\',this)}}" style="border-bottom: 1px solid var(--br_c0c6cc);" data-params="{&quot;module&quot;:&quot;Appointments&quot;,&quot;id&quot;:&quot;{{record.id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;}" data-zcqa="cancelAppMoreOption" class="crm-font-regular">{{getI18n(\'crm.appointments.status.markcancel\',getSingularLabel(\'Appointments\'))}}</lyte-menu-item> </template></template> <template is="if" value="{{hasEditPermissionForApp}}"><template case="true"> <lyte-menu-item id="editAppRecordbtn" onclick="{{action(\'eventEditPopup\',this)}}" data-params="{&quot;module&quot;:&quot;Appointments&quot;,&quot;id&quot;:&quot;{{record.id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;}" data-zcqa="editAppRecordbtn" class="crm-font-regular">{{getI18n(\'Edit\')}}</lyte-menu-item> </template></template><template is="if" value="{{hasDeletePermissionForApp}}"><template case="true"> <lyte-menu-item id="deleteAppRecordbtn" onclick="{{action(\'deleteIconClick\')}}" data-params="{&quot;module&quot;:&quot;Appointments&quot;,&quot;id&quot;:&quot;{{record.id}}&quot;,&quot;from&quot;:&quot;relatedlist_new&quot;}" data-zcqa="deleteAppRecordbtn" class="crm-font-regular">{{getI18n(\'Delete\')}}</lyte-menu-item> </template></template></lyte-menu-body></template></lyte-menu></template>  </template>  </template><template case="false"> <link-to class="icon-hover-effects mR5 crm-rl-write-action" data-zcqa="relListViewEdit_{{record.id}}" lt-prop-title="{{getI18n(\'crm.button.edit\')}}" lt-prop-route="crm.tab.module.entity.edit" lt-prop-id="relListViewEdit_{{record.id}}" lt-prop-class="zi2 ldlh1" lt-prop-dp="[&quot;{{module}}&quot;,&quot;{{record.id}}&quot;]" lt-prop-td="{&quot;recordNum&quot;:&quot;{{record.recnum}}&quot;,&quot;reqFrom&quot; : &quot;detailView&quot;}" lt-prop-qp="{{if(ifEquals(module,\'Activities\'),concat(\'{&quot;sub_module&quot; :&quot;\',record.$activity_type,\'&quot;}\'))}}"> <span class="zcicncss-editFilled zcicn-cssIcons zcicncss13 zcicn_black_mask zi2 mT1"></span> </link-to> </template></template></template></template></template></template></template></template></template></template> </template></template> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(module,\'==\',&quot;Activities&quot;),\'&amp;&amp;\',expHandlers(record.$activity_type,\'==\',&quot;Calls&quot;)),\'||\',expHandlers(module,\'==\',&quot;Calls&quot;)),\'&amp;&amp;\',checkActivityCallStatus(record))}}"><template case="true"> <span class="icon-hover-effects zi2 mR5 crm-rl-write-action {{if(menuOpened,\'icon-menu-Active\',\'\')}}" lt-prop-title="{{if(menuOpened,\'\',getI18n(\'crm.label.More\'))}}" data-zcqa="callMoreOption" id="relistViewMore_{{record.id}}"><span class="zcicncss-morevr zcicn-cssIcons zcicncss-rotate90 zcicn_black_mask zi2"></span></span> <lyte-menu lt-prop-wrapper-class="callMoreOptionsMenu" on-open="{{method(\'hideTooltip\')}}" on-close="{{method(\'onMenuClose\')}}" lt-prop-yield="true" lt-prop-query="#relistViewMore_{{record.id}}" lt-prop-freeze="false"> <template is="registerYield" yield-name="yield"> <lyte-menu-body id="callMoreOption" class="callMoreOptionLyteNew" data-zcqa="callMoreOption"> <lyte-menu-item id="completeCallMoreOption" onclick="{{action(\'showCallPopup\',\'Completed\')}}" data-zcqa="completeCallMoreOption" class="crm-font-regular">{{getI18n(\'crm.label.mark.completed\')}}</lyte-menu-item> <lyte-menu-item id="scheduleCallMoreOption" onclick="{{action(\'showCallPopup\',\'Scheduled\')}}" data-zcqa="scheduleCallMoreOption" class="crm-font-regular">{{getI18n(\'crm.label.reschedule.call\',\'call\')}}</lyte-menu-item> <lyte-menu-item id="cancelCallMoreOption" onclick="{{action(\'showCallPopup\',\'Cancelled\')}}" data-zcqa="cancelCallMoreOption" class="crm-font-regular">{{getI18n(\'crm.label.cancel.call\',\'call\')}}</lyte-menu-item> </lyte-menu-body> </template> </lyte-menu> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(module,\'==\',\'SalesOrders\'),\'||\',expHandlers(module,\'==\',\'Quotes\')),\'||\',expHandlers(module,\'==\',\'Invoices\')),\'&amp;&amp;\',expHandlers(relatedList.type,\'===\',\'default\')),\'&amp;&amp;\',expHandlers(expHandlers(clientPortalUser,\'!\'),\'||\',expHandlers(fromRecord.id,\'!==\',clientRecId)))}}"><template case="true"> <span class="icon-hover-effects zi2 mR5 {{if(menuOpened,\'icon-menu-Active\',\'\')}}" data-zcqa="callMoreOption" lt-prop-title="{{if(menuOpened,\'\',getI18n(\'crm.label.More\'))}}" id="relistViewMore_{{record.id}}"><span class="zcicncss-morevr zcicn-cssIcons zcicncss-rotate90 zcicn_black_mask zi2"></span></span> <lyte-menu lt-prop-wrapper-class="callMoreOptionsMenu crm-invoicepdf-menu crm-src-relatedlist-{{record.id}}" on-open="{{method(\'onMenuOpen\')}}" on-close="{{method(\'onMenuClose\')}}" lt-prop-yield="true" lt-prop-query="#relistViewMore_{{record.id}}" lt-prop-freeze="false"> <template is="registerYield" yield-name="yield"> <lyte-menu-body id="callMoreOption" class="callMoreOptionLyteNew" data-zcqa="callMoreOption"> <lyte-menu-item class="crm-rl-write-action" id="completeCallMoreOption" onclick="{{action(\'inventoryPopup\',\'Delete\')}}" data-zcqa="invoiceMenuListDelete">{{getI18n(\'Delete\')}}</lyte-menu-item> <template is="if" value="{{expHandlers(isClientAccount,\'!\')}}"><template case="true"> <lyte-menu-item id="scheduleCallMoreOption" onclick="{{action(\'inventoryPopup\',\'ExportPdf\')}}" data-zcqa="invoiceMenuListExport" class="crm-font-regular">{{getI18n(\'crm.export.pdf\')}}</lyte-menu-item> <lyte-menu-item class="crm-rl-write-action" id="cancelCallMoreOption" onclick="{{action(\'inventoryPopup\',\'SendMail\')}}" data-zcqa="invoiceMenuListSendMail">{{getI18n(\'crm.button.license.sendMail\')}}</lyte-menu-item> </template></template> </lyte-menu-body> </template> </lyte-menu> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(module,\'==\',&quot;Activities&quot;),\'&amp;&amp;\',expHandlers(record.$activity_type,\'==\',&quot;Tasks&quot;)),\'||\',expHandlers(module,\'==\',&quot;Tasks&quot;)),\'&amp;&amp;\',expHandlers(record.Status,\'!=\',activityRecordStatus)),\'&amp;&amp;\',expHandlers(record.$process_flow,\'!\'))}}"><template case="true"> <span class="body icon-hover-effects markCompleted zi2 mR5 crm-rl-write-action" lt-prop-title="{{getI18n(\'crm.label.mark.completed\')}}" data-zcqa="relistViewClose_{{record.id}}" id="relistViewClose_{{record.id}}" onclick="{{action(\'closeTask\',record.id)}}"><span class="zcicncss-tickrounded zcicn-cssIcons zcicn_black_mask zi2"></span></span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(relatedList.record_operations.disassociate,\'!\'),\'&amp;&amp;\',editPermissionAvailable),\'&amp;&amp;\',deleteEnabled),\'&amp;&amp;\',expHandlers(relatedList.personality_name,\'!=\',&quot;INVITEDEVENTSPERSONALITY&quot;))}}"><template case="true"> <template is="if" value="{{disableAndShowTooltip}}"><template case="true"><span id="deletelink" lt-prop-title="{{getI18n(\'crm.label.relatedlist.remove.disabled.tooltip\')}}" class="icon-hover-effects zi2 crm-rl-write-action cDefault" data-zcqa="lnk_delete_{{module}}"><span class="zcicncss-close zcicn-cssIcons zcicn_black_mask zi2"></span></span></template><template case="false"><span id="deletelink" lt-prop-title="{{getI18n(\'crm.label.delete\')}}" class="icon-hover-effects zi2 crm-rl-write-action" data-zcqa="lnk_delete_{{module}}" onclick="{{action(\'deleteIconClick\')}}"><span class="zcicncss-deleteLine-hover zcicn-cssIcons zcicn_black_mask zi2 scale9"></span></span></template></template> </template><template case="false"><template is="if" value="{{expHandlers(deleteEnabled,\'&amp;&amp;\',expHandlers(relatedList.personality_name,\'!=\',&quot;INVITEDEVENTSPERSONALITY&quot;))}}"><template case="true"> <span id="deletelink" lt-prop-title="{{getI18n(\'crm.confirm.deassociate\')}}" class="icon-hover-effects zi2 crm-rl-write-action" data-zcqa="lnk_delete_{{module}}" onclick="{{action(\'deleteIconClick\')}}"><span class="zcicncss-close zcicn-cssIcons zcicn_black_mask zi2"></span></span> </template></template></template></template></template></template></template></template></template></template> <template is="if" value="{{expHandlers(relatedList.personality_name,\'==\',&quot;INVITEDEVENTSPERSONALITY&quot;)}}"><template case="true"> <a class="icon-hover-effects zi2 mR5 crm-rl-write-action {{if(menuOpened,\'icon-menu-Active\',\'\')}}" lt-prop-title="{{if(menuOpened,\'\',getI18n(\'crm.label.More\'))}}" data-zcqa="callMoreOption" id="relistViewMore_{{record.id}}" href="javascript:;"> <span class="zcicncss-morevr zcicn-cssIcons zcicncss-rotate90 zcicn_black_mask zi2"></span></a> <lyte-menu lt-prop-wrapper-class="callMoreOptionsMenu" on-open="{{method(\'hideTooltip\')}}" on-close="{{method(\'onMenuClose\')}}" lt-prop-yield="true" lt-prop-query="#relistViewMore_{{record.id}}" lt-prop-freeze="false"> <template is="registerYield" yield-name="yield"> <lyte-menu-body id="callMoreOption" class="callMoreOptionLyteNew" data-zcqa="callMoreOption"> <lyte-menu-item id="editEvent" onclick="{{action(\'invitedEventsDrop\',\'edit\',record)}}" data-zcqa="relatedListEdit_Events" class="crm-font-regular">{{getI18n(\'Edit\')}}</lyte-menu-item> <lyte-menu-item id="deleteEvent" onclick="{{action(\'invitedEventsDrop\',\'delete\',record)}}" data-zcqa="lnk_delete_Events" class="crm-font-regular">{{getI18n(\'Delete\')}}</lyte-menu-item> <lyte-menu-item id="disassociateEvent" onclick="{{action(\'invitedEventsDrop\',\'disassociate\',record)}}" data-zcqa="lnk_remove_entity" class="crm-font-regular">{{getI18n(\'crm.label.event.remove.participant\',getValue(fromRecord,displayField[fromModule][0]))}}</lyte-menu-item> </lyte-menu-body> </template> </lyte-menu> </template></template> </template></template></template><template case="false"> <template is="if" value="{{expHandlers(record,\'&amp;&amp;\',record.$stop_processing)}}"><template case="true"> <span class="zcicncss-notallowed zcicn-cssIcons zcicn_black_mask zi2 vVIm" lt-prop-title="{{getI18n(&quot;crm.privacy.listview.consent.locked&quot;)}}"></span> </template><template case="false"><template is="if" value="{{expHandlers(record.$locked_for_me,\'&amp;&amp;\',expHandlers(record.$editable,\'!\'))}}"><template case="true"> <span class="zcicncss-lock zcicn-cssIcons zcicn_black_mask zi2 mT1 vVIm" data-zcqa="lockedforMeRelated_{{record.id}}" lt-prop-title="{{getI18n(\'crm.record.lock.record.locked\')}}" alt="{{getI18n(\'crm.record.lock.record.locked\')}}"></span> </template><template case="false"> <span class="zcicncss-lock zcicn-cssIcons zcicn_black_mask zi2 mT1 vVIm" lt-prop-title="{{getI18n(\'crm.approvalProcess.label.waitingForApproval\')}}" alt="{{getI18n(\'crm.approvalProcess.label.waitingForApproval\')}}"></span> </template></template></template></template> </template></template> </div> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[2]},{type:"text",position:[2,0]},{type:"componentDynamic",position:[2]},{type:"attr",position:[4]},{type:"text",position:[4,0]},{type:"componentDynamic",position:[4]}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,4]},{type:"if",position:[1,4],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5]},{type:"text",position:[1,5,0]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"text",position:[3,0]},{type:"componentDynamic",position:[3]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5]},{type:"text",position:[1,5,0]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}],_observedAttributes:["record","module","url","fromModule","fromRecord","editEnabled","deleteEnabled","relatedList","displayField","fromRecord","isLinkedModule","linkedModule","linkedRecordId","attachLinkMenuOpen","displayField","isCustomLookUp","moduleInfo","isClientAccount","activityRecordStatus","hasEditPermissionForApp","hasDeletePermissionForApp","hasCompleteAction","isScheduled","hasCompletePermissionForTask","clientPortalUser","clientRecId","menuOpened","parentRecApproved","disableAndShowTooltip","editPermissionAvailable"],data:function(){return{record:Lyte.attr("object",{hideAttr:!0}),module:Lyte.attr("string"),url:Lyte.attr("string"),fromModule:Lyte.attr("string"),fromRecord:Lyte.attr("object"),editEnabled:Lyte.attr("boolean",{default:!1}),deleteEnabled:Lyte.attr("boolean",{default:!1}),relatedList:Lyte.attr("object",{hideAttr:!0}),displayField:Lyte.attr("object",{default:{Leads:["Full_Name","Last_Name"],Attachments:["File_Name"],Activities:["Subject"],Tasks:["Subject"],Calls:["Subject"],Events:["Event_Title"],Accounts:["Account_Name"],Contacts:["Full_Name"],Deals:["Deal_Name"],Potentials:["Deal_Name"],Campaigns:["Campaign_Name"],Cases:["Subject"],Solutions:["Solution_Title"],Products:["Product_Name"],Vendors:["Vendor_Name"],PriceBooks:["Price_Book_Name"],Quotes:["Subject"],SalesOrders:["Subject"],PurchaseOrders:["Subject"],Invoices:["Subject"],Visits:["Visited_Page"]}}),fromRecord:Lyte.attr("object",{hideAttr:!0}),isLinkedModule:Lyte.attr("boolean",{default:!1}),linkedModule:Lyte.attr("string"),linkedRecordId:Lyte.attr("string"),attachLinkMenuOpen:Lyte.attr("boolean"),displayField:Lyte.attr("object",{default:{Leads:["Full_Name","Last_Name"],Attachments:["File_Name"],Activities:["Subject"],Tasks:["Subject"],Calls:["Subject"],Events:["Event_Title"],Accounts:["Account_Name"],Contacts:["Full_Name"],Deals:["Deal_Name"],Potentials:["Deal_Name"],Campaigns:["Campaign_Name"],Cases:["Subject"],Solutions:["Solution_Title"],Products:["Product_Name"],Vendors:["Vendor_Name"],PriceBooks:["Price_Book_Name"],Quotes:["Subject"],SalesOrders:["Subject"],PurchaseOrders:["Subject"],Invoices:["Subject"],Visits:["Visited_Page"]}}),isCustomLookUp:Lyte.attr("boolean"),moduleInfo:Lyte.attr("object"),isClientAccount:Lyte.attr("boolean"),activityRecordStatus:Lyte.attr("string"),hasEditPermissionForApp:Lyte.attr("boolean",{default:Crm.userDetails.permissions.Crm_Implied_Edit_Appointments}),hasDeletePermissionForApp:Lyte.attr("boolean",{default:Crm.userDetails.permissions.Crm_Implied_Delete_Appointments}),hasCompleteAction:Lyte.attr("boolean",{default:!0}),isScheduled:Lyte.attr("boolean",{default:!1}),hasCompletePermissionForTask:Lyte.attr("boolean"),clientPortalUser:Lyte.attr("string",{default:clientPortalName}),clientRecId:Lyte.attr("string",{default:Crm.userDetails.CLIENT_ID}),menuOpened:Lyte.attr("boolean",{default:!1}),parentRecApproved:Lyte.attr("boolean",{default:!0}),disableAndShowTooltip:Lyte.attr("boolean",{default:!1}),editPermissionAvailable:Lyte.attr("boolean",{default:!0})}},init:function(){"Tasks"!==this.getData("module")&&"Activities"!==this.getData("module")||this.activitiesCloseTaskStatus(),clientPortalName?this.setData("isClientAccount",!0):this.setData("isClientAccount",!1);var t=this.getData("relatedList");if("custom_lookup"===this.data.relatedList.type)this.setData("isCustomLookUp",!0);else if(t.mxnfield||"multiselectlookup"===this.data.relatedList.type){this.setData("isLinkedModule",!0);var e,a=t.linkingmodule,i=moduleRecordMapping[a].visibility,o=this.getData("record"),s=store.peekRecord("field",t.mxnfield);s=s&&s.multiselectlookup?s.multiselectlookup.connectedlookup_apiname:s.api_name,2&i||4&i?(this.setData("linkedModule",t.connectedmodule),e=o.isTemplate?o.id:o[s].id):(this.setData("linkedModule",t.linkingmodule),e=void 0===o.parentCompId?o.id:o.parentCompId),this.setData("linkedRecordId",e);var n=o[s];n&&this.setData({"record.$locked_for_me":n.$locked_for_me,"record.$review":n.$review,"record.$approved":n.$approved,"record.$approval":n.$approval,"record.$stop_processing":n.$stop_processing,"record.$editable":n.$editable,"record.$approval_state":n.$approval_state})}this.setData("moduleInfo",moduleRecordMapping[this.data.module]),this.setData("editEnabled",this.data.relatedList.record_operations&&this.data.relatedList.record_operations.edit||"Activities"==this.data.module||"Tasks"==this.data.module||"Events"==this.data.module||"Calls"==this.data.module),this.setData("deleteEnabled",this.data.relatedList.record_operations&&this.data.relatedList.record_operations.delete||this.data.relatedList.record_operations&&this.data.relatedList.record_operations.disassociate||"Activities"==this.data.module||"Tasks"==this.data.module||"Events"==this.data.module||"Calls"==this.data.module),!this.data.deleteEnabled&&"custom_lookup"===this.data.relatedList.type&&this.data.relatedList&&this.data.relatedList.record_operations&&!this.data.relatedList.record_operations.disassociate&&this.setData({disableAndShowTooltip:!0,deleteEnabled:!0}),!this.data.clientPortalUser||this.getModuleNameFromRelatedlist(this.data.relatedList)!==Crm.userDetails.CLIENT_TYPE&&(this.getData("fromRecord.id")!==Crm.userDetails.CLIENT_ID||"Campaigns"===this.data.relatedList.api_name&&"default"===this.getData("relatedList.type"))||this.setData("deleteEnabled",!1),this.data.deleteEnabled&&this.data.relatedList.record_operations&&!this.data.relatedList.record_operations.edit&&this.data.relatedList.record_operations.delete&&!this.data.relatedList.record_operations.disassociate&&this.setData("editPermissionAvailable",!1)},actions:{stopPropagation:function(t){"canvas"===Lyte.Router.getRouteInstance().routeName?(Crm.canvasScroll=this.$node.parentElement.closest(".zc-list-component").closest("[id]").id,t.stopPropagation()):"detail"===Lyte.Router.getRouteInstance().routeName&&t.stopPropagation()},eventEditPopup:function(t){Crm.editEntity(event,t),event.preventDefault()},closeTask:function(){if(this.getData("hasCompletePermissionForTask"))renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.security.error"));else{store.model[moduleRecordMapping.Tasks.id]||store.registerModel(moduleRecordMapping.Tasks.id,{Status:Lyte.attr("string")},{extends:"entity"});var t=Crm.isActivitySplitDone?"Tasks":"Activities";store.pushPayload(moduleRecordMapping.Tasks.id,[].concat(store.peekRecord(moduleRecordMapping[t].id,this.getData("record").id).$.toJSON())),$L("crm-detail-view-common")[0].component.closeTask(this.getData("record").id,this.$node)}},showCallPopup:function(t){Crm.fetchCallDetails(t,this.getData("record").id,"relatedList"),closeMultipleReminderBussinesscardView()},inventoryPopup:function(t){switch(t){case"Delete":if("detail"!==Lyte.Router.getRouteInstance().routeName&&(Crm.canvasScroll=this.$node.parentElement.closest(".zc-list-component").closest("[id]").id),!Crm.userDetails.permissions.hasOwnProperty("Crm_Implied_Delete_"+this.data.relatedList.module.api_name.replace("_","")))return void _cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.delete.error"),ltPropSecondaryMessage:I18n.getMsg("crm.security.error"),ltPropButtons:[{type:"accept",text:I18n.getMsg("crm.button.ok"),appearance:"primary"}],ltPropButtonPosition:"right"},show:function(t){t.childComp.querySelector(".alertPrimaryMsg").style="color:#E20000"}});this.recordDeletePopup(this.getData("record"),3,this.getData("module"),this.getData("fromModule"),this.getData("fromRecord"),this.getData("relatedList"));break;case"ExportPdf":var e=Crm.getCrmBasePath()+"/tab/"+this.getData("module")+"/"+this.getData("record").id+"/export-pdf?flag=false&module="+this.getData("module");adjustScreenAndOpen(e,this.getData("module"));break;case"SendMail":this.executeActionButton("sendMail",this.getData("module"),this.data.record.id,"",this.data.record,void 0,!0)}},deleteIconClick:function(){var t,e=this.getData("module"),a=this.getData("fromModule");if(t=this.data.relatedList.record_operations.delete&&this.data.relatedList.record_operations.disassociate?3:this.data.relatedList.record_operations.delete?2:1,"Activities"!=this.data.module&&"Tasks"!=this.data.module&&"Calls"!=this.data.module&&"Events"!=this.data.module&&"Appointments"!=this.data.module||(t=2),("Campaigns"!==a||"Leads"!==e&&"Contacts"!==e||-1===[1,2,3,8,4,5,7].indexOf(this.data.fromRecord.$campaign_type))&&("Campaigns"!==e||"Leads"!==a&&"Contacts"!==a||-1===[1,2,3,8,4,5,7].indexOf(this.data.record.$campaign_type))||"default"!==this.data.relatedList.type){if(2==t&&"Competitors"!=this.data.relatedList.api_name){var i=this.data.module;if("Activities"==i&&(i=this.data.record.$activity_type),!Crm.userDetails.permissions.hasOwnProperty("Crm_Implied_Delete_"+i))return void _cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.delete.error"),ltPropSecondaryMessage:I18n.getMsg("crm.security.error"),ltPropButtons:[{type:"accept",text:I18n.getMsg("crm.button.ok"),appearance:"primary"}],ltPropButtonPosition:"right"},show:function(t){t.childComp.querySelector(".alertPrimaryMsg").style="color:#E20000"}})}else if(2===t&&"Competitors"===this.data.relatedList.api_name&&!Crm.userDetails.permissions.hasOwnProperty("Crm_Implied_Delete_"+a))return void _cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.delete.error"),ltPropSecondaryMessage:I18n.getMsg("crm.security.error"),ltPropButtons:[{type:"accept",text:I18n.getMsg("crm.button.ok"),appearance:"primary"}],ltPropButtonPosition:"right"},show:function(t){t.childComp.querySelector(".alertPrimaryMsg").style="color:#E20000"}});if(1==t&&"multiselectlookup"==this.data.relatedList.type&&1===moduleRecordMapping[this.data.relatedList.linkingmodule].visibility&&moduleRecordMapping[this.data.relatedList.linkingmodule].visible&&!Crm.userDetails.permissions.hasOwnProperty("Crm_Implied_Delete_"+this.data.relatedList.linkingmodule))return void _cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.delete.error"),ltPropSecondaryMessage:I18n.getMsg("crm.security.error"),ltPropButtons:[{type:"accept",text:I18n.getMsg("crm.button.ok"),appearance:"primary"}],ltPropButtonPosition:"right"},show:function(t){t.childComp.querySelector(".alertPrimaryMsg").style="color:#E20000"}});if(("Products"===a&&"PriceBooks"===e||"PriceBooks"===a&&"Products"===e)&&!Crm.userDetails.permissions.hasOwnProperty("Crm_Implied_Delete_"+this.data.relatedList.module.api_name.replace("_","")))return void _cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.delete.error"),ltPropSecondaryMessage:I18n.getMsg("crm.security.error"),ltPropButtons:[{type:"accept",text:I18n.getMsg("crm.button.ok"),appearance:"primary"}],ltPropButtonPosition:"right"},show:function(t){t.childComp.querySelector(".alertPrimaryMsg").style="color:#E20000"}});this.recordDeletePopup(this.getData("record"),t,this.getData("module"),this.getData("fromModule"),this.getData("fromRecord"),this.getData("relatedList"))}else{var o=networkUtils.returnDependencyFiles(["crm-campaign-disassociate-popup.js","crm-campaign-detail-utils.js"],ResourceConstants.CRMClient),s=networkUtils.returnDependencyFiles(["crm-campaign-disassociate-popup.css"],ResourceConstants.CRMClient),n=o.concat(s);Lyte.injectResources(n,void 0,function(){let t=this.data.fromRecord.$campaign_type||this.data.record.$campaign_type;Lyte.Component.render("crm-campaign-disassociate-popup",{pModule:e,cModule:a,campaignType:t},"#show")}.bind(this))}},popupEdit:function(t,e){if("Campaigns"===t||"Campaigns"===e&&("Leads"===t||"Contacts"===t)){var a={};a.memberStatus=store.peekAll("campaign_status"),a.list_relation_id=this.getData("relatedList").id,a.record_id=this.getData("record").id,a.showPopup=!0;var i=networkUtils.returnDependencyFiles(["crm-update-member-status-popup.js"],ResourceConstants.CRMClient),o=networkUtils.returnDependencyFiles(["crm-update-member-status-popup.css"],ResourceConstants.CRMClient),s=i.concat(o);Lyte.injectResources(s,void 0,(function(){var t=$("#addCampaignMembersNextButton");t.length&&t.blur(),a.memberStatus=store.peekAll("campaign_status"),Lyte.Component.render("crm-update-member-status-popup",a,"#show")}))}else if("PriceBooks"==t||"PriceBooks"==e&&"Products"==t){var n=Crm.getCrmBasePath()+"/ShowMultiValuesForAdd.do?moduleid="+this.data.fromRecord.id+"&rid="+this.getData("relatedList").id+"&pname="+this.getData("relatedList").personality_name+"&returnAnchor=&tomodule="+encodeURIComponent(t)+"&Edit=true&othermoduleid="+this.getData("record").id+"&frommodule="+(e?encodeURIComponent(e):null);commonUtils.openCustomLookup(n,void 0,"topBandPopup")}else{n=Crm.getCrmBasePath()+"/potentials/EditCompetitor.do?id="+this.data.fromRecord.id+"&module=Potentials&competitorid="+this.data.record.id+"&rid="+this.data.relatedList.id+"&returnAnchor=competitorspersonality_"+this.data.relatedList.id;commonUtils.openCustomLookup(n,void 0,"topBandPopup")}},invitedEventsDrop:function(t,e){switch(t){case"edit":Crm.editEntity(event,void 0,{module:"Events",id:e.id,reqFrom:"detailView",from:"relatedlist_new"}),event.preventDefault();break;case"delete":this.recordDeletePopup(e,2,"Events");break;case"disassociate":$L("crm-detail-view-common")[0].component.removeParticipant(this.getData("fromRecord")[crmConstants.moduleDisplayField[this.getData("fromModule")][0]],e,this.data.fromRecord)}},showAppPopup:function(t,e){var a=this,i=this.getData("record");Lyte.resolvePromises({filesResolved:Lyte.injectResources(networkUtils.returnDependencyFiles(["zohocrm_services.js"],ResourceConstants.CRM).concat(networkUtils.returnDependencyFiles(["crm-services-appointments.js","servapp_preferences_model.js"],ResourceConstants.CRMClient)).concat(networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("businesshours")],ResourceConstants.CRM)))}).then((function(){var o=Lyte.Transform.datetime.deserialize(i.Appointment_End_Time);a.setAppointmentStatusActions(t,e,CrmDateUtils.convertDateTimetoISOFormat(o)),$L("#Calendar").hide()}))}},methods:{hideTooltip:function(){this.setData("menuOpened",!0)},onMenuClose:function(){this.throwEvent("hideIcons",this.getData("record").id),this.setData("menuOpened",!1)},onMenuOpen:function(t,e,a){var i=$L(a).closest(".canvas-cscript-readonly"),o=this.getData("record").id,s=document.querySelector(".crm-invoicepdf-menu.crm-src-relatedlist-"+o);i.length?(t.getData("ltPropWrapperClass")||"").indexOf("crm-invoicepdf-menu")>-1?s&&s.classList.add("canvas-cscript-readonly-menu"):s&&s.classList.remove("canvas-cscript-readonly-menu"):s&&s.classList.remove("canvas-cscript-readonly-menu");this.setData("menuOpened",!0)},showAppMenu:function(){var t=this.getData("record"),e=this;t.id;this.setData("isScheduled",!(!t||t.Status!==I18n.getMsg("Scheduled")&&I18n.getMsg(t.Status)!==I18n.getMsg("Overdue"))),I18n.getMsg(t.Status)!==I18n.getMsg("Overdue")?Lyte.injectResources(networkUtils.returnDependencyFiles(["servapp_preferences_model.js"],ResourceConstants.CRMClient),void 0,(function(){store.findAll("servapp_preferences",{},!1,!0,{module:"Appointments"}).then((function(t){t&&t.length&&(e.setData("hasCompleteAction","mark_as_complete"!==t[0].appointments.when_duration_exceeds),$L("#appMoreOptionList").css("display","block"))}))})):(this.setData("hasCompleteAction",!0),$L("#appMoreOptionList").css("display","block")),this.setData("menuOpened",!0)}},activitiesCloseTaskStatus:function(){var t,e=store.peekAll("field").filter((function(t){return"Status"===t.api_name&&t.module&&t.module[0]&&("Activities"===t.module[0].api_name||"Tasks"===t.module[0].api_name)}))[0];e?(t=e.pick_list_values.filter((function(t){return"Completed"===t.actual_value}))[0].display_value,this.setData("activityRecordStatus",t),this.setData("hasCompletePermissionForTask",!e.visible||e.read_only)):app.store.makeRequest("findRecord","module",moduleRecordMapping.Tasks.id,void 0,void 0,void 0,{getFields:!0}).then((function(){Lyte.triggerEvent("relatedList",{module:"Tasks"})}))},getActivityCallStatusValue:function(t,e){var a=store.peekAll("field").filterBy({api_name:t})[0];if(e&&a&&"picklist"===a.data_type)for(var i=a.pick_list_values,o=i.length,s=0;s<o;s++)if(e===i[s].display_value)return i[s].actual_value;return null}},{mixins:["crm-detail-view-utils","crm-create-mixin",,"crm-appointments-mixin","crm-validationrule-utils"]}),Lyte.Component.registerHelper("checkActivityCallStatus",(function(t){return t&&isNewCallView?"Overdue"===this.component.getActivityCallStatusValue("Outgoing_Call_Status",t.Outgoing_Call_Status)||"Scheduled"===this.component.getActivityCallStatusValue("Outgoing_Call_Status",t.Outgoing_Call_Status):!(!t||"Overdue"!==t.Call_Status&&"Scheduled"!==t.Call_Status)})),Lyte.Component.register("crm-custom-button",{_template:'<template tag-name="crm-custom-button" id="crmCustomButton"> <lyte-event-listener event-name="custom_button_cscript_action" on-fire="{{action(\'doCscriptActions\')}}"> <template is="if" value="{{headlessDropdown}}"><template case="true"> <lyte-menu lt-prop-animate="true" lt-prop-query=".{{headlessReference}}" lt-prop-event="click" lt-prop-yield="true" on-before-open="{{method(\'onCusttomButtonBeforeShow\')}}" on-close="{{method(\'onHide\')}}" lt-prop-freeze="false"> <template is="registerYield" yield-name="yield"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',5),\'||\',expHandlers(seModCustomButton.length,\'>\',5)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',5))}}"><template case="true"> <lyte-menu-header> <lyte-search lt-prop-placeholder="Search Button" on-search="{{method(\'checkResult\')}}" id="buttonSearch" lt-prop-query-selector="{&quot;scope&quot; : &quot;#cvBtnListSearch{{btnid}}&quot;, &quot;search&quot; : &quot;lyte-menu-item&quot;}" data-zcqa="CVListBtnSearchBox"></lyte-search> </lyte-menu-header> </template></template> <lyte-menu-body> <template is="if" value="{{expHandlers(isActivityModule,\'!\')}}"><template case="true"> <div id="cvBtnListSearch{{btnid}}"> <template is="for" items="{{customButtons}}" item="action" index="index"> <lyte-menu-item data-value="{{action.id}}" class="{{if(array_contains(disabledButtons,action.id),\'canvas-cscript-menuitem-disable\',\'\')}} customButtonQuery{{action.id}} crm-custom-button-item crm-custom-button-menuitem " data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}"> {{expHandlers(renamedButtons[action.id],\'||\',action.name)}} </lyte-menu-item> </template> </div> <template is="if" value="{{showNoButtonDiv}}"><template case="true"> <div class="lyteDropdownNoResult ">{{getI18n(\'crm.custombutton.nobuttons.found\')}}</div> </template></template> </template><template case="false"><template is="if" value="{{expHandlers(isActivityModule,\'&amp;&amp;\',expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',0),\'||\',expHandlers(seModCustomButtons.length,\'>\',0)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',0)))}}"><template case="true"> <div id="cvBtnListSearch{{btnid}}"> <div> <lyte-menu-group> <lyte-menu-header id="btnDropCont_CB">{{if(expHandlers(expHandlers(contactModCustomButtons.length,\'&gt;\',0),\'||\',expHandlers(seModCustomButtons.length,\'&gt;\',0)),module,\'\')}}</lyte-menu-header> <template is="if" value="{{expHandlers(customButtons.length,\'>\',0)}}"><template case="true"> <template is="for" items="{{customButtons}}" item="action" index="index"> <lyte-menu-item data-value="{{action.id}}" class="{{if(array_contains(disabledButtons,action.id),\'canvas-cscript-menuitem-disable\',\'\')}} customButtonQuery{{action.id}} crm-custom-button-item crm-custom-button-menuitem " data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{expHandlers(renamedButtons[action.id],\'||\',action.name)}}</lyte-menu-item> </template> </template><template case="false"> <div class="lyteDropdownNoResult dBImp {{if(expHandlers(customButtons.length,\'<=\',0),\'restrictSortForNoBtn\',\'\')}}">{{getI18n(\'crm.custombutton.nobuttons.found\')}}</div> </template></template> </lyte-menu-group> </div> <div> <template is="if" value="{{expHandlers(contactModCustomButtons.length,\'>\',0)}}"><template case="true"> <lyte-menu-group> <lyte-menu-header id="btnDropCont_CCB">{{getI18n(\'Contacts\')}}</lyte-menu-header> <template is="for" items="{{contactModCustomButtons}}" item="action" index="index"> <lyte-menu-item data-value="{{action.id}}" class="{{if(array_contains(disabledButtons,action.id),\'canvas-cscript-menuitem-disable\',\'\')}} customButtonQuery{{action.id}} crm-custom-button-item crm-custom-button-menuitem " data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{expHandlers(renamedButtons[action.id],\'||\',action.name)}}</lyte-menu-item> </template> </lyte-menu-group> </template></template> </div> <div> <template is="if" value="{{expHandlers(seModCustomButtons.length,\'>\',0)}}"><template case="true"> <lyte-menu-group> <lyte-menu-header id="btnDropCont_SCB">{{seModule}}</lyte-menu-header> <template is="for" items="{{seModCustomButtons}}" item="action" index="index"> <lyte-menu-item data-value="{{action.id}}" class="{{if(array_contains(disabledButtons,action.id),\'canvas-cscript-menuitem-disable\',\'\')}} customButtonQuery{{action.id}} crm-custom-button-item crm-custom-button-menuitem " data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{expHandlers(renamedButtons[action.id],\'||\',action.name)}}</lyte-menu-item> </template> </lyte-menu-group> </template></template> </div> </div> </template></template></template></template> </lyte-menu-body> <lyte-menu-footer> <template is="if" value="{{expHandlers(expHandlers(btnid,\'!=\',\'relatedList\'),\'&amp;&amp;\',expHandlers(isPortalPage,\'!\'))}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(getUserDetail(\'LICENSE_TYPE\'),\'!=\',\'L\'),\'&amp;&amp;\',expHandlers(getUserDetail(\'LICENSE_TYPE\'),\'!=\',\'F\')),\'&amp;&amp;\',expHandlers(getUserDetail(\'LICENSE_TYPE\'),\'!=\',\'N\'))}}"><template case="true"> <lyte-menu-item id="detailsCB" class="customBtnLink crm-custom-button-footer crm-custom-button-menuitem"> <div class="dB crmLinkColor" onclick="{{action(\'createCustomBtn\',module,position)}}" data-zcqa="create_buttons">{{getI18n(\'crm.custombutton.create.newbutton\')}}</div> </lyte-menu-item> </template></template> <lyte-menu-item class="customBtnLink crm-custom-button-menuitem" id="manageCustomButtonDiv"> <div class="dB crmLinkColor" onclick="{{action(\'manageCustomButton\',module)}}" data-zcqa="manage_buttons">{{getI18n(\'crm.custombutton.manage.button\')}}</div> </lyte-menu-item> </template></template> </lyte-menu-footer> </template> </lyte-menu> </template><template case="false"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(seModCustomButtons.length,\'>\',0),\'||\',expHandlers(contactModCustomButtons.length,\'>\',0)),\'||\',expHandlers(customButtons.length,\'>\',0))}}"><template case="true"> <lyte-dropdown id="{{btnid}}" lt-prop-tabindex="-1" class="{{if(withoutRecord,\'mR10\',\'fL mR15\')}}" lt-prop-is-open="{{lbind(showCustomButtons)}}" lt-prop-yield="true" on-before-show="{{method(\'onCusttomButtonBeforeShow\')}}" on-show="{{method(\'onCusttomButtonShow\')}}" on-hide="{{method(\'onHide\')}}" lt-prop-freeze="false" lt-prop-disable-item-tooltip="true" lt-prop-disabled-list="{{csript_disabledactions}}" lt-prop-allow-focusable-elements="true" lt-prop-active-element="{{if(expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',5),\'||\',expHandlers(seModCustomButton.length,\'>\',5)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',5)),\'#customButtonSearch\',\'.cbDropDownIcon\')}}" lt-prop-include-button-in-focus-loop="{{if(expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',5),\'||\',expHandlers(seModCustomButton.length,\'>\',5)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',5)),\'false\',\'true\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-button class="lvCustomButton newgreybtn dIF wsNowrap"> <template is="if" value="{{expHandlers(customButtons.length,\'>\',0)}}"><template case="true"> <div tabindex="{{if(showCustomButtons,\'-1\',\'0\')}}" class="executeCustomButton cBTextTrans dIB vaM customButtonQuery{{compId}}{{customButtons[0].id}} cVDropMax flexOne {{getDisableClassForActions_CustomButon(customButtons[0].id,csript_disabledactions)}}" cscript-tag="customBtn_{{customButtons[0].id}}" onmouseover="{{action(\'mouseOverCustomButton\',expHandlers(\'customButtonQuery\',\'+\',compId),customButtons[0].id,encodeJS(customButtons[0].name),encodeJS(customButtons[0].description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}" data-zcqa="{{customButtons[0].name}}">{{customButtons[0].name}}</div> </template><template case="false"><template is="if" value="{{expHandlers(contactModCustomButtons.length,\'>\',0)}}"><template case="true"> <div tabindex="{{if(showCustomButtons,\'-1\',\'0\')}}" class="executeCustomButton cBTextTrans dIB vaM customButtonQuery{{compId}}{{contactModCustomButtons[0].id}} cVDropMax flexOne {{getDisableClassForActions_CustomButon(customButtons[0].id,csript_disabledactions)}}" cscript-tag="customBtn_{{contactModCustomButtons[0].id}}" onmouseover="{{action(\'mouseOverCustomButton\',expHandlers(\'customButtonQuery\',\'+\',compId),contactModCustomButtons[0].id,encodeJS(contactModCustomButtons[0].name),encodeJS(contactModCustomButtons[0].description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}" data-zcqa="{{contactModCustomButtons[0].name}}">{{contactModCustomButtons[0].name}}</div> </template><template case="false"><template is="if" value="{{expHandlers(seModCustomButtons.length,\'>\',0)}}"><template case="true"> <div tabindex="{{if(showCustomButtons,\'-1\',\'0\')}}" class="executeCustomButton cBTextTrans dIB vaM customButtonQuery{{compId}}{{seModCustomButtons[0].id}} cVDropMax flexOne {{getDisableClassForActions_CustomButon(customButtons[0].id,csript_disabledactions)}}" cscript-tag="customBtn_{{seModCustomButtons[0].id}}" onmouseover="{{action(\'mouseOverCustomButton\',expHandlers(\'customButtonQuery\',\'+\',compId),seModCustomButtons[0].id,encodeJS(seModCustomButtons[0].name),encodeJS(seModCustomButtons[0].description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}" data-zcqa="{{seModCustomButtons[0].name}}">{{seModCustomButtons[0].name}}</div> </template></template></template></template></template></template> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',1),\'||\',expHandlers(btnid,\'!=\',\'relatedList\')),\'||\',expHandlers(seModCustomButton.length,\'>\',1)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',1))}}"><template case="true"> <div tabindex="0" class="cbDropDownIcon dIB vaM" data-zcqa="downArrow" aria-label="{{getI18n(\'crm.label.More\')}}" lt-prop-title="{{getI18n(\'crm.label.More\')}}" role="combobox" aria-haspopup="menu"></div> </template></template> </lyte-drop-button> <lyte-drop-box class="customButtonDropBox moduleChangeDom"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',5),\'||\',expHandlers(seModCustomButton.length,\'>\',5)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',5))}}"><template case="true"> <lyte-drop-header> <lyte-search lt-prop-placeholder="Search Button" lt-prop-focus="true" on-search="{{method(\'checkResult\')}}" id="buttonSearch" lt-prop-id="customButtonSearch" lt-prop-query-selector="{&quot;scope&quot; : &quot;#cvBtnListSearch{{btnid}}&quot;, &quot;search&quot; : &quot;lyte-drop-item&quot;}" data-zcqa="CVListBtnSearchBox"> </lyte-search> </lyte-drop-header> </template></template> <lyte-drop-body class="customButtonSortable lvCustomButtonDD {{if(ifEquals(btnid,\'detailPageButton\'),\'customButtonDropBody\',\'\')}}"> <template is="if" value="{{expHandlers(isActivityModule,\'!\')}}"><template case="true"> <div id="cvBtnListSearch{{btnid}}"> <template is="for" items="{{customButtons}}" item="action" index="index"> <lyte-drop-item data-value="{{action.id}}" class="customButtonQuery{{action.id}}" cscript-tag="customBtn_{{action.id}}" data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{action.name}}</lyte-drop-item> </template> </div> <template is="if" value="{{showNoButtonDiv}}"><template case="true"> <div class="lyteDropdownNoResult dBImp">{{getI18n(\'crm.custombutton.nobuttons.found\')}}</div> </template></template> </template><template case="false"><template is="if" value="{{expHandlers(isActivityModule,\'&amp;&amp;\',expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',0),\'||\',expHandlers(seModCustomButtons.length,\'>\',0)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',0)))}}"><template case="true"> <div id="cvBtnListSearch{{btnid}}"> <div> <lyte-drop-group label="{{if(expHandlers(expHandlers(contactModCustomButtons.length,\'>\',0),\'||\',expHandlers(seModCustomButtons.length,\'>\',0)),moduleLabel,\'\')}}" id="btnDropCont_CB"> <template is="if" value="{{expHandlers(customButtons.length,\'>\',0)}}"><template case="true"> <template is="for" items="{{customButtons}}" item="action" index="index"> <lyte-drop-item data-value="{{action.id}}" class="customButtonQuery{{action.id}}" cscript-tag="customBtn_{{action.id}}" data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{action.name}}</lyte-drop-item> </template> </template><template case="false"> <div class="lyteDropdownNoResult dBImp {{if(expHandlers(customButtons.length,\'<=\',0),\'restrictSortForNoBtn\',\'\')}}">{{getI18n(\'crm.custombutton.nobuttons.found\')}}</div> </template></template> </lyte-drop-group> </div> <div> <template is="if" value="{{expHandlers(contactModCustomButtons.length,\'>\',0)}}"><template case="true"> <lyte-drop-group label="{{getI18n(\'Contacts\')}}" id="btnDropCont_CCB"> <template is="for" items="{{contactModCustomButtons}}" item="action" index="index"> <lyte-drop-item data-value="{{action.id}}" class="customButtonQuery{{action.id}}" cscript-tag="customBtn_{{action.id}}" data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{action.name}}</lyte-drop-item> </template> </lyte-drop-group> </template></template> </div> <div> <template is="if" value="{{expHandlers(seModCustomButtons.length,\'>\',0)}}"><template case="true"> <lyte-drop-group label="{{seModuleLabel}}" id="btnDropCont_SCB"> <template is="for" items="{{seModCustomButtons}}" item="action" index="index"> <lyte-drop-item data-value="{{action.id}}" class="customButtonQuery{{action.id}}" cscript-tag="customBtn_{{action.id}}" data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{action.name}}</lyte-drop-item> </template> </lyte-drop-group> </template></template> </div> </div> </template></template></template></template> </lyte-drop-body> <lyte-drop-footer> <template is="if" value="{{expHandlers(expHandlers(btnid,\'!=\',\'relatedList\'),\'&amp;&amp;\',expHandlers(isPortalPage,\'!\'))}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(getUserDetail(\'LICENSE_TYPE\'),\'!=\',\'L\'),\'&amp;&amp;\',expHandlers(getUserDetail(\'LICENSE_TYPE\'),\'!=\',\'F\')),\'&amp;&amp;\',expHandlers(getUserDetail(\'LICENSE_TYPE\'),\'!=\',\'N\'))}}"><template case="true"> <div class="customBtnLink" id="createCustomButtonDiv"> <div class="dB crmLinkColor accessibility-route-elem" tabindex="0" onclick="{{action(\'createCustomBtn\',module,position)}}" lt-prop-aria-keydown="true" role="link" data-zcqa="create_buttons">{{getI18n(\'crm.custombutton.create.newbutton\')}}</div> </div> </template></template> <div class="customBtnLink" id="manageCustomButtonDiv"> <div class="dB crmLinkColor accessibility-route-elem" tabindex="0" onclick="{{action(\'manageCustomButton\',module)}}" lt-prop-aria-keydown="true" role="link" data-zcqa="manage_buttons">{{getI18n(\'crm.custombutton.manage.button\')}}</div> </div> </template></template> </lyte-drop-footer> </lyte-drop-box> </template> </lyte-dropdown> </template></template> </template></template> </lyte-event-listener></template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1,1,0]},{type:"componentDynamic",position:[1,1,1,1]},{type:"attr",position:[1,1,1,3]},{type:"if",position:[1,1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"for",position:[1,3],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,5,1]},{type:"if",position:[1,5,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"for",position:[1,3],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"if",position:[5,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3,1]},{type:"text",position:[3,1,0]},{type:"componentDynamic",position:[3]}]}},default:{}},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3,3]},{type:"attr",position:[3,3,1]},{type:"if",position:[3,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"attr",position:[1,1,1,1]},{type:"if",position:[1,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,5,1]},{type:"if",position:[1,5,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[3,3]},{type:"attr",position:[3,5,1]},{type:"if",position:[3,5,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]}]}},default:{}},{type:"attr",position:[3,1]},{type:"text",position:[3,1,0]}]}},default:{}},{type:"componentDynamic",position:[3,5]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}],_observedAttributes:["customButtons","withoutRecord","headlessDropdown","headlessReference","fetchInfo","position","btnid","disabledButtons","renamedButtons","showNoButtonDiv","showCustomButtons","currentLayoutId","compId","tabIndex","module","record","customButtons","contactModCustomButtons","seModCustomButtons","isActivityModule","seModule","seModuleLabel","moduleLabel","recordLockingDetails","customButtonContainer","isPortalPage"],data:function(){return{customButtons:Lyte.attr("array"),withoutRecord:Lyte.attr("boolean"),headlessDropdown:Lyte.attr("boolean",{default:!1}),headlessReference:Lyte.attr("string",{default:""}),fetchInfo:Lyte.attr("boolean",{default:!1}),position:Lyte.attr("string"),btnid:Lyte.attr("string"),disabledButtons:Lyte.attr("array",{default:[]}),renamedButtons:Lyte.attr("object"),showNoButtonDiv:Lyte.attr("boolean",{default:!1}),showCustomButtons:Lyte.attr("boolean",{default:!1}),currentLayoutId:Lyte.attr("string"),compId:Lyte.attr("string"),tabIndex:Lyte.attr("string",{default:"0"}),module:Lyte.attr("string"),record:Lyte.attr("object"),customButtons:Lyte.attr("array",{default:[]}),contactModCustomButtons:Lyte.attr("array",{default:[]}),seModCustomButtons:Lyte.attr("array",{default:[]}),isActivityModule:Lyte.attr("boolean",{default:!1}),seModule:Lyte.attr("string",{default:null}),seModuleLabel:Lyte.attr("string",{default:""}),moduleLabel:Lyte.attr("string",{default:""}),recordLockingDetails:Lyte.attr("object",{default:{}}),customButtonContainer:Lyte.attr("array",{default:[]}),isPortalPage:Lyte.attr("boolean",{default:!!Crm.userDetails.CLIENT_ACCOUNT})}},init:function(){var t=this.getData("customButtons");t&&t.length&&(t=Lyte.deepCopyObject(t));var e=this.getData("currentLayoutId"),a=this.getData("position");t&&t.length&&a&&-1!==a.indexOf("list_view")&&(t=this.filterButtonsByPosition(t,a)),t&&t.length&&e&&(t=this.filterButtonsByLayout(t,e)),this.setData("customButtons",t),this.setData("customButtonContainer",t);let i=this.getData("module");const o=(moduleRecordMapping[i]||{}).plural_label||i;if(this.setData("moduleLabel",o),"Events"===i||"Tasks"===i){this.setData("isActivityModule",!0);let t=this.getData("record");if(t&&t.$se_module){this.setData("seModule",t.$se_module);const e=(moduleRecordMapping[t.$se_module]||{}).plural_label||t.$se_module;this.setData("seModuleLabel",e)}}this.filterRestrictedCustomButton(),"view"!==a&&"detail"!==a||this.getRelatedModuleCustomButtons(),this.setData("csript_disabledactions",[])},recordLockingDetails:function(){this.filterRestrictedCustomButton()}.observes("recordLockingDetails"),getRestrictedButtonIds:function(){if("undefined"!=typeof detailView&&detailView&&detailView.recordLockingDetails&&detailView.recordLockingDetails.lockingConfigJSON&&detailView.recordLockingDetails.lockingConfigJSON.length)return new Set(detailView.recordLockingDetails.lockingConfigJSON.map((t=>t.restricted_custom_buttons)).flat().filter((t=>t&&t.id)).map((t=>t.id)));{let t=this.getData("recordLockingDetails");return t&&t.restricted_custom_buttons&&t.restricted_custom_buttons.length?new Set(t.restricted_custom_buttons):new Set}},filterRestrictedCustomButton:function(){if(function(){const t=this.getData("record"),e=this.getData("recordLockingDetails");return Crm.renderDVLyteFlow(this.getData("module"))?e&&e.isLockedForMe:t&&t.$locked_for_me}.call(this)){let t=this.getRestrictedButtonIds(),e=this.getData("customButtons");e=e||[],e=e.filter((e=>!t.has(e.id))),this.setData("customButtons",e)}else this.setData("customButtons",this.getData("customButtonContainer"))},getRecordLayoutId:function(t,e,a){const i=moduleRecordMapping[t].id;i&&store.findRecord("module",i,void 0,void 0,void 0,{allowMultiple:!0}).then(function([o]){const s={position:"view",moduleName:t};store.findRecord(i,e,{fields:"Layout"},void 0,!0,{}).then(function([t]){s.layoutId=t.Layout?t.Layout.id:o.layouts[0].id,a(s)}.bind(this))}.bind(this))},getCustomButtonsPromise:function(t){return store.findAll("custom_button",{module:moduleApiMapping[t],fields:"id,name,description,profiles,layouts,sequence_number,position,details,user_types"},!0,!0,{isV6Api:!0})},getLayoutIdFromModule:function(t){const e=moduleRecordMapping[t];if(e&&e.layouts&&e.layouts.length)return e.layouts[0].id},getRelatedModuleCustomButtons:function(){let t=this.getData("record");if(this.getData("isActivityModule")&&t)if(Crm.renderDVLyteFlow(this.getData("module"))){const e=function(e){if(t.Who_Id&&e[t.Who_Id.id]){const a=t.Who_Id.record_module,[i]=e[t.Who_Id.id];let o=i&&i.$layout_id&&i.$layout_id.id;o||(o=this.getLayoutIdFromModule(a));const s=function(t){const e={position:"view",moduleName:a};o&&(e.layoutId=o),t=this.filterButtonData(t,e),t=this.executeMethod("reOrderCustomButtons",t),this.setData("contactModCustomButtons",t||[])};this.getCustomButtonsPromise(a).then(s.bind(this))}if(t.$se_module&&t.What_Id&&e[t.What_Id.id]){const a=t.What_Id.record_module,[i]=e[t.What_Id.id];let o=i&&i.$layout_id&&i.$layout_id.id;o||(o=this.getLayoutIdFromModule(a));const s=function(t){const e={position:"view",moduleName:a};o&&(e.layoutId=o),t=this.filterButtonData(t,e),t=this.executeMethod("reOrderCustomButtons",t),this.setData("seModCustomButtons",t||[])};this.getCustomButtonsPromise(a).then(s.bind(this))}},a=this.getData("uniqueListenerId");a&&Lyte.triggerEvent("detail_view_trigger_request_listener_"+a,{case:"activity_rel_module",callBackFunc:e.bind(this)})}else{const e=function(t,e,a){this.getCustomButtonsPromise(t).then(function(i){this.getRecordLayoutId(t,e,function(t){i=this.filterButtonData(i,t),i=this.executeMethod("reOrderCustomButtons",i),this.setData(a,i||[])}.bind(this))}.bind(this))};if(t.Who_Id&&e.call(this,"Contacts",t.Who_Id.id,"contactModCustomButtons"),t.$se_module&&t.What_Id){let a=t.$se_module;a=moduleApiMapping[a]||a;const i=Object.entries(moduleApiMapping).find((t=>t[1]===a));if(i){const[a]=i;e.call(this,a,t.What_Id.id,"seModCustomButtons")}}}},didConnect:function(){var t=Math.random().toString(36).substring(2,15);this.setData("compId",t),this.executeMethod("reOrderCustomButtons")},methods:{reOrderCustomButtons:function(t){var e=!0;t||(e=!1,t=this.getData("customButtons")||[]);for(var a=t.length,i=[],o=[],s={},n=0;n<a;n++)t[n].hasOwnProperty("sequence_number")&&!s.hasOwnProperty(t[n].sequence_number)?s[t[n].sequence_number]=t[n]:i.push(t[n]);var l=Object.keys(s);l.sort((function(t,e){return t-e}));var r=l.length;for(n=0;n<r;n++)o.push(s[l[n]]);var p=i.length;for(n=0;n<p;n++)o.push(i[n]);if(e)return o;this.setData("customButtons",o)},onCusttomButtonBeforeShow:function(t){if("newWindow"==CustomButtonJSObjectInit[this.getData("module")+this.getData("position")]){var e=this;return commonUtils.showHideLoadingDiv(!0),store.clearCachedQuery("custom_button",{module:this.data.module}),new Promise((function(t,a){e.getCustomButtonApiPromise({moduleApiName:moduleRecordMapping[e.getData("module")].api_name,fields:"id,name,description,profiles,layouts,sequence_number,position,details,user_types,action"}).then((function(a){commonUtils.showHideLoadingDiv(!1),e.setData("customButtons",e.filterButtonData(a,{position:e.getData("position"),moduleName:e.getData("module")})),e.executeMethod("reOrderCustomButtons"),CustomButtonJSObjectInit[e.getData("module")+e.getData("position")]=e.getData("customButtons"),t(a)}),(function(t){a(t)}))}))}if(!this.getData("headlessDropdown")&&t&&t.target.classList.contains("executeCustomButton")){let t,e=this.getData("customButtons"),a=this.getData("contactModCustomButtons"),i=this.getData("seModCustomButtons");return t=e&&e.length?e[0].id:a&&a.length?a[0].id:i[0].id,this.getData("csript_disabledactions")&&-1!==this.getData("csript_disabledactions").indexOf(t)?!1:(this.throwEvent("on-button-click",t),!1)}if(this.getData("headlessDropdown")){var a=store.peekAll("custom_button");if("canvas"===Lyte.Router.getRouteInstance().routeName){const t={position:"view",moduleName:this.getData("module")};this.getData("currentLayoutId")&&(t.layoutId=this.getData("currentLayoutId")),a=Lyte.registeredMixins["crm-view-utils"].filterButtonData(a,t);var i=$L("crm-detailview-canvas")[0];if(i){var o=i.getData("recordLockingDetails");o&&o.isLockedForMe&&o.restricted_custom_buttons&&(a=a.filter((function(t){return!o.restricted_custom_buttons.contains(t.id)})))}}this.setData("customButtons",a)}if(CustomButtonJSObjectInit.showOrHideButtons(),Crm.userDetails.isRelatedListLyteEnabled&&"relatedList"===this.getData("btnid")&&this.getData("customButtons").length<=1)return!1},checkResult:function(t){0==t.length?this.setData("showNoButtonDiv",!0):this.setData("showNoButtonDiv",!1)},onCusttomButtonShow:function(){this.addSortableDropdown()},onHide:function(){var t=document.querySelector("#buttonSearch");t&&t.setValue("")},getCurrentViewPageDetails:function(t){try{var e=Lyte.Router.getRouteInstance().routeName,a={};if("list"===e){var i=$("crm-page-navigator");if(i.length){var o=i[0].component,s=o.data.page,n=o.data.per_page,l=o.data.startIndex,r=o.data.total_count,p=l+n;p=p>r?r:p;var d=store.model[t].data,c=[];d&&d.length&&(c=d.filter((t=>t.recnum<=p&&t.recnum>l)).map((t=>t.id))),a.ids=c,a.pageNo=s}}else if("canvas"===e){let t,e=[],i=$L("crm-list-view-canvas");if(i.length){i=i[0].component;e=i.data.customview_records.map((t=>t.id)),t=i.data.page}a.ids=e||[],a.pageNo=t}return a.cvId=$("crm-customview-layer")[0].component.data.cvid,a}catch(e){throw location.href.indexOf("localzoho")>=0&&(murphy.addCustomTracking({message:"moduleId to be debugged"+t,type:"custom event"}),murphy.addCustomTracking({message:"moduleInfo to be debugged"+JSON.stringify(store.model[t]),type:"custom event"})),murphy.error(e),e}}},actions:{doCscriptActions:function(t){if("rename"===t.action){const t=CustomButtonJSObjectInit.cscriptChecks.rename,e=this.getData("customButtons");Object.keys(t).length&&e&&e.length&&e.forEach((e=>{t[e.id]&&(Lyte.objectUtils(e,"delete","name"),Lyte.objectUtils(e,"add","name",t[e.id]))})),this.setData("customButtons",e)}},mouseOverCustomButton:function(t,e,a,i){this.mouseOverCustomButton(t,e,a,i)},mouseOutCustomButton:function(){this.mouseOutCustomButton()},executeCustomButton:function(t){var e=this.getData("btnid"),a=$L("#"+e)[0];a&&a.toggle(),this.throwEvent("on-button-click",t)},createCustomBtn:function(t,e){"view"!==e&&"detail"!==e||(e="viewEntity"),CustomButtonJSObjectInit.createCustBtnPage(t,e)},manageCustomButton:function(t){CustomButtonJSObjectInit.manageCustBtn(t)}},addSortableDropdown:function(){let t=null;const e=function(t,e,a,i,o,s,n){var l=this.getData("module"),r=t.dataset.value,p=store.peekRecord("custom_button",r);let d=this.getData("customButtons");if(r&&i!==o){if(this.getData("isActivityModule")){(this.getData("seModCustomButtons").length>0||this.getData("contactModCustomButtons").length>0)&&_cruxUtils.showCustomMessage({params:{ltPropType:"info",ltPropMessage:I18n.getMsg("crm.custombutton.sort.msg")}}),p&&p.$.set("sequence_number",o);let t=this.getData("customButtons"),e=this.getData("contactModCustomButtons"),a=this.getData("seModCustomButtons");t.some((t=>t.id===r))?d=t:e.some((t=>t.id===r))?(l="Contacts",d=e):a.some((t=>t.id===r))&&(l=this.getData("seModule"),d=a),Lyte.arrayUtils(d,"insertAt",o-1,Lyte.arrayUtils(d,"removeAt",i-1))}else p.$.set("sequence_number",o+1),Lyte.arrayUtils(d,"insertAt",o,Lyte.arrayUtils(d,"removeAt",i)),l=this.getData("module");this.addSortableDropdown(),moduleApiMapping[l]&&(l=moduleApiMapping[l]);const e=function(){const t=$L("crm-custom-button lyte-dropdown"),e=this.getData("csript_disabledactions");t.length&&(t[0].ltProp("disabledList",[]),t[0].ltProp("disabledList",e))};e.call(this);const a=function(){Lyte.registeredMixins["crm-view-utils"].clearCustomButtonCache(l)};store.triggerUpdate("custom_button",t.dataset.value,["sequence_number"],{module:l},{isV6Api:!0}).then(a.bind(this)).finally(e.bind(this))}n.preventDefault()};if(this.getData("isActivityModule")){let a="#cvBtnListSearch"+this.data.btnid+" lyte-drop-group",i=$L("#"+this.data.btnid,this.$node)[0].component.childComp;t=$L(a,i);let o=t.length;for(let a=0;a<o;a++){let i=t[a].id;t.eq(a).sortable({onDrop:e.bind(this),containment:"#"+i,restrict:"#"+i+" lyte-drop-label,.restrictSortForNoBtn"})}}else t=$L("#cvBtnListSearch"+this.data.btnid,$L("#"+this.data.btnid,this.$node)[0].component.childComp),t.sortable({onDrop:e.bind(this),preventDefault:{mousedown:!1}})}},{mixins:["crm-view-utils","crm-custom-button-mixin"]}),Lyte.Component.registerHelper("getDisableClassForActions_CustomButon",(function(t,e){return e&&-1!==e.indexOf(t)?" disable cDefault ":""})),Lyte.Component.register("crm-custombuttons-popover",{_template:'<template tag-name="crm-custombuttons-popover"> <lyte-popover lt-prop-wrapper-class="customButtonPopover" id="customButtonPopover" lt-prop-max-width="280px" lt-prop-show-close-button="false" lt-prop-freeze="false"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <div class="labelNameColor crmBaseColor crm-base-font-size crm-font-semibold mB5">{{getI18n(\'crm.custombutton.name\')}}:</div> <div class="crm-base-font-size crmBaseColor">{{popoverName}}</div> <template is="if" value="{{popoverDescription}}"><template case="true"> <div class="labelNameColor mT15 crmBaseColor crm-base-font-size crm-font-semibold mB5">{{getI18n(\'crm.customize.custombutton.function.desc\')}}:</div> <div class="wwBreakWord crm-base-font-size baseColor">{{popoverDescription}}</div> </template></template> </lyte-popover-content> </template> </lyte-popover> </template>',_dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1,1,0]},{type:"text",position:[1,3,0]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"text",position:[3,0]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["popoverName","popoverDescription","originElement","position","customButtonFocus"],data:function(){return{popoverName:Lyte.attr("string"),popoverDescription:Lyte.attr("string"),originElement:Lyte.attr("string"),position:Lyte.attr("string"),customButtonFocus:Lyte.attr("boolean",{default:!1})}},onMouseOver:function(t,e,a,i){if(a||Math.ceil($L(t).outerWidth())<Math.ceil($L(t)[0].scrollWidth)){var o=this;if(this.setData("customButtonFocus",!0),o.getData("customButtonFocus")){o.setData("popoverName",e),o.setData("popoverDescription",null!=a?a:"");var s=document.getElementsByTagName("crm-custombuttons-popover")[0].querySelector("lyte-popover");i&&o.setData("position",i),s.ltProp("placement",this.getData("position")),s.ltProp("originElem",t),s.ltProp("show",!0)}}},onMouseOut:function(){document.getElementsByTagName("crm-custombuttons-popover")[0].querySelector("lyte-popover").ltProp("show",!1),this.setData("customButtonFocus",!1)}});
