Lyte.Component.register("crm-view-container",{_template:'<template tag-name="crm-view-container"> <crm-list-view manage_columns_visible="{{manage_columns_visible}}" custom-method-implemented="{{customMethodImplemented}}" is-pin-unpin-supported="{{isPinUnpinSupported}}" render-without-custom-view="{{renderWithoutCustomView}}" save-button-literal="{{saveButtonLiteral}}" manage-column-disable-literal="{{manageColumnDisableLiteral}}" related_lists="{{related_lists}}" show-last-added-note="{{showLastAddedNote}}" hide-activity-badge="{{hideActivityBadge}}" show-activity-quick-create="{{showActivityQuickCreate}}" rec-idvs-note-count="{{recIdvsNoteCount}}" show-filter-by="{{showFilterBy}}" show-note="{{showNote}}" is-blocked-reason="{{isBlockedReason}}" class="dB" reset_scroll="{{reset_scroll}}" cv_sys_name="{{cv_sys_name}}" no_record_message="{{no_record_message}}" more_records="{{more_records}}" module_info="{{module_info}}" custom_buttons="{{custom_buttons}}" listfields="{{listfields}}" customview_records="{{customview_records}}" list_cv_btn="{{list_cv_btn}}" module="{{module}}" page="{{page}}" start_index="{{start_index}}" total_count="{{total_count}}" selected-ids="{{selectedIds}}" sort-details="{{sortDetails}}" is-from-modal="{{isFromModal}}" feature-name="{{featureName}}" begin_page="{{begin_page}}" is-resize-enabled="{{isResizeEnabled}}" is-clip-wrap-enabled="{{isClipWrapEnabled}}" show-manage-column="{{showManageColumn}}" search_letter="{{search_letter}}" search_field="{{search_field}}" clip_mode="{{lbind(clip_mode)}}" query-params="{{lbind(queryParams)}}" feature-object="{{featureObject}}" module-actions-menu="{{moduleActionsMenu}}" persist-pin-update="{{persistPinUpdate}}" persist-width-update="{{persistWidthUpdate}}" persist-wrap-update="{{persistWrapUpdate}}" persist-manage-columns="{{persistManageColumns}}" on-select-entity="{{method(\'selectRecord\')}}" on-select-all-entities="{{method(\'selectAllRecords\')}}"></crm-list-view> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}],_observedAttributes:["selectedIds","module_info","sortDetails","isBlockedReason","manage_columns_visible","page","isFromModal","featureName","featureObject","queryParams","renderWithoutCustomView","saveButtonLiteral","manageColumnDisableLiteral","isPinUnpinSupported","customMethodImplemented"],data:function(){return{selectedIds:Lyte.attr("array",{default:[]}),module_info:Lyte.attr("object"),sortDetails:Lyte.attr("array",{default:[]}),isBlockedReason:Lyte.attr("boolean"),manage_columns_visible:Lyte.attr("boolean",{default:!0}),page:Lyte.attr("number"),isFromModal:Lyte.attr("boolean",{default:!1}),featureName:Lyte.attr("string"),featureObject:Lyte.attr("object",{default:{}}),queryParams:Lyte.attr("object",{default:{}}),renderWithoutCustomView:Lyte.attr("boolean",{default:!1}),saveButtonLiteral:Lyte.attr("string"),manageColumnDisableLiteral:Lyte.attr("string",{default:"crm.listview.customview.locked"}),isPinUnpinSupported:Lyte.attr("boolean",{default:!0}),customMethodImplemented:Lyte.attr("boolean",{default:!1})}},methods:{selectAllRecords:function(){this.getMethods("onSelectAllEntities")&&this.executeMethod("onSelectAllEntities")},selectRecord:function(e,t){this.getMethods("onSelectEntity")&&this.executeMethod("onSelectEntity",e,t)}}}),Lyte.Component.register("crm-view-edit-icon",{_template:"<template tag-name=\"crm-view-edit-icon\"> <div class=\"{{if(from_listview,'','aligncenter')}}\" onclick=\"{{action('stopPropagation',event)}}\" id=\"listViewIcons_{{record.id}}\"> <template is=\"if\" value=\"{{expHandlers(expHandlers(module,'==',&quot;Appointments&quot;),'&amp;&amp;',expHandlers(from_globalsearchview,'!'))}}\"><template case=\"true\"><template is=\"if\" value=\"{{hasAppMoreOptionsMenu}}\"><template case=\"true\"> <a class=\"svgIcons moreOptionIcon mL5 dIB vaM moreOptVertical lvmoreIcon\" data-zcqa=\"appMoreOptionList\" id=\"listViewAppMore_{{record.id}}\" href=\"javascript:;\" focusable=\"true\"></a> </template></template></template><template case=\"false\"><template is=\"if\" value=\"{{expHandlers(expHandlers(from_globalsearchview,'!'),'&amp;&amp;',expHandlers(expHandlers(expHandlers(record.$activity_type,'==',&quot;Events&quot;),'||',expHandlers(module,'==',&quot;Events&quot;)),'||',expHandlers(expHandlers(expHandlers(record.$activity_type,'==',&quot;Calls&quot;),'||',expHandlers(module,'==',&quot;Calls&quot;)),'&amp;&amp;',module_info.new_call_view)))}}\"><template case=\"true\"><template is=\"if\" value=\"{{expHandlers(expHandlers(record.$activity_type,'==',&quot;Events&quot;),'||',expHandlers(record.$activity_type,'==',&quot;Calls&quot;))}}\"><template case=\"true\"> <a class=\"icon-hover-effects icon-hover-lg {{if(fromListView,'pA lvEditIcon','mT_4')}}\" focusable=\"true\" data-cid=\"editbtn\" lt-prop-id=\"listViewEdit_{{record.id}}\" data-zcqa=\"listViewEdit_{{record.id}}\" onclick=\"{{action('eventEditPopup',this)}}\" id=\"listViewEdit_{{record.id}}\" href=\"{{if(clientPortalName,concat('/portal/',clientPortalName,getCrmBasePath(),'/EditEntity.do?module=',record.$activity_type,'&amp;id=',record.id,'&amp;cvid=',cvid,'&amp;recordNum=',record.recnum,'&amp;FROM_INDEX=',fromIndex,'&amp;TO_INDEX=',toIndex),concat(getCrmBasePath(),'/',crmPortal,'/EditEntity.do?module=',record.$activity_type,'&amp;id=',record.id,'&amp;cvid=',cvid,'&amp;recordNum=',record.recnum,'&amp;FROM_INDEX=',fromIndex,'&amp;TO_INDEX=',toIndex))}}\" data-params=\"{&quot;module&quot;:&quot;{{record.$activity_type}}&quot;,&quot;id&quot;:&quot;{{record.id}}&quot;,&quot;cvid&quot;:&quot;{{cvid}}&quot;,&quot;recordNum&quot;:&quot;{{record.recnum}}&quot;,&quot;from&quot;:&quot;listview&quot;}\"><span class=\"zcicncss-editFilled zcicn-cssIcons zcicncss13 zcicn_black_mask zi2\"></span></a> </template><template case=\"false\"> <a class=\"icon-hover-effects icon-hover-lg {{if(fromListView,'pA lvEditIcon','mT_4')}}\" focusable=\"true\" data-cid=\"editbtn\" lt-prop-id=\"listViewEdit_{{record.id}}\" data-zcqa=\"listViewEdit_{{record.id}}\" onclick=\"{{action('eventEditPopup',this)}}\" id=\"listViewEdit_{{record.id}}\" href=\"{{if(clientPortalName,concat('/portal/',clientPortalName,getCrmBasePath(),'/EditEntity.do?module=',module,'&amp;id=',record.id,'&amp;cvid=',cvid,'&amp;recordNum=',record.recnum,'&amp;FROM_INDEX=',fromIndex,'&amp;TO_INDEX=',toIndex),concat(getCrmBasePath(),'/',crmPortal,'/EditEntity.do?module=',module,'&amp;id=',record.id,'&amp;cvid=',cvid,'&amp;recordNum=',record.recnum,'&amp;FROM_INDEX=',fromIndex,'&amp;TO_INDEX=',toIndex))}}\" data-params=\"{&quot;module&quot;:&quot;{{module}}&quot;,&quot;id&quot;:&quot;{{record.id}}&quot;,&quot;cvid&quot;:&quot;{{cvid}}&quot;,&quot;recordNum&quot;:&quot;{{record.recnum}}&quot;,&quot;from&quot;:&quot;listview&quot;}\"><span class=\"zcicncss-editFilled zcicn-cssIcons zcicncss13 zcicn_black_mask zi2\"></span></a> </template></template> </template><template case=\"false\"><template is=\"if\" value=\"{{expHandlers(expHandlers(isClientPortalUser,'!'),'||',expHandlers(isClientPortalUser,'&amp;&amp;',checkPermission('Crm_Implied_Edit',module)))}}\"><template case=\"true\"> <template is=\"if\" value=\"{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(module,'==',&quot;Events&quot;),'||',expHandlers(module,'==',&quot;Calls&quot;)),'||',expHandlers(module,'==',&quot;Tasks&quot;)),'||',expHandlers(module,'==',&quot;Appointments&quot;)),'&amp;&amp;',from_globalsearchview)}}\"><template case=\"true\"> {{log('check this')}} <div onclick=\"{{action('eventEditPopup',this)}}\" data-params=\"{&quot;module&quot;:&quot;{{module}}&quot;,&quot;id&quot;:&quot;{{record.id}}&quot;,&quot;cvid&quot;:&quot;{{cvid}}&quot;,&quot;recordNum&quot;:&quot;{{record.recnum}}&quot;,&quot;from&quot;:&quot;listview&quot;}\"> <a class=\"dIB cgsEditAnchor\" data-cid=\"editbtn\" lt-prop-id=\"listViewEdit_{{record.id}}\" data-zcqa=\"listViewEdit_{{record.id}}\" id=\"listViewEdit_{{record.id}}\" href=\"{{if(clientPortalName,concat('/portal/',clientPortalName,getCrmBasePath(),'/EditEntity.do?module=',module,'&amp;id=',record.id,'&amp;cvid=',cvid,'&amp;recordNum=',record.recnum,'&amp;FROM_INDEX=',fromIndex,'&amp;TO_INDEX=',toIndex),concat(getCrmBasePath(),'/',crmPortal,'/EditEntity.do?module=',module,'&amp;id=',record.id,'&amp;cvid=',cvid,'&amp;recordNum=',record.recnum,'&amp;FROM_INDEX=',fromIndex,'&amp;TO_INDEX=',toIndex))}}\"> {{getI18n(\"crm.button.edit\")}} </a> </div> </template><template case=\"false\"><template is=\"if\" value=\"{{expHandlers(module,'==',&quot;Notes&quot;)}}\"><template case=\"true\"> <div class=\"cgsEditAnchor\" onclick=\"{{action('editNotesDiv',record.id)}}\"> {{getI18n(\"crm.button.edit\")}} </div> </template><template case=\"false\"> <template is=\"if\" value=\"{{expHandlers(expHandlers(expHandlers(expHandlers(module,'==',&quot;Events&quot;),'||',expHandlers(module,'==',&quot;Calls&quot;)),'||',expHandlers(module,'==',&quot;Tasks&quot;)),'||',expHandlers(module,'==',&quot;Appointments&quot;))}}\"><template case=\"true\"> <link-to data-zcqa=\"listViewEdit_{{record.id}}\" lt-prop-route=\"crm.tab.module.entity.edit\" lt-prop-id=\"listViewEdit_{{record.id}}\" lt-prop-class=\"link dIB vaT {{if(from_listview,'','neweditIcon listEditIcon')}} cgsEditAnchor {{if(fromListView,'pA lvEditIcon','mT_4')}}\" lt-prop-dp=\"[&quot;{{module}}&quot;,&quot;{{record.id}}&quot;]\" lt-prop-td=\"{&quot;recordNum&quot;:&quot;{{record.recnum}}&quot;}\" lt-prop-qp=\"{{if(ifEquals(module,'Activities'),concat('{&quot;sub_module&quot; :&quot;',record.$activity_type,'&quot;}'))}}\"> <template is=\"if\" value=\"{{expHandlers(from_listview,'||',from_globalsearchview)}}\"><template case=\"true\"> {{getI18n(\"crm.button.edit\")}} </template></template> </link-to> </template><template case=\"false\"> <link-to data-zcqa=\"listViewEdit_{{record.id}}\" lt-prop-route=\"crm.tab.module.entity.edit\" lt-prop-id=\"listViewEdit_{{record.id}}\" lt-prop-class=\"link dIB vaT {{if(from_listview,'','neweditIcon listEditIcon')}} cgsEditAnchor\" lt-prop-dp=\"[&quot;{{module}}&quot;,&quot;{{record.id}}&quot;]\" lt-prop-td=\"{&quot;recordNum&quot;:&quot;{{record.recnum}}&quot;}\" lt-prop-qp=\"{{if(ifEquals(module,'Activities'),concat('{&quot;sub_module&quot; :&quot;',record.$activity_type,'&quot;}'))}}\"> <template is=\"if\" value=\"{{expHandlers(from_listview,'||',from_globalsearchview)}}\"><template case=\"true\"> {{getI18n(\"crm.button.edit\")}} </template></template> </link-to> </template></template> </template></template></template></template></template></template></template></template></template></template> <template is=\"if\" value=\"{{expHandlers(expHandlers(activityBadgeUpgrade,'&amp;&amp;',expHandlers(expHandlers(expHandlers(expHandlers(module,'==',&quot;Appointments&quot;),'||',expHandlers(module,'==',&quot;Tasks&quot;)),'||',expHandlers(module,'==',&quot;Events&quot;)),'||',expHandlers(module,'==',&quot;Calls&quot;))),'&amp;&amp;',expHandlers(notesBadge,'===',&quot;enabled&quot;))}}\"><template case=\"true\"> <span id=\"notesBadge\" data-zcqa=\"noteBadge_{{record.id}}\" lt-prop-title=\"{{if(disableNotesBadge,getI18n('crm.creator.error.access'),if(expHandlers(isNoteRLVisible,'!'),getI18n('crm.customview.rl.hidden',getI18n('crm.label.notes'))))}}\" lt-prop-tooltip-config=\"{&quot;position&quot;:&quot;bottomright&quot;, &quot;appearance&quot; : &quot;box&quot;}\" class=\"lvNoteIcon icon-hover-effects icon-hover-lg {{if(disableNotesBadge,'disabled cNotAllowed',if(expHandlers(isNoteRLVisible,'!'),'cNotAllowed'))}} {{if(expHandlers(recordObj.noteCount,'>',0),'recordNotesicon showIcon','createNotesicon')}}\" onclick=\"{{action(&quot;showWorkQueueNote&quot;,event,this,record)}}\" onmouseenter=\"{{action('showLatestNote',event,this,record)}}\" onmouseleave=\"{{action('closeLatestNote',event,this)}}\"> <span class=\"zcicncss-notes-lg zcicn-cssIcons zcicncss15 zcicn_black_mask zi2\"></span> </span> </template></template> <template is=\"if\" value=\"{{expHandlers(from_globalsearchview,'!')}}\"><template case=\"true\"><template is=\"if\" value=\"{{hasCallMoreOptionsMenu}}\"><template case=\"true\"> <a class=\"icon-hover-effects icon-hover-lg pA lvmoreIcon\" focusable=\"true\" data-zcqa=\"callMoreOption\" id=\"listViewMore_{{record.id}}\" href=\"javascript:;\"><span class=\"zcicncss-morehr zcicn-cssIcons zcicn_black_mask zi2\"></span></a> </template><template case=\"false\"><template is=\"if\" value=\"{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(module,'==',&quot;Activities&quot;),'&amp;&amp;',expHandlers(record.$activity_type,'==',&quot;Tasks&quot;)),'&amp;&amp;',record.Status),'&amp;&amp;',expHandlers(record.Status,'!=',&quot;Completed&quot;)),'&amp;&amp;',expHandlers(record.$process_flow,'!=',true)),'&amp;&amp;',hasCompleteTaskPermission),'&amp;&amp;',expHandlers(clientPortalName,'!'))}}\"><template case=\"true\"> <a class=\"icon-hover-effects icon-hover-lg pA lvCloseTaskIcon\" focusable=\"true\" href=\"javascript:void(0)\" close-task=\"{{concat('closeTask(&quot;',getCrmBasePath(),'/closeTask.do?action=CloseTask&amp;taskid=',record.id,'&amp;id=',record.id,'&amp;module=Activities&quot;)')}}\" data-zcqa=\"listViewClose_{{record.id}}\" id=\"listViewClose_{{record.id}}\" onclick=\"{{action(&quot;closeTask&quot;,record.id)}}\"><span href=\"javascript:void(0)\" class=\"zcicncss-tickfilled zcicn-cssIcons zcicn_green_mask zi2\" close-task=\"{{concat('closeTask(&quot;',getCrmBasePath(),'/closeTask.do?action=CloseTask&amp;taskid=',record.id,'&amp;id=',record.id,'&amp;module=Activities&quot;)')}}\"></span></a> </template><template case=\"false\"><template is=\"if\" value=\"{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(module,'===',&quot;Tasks&quot;),'&amp;&amp;',record.Status),'&amp;&amp;',expHandlers(record.Status,'!=',&quot;Completed&quot;)),'&amp;&amp;',expHandlers(record.$process_flow,'!=',true)),'&amp;&amp;',hasCompleteTaskPermission),'&amp;&amp;',expHandlers(clientPortalName,'!'))}}\"><template case=\"true\"> <span class=\"icon-hover-effects icon-hover-lg pA lvCloseTaskIcon\" href=\"javascript:void(0)\" close-task=\"{{concat('closeTask(&quot;',getCrmBasePath(),'/closeTask.do?action=CloseTask&amp;taskid=',record.id,'&amp;id=',record.id,'&amp;module=Tasks&quot;)')}}\" data-zcqa=\"listViewClose_{{record.id}}\" id=\"listViewClose_{{record.id}}\" onclick=\"{{action(&quot;closeTask&quot;,record.id)}}\"><span href=\"javascript:void(0)\" class=\"zcicncss-tickfilled zcicn-cssIcons zcicn_green_mask zi2\" close-task=\"{{concat('closeTask(&quot;',getCrmBasePath(),'/closeTask.do?action=CloseTask&amp;taskid=',record.id,'&amp;id=',record.id,'&amp;module=Tasks&quot;)')}}\"></span></span> </template></template></template></template></template></template></template></template> </div> </template>",_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1]},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"text",position:[3,1,1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}],_observedAttributes:["clientPortalName","crmPortal","module_info","lyteUnbound","hasCallMoreOptionsMenu","hasAppMoreOptionsMenu","from_listview","from_globalsearchview","hasCompleteTaskPermission","isClientPortalUser","notesBadge","fromListView"],data:function(){return{clientPortalName:Lyte.attr("string"),crmPortal:Lyte.attr("string"),module_info:Lyte.attr("object"),lyteUnbound:Lyte.attr("boolean",{default:!1}),hasCallMoreOptionsMenu:Lyte.attr("boolean",{default:!1}),hasAppMoreOptionsMenu:Lyte.attr("boolean",{default:!1}),from_listview:Lyte.attr("boolean",{default:!1}),from_globalsearchview:Lyte.attr("boolean",{default:!1}),hasCompleteTaskPermission:Lyte.attr("boolean",{default:!0}),isClientPortalUser:Lyte.attr("boolean",{default:!1}),notesBadge:Lyte.attr("string"),fromListView:Lyte.attr("boolean",{default:!1})}},init:function(){this.setData("isClientPortalUser",Crm.userDetails.CLIENT_ACCOUNT),this.setData("clientPortalName",window.clientPortalName),this.setData("crmPortal",crmPortal),this.setData("tooltipconf",{position:"bottomRight",appearance:"box"});var e=this.getData("module"),t=this.getData("record");if(this.getData("from_globalsearchview"))this.setData("hasAppMoreOptionsMenu",!1);else{if(("Activities"!==e||"Calls"!==t.$activity_type)&&"Calls"!==e||"Overdue"!==t.Call_Status&&"Scheduled"!==t.Call_Status&&t.Outgoing_Call_Status!==this.getPickListTranslatedvalueFromActualValue({api_name:"Outgoing_Call_Status"},"Overdue")&&t.Outgoing_Call_Status!==this.getPickListTranslatedvalueFromActualValue({api_name:"Outgoing_Call_Status"},"Scheduled")||isNewCallView&&!Crm.userDetails.permissions.Crm_Implied_Edit_Calls&&t.Owner.id!=Crm.userDetails.USER_ID||this.setData("hasCallMoreOptionsMenu",!0),"Appointments"===e){var a=$L("crm-list-view-canvas")[0];a||!Crm.userDetails.permissions.Crm_Implied_Edit_Appointments&&!Crm.userDetails.permissions.Crm_Implied_Delete_Appointments?a&&Crm.userDetails.permissions.Crm_Implied_Edit_Appointments&&this.setData("hasAppMoreOptionsMenu",!0):this.setData("hasAppMoreOptionsMenu",!0)}"Activities"!==e&&"Tasks"!==e||this.setData("hasCompleteTaskPermission",this.getData("module_info").hasCompleteTaskPermission)}this.setData("activityBadgeUpgrade",Crm.userDetails.activityBadgeUpgradeEnabled)},actions:{showNotesDiv:function(e){this.$node.closest("lyte-menu-box").parent.ltProp("show",!1),Notes.showNotesDiv("/crm/viewnote.do?type=gsearch&notesid="+e,"ViewNote")},editNotesDiv:function(e){this.$node.closest("lyte-menu-box").parent.ltProp("show",!1),Notes.showNotesDiv("/crm/editnote.do?type=gsearch&notesid="+e+"&actionType=EditFromGSearchView&noteNumber=-1&noteSortColumn=&noteSortOrder=","CustomViewDetails")},stopPropagation:function(e){this.data.from_listview||e.stopPropagation()},eventEditPopup:function(e){Crm.editEntity(event,e),event.preventDefault(),this.$node.closest("lyte-menu-box").parent.ltProp("show",!1)},closeTask:function(e){Crm.isActivitySplitDone?closeTask(Crm.getCrmBasePath()+"/closeTask.do?action=CloseTask&taskid="+e+"&id="+e+"&module=Tasks"):closeTask(Crm.getCrmBasePath()+"/closeTask.do?action=CloseTask&taskid="+e+"&id="+e+"&module=Activities")},showLatestNote:function(e,t,a){this.throwEvent("showLatestNote",e,t,a)},closeLatestNote:function(e,t){this.throwEvent("closeLatestNote",e,t)},showWorkQueueNote:function(e,t,a){this.throwEvent("showWorkQueueNote",e,t,a)}},getPickListTranslatedvalueFromActualValue:function(e,t){var a=store.peekAll("field").filterBy(e)[0];if(t&&a&&"picklist"===a.data_type)for(var i=a.pick_list_values,o=i.length,s=0;s<o;s++)if(t===i[s].actual_value)return i[s].display_value}}),Lyte.Component.register("crm-list-view",{_template:'<template tag-name="crm-list-view"> <div class="lv_table_holder {{if(cvObj.displayFilters,\'cvFilters_show\')}}"> <div id="listviewtablescroll" class="ltTable pR newListOLY {{if(expHandlers(cv_width_updated,\'!\'),\'listWAutoClass\')}}" style="max-height:{{lvheight}}"> <crm-inner-list manage_columns_visible="{{manage_columns_visible}}" custom-method-implemented="{{customMethodImplemented}}" render-without-custom-view="{{renderWithoutCustomView}}" save-button-literal="{{saveButtonLiteral}}" manage-column-disable-literal="{{manageColumnDisableLiteral}}" related_lists="{{related_lists}}" is-from-modal="{{isFromModal}}" feature-name="{{featureName}}" latest_ent_row="{{latestEntRow}}" prefix-yields="{{prefixYields}}" suffix-yields="{{suffixYields}}" cv_system_name="{{cv_sys_name}}" no_record_message="{{no_record_message}}" enable_body_scroll="{{enableBodyScroll}}" module="{{module}}" start_index="{{start_index}}" page="{{page}}" customfields="{{customfields}}" customview_records="{{cvrecords}}" list_cv_btn="{{list_cv_btn}}" fieldmapping="{{fieldMapping}}" module_info="{{module_info}}" field-mapping="{{fieldMapping}}" selected-ids="{{selectedIds}}" displayfield="{{displayfield}}" header-yields="{{headerYields}}" is-resize-enabled="{{isResizeEnabled}}" show-last-added-note="{{showLastAddedNote}}" hide-activity-badge="{{hideActivityBadge}}" show-activity-quick-create="{{showActivityQuickCreate}}" show-note="{{showNote}}" is-clip-wrap-enabled="{{isClipWrapEnabled}}" show-manage-column="{{showManageColumn}}" begin_page="{{begin_page}}" search_letter="{{search_letter}}" search_field="{{search_field}}" clip_mode="{{lbind(clip_mode)}}" cv_width_updated="{{lbind(cv_width_updated)}}" query-params="{{lbind(queryParams)}}" feature-object="{{featureObject}}" sort-by-comp="{{sortByComp}}" module-actions-menu="{{moduleActionsMenu}}" show-sort-icon="{{showSortIcon}}" pined_fields_limit="{{pined_fields_limit}}" persist-pin-update="{{persistPinUpdate}}" persist-width-update="{{persistWidthUpdate}}" persist-wrap-update="{{persistWrapUpdate}}" on-select-entity="{{method(\'selectRecord\')}}" on-select-all-entities="{{method(\'selectAllRecords\')}}" activity-badge="{{activityBadge}}" notes-badge="{{notesBadge}}"> </crm-inner-list> </div> </div> <div id="customBtns" style="height:0"> <template is="if" value="{{list_cv_btn.length}}"><template case="true"> <div id="customBtn" class="clearFix listViewCB"> <lyte-button cscript-tag="customBtn_{{list_cv_btn[0].id}}" class="cvButtonQuery{{list_cv_btn[0].id}} lv_cvbtn fL" lt-prp-value="{{list_cv_btn[0].name}}" onmouseover="{{action(\'mouseOverCustomButton\',\'cvButtonQuery\',list_cv_btn[0].id,encodeJS(list_cv_btn[0].name),encodeJS(list_cv_btn[0].description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}" lt-prop-id="custom_button" lt-prop-class="custBtnSortFunc custBtnEachRec lyteSm" onclick="{{action(&quot;executeCustomButton&quot;,list_cv_btn[0].id,this)}}"> <template is="registerYield" yield-name="text"> {{list_cv_btn[0].name}} </template> </lyte-button> <template is="if" value="{{expHandlers(list_cv_btn.length,\'>\',1)}}"><template case="true"> <a id="customBtnList" class="cbDropDownIcon fL cP" onclick="{{action(\'stopPropagation\',event)}}"></a> </template></template> </div> </template></template> </div> <lyte-menu lt-prop-position="downAlignLeft" id="cvMenuId" lt-prop-wrapper-class="cvButtonLayerNew" lt-prop-yield="true" lt-prop-freeze="false" lt-prop-event="click" lt-prop-query="#customBtnList" on-before-open="{{method(\'customBtnClick\')}}" on-menu-click="{{method(\'executeCustomButton\')}}" on-open="{{method(\'makeSortableBtn\')}}" on-close="{{method(\'hideMenu\')}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body id="cvBtnContainer"> <template is="if" value="{{expHandlers(list_cv_btn.length,\'>\',5)}}"><template case="true"> <lyte-search id="cvBtnSearch" lt-prop-placeholder="Search Button" lt-prop-query-selector="{&quot;scope&quot; : &quot;#customButtonsList&quot;, &quot;search&quot; : &quot;lyte-menu-item&quot;}" data-zcqa="CVBtnSearchBox" on-search="{{method(\'setCss\')}}"> </lyte-search> </template></template> <div id="customButtonsList" class="customButtonsList" onmouseleave="{{action(\'customBtnMouseOut\',this)}}" style="max-height:165px;"> <template is="for" items="{{list_cv_btn}}" item="action" index="index"> <lyte-menu-item data-value="{{action.id}}" class="customButtonQuery{{action.id}}" cscript-tag="customBtn_{{action.id}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}"> {{action.name}} </lyte-menu-item> </template> </div> </lyte-menu-body> </template> </lyte-menu> <lyte-menu lt-prop-yield="true" lt-prop-aria="{{isAccessibilityConfigSupported}}" id="sort_menu" lt-prop-event="click" lt-prop-query="lyte-exptable-th.sort .cxTableSortIcon" on-menu-click="{{method(\'sortRecord\')}}" data-zcqa="sort_div" lt-prop-freeze="false" on-before-open="{{method(\'sortButtonDisplay\')}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body id="sort_div" class="newSortMenu newLvDropdown crmSortMenu"> <template is="for" items="{{sortDetails}}" item="order" index="index"> <lyte-menu-item data-value="{{order}}" data-zcqa="sorting_{{order}}" lt-prop-tooltip-class="crmWhiteTooltip" id="sorting_{{order}}" class="sortItemMenu {{if(expHandlers(expHandlers(expHandlers(expHandlers(pined_fields_length,\'>=\',pined_fields_limit),\'&amp;&amp;\',expHandlers(order,\'===\',\'Pin Column\')),\'||\',expHandlers(islockedListView,\'&amp;&amp;\',expHandlers(expHandlers(order,\'===\',\'Pin Column\'),\'||\',expHandlers(order,\'===\',\'UnPin Column\')))),\'||\',expHandlers(disableHideOpt,\'&amp;&amp;\',expHandlers(order,\'===\',\'Hide Column\'))),\'disabled cNotAllowed\',\'\')}}" lt-prop-tooltip-config="{&quot;showdelay&quot;:600, &quot;position&quot; : &quot;bottom&quot;}" lt-prop-title="{{if(expHandlers(order,\'===\',&quot;Hide Column&quot;),if(pinnedColumn,getI18n(&quot;crm.customview.hide.pinned.column&quot;),if(islockedListView,getI18n(&quot;crm.listview.customview.locked&quot;),if(disableHideOpt,getI18n(&quot;crm.customview.min.mandatory.field&quot;)))),if(islockedListView,if(expHandlers(order,\'===\',&quot;Pin Column&quot;),getI18n(&quot;crm.customview.lock.pin.disable&quot;),getI18n(&quot;crm.customview.lock.unpin.disable&quot;)),if(expHandlers(expHandlers(pined_fields_length,\'>=\',pined_fields_limit),\'&amp;&amp;\',expHandlers(order,\'===\',&quot;Pin Column&quot;)),if(expHandlers(pined_fields_limit,\'>\',1),getI18n(&quot;crm.customview.pin.unpin.maximum.limit.new&quot;,pined_fields_limit),getI18n(&quot;crm.customview.pin.unpin.maximum.limit.new&quot;,pined_fields_limit)))))}}"> <template is="if" value="{{expHandlers(order,\'==\',&quot;unsort&quot;)}}"><template case="true"> {{getI18n("crm.column.unsort")}} <crmutil-icon icon-name="close-9" icon-class="zcicn-close-9 zcicn9 crmBaseIcon " class="unsortFiels"></crmutil-icon> </template><template case="false"><template is="if" value="{{expHandlers(order,\'==\',&quot;Filter By&quot;)}}"><template case="true"> <span class="zcicncss-filter zcicn-cssIcons zcicn_black_mask"></span> {{sortDisplayDetails[order]}} </template><template case="false"><template is="if" value="{{expHandlers(order,\'==\',&quot;Hide Column&quot;)}}"><template case="true"> <span class="zcicncss-eye-closed zcicn-cssIcons zcicncss16"></span> {{sortDisplayDetails[order]}} </template><template case="false"> {{sortDisplayDetails[order]}} </template></template></template></template></template></template><template is="if" value="{{ifAnyMatch(order,\'=\',\'asc\',order,\'=\',\'desc\')}}"><template case="true"> <span class="dIB zcicncss-arrowasc {{if(ifEquals(order,\'asc\'),\'\',\'zcicn-rotate-180\')}} zcicn-cssIcons"></span> </template><template case="false"><template is="if" value="{{ifAnyMatch(order,\'=\',\'Pin Column\',order,\'=\',\'UnPin Column\')}}"><template case="true"> <crmutil-icon icon-name="{{if(ifEquals(order,\'Pin Column\'),\'thumbtack\',\'thumbuntack\')}}" class="lvPinIcon" icon-class="zcicn-{{if(ifEquals(order,\'Pin Column\'),\'thumbtack\',\'thumbuntack\')}} crmBaseIcon"></crmutil-icon> </template></template></template></template> </lyte-menu-item> </template> </lyte-menu-body> </template> </lyte-menu> <lyte-popover lt-prop-origin-elem="#custom_button" lt-prop-freeze="false"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <div class="crmBaseColor crm-small-font-size">{{getI18n(\'Name\')}}:</div> <div id="btnToolTipNameDiv"></div> <div class="crmBaseColor mT15 crm-small-font-size" id="btnDesc">{{getI18n(\'Description\')}}:</div> <div id="btnToolTipDescDiv"></div> </lyte-popover-content> </template> </lyte-popover> <div id="columnList" style="display:none;position:fixed;z-index:2" onclick="{{action(\'stopPropagation\',event)}}"></div> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'max-height:'","lvheight"]}}}},{type:"attr",position:[1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[5]},{type:"registerYield",position:[5,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"attr",position:[1,3,1]},{type:"for",position:[1,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[5]},{type:"attr",position:[7]},{type:"registerYield",position:[7,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[3]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,2]},{type:"if",position:[1,2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[7]},{type:"registerYield",position:[9,1],dynamicNodes:[{type:"text",position:[1,1,0]},{type:"text",position:[1,5,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[9]},{type:"attr",position:[11]}],_observedAttributes:["listfields","customview_records","parent_comp","cvrecords","module","customfields","module_info","displayfield","selectedIds","fieldUiType","fieldMapping","lvheight","list_cv_btn","related_lists","prefixYields","suffixYields","enableBodyScroll","data_change","manage_columns_visible","reset_scroll","latestEntRow","isBlockedReason","headerYields","cv_sys_name","isFromModal","featureName","isResizeEnabled","featureObject","cv_width_updated","cv_mod_pined_fields","pined_fields_length","activity_badge","sortByComp","pined_fields_limit","sortIconFieldId","islockedListView","showSortIcon","persistPinUpdate","persistWrapUpdate","persistWidthUpdate","isAccessibilityConfigSupported","persistManageColumns","isPinUnpinSupported","renderWithoutCustomView","saveButtonLiteral","manageColumnDisableLiteral","customMethodImplemented"],data:function(){return{listfields:Lyte.attr("array"),customview_records:Lyte.attr("array",{default:[]}),parent_comp:Lyte.attr("string",{default:"crm-list-view"}),cvrecords:Lyte.attr("array"),module:Lyte.attr("string"),customfields:Lyte.attr("array"),module_info:Lyte.attr("object"),displayfield:Lyte.attr("object",{default:crmConstants.moduleDisplayField}),selectedIds:Lyte.attr("array",{default:[]}),fieldUiType:Lyte.attr("object"),fieldMapping:Lyte.attr("object"),lvheight:Lyte.attr("string"),list_cv_btn:Lyte.attr("array"),related_lists:Lyte.attr("array",{default:[]}),prefixYields:Lyte.attr("array"),suffixYields:Lyte.attr("array"),enableBodyScroll:Lyte.attr("boolean",{default:!0}),data_change:Lyte.attr("boolean",{default:!1}),manage_columns_visible:Lyte.attr("boolean",{default:!0}),reset_scroll:Lyte.attr("boolean",{default:!1}),latestEntRow:Lyte.attr("number"),isBlockedReason:Lyte.attr("boolean",{default:!1}),headerYields:Lyte.attr("object"),cv_sys_name:Lyte.attr("string"),isFromModal:Lyte.attr("boolean",{default:!1}),featureName:Lyte.attr("string"),isResizeEnabled:Lyte.attr("boolean",{default:!1}),featureObject:Lyte.attr("object",{default:{}}),cv_width_updated:Lyte.attr("boolean",{default:!1}),cv_mod_pined_fields:Lyte.attr("array",{default:[]}),pined_fields_length:Lyte.attr("number"),activity_badge:Lyte.attr("string",{default:"enabled"}),sortByComp:Lyte.attr("object",{default:{}}),pined_fields_limit:Lyte.attr("number",{default:Crm.userDetails.customViewPinLimit?Crm.userDetails.customViewPinLimit:1}),sortIconFieldId:Lyte.attr("string"),islockedListView:Lyte.attr("boolean",{default:!1}),showSortIcon:Lyte.attr("boolean",{default:!0}),persistPinUpdate:Lyte.attr("boolean",{default:!0}),persistWrapUpdate:Lyte.attr("boolean",{default:!0}),persistWidthUpdate:Lyte.attr("boolean",{default:!0}),isAccessibilityConfigSupported:Lyte.attr("boolean",{default:Crm.userDetails.isAccessibilityConfigSupported}),persistManageColumns:Lyte.attr("boolean",{default:!0}),isPinUnpinSupported:Lyte.attr("boolean",{default:!0}),renderWithoutCustomView:Lyte.attr("boolean",{default:!1}),saveButtonLiteral:Lyte.attr("string"),manageColumnDisableLiteral:Lyte.attr("string",{default:"crm.listview.customview.locked"}),customMethodImplemented:Lyte.attr("boolean",{default:!1})}},init:function(){this._menumove=this.menumousemove.bind(this);var e=Object.assign({},crmConstants.defaultUiTypeToCruxMapping);Object.assign(e,{20:"user",127:"lookup",2:"text",133:"lookup"}),this.data.fieldUiType=e,this.data.cvpermission=Crm.userDetails.permissions.Crm_Implied_Customize_Zoho_CRM||Crm.userDetails.permissions.Crm_Implied_Manage_CustomViews,this.constructCustomFields(),this.setData("enableBodyScroll",null==Crm.latestEntId),this.data.cvrecords=this.getData("customview_records"),this.data.activity_badge=this.getData("module_info").activity_badge?this.getData("module_info").activity_badge.toLowerCase():this.getData("module_info").activity_badge,this.data.notes_badge=this.getData("module_info").notes_badge?this.getData("module_info").notes_badge.toLowerCase():this.getData("module_info").notes_badge,this.setYieldInfo(this.getData("module"),this.getData("list_cv_btn"));for(var t=this.data.listfields?this.data.listfields:this.getData("module_info").custom_view.fields,a=t.length,i=[],o=this.getData("module_info").fields.map((function(e){return e.id})),s=0;s<a;s++)!0===t[s]._pin&&o.includes(t[s].id)&&(!t[s]._pin_order||i.length<t[s]._pin_order?i.push(t[s].id):i.splice(t[s]._pin_order-1,0,t[s].id));this.data.cv_mod_pined_fields=i,this.data.pined_fields_length=i.length,this.data.islockedListView=this.checkforListViewLock()},setExpTableScroll:function(){clearTimeout(this.expTableScrollTime),this.expTableScrollTime=setTimeout(function(){var e=$L("lyte-expresstable");if(e.length>0)if(Crm.userDetails.RTL_ENABLED&&/Chrome/i.test(navigator.userAgent)&&/Google Inc/i.test(navigator.vendor)&&!this.isNegativeScroll()){var t=$L("crm-list-view .lyteExpTableOrigTableInnerWrap")[0],a=t.scrollWidth-t.clientWidth;e.scrollTo&&e.scrollTo(a,0)}else e.scrollTo&&e.scrollTo(0,0)}.bind(this),0)},changePrefix:function(){Crm.latestEntId=void 0}.observes("module"),setYieldInfo:function(e,t){for(var a=this.getData("customview_records"),i=a?a.length:0,o=!1,s=!1,l=0;l<i&&(!o||!s);l++)a[l].$upcoming_activity&&(o=!0),a[l].Locked__s&&(s=!0);var n=[],r=[],d=this.getData("headerYields")?this.getData("headerYields"):{prefix:[],suffix:[]},p=!1,c=store.peekRecord("custom_view",this.getData("module_info").custom_view.id),m=c&&c.system_name?c.system_name:"";if(e.startsWith("Orchestration")||e.startsWith("PathFinder"))n=[{width:"30px",class:"lvEditIconCol"}];else{n=[{fixed:"enable",width:"10px"},{fixed:"enable",width:"10px"}];var u=[];n=[{fixed:"enable",width:"10px",class:"lvEditIconCol"},{fixed:"enable",width:"10px",class:s?"lvCheckboxCol rlc_lockTd":"lvCheckboxCol"}];var y=c&&("CONVERTEDVIEWS"===m||"MYCONVERTEDVIEWS"===m);"Tasks"!==e&&"Calls"!==e||this.getData("isFromModal")||u.push("activityMod"),o&&"enabled"===this.getData("activity_badge")&&!this.getData("hideActivityBadge")?n.push({class:"lv_activityLink pR",fixed:"enable"}):!Crm.userDetails.activityBadgeUpgradeEnabled||"CHARTVIEWS"===this.getData("featureName")||"enabled"!==this.getData("activity_badge")||this.getData("hideActivityBadge")||y?n.push({class:"lv_activityLink lv_noActivity pR",fixed:"enable"}):n.push({class:"activityBadgeIcon pR",fixed:"enable"});var f=!1;m.indexOf("REVIEWPROCESS")>=0&&this.getData("customview_records").find((function(e){return e.$approval_state&&"review_process_rejected"===e.$approval_state.toLowerCase()}))&&(f=!0),(m.indexOf("REVIEWPROCESS")<0||m.indexOf("REVIEWPROCESS")>=0&&f&&"CHARTVIEWS"!==this.getData("featureName"))&&(!Crm.userDetails.CLIENT_ACCOUNT||Crm.userDetails.CLIENT_ACCOUNT&&Crm.userDetails.permissions[`Crm_Implied_Edit_${e}`])&&u.push("moreOptionMenu"),!y&&Crm.userDetails.activityBadgeUpgradeEnabled&&"enabled"===this.getData("notes_badge")&&"COMPLIANCE"!==this.getData("featureName")&&u.push("noteBadgeIcon"),n[0].class=n[0].class.concat(" ",u.join(" ")),this.setData({activityBadge:this.getData("activity_badge"),notesBadge:this.getData("notes_badge")})}(d.prefix[0]&&n[0]&&d.prefix[0].class!=n[0].class||d.prefix[1]&&n[1]&&d.prefix[1].class!=n[1].class||d.prefix[2]&&n[2]&&d.prefix[2].class!=n[2].class||d.prefix.length!=n.length)&&(p=!0),(r=t&&t.length>0&&-1===this.data.cv_sys_name.indexOf("REVIEWPROCESS LEADS")&&!this.getData("isFromModal")?[{width:"100px",class:"lv_customBtnTd"}]:[{width:"100px",class:"lv_noCustomBtn lv_customBtnTd"}]).push({width:"53px",class:"lv_fixedLastCol"}),d.suffix[0]&&r[0]&&d.suffix[0].class!=r[0].class&&(p=!0),p&&this.setData("headerYields",{prefix:n,suffix:r})},setValues:function(){var e=$L("#customBtns")[0],t=$L("#customBtn")[0];e&&t&&LyteComponent.appendChild(e,t),this.constructCustomFields()}.observes("listfields"),appendBlockedReason:function(){for(var e,t=this.getData("customfields").slice(0),a=!1,i=t.length,o=0;o<i;o++)"$blocked_reason"==t[o].api_name&&(a=!0,e=o);1!=this.data.isBlockedReason||a?a&&t.splice(e,1):t.push({api_name:"$blocked_reason",list_display_label:"Blocked Reason",field_label:"Blocked Reason",display_label:"Blocked Reason",ui_type:27}),this.setData("cvrecords",[]),this.setData("customfields",t),this.setData("cvrecords",this.getData("customview_records"))}.observes("isBlockedReason"),menumousemove:function(e){var t=$L("lyte-menu-box:not(.lyteMenuHidden)")[0],a=$L(".cvButtonHover #customBtn")[0];t&&a&&!t.contains(e.target)&&!a.parentNode.contains(e.target)&&t.parent.ltProp("show",!1)},refreshRecord:function(){const e=this.getData("customview_records").map((e=>e));this.setData("customview_records",e)},onHideColumnSuccess:function(e,t){var a=store.peekRecord("field",e);_cruxUtils.showCustomMessage({params:{ltPropType:"success",ltPropMessage:I18n.getMsg("crm.customview.hide.column.success",a.list_display_label)}}),this.setData("listfields",t),this.refreshRecord()},actions:{stopPropagation:function(e){e.stopPropagation()},customBtnMouseOut:function(){arguments[0].parent&&arguments[0].parent.ltProp("show",!1)},executeCustomButton:function(e){var t=$L("crm-inner-list")[0].getData("entityId");this.executeCustomButton(e,t)},mouseOverCustomButton:function(e,t,a,i){this.mouseOverCustomButton(e,t,a,i)},mouseOutCustomButton:function(){this.mouseOutCustomButton()}},methods:{executeCustomButton:function(e){this.executeCustomButton(e,this.$node.querySelector("crm-inner-list").component.data.entityId)},selectAllRecords:function(){this.getMethods("onSelectAllEntities")&&this.executeMethod("onSelectAllEntities")},selectRecord:function(e,t){this.getMethods("onSelectEntity")&&this.executeMethod("onSelectEntity",e,t)},sortButtonDisplay:function(){var e=store.peekRecord("field",arguments[2].parentElement.id);this.data.sortIconFieldId=e.id;var t=["phone","currency","integer","double"].contains(e.data_type),a=$L("#sorted_column_"+e.id)[0],i=[],o={};if(e.sortable&&("BEST_TIME"===e.column_name?(i=["asc","unsort"],o={asc:I18n.getMsg("crm.column.sort.asc"),unsort:"unsort"}):(i=a&&"asc"===this.getData("module_info").custom_view.sort_order?["desc","unsort"]:a&&"desc"===this.getData("module_info").custom_view.sort_order?["asc","unsort"]:["asc","desc"],o={asc:t?"0-9":I18n.getMsg("crm.column.sort.asc"),desc:t?"9-0":I18n.getMsg("crm.column.sort.desc")})),!window.clientPortalName){var s=this.data.listfields?this.data.listfields:store.peekRecord("custom_view",this.getData("module_info").custom_view.id).fields;this.data.isPinUnpinSupported&&s.forEach((function(t){if(e.id===t.id)if(!0===t._pin)i.push("UnPin Column"),o["UnPin Column"]=I18n.getMsg("crm.customview.unpin.column");else i.push("Pin Column"),o["Pin Column"]=I18n.getMsg("crm.customview.pin.column")}))}if(Crm.userDetails.activityBadgeUpgradeEnabled&&(this.getData("showFilterBy")&&e.filterable&&(i.push("Filter By"),o["Filter By"]=I18n.getMsg("crm.api.filterby")),this.getData("showManageColumn"))){var l=this.getData("module_info").custom_view.system_name,n=this.getData("module"),r=!!moduleRecordMapping[n]&&"team_based"===moduleRecordMapping[n].access_type,d=r?Crm.userDetails.permissions["Crm_Implied_Manage_CustomViews_"+n]:Crm.userDetails.permissions.Crm_Implied_Manage_CustomViews,p=!(l&&-1!==l.indexOf("CONVERTEDVIEWS")&&!this.data.customview_records.length||!d)&&("Activities"!==n||!Crm.isActivitySplitDone);p&&(i.push("Hide Column"),o["Hide Column"]=I18n.getMsg("crm.calendar.hide.events",I18n.getMsg("crm.report.column")))}var c=this.getData("customfields").filter((t=>t.id===e.id))[0],m=this.getData("module_info"),u=crmConstants.moduleDisplayField[m.module_name],y=0;return this.getData("customfields").forEach((function(e){u.includes(e.api_name)&&(y+=1)})),c.cxPropPinned||u.includes(e.api_name)&&1===y||this.getData("islockedListView")?this.setData("disableHideOpt",!0):this.setData("disableHideOpt",!1),c.cxPropPinned?this.setData("pinnedColumn",!0):this.setData("pinnedColumn",!1),this.setData("sortDetails",i),this.setData("sortDisplayDetails",o),!0},makeSortableBtn:function(){$L(arguments[2]).closest("lyte-exptable-tr").addClass("cvButtonHover"),document.addEventListener("mouseover",this._menumove,!0)},hideMenu:function(){document.removeEventListener("mouseover",this._menumove,!0),$L(".cvButtonHover").removeClass("cvButtonHover");var e=document.querySelector("#cvBtnSearch");e&&e.setValue("")},customBtnClick:function(){arguments[1].stopPropagation(),arguments[1].preventDefault()},sortRecord:function(e,t,a,i,o){if(this.data.customMethodImplemented){var s="Hide Column"===e;if(s&&this.getData("disableHideOpt"))return;var l=s?{hideField:i,listFields:this.data.listfields,method:"handleManageColumns"}:{value:e,event:t,element:a,sortElem:i,sortObj:o,method:"sortRecord"};Lyte.triggerEvent("invokeDrillDownMethodImplementation",l)}else{var n=this.getData("isFromModal"),r=this.getData("persistPinUpdate");if("Filter By"===e)this.filterByColumn(i.parentElement.id,this.getData("module_info"));else if("Hide Column"===e){if(this.getData("disableHideOpt"))return;this.hideFieldColumn(i.parentElement.id,this.getData("featureName"),this.getData("module_info"))}else if("Pin Column"===e||"UnPin Column"===e){if(this.getData("pined_fields_length")>=this.getData("pined_fields_limit")&&"Pin Column"===e||this.getData("islockedListView"))return;this.pinUnpinfield(e,r)}else this.sortRecord(e,t,a,i,o,n,this.data.featureName)}},tableScroll:function(){$L("#sort_menu")[0].ltProp("show",!1)},setCss:function(e){var t=$L("#cvMenuId")[0].component;if(t.setCss.call(t),0==e.length){if(document.querySelector(".noresultstyle"))return;var a=document.querySelector("#cvBtnContainer"),i=document.createElement("div");i.setAttribute("class","noresultstyle"),i.textContent=I18n.getMsg("crm.social.integ.no.result"),a.appendChild(i)}else{var o=document.querySelector(".noresultstyle");o&&o.remove()}}},constructCustomFields:function(){var e=this.fieldYieldMapping(this.getData("listfields"),this.getData("isResizeEnabled")),t=e.customfields,a=e.fieldMapping;this.setData("fieldMapping",a);var i=this.data.persistManageColumns;(this.setExpTableScroll(),this.setData("customfields",t),$("#newPopup")[0])&&document.getElementsByTagName("crm-column-list")[0].component.setData({module:this.getData("module"),cvid:this.getData("module_info").custom_view.id,persistManageColumns:i})},checkforListViewLock:function(){var e=this.getData("module_info").custom_view,t=Crm.userDetails.IS_ADMIN;return!!e.locked&&((!e.system_defined||!t)&&!(!e.system_defined&&(t||e.created_by.id===Crm.userDetails.USER_ID)))},observeRecords:function(){var e=$L("#customBtns")[0],t=$L("#customBtn");e&&t[0]&&LyteComponent.appendChild(e,t[0]),this.setData("enableBodyScroll",null==Crm.latestEntId);var a=$L("lyte-expresstable")[0];if(a){a.scrollTo();var i=document.querySelector("#listcrux");i.component.disableScroll=!0,this.setExpTableScroll(),$L.fastdom.measure((function(){$L.fastdom.mutate((function(){$L.fastdom.measure((function(){i.component.disableScroll=!1}))}))}))}Crm.latestEntId?this.data.customview_records.every(function(e){return e.id!=Crm.latestEntId||(this.set("latestEntRow",e.recnum-(this.data.page-1)*this.data.module_info.per_page),!1)}.bind(this)):this.setData("latestEntRow",1);var o=$L("crm-custom-outer-box")[0];this.getData("cv_sys_name")||this.setData("cv_sys_name",o?o.getData("cv_sys_name"):""),this.setYieldInfo(this.getData("module"),this.getData("list_cv_btn")),this.setData("cvrecords",this.getData("customview_records"))}.observes("customview_records"),isNegativeScroll:function(){if(null!=this._negativeScrollChrome)return this._negativeScrollChrome;var e,t=document.body.appendChild($L("<div style='position: absolute; left: 0; top: 0; overflow: hidden; width: 10px;height: 1px;'><div style='width: 20px; height: 1px;'></div></div>").get(0));return t.scrollLeft=-5,e=t.scrollLeft<0,document.body.removeChild(t),this._negativeScrollChrome=e,e},didConnect:function(){$L(".lyteExpTableOrigTableInnerWrap").on("scroll",(function(){var e=$L("#appoinmentMoreOptionsMenu");e.length&&e[0].ltProp("show",!1)}))}},{mixins:["crm-view-utils","crm-list-view-modal-util"]}),Lyte.Component.register("crm-cverror-page",{_template:'<template tag-name="crm-cverror-page"> <div data-zcqa="crm_error_page" data-errormessage="The action that you intend to perform is not possible" class="leadbox p30" style=" margin-top:200px;min-height:100px; height:170px;"><br> <div class="crm-error-page pR pL30"> <span class="crm-error-page-icon p0"></span> <h2 class="mL15 mandatory">{{getI18n("crm.delete.error")}}</h2> <div class="mT5 crm-base-font-size mL15 lh20">{{getI18n("crm.cv.delete.message")}} <a onclick="{{action(\'redirectDefaultView\')}}" style="cursor: pointer;"> <template is="if" value="{{cvdisplayName}}"><template case="true"> {{I18nDynamicKey("crm.import.link.gotoDetailView","",cvdisplayName,module_name)}} </template><template case="false"> {{getI18n("crm.migration.complete.goToHome")}} </template></template> </a> </div> </div> </div> </template>',_dynamicNodes:[{type:"text",position:[1,2,3,0]},{type:"text",position:[1,2,5,0]},{type:"attr",position:[1,2,5,2]},{type:"attr",position:[1,2,5,2,1]},{type:"if",position:[1,2,5,2,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}],_observedAttributes:["cvdisplayName"],data:function(){return{cvdisplayName:Lyte.attr("string")}},actions:{redirectDefaultView:function(){var e=this.getData("module_name"),t=Lyte.Router.getRouteInstance().transition.info.route,a=moduleRecordMapping[e];if("crm.tab.module.custom-view.kanban"===t&&!a.custom_view){for(var i=store.peekAll("custom_view"),o=i.length,s=[],l=0;l<o;l++)i[l].module.api_name===a.api_name&&s.push(i[l]);var n=s.filter((function(e){if("ALLVIEWS"===e.system_name)return e})),r=n[0],d=n.length;for(l=0;l<d;l++)if(n[l].name.startsWith("All")){r=n[l];break}a.custom_view=r}this.getData("cvdisplayName")&&moduleRecordMapping[e].custom_view?"crm.tab.module.custom-view.canvas"===t?Lyte.Router.transitionTo({route:t,dynamicParams:[e,moduleRecordMapping[e].custom_view.id,Lyte.Router.getRouteInstance().getDynamicParam()],queryParams:{viewType:Lyte.Router.getRouteInstance().getQueryParams().viewType}}):(a.$.triggerAction("view_preference_configurations",{module:a.api_name},{},"PUT",{last_accessed_views:[{type:"custom_view",custom_view:{id:moduleRecordMapping[e].custom_view.id}}]}),Lyte.Router.transitionTo({route:t,dynamicParams:[e,moduleRecordMapping[e].custom_view.id]})):Lyte.Router.transitionTo({route:"crm.tab.module.begin",dynamicParams:["Home"]})}}}),Lyte.Component.register("crm-list-printview",{_template:'<template tag-name="crm-list-printview" use-strict="false"> <div class="lbox m15"> <div align="center" class="buttoncontainer" style="margin-top: 10px;"> <button class="newgraybtn" onclick="window.print()" data-zcqa="printpage">{{getI18n(\'crm.button.print.page\')}}</button> <button class="newgraybtn" onclick="window.close()" data-zcqa="closebtn">{{getI18n(\'crm.label.close\')}}</button> </div> <div class="mB10">{{pluralLabel}}: {{customViewDisp_val}}</div> <lyte-table-temp> <div class="cruxTableStructure printViewTable"> <div class="tablecomponent1 tableBdrCollapse printViewRow tablecomponent" style="background : rgb(255,255,255);"> <template is="for" items="{{fields}}" item="field" index="index" unbound="true"> <div class="br_top_border4 printViewColumn printPreviewHeader" style="white-space: nowrap;"> <template is="if" value="{{expHandlers(field.ui_type,\'==\',209)}}"><template case="true"> {{getI18n("crm.label.small.tags")}} </template><template case="false"> {{field.field_label}} </template></template> </div> </template> </div> <template is="if" value="{{body.length}}"><template case="true"> <template is="for" items="{{body}}" item="row" index="contentIndex" unbound="true"> <div class="tableBdrCollapse tablecomponent2 printViewRow" id="{{cxPropBodyId}}"> <template is="for" items="{{fields}}" item="field" index="index" unbound="true"> <div class="pR printViewColumn printPreviewBody crmBaseColor formatLtr"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(field.data_type,\'==\',&quot;lookup&quot;),\'||\',expHandlers(field.data_type,\'==\',&quot;multi_module_lookup&quot;)),\'||\',expHandlers(field.ui_type,\'==\',8)),\'||\',expHandlers(field.ui_type,\'==\',221)),\'||\',expHandlers(field.ui_type,\'==\',55)),\'||\',expHandlers(field.ui_type,\'==\',208)),\'||\',expHandlers(field.ui_type,\'==\',207)),\'||\',expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(field.ui_type,\'==\',20),\'&amp;&amp;\',expHandlers(field.api_name,\'!=\',&quot;Quote_Number&quot;)),\'&amp;&amp;\',expHandlers(field.api_name,\'!=\',&quot;Solution_Number&quot;)),\'&amp;&amp;\',expHandlers(field.api_name,\'!=\',&quot;Invoice_Number&quot;)),\'&amp;&amp;\',expHandlers(field.api_name,\'!=\',&quot;Case_Number&quot;)),\'&amp;&amp;\',expHandlers(field.api_name,\'!=\',&quot;SO_Number&quot;)))}}"><template case="true"> {{row[field.api_name].name}} </template><template case="false"><template is="if" value="{{expHandlers(field.separator,\'&amp;&amp;\',row[field.api_name])}}"><template case="true">{{formatNumber(toString(row[field.api_name]))}}</template><template case="false"><template is="if" value="{{expHandlers(field.ui_type,\'==\',209)}}"><template case="true">{{arrayJoin(arrayMap(row[field.api_name],\'name\'),\',\')}}</template><template case="false"><template is="if" value="{{expHandlers(field.ui_type,\'==\',999)}}"><template case="true">{{arrayJoin(arrayMap(row[field.api_name],\'Name\'),\', \')}}</template><template case="false"><template is="if" value="{{expHandlers(expHandlers(field.ui_type,\'==\',301),\'||\',expHandlers(expHandlers(field.ui_type,\'==\',116),\'&amp;&amp;\',expHandlers(field.formula.return_type,\'==\',&quot;boolean&quot;)))}}"><template case="true"> <template is="if" value="{{expHandlers(row[field.api_name],\'==\',true)}}"><template case="true"> <img src="{{yesImgUrl}}" class="yes" alt="true"> </template><template case="false"><span></span></template></template> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(field.ui_type,\'==\',111),\'||\',expHandlers(field.ui_type,\'==\',32)),\'||\',expHandlers(field.ui_type,\'==\',36)),\'||\',expHandlers(field.ui_type,\'==\',77)),\'||\',expHandlers(field.ui_type,\'==\',143)),\'||\',expHandlers(field.ui_type,\'==\',144)),\'||\',expHandlers(field.ui_type,\'==\',145)),\'||\',expHandlers(field.ui_type,\'==\',34)),\'||\',expHandlers(expHandlers(expHandlers(field.ui_type,\'==\',116),\'||\',expHandlers(field.ui_type,\'==\',117)),\'&amp;&amp;\',expHandlers(expHandlers(field.formula.return_type,\'==\',&quot;currency&quot;),\'||\',expHandlers(field.formula.return_type,\'==\',&quot;double&quot;)))),\'||\',expHandlers(expHandlers(field.ui_type,\'==\',118),\'&amp;&amp;\',expHandlers(expHandlers(field.rollup_summary.return_type,\'==\',&quot;currency&quot;),\'||\',expHandlers(field.rollup_summary.return_type,\'==\',&quot;double&quot;))))}}"><template case="true"> {{getNumberValueForView(row[field.api_name],field,row.Currency,row.Exchange_Rate,row.ExchangeRate,row.$home_converted_currency[field.api_name],row.$formatted_currency[field.api_name])}} </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(expHandlers(field.ui_type,\'===\',3),\'||\',expHandlers(field.ui_type,\'===\',110)),\'||\',expHandlers(field.data_type,\'===\',&quot;textarea&quot;))}}"><template case="true"> <pre class="wbBreakWord wsPreWrap">{{row[field.api_name]}}</pre> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(field.ui_type,\'==\',333),\'||\',expHandlers(field.ui_type,\'==\',14)),\'||\',expHandlers(field.ui_type,\'==\',786)),\'&amp;&amp;\',expHandlers(moduleName,\'==\',&quot;Activities&quot;)),\'&amp;&amp;\',row.All_day)}}"><template case="true"> {{getDateTimeForView(row[field.api_name])}} </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(row[field.api_name],\'&amp;&amp;\',expHandlers(row[field.api_name],\'!==\',&quot;&quot;)),\'&amp;&amp;\',expHandlers(expHandlers(field.ui_type,\'==\',2),\'||\',expHandlers(field.ui_type,\'==\',26))),\'&amp;&amp;\',expHandlers(field.enable_colour_code,\'==\',true)),\'&amp;&amp;\',expHandlers(moduleName,\'!=\',&quot;Activities&quot;))}}"><template case="true"> <span class="colorAppliedPicklist" data-zcqa="colorspanpl_{{row.id}}_{{field.id}}" style="{{getCVPicklistStyleObj(row[field.api_name],field)}}">{{getRecordValue(row,field)}}</span> </template><template case="false"> {{getRecordValue(row,field)}} </template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template><template is="if" value="{{expHandlers(expHandlers(moduleName,\'==\',&quot;Activities&quot;),\'&amp;&amp;\',expHandlers(field.enable_colour_code,\'==\',true))}}"><template case="true"> <span class="dIB eventColor_lv" data-zcqa="colorspanpl_{{row[field.api_name]}}" style="left:-3px;top:13px;background: {{row.$colour_code}}"></span> </template></template><template is="if" value="{{expHandlers(field.column_name,\'==\',&quot;SUBJECT&quot;)}}"><template case="true"><template is="if" value="{{row.$colour_code}}"><template case="true"> <span class="dIB eventColor_lv" data-zcqa="colorspanpl_{{row[field.api_name]}}" style="left:-3px;top:13px;background: {{row.$colour_code}}"></span> </template></template><template is="if" value="{{row.$in_project_sync}}"><template case="true"> <i style="margin-bottom: 2px;" class="task_syncIcon vaM" lt-prop-title="{{concat(getI18n(&quot;crm.schedules.prefix.in&quot;),getI18n(&quot;crm.integ.sync.message&quot;,&quot;crm.project.integration.title&quot;))}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;followcursor&quot;, &quot;appearance&quot; : &quot;box&quot;}"></i> </template></template></template></template> </div> </template> </div> </template> </template></template> </div> </lyte-table-temp> <template is="if" value="{{expHandlers(body.length,\'!\')}}"><template case="true"> <div style="text-align : center; color : #787878; padding-bottom: 30px!important; padding-top: 30px !important;">{{I18nDynamicKey(\'crm.module.empty.message\',\'\',pluralLabel)}}</div> </template></template> <div align="center" class="mT20 buttoncontainer " style="margin-top : 20px;"> <button class="newgraybtn" onclick="window.print()" data-zcqa="printpage">{{getI18n(\'crm.button.print.page\')}}</button> <button class="newgraybtn" onclick="window.close()" data-zcqa="closebtn">{{getI18n(\'crm.label.close\')}}</button> </div> </div> </template>',_dynamicNodes:[{type:"text",position:[1,1,1,0]},{type:"text",position:[1,1,3,0]},{type:"text",position:[1,3,0]},{type:"text",position:[1,3,2]},{type:"attr",position:[1,5,1,1,1]},{type:"for",position:[1,5,1,1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]},{type:"attr",position:[1,5,1,3]},{type:"if",position:[1,5,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"getCVPicklistStyleObj",args:["row[field.api_name]","field"]}}}},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,2]},{type:"if",position:[1,2],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'left:-3px;top:13px;background: '","row.$colour_code"]}}}}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'left:-3px;top:13px;background: '","row.$colour_code"]}}}}]}},default:{}},{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}}]}]}]}},default:{}},{type:"componentDynamic",position:[1,5]},{type:"attr",position:[1,7]},{type:"if",position:[1,7],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"text",position:[1,9,1,0]},{type:"text",position:[1,9,3,0]}],_observedAttributes:["data","moduleId","fields","body","moduleName","customViewDisp_val","pluralLabel","fieldMapping","height","lyteUnbound","lyteFastRender","cxPropCurrencyDetails","cxPropDefaultRoundOff","cxPropCurrencyCode","cxPropDefaultOrgCurrency","yesImgUrl"],data:function(){return{data:Lyte.attr("object"),moduleId:Lyte.attr("string"),fields:Lyte.attr("array"),body:Lyte.attr("array"),moduleName:Lyte.attr("string"),customViewDisp_val:Lyte.attr("string"),pluralLabel:Lyte.attr("string"),fieldMapping:Lyte.attr("object"),height:Lyte.attr("string"),lyteUnbound:Lyte.attr("boolean"),lyteFastRender:Lyte.attr("boolean",{default:!0}),cxPropCurrencyDetails:Lyte.attr("object",{default:Crm.userDetails.CURRENCY_DETAILS}),cxPropDefaultRoundOff:Lyte.attr("number",{default:Crm.userDetails.defaultRoundOff?Crm.userDetails.defaultRoundOff:2}),cxPropCurrencyCode:Lyte.attr("string",{default:Crm.userDetails.BASE_CURRENCY}),cxPropDefaultOrgCurrency:Lyte.attr("string",{default:Crm.userDetails.defaultOrgCurrency}),yesImgUrl:Lyte.attr("string",{default:Search.yesImg})}}},{mixins:["crux-element-validation"]}),Lyte.Component.register("crm-listview-options",{_template:'<template tag-name="crm-listview-options"> <lyte-popover lt-prop-origin-elem="#addColumn" id="showManageSettings" custom-dropdown-sel="#showManageSettings" custom-dropdown-class="lytePopoverOpened" lt-prop-yeild="true" lt-prop-wrapper-class="manageSettingContent managePopoverZI" lt-prop-height="auto" lt-prop-freeze="false" lt-prop-show-close-button="false" lt-prop-type="box" lt-prop-placement="bottomRight" lt-prop-allow-multiple="true" lt-prop-show="{{showCont}}" on-close="{{method(\'popoverClose\')}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="manageColumnListContent"> <lyte-keyboard-navigator lt-prop-highlighted=".manageCList" lt-prop-children=".manageCList" lt-prop-selected="selectedPopItem" lt-prop-if-cycle="true" lt-prop-parent="#addColumn" lt-prop-scope=".manageList" lt-prop-skip-elements=".disable" lt-prop-trigger-click="true"> <template is="yield" yield-name="keyboard-navigator-content"> <ul class="manageList"> <template is="if" value="{{showManageColumn}}"><template case="true"><template is="if" value="{{isManageColumnsEnabled}}"><template case="true"> <li role="button" tabindex="-1" onclick="{{action(\'showColumnList\')}}" id="addColumnOrginate" class="manageCList" data-zcqa="lv_manageColumn">{{getI18n("crm.listview.options.manage")}}</li> </template><template case="false"> <li lt-prop-title="{{getI18n(manageColumnDisableLiteral)}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;followcursor&quot;, &quot;appearance&quot; : &quot;box&quot;}" class="manageCList manageCListDisabled" data-zcqa="lv_manageColumn">{{getI18n("crm.listview.options.manage")}}</li> </template></template></template></template><template is="if" value="{{expHandlers(featureName,\'!==\',\'PORTALS\')}}"><template case="true"><template is="if" value="{{isResizeEnabled}}"><template case="true"> <li onclick="{{action(\'resetColumnWidth\')}}" class="manageCList {{if(disableResetOption,\'eventNone disable\')}}" role="button" tabindex="-1" data-zcqa="lv_resetWidth">{{getI18n("crm.listview.options.reset.width")}}</li> </template></template><template is="if" value="{{isClipTextEnabled}}"><template case="true"> <li onclick="{{action(\'changeWrap\',\'wrap\')}}" class="manageCList" role="button" tabindex="-1" data-zcqa="lv_clipWrapSwitch">{{getI18n("crm.listview.options.text.wrap")}}</li> </template><template case="false"> <li onclick="{{action(\'changeWrap\',\'clip\')}}" class="manageCList" role="button" tabindex="-1" data-zcqa="lv_clipWrapSwitch">{{getI18n("crm.listview.options.text.clip")}}</li> </template></template></template></template> </ul> </template> </lyte-keyboard-navigator> </lyte-popover-content> </template> </lyte-popover> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"registerYield",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,2]},{type:"if",position:[1,2],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}}]}},default:{}}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["module","cvid","columnListOpen","disableResetOption","showCont","isResizeEnabled","showManageColumn","isClipTextEnabled","isManageColumnsEnabled","isFromModal","pined_fields_limit","featureName","renderWithoutCustomView","customMethodImplemented","saveButtonLiteral","manageColumnDisableLiteral"],data:function(){return{module:Lyte.attr("string"),cvid:Lyte.attr("string"),columnListOpen:Lyte.attr("boolean",{default:!1}),disableResetOption:Lyte.attr("boolean",{default:!0}),showCont:Lyte.attr("boolean",{default:!1}),isResizeEnabled:Lyte.attr("boolean",{default:!1}),showManageColumn:Lyte.attr("boolean",{default:!1}),isClipTextEnabled:Lyte.attr("boolean",{default:!1}),isManageColumnsEnabled:Lyte.attr("boolean",{default:!0}),isFromModal:Lyte.attr("boolean",{default:!1}),pined_fields_limit:Lyte.attr("number",{default:Crm.userDetails.customViewPinLimit?Crm.userDetails.customViewPinLimit:1}),featureName:Lyte.attr("string"),renderWithoutCustomView:Lyte.attr("boolean",{default:!1}),customMethodImplemented:Lyte.attr("boolean",{default:!1}),saveButtonLiteral:Lyte.attr("string"),manageColumnDisableLiteral:Lyte.attr("string",{default:"crm.listview.customview.locked"})}},actions:{showColumnList:function(){if(commonUtils.showHideLoadingDiv(!0),this.setData("showCont",!1),$L("#newPopup")[0]){var e=document.querySelector("crm-column-list");this.getData("columnListOpen")?(this.setData("columnListOpen",!1),e.setData("showModal",!1)):(e.setData({module:this.getData("module"),cvid:this.getData("cvid"),showModal:!0,from:"list",type:"modal",isResizeEnabled:this.getData("isResizeEnabled"),pined_fields_limit:this.getData("pined_fields_limit"),isFromModal:this.getData("isFromModal"),featureName:this.getData("featureName")}),this.setData("columnListOpen",!0))}else this.setData("columnListOpen",!0),Lyte.Component.render("crm-column-list",{saveButtonLiteral:this.getData("saveButtonLiteral")?this.getData("saveButtonLiteral"):"crm.button.save",customMethodImplemented:this.getData("customMethodImplemented"),renderWithoutCustomView:this.getData("renderWithoutCustomView"),module:this.getData("module"),cvid:this.getData("cvid"),showModal:!0,from:"list",type:"modal",isResizeEnabled:this.getData("isResizeEnabled"),pined_fields_limit:this.getData("pined_fields_limit"),isFromModal:this.getData("isFromModal"),featureName:this.getData("featureName")},"#columnList");commonUtils.showHideLoadingDiv(!1),event.stopPropagation()},resetColumnWidth:function(){var e=moduleRecordMapping[this.getData("module")],t=e.cvid;"CAMPAIGNMEMBERLISTVIEW"===this.data.featureName&&(t=store.peekAll("custom_view").find((e=>"ALLVIEWS"===e.system_name)).id);var a,i=store.peekRecord("custom_view",t),o=[],s=!1,l=document.querySelector("crm-inner-list"),n=$L("#listViewTable");this.setData("showCont",!1),l.getData("cv_width_updated")&&(this.loderStarts(!0),setTimeout(function(){if(n[0]&&n[0].getData("ltPropStickyTable")&&n.find(".lyteExpOriginalTable").css("width",""),i&&i.fields&&i.fields.forEach((function(e){(a=Object.assign({},e))._width&&(s=l.getData("persistWidthUpdate"),a._width=void 0,delete a._width),o.push(a)})),s){i.$.set("fields",o);var t=this;commonUtils.showHideLoadingDiv(!0);var r={id:e.custom_view.id},d={module:e.api_name};this.data.isFromModal&&this.setFeatureSpecificParams(d,this.data.featureName),store.triggerAction("custom_view","reset_width",r,d).then((function(){commonUtils.showHideLoadingDiv(!1);for(var e=l.getData("customfields").length,a=0;a<e;a++){if("Tag"===l.component.data.customfields[a].api_name){var i=t.getDefaultWidthForField(l.component.data.customfields[a].ui_type)+"px";t.reRenderTagComponent(l.component.data.clip_mode,i),Lyte.objectUtils(l.component.data.customfields[a],"add","tagWidth",i)}Lyte.objectUtils(l.component.data.customfields[a],"delete","width"),Lyte.objectUtils(l.component.data.customfields[a],"add","style","")}l.setData("cv_width_updated",!1),l.setData("width_prev_cvid",""),l.setData("cv_mod_fields",new Map),n[0]&&(n[0].setColumnWidth(),n[0].setVisibleFixedHeader()),setTimeout(function(){t.getData("isClipTextEnabled")||t.setHeight(),t.loderStarts(!1)}.bind(this),0)}),(function(){i.$.rollBack(),commonUtils.showHideLoadingDiv(!1),t.loderStarts(!1)}))}else{for(var p=l.getData("customfields").length,c=0;c<p;c++){if("Tag"===l.component.data.customfields[c].api_name){var m=this.getDefaultWidthForField(l.component.data.customfields[c].ui_type)+"px";this.reRenderTagComponent(l.component.data.clip_mode,m),Lyte.objectUtils(l.component.data.customfields[c],"add","tagWidth",m)}Lyte.objectUtils(l.component.data.customfields[c],"add","style","")}l.setData("cv_mod_fields",new Map),l.setData("cv_width_updated",!1),l.setData("width_prev_cvid",""),n&&(n[0].setColumnWidth(),n[0].setVisibleFixedHeader()),setTimeout(function(){this.getData("isClipTextEnabled")||this.setHeight(),this.loderStarts(!1)}.bind(this),0)}}.bind(this),0),event.stopPropagation())},changeWrap:function(e){this.loderStarts(!0),this.setData("showCont",!1),setTimeout(function(){var t=this,a=document.querySelector("crm-inner-list").component,i="clip"===e,o=$L("#listViewTable")[0];a.setData("isOptionOpened",!1),a.setData("clip_mode",i),t.setData("isClipTextEnabled",i);var s=a.data.customfields.filter((function(e){return"Tag"===e.api_name}));s.length&&t.reRenderTagComponent(i,s[0].tagWidth),o&&(o.fixRowHeight(),o.fixColumn()),setTimeout(function(){t.setHeight(),t.loderStarts(!1)}.bind(this),0)}.bind(this),0),event.stopPropagation()}},methods:{popoverClose:function(){$L("crm-inner-list")[0].setData("isOptionOpened",!1),this.setData("showCont",!1)}},loderStarts:function(e){$(".newListviewLoader").css("display",e?"block":"none")},didConnect:function(){document.getElementById("showManageSettings").ltProp({headerPadding:"0px 5px 0px 5px",contentPadding:"0",footerPadding:"8px 15px",show:!0})}},{mixins:["crm-view-utils","crm-list-view-modal-util"]}),Lyte.Component.register("crm-list-footer",{_template:'<template tag-name="crm-list-footer"> <div class="listviewButtonLayer pR " id="crmListFooter"> <lyte-table lt-prop-yield="true" class="w100_per" lt-prop-prevent-scrollbar="true"> <template is="registerYield" yield-name="yield"> <lyte-table-structure> <lyte-tbody> <lyte-tr> <template is="if" value="{{expHandlers(customview_records.length,\'||\',expHandlers(page,\'>\',1))}}"><template case="true"> <lyte-td> <div id="tcDiv" class="crmBaseColor alignLeft mL30 tcDiv"> <template is="if" value="{{expHandlers(expHandlers(fetchCountValues,\'!\'),\'&amp;&amp;\',expHandlers(total_new_count,\'==\',&quot;###&quot;))}}"><template case="true"> &nbsp;&nbsp; <nobr> <a id="totalRecordsCount" href="javascript:;" onclick="{{action(\'fetchCountOnReq\')}}" class="link date">{{getI18n("crm.label.totalcount")}}: <span id="totalCountNo">{{total_new_count}}</span></a> </nobr> &nbsp;&nbsp; </template><template case="false"> {{getI18n("crm.label.totalcount")}}: <template is="if" value="{{expHandlers(expHandlers(expHandlers(total_count,\'!\'),\'&amp;&amp;\',expHandlers(total_count,\'!=\',0)),\'||\',show_loading)}}"><template case="true"> <span class="cvFltCnt"> <img src="{{getCrmImageUrl(\'moreloading1_lightmode.gif\')}}" class="w10 h10" data-image-mode="true"> </span> </template><template case="false"> <span id="totalCountNo" class="totalCountNo crm-font-bold">{{total_count}}</span> </template></template></template></template> </div> </lyte-td> </template></template> <lyte-td class="alignRight"> <div class="dIB vaM"> <lyte-dropdown data-zcqa="dash_currentOption" lt-prop-freeze="false" class="dash_currentOption {{if(customview_records.length,\'\',\'mR30\')}}" lt-prop-selected="{{moduleInfo.per_page}}" on-option-selected="{{method(\'getCustomRecord\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box> <lyte-drop-body> <template is="for" items="{{optionsList}}" item="item" index="index"> <lyte-drop-item class="wsNowrap" data-value="{{item.system_value}}" data-zcqa="{{item.user_value}}"> {{item.user_value}}</lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </div> <template is="if" value="{{expHandlers(customview_records.length,\'||\',expHandlers(page,\'>\',1))}}"><template case="true"> <crm-page-navigator query-params="{{lbind(queryParams)}}" is-from-modal="{{isFromModal}}" feature-name="{{featureName}}" from="footer" module_info="{{moduleInfo}}" more_records="{{more_records}}" start-index="{{lbind(moduleInfo.start_index)}}" total_count="{{getFinalTotalCount(total_count,customview_records.length,page,moduleInfo.per_page)}}" per_page="{{moduleInfo.per_page}}" page="{{lbind(page)}}" class="dIB vaM mL10"></crm-page-navigator> </template></template> </lyte-td> </lyte-tr> </lyte-tbody> </lyte-table-structure> </template> </lyte-table> </div> </template>',_dynamicNodes:[{type:"registerYield",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1,1,1,1]},{type:"if",position:[1,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"text",position:[1,1,2,0]}]},false:{dynamicNodes:[{type:"text",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,1,1,3,1,1]},{type:"registerYield",position:[1,1,1,3,1,1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,1,3,1,1]},{type:"attr",position:[1,1,1,3,3]},{type:"if",position:[1,1,1,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1,1,1,3]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]}],_observedAttributes:["customview_records","optionList","more_records","show_loading","moduleInfo","module","total_count","total_new_count","display_navigator","fetchCountValues","page","isFromModal","featureName","queryParams"],data:function(){return{customview_records:Lyte.attr("array"),optionList:Lyte.attr("array"),more_records:Lyte.attr("boolean"),show_loading:Lyte.attr("boolean",{default:!0}),moduleInfo:Lyte.attr("object"),module:Lyte.attr("string"),total_count:Lyte.attr("number"),total_new_count:Lyte.attr("string",{default:"###"}),display_navigator:Lyte.attr("boolean",{default:!1}),fetchCountValues:Lyte.attr("boolean",{default:Crm.userDetails.fetchCountValues}),page:Lyte.attr("number"),isFromModal:Lyte.attr("boolean",{default:!1}),featureName:Lyte.attr("string"),queryParams:Lyte.attr("object",{default:{}})}},init:function(){this.setData("optionsList",this.constructRCOptions())},actions:{fetchCountOnReq:function(){var e=this.getData("isFromModal");commonUtils.showHideLoadingDiv(!0);var t=Lyte.Router.getRouteInstance(),a=(e=this.getData("isFromModal"))?this.getData("queryParams"):t.transition.info.queryParams,i={},o=this;this.beforeRecordAPI(a,i,this.getData("moduleInfo"));var s=JSON.parse(JSON.stringify(i));delete s.fields,delete s.page,delete s.per_page,e&&(this.setFeatureSpecificFilters(s,this.data.featureName),delete s.cvid,delete s.status,delete s.type),store.triggerAction(this.getData("moduleInfo").id,"count",s).then((function(a){if(o.setData("total_new_count",a.count),0!=a.count&&(o.setData("total_count",a.count),o.getData("moduleInfo").total_count=a.count,crmTab.getFromCache(o.getData("moduleInfo").module_name).totalCount=a.count,t.currentModel&&(t.currentModel.total_count=a.count)),e){var i=$("crm-list-view-modal")[0];i&&i.setData("total_count",a.count)}commonUtils.showHideLoadingDiv()}))}},methods:{getCustomRecord:function(e,t){}}},{mixins:["crm-view-utils","crm-list-view-modal-util"]}),Lyte.Component.register("crm-listview-relatedfields-popover",{_template:'<template tag-name="crm-listview-relatedfields-popover"> <lyte-popover id="relatedFieldsPopover" lt-prop-show="{{show}}" lt-prop-freeze="false" lt-prop-origin-elem="#relatedFieldsPopoverTarget" lt-prop-type="box" lt-prop-show-close-button="false"> <template is="registerYield" yield-name="popover"> <lyte-popover-content onmouseover="{{action(\'stopHide\')}}" class="pL20 pR20"> <lyte-table width="100%" border="0" cellspacing="0" cellpadding="5" class="crmListviewRelatedfieldsPopoverTD oH"> <template is="if" value="{{addPhone}}"><template case="true"><lyte-tr><lyte-td class="alignRight" width="50">{{getI18n(\'Phone\')}}:</lyte-td><lyte-td class="alignLeft"><template is="if" value="{{record.Phone}}"><template case="true">{{record.Phone}}</template></template></lyte-td></lyte-tr></template></template> <template is="if" value="{{addEmail}}"><template case="true"><lyte-tr><lyte-td class="alignRight" width="50">{{getI18n(\'Email\')}}:</lyte-td><lyte-td class="alignLeft"><template is="if" value="{{record.Email}}"><template case="true"><crux-email-component cx-prop-value="{{record.Email}}"></crux-email-component></template></template></lyte-td></lyte-tr></template></template> </lyte-table> </lyte-popover-content> </template> </lyte-popover> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"text",position:[0,0,0]},{type:"componentDynamic",position:[0,0]},{type:"attr",position:[0,1,0]},{type:"if",position:[0,1,0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}},{type:"componentDynamic",position:[0,1]},{type:"componentDynamic",position:[0]}]}},default:{}},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[0,0,0]},{type:"componentDynamic",position:[0,0]},{type:"attr",position:[0,1,0]},{type:"if",position:[0,1,0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"componentDynamic",position:[0]}]}},default:{}},{type:"componentDynamic",position:[0,1]},{type:"componentDynamic",position:[0]}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["show"],data:function(){return{show:Lyte.attr("boolean",{default:!0})}},actions:{stopHide:function(){event.stopPropagation()}}});
