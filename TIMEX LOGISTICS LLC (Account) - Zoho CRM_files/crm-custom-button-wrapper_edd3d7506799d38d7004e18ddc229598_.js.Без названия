Lyte.Component.register("crm-custom-button",{_template:'<template tag-name="crm-custom-button" id="crmCustomButton"> <lyte-event-listener event-name="custom_button_cscript_action" on-fire="{{action(\'doCscriptActions\')}}"> <template is="if" value="{{headlessDropdown}}"><template case="true"> <lyte-menu lt-prop-animate="true" lt-prop-query=".{{headlessReference}}" lt-prop-event="click" lt-prop-yield="true" on-before-open="{{method(\'onCusttomButtonBeforeShow\')}}" on-close="{{method(\'onHide\')}}" lt-prop-freeze="false"> <template is="registerYield" yield-name="yield"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',5),\'||\',expHandlers(seModCustomButton.length,\'>\',5)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',5))}}"><template case="true"> <lyte-menu-header> <lyte-search lt-prop-placeholder="Search Button" on-search="{{method(\'checkResult\')}}" id="buttonSearch" lt-prop-query-selector="{&quot;scope&quot; : &quot;#cvBtnListSearch{{btnid}}&quot;, &quot;search&quot; : &quot;lyte-menu-item&quot;}" data-zcqa="CVListBtnSearchBox"></lyte-search> </lyte-menu-header> </template></template> <lyte-menu-body> <template is="if" value="{{expHandlers(isActivityModule,\'!\')}}"><template case="true"> <div id="cvBtnListSearch{{btnid}}"> <template is="for" items="{{customButtons}}" item="action" index="index"> <lyte-menu-item data-value="{{action.id}}" class="{{if(array_contains(disabledButtons,action.id),\'canvas-cscript-menuitem-disable\',\'\')}} customButtonQuery{{action.id}} crm-custom-button-item crm-custom-button-menuitem " data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}"> {{expHandlers(renamedButtons[action.id],\'||\',action.name)}} </lyte-menu-item> </template> </div> <template is="if" value="{{showNoButtonDiv}}"><template case="true"> <div class="lyteDropdownNoResult ">{{getI18n(\'crm.custombutton.nobuttons.found\')}}</div> </template></template> </template><template case="false"><template is="if" value="{{expHandlers(isActivityModule,\'&amp;&amp;\',expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',0),\'||\',expHandlers(seModCustomButtons.length,\'>\',0)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',0)))}}"><template case="true"> <div id="cvBtnListSearch{{btnid}}"> <div> <lyte-menu-group> <lyte-menu-header id="btnDropCont_CB">{{if(expHandlers(expHandlers(contactModCustomButtons.length,\'&gt;\',0),\'||\',expHandlers(seModCustomButtons.length,\'&gt;\',0)),module,\'\')}}</lyte-menu-header> <template is="if" value="{{expHandlers(customButtons.length,\'>\',0)}}"><template case="true"> <template is="for" items="{{customButtons}}" item="action" index="index"> <lyte-menu-item data-value="{{action.id}}" class="{{if(array_contains(disabledButtons,action.id),\'canvas-cscript-menuitem-disable\',\'\')}} customButtonQuery{{action.id}} crm-custom-button-item crm-custom-button-menuitem " data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{expHandlers(renamedButtons[action.id],\'||\',action.name)}}</lyte-menu-item> </template> </template><template case="false"> <div class="lyteDropdownNoResult dBImp {{if(expHandlers(customButtons.length,\'<=\',0),\'restrictSortForNoBtn\',\'\')}}">{{getI18n(\'crm.custombutton.nobuttons.found\')}}</div> </template></template> </lyte-menu-group> </div> <div> <template is="if" value="{{expHandlers(contactModCustomButtons.length,\'>\',0)}}"><template case="true"> <lyte-menu-group> <lyte-menu-header id="btnDropCont_CCB">{{getI18n(\'Contacts\')}}</lyte-menu-header> <template is="for" items="{{contactModCustomButtons}}" item="action" index="index"> <lyte-menu-item data-value="{{action.id}}" class="{{if(array_contains(disabledButtons,action.id),\'canvas-cscript-menuitem-disable\',\'\')}} customButtonQuery{{action.id}} crm-custom-button-item crm-custom-button-menuitem " data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{expHandlers(renamedButtons[action.id],\'||\',action.name)}}</lyte-menu-item> </template> </lyte-menu-group> </template></template> </div> <div> <template is="if" value="{{expHandlers(seModCustomButtons.length,\'>\',0)}}"><template case="true"> <lyte-menu-group> <lyte-menu-header id="btnDropCont_SCB">{{seModule}}</lyte-menu-header> <template is="for" items="{{seModCustomButtons}}" item="action" index="index"> <lyte-menu-item data-value="{{action.id}}" class="{{if(array_contains(disabledButtons,action.id),\'canvas-cscript-menuitem-disable\',\'\')}} customButtonQuery{{action.id}} crm-custom-button-item crm-custom-button-menuitem " data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{expHandlers(renamedButtons[action.id],\'||\',action.name)}}</lyte-menu-item> </template> </lyte-menu-group> </template></template> </div> </div> </template></template></template></template> </lyte-menu-body> <lyte-menu-footer> <template is="if" value="{{expHandlers(expHandlers(btnid,\'!=\',\'relatedList\'),\'&amp;&amp;\',expHandlers(isPortalPage,\'!\'))}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(getUserDetail(\'LICENSE_TYPE\'),\'!=\',\'L\'),\'&amp;&amp;\',expHandlers(getUserDetail(\'LICENSE_TYPE\'),\'!=\',\'F\')),\'&amp;&amp;\',expHandlers(getUserDetail(\'LICENSE_TYPE\'),\'!=\',\'N\'))}}"><template case="true"> <lyte-menu-item id="detailsCB" class="customBtnLink crm-custom-button-footer crm-custom-button-menuitem"> <div class="dB crmLinkColor" onclick="{{action(\'createCustomBtn\',module,position)}}" data-zcqa="create_buttons">{{getI18n(\'crm.custombutton.create.newbutton\')}}</div> </lyte-menu-item> </template></template> <lyte-menu-item class="customBtnLink crm-custom-button-menuitem" id="manageCustomButtonDiv"> <div class="dB crmLinkColor" onclick="{{action(\'manageCustomButton\',module)}}" data-zcqa="manage_buttons">{{getI18n(\'crm.custombutton.manage.button\')}}</div> </lyte-menu-item> </template></template> </lyte-menu-footer> </template> </lyte-menu> </template><template case="false"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(seModCustomButtons.length,\'>\',0),\'||\',expHandlers(contactModCustomButtons.length,\'>\',0)),\'||\',expHandlers(customButtons.length,\'>\',0))}}"><template case="true"> <lyte-dropdown id="{{btnid}}" lt-prop-tabindex="-1" class="{{if(withoutRecord,\'mR10\',\'fL mR15\')}}" lt-prop-is-open="{{lbind(showCustomButtons)}}" lt-prop-yield="true" on-before-show="{{method(\'onCusttomButtonBeforeShow\')}}" on-show="{{method(\'onCusttomButtonShow\')}}" on-hide="{{method(\'onHide\')}}" lt-prop-freeze="false" lt-prop-disable-item-tooltip="true" lt-prop-disabled-list="{{csript_disabledactions}}" lt-prop-allow-focusable-elements="true" lt-prop-active-element="{{if(expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',5),\'||\',expHandlers(seModCustomButton.length,\'>\',5)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',5)),\'#customButtonSearch\',\'.cbDropDownIcon\')}}" lt-prop-include-button-in-focus-loop="{{if(expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',5),\'||\',expHandlers(seModCustomButton.length,\'>\',5)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',5)),\'false\',\'true\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-button class="lvCustomButton newgreybtn dIF wsNowrap"> <template is="if" value="{{expHandlers(customButtons.length,\'>\',0)}}"><template case="true"> <div tabindex="{{if(showCustomButtons,\'-1\',\'0\')}}" class="executeCustomButton cBTextTrans dIB vaM customButtonQuery{{compId}}{{customButtons[0].id}} cVDropMax flexOne {{getDisableClassForActions_CustomButon(customButtons[0].id,csript_disabledactions)}}" cscript-tag="customBtn_{{customButtons[0].id}}" onmouseover="{{action(\'mouseOverCustomButton\',expHandlers(\'customButtonQuery\',\'+\',compId),customButtons[0].id,encodeJS(customButtons[0].name),encodeJS(customButtons[0].description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}" data-zcqa="{{customButtons[0].name}}">{{customButtons[0].name}}</div> </template><template case="false"><template is="if" value="{{expHandlers(contactModCustomButtons.length,\'>\',0)}}"><template case="true"> <div tabindex="{{if(showCustomButtons,\'-1\',\'0\')}}" class="executeCustomButton cBTextTrans dIB vaM customButtonQuery{{compId}}{{contactModCustomButtons[0].id}} cVDropMax flexOne {{getDisableClassForActions_CustomButon(customButtons[0].id,csript_disabledactions)}}" cscript-tag="customBtn_{{contactModCustomButtons[0].id}}" onmouseover="{{action(\'mouseOverCustomButton\',expHandlers(\'customButtonQuery\',\'+\',compId),contactModCustomButtons[0].id,encodeJS(contactModCustomButtons[0].name),encodeJS(contactModCustomButtons[0].description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}" data-zcqa="{{contactModCustomButtons[0].name}}">{{contactModCustomButtons[0].name}}</div> </template><template case="false"><template is="if" value="{{expHandlers(seModCustomButtons.length,\'>\',0)}}"><template case="true"> <div tabindex="{{if(showCustomButtons,\'-1\',\'0\')}}" class="executeCustomButton cBTextTrans dIB vaM customButtonQuery{{compId}}{{seModCustomButtons[0].id}} cVDropMax flexOne {{getDisableClassForActions_CustomButon(customButtons[0].id,csript_disabledactions)}}" cscript-tag="customBtn_{{seModCustomButtons[0].id}}" onmouseover="{{action(\'mouseOverCustomButton\',expHandlers(\'customButtonQuery\',\'+\',compId),seModCustomButtons[0].id,encodeJS(seModCustomButtons[0].name),encodeJS(seModCustomButtons[0].description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}" data-zcqa="{{seModCustomButtons[0].name}}">{{seModCustomButtons[0].name}}</div> </template></template></template></template></template></template> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',1),\'||\',expHandlers(btnid,\'!=\',\'relatedList\')),\'||\',expHandlers(seModCustomButton.length,\'>\',1)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',1))}}"><template case="true"> <div tabindex="0" class="cbDropDownIcon dIB vaM" data-zcqa="downArrow" aria-label="{{getI18n(\'crm.label.More\')}}" lt-prop-title="{{getI18n(\'crm.label.More\')}}" role="combobox" aria-haspopup="menu"></div> </template></template> </lyte-drop-button> <lyte-drop-box class="customButtonDropBox moduleChangeDom"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',5),\'||\',expHandlers(seModCustomButton.length,\'>\',5)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',5))}}"><template case="true"> <lyte-drop-header> <lyte-search lt-prop-placeholder="Search Button" lt-prop-focus="true" on-search="{{method(\'checkResult\')}}" id="buttonSearch" lt-prop-id="customButtonSearch" lt-prop-query-selector="{&quot;scope&quot; : &quot;#cvBtnListSearch{{btnid}}&quot;, &quot;search&quot; : &quot;lyte-drop-item&quot;}" data-zcqa="CVListBtnSearchBox"> </lyte-search> </lyte-drop-header> </template></template> <lyte-drop-body class="customButtonSortable lvCustomButtonDD {{if(ifEquals(btnid,\'detailPageButton\'),\'customButtonDropBody\',\'\')}}"> <template is="if" value="{{expHandlers(isActivityModule,\'!\')}}"><template case="true"> <div id="cvBtnListSearch{{btnid}}"> <template is="for" items="{{customButtons}}" item="action" index="index"> <lyte-drop-item data-value="{{action.id}}" class="customButtonQuery{{action.id}}" cscript-tag="customBtn_{{action.id}}" data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{action.name}}</lyte-drop-item> </template> </div> <template is="if" value="{{showNoButtonDiv}}"><template case="true"> <div class="lyteDropdownNoResult dBImp">{{getI18n(\'crm.custombutton.nobuttons.found\')}}</div> </template></template> </template><template case="false"><template is="if" value="{{expHandlers(isActivityModule,\'&amp;&amp;\',expHandlers(expHandlers(expHandlers(customButtons.length,\'>\',0),\'||\',expHandlers(seModCustomButtons.length,\'>\',0)),\'||\',expHandlers(contactModCustomButtons.length,\'>\',0)))}}"><template case="true"> <div id="cvBtnListSearch{{btnid}}"> <div> <lyte-drop-group label="{{if(expHandlers(expHandlers(contactModCustomButtons.length,\'>\',0),\'||\',expHandlers(seModCustomButtons.length,\'>\',0)),moduleLabel,\'\')}}" id="btnDropCont_CB"> <template is="if" value="{{expHandlers(customButtons.length,\'>\',0)}}"><template case="true"> <template is="for" items="{{customButtons}}" item="action" index="index"> <lyte-drop-item data-value="{{action.id}}" class="customButtonQuery{{action.id}}" cscript-tag="customBtn_{{action.id}}" data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{action.name}}</lyte-drop-item> </template> </template><template case="false"> <div class="lyteDropdownNoResult dBImp {{if(expHandlers(customButtons.length,\'<=\',0),\'restrictSortForNoBtn\',\'\')}}">{{getI18n(\'crm.custombutton.nobuttons.found\')}}</div> </template></template> </lyte-drop-group> </div> <div> <template is="if" value="{{expHandlers(contactModCustomButtons.length,\'>\',0)}}"><template case="true"> <lyte-drop-group label="{{getI18n(\'Contacts\')}}" id="btnDropCont_CCB"> <template is="for" items="{{contactModCustomButtons}}" item="action" index="index"> <lyte-drop-item data-value="{{action.id}}" class="customButtonQuery{{action.id}}" cscript-tag="customBtn_{{action.id}}" data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{action.name}}</lyte-drop-item> </template> </lyte-drop-group> </template></template> </div> <div> <template is="if" value="{{expHandlers(seModCustomButtons.length,\'>\',0)}}"><template case="true"> <lyte-drop-group label="{{seModuleLabel}}" id="btnDropCont_SCB"> <template is="for" items="{{seModCustomButtons}}" item="action" index="index"> <lyte-drop-item data-value="{{action.id}}" class="customButtonQuery{{action.id}}" cscript-tag="customBtn_{{action.id}}" data-zcqa="{{action.name}}" onclick="{{action(\'executeCustomButton\',action.id)}}" onmouseover="{{action(\'mouseOverCustomButton\',\'customButtonQuery\',action.id,encodeJS(action.name),encodeJS(action.description))}}" onmouseout="{{action(\'mouseOutCustomButton\')}}">{{action.name}}</lyte-drop-item> </template> </lyte-drop-group> </template></template> </div> </div> </template></template></template></template> </lyte-drop-body> <lyte-drop-footer> <template is="if" value="{{expHandlers(expHandlers(btnid,\'!=\',\'relatedList\'),\'&amp;&amp;\',expHandlers(isPortalPage,\'!\'))}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(getUserDetail(\'LICENSE_TYPE\'),\'!=\',\'L\'),\'&amp;&amp;\',expHandlers(getUserDetail(\'LICENSE_TYPE\'),\'!=\',\'F\')),\'&amp;&amp;\',expHandlers(getUserDetail(\'LICENSE_TYPE\'),\'!=\',\'N\'))}}"><template case="true"> <div class="customBtnLink" id="createCustomButtonDiv"> <div class="dB crmLinkColor accessibility-route-elem" tabindex="0" onclick="{{action(\'createCustomBtn\',module,position)}}" lt-prop-aria-keydown="true" role="link" data-zcqa="create_buttons">{{getI18n(\'crm.custombutton.create.newbutton\')}}</div> </div> </template></template> <div class="customBtnLink" id="manageCustomButtonDiv"> <div class="dB crmLinkColor accessibility-route-elem" tabindex="0" onclick="{{action(\'manageCustomButton\',module)}}" lt-prop-aria-keydown="true" role="link" data-zcqa="manage_buttons">{{getI18n(\'crm.custombutton.manage.button\')}}</div> </div> </template></template> </lyte-drop-footer> </lyte-drop-box> </template> </lyte-dropdown> </template></template> </template></template> </lyte-event-listener></template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1,1,0]},{type:"componentDynamic",position:[1,1,1,1]},{type:"attr",position:[1,1,1,3]},{type:"if",position:[1,1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"for",position:[1,3],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,5,1]},{type:"if",position:[1,5,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"for",position:[1,3],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"if",position:[5,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3,1]},{type:"text",position:[3,1,0]},{type:"componentDynamic",position:[3]}]}},default:{}},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3,3]},{type:"attr",position:[3,3,1]},{type:"if",position:[3,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"attr",position:[1,1,1,1]},{type:"if",position:[1,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,5,1]},{type:"if",position:[1,5,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[3,3]},{type:"attr",position:[3,5,1]},{type:"if",position:[3,5,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]}]}},default:{}},{type:"attr",position:[3,1]},{type:"text",position:[3,1,0]}]}},default:{}},{type:"componentDynamic",position:[3,5]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}],_observedAttributes:["customButtons","withoutRecord","headlessDropdown","headlessReference","fetchInfo","position","btnid","disabledButtons","renamedButtons","showNoButtonDiv","showCustomButtons","currentLayoutId","compId","tabIndex","module","record","customButtons","contactModCustomButtons","seModCustomButtons","isActivityModule","seModule","seModuleLabel","moduleLabel","recordLockingDetails","customButtonContainer","isPortalPage"],data:function(){return{customButtons:Lyte.attr("array"),withoutRecord:Lyte.attr("boolean"),headlessDropdown:Lyte.attr("boolean",{default:!1}),headlessReference:Lyte.attr("string",{default:""}),fetchInfo:Lyte.attr("boolean",{default:!1}),position:Lyte.attr("string"),btnid:Lyte.attr("string"),disabledButtons:Lyte.attr("array",{default:[]}),renamedButtons:Lyte.attr("object"),showNoButtonDiv:Lyte.attr("boolean",{default:!1}),showCustomButtons:Lyte.attr("boolean",{default:!1}),currentLayoutId:Lyte.attr("string"),compId:Lyte.attr("string"),tabIndex:Lyte.attr("string",{default:"0"}),module:Lyte.attr("string"),record:Lyte.attr("object"),customButtons:Lyte.attr("array",{default:[]}),contactModCustomButtons:Lyte.attr("array",{default:[]}),seModCustomButtons:Lyte.attr("array",{default:[]}),isActivityModule:Lyte.attr("boolean",{default:!1}),seModule:Lyte.attr("string",{default:null}),seModuleLabel:Lyte.attr("string",{default:""}),moduleLabel:Lyte.attr("string",{default:""}),recordLockingDetails:Lyte.attr("object",{default:{}}),customButtonContainer:Lyte.attr("array",{default:[]}),isPortalPage:Lyte.attr("boolean",{default:!!Crm.userDetails.CLIENT_ACCOUNT})}},init:function(){var t=this.getData("customButtons");t&&t.length&&(t=Lyte.deepCopyObject(t));var e=this.getData("currentLayoutId"),o=this.getData("position");t&&t.length&&o&&-1!==o.indexOf("list_view")&&(t=this.filterButtonsByPosition(t,o)),t&&t.length&&e&&(t=this.filterButtonsByLayout(t,e)),this.setData("customButtons",t),this.setData("customButtonContainer",t);let n=this.getData("module");const s=(moduleRecordMapping[n]||{}).plural_label||n;if(this.setData("moduleLabel",s),"Events"===n||"Tasks"===n){this.setData("isActivityModule",!0);let t=this.getData("record");if(t&&t.$se_module){this.setData("seModule",t.$se_module);const e=(moduleRecordMapping[t.$se_module]||{}).plural_label||t.$se_module;this.setData("seModuleLabel",e)}}this.filterRestrictedCustomButton(),"view"!==o&&"detail"!==o||this.getRelatedModuleCustomButtons(),this.setData("csript_disabledactions",[])},recordLockingDetails:function(){this.filterRestrictedCustomButton()}.observes("recordLockingDetails"),getRestrictedButtonIds:function(){if("undefined"!=typeof detailView&&detailView&&detailView.recordLockingDetails&&detailView.recordLockingDetails.lockingConfigJSON&&detailView.recordLockingDetails.lockingConfigJSON.length)return new Set(detailView.recordLockingDetails.lockingConfigJSON.map((t=>t.restricted_custom_buttons)).flat().filter((t=>t&&t.id)).map((t=>t.id)));{let t=this.getData("recordLockingDetails");return t&&t.restricted_custom_buttons&&t.restricted_custom_buttons.length?new Set(t.restricted_custom_buttons):new Set}},filterRestrictedCustomButton:function(){if(function(){const t=this.getData("record"),e=this.getData("recordLockingDetails");return Crm.renderDVLyteFlow(this.getData("module"))?e&&e.isLockedForMe:t&&t.$locked_for_me}.call(this)){let t=this.getRestrictedButtonIds(),e=this.getData("customButtons");e=e||[],e=e.filter((e=>!t.has(e.id))),this.setData("customButtons",e)}else this.setData("customButtons",this.getData("customButtonContainer"))},getRecordLayoutId:function(t,e,o){const n=moduleRecordMapping[t].id;n&&store.findRecord("module",n,void 0,void 0,void 0,{allowMultiple:!0}).then(function([s]){const i={position:"view",moduleName:t};store.findRecord(n,e,{fields:"Layout"},void 0,!0,{}).then(function([t]){i.layoutId=t.Layout?t.Layout.id:s.layouts[0].id,o(i)}.bind(this))}.bind(this))},getCustomButtonsPromise:function(t){return store.findAll("custom_button",{module:moduleApiMapping[t],fields:"id,name,description,profiles,layouts,sequence_number,position,details,user_types"},!0,!0,{isV6Api:!0})},getLayoutIdFromModule:function(t){const e=moduleRecordMapping[t];if(e&&e.layouts&&e.layouts.length)return e.layouts[0].id},getRelatedModuleCustomButtons:function(){let t=this.getData("record");if(this.getData("isActivityModule")&&t)if(Crm.renderDVLyteFlow(this.getData("module"))){const e=function(e){if(t.Who_Id&&e[t.Who_Id.id]){const o=t.Who_Id.record_module,[n]=e[t.Who_Id.id];let s=n&&n.$layout_id&&n.$layout_id.id;s||(s=this.getLayoutIdFromModule(o));const i=function(t){const e={position:"view",moduleName:o};s&&(e.layoutId=s),t=this.filterButtonData(t,e),t=this.executeMethod("reOrderCustomButtons",t),this.setData("contactModCustomButtons",t||[])};this.getCustomButtonsPromise(o).then(i.bind(this))}if(t.$se_module&&t.What_Id&&e[t.What_Id.id]){const o=t.What_Id.record_module,[n]=e[t.What_Id.id];let s=n&&n.$layout_id&&n.$layout_id.id;s||(s=this.getLayoutIdFromModule(o));const i=function(t){const e={position:"view",moduleName:o};s&&(e.layoutId=s),t=this.filterButtonData(t,e),t=this.executeMethod("reOrderCustomButtons",t),this.setData("seModCustomButtons",t||[])};this.getCustomButtonsPromise(o).then(i.bind(this))}},o=this.getData("uniqueListenerId");o&&Lyte.triggerEvent("detail_view_trigger_request_listener_"+o,{case:"activity_rel_module",callBackFunc:e.bind(this)})}else{const e=function(t,e,o){this.getCustomButtonsPromise(t).then(function(n){this.getRecordLayoutId(t,e,function(t){n=this.filterButtonData(n,t),n=this.executeMethod("reOrderCustomButtons",n),this.setData(o,n||[])}.bind(this))}.bind(this))};if(t.Who_Id&&e.call(this,"Contacts",t.Who_Id.id,"contactModCustomButtons"),t.$se_module&&t.What_Id){let o=t.$se_module;o=moduleApiMapping[o]||o;const n=Object.entries(moduleApiMapping).find((t=>t[1]===o));if(n){const[o]=n;e.call(this,o,t.What_Id.id,"seModCustomButtons")}}}},didConnect:function(){var t=Math.random().toString(36).substring(2,15);this.setData("compId",t),this.executeMethod("reOrderCustomButtons")},methods:{reOrderCustomButtons:function(t){var e=!0;t||(e=!1,t=this.getData("customButtons")||[]);for(var o=t.length,n=[],s=[],i={},a=0;a<o;a++)t[a].hasOwnProperty("sequence_number")&&!i.hasOwnProperty(t[a].sequence_number)?i[t[a].sequence_number]=t[a]:n.push(t[a]);var u=Object.keys(i);u.sort((function(t,e){return t-e}));var c=u.length;for(a=0;a<c;a++)s.push(i[u[a]]);var r=n.length;for(a=0;a<r;a++)s.push(n[a]);if(e)return s;this.setData("customButtons",s)},onCusttomButtonBeforeShow:function(t){if("newWindow"==CustomButtonJSObjectInit[this.getData("module")+this.getData("position")]){var e=this;return commonUtils.showHideLoadingDiv(!0),store.clearCachedQuery("custom_button",{module:this.data.module}),new Promise((function(t,o){e.getCustomButtonApiPromise({moduleApiName:moduleRecordMapping[e.getData("module")].api_name,fields:"id,name,description,profiles,layouts,sequence_number,position,details,user_types,action"}).then((function(o){commonUtils.showHideLoadingDiv(!1),e.setData("customButtons",e.filterButtonData(o,{position:e.getData("position"),moduleName:e.getData("module")})),e.executeMethod("reOrderCustomButtons"),CustomButtonJSObjectInit[e.getData("module")+e.getData("position")]=e.getData("customButtons"),t(o)}),(function(t){o(t)}))}))}if(!this.getData("headlessDropdown")&&t&&t.target.classList.contains("executeCustomButton")){let t,e=this.getData("customButtons"),o=this.getData("contactModCustomButtons"),n=this.getData("seModCustomButtons");return t=e&&e.length?e[0].id:o&&o.length?o[0].id:n[0].id,this.getData("csript_disabledactions")&&-1!==this.getData("csript_disabledactions").indexOf(t)?!1:(this.throwEvent("on-button-click",t),!1)}if(this.getData("headlessDropdown")){var o=store.peekAll("custom_button");if("canvas"===Lyte.Router.getRouteInstance().routeName){const t={position:"view",moduleName:this.getData("module")};this.getData("currentLayoutId")&&(t.layoutId=this.getData("currentLayoutId")),o=Lyte.registeredMixins["crm-view-utils"].filterButtonData(o,t);var n=$L("crm-detailview-canvas")[0];if(n){var s=n.getData("recordLockingDetails");s&&s.isLockedForMe&&s.restricted_custom_buttons&&(o=o.filter((function(t){return!s.restricted_custom_buttons.contains(t.id)})))}}this.setData("customButtons",o)}if(CustomButtonJSObjectInit.showOrHideButtons(),Crm.userDetails.isRelatedListLyteEnabled&&"relatedList"===this.getData("btnid")&&this.getData("customButtons").length<=1)return!1},checkResult:function(t){0==t.length?this.setData("showNoButtonDiv",!0):this.setData("showNoButtonDiv",!1)},onCusttomButtonShow:function(){this.addSortableDropdown()},onHide:function(){var t=document.querySelector("#buttonSearch");t&&t.setValue("")},getCurrentViewPageDetails:function(t){try{var e=Lyte.Router.getRouteInstance().routeName,o={};if("list"===e){var n=$("crm-page-navigator");if(n.length){var s=n[0].component,i=s.data.page,a=s.data.per_page,u=s.data.startIndex,c=s.data.total_count,r=u+a;r=r>c?c:r;var d=store.model[t].data,m=[];d&&d.length&&(m=d.filter((t=>t.recnum<=r&&t.recnum>u)).map((t=>t.id))),o.ids=m,o.pageNo=i}}else if("canvas"===e){let t,e=[],n=$L("crm-list-view-canvas");if(n.length){n=n[0].component;e=n.data.customview_records.map((t=>t.id)),t=n.data.page}o.ids=e||[],o.pageNo=t}return o.cvId=$("crm-customview-layer")[0].component.data.cvid,o}catch(e){throw location.href.indexOf("localzoho")>=0&&(murphy.addCustomTracking({message:"moduleId to be debugged"+t,type:"custom event"}),murphy.addCustomTracking({message:"moduleInfo to be debugged"+JSON.stringify(store.model[t]),type:"custom event"})),murphy.error(e),e}}},actions:{doCscriptActions:function(t){if("rename"===t.action){const t=CustomButtonJSObjectInit.cscriptChecks.rename,e=this.getData("customButtons");Object.keys(t).length&&e&&e.length&&e.forEach((e=>{t[e.id]&&(Lyte.objectUtils(e,"delete","name"),Lyte.objectUtils(e,"add","name",t[e.id]))})),this.setData("customButtons",e)}},mouseOverCustomButton:function(t,e,o,n){this.mouseOverCustomButton(t,e,o,n)},mouseOutCustomButton:function(){this.mouseOutCustomButton()},executeCustomButton:function(t){var e=this.getData("btnid"),o=$L("#"+e)[0];o&&o.toggle(),this.throwEvent("on-button-click",t)},createCustomBtn:function(t,e){"view"!==e&&"detail"!==e||(e="viewEntity"),CustomButtonJSObjectInit.createCustBtnPage(t,e)},manageCustomButton:function(t){CustomButtonJSObjectInit.manageCustBtn(t)}},addSortableDropdown:function(){let t=null;const e=function(t,e,o,n,s,i,a){var u=this.getData("module"),c=t.dataset.value,r=store.peekRecord("custom_button",c);let d=this.getData("customButtons");if(c&&n!==s){if(this.getData("isActivityModule")){(this.getData("seModCustomButtons").length>0||this.getData("contactModCustomButtons").length>0)&&_cruxUtils.showCustomMessage({params:{ltPropType:"info",ltPropMessage:I18n.getMsg("crm.custombutton.sort.msg")}}),r&&r.$.set("sequence_number",s);let t=this.getData("customButtons"),e=this.getData("contactModCustomButtons"),o=this.getData("seModCustomButtons");t.some((t=>t.id===c))?d=t:e.some((t=>t.id===c))?(u="Contacts",d=e):o.some((t=>t.id===c))&&(u=this.getData("seModule"),d=o),Lyte.arrayUtils(d,"insertAt",s-1,Lyte.arrayUtils(d,"removeAt",n-1))}else r.$.set("sequence_number",s+1),Lyte.arrayUtils(d,"insertAt",s,Lyte.arrayUtils(d,"removeAt",n)),u=this.getData("module");this.addSortableDropdown(),moduleApiMapping[u]&&(u=moduleApiMapping[u]);const e=function(){const t=$L("crm-custom-button lyte-dropdown"),e=this.getData("csript_disabledactions");t.length&&(t[0].ltProp("disabledList",[]),t[0].ltProp("disabledList",e))};e.call(this);const o=function(){Lyte.registeredMixins["crm-view-utils"].clearCustomButtonCache(u)};store.triggerUpdate("custom_button",t.dataset.value,["sequence_number"],{module:u},{isV6Api:!0}).then(o.bind(this)).finally(e.bind(this))}a.preventDefault()};if(this.getData("isActivityModule")){let o="#cvBtnListSearch"+this.data.btnid+" lyte-drop-group",n=$L("#"+this.data.btnid,this.$node)[0].component.childComp;t=$L(o,n);let s=t.length;for(let o=0;o<s;o++){let n=t[o].id;t.eq(o).sortable({onDrop:e.bind(this),containment:"#"+n,restrict:"#"+n+" lyte-drop-label,.restrictSortForNoBtn"})}}else t=$L("#cvBtnListSearch"+this.data.btnid,$L("#"+this.data.btnid,this.$node)[0].component.childComp),t.sortable({onDrop:e.bind(this),preventDefault:{mousedown:!1}})}},{mixins:["crm-view-utils","crm-custom-button-mixin"]}),Lyte.Component.registerHelper("getDisableClassForActions_CustomButon",(function(t,e){return e&&-1!==e.indexOf(t)?" disable cDefault ":""})),Lyte.Component.register("crm-custombuttons-popover",{_template:'<template tag-name="crm-custombuttons-popover"> <lyte-popover lt-prop-wrapper-class="customButtonPopover" id="customButtonPopover" lt-prop-max-width="280px" lt-prop-show-close-button="false" lt-prop-freeze="false"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <div class="labelNameColor crmBaseColor crm-base-font-size crm-font-semibold mB5">{{getI18n(\'crm.custombutton.name\')}}:</div> <div class="crm-base-font-size crmBaseColor">{{popoverName}}</div> <template is="if" value="{{popoverDescription}}"><template case="true"> <div class="labelNameColor mT15 crmBaseColor crm-base-font-size crm-font-semibold mB5">{{getI18n(\'crm.customize.custombutton.function.desc\')}}:</div> <div class="wwBreakWord crm-base-font-size baseColor">{{popoverDescription}}</div> </template></template> </lyte-popover-content> </template> </lyte-popover> </template>',_dynamicNodes:[{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[1,1,0]},{type:"text",position:[1,3,0]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"text",position:[3,0]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["popoverName","popoverDescription","originElement","position","customButtonFocus"],data:function(){return{popoverName:Lyte.attr("string"),popoverDescription:Lyte.attr("string"),originElement:Lyte.attr("string"),position:Lyte.attr("string"),customButtonFocus:Lyte.attr("boolean",{default:!1})}},onMouseOver:function(t,e,o,n){if(o||Math.ceil($L(t).outerWidth())<Math.ceil($L(t)[0].scrollWidth)){var s=this;if(this.setData("customButtonFocus",!0),s.getData("customButtonFocus")){s.setData("popoverName",e),s.setData("popoverDescription",null!=o?o:"");var i=document.getElementsByTagName("crm-custombuttons-popover")[0].querySelector("lyte-popover");n&&s.setData("position",n),i.ltProp("placement",this.getData("position")),i.ltProp("originElem",t),i.ltProp("show",!0)}}},onMouseOut:function(){document.getElementsByTagName("crm-custombuttons-popover")[0].querySelector("lyte-popover").ltProp("show",!1),this.setData("customButtonFocus",!1)}});
